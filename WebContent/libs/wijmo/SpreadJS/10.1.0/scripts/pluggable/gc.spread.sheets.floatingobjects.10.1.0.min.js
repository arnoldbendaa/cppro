/*!
 * 
 * Spread.Sheets Library 10.1.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/spreadjs/eula/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FloatingObjects=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){var d=c(1);c(5),c(4),c(6),d.SR={},d.SR.en=c(8),a.exports=d},function(a,b,c){var d,e,f,g,h,i,j,k=c(2),l=c(3),m=l.j.Fa,n=c(4),o=k.Rect,p=k.Point,q=k.Events,r=k.Rm,s=l.j.Ma,t=k.Ul,u=t.Pl,v=t.Nl,w=t.Rl,x=n.yR,y=document,z=l.D,A=function(){return l.C(a.exports.SR)()},B=k.GC$,C=null,D=void 0,E=Math.ceil,F=Math.floor,G=Math.max,H=Math.min,I=Math.abs,J="div",K="on",L="z-index",M="move",N="unselectable",O=1,P="border",Q=9007199254740992,R="floatingObjects",S=".gcFloatingObject",T="name",U="x",V="y",W="width",X="height",Y="start",Z=Y+"Row",$=Y+"RowOffset",_=Y+"Column",aa=Y+"ColumnOffset",ba="end",ca=ba+"Row",da=ba+"RowOffset",ea=ba+"Column",fa=ba+"ColumnOffset",ga="isSelected",ha="isLocked",ia="isVisible",ja="canPrint",ka="dynamicSize",la="dynamicMove",ma="fixedPosition",na="allowResize",oa="allowMove",pa=700,qa=701,ra="position",sa="absolute",ta="background",ua="gc-no-user-select",va="gc-floatingobject-selected",wa="gc-floatingobject-unselected",xa="gc-floatingobject-resize-indicator-select",ya="gc-floatingobject-resize-indicator-unSelect",za="gc-floatingobject-content-container",Aa="gc-floatingobject-container",Ba="gc-floatingobject-moving-container",Ca="gc-floatingobject-moving-div",Da=".gc-floatingobject-resize-indicator",Ea="gc-floatingobject-resize-indicator",Fa="gc-floatingobject-absolute",Ga="gc-floatingobject-top",Ha="gc-floatingobject-middle",Ia="gcfloatingobject-bottom",Ja="gc-floatingobject-left",Ka="gc-floatingobject-center",La="gc-floatingobject-right",Ma="div."+Ea,Na=Ma+"."+Ga+"."+Ja,Oa=Ma+"."+Ha+"."+Ja,Pa=Ma+"."+Ia+"."+Ja,Qa=Ma+"."+Ga+"."+Ka,Ra=Ma+"."+Ia+"."+Ka,Sa=Ma+"."+Ga+"."+La,Ta=Ma+"."+Ha+"."+La,Ua=Ma+"."+Ia+"."+La,Va="content",Wa="gc-no-user-select",Xa="100%",Ya="gc-floatingobject-background-cover",Za=function(){var a=this;a.uQ=function(){var a=this.wr;a&&a.zR().forEach(function(a){a.isSelected(!1)})},a.AR=function(){var a=this,b=a.wr;b&&(b.isNeedToUpdateLayout=!0)},a.BR=function(){var a=this,b=a.parent,c=a.tv,d=b&&b.tv;return c||(c=a.tv=d?d:{fromSheet:C,isCutting:!1}),c},a.ex=function(){var a=this,b=a.BR(),c=b&&b.fromSheet;c&&(c.CR=C),b.fromSheet=C,b.isCutting=!1},a.DR=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.ER=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.isPasteFloatingObject=function(){var a=this,b=a.BR().fromSheet,c=this.CR;return!c&&b&&(c=b.CR),c&&!c.isEmpty()}};Za.call(k.Worksheet.prototype);function $a(a){var b,c,d,e,f,g,h,i=a.FR;if(i){for(b=0,d=i.length;b<d;b++)if(f=i[b]){for(c=0,e=f.length;c<e;c++)g=f[c],g&&g.no();f.length=0}i.length=0,a.FR=C}h=a.wr,h&&h.no()}function _a(a,b,c){a.zR().forEach(function(a){a.rI(b,c)})}function ab(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){db(b,-1,b+c-1,a.sheet().getColumnCount(),d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.GR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function bb(a,b,c){a.zR().forEach(function(a){a.tI(b,c)})}function cb(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){db(-1,b,a.sheet().getRowCount(),b+c-1,d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.HR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function db(a,b,c,d,e){var f=e[Z](),g=e[_](),h=e[ca](),i=e[ea]();return a<=f&&b<=g&&c>=h&&d>=i}d={init:function(){var a=this;a.wr=new f(a),a.pictures=new vb(a,"1"),a.floatingObjects=new vb(a,"0")},dispose:function(){var a=this;$a(a),B(a.Ws()).unbind("mousedown.fos")},setHost:function(a){if(a){var b=this,c=".fos";a.bind("mousedown"+c,function(){b.uQ()}),b.bind(q.TableFiltered+c,function(){b.AR()}),b.bind(q.RangeFiltered+c,function(){b.AR()})}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=this.wr;g&&("addRows"===b?_a(g,c,d):"deleteRows"===b?ab(g,c,d):"addColumns"===b?bb(g,e,f):"deleteColumns"===b&&cb(g,e,f))},paint:function(a){var b=this,c=a.clipRect;b.QP||(b.IR=function(a,c){var d,e;return b.FR||(b.FR=[]),d=b.FR[a],d||(b.FR[a]=[]),e=b.FR[a][c],e||(b.FR[a][c]=new i(b)),e=b.FR[a][c]},b.QP=function(a,b){var c,d,e,f,g,h=this;if(!h.fI&&h.wr)for(c=h.am(),b!==C&&void 0!==b||(b=h._zoomFactor),e=0;e<=2;e++)for(f=0;f<=2;f++)d=c.Ft(e,f),d&&(g=h.IR(e,f),g&&g.yl(e,f,b))}),b.QP(c)},lastNonNullRowAndCol:function(){var a=0,b=0,c=this.wr;return c&&c.zR().forEach(function(c){c&&(c[ca]()>a&&(a=c[ca]()),c[ea]()>b&&(b=c[ea]()))}),{lastNonNullRow:a,lastNonNullCol:b}},toJson:function(a){var b=this.wr.toJSON();b.length>0&&(a.floatingObjects=b)},fromJson:function(a,b){var c,d,e=this;e.wr=new f(e),c=a&&a.floatingObjectArray,d=b?c&&c.floatingObjects:a.floatingObjects,d&&e.wr.fromJSON(d,b)},preProcessMouseDown:function(){this.uQ()},processKeyDown:function(a){var b,c,d,e,f=this.wr;if(f)for(b=f.zR(),d=b.length,c=0;c<d;c++)if(e=b[c],e.isSelected())return void(a.r=!0)}},k.Worksheet.$n(R,d),e={init:function(){k.Commands.JR(this.commandManager())}},k.Workbook.$n(R,e);function eb(a,b){var c=this;return b||(b={}),B.each(a,function(a,d){var e=c[d],f=e.call(c);e.isDefault(f)||(b[d]=f)}),b}function fb(a,b){if(b){var c=this;B.each(a,function(a,d){b[d]!==D&&c[d].call(c,b[d],!1)})}}function gb(a){var b=a;return function(a){var c=this,d=c.sheet();b===Va&&(c.KR=!0),d&&d.$p(),c.onPropertyChanged(b,a)}}function hb(a){var b=a;return function(a){var c=this,d=c.sheet();d&&(jb(c),d.$p()),c.onPropertyChanged(b,a)}}function ib(a){var b=a;return function(a){var c=this,d=c.sheet();d&&(wb(c),d.$p()),c.onPropertyChanged(b,a)}}function jb(a){var b,c,d=a.sheet();function e(b,c,e,f,g){var h=0,i=b.call(a);return h=c.call(a,d,0,i),kb.call(a,b,e,f,!0,g),h+=e.call(a)}d&&(b=e(a[Z],lb,a[$],d.getRowHeight,$),c=e(a[_],mb,a[aa],d.getColumnWidth,aa),a.x()===c&&a.y()===b||(a.x(c,!1),a.y(b,!1),a.onPropertyChanged("location",new o(c,b,a[W](),a[X]()))))}function kb(a,b,c,d,e){var f=this,g=b.call(f),h=c.call(f.sheet(),a.call(f),3),i=f.LR;h>0&&h--,g>h?(i[e]||(i[e]=g),b.call(f,h)):i[e]&&(i[e]<h?(b.call(f,i[e]),i[e]=D):(d&&h<i[e]||!d&&g<i[e])&&b.call(f,h))}function lb(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getRowHeight(e,3),!(f>d));e++);return f}function mb(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getColumnWidth(e,3),!(f>d));e++);return f}function nb(a){var b=a.sheet();function c(b,c,d,e,f){var g=pb(a,b,c),h=g.index;e.call(a,g.offset,!1),g.offset===-1&&(h+=1,e.call(a,0),h===f&&(h=f-1)),d.call(a,h,!1)}b&&(c(!0,a.y(),a[Z],a[$],b.getRowCount()),c(!1,a.x(),a[_],a[aa],b.getColumnCount()))}function ob(a){var b=a.sheet();function c(b,c,d,e){var f=pb(a,b,c);d.call(a,f.index,!1),e.call(a,f.offset,!1)}b&&(c(!0,a.y()+a[X](),a[ca],a[da]),c(!1,a.x()+a[W](),a[ea],a[fa]))}function pb(a,b,c){var d,e=0,f=0,g=a.sheet(),h=b?g.getRowCount():g.getColumnCount(),i=0;for(i=0;i<h;i++){if(d=b?g.getRowHeight(i,3):g.getColumnWidth(i,3),e+=d,f=e-c,f>0){f=f>0?d-f:-1;break}if(0===f){f=0,i+=1;break}}return i>=h&&(i=h-1,f=0),{offset:f,index:i}}function qb(a,b){rb(b,sb(a))}function rb(a,b){a&&(a.style.zIndex=b+"")}function sb(a){var b=a.PR;return m(b)&&(b=a.Gia),b}function tb(a,b){a.PR=b,a.qo.forEach(function(a){for(var c=a.parentElement;c.className.indexOf(Aa)===-1;)c=c.parentElement;rb(c,b)})}function ub(a,b){m(a.PR)&&(a.Gia+=b)}function vb(a,b){this.kj=a,this.MR=b}B.extend(vb.prototype,{add:function(a,b,c,d,e,f){var g=this,h;return"1"===g.MR?h=new j.Picture(a,b,c,d,e,f):"0"===g.MR&&(h=a),g.kj.wr.Sb(h),h},get:function(a){return this.kj.wr.NR(a)},remove:function(a){this.kj.wr.Fb(a)},clear:function(){return this.kj.wr.$b(this.MR)},all:function(){return this.kj.wr.zR(this.MR)},zIndex:function(a,b){return this.kj.wr.PR(a,b)}}),f=function(){function a(a){var c=this;c.sheet(a),b(c),c.QR={}}function b(a){var b=a.sheet();b&&(B(y.body).bind("scroll"+S,function(){var a=b.parent.getActiveSheet();a.wr&&b.QP(a.Dr())}),b.Fu(q.ColumnChanged+S,function(b,d){var e=d.propertyName;e!==W&&e!==ia||c(a)}),b.Fu(q.RowChanged+S,function(b,d){var e=d.propertyName;e!==X&&e!==ia||c(a)}),b.Fu(q.ColumnWidthChanged+S,function(){c(a)}),b.Fu(q.RowHeightChanged+S,function(){c(a)}))}function c(a){var b=a.sheet();a.isNeedToUpdateLayout=!0,b.QP&&b.QP(b.Dr())}function d(a,b){if(a.QR[b])throw Error(A().Exp_FloatingObjectHasSameNameError)}var e={sheet:u("sheet",D),Hia:function(a){this.zR().forEach(function(b){ub(b,a)})},Sb:function(a){var b,c=this,e=c.sheet();if(e.suspendPaint(),b=a.name(),!b)throw Error(A().Exp_FloatingObjectNameEmptyError);d(c,b),c.Hia(-1),a.sheet(e),c.QR[b]=a,e.resumePaint()},NR:function(a){return this.QR[a]},Fb:function(a,b){var c,d,e,f=this;return!!a&&(c=f.sheet(),d=f.NR(a),c.suspendPaint(),b?(e={sheet:c,sheetName:c.Cj,floatingObject:d,cancel:!1},c.Wq(q.FloatingObjectRemoving,e),e&&e.cancel===!1&&(delete f.QR[a],c.Wq(q.FloatingObjectRemoved,{sheet:c,sheetName:c.Cj,floatingObject:d}))):delete f.QR[a],c.resumePaint(),!0)},U3:function(a,b){var c,e=this,f=e.sheet();if(f.suspendPaint(),!b)throw Error(A().Exp_FloatingObjectNameEmptyError);d(e,b),c=e.QR[a],delete e.QR[a],e.QR[b]=c,f.resumePaint()},$b:function(a){var b=this,c=b.sheet();c.suspendPaint(),B.each(this.QR,function(c,d){a&&a!==d.typeName||b.Fb(d.name())}),c.resumePaint()},zR:function(a){var b=[];return B.each(this.QR,function(c,d){a&&a!==d.typeName||b.push(d)}),b},PR:function(a,b){var c=isNaN(b),d=this.NR(a);if(d){if(c)return sb(d);tb(d,b)}if(c)return-1},toJSON:function(){var a=[];return this.zR().forEach(function(b){var c,d;b instanceof g&&b.hga()&&(c=b.toJSON(),d=b.PR,isNaN(d)||(c.zIndex=d),a.push(c))}),a},fromJSON:function(a,b){var c,d,e,f,h,i,l,n=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)d=a[c],e=C,d&&(h=d.floatingObjectType,i=t.Ol(h)?h+"":d.typeName,f="0"===i?g:"1"===i?j.Picture:k.getTypeFromString(i),f&&(e=new f,e.fromJSON(d,b),n.Sb(e),l=d.zIndex,m(l)||(e.PR=l)))},no:function(){B(y.body).unbind("scroll"+S);var a=this.sheet();a&&(a.Gu(q.ColumnChanged+S),a.Gu(q.RowChanged+S),a.Gu(q.ColumnWidthChanged+S),a.Gu(q.RowHeightChanged+S))},hitTest:function(a,b){var c=this.sheet(),d=c.am(),e=c._zoomFactor,f=C;return d&&B.each(this.QR,function(g,h){if(c.DR(h)){var i=h.position().x*e+d.zr+d.Br,j=h.position().y*e+d.Ar+d.Cr,k=h[W](),l=h[X]();return a>=i&&a<i+k&&b>=j&&b<j+l?(f={x:a,y:b,floatingObject:h},!1):void 0}}),f},FS:function(){for(var a="FloatingObject",b=1,c=a+b;this.NR(c);)b++,c=a+b;return c}};return B.extend(a.prototype,e),a}();function wb(a){var b,c,d=a.sheet();function e(b,c,e,f,g,h,i){var j,k,l=0,m=b.call(a),n=c.call(a);return l=e.call(a,d,m,n),j=l+f.call(d,n,3),0===j&&a.isVisible()&&(a.isVisible(!1),a.RR=!1),m===n?(kb.call(a,c,h,f,!1,i),l=a[da]()-a[$]()):(k=f.call(d,m,3),k>0&&(l-=g.call(a)),kb.call(a,c,h,f,!1,i),l+=h.call(a)),l}d&&(a.RR===!1&&(a.isVisible(!0),a.RR=!0),b=e(a[Z],a[ca],lb,d.getRowHeight,a[$],a[da],da),c=e(a[_],a[ea],mb,d.getColumnWidth,a[aa],a[fa],fa),c<0&&(c=0),b<0&&(b=0),a[W]()!==c&&(a[W](c,!1),a.onPropertyChanged(W,c)),a[X]()!==b&&(a[X](b,!1),a.onPropertyChanged(X,b)))}g=function(){var a,b=[T,U,V,W,X,ja,ga,ha,ia,la,ka,ma,na,oa],c=[["sheet",C,function(){l(this)}],[T,D,function(a){var b=this;if("string"!=typeof a||""===a)throw Error(A().Exp_FloatingObjectNameEmptyError);b.sheet()&&b.sheet().wr.Sb(b),b.onPropertyChanged("name",a)},function(){var a=this;return a.sheet()&&a.sheet().wr.Fb(a.name()),!0}],[U,0,f(U,!1)],[V,0,f(V,!1)],[X,0,f(X,!0)],[W,0,f(W,!0)],[Z,D,hb(Z)],[$,0,hb($)],[_,D,hb(_)],[aa,0,hb(aa)],[ca,D,ib(ca)],[da,0,ib(da)],[ea,D,ib(ea)],[fa,0,ib(fa)],[ga,!1,gb(ga)],[ha,!0,e(ha)],[ja,!0,e(ja)],[ia,!0,gb(ia)],[la,!0,function(a,b){e(la).call(this,a,b)},function(a){return"boolean"==typeof a&&(a||this.dynamicSize(!1,!1),!this.fixedPosition())}],[ka,!0,function(a,b){e(ka).call(this,a,b)},function(a){return"boolean"==typeof a&&this.dynamicMove()&&!this.fixedPosition()}],[ma,!1,function(a){var b=this;a&&(b.dynamicMove(!1,!1),b.dynamicSize(!1,!1)),b.onPropertyChanged(ma,a)}],[na,!0,gb(na)],[oa,!0,gb(oa)]];function d(a,b,c,d,e){var f=this;f.LR={startRowOffset:D,startColumnOffset:D,endRowOffset:D,endColumnOffset:D},f.RR=!0,f.typeName="0",f.name(a),f.x(b?b:0,!1),f.y(c?c:0,!1),f[W](d?d:0,!1),f[X](e?e:0,!1),f.qo=[],f.KR=!1,f.Gia=pa}function e(a){return function(b){this.onPropertyChanged(a,b)}}function f(a,b){return function(c){var d=this,e=d.sheet();e&&(b&&i(d),j(d),o(d),e.$p()),d.onPropertyChanged(a,c)}}function g(a,b,c,d){var e=this,f=a.call(e),g=b.call(e);c<=f?e.dynamicMove()&&(a.call(e,f+d),b.call(e,g+d)):c>f&&c<g&&e.dynamicSize()&&b.call(e,g+d)}function h(a,b,c,d,e,f,g){var h,i,j=this,k=a.call(j),l=c.call(j);e<=k?g<k?j.dynamicMove()&&(a.call(j,k-f),c.call(j,l-f)):g<l&&(h=g-k+1,i=l-k+1-h,j.dynamicMove()&&(a.call(j,e),b.call(j,0)),j.dynamicSize()&&c.call(j,e+i-1)):e<=l&&(g<l?j.dynamicSize()&&c.call(j,l-f):j.dynamicSize()&&(c.call(j,e),d.call(j,0)))}function i(a){var b=m(a,a[X]()),c=n(a,a[W]());a[W]()>c&&a[W](c,!1),a[X]()>b&&a[X](b,!1)}function j(a){var b,c,d=a.x()+a[W](),e=n(a,d);d>e&&a.x(G(0,e-a[W]()),!1),a.x()<0&&a.x(0,!1),b=a.y()+a[X](),c=m(a,b),b>c&&a.y(G(0,c-a[X]()),!1),a.y()<0&&a.y(0,!1)}function l(a){var b,c,d,e;i(a),j(a),b=a[Z](),c=a[_](),b&&c?jb(a):nb(a),d=a[ca](),e=a[ea](),d&&e?wb(a):ob(a)}function m(a,b){var c,d=a.sheet();return d?(c=d.getRowCount(),lb(d,0,c,b)):Q}function n(a,b){var c,d=a.sheet();return d?(c=d.getColumnCount(),mb(d,0,c,b)):Q}function o(a){nb(a),ob(a)}return a={constructor:d,position:function(a){var b=this,c=b.sheet();return 0===arguments.length?new p(b.x(),b.y()):(s(a,p)&&(b.x()===a.x&&b.y()===a.y||(b.x(a.x,!1),b.y(a.y,!1),j(b),o(b),c&&c.$p(),b.onPropertyChanged("position",a))),b)},content:u(Va,C,gb(Va)),cloneContent:function(){var a,b,c=this.content();return c?(c.cloneNode?a=c.cloneNode(!0):(b=v(J),b.innerHTML=c.outerHTML,a=b.firstChild),B(a).removeAttr("id")[0]):C},refreshContent:function(a){var b,c,d,e,f,g,h=this;h.KR&&a&&(b=B(a),b.empty(),c=h.cloneContent(),d=Xa,e=Xa,f="",g="",c&&c.style&&(f=c.style.width,g=c.style.height),""!==f&&(d=f),""!==g&&(e=g),c!==C?(B(c).css({width:d,height:e}).addClass(Ya).addClass(ua).attr(N,K).appendTo(a),b.css(ta,"")):b.css(ta,"#044062"),h.KR=!1)},toJSON:function(){var a=this,c=eb.call(a,b);return c.typeName=a.typeName,c[Va]=B(v(J)).append(a.cloneContent()).html(),c},fromJSON:function(a,c){var d,e;a&&(d=this,d.TR=!0,fb.call(this,b,a,c),o(d),a.content&&(e=v(J),e.innerHTML=a.content,d.content(B(e.firstChild)[0])),d.TR=D)},clone:function(){var a=this,b=k.getTypeFromString(a.typeName),c=b?new b:new d,e=JSON.stringify(a.toJSON());return c.fromJSON(JSON.parse(e)),c.content(a.cloneContent()),c},onPropertyChanged:function(a,b){var c,d=this;d.TR||(c=d.sheet(),d.Wq({sheet:c,sheetName:c?c.Cj:"",floatingObject:d,propertyName:a}))},Wq:function(a){var b,c=this.sheet();c&&(c.Wq(q.FloatingObjectChanged,a),a.propertyName===ga&&(b={sheet:a.sheet,sheetName:a.sheetName,floatingObject:a.floatingObject},c.Wq(q.FloatingObjectSelectionChanged,b)))},rI:function(a,b){var c=this;a=E(a),b=E(b),g.call(c,c[Z],c[ca],a,b)},GR:function(a,b){var c=this,d=a+b-1;h.call(c,c[Z],c[$],c[ca],c[da],a,b,d)},tI:function(a,b){var c=this;a=E(a),b=E(b),g.call(c,c[_],c[ea],a,b)},HR:function(a,b){var c,d=this;a=E(a),b=E(b),c=a+b-1,h.call(d,d[_],d[aa],d[ea],d[fa],a,b,c)},getHost:function(){return this.qo.concat()},UR:function(a){var b=this.qo;a&&b.indexOf(a)<0&&b.push(a)},VR:function(a){var b=this.qo,c=b.indexOf(a);c>=0&&b.splice(c,1)},WR:function(){var a,b,c,d,e,f,g=v(J);return B(g).addClass(Wa).addClass(za).attr(N,K).css(ra,sa),a=this.cloneContent(),b=Xa,c=Xa,d="",e="",f=a&&a.style,f&&(d=f.width,e=f.height),""!==d&&(b=d),""!==e&&(c=e),a!==C&&B(a).css({width:b,height:c}).addClass(Ya).addClass(Wa).attr(N,K).appendTo(g),this.UR(g),g},hga:function(){return!0}},B.each(c,function(b,c){a[c[0]]=u(c[0],c[1],c[2],c[3])}),d.prototype=a,d}(),h=function(){var a=Y+"X",b=Y+"Y",c=Y+"Width",d=Y+"Height",e="end",f=e+"X",g=e+"Y",h=Y+"TopRow",i=Y+"LeftColumn",j="left",l="center",m="right",n="top",s=n+j,u=n+l,x=n+m,A="middle",E=A+j,Q=A+m,R="bottom",T=R+j,U=R+l,V=R+m,$="-resize",aa="cursor",ba="mousemove",da="mouseup";function fa(a,b){this.XR="";var c=this;c.YR=a,c.name=a?a.name():"",c.kj=b,c.RB=!1,c.ZR=!1}k.Zn(fa);function ga(e,f,g){var h=e.$R,i,j,k,l;switch(f){case s:i=H(h[a]+h[c],g.x),j=H(h[b]+h[d],g.y),k=I(g.x-h[a]-h[c]),l=I(g.y-h[b]-h[d]);break;case u:i=h[a],j=H(h[b]+h[d],g.y),k=h[c],l=I(g.y-h[b]-h[d]);break;case x:i=H(h[a],g.x),j=H(h[b]+h[d],g.y),k=I(g.x-h[a]),l=I(g.y-h[b]-h[d]);break;case E:i=H(h[a]+h[c],g.x),j=h[b],k=I(g.x-h[a]-h[c]),l=h[d];break;case Q:i=H(h[a],g.x),j=h[b],k=I(g.x-h[a]),l=h[d];break;case T:i=H(h[a]+h[c],g.x),j=H(h[b],g.y),k=I(g.x-h[a]-h[c]),l=I(g.y-h[b]);break;case U:i=h[a],j=H(h[b],g.y),k=h[c],l=I(g.y-h[b]);break;case V:i=H(h[a],g.x),j=H(h[b],g.y),k=I(g.x-h[a]),l=I(g.y-h[b])}return new o(i,j,k,l)}function ha(a){var b=B(a),c=b.position();return new o(c.left,c.top,b[W](),b[X]())}function ia(a,b,c,d,e,f){B(a).css([n,j,W,X],[[d-1],[c-1],e,f]).addClass(Ca).appendTo(b)}function ja(a,b){if(!a._R)return C;var c={inMoving:!1};return B(b.target).attr("resizeDirection")||(c.inMoving=!0),c}function ka(a){var b,c,d,e,f,g=a,h=g.kj,i=g.WE,j=g.aS,k=h.frozenTrailingRowCount(),l=h.frozenTrailingColumnCount(),m=h.am(),n=m.Ft(i,j),o=g.YR,p=o[Z](),q=o[_](),r=o[ca](),s=o[ea](),t=h.frozenRowCount(),u=h.frozenColumnCount(),v=h.getRowCount(3)-k-1,w=h.getColumnCount(3)-l-1;return i===O?(t>0&&(b=h.getViewportTopRow(i),(p<t||b===t)&&(n.y-=m.fs,n[X]+=m.fs)),k>0&&(c=h.getViewportBottomRow(i),r>v&&c===v&&(n[X]+=m.gs))):i===O-1?(b=h.getViewportTopRow(i+1),(r>=b||b===t)&&(f=m.Ft(i+1,j),n[X]+=f[X])):i===O+1&&(c=h.getViewportBottomRow(i-1),(p<=c||c===v)&&(f=m.Ft(i-1,j),n.y=f.y,n[X]+=f[X])),j===O?(u>0&&(d=h.getViewportLeftColumn(j),(q<u||d===u)&&(n.x-=m.hs,n[W]+=m.hs)),h.frozenTrailingColumnCount()>0&&(e=h.getViewportRightColumn(j),(s>w||e===w)&&(n[W]+=m.js))):j===O-1?(d=h.getViewportLeftColumn(j+1),(s>=d||d===u)&&(f=m.Ft(i,j+1),n[W]+=f[W])):j===O+1&&(e=h.getViewportRightColumn(j-1),(q<=e||e===w)&&(f=m.Ft(i,j-1),n.x=f.x,n[W]+=f[W])),n}function la(a,b,c,d,e){var f=ha(a);B(a).css([n,j,W,X],[f.y+c,f.x+b,f[W]+d,f[X]+e])}function ma(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,q=a;if(q.bS){b=q.$F,c=ka(q),d=q.cS,e=q.$R,f=e.direction,b=new p(b.x-c.x,b.y-c.y),g=ga(q,f,b),e.endX=g.x,e.endY=g.y,e.endWidth=g[W],e.endHeight=g[X],h=ha(d),i=g.y-h.y,j=g.x-h.x,k=g[W]-h[W],l=g[X]-h[X],la(d,j,i,k,l),m=q.dS;for(n in m)z(m,n)&&(o=m[n],la(o.moveResizeDiv,j,i,k,l))}}function na(a,b){var c=a.kj;if(c)return c.RF(b),!1}function oa(c){var d,e,j,k,l,m,n,o=c,p=o.kj,q=o.eS;if(q){if(d=w(p,q[h],p.getViewportTopRow(o.WE),!0),e=w(p,q[i],p.getViewportLeftColumn(o.aS),!1),j=q[f]-q[a]+(q[f]>q[a]?e:-1*e),k=q[g]-q[b]+(q[g]>q[b]?d:-1*d),0===j&&0===k)return;l=[],l.push(o.YR.name()),m=o.dS;for(n in m)z(m,n)&&l.push(n);p.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function Ma(c){var d,e,j,k,l,m,n,o=c,p=o.kj,q=o.eS,r=p._zoomFactor;if(q){d=w(p,q[h],p.getViewportTopRow(o.WE),!0),e=w(p,q[i],p.getViewportLeftColumn(o.aS),!1),j=q[f]-q[a]+(q[f]>q[a]?e:-1*e),k=q[g]-q[b]+(q[g]>q[b]?d:-1*d),j/=r,k/=r,l=[],l.push(o.YR.name()),m=o.dS;for(n in m)z(m,n)&&l.push(n);p.wu().execute({cmd:"moveFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function Va(c){var d,e,j,k,l,m,n,o,p,q=c,r=q.kj,s=r._zoomFactor,t=q.YR,u=q.$R;if(u){d=w(r,u[h],r.getViewportTopRow(q.WE),!0),e=w(r,u[i],r.getViewportLeftColumn(q.aS),!1),j=u[f]-u[a]+(u[f]>u[a]?e:-1*e),j/=s,k=u[g]-u[b]+(u[g]>u[b]?d:-1*d),k/=s,l=(u.endWidth+e)/s-t[W](),m=(u.endHeight+d)/s-t[X](),n=[],n.push(t.name()),o=q.dS;for(p in o)z(o,p)&&n.push(p);r.wu().execute({cmd:"resizeFloatingObjects",sheetName:r.name(),floatingObjects:n,offsetX:j,offsetY:k,offsetWidth:l,offsetHeight:m})}}function Wa(a,b,c){var d,e,f,g,h,i=a,j=i.cS;if(j){d=c.x-b.x,e=c.y-b.y,Xa(j,d,e),f=i.dS;for(g in f)z(f,g)&&(h=f[g],Xa(h.moveResizeDiv,d,e))}}function Xa(a,b,c){var d=B(a),e=B(a).position();d.css([n,j],[e[n]+c,e[j]+b])}function Ya(a){var b,c,d,e,f,g,h,i,j,k,l,m=a,n=m.eS;n&&(b=m.YR,c=m.kj,d=c.am(),e=d[W]-d.Br-d.zr,f=d[X]-d.Cr-d.Ar,g=n.startX,h=n.startY,i=b.position().x,j=b.position().y,k=b[W](),l=b[X](),i+n.endX-g<0&&(n.endX=g-i),j+n.endY-h<0&&(n.endY=h-j),i+k+n.endX-g>e&&(n.endX=e+g-i-k),j+l+n.endY-h>f&&(n.endY=f+h-j-l),n.startTopRow=c.getViewportTopRow(m.WE),n.startLeftColumn=c.getViewportLeftColumn(m.aS))}function Za(a){var b,c,d,e,f,g=a,h=g.$R;h&&(b=g.kj,c=b.am(),d=c[W]-c.Br-c.zr,e=c[X]-c.Cr-c.Ar,f=new o(h.endX,h.endY,h.endWidth,h.endHeight),f=f.getIntersect(0,0,d,e),h.endX=f.x,h.endY=f.y,h.endWidth=f[W],h.endHeight=f[X],h.startTopRow=b.getViewportTopRow(g.WE),h.startLeftColumn=b.getViewportLeftColumn(g.aS))}function $a(a){var b,c,d,e,f,g,h,i,j=v(J),k=B(j),l=a;return k.addClass(Aa).addClass(ua).attr(N,K).css(L,pa).bind("mousedown",function(a){l.AD(a)}).bind(ba,function(a){l.BD(a)}).bind(da,function(a){l.CD(a)}),j.addEventListener("mousewheel",function(a){na(l,a)},!1),j.addEventListener("DOMMouseScroll",function(a){na(l,a)},!1),b=B(v(J)).addClass(Ea+" "+Ga+" "+Ja+" "+Fa),c=B(v(J)).addClass(Ea+" "+Ga+" "+Ka+" "+Fa),d=B(v(J)).addClass(Ea+" "+Ga+" "+La+" "+Fa),e=B(v(J)).addClass(Ea+" "+Ha+" "+Ja+" "+Fa),f=B(v(J)).addClass(Ea+" "+Ha+" "+La+" "+Fa),g=B(v(J)).addClass(Ea+" "+Ia+" "+Ja+" "+Fa),h=B(v(J)).addClass(Ea+" "+Ia+" "+Ka+" "+Fa),i=B(v(J)).addClass(Ea+" "+Ia+" "+La+" "+Fa),k.append(b).append(c).append(d).append(e).append(f).append(g).append(h).append(i),fa.ao(l,"init",j),j}function _a(a){var b,c,d,e,f,g,h,i,k=a,l=k.hS&&k._R;if(l&&!k.cS){b=k.iS=v(J),k.cS=v(J),k.dS={},k.gS.jS.each(function(a){var b,c=a.YR;c&&c.name()!==k.YR.name()&&c.isSelected()&&!k.dS[c.name()]&&(b=a._R,k.dS[c.name()]={offsetX:b.x-l.x,offsetY:b.y-l.y,height:b[X],width:b[W],moveResizeDiv:v(J)})}),c=ka(k),d=B(b),d.css([L,n,j,W,X,ta],[qa,c.y,c.x,c[W],c[X],"rgba(255,255,255,0.01)"]).addClass(Ba).bind(ba,function(a){k.BD(a)}).bind(da,function(a){k.CD(a)}),e=l.y-c.y,f=l.x-c.x,ia(k.cS,b,f,e,l[W],l[X]),g=k.dS;for(h in g)z(g,h)&&(i=g[h],ia(i.moveResizeDiv,k.iS,f+i.offsetX,e+i.offsetY,i[W],i[X]));k.Ks&&B(k.Ks).append(k.iS)}}function ab(a){var b=a;b.RB||(B(y).bind(ba+S,function(a){b.BD(a)}).bind(da+S,function(a){b.CD(a)}),b.RB=!0)}function bb(a){var b=a;b.RB&&(b.RB=!1,B(y).unbind(ba+S).unbind(da+S))}function cb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=B(Da,b);r.removeClass(ya),c=a,d=ha(c.hS),e=c.kS,f=c.YR,c.lS&&(e=c.lS),g=fa.mS,h=ha(e),i=h.x,j=h.y,k=d[X]-h.y-h[X],l=d[W]-h.x-h[W],m=0,n=g+2,o=F(g/2+1),"function"==typeof f.borderWidth&&(p=f.borderWidth(),q=f.borderStyle(),f.nS(q)||(p=0),p>=o&&(m=p-o),k=d[X]-j-h[X]-p,l=d[W]-i-h[W]-p,i+=p,j+=p),i>0?(db(c,j>0,Na,m,m,D,D,"nw"+$,s),db(c,d[X]>0,Oa,m,(h[X]-n)/2+j,D,D,"w"+$,E),db(c,k>0,Pa,m,D,D,m,"ne"+$,T)):(eb(c,Na),eb(c,Oa),eb(c,Pa)),db(c,j>0,Qa,(h[W]-n)/2+i,m,D,D,"n"+$,u),db(c,k>0,Ra,(h[W]-n)/2+i,D,D,m,"n"+$,U),l>0?(db(c,j>0,Sa,D,m,m,D,"sw"+$,x),db(c,d[X]>0,Ta,D,(h[X]-n)/2+j,m,D,"w"+$,Q),db(c,k>0,Ua,D,D,m,m,"se"+$,V)):(eb(c,Sa),eb(c,Ta),eb(c,Ua)),c.ZR=!0}function db(a,b,c,d,e,f,g,h,i){var k,l=a,o=B(c,l.hS);b?(k=fa.mS,o.css([j,n,m,R,W,X,aa],[d,e,f,g,k,k,h]).addClass(xa).attr("resizeDirection",i)):eb(l,c)}function eb(a,b){B(b,a.hS).removeClass(xa).addClass(ya)}function fb(a,b){B(Da,b).removeClass(xa).addClass(ya),a.ZR=!1}function gb(a){var b,c,d,e,f,g=a,h=g.YR,i=h.src(),j=h.pictureStretch(),k=r.Om(h.sheet(),h.backColor()),l=g.kS;i&&l&&(b=B(l),g.XR!==i&&(g.XR=i,b.css([ta+"-image",ta+"-repeat"],["url('"+i+"')","no-repeat"])),b.css(ta+"-color",k),j!==C&&j!==D&&h.oS&&(c=h.getOriginalWidth(),d=h.getOriginalHeight(),e=b[W](),f=b[X](),t.ql(l,e,f,c,d,j)))}function hb(a,b,c){var d,e,f,g,h=a.lS,i=a.YR,k=i.borderWidth(),l=i.borderStyle(),o=r.Om(i.sheet(),i.borderColor()),p=i.borderRadius(),q=0,s=F(fa.mS/2+1);i.nS(l)||(k=0),k<s&&(q=s-k),d=q,e=q,f=q,g=q,s=G(k,s),b.x<0?d+=b.x-s:(d+=b.x<s?b.x-s:0,g=c[W]-d-b[W]-2-2*k),b.y<0?e+=b.y-s:(e+=b.y<s?b.y-s:0,f=c[X]-e-b[X]-2-2*k),B(h).css([ra,j,n,R,m,P+"-width",P+"-style",P+"-color",P+"-radius"],[sa,d,e,f,g,k,l,o,p])}return fa.prototype={AD:function(a){var b,c,d,e,f,g,h,i,j,l,m=this,n=m.kj,o=m.YR,q=n.comments,r=m.WE,s=m.aS;if(n.ER(o)&&n.endEdit()&&(b={e:a,r:C},fa.ao(m,"preProcessMouseDown",b),!b.r)){if(0===a.button||2===a.button){if(c=o.isSelected(),a.ctrlKey||a.shiftKey?o.isSelected(!c):c||(n.uQ(),o.isSelected(!0)),c||k.Vl.Zl(n),q&&q.vQ(),n.EJ(),2===a.button)return;if(d=n.mm,e=n.Vs(),f=new p(a.pageX-e.left,a.pageY-e.top),g=ja(m,a),!o.allowMove()&&(!o.allowResize()||g.inMoving))return;m.$F=f,m.pS=!0,m.bS=g,g.inMoving?(h={},h.startTopRow=n.getViewportTopRow(r),h.startLeftColumn=n.getViewportLeftColumn(s),h.startX=f.x,h.startY=f.y,m.eS=h):(_a(m),i={},j=ha(m.cS),i.startX=j.x,i.startY=j.y,i.startWidth=j[W],i.startHeight=j[X],i.startTopRow=n.getViewportTopRow(r),i.startLeftColumn=n.getViewportLeftColumn(s),i.cursor=a.target.style.cursor,i.direction=B(a.target).attr("resizeDirection"),m.$R=i),ab(m),l=n.hitTest(f.x,f.y),d.rG={KG:l.rowViewportIndex,MG:l.colViewportIndex,sG:l.hitTestType},d.$F=f,d.qG(),d.O3=!0}return!1}},BD:function(a){var b,c,d,e,f=this,g=f.kj,h=f.hS,i=f.iS;if(g.ER(f.YR)&&(b={e:a,r:C},fa.ao(f,"preProcessMouseMove",b),!b.r))return g.dG?(h&&B(h).css(aa,"default"),!0):(c=g.mm,d=g.Vs(),e=new p(a.pageX-d.left,a.pageY-d.top),f.pS&&(f.bS.inMoving?(f.qS=!0,_a(f),Wa(f,f.$F,e),B(i).css(aa,M)):f.YR.allowResize()&&(f.kv=!0,ma(f),B(i).css(aa,f.$R[aa])),(f.qS||f.kv)&&(f.$F=e,c.$F=e,c.NG(),B(y.body).addClass(ua).attr(N,K))),!1)},CD:function(a){var b,c,d,e,f,g=this,h=g.kj,i=h.mm,j=g.YR,k=g.hS,l=g.bS;if(h.ER(j)&&(b={e:a,r:C},fa.ao(g,"preProcessMouseUp",b),!b.r))return h.dG?(B(k).css(aa,M),!0):(i.O3=!1,i.RG(),c=h.Vs(),d=new p(a.pageX-c.left,a.pageY-c.top),e=g.eS,e&&(e.endX=d.x,e.endY=d.y),l&&(f=j.fixedPosition(),l.inMoving&&g.qS?(f&&Ya(g),a.ctrlKey?oa(g):Ma(g)):g.kv&&(f&&Za(g),Va(g)),B(y.body).removeClass(ua)),g.rS(),!1)},rS:function(){var a=this;a.$R=C,a.eS=C,a.dS=C,B(a.iS).remove(),a.cS=C,a.pS=!1,bb(a),a.qS=!1,a.kv=!1},YR:function(){return this.YR},yl:function(a,b){var c,d,e,f,g,h,i,k=this,l=k.YR,m=k.kj;l&&(c=!1,k.sS=a,d=k.hS,d||(d=k.hS=$a(k),qb(l,d),e=m.parent,e&&(f=k.Ks=e.xv(),f&&B(f).append(d))),g=k.kS,g||(g=k.kS=l.WR(),"function"==typeof l.borderWidth?(k.lS=v(J),B(k.lS).addClass(ua+" "+za).attr(N,K),d.appendChild(k.lS),k.lS.appendChild(g)):(d.appendChild(g),c=!0)),k.lS&&(hb(k,b,a),b.x=0,b.y=0),h=B(g),B(d).css([n,j,W,X],[a.y,a.x,a[W],a[X]]),h.css([n,j,W,X,aa],[b.y,b.x,b[W],b[X],M]),l.refreshContent&&l.refreshContent(g),k.lS&&gb(k),l.isSelected()?(h.removeClass(wa).addClass(va),l.allowResize()?cb(k,d):k.ZR&&fb(k,d)):(h.removeClass(va).addClass(wa),fb(k,d)),c&&(i=g.firstChild,m.Wq(q.FloatingObjectLoaded,{sheet:m,sheetName:m.Cj,floatingObject:l,element:i})))},no:function(){var a=this,b=a.YR,c=a.hS,d=a.iS,e=a.kS;fa.ao(a,"dispose"),e&&b.VR&&b.VR(e),c&&(B(c).remove(),a.hS=C),d&&(B(d).remove(),a.iS=C)}},fa.mS=7,fa}(),i=function(){function a(a){this.kj=a,this.jS=new x}function b(a){a.zR().forEach(function(a){a.dynamicMove()?jb(a):nb(a),a.dynamicSize()?wb(a):ob(a)})}function c(a,b,c){var d,e,f,g,h,i,j,k=a.kj,l=k.it(c),m=0,n=0,p=0,q=0;return l&&l.length>0&&(d=l[0],e=l[l.length-1],m=d.x,p=e.x+e[W]-m),f=k.jt(b),f&&f.length>0&&(g=f[0],h=f[f.length-1],n=g.y,q=h.y+h[X]-n),i=k.am(),j=i.Ft(b,c),j.getIntersect(m,n,p,q)||new o(0,0,0,0)}function d(a,c,d,e){var f,g,h,i,j,k,l,m,n=a,o=n.kj,p=new x,q=o.wr;return q.isNeedToUpdateLayout&&(b(q),q.isNeedToUpdateLayout=!1),f=o.am(),g=o.ss,h=o.it(d),i=o.jt(c),h.length<=0||i.length<=0?p:(j=h[0],k=h[h.length-1],l=i[0],m=i[i.length-1],q.zR().forEach(function(a){var b,c,d,n,o,q,r,s,t,u,v,w,x;if(a&&a.isVisible()){if(a.fixedPosition())d=a.position(),b=d.x*e+f.kt,c=d.y*e+f.nt;else{if(b=0,n=a[_](),o=h.findCol(n),o)b=o.x;else if(n<j.col)for(b=j.x,q=j.col-1;q>=n;q--)b-=g._m(q);else for(b=k.x+k[W],r=k.col+1;r<=n;r++)b+=g._m(r);if(b+=a[aa]()*e,c=0,s=a[Z](),t=i.findRow(s),t)c=t.y;else if(s<l.row)for(c=l.y,u=l.row-1;u>=s;u--)c-=g.Sl(u);else for(c=m.y+m[X],v=m.row+1;v<=s;v++)c+=g.Sl(v);c+=a[$]()*e}w=F(a[W]()*e),x=F(a[X]()*e),p.push({name:a.name(),x:b,y:c,width:w,height:x})}}),p)}return a.prototype={no:function(){var a=this.jS;a.each(function(a){a.no()}),a.empty()},yl:function(a,b,e){var f,g,i,j,k,l,m,n,p,q;if(!(a<0||b<0)){for(f=this,g=f.kj,i=f.jS,j=g.wr,k=d(f,a,b,e),l=[],i.each(function(a){k.find(a.name)||l.push(a)}),m=0,n=l.length;m<n;m++)p=l[m],p.gS=C,i.remove(p.name),p.no();q=g.parent&&g.parent.options.useTouchLayout,h.mS=q?11:7,k.each(function(d){var e,k,l,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B=j.NR(d.name),C=F(h.mS/2+1);B&&"function"==typeof B.borderWidth&&(e=B.borderWidth(),k=B.borderStyle(),B.nS(k)||(e=0),e>C&&(C=e)),l=c(f,a,b),m=1,n=d.x-C-m,p=d.y-C-m,q=d[W]+2*C+2*m,r=d[X]+2*C+2*m,s=G(l.y,p),t=G(l.x,n),u=r,v=q,w=C,x=C,y=-1*C-m,w=p-s+w,x=n-t+x,w<=0?(u+=w,u+=y):w<C&&w>0&&(u-=C-w),x<=0?(v+=x,v+=y):x<C&&x>0&&(v-=C-x),z=i.find(d.name),z||(z=new h(j.NR(d.name),g),z.gS=f,i.push(z)),z._R=d,z.WE=a,z.aS=b,A=new o(l.x,l.y,l[W],l[X]),z.yl(new o(t,s,v,u).getIntersectRect(A)||new o(t,s,0,0),new o(x,w,d[W],d[X]))})}}},a}(),j={FloatingObject:g,FloatingObjectCollection:vb,tS:h,uS:gb,vS:fb,wS:eb},B.extend(j,n),a.exports=j},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){var d,e,f,g,h,i,j,k,l=c(2),m=c(3),n=l.GC$,o=l.Commands,p=m.k.ac,q=o.ActionBase,r=null,s=void 0,t=Math.min,u="unSelectAllFloatingObjects",v="deleteFloatingObjects",w="navigationNextFloatingObject",x="navigationPreviousFloatingObject",y="cutFloatingObjects",z="copyFloatingObjects",A="pasteFloatingObjects",B="dragCopyFloatingObjects",C="selectAllFloatingObjects",D="moveFloatingObjects",E="moveFloatingObjectsUp",F="moveFloatingObjectsDown",G="moveFloatingObjectsLeft",H="moveFloatingObjectsRight",I="resizeFloatingObjects",J="isSelected",K="name",L=o.h4;function M(a){var b=a.wr,c=!1;return b&&b.zR().forEach(function(a){a&&a[J]()&&(c=!0)}),c}d=function(a){n.inherit(b,a);function b(){a.call(this)}var c={init:function(a,b){var c=this;c.kj=a,c.VQ=b,b.yS=b.yS||[]},canExecute:function(){return!!M(this.kj)},canUndo:function(){var a=this.VQ.yS;return!!(a&&p(a)>0)},saveState:function(){var a,b,c,d,e=this,f=e.VQ.floatingObjects;if(f instanceof Array)for(a=e.kj.wr,b=0,c=p(f);b<c;b++)d=a.NR(f[b]),d&&e.VQ.yS.push(d)}};return n.extend(b.prototype,c),b}(q),e=function(a){n.inherit(b,a);function b(b,c){a.call(this),this.init(b,c)}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g=this,h=!1,i=g.kj,j=g.VQ,k=j.floatingObjects;if(g.canExecute()&&k instanceof Array){for(g.saveState(),g.Lz(i,!0),a=i.wr,b=0,c=p(k);b<c;b++)d=a.NR(k[b]),d&&(e=i.slicers,g.zS(d)&&e&&e.remove(d[K]()),f=a.Fb(k[b],!0),f||(j.yS[b]=s),d[J](!1));i.GJ(),g.Mz(i,!0),h=p(k)>0}return h},undo:function(){var a,b,c,d,e,f=this,g=f.VQ,h=g.yS,i=f.kj;if(f.canUndo()){for(f.Lz(i,!0),a=i.wr,b=0,c=p(h);b<c;b++)d=h[b],d&&(d[J](!0),a.Sb(d),e=i.slicers,f.zS(d)&&e&&e.Cz(d),d.position(g.AS[d[K]()]));return i.EJ(),h.length=0,f.Mz(i,!0),!0}return!1},init:function(b,c){a.prototype.init.call(this,b,c),c.AS=c.AS||{}},zS:function(a){return a&&"Slicer"===a.typeName},saveState:function(){var b,c,d,e,f,g,h;if(a.prototype.saveState.call(this),b=this,c=b.kj,d=b.VQ.floatingObjects,d instanceof Array)for(e=c.wr,f=0,g=p(d);f<g;f++)h=e.NR(d[f]),h&&h.position()&&(b.VQ.AS[h[K]()]=h.position())}};return n.extend(b.prototype,c),b}(d),f=function(a){n.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={constructor:b,canExecute:function(){return!0},execute:function(){var a,b,c,d,e,f=this,g=!1,h=f.VQ,i=h.floatingObjects,j=f.kj;if(f.canExecute()&&i instanceof Array){for(f.saveState(),f.Lz(j,!0),a=j.wr,b=0,c=p(i);b<c;b++)d=a.NR(i[b]),e=d.position(),d.position(new l.Point(e.x+h.offsetX,e.y+h.offsetY));f.Mz(j,!0),g=p(i)>0}return g},undo:function(){var a,b,c,d,e=this,f=e.VQ.yS,g=e.kj;if(e.canUndo()){for(e.Lz(g,!0),a=0,b=p(f);a<b;a++)c=f[a],d=c.position(),c.position(new l.Point(d.x-e.VQ.offsetX,d.y-e.VQ.offsetY));return f.length=0,e.Mz(g,!0),!0}return!1}};return n.extend(b.prototype,c),b}(d),
g=function(a){n.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={execute:function(){var a,b,c,d,e,f=this,g=!1,h=f.VQ,i=h.floatingObjects,j=f.kj;if(f.canExecute()&&i instanceof Array){for(f.saveState(),f.Lz(j,!0),a=j.wr,b=0,c=p(i);b<c;b++)d=a.NR(i[b]),e=d.position(),d.width(d.width()+h.offsetWidth),d.height(d.height()+h.offsetHeight),d.position(new l.Point(e.x+h.offsetX,e.y+h.offsetY));f.Mz(j,!0),g=p(i)>0}return g},undo:function(){var a,b,c,d,e=this,f=e.VQ.yS,g=e.kj;if(e.canUndo()){for(e.Lz(g,!0),a=0,b=p(f);a<b;a++)c=f[a],d=c.position(),c.position(new l.Point(d.x-e.VQ.offsetX,d.y-e.VQ.offsetY)),c.width(c.width()-e.VQ.offsetWidth),c.height(c.height()-e.VQ.offsetHeight);return f.length=0,e.Mz(g,!0),!0}return!1}};return n.extend(b.prototype,c),b}(d),h=function(a){n.inherit(b,a);function b(){var b=this;a.call(b),b.kj=r}var c={canExecute:function(){var a=this,b=a.VQ.floatingObjects;return!!(p(b)>0&&a.ES(b))},canUndo:function(){var a=this.VQ.DS;return!!(a&&p(a)>0)},ES:function(a){var b,c,d,e=this,f=e.kj,g=f.wr;for(b=0,c=p(a);b<c;b++)if(d=g.NR(a[b]),d&&!f.ER(d))return!1;return!0},zS:function(a){return a&&"Slicer"===a.typeName}};return n.extend(b.prototype,c),b}(q),i=function(a){n.inherit(b,a);function b(b,c){var d=this;a.call(d),d.OFFSET=15,d.kj=b,d.VQ=c,c.DS=c.DS||[],c.f6=c.f6||[]}var c={execute:function(){var a,b,c,d,e,f,g,h,i,j,k,m,n,o,q,r,s,u,v,w,x,y,z,A,B=this,C=B.VQ,D=C.floatingObjects;if(B.canExecute()){for(a=B.kj,b=C.fromSheet,B.Lz(a,!0),c=C.f6,d=a.wr,void 0===C.Jl&&(M(a)&&d.zR().forEach(function(a){a&&a[J]()&&c.push(a)}),C.Jl=B.kj.getActiveRowIndex(),C.GS=B.kj.getActiveColumnIndex()),M(a)&&d.zR().forEach(function(a){a&&a[J]()&&a[J](!1)}),e=[],h=Number.MAX_VALUE,i=h,j=h,k=[],f=0,g=p(D);f<g;f++)m=b.CR.find(D[f]).position(),i=t(i,m.x),j=t(j,m.y),k.push(new l.Point(m.x-i,m.y-j));if(n=0,o=0,c.length)q=h,r=h,c.forEach(function(a){if(a){var b=a.position();q=t(q,b.x),r=t(r,b.y)}}),n=q<h?q+B.OFFSET:0,o=r<h?r+B.OFFSET:0;else{for(s=0;s<C.Jl;s++)o+=a.Yr(s,3);for(u=0;u<C.GS;u++)n+=a.$r(u,3)}for(f=0,g=p(D);f<g;f++)v=k[f],e.push(new l.Point(n+v.x,o+v.y));for(w=C.isCutting,x=b.wr,f=0,g=p(D);f<g;f++)A=b.CR.find(D[f]),w&&!x.NR(D[f])?(y=A,y.sheet(a)):(y=A.clone(a),z=B.zS(y)?a.slicers.HS(y[K]()):d.FS()),z&&y[K](z),B.zS(y)&&(a.slicers.Cz(y),y.width(A.width()),y.height(A.height())),y.isVisible(!0),y.position(e[f]),y[J](!0),d.Sb(y),C.DS.push(y);return B.Mz(a,!0),!0}return!1},undo:function(){var a,b,c,d,e,f,g,h=this,i=h.VQ,j=i.DS;if(h.canUndo()){for(a=h.kj,b=a.wr,h.Lz(a,!0),c=0,d=p(j);c<d;c++)e=j[c],f=a.slicers,h.zS(e)&&f&&f.remove(e[K]()),b.Fb(e[K](),!0);return j.length=0,g=i.f6,g.forEach(function(a){a[J](!0)}),h.Mz(a,!0),!0}return!1}};return n.extend(b.prototype,c),b}(h),j=function(a){n.inherit(b,a);function b(a,b){var c=this;c.kj=a,c.VQ=b,b.DS=b.DS||[]}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g,h,i=this,j=!1,k=i.VQ,m=k.floatingObjects,n=i.kj;if(i.canExecute()){for(i.Lz(n,!0),a=n.wr,b=0,c=p(m);b<c;b++)d=a.NR(m[b]),d&&(e=d.clone(n),f=d.position(),e.position(new l.Point(f.x+k.offsetX,f.y+k.offsetY)),e[K](a.FS()),e[J](!0),d[J](!1),i.zS(e)&&n.slicers&&(g=e,h=n.slicers.HS(g.columnName()),g[K](h),n.slicers.Cz(g)),a.Sb(e),k.DS.push(e));i.Mz(n,!0),j=!0}return j},undo:function(){var a,b,c,d,e,f,g=this,h=g.VQ,i=h.DS,j=g.kj;if(g.canUndo()){for(g.Lz(j,!0),a=j.wr,b=0,c=p(i);b<c;b++)d=i[b][K](),e=j.slicers,f=a.NR(d),g.zS(f)&&e&&e.remove(d),a.Fb(d,!0);return i.length=0,g.Mz(j,!0),!0}return!1}};return n.extend(b.prototype,c),b}(h);function N(a){var b=[];return a.wr.zR().forEach(function(a){a[J]()&&b.push(a[K]())}),b}function O(a,b,c){var d,e,f,g,h=a.BR(),i=h.fromSheet;for(h.fromSheet=a,h.isCutting=c,d=new k,e=0,f=0;f<p(b);f++)g=a.wr.NR(b[f]),g&&(d.push(g),e++);return i&&(i.CR=r),a.CR=d,e>0}o[u]={canUndo:!1,execute:function(a,b){var c=o.bT(a,b);return!!M(c)&&(c.suspendPaint(),c.uQ(),c.GJ(),c.resumePaint(),!0)}},o[C]={canUndo:!1,execute:function(a,b){var c=o.bT(a,b);c.suspendPaint(),c.wr.zR().forEach(function(a){a[J](!0)}),c.resumePaint()}},o[v]={canUndo:!0,execute:function(a,b,c){var d,f;return b.floatingObjects?L(a,e,b,c):(d=a.sheets?a.getActiveSheet():a,f=N(d),p(f)>0?d.wu().execute({cmd:v,sheetName:d.name(),floatingObjects:f}):void 0)}},o[w]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i,j=o.bT(a,b);if(M(j)){for(j.suspendPaint(),g=j.wr.zR(),h=g.length,f=0;f<h;f++){if(i=g[f],d||(d=i),c){e=i;break}i&&i[J]()&&(c=i)}return j.uQ(),e||(e=d),e&&e[J](!0),j.resumePaint(),!0}return!1}},o[x]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i=o.bT(a,b);if(M(i)){for(i.suspendPaint(),f=i.wr.zR(),g=f.length,e=0;e<g;e++)if(h=f[e],c||(c=h),c[J]())d=h;else if(h[J]()||(d=h),h[J]())break;return i.uQ(),d[J](!0),i.resumePaint(),!0}return!1}},o[y]={canUndo:!1,execute:function(a,b){var c,d=o.bT(a,b),e=[];return d.wr.zR().forEach(function(a){a[J]()&&e.push(a[K]())}),p(e)>0&&(O(d,e,!0),c={cmd:v,sheetName:d.name(),floatingObjects:e},d.wu().execute(c))}},o[z]={canUndo:!1,execute:function(a,b){var c=o.bT(a,b),d=[];return c.wr.zR().forEach(function(a){a[J]()&&d.push(a[K]())}),O(c,d,!1)}},o[A]={canUndo:!0,execute:function(a,b,c){var d,e,f,g,h;if(b.floatingObjects)return L(a,i,b,c);if(d=o.bT(a,b),!d.isEditing()&&(e=d.BR(),f=e.fromSheet,g=f&&f.CR)){if(h=[],g.each(function(a){h.push(a[K]())}),0===p(h))return!1;if(!d.Js)return d.wu().execute({cmd:A,sheetName:d.name(),floatingObjects:h,fromSheet:f,isCutting:e.isCutting})}}},o[B]={canUndo:!0,execute:function(a,b,c){return L(a,j,b,c)}};function P(a){return function(b,c){var d,e,f=o.bT(b,c),g=0;return 0===a?g=-1:2===a&&(g=1),d=0,1===a?d=-1:3===a&&(d=1),e=N(f),p(e)>0&&f.wu().execute({cmd:D,sheetName:f.name(),floatingObjects:e,offsetX:g,offsetY:d})}}o[G]=P(0),o[E]=P(1),o[H]=P(2),o[F]=P(3),o[D]={canUndo:!0,execute:function(a,b,c){return L(a,f,b,c)}},o[I]={canUndo:!0,execute:function(a,b,c){return L(a,g,b,c)}},o.JR=function(a){var b=l.Ul.sl(),c=!b,d=b;a.register(u,o[u],27,!1,!1,!1,!1),a.register(C,o[C],65,c,!1,!1,d),a.register(v,o[v],46,!1,!1,!1,!1),a.register(w,o[w],9,!1,!1,!1,!1),a.register(x,o[x],9,!1,!0,!1,!1),a.register(y,o[y],88,c,!1,!1,d),a.register(z,o[z],67,c,!1,!1,d),a.register(B,o[B]),a.register(A,o[A],86,c,!1,!1,d),a.register(D,o[D]),a.register(E,o[E],38,!1,!1,!1,!1),a.register(F,o[F],40,!1,!1,!1,!1),a.register(G,o[G],37,!1,!1,!1,!1),a.register(H,o[H],39,!1,!1,!1,!1),a.register(I,o[I])},k=function(){function a(a){return"string"==typeof a[K]?a[K]:a[K]()}function b(){this.rM={}}return b.prototype={push:function(b){this.rM[a(b)]=b},remove:function(a){delete this.rM[a]},find:function(a){return this.rM[a]},empty:function(){delete this.rM,this.rM={}},each:function(a){var b,c=this.rM;for(b in c)c.hasOwnProperty(b)&&a(c[b])},isEmpty:function(){var a,b=this.rM;for(a in b)if(b.hasOwnProperty(a))return!1;return!0}},b}(),a.exports={yR:k,FloatingObjectUndoActionBase:d,DeleteFloatingObjectUndoAction:e,MovingFloatingObjectUndoAction:f,ResizingFloatingObjectUndoAction:g,FloatingObjectCopyPasteUndoAction:h,ClipboardPasteFloatingObjectUndoAction:i,DragCopyFloatingObjectUndoAction:j}},function(a,b,c){var d=c(2),e=c(1),f=d.Ul.Nl,g=d.Ul.Pl,h=e.FloatingObject,i=e.vS,j=e.wS,k=e.uS,l=d.GC$,m=null,n=void 0,o=function(a){var b,c,e,h,o,p,q,r,s,t;l.inherit(v,a);function u(a){return"number"==typeof a&&!isNaN(a)}b="src",c="backColor",e="pictureStretch",h="borderRadius",o="borderWidth",p="borderStyle",q="borderColor",r=[b,c,h,o,p,q,e],s=[[b,n,function(a){var c=this;c.oS=!1,w(c),c.srccallback||(c.srccallback=k(b)),c.srccallback.call(c,a)}],[c,m,k(c)],[h,-1,k(h),u],[o,1,k(o),u],[p,"none",function(a){var b=this;b.nS(a)||b.borderWidth(0),b.bscallback||(b.bscallback=k(p)),b.bscallback.call(b,a)}],[q,m,k(q)],[e,0,k(e)]];function v(b,c,d,e,f,g){var h=this;a.call(h,b,d,e,f,g),h.typeName="1",h.bt=m,h.oS=!1,h.JS=!1,"string"==typeof c&&(h.JS=!f||!g,h.src(c))}function w(a){var b,c,e=a,f=e.src(),g=e.sheet();e.bt||(e.bt=new d.oo(function(){w(e)})),b=e.bt;try{b.ko(f)?(e.oS=!0,c=b.lo(f),e.KS=c.width,e.LS=c.height,e.JS&&(e.width(c.width,!0),e.height(c.height,!0),e.JS=!1),g&&g.repaint()):b.fo(f)}catch(a){}}return t={onPropertyChanged:function(a,b){var c,d=this;d.TR||(c=d.sheet(),this.Wq({sheet:c,sheetName:c?c.Cj:"",picture:d,propertyName:a}))},toJSON:function(){var b=this,c=a.prototype.toJSON.call(this);return j.call(b,r,c),delete c.content,c},fromJSON:function(b,c){if(b){var d=this;d.TR=!0,a.prototype.fromJSON.call(d,b,c),i.call(d,r,b,c),d.oS=!1,w(d),d.TR=n}},clone:function(){var a=new v,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a},getOriginalWidth:function(){return this.KS},getOriginalHeight:function(){return this.LS},nS:function(a){var b=["dotted","dashed","solid","double","groove","ridge","inset","outset"];return b.indexOf(a)>=0},WR:function(){var a=f("div");return l(a).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(a),a},Wq:function(a){var b,c=this.sheet();c&&(c.Wq(d.Events.PictureChanged,a),"isSelected"===a.propertyName&&(b={sheet:a.sheet,sheetName:a.sheetName,picture:a.picture},c.Wq(d.Events.PictureSelectionChanged,b)))}},l.each(s,function(a,b){t[b[0]]=g(b[0],b[1],b[2],b[3])}),l.extend(v.prototype,t),v}(h);e.Picture=o,a.exports=e},function(a,b,c){var d=c(7);d&&!function(){var a=c(2),b=a.GC$,e=b.extend,f=a.Ul.nl,g=d.jR,h=d.kR;function i(a,b,c){var d,e,f=this;f.yM=new g(f),f.DQ=new h(a,"FL_"+b.name,f.yM,2,200),f.BQ=c,f.CQ=new j(a,b),d=f.CQ,e=f.DQ,e._M=function(){return b.YR.isSelected()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(i.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function j(a,b){var c=this;c.MS=b,c.YR=b.YR,c.NS=a,c.hQ=new d.TP(b.kj)}e(j.prototype,{OS:function(a){var c,e=new d.oP(a.X,a.Y),f=b(this.NS).offset();return f&&(c=document.body,e.X+=f.left+c.clientLeft||0,e.Y+=f.top+c.clientTop||0),e},jQ:function(a){a.DO=35},lQ:function(a){var b=this,c=b.OS(a.rN);b.MS.AD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},pQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?(e.mm.O3=!1,c.MS.rS(),c.hQ.PP(d)):(b=c.OS(a.rN),c.MS.BD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},qQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?c.hQ.SP(d):(b=c.OS(a.rN),this.MS.CD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},sQ:function(){var b,c;try{b=this,c=b.MS.kj,c.suspendPaint(),b.YR.isSelected()||(c.uQ(),b.YR.isSelected(!0),a.Vl.Zl(c)),c.clearSelection()}finally{c.resumePaint()}}}),c(1).tS.$n("touch",{init:function(a){var b=this,c=b.wR=new i(a,b,b.kj.parent.BQ);c.EQ()},dispose:function(){var a=this.wR;a&&a.FQ()},preProcessMouseDown:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.IQ(b)&&(f(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.HQ(b)&&(f(b),a.r=!0)}})}()},function(a,b){a.exports=GC.Spread.Sheets.Touch},function(a,b){a.exports={Exp_FloatingObjectHasSameNameError:"The current worksheet already has a floating object with the same name.",Exp_FloatingObjectNameEmptyError:"Floating object must have name"}}]);
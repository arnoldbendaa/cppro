/*!
 * 
 * Spread.Sheets Library 11.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Bindings=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b,d,e,f={};c(1),b=c(3),g(f,b),d=c(5),g(f,d),e=c(6),g(f,e),f.SR={},f.SR.en=c(7),a.exports=f;function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}}()},function(a,b,c){!function(){"use strict";var a,b,d,e,f,g,h,i,j,k,l,m;function n(a){return a.nq()}function o(a,b,c){"string"==typeof c&&(c={name:c}),n(a).Kp(b,c);var d=c&&c.formatter,e=c&&c.cellType;d&&a.setFormatter&&a.setFormatter(-1,b,d),e&&a.setCellType(-1,b,e),c&&c.width&&a.setColumnWidth(b,c.width)}a=c(2),b=c(3).qL,d=a.j.Fa,e=c(4),f=e.Worksheet,g=e.GC$.isEmptyObject,h=f.prototype,i=null,j="bindingPath",k=a.l,l={getDataSource:function(){var a=this.wq;return a?a.getSource():i},setDataSource:function(a,c){var d,f,g,h,i,j=this,k=j.wq;if(k&&k.getSource()!==a){if(c&&j.vs(),a){if(k=j.wq,d=k.bind(a),!d&&(j.setRowCountCore(k.getRowCount()),j.autoGenerateColumns&&(j.setColumnCount(k.getColumnCount()),f=n(j),g=k.rL())))for(h=0,i=g.length;h<i;h++)f.Kp(h,{name:g[h]})}else j.wq=new b(j);j.clearPendingChanges(),e.X3&&j.recalcAll(),j.$p()}},bindColumn:function(a,b){var c=this;c.suspendPaint();try{o(c,a,b)}finally{c.resumePaint()}},bindColumns:function(a){var b,c,d=this;d.suspendPaint();try{if(a)for(b=a.length,isNaN(b)||d.setColumnCount(b),c=0;c<b;c++)o(d,c,a[c])}finally{d.resumePaint()}},getDataItem:function(a){var b,c,d,e,f,g,h=this,j=h.wq,k=n(h);if(!j||0===j.getRowCount())return i;if(b=h.getColumnCount(),c={},d=j.ru(a))for(e in d)d.hasOwnProperty(e)&&"function"!=typeof e&&(c[e]=d[e]);for(f=0;f<b;f++)g=k.Jp(f),g&&g.name&&g.name.length>0&&!c[g.name]&&(c[g.name]=h.getValue(a,f));return c},getDataColumnName:function(a){var b,c=this;return 0<=a&&a<c.getColumnCount()&&c.getDataSource()?(b=n(c).Jp(a),b&&(b.displayName||b.name)):i},getBindingPath:function(a,b){var c=this.Mp();return c.getValueForKey(a,b,j)},setBindingPath:function(a,b,c){var d=this,e=d.Mp();return e.setValueForKey(a,b,j,c),d.$p(),d}},e.GC$.extend(h,l),m=e.CellRange,m.prototype.bindingPath=m.Pl(h.getBindingPath,h.setBindingPath);function p(a,b,c,e){var f,g,h,i,j=a.wq;for(f=0;f<c;f++)for(g=0;g<e;g++)h=j.getValue(f,g).value,d(h)||(i=h,k.Ska(h)&&(i=k.Daa(h)),a.qI(b,f,g,i))}function q(a,b,c,e){var f,g,h,i,j,k=a.nq().Hp(),l=a.options.colHeaderAutoTextIndex;for(f=0;f<c;f++)if(l>=0&&f===l||l===-1&&f===c-1)for(g=0;g<e;g++)h=b[f]&&b[f][g]&&b[f][g].value,i=k[g],d(h)&&i&&(j=i.displayName||i.name,j&&a.qI(b,f,g,j))}f.$n("binding",{init:function(){var a=this;a.autoGenerateColumns=!0,a.wq=new b(a)},dispose:function(a){var b=this;a!==!1&&(b.wq=i)},onLayoutChanged:function(a){var b,c,d,e,f,g,h,j=this,k=a.changeType,l=a.row,m=a.rowCount,n=a.sheetArea,o=j.wq;if("addingRows"===k)o&&o.sL()===!1?a.canAdd=!1:o&&o.tL()===!1&&(a.newRow=j.getRowCount());else if("addRows"===k)o&&o.uL(l,m);else if("deletingRows"===k){if(o)if(o.vL()===!1)a.canDelete=!1;else for(j.Ts||(j.Ts=[]),b=j.Ts,c=j.Mp(),d=o.getRowCount(),e=0;e<m&&l+e<c.getRowCount();e++)f=i,l+e<d&&(f=o.ru(l+e)),g=i,h=c.dataTable,h&&h[l+e]&&(g=h[l+e].key),b.push({row:l+e,data:f,key:g})}else"deleteRows"===k?o&&o.wL(l,m):"settingRowCount"===k&&(!o.getSource()||o.xL()||3!==n&&2!==n||(a.canSet=!1))},toJson:function(a,b){var c,d,e,f=this,h=f.getColumnCount(),i=f.getDataSource();b&&b.includeBindingSource&&i&&(c=a.data.dataTable||{},p(f,c,f.getRowCount(),h),g(c)||(a.data.dataTable=c),d=a.colHeaderData.dataTable||{},q(f,d,f.getRowCount(1),h),g(d)||(a.colHeaderData.dataTable=d)),e=f.autoGenerateColumns,e!==!0&&(a.autoGenerateColumns=f.autoGenerateColumns)},fromJson:function(a,c){var e,f,g,h,i=this;i.wq=new b(i),c&&(e=i.wq,f=a.dataSource,g=a.dataBinding,f&&e.bind(f),g&&e.fromJSON(g,c)),h=a.autoGenerateColumns,d(h)||(i.autoGenerateColumns=h)},preFromJson:function(){this.wq=new b(this)}})}()},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var b=c(4),d=c(2),e=b.GC$,f=e.isNumeric,g=d.j.Fa,h=b.Events,i={},j=null,k=void 0,l="string",m=i.yL={},n="cellBinding",o=function(){return d.C(i.SR)()};function p(a){this.xf=a}p.prototype={setValue:function(a,b){A(this.xf,a,b)},getValue:function(a){return B(this.xf,a)},getSource:function(){return this.xf}},i.CellBindingSource=p;function q(a){this.ad(a)}q.prototype={bind:function(a){var b,c,d,f,g=this,h=g.kj,i=g.Ou;if(i&&(i.lka&&(i.subscribe=i.lka,delete i.mka,delete i.lka),z(i.dispose)&&i.dispose()),g.zL(g.AL),g.zL(g.BL),g.ad(h),g.Ou=a,a){if(b=g.CL=w(a),!b)throw Error(o().Exp_NotSupportedDataSource);g.DL=g.EL(),h&&e[e.sd]({tc:h.parent}),h&&(c=g.AL,d=a.currentPosition,a.subscribe&&c.push(a.subscribe(g.FL,g)),d&&d.subscribe&&c.push(d.subscribe(g.GL,g)),z(a.subscribe)&&!a.lka&&(f=a.lka=a.subscribe,a.mka=!1,a.subscribe=function(b,c){var d=[].concat.apply([],arguments),e=function(){if(!a.mka&&z(b))return b.apply(c,arguments)};return d[0]=e,f.apply(a,d)}),g.Lx()),g.HL=x(a,b)}return s(h,a)},Lx:function(){var a,b,c,d,e,f=this,g=f.kj,h=f.Ou;if(g&&h&&(a=f.CL,f.zL(f.BL),b=j,a!==n&&(c=g.getActiveRowIndex(),h.currentPosition?(-1<=c&&c<h.count()&&h.currentPosition(c),b=h.currentItem()):b=f.ru(c)),b)){d=function(){g&&g.repaint()};for(e in b)b[e]&&z(b[e].subscribe)&&f.BL.push(b[e].subscribe(d,j,j))}},zL:function(a){var b,c;if(a)for(b=0;b<a.length;b++)c=a[b],c&&z(c.dispose)&&c.dispose()},getRowCount:function(){var a=this,b=a.Ou,c=a.CL,d=0;return b&&c&&c!==n&&(d=m[c].getDataLength(b)),d},getColumnCount:function(){var a,b,c,d=this.HL;return d?d.length:(a=this.Ou,a&&(b=a[0],c=e.getType(b),"null"===c||c===l||"number"===c)?1:0)},getSource:function(){return this.Ou},rL:function(){return this.HL},Nka:function(a){this.HL=a},ru:function(a){var b=this.Ou,c=this.CL,d=j;return b&&c&&c!==n&&(d=m[c].getDataItem(b,a)),d},EL:function(){var a,b,c,d=this;if(!d.DL)for(a=d.getRowCount(),b=0;b<a;b++)if(c=d.ru(b)){d.DL=c.entityAspect&&c.entityType||c.constructor;break}return d.DL},getValue:function(a,b){return u(this,a,b)},setValue:function(a,b,c){return v(this,a,b,c)},sL:function(){var a=m[this.CL];return a&&a.canAdd&&a.canAdd()},tL:function(){var a=m[this.CL];return a&&a.canInsert&&a.canInsert()},vL:function(){var a=m[this.CL];return a&&a.canRemove&&a.canRemove()},uL:function(a,b){var c,d,e=this,f=e.Ou;!f||a>e.getRowCount()||(c=e.CL,d=e.EL(),c&&c!==n&&!e.IL&&(e.JL=!0,m[c].addItems(f,a,b,d),e.JL=!1))},wL:function(a,b){var c=this,d=c.CL,e=c.getRowCount(),f=c.Ou;!f||a>=e||d&&d!==n&&!c.IL&&(c.JL=!0,m[d].removeItems(f,a,b),c.JL=!1)},xL:function(a){return y(a||this.Ou)},ad:function(a){var b=this;b.Ou=j,b.CL="",b.DL=j,b.HL=j,b.AL=[],b.BL=[],b.qia=j,b.kj=a,r(a)},FL:function(a){var b,c,d,e,f=this,h=f.kj;if(h&&!f.JL){if(a){if(f.IL=!0,!isNaN(a.length)&&(h.setRowCountCore(a.length),g(f.HL)&&0===t(h).Hp().length&&(f.HL=x(f.Ou),h.setColumnCount(f.getColumnCount()),b=t(h),c=f.rL())))for(d=0,e=c.length;d<e;d++)b.Kp(d,{name:c[d]});f.IL=!1}h.$p()}},GL:function(){var a,b=this,c=b.kj,d=b.Ou;c&&d&&d.currentPosition&&(a=d.currentPosition(),c.Jl!==a&&(c.Sr(a,c.Kl,k,k,2),c.$p()))},toJSON:function(){var a,b=this.Ou;return b?(a=this.CL,b=a===n?b.getSource():m[a].toJSON(b),{type:a,source:b}):j},fromJSON:function(a){var b,c,d=a&&a.source;d&&(b=a.type,c=b===n?new p(d):m[b].fromJSON(d),c&&this.bind(c))}},i.qL=q;function r(a){var b=a&&a.wq;b&&b.xL()&&a.Wq(h.ResetBinding,{sheet:a})}function s(a,b){var c=a&&a.wq;return!(!c||!c.xL(b))&&(a.clearPendingChanges(),a.Wq(h.InitBinding,{sheet:a,data:b}),!0)}function t(a){return a.nq()}function u(a,b,c){var d,e,f,g,h,i,k,l,o,p=a,q=p.Ou,r={value:j,hasBinding:!1};if(!q)return r;if(d=p.kj,e=p.CL,e===n){if(h=d?d.getBindingPath(b,c):j)return{value:q.getValue(h),hasBinding:!0}}else{if(b<0||a.getRowCount()<=b)return r;if(i=d?d.getColumnCount():a.getColumnCount(),c<0||i<=c)return r;if(d?(p.qia||(p.qia=t(d).Hp()),f=p.qia[c],f&&(g=f.name)):a.HL&&(g=a.HL[c]),e)return k=m[e],l=f&&f.value,o=z(l)?l:j,k.getValue(q,o,g,b,c)}return r}function v(a,b,c,d){var e,f,g,h,i,k,l,o,p,q=a,r=q.Ou,s=!1;if(!r)return s;if(e=q.kj,f=q.CL,f===n)i=e?e.getBindingPath(b,c):j,i&&(r.setValue(i,d),s=!0);else{if(b<0||a.getRowCount()<=b)return s;if(k=e?e.getColumnCount():a.getColumnCount(),c<0||k<=c)return s;e?(q.qia||(q.qia=t(e).Hp()),g=q.qia[c],g&&(h=g.name)):a.HL&&(h=a.HL[c]),f&&(l=m[f],o=g&&g.value,p=z(o)?o:j,s=l.setValue(r,p,h,b,c,d))}return s}function w(a){var b=j;return a&&(y(a)?b=n:e.each(m,function(c,d){if(d.isDataSource(a))return b=c,!1})),b}function x(a,b){return a&&b&&b!==n?m[b].getProperties(a):j}function y(a){return p&&a instanceof p}function z(a){return a instanceof Function}function A(a,b,c){var d,e,f,g;if(a&&b)for(d=b.split("."),e=d.length,f=0;f<e&&(g=d[f],a);f++)f===e-1?z(a[g])?a[g](c):a[g]=c:a=z(a[g])?a[g]():a[g]}i.KL=A;function B(a,b){var c,d,e,f;if(!a||!b)return j;c=b.split("."),d=c.length,e=0;do if(f=c[e],a=z(a[f])?a[f]():a[f],g(a))return j;while(++e<d);return a}i.LL=B;function C(){}C.prototype={isDataSource:function(a){return e.isArray(a)},getDataLength:function(a){return a.length},getDataItem:function(a,b){return a[b]},addItems:function(a,b,c,d){var e,f;for(e=0;e<c;e++)f=j,d&&(f=d.createEntity?d.createEntity():new d),a.splice(b,0,f)},removeItems:function(a,b,c){var d=this.getDataLength(a);b<d&&a.splice(b,Math.min(c,d-b))},getProperties:function(a){var b,c,d=a.length,e=j;if(d>0){e=[],b=a[0];for(c in b)z(b[c])||e.push(c)}return e},getValue:function(a,b,c,d,e){var h=j,i=!1,k=this.getDataItem(a,d);return g(k)||(b?(h=b(k),i=!0):c?(h=B(k,c),i=!0):(typeof k===l||f(k))&&0===e&&(h=k,i=!0)),{value:h,hasBinding:i}},setValue:function(a,b,c,d,e,h){var i=!1,j=this.getDataItem(a,d);return g(j)||(b?(b(j,h),i=!0):c?(A(j,c,h),i=!0):(typeof j===l||f(j))&&0===e&&(a[d]=h,i=!0)),i},fromJSON:function(a){return a},toJSON:function(a){return a}},m.defaultBindingSource=new C,a.exports=i}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b,c){!function(){"use strict";var b=c(2),d=c(3),e=b.j.Fa,f=null;function g(){}g.prototype={isDataSource:function(a){var b=window.wijmo;return b&&b.data&&b.data.isDataView&&b.data.isDataView(a)},getDataLength:function(a){return a.count()},getDataItem:function(a,b){return a.item(b)},addItems:function(a,b,c,d){if(d)for(var e=0;e<c;e++)a.mka=!0,a.add(d.createEntity?d.createEntity():new d),a.mka=!1,a.commitEdit()},removeItems:function(a,b,c){var d,e,f=this.getDataLength(a);if(b<f)for(d=Math.min(c,f-b),e=0;e<d;e++)a.remove(a.item(b))},getProperties:function(a){var b,c=0,d=f,e=a.getProperties();if(e&&e.length>0)for(c=e.length,d=[],b=0;b<c;b++)d.push(e[b].name);return d},canInsert:function(){return!1},getValue:function(a,b,c,d,g){var h=f,i=!1,j=this.getDataItem(a,d);return e(j)||(b?(h=b(j),i=!0):c&&(h=a.getProperty(j,c),i=!0)),{value:h,hasBinding:i}},setValue:function(a,b,c,d,f,g){var h=!1,i=this.getDataItem(a,d);return e(i)||(b?(b(i,g),h=!0):c&&(a.setProperty(i,c,g),h=!0)),h},fromJSON:function(a){return a},toJSON:function(a){return a.local}},d.yL.dataViewBinding=new g,a.exports=d}()},function(a,b,c){!function(){"use strict";var b,d=c(4),e=c(2),f=c(3),g=e.j.Fa,h=d.GC$,i=h.isFunction,j=h.getType,k=h.isNumeric,l=null,m="string",n=window.ko;function o(){}o.prototype={isDataSource:function(a){return n&&n.isObservable(a)},getDataLength:function(a){return a().length},getDataItem:function(a,b){return a()[b]},addItems:function(a,b,c,d){var e,f;for(e=0;e<c;e++)f=l,d&&(f=d.createEntity?d.createEntity():new d),a.splice(b,0,f)},removeItems:function(a,b,c){var d=this.getDataLength(a);b<d&&a.splice(b,Math.min(c,d-b))},getProperties:function(a){var b,c,d=a(),e=d.length,f=[];if(e>0){b=d[0];for(c in b)i(b[c])?n&&n.isObservable(b[c])&&f.push(c):f.push(c)}return f},getValue:function(a,b,c,d,e){var h=l,i=!1,n=this.getDataItem(a,d);return g(n)||(b?(h=b(n),i=!0):c?(h=f.LL(n,c),i=!0):(j(n)===m||k(n))&&0===e&&(h=n,i=!0)),{value:h,hasBinding:i}},setValue:function(a,b,c,d,e,h){var i=!1,l=this.getDataItem(a,d);return g(l)||(b?(b(l,h),i=!0):c?(f.KL(l,c,h),i=!0):(j(l)===m||k(l))&&0===e&&(a()[d]=h,i=!0)),i},fromJSON:function(a){return n?n.observableArray(a):l},toJSON:function(a){return a()}},f.yL.koBinding=new o,n&&(b=n.bindingHandlers,b["gc-spread-sheets"]=b["gcspread-sheets"]=b.wijspread={init:function(a,b,c,e){var f,g,i,j,k,l,n,o,p,q,r,s;if(!h(a).data("workbook")&&(f=b(),g=f&&f.sheets,i=new d.Workbook(h("#"+a.id)[0],f),g)){for(l=g.length,n=i.getSheetCount();n<l;)j=i.vv(i.wv(n)),i.ow(n,0,j),n=i.getSheetCount();for(o=0;o<l;o++)j=i.getSheet(o),k=g[o],p=k.name,q=k.autoGenerateColumns,r=k.data,s=k.columns,typeof p===m&&p.length>0&&(j.Cj=p),"boolean"==typeof q&&(j.autoGenerateColumns=q),r&&j.setDataSource(r),s&&s.length>0&&(j.autoGenerateColumns=!1,j.bindColumns(s))}},update:function(a,b,c,d){}}),a.exports=f}()},function(a,b){!function(){"use strict";a.exports={Exp_NotSupportedDataSource:"The data source is not supported!"}}()}]);
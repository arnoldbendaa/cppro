/*!
 * 
 * Spread.Sheets Library 11.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FloatingObjects=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);c(5),c(4),c(6),b.SR={},b.SR.en=c(8),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k=c(2),l=c(3),m=l.j.Fa,n=c(4),o=k.Rect,p=k.Point,q=k.Events,r=k.Rm,s=l.j.Ma,t=k.Ul,u=t.Pl,v=t.Ol,w=t.Nl,x=t.Rl,y=n.yR,z=document,A=l.D,B=function(){return l.C(a.exports.SR)()},C=k.GC$,D=null,E=void 0,F=Math.ceil,G=Math.floor,H=Math.max,I=Math.min,J=Math.abs,K="div",L="on",M="z-index",N="move",O="unselectable",P=1,Q="border",R=9007199254740992,S="floatingObjects",T=".gcFloatingObject",U="name",V="x",W="y",X="width",Y="height",Z="start",$=Z+"Row",_=Z+"RowOffset",aa=Z+"Column",ba=Z+"ColumnOffset",ca="end",da=ca+"Row",ea=ca+"RowOffset",fa=ca+"Column",ga=ca+"ColumnOffset",ha="isSelected",ia="isLocked",ja="isVisible",ka="canPrint",la="dynamicSize",ma="dynamicMove",na="fixedPosition",oa="allowResize",pa="allowMove",qa=700,ra=701,sa="position",ta="absolute",ua="background",va="gc-no-user-select",wa="gc-floatingobject-selected",xa="gc-floatingobject-unselected",ya="gc-floatingobject-resize-indicator-select",za="gc-floatingobject-resize-indicator-unSelect",Aa="gc-floatingobject-content-container",Ba="gc-floatingobject-container",Ca="gc-floatingobject-moving-container",Da="gc-floatingobject-moving-div",Ea=".gc-floatingobject-resize-indicator",Fa="gc-floatingobject-resize-indicator",Ga="gc-floatingobject-absolute",Ha="gc-floatingobject-top",Ia="gc-floatingobject-middle",Ja="gcfloatingobject-bottom",Ka="gc-floatingobject-left",La="gc-floatingobject-center",Ma="gc-floatingobject-right",Na="div."+Fa,Oa=Na+"."+Ha+"."+Ka,Pa=Na+"."+Ia+"."+Ka,Qa=Na+"."+Ja+"."+Ka,Ra=Na+"."+Ha+"."+La,Sa=Na+"."+Ja+"."+La,Ta=Na+"."+Ha+"."+Ma,Ua=Na+"."+Ia+"."+Ma,Va=Na+"."+Ja+"."+Ma,Wa="content",Xa="gc-no-user-select",Ya="100%",Za="gc-floatingobject-background-cover",$a=".fos",_a=function(){var a=this;a.uQ=function(){var a=this.wr;a&&a.zR().forEach(function(a){a.isSelected(!1)})},a.AR=function(){var a=this,b=a.wr;b&&(b.isNeedToUpdateLayout=!0)},a.BR=function(){var a=this,b=a.parent,c=a.tv,d=b&&b.tv;return c||(c=a.tv=d?d:{fromSheet:D,isCutting:!1}),c},a.ex=function(){var a=this,b=a.BR(),c=b&&b.fromSheet;c&&(c.CR=D),b.fromSheet=D,b.isCutting=!1},a.DR=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.ER=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.isPasteFloatingObject=function(){var a=this,b=a.BR().fromSheet,c=this.CR;return!c&&b&&(c=b.CR),c&&!c.isEmpty()}};_a.call(k.Worksheet.prototype);function ab(a){var b,c,d,e,f,g,h,i=a.FR;if(i){for(b=0,d=i.length;b<d;b++)if(f=i[b]){for(c=0,e=f.length;c<e;c++)g=f[c],g&&g.no();f.length=0}i.length=0,a.FR=D}h=a.wr,h&&h.no()}function bb(a,b,c){a.zR().forEach(function(a){a.rI(b,c)})}function cb(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){fb(b,-1,b+c-1,a.sheet().getColumnCount(),d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.GR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function db(a,b,c){a.zR().forEach(function(a){a.tI(b,c)})}function eb(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){fb(-1,b,a.sheet().getRowCount(),b+c-1,d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.HR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function fb(a,b,c,d,e){var f=e[$](),g=e[aa](),h=e[da](),i=e[fa]();return a<=f&&b<=g&&c>=h&&d>=i}function gb(a,b){var c=this;return b||(b={}),C.each(a,function(a,d){var e=c[d],f=e.call(c);e.isDefault(f)||(b[d]=f)}),b}function hb(a,b){if(b){var c=this;C.each(a,function(a,d){b[d]!==E&&c[d].call(c,b[d],!1)})}}function ib(a){var b=a;return function(a){var c=this,d=c.sheet();b===Wa&&(c.KR=!0),d&&d.$p(),c.onPropertyChanged(b,a)}}function jb(a){var b=a;return function(a){var c=this,d=c.sheet();d&&(lb(c),d.$p()),c.onPropertyChanged(b,a)}}function kb(a){var b=a;return function(a){var c=this,d=c.sheet();d&&(yb(c),d.$p()),c.onPropertyChanged(b,a)}}function lb(a){var b,c,d=a.sheet();function e(b,c,e,f,g){var h=0,i=b.call(a);return h=c.call(a,d,0,i),mb.call(a,b,e,f,!0,g),h+=e.call(a)}d&&(b=e(a[$],nb,a[_],d.getRowHeight,_),c=e(a[aa],ob,a[ba],d.getColumnWidth,ba),a.x()===c&&a.y()===b||(a.x(c,!1),a.y(b,!1),a.onPropertyChanged("location",new o(c,b,a[X](),a[Y]()))))}function mb(a,b,c,d,e){var f=this,g=b.call(f),h=c.call(f.sheet(),a.call(f),3),i=f.LR;h>0&&h--,g>h?(i[e]||(i[e]=g),b.call(f,h,!1)):i[e]&&(i[e]<h?(b.call(f,i[e],!1),i[e]=E):(d&&h<i[e]||!d&&g<i[e])&&b.call(f,h,!1))}function nb(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getRowHeight(e,3),!(f>d));e++);return f}function ob(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getColumnWidth(e,3),!(f>d));e++);return f}function pb(a){var b=a.sheet();function c(b,c,d,e,f){var g=rb(a,b,c),h=g.index;e.call(a,g.offset,!1),g.offset===-1&&(h+=1,e.call(a,0),h===f&&(h=f-1)),d.call(a,h,!1)}b&&(c(!0,a.y(),a[$],a[_],b.getRowCount()),c(!1,a.x(),a[aa],a[ba],b.getColumnCount()))}function qb(a){var b=a.sheet();function c(b,c,d,e){var f=rb(a,b,c);d.call(a,f.index,!1),e.call(a,f.offset,!1)}b&&(c(!0,a.y()+a[Y](),a[da],a[ea]),c(!1,a.x()+a[X](),a[fa],a[ga]))}function rb(a,b,c){var d,e=0,f=0,g=a.sheet(),h=b?g.getRowCount():g.getColumnCount(),i=0;for(i=0;i<h;i++){if(d=b?g.getRowHeight(i,3):g.getColumnWidth(i,3),e+=d,f=e-c,f>0){f=f>0?d-f:-1;break}if(0===f){f=0,i+=1;break}}return i>=h&&(i=h-1,f=0),{offset:f,index:i}}function sb(a,b){tb(b,ub(a))}function tb(a,b){a&&(a.style.zIndex=b+"")}function ub(a){var b=a.PR;return m(b)&&(b=a.Cka),b}function vb(a,b){a.PR=b,a.qo.forEach(function(a){for(var c=a.parentElement;c.className.indexOf(Ba)===-1;)c=c.parentElement;tb(c,b)})}function wb(a,b){m(a.PR)&&(a.Cka+=b)}function xb(a,b){this.kj=a,this.g3=b}C.extend(xb.prototype,{add:function(a,b,c,d,e,f){var g=this,i;return"1"===g.g3?i=new h.Picture(a,b,c,d,e,f):"0"===g.g3&&(i=a),g.kj.wr.Sb(i),i},get:function(a){return this.kj.wr.NR(a)},remove:function(a){this.kj.wr.Fb(a)},clear:function(){return this.kj.wr.$b(this.g3)},all:function(){return this.kj.wr.zR(this.g3)},zIndex:function(a,b){return this.kj.wr.PR(a,b)}}),b=function(){function a(a){var c=this;c.sheet(a),b(c),c.QR={}}function b(a){var b=a.sheet();b&&(C(z.body).bind("scroll"+T,function(){var a=b.parent.getActiveSheet();a.wr&&b.QP(a.Dr())}),b.Fu(q.ColumnChanged+T,function(b,d){var e=d.propertyName;e!==X&&e!==ja||c(a)}),b.Fu(q.RowChanged+T,function(b,d){var e=d.propertyName;e!==Y&&e!==ja||c(a)}),b.Fu(q.ColumnWidthChanged+T,function(){c(a)}),b.Fu(q.RowHeightChanged+T,function(){c(a)}))}function c(a){var b=a.sheet();a.isNeedToUpdateLayout=!0,b.QP&&b.QP(b.Dr())}function d(a,b){if(a.QR[b])throw Error(B().Exp_FloatingObjectHasSameNameError)}function f(a,b,c){return c&&c.width>0&&c.height>0&&(c.x===a||c.y===b||c.contains(a,b))}var g={sheet:u("sheet",E),Dka:function(a){this.zR().forEach(function(b){wb(b,a)})},Sb:function(a){var b,c=this,e=c.sheet();if(e.suspendPaint(),b=a.name(),!b)throw Error(B().Exp_FloatingObjectNameEmptyError);d(c,b),c.Dka(-1),a.sheet(e),c.QR[b]=a,e.Zoa(a),e.resumePaint()},NR:function(a){return this.QR[a]},Fb:function(a,b){var c,d,e,f=this;return!!a&&(c=f.sheet(),d=f.NR(a),c.suspendPaint(),b?(e={sheet:c,sheetName:c.Cj,floatingObject:d,cancel:!1},c.Wq(q.FloatingObjectRemoving,e),e.cancel===!1&&(delete f.QR[a],c.Wq(q.FloatingObjectRemoved,{sheet:c,sheetName:c.Cj,floatingObject:d}))):delete f.QR[a],c.resumePaint(),!0)},U3:function(a,b){var c,e=this,f=e.sheet();if(f.suspendPaint(),!b)throw Error(B().Exp_FloatingObjectNameEmptyError);d(e,b),c=e.QR[a],delete e.QR[a],e.QR[b]=c,c.onNameChanged&&c.onNameChanged(a,b),f.resumePaint()},$b:function(a){var b=this,c=b.sheet();c.suspendPaint(),C.each(this.QR,function(c,d){a&&a!==d.g3||b.Fb(d.name())}),c.resumePaint()},zR:function(a){var b=[];return C.each(this.QR,function(c,d){a&&a!==d.g3||b.push(d)}),b},PR:function(a,b){var c=isNaN(b),d=this.NR(a);if(d){if(c)return ub(d);vb(d,b)}if(c)return-1},toJSON:function(){var a=[];return this.zR().forEach(function(b){var c,d;b instanceof e&&b.hga()&&(c=b.toJSON(),d=b.PR,isNaN(d)||(c.zIndex=d),a.push(c))}),a},fromJSON:function(a,b){var c,d,f,g,i,j,l,n=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)d=a[c],d&&(i=d.floatingObjectType,j=t.Ol(i)?i+"":d.typeName,g="0"===j?e:"1"===j?h.Picture:k.getTypeFromString(j),g&&(f=new g,f.fromJSON(d,b),n.Sb(f),l=d.zIndex,m(l)||(f.PR=l)))},no:function(){C(z.body).unbind("scroll"+T);var a=this.sheet();a&&(a.Gu(q.ColumnChanged+T),a.Gu(q.RowChanged+T),a.Gu(q.ColumnWidthChanged+T),a.Gu(q.RowHeightChanged+T))},hitTest:function(a,b){var c,d,e,g,h=this.sheet(),i=h.am(),j=D;if(i)for(c=0;c<=2;c++)for(d=0;d<=2;d++)if(e=i.Ft(c,d),e&&e.contains(a,b)&&(g=h.IR&&h.IR(c,d),g&&g.jS.each(function(c){var d=c.YR;d&&d.isVisible()&&h.DR(d)&&f(a,b,c.Tka)&&(j?ub(j.floatingObject)<ub(d)&&(j.floatingobject=d):j={x:a,y:b,floatingObject:d})}),j))return j;return j},FS:function(){for(var a="FloatingObject",b=1,c=a+(""+b);this.NR(c);)b++,c=a+(""+b);return c}};return C.extend(a.prototype,g),a}();function yb(a){var b,c,d=a.sheet();function e(b,c,e,f,g,h,i){var j,k,l=0,m=b.call(a),n=c.call(a);return l=e.call(a,d,m,n),j=l+f.call(d,n,3),0===j&&a.isVisible()&&(a.isVisible(!1,!1),a.RR=!1),m===n?(mb.call(a,c,h,f,!1,i),l=h.call(a)-g.call(a)):(k=f.call(d,m,3),k>0&&(l-=g.call(a)),mb.call(a,c,h,f,!1,i),l+=h.call(a)),l}d&&(a.RR===!1&&(a.isVisible(!0,!1),a.RR=!0),b=e(a[$],a[da],nb,d.getRowHeight,a[_],a[ea],ea),c=e(a[aa],a[fa],ob,d.getColumnWidth,a[ba],a[ga],ga),c<0&&(c=0),b<0&&(b=0),a[X]()!==c&&(a[X](c,!1),a.onPropertyChanged(X,c)),a[Y]()!==b&&(a[Y](b,!1),a.onPropertyChanged(Y,b)))}d=["dotted","dashed","solid","double","groove","ridge","inset","outset"];function zb(a){return d.indexOf(a)>=0}function Ab(a){var b,c,d;if(v(a)&&("string"!=typeof a||""===a))throw Error(B().Exp_FloatingObjectNameEmptyError);return b=this,a!==b.name()&&(c=b.sheet(),!c||(d=c.wr.NR(a),!d))}e=function(){var a,b=[U,V,W,X,Y,ka,ha,ia,ja,ma,la,na,oa,pa],c=[["sheet",D,function(){l(this)}],[U,E,function(a,b){var c,d,e=this,f=e.sheet();f&&(c=f.wr,d=c.NR(b),d===e&&c.U3(b,a)),e.onPropertyChanged("name",a)},Ab],[V,0,f(V,!1)],[W,0,f(W,!1)],[Y,0,f(Y,!0)],[X,0,f(X,!0)],[$,E,jb($)],[_,0,jb(_)],[aa,E,jb(aa)],[ba,0,jb(ba)],[da,E,kb(da)],[ea,0,kb(ea)],[fa,E,kb(fa)],[ga,0,kb(ga)],[ha,!1,ib(ha)],[ia,!0,e(ia)],[ka,!0,e(ka)],[ja,!0,ib(ja)],[ma,!0,function(a,b){e(ma).call(this,a,b)},function(a){return"boolean"==typeof a&&(a||this.dynamicSize(!1,!1),!this.fixedPosition())}],[la,!0,function(a,b){e(la).call(this,a,b)},function(a){return"boolean"==typeof a&&this.dynamicMove()&&!this.fixedPosition()}],[na,!1,function(a){var b=this;a&&(b.dynamicMove(!1,!1),b.dynamicSize(!1,!1)),b.onPropertyChanged(na,a)}],[oa,!0,ib(oa)],[pa,!0,ib(pa)]];function d(a,b,c,d,e){var f=this;f.LR={startRowOffset:E,startColumnOffset:E,endRowOffset:E,endColumnOffset:E},f.RR=!0,f.typeName="0",f.g3="0",f.name(a),f.x(b?b:0,!1),f.y(c?c:0,!1),f[X](d?d:0,!1),f[Y](e?e:0,!1),f.qo=[],f.KR=!1,f.Cka=qa}function e(a){return function(b){this.onPropertyChanged(a,b)}}function f(a,b){return function(c){var d=this,e=d.sheet();e&&(b&&i(d),j(d),r(d),e.$p()),d.onPropertyChanged(a,c)}}function g(a,b,c,d){var e=this,f=a.call(e),g=b.call(e);c<=f?e.dynamicMove()&&(a.call(e,f+d),b.call(e,g+d)):c<g&&e.dynamicSize()&&b.call(e,g+d)}function h(a,b,c,d,e,f,g){var h,i,j=this,k=a.call(j),l=c.call(j);e<=k?g<k?j.dynamicMove()&&(a.call(j,k-f),c.call(j,l-f)):g<l&&(h=g-k+1,i=l-k+1-h,j.dynamicMove()&&(a.call(j,e),b.call(j,0)),j.dynamicSize()&&c.call(j,e+i-1)):e<=l&&(g<l?j.dynamicSize()&&c.call(j,l-f):j.dynamicSize()&&(c.call(j,e),d.call(j,0)))}function i(a){var b=n(a,a[Y]()),c=o(a,a[X]());a[X]()>c&&a[X](c,!1),a[Y]()>b&&a[Y](b,!1)}function j(a){var b,c,d=a.x()+a[X](),e=o(a,d);d>e&&a.x(H(0,e-a[X]()),!1),a.x()<0&&a.x(0,!1),b=a.y()+a[Y](),c=n(a,b),b>c&&a.y(H(0,c-a[Y]()),!1),a.y()<0&&a.y(0,!1)}function l(a){var b,c,d,e;i(a),j(a),b=a[$](),c=a[aa](),b&&c?lb(a):pb(a),d=a[da](),e=a[fa](),d&&e?yb(a):qb(a)}function n(a,b){var c,d=a.sheet();return d?(c=d.getRowCount(),nb(d,0,c,b)):R}function o(a,b){var c,d=a.sheet();return d?(c=d.getColumnCount(),ob(d,0,c,b)):R}function r(a){pb(a),qb(a)}return a={constructor:d,position:function(a){var b=this,c=b.sheet();return 0===arguments.length?new p(b.x(),b.y()):(!s(a,p)||b.x()===a.x&&b.y()===a.y||(b.x(a.x,!1),b.y(a.y,!1),j(b),r(b),c&&c.$p(),b.onPropertyChanged("position",a)),b)},content:u(Wa,D,ib(Wa)),cloneContent:function(){var a,b,c=this.content();return c?(c.cloneNode?a=c.cloneNode(!0):(b=w(K),b.innerHTML=c.outerHTML,a=b.firstChild),C(a).removeAttr("id")[0]):D},refreshContent:function(a){var b,c,d,e,f,g,h=this;h.KR&&a&&(b=C(a),b.empty(),c=h.cloneContent(),d=Ya,e=Ya,f="",g="",c&&c.style&&(f=c.style.width,g=c.style.height),""!==f&&(d=f),""!==g&&(e=g),c!==D?(C(c).css({width:d,height:e}).addClass(Za).addClass(va).attr(O,L).appendTo(a),b.css(ua,"")):b.css(ua,"#044062"),h.KR=!1)},toJSON:function(){var a=this,c=gb.call(a,b);return c.typeName=a.typeName,c[Wa]=C(w(K)).append(a.cloneContent()).html(),c},fromJSON:function(a,c){var d,e;a&&(d=this,d.TR=!0,hb.call(this,b,a,c),r(d),a.content&&(e=w(K),e.innerHTML=a.content,d.content(C(e.firstChild)[0])),d.TR=E)},clone:function(){var a=this,b=k.getTypeFromString(a.typeName),c=b?new b:new d,e=JSON.stringify(a.toJSON());return c.fromJSON(JSON.parse(e)),c.content(a.cloneContent()),c},onPropertyChanged:function(a,b){var c,d=this;d.TR||(c=d.sheet(),d.Wq({sheet:c,sheetName:c?c.Cj:"",floatingObject:d,propertyName:a}))},Wq:function(a){var b,c=this.sheet();c&&(c.Wq(q.FloatingObjectChanged,a),a.propertyName===ha&&(b={sheet:a.sheet,sheetName:a.sheetName,floatingObject:a.floatingObject},c.Wq(q.FloatingObjectSelectionChanged,b)))},rI:function(a,b){var c=this;a=F(a),b=F(b),g.call(c,c[$],c[da],a,b)},GR:function(a,b){var c=this,d=a+b-1;h.call(c,c[$],c[_],c[da],c[ea],a,b,d)},tI:function(a,b){var c=this;a=F(a),b=F(b),g.call(c,c[aa],c[fa],a,b)},HR:function(a,b){var c,d=this;a=F(a),b=F(b),c=a+b-1,h.call(d,d[aa],d[ba],d[fa],d[ga],a,b,c)},getHost:function(a,b){var c,d,e=this.qo.concat();if(!m(a)&&!m(b)){for(c=0;c<e.length;c++)if(d=e[c],d.rowViewportIndex===a&&d.columnViewportIndex===b)return d;return D}return e},UR:function(a,b,c){var d=this.qo;a&&d.indexOf(a)<0&&(a.rowViewportIndex=b,a.columnViewportIndex=c,d.push(a))},VR:function(a){var b=this.qo,c=b.indexOf(a);c>=0&&b.splice(c,1)},WR:function(a,b){var c,d,e,f,g,h,i=w(K);return C(i).addClass(Xa).addClass(Aa).attr(O,L).css(sa,ta),c=this.cloneContent(),d=Ya,e=Ya,f="",g="",h=c&&c.style,h&&(f=h.width,g=h.height),""!==f&&(d=f),""!==g&&(e=g),c!==D&&C(c).css({width:d,height:e}).addClass(Za).addClass(Xa).attr(O,L).appendTo(i),this.UR(i,a,b),i},hga:function(){return!0},no:function(a){},Toa:function(){lb(this),yb(this)}},C.each(c,function(b,c){a[c[0]]=u(c[0],c[1],c[2],c[3])}),d.prototype=a,d}(),f=function(){var a=Z+"X",b=Z+"Y",c=Z+"Width",d=Z+"Height",e=ca+"X",f=ca+"Y",g=Z+"TopRow",h=Z+"LeftColumn",i="left",j="center",l="right",m="top",n=m+i,s=m+j,u=m+l,v="middle",y=v+i,B=v+l,F="bottom",R=F+i,S=F+j,U=F+l,V="-resize",W="cursor",_="mousemove",ba="mouseup";function ea(a,b){this.XR="";var c=this;c.YR=a,c.name=a?a.name():"",c.kj=b,c.RB=!1,c.ZR=!1}k.Zn(ea);function ga(e,f,g){var h=e.$R,i,j,k,l;switch(f){case n:i=I(h[a]+h[c],g.x),j=I(h[b]+h[d],g.y),k=J(g.x-h[a]-h[c]),l=J(g.y-h[b]-h[d]);break;case s:i=h[a],j=I(h[b]+h[d],g.y),k=h[c],l=J(g.y-h[b]-h[d]);break;case u:i=I(h[a],g.x),j=I(h[b]+h[d],g.y),k=J(g.x-h[a]),l=J(g.y-h[b]-h[d]);break;case y:i=I(h[a]+h[c],g.x),j=h[b],k=J(g.x-h[a]-h[c]),l=h[d];break;case B:i=I(h[a],g.x),j=h[b],k=J(g.x-h[a]),l=h[d];break;case R:i=I(h[a]+h[c],g.x),j=I(h[b],g.y),k=J(g.x-h[a]-h[c]),l=J(g.y-h[b]);break;case S:i=h[a],j=I(h[b],g.y),k=h[c],l=J(g.y-h[b]);break;case U:i=I(h[a],g.x),j=I(h[b],g.y),k=J(g.x-h[a]),l=J(g.y-h[b])}return new o(i,j,k,l)}function ha(a){var b=C(a),c=b.position();return new o(c.left,c.top,b[X](),b[Y]())}function ia(a,b,c,d,e,f){C(a).css([m,i,X,Y],[[d-1],[c-1],e,f]).addClass(Da).appendTo(b)}function ja(a,b){if(!a._R)return D;var c={inMoving:!1};return C(b.target).attr("resizeDirection")||(c.inMoving=!0),c}function ka(a){var b,c,d,e,f,g=a,h=g.kj,i=g.WE,j=g.aS,k=h.frozenTrailingRowCount(),l=h.frozenTrailingColumnCount(),m=h.am(),n=m.Ft(i,j),o=g.YR,p=o[$](),q=o[aa](),r=o[da](),s=o[fa](),t=h.frozenRowCount(),u=h.frozenColumnCount(),v=h.getRowCount(3)-k-1,w=h.getColumnCount(3)-l-1;return i===P?(t>0&&(b=h.getViewportTopRow(i),(p<t||b===t)&&(n.y-=m.fs,n[Y]+=m.fs)),k>0&&(c=h.getViewportBottomRow(i),r>v&&c===v&&(n[Y]+=m.gs))):i===P-1?(b=h.getViewportTopRow(i+1),(r>=b||b===t)&&(f=m.Ft(i+1,j),n[Y]+=f[Y])):i===P+1&&(c=h.getViewportBottomRow(i-1),(p<=c||c===v)&&(f=m.Ft(i-1,j),n.y=f.y,n[Y]+=f[Y])),j===P?(u>0&&(d=h.getViewportLeftColumn(j),(q<u||d===u)&&(n.x-=m.hs,n[X]+=m.hs)),h.frozenTrailingColumnCount()>0&&(e=h.getViewportRightColumn(j),(s>w||e===w)&&(n[X]+=m.js))):j===P-1?(d=h.getViewportLeftColumn(j+1),(s>=d||d===u)&&(f=m.Ft(i,j+1),n[X]+=f[X])):j===P+1&&(e=h.getViewportRightColumn(j-1),(q<=e||e===w)&&(f=m.Ft(i,j-1),n.x=f.x,n[X]+=f[X])),n}function la(a,b,c,d,e){var f=ha(a);C(a).css([m,i,X,Y],[f.y+c,f.x+b,f[X]+d,f[Y]+e])}function ma(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,q=a;if(q.bS){b=q.$F,c=ka(q),d=q.cS,e=q.$R,f=e.direction,b=new p(b.x-c.x,b.y-c.y),g=ga(q,f,b),e.endX=g.x,e.endY=g.y,e.endWidth=g[X],e.endHeight=g[Y],h=ha(d),i=g.y-h.y,j=g.x-h.x,k=g[X]-h[X],l=g[Y]-h[Y],la(d,j,i,k,l),m=q.dS;for(n in m)A(m,n)&&(o=m[n],la(o.moveResizeDiv,j,i,k,l))}}function na(a,b){var c,d=a.kj;d&&(c=d.RF(b),c===!1&&t.nl(b))}function oa(c){var d,i,j,k,l,m,n,o=c,p=o.kj,q=o.eS;if(q){if(d=x(p,q[g],p.getViewportTopRow(o.WE),!0),i=x(p,q[h],p.getViewportLeftColumn(o.aS),!1),j=q[e]-q[a]+(q[e]>q[a]?i:-1*i),k=q[f]-q[b]+(q[f]>q[b]?d:-1*d),0===j&&0===k)return;l=[],l.push(o.YR.name()),m=o.dS;for(n in m)A(m,n)&&l.push(n);p.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function pa(c){var d,i,j,k,l,m,n,o=c,p=o.kj,q=o.eS,r=p._zoomFactor;if(q){d=x(p,q[g],p.getViewportTopRow(o.WE),!0),i=x(p,q[h],p.getViewportLeftColumn(o.aS),!1),j=q[e]-q[a]+(q[e]>q[a]?i:-1*i),k=q[f]-q[b]+(q[f]>q[b]?d:-1*d),j/=r,k/=r,l=[],l.push(o.YR.name()),m=o.dS;for(n in m)A(m,n)&&l.push(n);p.wu().execute({cmd:"moveFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function Na(c){var d,i,j,k,l,m,n,o,p,q=c,r=q.kj,s=r._zoomFactor,t=q.YR,u=q.$R;if(u){d=x(r,u[g],r.getViewportTopRow(q.WE),!0),i=x(r,u[h],r.getViewportLeftColumn(q.aS),!1),j=u[e]-u[a]+(u[e]>u[a]?i:-1*i),j/=s,k=u[f]-u[b]+(u[f]>u[b]?d:-1*d),k/=s,l=(u.endWidth+i)/s-t[X](),m=(u.endHeight+d)/s-t[Y](),n=[],n.push(t.name()),o=q.dS;for(p in o)A(o,p)&&n.push(p);r.wu().execute({cmd:"resizeFloatingObjects",sheetName:r.name(),floatingObjects:n,offsetX:j,offsetY:k,offsetWidth:l,offsetHeight:m})}}function Wa(a,b,c){var d,e,f,g,h,i=a,j=i.cS;if(j){d=c.x-b.x,e=c.y-b.y,Xa(j,d,e),f=i.dS;for(g in f)A(f,g)&&(h=f[g],Xa(h.moveResizeDiv,d,e))}}function Xa(a,b,c){var d=C(a),e=C(a).position();d.css([m,i],[e[m]+c,e[i]+b])}function Ya(a){var b,c,d,e,f,g,h,i,j,k,l,m=a,n=m.eS;n&&(b=m.YR,c=m.kj,d=c.am(),e=d[X]-d.Br-d.zr,f=d[Y]-d.Cr-d.Ar,g=n.startX,h=n.startY,i=b.position().x,j=b.position().y,k=b[X](),l=b[Y](),i+n.endX-g<0&&(n.endX=g-i),j+n.endY-h<0&&(n.endY=h-j),i+k+n.endX-g>e&&(n.endX=e+g-i-k),j+l+n.endY-h>f&&(n.endY=f+h-j-l),n.startTopRow=c.getViewportTopRow(m.WE),n.startLeftColumn=c.getViewportLeftColumn(m.aS))}function Za(a){var b,c,d,e,f,g=a,h=g.$R;h&&(b=g.kj,c=b.am(),d=c[X]-c.Br-c.zr,e=c[Y]-c.Cr-c.Ar,f=new o(h.endX,h.endY,h.endWidth,h.endHeight),f=f.getIntersect(0,0,d,e),h.endX=f.x,h.endY=f.y,h.endWidth=f[X],h.endHeight=f[Y],h.startTopRow=b.getViewportTopRow(g.WE),h.startLeftColumn=b.getViewportLeftColumn(g.aS))}function $a(a){var b,c,d,e,f,g,h,i,j=w(K),k=C(j),l=a;return k.addClass(Ba).addClass(va).attr(O,L).css(M,qa).bind("mousedown",function(a){l.AD(a)}).bind(_,function(a){l.BD(a)}).bind(ba,function(a){l.CD(a)}),j.addEventListener("mousewheel",function(a){na(l,a)},!1),j.addEventListener("DOMMouseScroll",function(a){na(l,a)},!1),b=C(w(K)).addClass(Fa+" "+Ha+" "+Ka+" "+Ga),c=C(w(K)).addClass(Fa+" "+Ha+" "+La+" "+Ga),d=C(w(K)).addClass(Fa+" "+Ha+" "+Ma+" "+Ga),e=C(w(K)).addClass(Fa+" "+Ia+" "+Ka+" "+Ga),f=C(w(K)).addClass(Fa+" "+Ia+" "+Ma+" "+Ga),g=C(w(K)).addClass(Fa+" "+Ja+" "+Ka+" "+Ga),h=C(w(K)).addClass(Fa+" "+Ja+" "+La+" "+Ga),i=C(w(K)).addClass(Fa+" "+Ja+" "+Ma+" "+Ga),k.append(b).append(c).append(d).append(e).append(f).append(g).append(h).append(i),ea.ao(l,"init",j),j}function _a(a){var b,c,d,e,f,g,h,j,k=a,l=k.hS&&k._R;if(l&&!k.cS){b=k.iS=w(K),k.cS=w(K),k.dS={},k.gS.jS.each(function(a){var b,c=a.YR;c&&c.name()!==k.YR.name()&&c.isSelected()&&!k.dS[c.name()]&&(b=a._R,k.dS[c.name()]={offsetX:b.x-l.x,offsetY:b.y-l.y,height:b[Y],width:b[X],moveResizeDiv:w(K)})}),c=ka(k),d=C(b),d.css([M,m,i,X,Y,ua],[ra,c.y,c.x,c[X],c[Y],"rgba(255,255,255,0.01)"]).addClass(Ca).bind(_,function(a){k.BD(a)}).bind(ba,function(a){k.CD(a)}),e=l.y-c.y,f=l.x-c.x,ia(k.cS,b,f,e,l[X],l[Y]),g=k.dS;for(h in g)A(g,h)&&(j=g[h],ia(j.moveResizeDiv,k.iS,f+j.offsetX,e+j.offsetY,j[X],j[Y]));k.Ks&&C(k.Ks).append(k.iS)}}function ab(a){var b=a;b.RB||(C(z).bind(_+T,function(a){b.BD(a)}).bind(ba+T,function(a){b.CD(a)}),b.RB=!0)}function bb(a){var b=a;b.RB&&(b.RB=!1,C(z).unbind(_+T).unbind(ba+T))}function cb(a,b){var c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,t=C(Ea,b);t.removeClass(za),c=a,d=ha(c.hS),e=c.kS,f=c.YR,c.lS&&(e=c.lS),g=ea.mS,h=ha(e),i=h.x,j=h.y,k=d[Y]-h.y-h[Y],l=d[X]-h.x-h[X],m=0,o=g+2,p=G(g/2+1),"1"===f.typeName&&(q=f.borderWidth(),r=f.borderStyle(),zb(r)||(q=0),q>=p&&(m=q-p),k=d[Y]-j-h[Y]-q,l=d[X]-i-h[X]-q,i+=q,j+=q),i>0?(db(c,j>0,Oa,m,m,E,E,"nw"+V,n),db(c,d[Y]>0,Pa,m,(h[Y]-o)/2+j,E,E,"w"+V,y),db(c,k>0,Qa,m,E,E,m,"ne"+V,R)):(eb(c,Oa),eb(c,Pa),eb(c,Qa)),db(c,j>0,Ra,(h[X]-o)/2+i,m,E,E,"n"+V,s),db(c,k>0,Sa,(h[X]-o)/2+i,E,E,m,"n"+V,S),l>0?(db(c,j>0,Ta,E,m,m,E,"sw"+V,u),db(c,d[Y]>0,Ua,E,(h[Y]-o)/2+j,m,E,"w"+V,B),db(c,k>0,Va,E,E,m,m,"se"+V,U)):(eb(c,Ta),eb(c,Ua),eb(c,Va)),c.ZR=!0}function db(a,b,c,d,e,f,g,h,j){var k,n=a,o=C(c,n.hS);b?(k=ea.mS,o.css([i,m,l,F,X,Y,W],[d,e,f,g,k,k,h]).addClass(ya).attr("resizeDirection",j)):eb(n,c)}function eb(a,b){C(b,a.hS).removeClass(ya).addClass(za)}function fb(a,b){C(Ea,b).removeClass(ya).addClass(za),a.ZR=!1}function gb(a){var b,c,d,e,f,g=a,h=g.YR,i=h.src(),j=h.pictureStretch(),k=r.Om(h.sheet(),h.backColor()),l=g.kS;i&&l&&(b=C(l),g.XR!==i&&(g.XR=i,b.css([ua+"-image",ua+"-repeat"],["url('"+i+"')","no-repeat"])),b.css(ua+"-color",k),j!==D&&j!==E&&h.oS&&(c=h.getOriginalWidth(),d=h.getOriginalHeight(),e=b[X](),f=b[Y](),t.ql(l,e,f,c,d,j)))}function hb(a,b,c){var d,e,f,g,h=a.lS,j=a.YR,k=j.borderWidth(),n=j.borderStyle(),o=r.Om(j.sheet(),j.borderColor()),p=j.borderRadius(),q=0,s=G(ea.mS/2+1);zb(n)||(k=0),k<s&&(q=s-k),d=q,e=q,f=q,g=q,s=H(k,s),b.x<0?d+=b.x-s:(d+=b.x<s?b.x-s:0,g=c[X]-d-b[X]-2-2*k),b.y<0?e+=b.y-s:(e+=b.y<s?b.y-s:0,f=c[Y]-e-b[Y]-2-2*k),C(h).css([sa,i,m,F,l,Q+"-width",Q+"-style",Q+"-color",Q+"-radius"],[ta,d,e,f,g,k,n,o,p])}return ea.prototype={AD:function(a){var b,c,d,e,f,g,h,i,j,l,m=this,n=m.kj,o=m.YR,q=n.comments,r=m.WE,s=m.aS;if(n.ER(o)&&n.endEdit()&&(n.zt(!0),b={e:a,r:D},ea.ao(m,"preProcessMouseDown",b),!b.r)){if(0===a.button||2===a.button){if(c=o.isSelected(),a.ctrlKey||a.shiftKey?o.isSelected(!c):c||(n.uQ(),o.isSelected(!0)),c||k.Vl.Zl(n),q&&q.vQ(),n.EJ(),2===a.button)return;if(d=n.mm,e=n.Vs(),f=new p(a.pageX-e.left,a.pageY-e.top),g=ja(m,a),!o.allowMove()&&(!o.allowResize()||g.inMoving))return;m.$F=f,m.pS=!0,m.bS=g,g.inMoving?(h={},h.startTopRow=n.getViewportTopRow(r),h.startLeftColumn=n.getViewportLeftColumn(s),h.startX=f.x,h.startY=f.y,m.eS=h):(_a(m),i={},j=ha(m.cS),i.startX=j.x,i.startY=j.y,i.startWidth=j[X],i.startHeight=j[Y],i.startTopRow=n.getViewportTopRow(r),i.startLeftColumn=n.getViewportLeftColumn(s),i.cursor=a.target.style.cursor,i.direction=C(a.target).attr("resizeDirection"),m.$R=i),ab(m),l=n.hitTest(f.x,f.y),d.rG={KG:l.rowViewportIndex,MG:l.colViewportIndex,sG:l.hitTestType},d.$F=f,d.qG(),d.O3=!0}return!1}},BD:function(a){var b,c,d,e,f=this,g=f.kj,h=f.hS,i=f.iS;if(g.ER(f.YR)&&(b={e:a,r:D},ea.ao(f,"preProcessMouseMove",b),!b.r))return g.dG?(h&&C(h).css(W,"default"),!0):(c=g.mm,d=g.Vs(),e=new p(a.pageX-d.left,a.pageY-d.top),f.pS&&(f.bS.inMoving?(f.qS=!0,_a(f),Wa(f,f.$F,e),C(i).css(W,N)):f.YR.allowResize()&&(f.kv=!0,ma(f),C(i).css(W,f.$R[W])),(f.qS||f.kv)&&(f.$F=e,c.$F=e,c.NG(),C(z.body).addClass(va).attr(O,L))),!1)},CD:function(a){var b,c,d,e,f,g=this,h=g.kj,i=h.mm,j=g.YR,k=g.hS,l=g.bS;if(h.ER(j)&&(b={e:a,r:D},ea.ao(g,"preProcessMouseUp",b),!b.r))return h.dG?(C(k).css(W,N),!0):(i.O3=!1,i.RG(),c=h.Vs(),d=new p(a.pageX-c.left,a.pageY-c.top),e=g.eS,e&&(e.endX=d.x,e.endY=d.y),l&&(f=j.fixedPosition(),l.inMoving&&g.qS?(f&&Ya(g),a.ctrlKey?oa(g):pa(g)):g.kv&&(f&&Za(g),Na(g)),C(z.body).removeClass(va)),g.rS(),!1)},rS:function(){var a=this;a.$R=D,a.eS=D,a.dS=D,C(a.iS).remove(),a.cS=D,a.pS=!1,bb(a),a.qS=!1,a.kv=!1},YR:function(){return this.YR},yl:function(a,b){var c,d,e,f,g,h,j,k,l=this,n=l.YR,o=l.kj;if(n){if(c=!1,l.sS=a,d=l.hS,!d){if(a.width<=0||a.height<=0)return;d=l.hS=$a(l),sb(n,d),e=o.parent,e&&(f=l.Ks=e.xv(),f&&C(f).append(d))}g=l.kS,g||(g=l.kS=n.WR(l.WE,l.aS),"1"===n.typeName?(l.lS=w(K),C(l.lS).addClass(va+" "+Aa).attr(O,L),d.appendChild(l.lS),l.lS.appendChild(g)):(d.appendChild(g),c=!0)),l.lS&&(hb(l,b,a),b.x=0,b.y=0),h=C(g),j=n.isLocked()&&o.options.isProtected,C(d).css([m,i,X,Y],[a.y,a.x,a[X],a[Y]]),h.css([m,i,X,Y,W],[b.y,b.x,b[X],b[Y],j?"default":N]),l.Tka=a,n.refreshContent&&n.refreshContent(g),l.lS&&gb(l),n.isSelected()?(h.removeClass(xa).addClass(wa),n.allowResize()?cb(l,d):l.ZR&&fb(l,d)):(h.removeClass(wa).addClass(xa),fb(l,d)),c&&(k=g.firstChild,o.Wq(q.FloatingObjectLoaded,{sheet:o,sheetName:o.Cj,floatingObject:n,element:k}))}},no:function(){var a=this,b=a.YR,c=a.hS,d=a.iS,e=a.kS;ea.ao(a,"dispose"),e&&b.VR&&(b.VR(e),b.no(!1)),c&&(C(c).remove(),a.hS=D),d&&(C(d).remove(),a.iS=D)}},ea.mS=7,ea}(),g=function(){function a(a){this.kj=a,this.jS=new y}function b(a){a.zR().forEach(function(a){a.dynamicMove()?lb(a):pb(a),a.dynamicSize()?yb(a):qb(a)})}function c(a,b,c){var d,e,f,g,h,i,j,k=a.kj,l=k.it(c),m=0,n=0,p=0,q=0;return l&&l.length>0&&(d=l[0],e=l[l.length-1],m=d.x,p=e.x+e[X]-m),f=k.jt(b),f&&f.length>0&&(g=f[0],h=f[f.length-1],n=g.y,q=h.y+h[Y]-n),i=k.am(),j=i.Ft(b,c),j.getIntersect(m,n,p,q)||new o(0,0,0,0)}function d(a,c,d,e){var f,g,h,i,j,k,l,m,n=a,o=n.kj,p=new y,q=o.wr;return q.isNeedToUpdateLayout&&(b(q),q.isNeedToUpdateLayout=!1),f=o.am(),g=o.ss,h=o.it(d),i=o.jt(c),h.length<=0||i.length<=0?p:(j=h[0],k=h[h.length-1],l=i[0],m=i[i.length-1],q.zR().forEach(function(a){var b,c,d,n,o,q,r,s,t,u,v,w,x;if(a&&a.isVisible()){if(a.fixedPosition())d=a.position(),b=d.x*e+f.kt,c=d.y*e+f.nt;else{if(n=a[aa](),o=h.findCol(n))b=o.x;else if(n<j.col)for(b=j.x,q=j.col-1;q>=n;q--)b-=g._m(q);else for(b=k.x+k[X],r=k.col+1;r<=n;r++)b+=g._m(r);if(b+=a[ba]()*e,s=a[$](),t=i.findRow(s),t)c=t.y;else if(s<l.row)for(c=l.y,u=l.row-1;u>=s;u--)c-=g.Sl(u);else for(c=m.y+m[Y],v=m.row+1;v<=s;v++)c+=g.Sl(v);c+=a[_]()*e}w=G(a[X]()*e),x=G(a[Y]()*e),p.push({name:a.name(),x:b,y:c,width:w,height:x})}}),p)}return a.prototype={no:function(){var a=this.jS;a.each(function(a){a.no()}),a.empty()},yl:function(a,b,e){var g,h,i,j,k,l,m,n,p,q;if(!(a<0||b<0)){for(g=this,h=g.kj,i=g.jS,j=h.wr,k=d(g,a,b,e),l=[],i.each(function(a){k.find(a.name)||l.push(a)}),m=0,n=l.length;m<n;m++)p=l[m],p.gS=D,i.remove(p.name),p.no();q=h.parent&&h.parent.options.useTouchLayout,f.mS=q?11:7,k.each(function(d){var e,k,l,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B=j.NR(d.name),C=G(f.mS/2+1);B&&"1"===B.typeName&&(e=B.borderWidth(),k=B.borderStyle(),zb(k)||(e=0),e>C&&(C=e)),l=c(g,a,b),m=1,n=d.x-C-m,p=d.y-C-m,q=d[X]+2*C+2*m,r=d[Y]+2*C+2*m,s=H(l.y,p),t=H(l.x,n),u=r,v=q,w=C,x=C,y=-1*C-m,w=p-s+w,x=n-t+x,w<=0?(u+=w,u+=y):w<C&&w>0&&(u-=C-w),x<=0?(v+=x,v+=y):x<C&&x>0&&(v-=C-x),z=i.find(d.name),z||(z=new f(j.NR(d.name),h),z.gS=g,i.push(z)),z._R=d,z.WE=a,z.aS=b,A=new o(l.x,l.y,l[X],l[Y]),z.yl(new o(t,s,v,u).getIntersectRect(A)||new o(t,s,0,0),new o(x,w,d[X],d[Y]))})}}},a}(),h={FloatingObject:e,FloatingObjectCollection:xb,tS:f,uS:ib,vS:hb,wS:gb},C.extend(h,n),i={init:function(){var a=this,c=a.$oa=[];a.Zoa=function(a){c.forEach(function(b){b.Wva&&b.Wva(a)})},a.wr=new b(a),a.pictures=new xb(a,"1"),a.floatingObjects=new xb(a,"0")},dispose:function(a){var b=this;ab(b),C.each(b.wr.zR(),function(b,c){c.no(a)}),C(b.Ws()).unbind("mousedown.fos"),b.unbind(q.TableFiltered+$a),b.unbind(q.RangeFiltered+$a)},setHost:function(a){if(a){var b=this;a.bind("mousedown"+$a,function(){b.uQ()}),b.bind(q.TableFiltered+$a,function(){b.AR()}),b.bind(q.RangeFiltered+$a,function(){b.AR()})}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=this.wr;g&&("addRows"===b?bb(g,c,d):"deleteRows"===b?cb(g,c,d):"addColumns"===b?db(g,e,f):"deleteColumns"===b&&eb(g,e,f))},paint:function(a){var b=this,c=a.clipRect;b.QP||(b.IR=function(a,c){var d,e;return b.FR||(b.FR=[]),d=b.FR[a],d||(b.FR[a]=[]),e=b.FR[a][c],e||(b.FR[a][c]=new g(b)),e=b.FR[a][c]},b.QP=function(a,b){var c,d,e,f,g,h=this;if(!h.fI&&h.wr)for(c=h.am(),b!==D&&void 0!==b||(b=h._zoomFactor),e=0;e<=2;e++)for(f=0;f<=2;f++)d=c.Ft(e,f),d&&(g=h.IR(e,f),g&&g.yl(e,f,b))}),b.QP(c)},lastNonNullRowAndCol:function(){var a=0,b=0,c=this.wr;return c&&c.zR().forEach(function(c){c&&(c[da]()>a&&(a=c[da]()),c[fa]()>b&&(b=c[fa]()))}),{lastNonNullRow:a,lastNonNullCol:b}},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.wr.toJSON(),c.length>0&&(a.floatingObjects=c))},fromJson:function(a,c,d){var e,f,g,h=d&&d.ignoreStyle;h||(e=this,e.wr=new b(e),f=a&&a.floatingObjectArray,g=c?f&&f.floatingObjects:a.floatingObjects,g&&e.wr.fromJSON(g,c))},preProcessMouseDown:function(){this.uQ()},processKeyDown:function(a){var b,c,d,e,f=this.wr;if(f)for(b=f.zR(),d=b.length,c=0;c<d;c++)if(e=b[c],e.isSelected())return void(a.r=!0)}},k.Worksheet.$n(S,i),j={init:function(){k.Commands.JR(this.commandManager())}},k.Workbook.$n(S,j),a.exports=h}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j=c(2),k=c(3),l=j.GC$,m=l.isArray,n=j.Commands,o=k.k.ac,p=n.ActionBase,q=null,r=void 0,s=Math.min,t="unSelectAllFloatingObjects",u="deleteFloatingObjects",v="navigationNextFloatingObject",w="navigationPreviousFloatingObject",x="cutFloatingObjects",y="copyFloatingObjects",z="pasteFloatingObjects",A="dragCopyFloatingObjects",B="selectAllFloatingObjects",C="moveFloatingObjects",D="moveFloatingObjectsUp",E="moveFloatingObjectsDown",F="moveFloatingObjectsLeft",G="moveFloatingObjectsRight",H="resizeFloatingObjects",I="isSelected",J="name",K=n.h4,L=function(){function a(a){return"string"==typeof a[J]?a[J]:a[J]()}function b(){this.rM={}}return b.prototype={push:function(b){this.rM[a(b)]=b},remove:function(a){delete this.rM[a]},find:function(a){return this.rM[a]},empty:function(){delete this.rM,this.rM={}},each:function(a){var b,c=this.rM;for(b in c)c.hasOwnProperty(b)&&a(c[b])},isEmpty:function(){var a,b=this.rM;for(a in b)if(b.hasOwnProperty(a))return!1;return!0}},b}();function M(a){var b=a.wr,c=!1;return b&&b.zR().forEach(function(a){a&&a[I]()&&(c=!0)}),c}b=function(a){l.inherit(b,a);function b(){a.call(this)}var c={init:function(a,b){var c=this;c.kj=a,c.VQ=b,b.yS=b.yS||[]},canExecute:function(){return!!M(this.kj)},canUndo:function(){var a=this.VQ.yS;return!!(a&&o(a)>0)},saveState:function(){var a,b,c,d,e=this,f=e.VQ.floatingObjects;if(m(f))for(a=e.kj.wr,b=0,c=o(f);b<c;b++)d=a.NR(f[b]),d&&e.VQ.yS.push(d)}};return l.extend(b.prototype,c),b}(p),d=function(a){l.inherit(b,a);function b(b,c){a.call(this),this.init(b,c)}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g=this,h=!1,i=g.kj,j=g.VQ,k=j.floatingObjects;if(g.canExecute()&&m(k)){for(g.saveState(),g.Lz(i,!0),a=i.wr,b=0,c=o(k);b<c;b++)d=a.NR(k[b]),d&&(e=i.slicers,
g.zS(d)&&e&&e.vV(d[J]()),f=a.Fb(k[b],!0),f||(j.yS[b]=r),d[I](!1));i.GJ(),g.Mz(i,!0),h=o(k)>0}return h},undo:function(){var a,b,c,d,e,f=this,g=f.VQ,h=g.yS,i=f.kj;if(f.canUndo()){for(f.Lz(i,!0),a=i.wr,b=0,c=o(h);b<c;b++)d=h[b],d&&(d[I](!0),a.Sb(d),e=i.slicers,f.zS(d)&&e&&e.Cz(d),d.position(g.AS[d[J]()]));return i.EJ(),h.length=0,f.Mz(i,!0),!0}return!1},init:function(b,c){a.prototype.init.call(this,b,c),c.AS=c.AS||{}},zS:function(a){return a&&"Slicer"===a.typeName},saveState:function(){var b,c,d,e,f,g,h;if(a.prototype.saveState.call(this),b=this,c=b.kj,d=b.VQ.floatingObjects,m(d))for(e=c.wr,f=0,g=o(d);f<g;f++)h=e.NR(d[f]),h&&h.position()&&(b.VQ.AS[h[J]()]=h.position())}};return l.extend(b.prototype,c),b}(b),e=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={constructor:b,canExecute:function(){return!0},execute:function(){var a,b,c,d,e,f=this,g=!1,h=f.VQ,i=h.floatingObjects,k=f.kj;if(f.canExecute()&&m(i)){for(f.saveState(),f.Lz(k,!0),a=k.wr,b=0,c=o(i);b<c;b++)d=a.NR(i[b]),e=d.position(),d.position(new j.Point(e.x+h.offsetX,e.y+h.offsetY));f.Mz(k,!0),g=o(i)>0}return g},undo:function(){var a,b,c,d,e=this,f=e.VQ.yS,g=e.kj;if(e.canUndo()){for(e.Lz(g,!0),a=0,b=o(f);a<b;a++)c=f[a],d=c.position(),c.position(new j.Point(d.x-e.VQ.offsetX,d.y-e.VQ.offsetY));return f.length=0,e.Mz(g,!0),!0}return!1}};return l.extend(b.prototype,c),b}(b),f=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={execute:function(){var a,b,c,d,e,f=this,g=!1,h=f.VQ,i=h.floatingObjects,k=f.kj;if(f.canExecute()&&m(i)){for(f.saveState(),f.Lz(k,!0),a=k.wr,b=0,c=o(i);b<c;b++)d=a.NR(i[b]),e=d.position(),d.width(d.width()+h.offsetWidth),d.height(d.height()+h.offsetHeight),d.position(new j.Point(e.x+h.offsetX,e.y+h.offsetY));f.Mz(k,!0),g=o(i)>0}return g},undo:function(){var a,b,c,d,e=this,f=e.VQ.yS,g=e.kj;if(e.canUndo()){for(e.Lz(g,!0),a=0,b=o(f);a<b;a++)c=f[a],d=c.position(),c.position(new j.Point(d.x-e.VQ.offsetX,d.y-e.VQ.offsetY)),c.width(c.width()-e.VQ.offsetWidth),c.height(c.height()-e.VQ.offsetHeight);return f.length=0,e.Mz(g,!0),!0}return!1}};return l.extend(b.prototype,c),b}(b),g=function(a){l.inherit(b,a);function b(){var b=this;a.call(b),b.kj=q}var c={canExecute:function(){var a=this,b=a.VQ.floatingObjects;return!!(o(b)>0&&a.ES(b))},canUndo:function(){var a=this.VQ.DS;return!!(a&&o(a)>0)},ES:function(a){var b,c,d,e=this,f=e.kj,g=f.wr;for(b=0,c=o(a);b<c;b++)if(d=g.NR(a[b]),d&&!f.ER(d))return!1;return!0},zS:function(a){return a&&"Slicer"===a.typeName}};return l.extend(b.prototype,c),b}(p),h=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.OFFSET=15,d.kj=b,d.VQ=c,c.DS=c.DS||[],c.f6=c.f6||[]}var c={execute:function(){var a,b,c,d,e,f,g,h,i,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,B=this,C=B.VQ,D=C.floatingObjects;if(B.canExecute()){for(a=B.kj,b=C.fromSheet,B.Lz(a,!0),c=C.f6,d=a.wr,void 0===C.Jl&&(M(a)&&d.zR().forEach(function(a){a&&a[I]()&&c.push(a)}),C.Jl=B.kj.getActiveRowIndex(),C.GS=B.kj.getActiveColumnIndex()),M(a)&&d.zR().forEach(function(a){a&&a[I]()&&a[I](!1)}),e=[],h=Number.MAX_VALUE,i=h,k=h,l=[],f=0,g=o(D);f<g;f++)m=b.CR.find(D[f]).position(),i=s(i,m.x),k=s(k,m.y),l.push(new j.Point(m.x-i,m.y-k));if(n=0,p=0,c.length)q=h,r=h,c.forEach(function(a){if(a){var b=a.position();q=s(q,b.x),r=s(r,b.y)}}),n=q<h?q+B.OFFSET:0,p=r<h?r+B.OFFSET:0;else{for(t=0;t<C.Jl;t++)p+=a.Yr(t,3);for(u=0;u<C.GS;u++)n+=a.$r(u,3)}for(f=0,g=o(D);f<g;f++)v=l[f],e.push(new j.Point(n+v.x,p+v.y));for(w=C.isCutting,x=b.wr,f=0,g=o(D);f<g;f++)A=b.CR.find(D[f]),y=A.clone(a),y.sheet(a),z=!w||x.NR(D[f])||a.wr.NR(D[f])?B.zS(y)?a.slicers.HS(y[J]()):d.FS():A.name(),y[J](z),B.zS(y)&&(a.slicers.Cz(y),y.width(A.width()),y.height(A.height())),y.isVisible(!0),y.position(e[f]),y[I](!0),d.Sb(y),C.DS.push(y);return B.Mz(a,!0),!0}return!1},undo:function(){var a,b,c,d,e,f,g,h=this,i=h.VQ,j=i.DS;if(h.canUndo()){for(a=h.kj,b=a.wr,h.Lz(a,!0),c=0,d=o(j);c<d;c++)e=j[c],f=a.slicers,h.zS(e)&&f&&f.remove(e[J]()),b.Fb(e[J](),!0);return j.length=0,g=i.f6,g.forEach(function(a){a[I](!0)}),h.Mz(a,!0),!0}return!1}};return l.extend(b.prototype,c),b}(g),i=function(a){l.inherit(b,a);function b(a,b){var c=this;c.kj=a,c.VQ=b,b.DS=b.DS||[]}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g,h,i=this,k=!1,l=i.VQ,m=l.floatingObjects,n=i.kj;if(i.canExecute()){for(i.Lz(n,!0),a=n.wr,b=0,c=o(m);b<c;b++)d=a.NR(m[b]),d&&(e=d.clone(n),f=d.position(),e.position(new j.Point(f.x+l.offsetX,f.y+l.offsetY)),e[J](a.FS()),e[I](!0),d[I](!1),i.zS(e)&&n.slicers&&(g=e,h=n.slicers.HS(g.columnName()),g[J](h),n.slicers.Cz(g)),a.Sb(e),l.DS.push(e));i.Mz(n,!0),k=!0}return k},undo:function(){var a,b,c,d,e,f,g=this,h=g.VQ,i=h.DS,j=g.kj;if(g.canUndo()){for(g.Lz(j,!0),a=j.wr,b=0,c=o(i);b<c;b++)d=i[b][J](),e=j.slicers,f=a.NR(d),g.zS(f)&&e&&e.remove(d),a.Fb(d,!0);return i.length=0,g.Mz(j,!0),!0}return!1}};return l.extend(b.prototype,c),b}(g);function N(a){var b=[];return a.wr.zR().forEach(function(a){a[I]()&&b.push(a[J]())}),b}function O(a,b,c){var d,e,f,g,h=a.BR(),i=h.fromSheet;for(h.fromSheet=a,h.isCutting=c,d=new L,e=0,f=0;f<o(b);f++)g=a.wr.NR(b[f]),g&&(d.push(g),e++);return i&&(i.CR=q),a.CR=d,e>0}n[t]={canUndo:!1,execute:function(a,b){var c=n.bT(a,b);return!!M(c)&&(c.suspendPaint(),c.uQ(),c.GJ(),c.resumePaint(),!0)}},n[B]={canUndo:!1,execute:function(a,b){var c=n.bT(a,b);c.suspendPaint(),c.wr.zR().forEach(function(a){a[I](!0)}),c.resumePaint()}},n[u]={canUndo:!0,execute:function(a,b,c){var e,f;return b.floatingObjects?K(a,d,b,c):(e=a.sheets?a.getActiveSheet():a,f=N(e),o(f)>0?e.wu().execute({cmd:u,sheetName:e.name(),floatingObjects:f}):void 0)}},n[v]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i,j=n.bT(a,b);if(M(j)){for(j.suspendPaint(),g=j.wr.zR(),h=g.length,f=0;f<h;f++){if(i=g[f],d||(d=i),c){e=i;break}i&&i[I]()&&(c=i)}return j.uQ(),e||(e=d),e&&e[I](!0),j.resumePaint(),!0}return!1}},n[w]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i=n.bT(a,b);if(M(i)){for(i.suspendPaint(),f=i.wr.zR(),g=f.length,e=0;e<g;e++)if(h=f[e],c||(c=h),c[I]())d=h;else if(h[I]()||(d=h),h[I]())break;return d&&(i.uQ(),d[I](!0)),i.resumePaint(),!0}return!1}},n[x]={canUndo:!1,execute:function(a,b){var c,d=n.bT(a,b),e=[];return d.wr.zR().forEach(function(a){a[I]()&&e.push(a[J]())}),o(e)>0&&(O(d,e,!0),c={cmd:u,sheetName:d.name(),floatingObjects:e},d.wu().execute(c))}},n[y]={canUndo:!1,execute:function(a,b){var c=n.bT(a,b),d=[];return c.wr.zR().forEach(function(a){a[I]()&&d.push(a[J]())}),O(c,d,!1)}},n[z]={canUndo:!0,execute:function(a,b,c){var d,e,f,g,i;if(b.floatingObjects)return K(a,h,b,c);if(d=n.bT(a,b),!d.isEditing()&&(e=d.BR(),f=e.fromSheet,g=f&&f.CR)){if(i=[],g.each(function(a){i.push(a[J]())}),0===o(i))return!1;if(!d.Js)return d.wu().execute({cmd:z,sheetName:d.name(),floatingObjects:i,fromSheet:f,isCutting:e.isCutting})}}},n[A]={canUndo:!0,execute:function(a,b,c){return K(a,i,b,c)}};function P(a){return function(b,c){var d,e,f=n.bT(b,c),g=0;return 0===a?g=-1:2===a&&(g=1),d=0,1===a?d=-1:3===a&&(d=1),e=N(f),o(e)>0&&f.wu().execute({cmd:C,sheetName:f.name(),floatingObjects:e,offsetX:g,offsetY:d})}}n[F]=P(0),n[D]=P(1),n[G]=P(2),n[E]=P(3),n[C]={canUndo:!0,execute:function(a,b,c){return K(a,e,b,c)}},n[H]={canUndo:!0,execute:function(a,b,c){return K(a,f,b,c)}},n.JR=function(a){var b=j.Ul.sl(),c=!b,d=b;a.register(t,n[t],27,!1,!1,!1,!1),a.register(B,n[B],65,c,!1,!1,d),a.register(u,n[u],46,!1,!1,!1,!1),a.register(v,n[v],9,!1,!1,!1,!1),a.register(w,n[w],9,!1,!0,!1,!1),a.register(x,n[x],88,c,!1,!1,d),a.register(y,n[y],67,c,!1,!1,d),a.register(A,n[A]),a.register(z,n[z],86,c,!1,!1,d),a.register(C,n[C]),a.register(D,n[D],38,!1,!1,!1,!1),a.register(E,n[E],40,!1,!1,!1,!1),a.register(F,n[F],37,!1,!1,!1,!1),a.register(G,n[G],39,!1,!1,!1,!1),a.register(H,n[H])},a.exports={yR:L,FloatingObjectUndoActionBase:b,DeleteFloatingObjectUndoAction:d,MovingFloatingObjectUndoAction:e,ResizingFloatingObjectUndoAction:f,FloatingObjectCopyPasteUndoAction:g,ClipboardPasteFloatingObjectUndoAction:h,DragCopyFloatingObjectUndoAction:i}}()},function(a,b,c){!function(){"use strict";var b=c(2),d=c(1),e=b.Ul.Nl,f=b.Ul.Pl,g=d.FloatingObject,h=d.vS,i=d.wS,j=d.uS,k=b.GC$,l=null,m=void 0,n=function(a){var c,d,g,n,o,p,q,r,s,t;k.inherit(v,a);function u(a){return"number"==typeof a&&!isNaN(a)}c="src",d="backColor",g="pictureStretch",n="borderRadius",o="borderWidth",p="borderStyle",q="borderColor",r=[c,d,n,o,p,q,g],s=[[c,m,function(a){var b=this;b.oS=!1,w(b),b.srccallback||(b.srccallback=j(c)),b.srccallback.call(b,a)}],[d,l,j(d)],[n,-1,j(n),u],[o,1,j(o),u],[p,"none",function(a){var b=this;b.nS(a)||b.borderWidth(0),b.bscallback||(b.bscallback=j(p)),b.bscallback.call(b,a)}],[q,l,j(q)],[g,0,j(g)]];function v(b,c,d,e,f,g){var h=this;a.call(h,b,d,e,f,g),h.typeName="1",h.g3="1",h.bt=l,h.oS=!1,h.JS=!1,"string"==typeof c&&(h.JS=!f||!g,h.src(c))}function w(a){var c,d,e=a,f=e.src(),g=e.sheet();e.bt||(e.bt=new b.oo(function(){w(e)})),c=e.bt;try{c.ko(f)?(e.oS=!0,d=c.lo(f),e.KS=d.width,e.LS=d.height,e.JS&&(e.width(d.width,!0),e.height(d.height,!0),e.JS=!1),g&&g.repaint()):c.fo(f)}catch(a){}}return t={onPropertyChanged:function(a,b){var c,d=this;d.TR||(c=d.sheet(),this.Wq({sheet:c,sheetName:c?c.Cj:"",picture:d,propertyName:a}))},toJSON:function(){var b=this,c=a.prototype.toJSON.call(this);return i.call(b,r,c),delete c.content,c},fromJSON:function(b,c){if(b){var d=this;d.TR=!0,a.prototype.fromJSON.call(d,b,c),h.call(d,r,b,c),d.oS=!1,w(d),d.TR=m}},clone:function(){var a=new v,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a},getOriginalWidth:function(){return this.KS},getOriginalHeight:function(){return this.LS},nS:function(a){var b=["dotted","dashed","solid","double","groove","ridge","inset","outset"];return b.indexOf(a)>=0},WR:function(a,b){var c=e("div");return k(c).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(c,a,b),c},Wq:function(a){var c,d=this.sheet();d&&(d.Wq(b.Events.PictureChanged,a),"isSelected"===a.propertyName&&(c={sheet:a.sheet,sheetName:a.sheetName,picture:a.picture},d.Wq(b.Events.PictureSelectionChanged,c)))},no:function(a){self.bt&&a!==!1&&(self.bt.no(),self.bt=l)}},k.each(s,function(a,b){t[b[0]]=f(b[0],b[1],b[2],b[3])}),k.extend(v.prototype,t),v}(g);d.Picture=n,a.exports=d}()},function(a,b,c){!function(){"use strict";var a=c(7);a&&!function(){var b=c(2),d=b.GC$,e=d.extend,f=b.Ul.nl,g=a.jR,h=a.kR;function i(a,b,c){var d,e,f=this;f.yM=new g(f),f.DQ=new h(a,"FL_"+b.name,f.yM,2,200),f.BQ=c,f.CQ=new j(a,b),d=f.CQ,e=f.DQ,e._M=function(){return b.YR.isSelected()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(i.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function j(b,c){var d=this;d.MS=c,d.YR=c.YR,d.NS=b,d.hQ=new a.TP(c.kj)}e(j.prototype,{OS:function(b){var c,e=new a.oP(b.X,b.Y),f=d(this.NS).offset();return f&&(c=document.body,e.X+=f.left+c.clientLeft||0,e.Y+=f.top+c.clientTop||0),e},jQ:function(a){a.DO=3},lQ:function(a){var b=this,c=b.OS(a.rN);b.MS.AD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},pQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?(e.mm.O3=!1,c.MS.rS(),c.hQ.PP(d)):(b=c.OS(a.rN),c.MS.BD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},qQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?c.hQ.SP(d):(b=c.OS(a.rN),this.MS.CD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},sQ:function(){var a,c;try{a=this,c=a.MS.kj,c.suspendPaint(),a.YR.isSelected()||(c.uQ(),a.YR.isSelected(!0),b.Vl.Zl(c)),c.clearSelection()}finally{c.resumePaint()}}}),c(1).tS.$n("touch",{init:function(a){var b=this,c=b.wR=new i(a,b,b.kj.parent.BQ);c.EQ()},dispose:function(){var a=this.wR;a&&a.FQ()},preProcessMouseDown:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.IQ(b)&&(f(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.HQ(b)&&(f(b),a.r=!0)}})}()}()},function(a,b){a.exports=GC.Spread.Sheets.Touch},function(a,b){!function(){"use strict";a.exports={Exp_FloatingObjectHasSameNameError:"The current worksheet already has a floating object with the same name.",Exp_FloatingObjectNameEmptyError:"Floating object must have name"}}()}]);
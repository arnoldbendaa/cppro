/*!
 * 
 * Spread.Sheets Library 11.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Outlines=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";c(1);var b=c(4);b.SR={},b.SR.en=c(5),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p=c(2),q=c(3),r=q.Commands,s=r.ActionBase,t=q.GC$,u="outlineColumn",v="removeColumnOutline",w="expandColumnOutline",x="expandColumnOutlineForLevel",y="outlineRow",z="removeRowOutline",A="expandRowOutline",B="expandRowOutlineForLevel",C=p.j.Fa;function D(a){var b=a.kj;return a.ML?b.rowOutlines:b.columnOutlines}function E(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ.index,d=g.VQ.count,e=D(g),b&&e&&!C(c)&&!C(d)&&(f=a?e.group:e.ungroupRange,g.Lz(b,!0),f.call(e,c,d),g.Mz(b,!0),h=!0)),h}b=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){return E.call(this,!0)},undo:function(){return E.call(this,!1)}};return t.extend(b.prototype,c),b}(s),d=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(b),e=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(b),f=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){var a,b,c,d=this,e=d.kj,f=!1;return d.canExecute()&&(a=d.VQ.index,b=d.VQ.count,c=D(d),e&&c&&!C(a)&&!C(b)&&((c.getLevel(a)>=0||c.getLevel(a+b-1)>=0)&&(d.Lz(e,!0),c.ungroupRange(a,b),d.Mz(e,!0)),f=!0)),f},undo:function(){var a,b,c,d=this,e=!1,f=d.kj;return d.canUndo()&&(a=d.VQ.index,b=d.VQ.count,c=D(d),f&&c&&!C(a)&&!C(b)&&(d.Lz(f,!0),c.group(a,b),d.Mz(f,!0),e=!0)),e}};return t.extend(b.prototype,c),b}(s),g=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(f),h=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(f);function F(a,b,c,d,e){var f=0,g;for(g=b;g<=c&&g<d;g++)f+=e.call(a,g)*a._zoomFactor;return f}function G(a,b,c,d,e){var f=0,g;for(g=b;g<d&&f<c;g++)b++,f+=e.call(a,g)*a._zoomFactor;return b>=d?d-1:b}function H(a,b,c,d,e){if(b<d)return d;if(b>e)return e;for(var f=b;f<=e;f++)if(c.call(a,f))return f;return-1}function I(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.kj,s=c.index,t=b?r.getRowCount():r.getColumnCount(),u=void 0;s<0||s>=t||(d=D(q),e=1===d.direction(),f=b?r.frozenRowCount():r.frozenColumnCount(),g=b?r.getRowHeight:r.getColumnWidth,h=b?r.getViewportTopRow:r.getViewportLeftColumn,i=b?r.getViewportHeight:r.getViewportWidth,j=h.call(r,1),n=d.find(e?s-1:s+1,c.level),n&&(o=e?n.start:s,p=e?s:n.end,e?(a?o=s:o<f&&(o=f),o<j&&(j=o),k=i.call(r,1),l=F(r,j,p,t,g),l>k&&(j=G(r,j,l-k,t,g)),m=H(r,j,g,f,t-1)):(a?p=s:p>=t&&(p=t-1),o<j?m=H(r,o,g,f,t-1):(k=i.call(r,1),l=F(r,j,p,t,g),l>k&&(m=H(r,o,g,f,t-1)))),b&&m!==u?(r.lq=m,r.os()):b||m===u||(r.qq=m,r.qs())))}function J(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ,d=D(g),e=c.collapsed,f=c.index,!b||!d||C(e)||C(f)||C(c.level)||(g.Lz(b,!0),a||(e=!e),d.setCollapsed(f,e),I.call(g,e,g.ML,c),g.Mz(b,!0),h=!0)),h}i=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){return J.call(this,!0)},undo:function(){return J.call(this,!1)}};return t.extend(b.prototype,c),b}(s),j=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(i),k=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(i),l=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){var a,b,c,d=this,e=d.kj,f=!1;if(d.canExecute()&&(b=d.VQ.level,c=D(d),e&&c&&!C(b))){for(d.Lz(e,!0),d.saveState(),a=0;a<b;a++)c.expand(a,!0);c.expand(b,!1),d.Mz(e,!0),f=!0}return f},saveState:function(){var a=this,b=a.kj,c=a.VQ,d=null,e,f,g,h,i,j,k=a.ML,l=c.level,m=D(a),n=k?b.getRowCount():b.getColumnCount();if(b&&m&&!C(l))for(d={},e=0;e<=l;e++)for(i=0;i<n;){if(f=m.find(i,e)){switch(j=-1,g=f.start,h=f.end,m.direction()){case 0:j=g-1;break;case 1:j=h+1}d[j]||(d[j]=1===f.state()),i+=h-g+1}i++}c.RL=d},undo:function(){var a,b,c,d,e=this,f=!1;if(e.canUndo()&&(a=e.kj,b=e.VQ.RL,d=D(e),a&&b&&d)){e.Lz(a,!0);for(c in b)c&&(d.setCollapsed(parseInt(c),b[c]),f=!0);e.Mz(a,!0)}return f}};return t.extend(b.prototype,c),b}(s),m=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(l),n=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(l),o=r.h4,r[u]={canUndo:!0,execute:function(a,b,c){return o(a,d,b,c)}},r[y]={canUndo:!0,execute:function(a,b,c){return o(a,e,b,c)}},r[v]={canUndo:!0,execute:function(a,b,c){return o(a,g,b,c)}},r[z]={canUndo:!0,execute:function(a,b,c){return o(a,h,b,c)}},r[w]={canUndo:!0,execute:function(a,b,c){return o(a,j,b,c)}},r[A]={canUndo:!0,execute:function(a,b,c){return o(a,k,b,c)}},r[x]={canUndo:!0,execute:function(a,b,c){return o(a,m,b,c)}},r[B]={canUndo:!0,execute:function(a,b,c){return o(a,n,b,c)}},r.SL=function(a){a.register(u,r[u]),a.register(y,r[y]),a.register(v,r[v]),a.register(z,r[z]),a.register(w,r[w]),a.register(A,r[A]),a.register(x,r[x]),a.register(B,r[B])},a.exports=r}()},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Sheets},function(a,b,c){!function(){"use strict";var b,d,e,f,g=c(2),h=c(3),i=c(1),j={},k=null,l=void 0,m=Math.max,n=Math.min,o=h.GC$,p=o.each,q=h.Im.Lm,r=h.Rect,s=g.k,t=s._b,u=s.$b,v=s.ac,w=h.Ul.Ol,x=g.j.Fa,y=h.Ul.Pl,z=h.Ul.fp,A="rangegroup",B="gc-group",C=B+"-box",D="rgh",E="cgh",F="rg",G="cg",H=function(){return g.C(j.SR)()},I={Gt:function(){var a,b,c,d,e,f,g,h=this,i=h.TL;return i?i:(a={x:0,y:0,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},b=h.rowOutlines,c=h.columnOutlines,d=17,e=4,f=n(d,d*h._zoomFactor),h.showRowOutline()&&b&&!b.iT()&&(g=b.getMaxLevel(),g>=0&&(a.width=f*(g+2)+e,a.rowMaxLevel=g)),h.showColumnOutline()&&c&&!c.iT()&&(g=c.getMaxLevel(),g>=0&&(a.height=f*(g+2)+e,a.colMaxLevel=g)),h.TL=a,a)},showRowOutline:y("showRowOutline",!0,function(){this.$p()}),showColumnOutline:y("showColumnOutline",!0,function(){this.$p()})};o.extend(h.Worksheet.prototype,I);function J(a,b){a.Wq(h.Events.RangeGroupStateChanging,b)}function K(a,b){a.Wq(h.Events.RangeGroupStateChanged,b)}function L(a,b){var c,d,e,f;a.isEditing&&a.isEditing()||(c=b.info.index,d=b.what===D,e=d?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",f=N(a,d,-1,c,!0),J(a,f),f&&f.cancel===!1&&(a.wu().execute({cmd:e,sheetName:a.name(),level:c}),K(a,N(a,d,-1,c,!1))))}function M(a,b){var c,d,e,f,g,h,i;a.isEditing&&a.isEditing()||(c=b.what===F,S(c,a)&&(d=b.info,e=d.index,f=e,g=d.level,i=c?"expandRowOutline":"expandColumnOutline",1===d.lineDirection?e--:e++,h=N(a,c,e,g,!0),J(a,h),h&&h.cancel===!1&&(a.wu().execute({cmd:i,sheetName:a.name(),index:f,level:g,collapsed:d.isExpanded}),K(a,N(a,c,e,g,!1)))))}function N(a,b,c,d,e){var f={sheet:a,sheetName:a.Cj,isRowGroup:b,index:c,level:d};return e&&(f.cancel=!1),f}function O(a,b){var c,d,e,f,g=this,h=g.Gt(),i=h.width,j=h.height;return i||j?(c=g.am(),d=new r(h.x,h.y,i,c.height),e=new r(h.x,h.y,c.width,j),d.contains(a,b)||e.contains(a,b)?(f=P(g,a,b,h.rowMaxLevel,!0),f||(f=P(g,a,b,h.colMaxLevel,!1)),f||{what:"empty",info:k}):k):k}function P(a,b,c,d,e){var f,g,h=new fa(a,e,d),i=h.WL(b,c,e);if(i)return{what:e?D:E,info:i};for(f=Q(a,e,d),g=0;g<=2;g++)if(i=f[g].XL(b,c,e))return{what:e?F:G,info:i};return k}function Q(a,b,c){var d=[new ea(a,b,0,c),new ea(a,b,1,c),new ea(a,b,2,c)],e;for(e=0;e<=2;e++)d[e].YL();return d}function R(a,b){var c=b?a.width:a.height;return m(0,(c-2*this.PADDING)/(this.ZL+2))}function S(a,b){return a?b.rowOutlines:b.columnOutlines}j.OutlineDirection={backward:0,forward:1},j.OutlineState={expanded:0,collapsed:1},b=function(){function a(a,b,c,d){var e=this;e.children=[],e.parent=k,e.model=a,e.start=b,e.end=c,e.level=d}return a.prototype={state:function(a){var b=this,c=b.model;return arguments.length?void(c&&c.expandGroup(b,0===a)):c?c.getState(b):0},contains:function(a){return this.start<=a&&a<=this.end},addChild:function(a){a&&(this.children.push(a),a.parent=this)}},a}(),j.OutlineInfo=b;function T(a,b,c){var d,e,f,g;if(c>0){for(d=a.items,g=[],e=0;e<c;e++)g.push(k);if(a.items=d=d.slice(0,b).concat(g,d.slice(b)),a.V3<=0&&b>0&&(f=d[b-1]))for(e=0;e<c;e++)d[b+e]=new da(f);Z(a)}}function U(a,b,c){c>0&&(a.items.splice(b,c),Z(a))}function V(a,c,d){var e,f,g,h,i,j,l=k,m=a.items;for(f=c,h=v(m);f<h&&(e=m[f],!e||e.level<d||(l||(l=new b(a,f,f,d)),e.level>d&&(g=V(a,f,d+1),f=g.index,l.addChild(g.g)),f>l.end&&(l.end=f),!a.isGroupEnd(f,d)));f++);if(l)for(i=l.end+1,j=l.start;j<i;j++)m[j].groupInfo||(m[j].groupInfo=l);return{g:l,index:f}}function W(a,b){return b>=-1&&b<v(a.items)}function X(a,b,c){var d,e,f=a&&a.items;if(f)for(d=f[b]&&f[b].groupInfo;d;){if(e=d.level,e===c)return d;if(!(e>c))break;d=d.parent}return k}function Y(a,b){switch(a){case"head":case"tail":return b===k;case"direction":return 1===b;case"itemsData":return 0===v(b);default:return!1}}function Z(a){a.Zka=k,a.refresh()}function $(a,b){!b&&a.Wka||(a.Zka=a.createRangeGroup(),aa(a))}function _(a){a.Wka&&!a.Zka&&(a.Zka=a.createRangeGroup())}function aa(a,b){a.groupChangeHandler&&a.groupChangeHandler(b)}function ba(a,b,c){if(ca(a,b),!W(a,b+c-1))throw Error(H().Exp_InvalidCount)}function ca(a,b){if(!W(a,b))throw Error(H().Exp_InvalidIndex)}d=function(){function a(a,b){var c=this;c.head=k,c.tail=k,c.Zka=k,c.items=Array(a),c.V3=0,c.wz=!0,c.kj=b}return a.prototype={direction:y("direction",1),group:function(a,b){var c=this,d,e;for(ba(c,a,b),d=0;d<b;d++)e=a+d,c.items[e]?c.items[e].level++:c.items[e]=new da;c.Wka&&c.Zka&&(c.Zka=k),$(c),c.wz=!1},Lia:function(){this.Wka=!0,this.Zka=k},Mia:function(){this.Wka=!1,this.refresh()},ungroupRange:function(a,b){var c=this,d,e;for(ba(c,a,b),d=0;d<b;d++)e=c.items[a+d],e&&e.level>-1&&e.level--;$(c)},ungroup:function(){var a=this,b=v(a.items);a.items=Array(b),$(a),a.wz=!0},expand:function(a,b){var c,d,e,f,g;if(a<-1)throw Error(H().Exp_InvalidLevel);for(c=this,d=c.items,_(c),f=0,g=d.length;f<g;f++)d[f]&&(e=c.find(f,a),e&&c.expandGroup(e,b))},expandGroup:function(a,b){if(!a)throw Error(H().Exp_GroupInfoIsNull);var c=this,d=c.direction(),e=-1;0===d?e=a.start-1:1===d&&(e=a.end+1),c.setCollapsed(e,!b)},Xr:function(a){return!W(this,a)||!this.isCollapsed(a)},isCollapsed:function(a){var b=this.items[a];return!!(b&&b.viewCollapsed&&b.level>-1)},find:function(a,b){var c=this,d;return _(c),b===-1?d=c.Zka:(ca(c,a),d=X(c,a,b)),d},getLevel:function(a){var b=this.items[a];return b?b.level:-1},getCollapsed:function(a){var b=this.items[a];return!!b&&!!b.collapsed},B4:function(a,b,c,d){var e,f;for(e=b;e<=c;e++)f=a[e],f||(f=a[e]=new da,f.level=-1),f.viewCollapsed=d},setCollapsed:function(a,b){var c,d,e,f,g,h,i=this,j=!1,k=i.items;if(_(i),a<0?(c=i.head,c||(c=i.head=new da)):a<v(k)?(c=k[a],c||(c=k[a]=new da,c.level=-1)):(c=i.tail,c||(c=i.tail=new da)),d=1===i.direction(),c.collapsed!==b&&(c.collapsed=b,j=!0,i.E4(a,b)),j&&(a+=d?-1:1,f=[],g=i.find(a,i.getLevel(a)))){for(h=g.start;h<=g.end;h++)f.push(h);e={indexes:f}}aa(i,e)},dPa:function(a,b){var c,d=this.items;d[a]?d[a].collapsed!==b&&(d[a].collapsed=b):(c=d[a]=new da,c.level=-1,c.collapsed=b)},E4:function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.items,n=1===l.direction(),o=n?-1:1,p=a+o,q=X(l,p,l.getLevel(p));if(q)if(b)c=n?q.end+1:q.start-1,l.dPa(c,!0),l.B4(m,q.start,q.end,!0);else{for(d=!1,e=q.parent;e;){if(f=n?e.end+1:e.start-1,m[f]&&m[f].collapsed&&m[f].level>-1){d=!0;break}e=e.parent}if(!d)for(c=n?q.end+1:q.start-1,l.dPa(c,!1),l.B4(m,q.start,q.end,!1),g=[q],h=0;h>=0;)if(i=g[h--],f=n?i.end+1:i.start-1,m[f]&&m[f].collapsed&&m[f].level!==-1)l.B4(m,i.start,i.end,!0);else for(j=i.children,k=0;j&&k<j.length;k++)g[++h]=j[k]}},getMaxLevel:function(){var a=-1,b=this.items,c;return p(b,function(b,d){d&&(c=d.level,c>a&&(a=c))}),a},cB:function(a,b,c,d){if(!(c<=0||a===b)){a<0&&(a=0),b<0&&(b=0);for(var e=this,f=[],g=e.items,h=t(g,a-1),i;h>=0&&h<a+c;)i=new da(g[h]),f.push({index:h-a,value:i}),h=t(g,h);d&&u(g,a,c),u(g,b,c),p(f,function(a,c){g[b+c.index]=c.value}),Z(e)}},bB:function(a,b,c,d,e){var f,g,h;if(b<0&&(b=0),c<0&&(c=0),f=[],a)for(g=t(a.items,b-1);g>=0&&g<b+d;)f[g-b]=new da(a.items[g]),g=t(a.items,g);if(u(this.items,c,d),f.length>0)for(h in f)f.hasOwnProperty(h)&&(this.items[c+h]=f[h]);e&&u(a.items,b,d)},refresh:function(){this.wz||$(this)},VL:function(a){var b,c,d=this,e=d.items,f=v(e),g=a-f;if(g<0)e.splice(a,-g);else if(b=e[f-1])for(c=0;c<g;c++)e.push(new da(b));else d.items=e.concat(Array(g));Z(d)},getState:function(a){var b=this,c=b.items,d,e=b.direction(),f=-1;return 0===e?f=a.start-1:1===e&&(f=a.end+1),d=f<0?b.head:f<v(c)?c[f]:b.tail,d&&d.collapsed?1:0},Ez:function(a,b){var c=this,d=c.items;a<0?(c.head||(c.head=new da),c.head.level=b):a<v(d)?(d[a]||(d[a]=new da),d[a].level=b):(c.tail||(c.tail=new da),c.tail.level=b),Z(c)},suspendAdding:function(){this.V3++},resumeAdding:function(){this.V3--},createRangeGroup:function(){for(var a,c,d=this,e=d.items,f=v(d.items),g=new b(d,0,f-1,(-1)),h=0;h<f;)e[h]&&(e[h].groupInfo=k),h++;for(h=0;h<f;)e[h]?(a=V(d,h,0),c=a.g,h=a.index+1,c&&c.level>-1&&g.addChild(c)):h++;return g},isGroupEnd:function(a,b){var c,d,e,f,g,h,i=this,j=i.items,k=a+1;return!W(i,k)||(!(c=j[k])||(d=c.level,e=j[a].level,f=!1,d<e&&(g=e-d,h=e-b,h>=0&&h<g&&(f=!0)),f))},hitTest:function(a,b,c){return O.call(a,b,c)},jp:function(a,b,c,d){var e,f,g,h,i,j,k,l=a.Gt(),m=a.am(),n=a.ss,o=l.width,p=l.height;if(o||p){if(e=d?o:m.width,f=d?m.height:p,g=d?l.rowMaxLevel:l.colMaxLevel,h=d?n.bn:n.dn,b.save(),b.beginPath(),!c||c.intersect(l.x,l.y,e,f))for(i=new fa(a,d,g),i._L(b),j=h.call(a.ss,function(){return Q(a,d,g)}),k=0;k<=2;k++)j[k].aM(b);b.beginPath(),b.restore()}},UL:function(a,b){if(b){var c=b.what;c===D||c===E?L(a,b):c!==F&&c!==G||M(a,b)}},iT:function(){return this.wz},fromJSON:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.ignoreStyle;if(a&&!n)for(c=this,d=c.items,e=a.itemsData,f=a.direction,g=a.head,h=a.tail,l=[],p(e,function(a,b){if(i=b.index,j=b.info,i>=0&&j){for(k=0;k<b.count&&!(i+k>=v(d));k++)b.info.collapsed&&l.push(b),d[i+k]=new da(j);c.wz=!1}}),x(f)||c.direction(f),g&&(c.head=g),h&&(c.tail=h),$(c,!0),m=0;m<l.length;m++)c.E4(l[m].index,!0)},toJSON:function(a){var b,c,d,e,f,g,h,i,j,k=a&&a.ignoreStyle;if(!k){for(b=this,c=[],d=b.items,f=-1,e=0;e<v(d);e++)g=c[f],h=d[e],h&&(f>=0&&e===g.count+g.index&&h.level===g.info.level&&h.collapsed===g.info.collapsed?c[f].count++:c[++f]={index:e,count:1,info:{level:h.level,collapsed:h.collapsed}});return i={itemsData:c,direction:b.direction(),head:b.head,tail:b.tail},j={},p(i,function(a,b){Y(a,b)||(j[a]=b)}),o.isEmptyObject(j)?l:j}}},a}(),j.Outline=d;function da(a){return{level:a?a.level:0,collapsed:!!a&&a.collapsed,viewCollapsed:!!a&&a.viewCollapsed}}function ea(a,b,c,d){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.bM=[],e.cM=[],e.dM=[],e.kj=a,e.ML=b,e.eM=c,e.ZL=w(d)?d:S(b,a).getMaxLevel()}ea.prototype={YL:function(){var a,b=this;b.ZL!==-1&&(a=b.fM(0,b.ML),p(a,function(a,c){b.gM(c)}))},gM:function(a){var b,c,d,e,f,g,h,i,j,l,o,q,r,s,t,u,w,x,y=this,z=y.kj,A=y.ML,B=S(A,z).direction(),C=1===B,D=0===B,E=y.hM(!0,A),F=y.hM(!1,A),G=a.start,H=a.end,I=a.level;if(C?b=H+1:D&&(b=G-1),0===a.state()){if(c=!0,d=a.parent,d&&(D&&G===d.start||C&&H===d.end)&&(c=!1),c&&y.iM(!0,I,b,E,F,B),G<=F&&H>=E){for(e=m(E,G),f=n(F,H),c&&(g={start:e,end:f,level:I,startLine:k},(C&&e===G||D&&f===H)&&(g.startLine=!0),y.bM.push(g)),j=[],l=a.children,h=e;h<=f;h++)j.push(!1);for(p(l,function(a,b){var c=b.start,d=b.end,f;if(1===b.state())for(i=c;i<=d;i++)j[i-e]=!0;f=C?d+1:d-1,j[f-e]=!0,y.gM(b)}),o=!0,h=0;h<v(l);h++){if(q=l[h],r=q.start,s=q.end,t=r===G,u=s===H,t&&u){o=!1;break}if(C&&u||D&&t)for(i=r;i<=s;i++)j[i-e]=!0}if(o)for(w=e;w<=f;w++)j[w-e]||(x={index:w,level:I+1},y.cM.push(x))}}else 1===a.state()&&y.iM(!1,I,b,E,F,B)},iM:function(a,b,c,d,e,f){var g={isExpanded:a,level:b};a&&(g.paintLine=!0),c>=d&&c<=e&&(g.index=c,g.lineDirection=f,this.dM.push(g))},jM:function(a){var b=this,c=b.kj,d=b.eM;return b.ML?c.Gr(d).findRow(a):c.Hr(d).findCol(a)},aM:function(a){var b,c,d,e,f,g,h,i=this;i.ZL!==-1&&(b=i.kj.Gt(),c=i.ML,d=R.call(i,b,c),d&&(e=i.START_LINE_SIZE,f=i.PADDING,g=i.LINE_SIZE,h=m(0,(d-e)/2)+f,a.save(),a.fillStyle=q(B).color,i.kM(a,i.cM,c,b,d,h,g),i.lM(a,i.bM,c,b,d,h,g,e),i.mM(a,i.dM,c,b,d,h,g,f),a.beginPath(),a.restore()))},kM:function(a,b,c,d,e,f,g){var h,i,j=this;p(b,function(b,k){var l,n,o,p=j.jM(k.index);p&&(l=c?p.y:p.x,n=(c?p.height:p.width)-g,n>=0&&(h=l+m(0,n/2),i=k.level*e+f,c?(o=h,h=i+.5,i=o):i+=.5,a.fillRect(d.x+h,d.y+i,g,g)))})},lM:function(a,b,c,d,e,f,g,h){var i,j,k,l,o,p,q,r,s,t,u,w,x=this,y=x.kj,z=S(c,y).direction();for(i=0;i<v(b);i++){j=b[i],k=j.start,l=j.end;do o=x.jM(k),k++;while(!o&&k<=l);do p=x.jM(l),l--;while(!p&&l>=k);(o||p)&&(o?p||(p=o):o=p,q=c?o.y:o.x,r=j.level*e+f,s=c?g:m(0,p.x+p.width-o.x),t=c?m(0,p.y+p.height-o.y):g,1===z&&(q+=1),c?(u=q,q=r+.5,r=u):r+=.5,a.fillRect(d.x+q,d.y+r,s,t),j.startLine&&(w=n(h,e-g),w>0&&(0===z&&(c?r=r+t-g:q=q+s-g),c&&r>=o.y&&r<p.y+p.height?a.fillRect(d.x+q,d.y+r,w,g):!c&&q>=o.x&&q<p.x+p.width&&a.fillRect(d.x+q,d.y+r,g,w))))}},mM:function(a,b,c,d,e,f,g,h){var i,j,k,l,o,p,r,s,t,u,w,x,y,z,A,D,E,F,G,H,I=this;for(i=0;i<v(b);i++)j=b[i],k=I.jM(j.index),k&&(l=c?k.height:k.width,l<=0||(o=m(0,(l-e)/2),s=(c?k.y:k.x)+o,t=j.level*e+h,u=n(e,l),w=e,z=l-u,c?(A=s,s=t,t=A,D=u,u=w,w=D,x=.5,y=0):(x=0,y=.5),a.strokeStyle=q(C).borderTopColor,a.lineWidth=1,a.fillStyle=q(C).backgroundColor,a.fillRect(d.x+s,d.y+t,u,w),p=d.x+s+x,r=d.y+t+y,a.strokeRect(p,r,u,w),a.fillStyle=q(B).color,I.nM(a,j.isExpanded,p,r,u,w),j.paintLine&&z>0&&(s=c?k.y:k.x,t=j.level*e+f,E=0===j.lineDirection,F=c?g:o,G=c?o:g,c?(H=s,s=t,t=H,E&&(t+=o+w,G=z-o)):E&&(s+=o+u,F=z-o),a.fillRect(d.x+s+x,d.y+t+y,F,G))))},nM:function(a,b,c,d,e,f){b||a.fillRect(c+e/2-1,d+4,2,f-8),a.fillRect(c+4,d+f/2-1,e-8,2)},fM:function(a,b){var c,d,e,f=this,g=f.kj,h=[],i=-1,j=-1,k=S(b,g),l=b?g.Gr:g.Hr,o=l.call(g,f.eM),p=v(o);for(p&&(d=o[0],e=o[p-1],i=m(0,(b?d.row:d.col)-1),j=b?n(g.getRowCount(),e.row+2):n(g.getColumnCount(),e.col+2));i<j;)c=k.find(i,a),c?(i=c.end+1,h.push(c)):i++;return h},hM:function(a,b){var c=-1,d=this,e=d.kj,f=d.eM,g=e.frozenRowCount(),h=e.frozenColumnCount(),i=e.frozenTrailingRowCount(),j=e.frozenTrailingColumnCount(),k=e.getRowCount(),l=e.getColumnCount();return 0===f?c=a?0:(b?g:h)-1:1===f?c=a?b?g:h:(b?k-i:l-j)-1:2===f&&(c=a?b?k-i:l-j:(b?k:l)-1),c},oM:function(a){a&&this.kj.CH&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},XL:function(a,b,c){var d,e,f,g,h,i,j,l,o,p,q,s,t,u,w,x,y,z=this,A=z.ZL;if(A<0)return k;if(d=z.kj,e=d.Gt(),f=R.call(z,e,c),!f)return k;for(g=z.dM,j=0;j<v(g);j++)if(l=g[j],o=l.index,p=l.level*f+z.PADDING,q=z.jM(o),q&&(h=c?q.height:q.width,!(h<=0)&&(s=n(f,h),t=f,u=(c?q.y:q.x)+m(0,(h-f)/2),w=p,c&&(x=s,s=t,t=x,y=u,u=w,w=y),i=new r(e.x+u+.5,e.y+w+.5,s,t),z.oM(i),i.contains(a,b))))return l;return k}};function fa(a,b,c){var d=this;d.PADDING=2,d.kj=a,d.ML=b,d.ZL=w(c)?c:S(b,a).getMaxLevel()}fa.prototype={_L:function(a){var b,c,d,e,f,g,h,i,j,k,l,n,o,p,r,s,t,u,v,w,x,y,A,D,E,F,G,H=this,I=H.kj,J=H.ZL;if(!(J<0)&&(b=H.ML,c=I.Gt(),d=R.call(H,c,b),d&&(e=J+2,f=H.PADDING,g=I.options,h=c.width,i=c.height,j=c.x,k=c.y,l=I.am(),n=l.width,o=l.height,p=l.Cr,r=l.Br,s=l.zr,t=l.Ar,a.fillStyle=q(B).backgroundColor,a.strokeStyle=q(C).borderTopColor,a.font="8.25pt Arial",a.lineWidth=1,a.fillRect(j,k,b?h:n,b?o:i),a.strokeRect(j-.5,k-.5,b?h:n+1,b?o+1:i),b?a.strokeRect(j-.5,t-.5,h,p):a.strokeRect(s-.5,k-.5,r,i),u=(b?p:r)-d,w=m(0,(b?t:s)+u/2),x=f,b&&(A=w,w=x,x=A),v=b?g.colHeaderVisible:g.rowHeaderVisible,v&&u>=0)))for(y=0;y<e;y++)D=d-1,F=j+w,G=k+x,b?F+=.5:G+=.5,a.fillStyle=q(C).backgroundColor,a.fillRect(F,G,D,D),a.strokeRect(F,G,D,D),a.fillStyle=q(C).color,E=z(a.font),H.pM(a,F,G,D,d,y+1,E),b?w+=d:x+=d},pM:function(a,b,c,d,e,f,g){var h=""+f,i=a.measureText(h).width;i<=d&&g<=e&&(a.textBaseline="middle",a.fillText(h,b+(d-i)/2,c+d/2))},WL:function(a,b,c){var d,e,f,g=this,h=g.kj,i=g.ZL;return i<0?k:(d=i+2,e=h.am(),f=h.options,c?g.qM(h,a,b,c,f.colHeaderVisible,e.Cr,e.Ar,d):g.qM(h,a,b,c,f.rowHeaderVisible,e.Br,e.zr,d))},qM:function(a,b,c,d,e,f,g,i){var j,l,n,o,p,q=this,r=a.Gt(),s=R.call(q,r,d),t=f-s;if(s&&e&&t>=0)for(j=m(0,g+t/2),l=q.PADDING,d&&(p=j,j=l,l=p),o=0;o<i;o++){if(n=new h.Rect(r.x+j,r.y+l,s,s),n.contains(b,c))return{index:o};d?j+=s:l+=s}return k}},e={init:function(){var a=this;a.rowOutlines=new d(a.getRowCount(),a),a.columnOutlines=new d(a.getColumnCount(),a),a.rowOutlines.groupChangeHandler=function(b){b&&b.indexes&&a.recalcRows&&a.recalcRows(b.indexes),a.au()},a.columnOutlines.groupChangeHandler=function(){a.bu()},a.Wr.push(a.rowOutlines),a.Zr.push(a.columnOutlines)},dispose:function(){var a=this;o(a.Ws()).unbind("mousedown.group")},setHost:function(a){if(a){var b=this;a.bind("mousedown.group",function(a){var c,d=b.Vs(),e=O.call(b,a.pageX-d.left,a.pageY-d.top);e&&(c=e.what,c===F||c===D?b.rowOutlines.UL(b,e):c!==G&&c!==E||b.columnOutlines.UL(b,e))})}},onPaintSuspend:function(a){var b=this;a.suspend?(b.rowOutlines.Lia(),b.columnOutlines.Lia()):(b.rowOutlines.Mia(),b.columnOutlines.Mia())},onLayoutChanged:function(a){var b=this,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=a.sheetArea,i=b.rowOutlines,j=b.columnOutlines;"addRows"===c?T(i,d,e):"deleteRows"===c?U(i,d,e):"addColumns"===c?T(j,f,g):"deleteColumns"===c?U(j,f,g):"invalidateLayout"===c?b.TL=k:"setColumnCount"===c?3!==h&&1!==h||j.VL(g):"setRowCount"!==c||3!==h&&2!==h||i.VL(e)},paint:function(a){var b=a.ctx,c=a.clipRect,d=this,e=d.rowOutlines,f=d.columnOutlines;e&&e.jp(d,b,c,!0),f&&f.jp(d,b,c,!1)},fromJson:function(a,b,c){if(a){var d=this,e,f=a.showRowRangeGroup,g=a.showColumnRangeGroup,h=w(f)?f:a.showRowOutline,i=w(g)?g:a.showColumnOutline;x(h)||d.showRowOutline(h),x(i)||d.showColumnOutline(i),e=a.rowRangeGroup||a.rowOutlines,e&&d.rowOutlines.fromJSON(e,c),e=a.colRangeGroup||a.columnOutlines,e&&d.columnOutlines.fromJSON(e,c)}},toJson:function(a,b){var c,d=this,e=d.rowOutlines,f=d.columnOutlines,g=d.showRowOutline();g!==!0&&(a.showRowOutline=g),c=d.showColumnOutline(),c!==!0&&(a.showColumnOutline=c),a.rowOutlines=e?e.toJSON(b):l,a.columnOutlines=f?f.toJSON(b):l}},h.Worksheet.$n(A,e),f={init:function(){i.SL(this.commandManager())}},h.Workbook.$n(A,f),a.exports=j}()},function(a,b){!function(){"use strict";a.exports={Exp_InvalidIndex:"Invalid index",Exp_InvalidCount:"Invalid count",Exp_InvalidLevel:"Invalid level",Exp_GroupInfoIsNull:"groupInfo is null"}}()}]);
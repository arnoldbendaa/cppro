/*!
 * 
 * Spread.Sheets Library 11.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Slicers=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);c(8),b.SR={},b.SR.en=c(9),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p=c(2),q=c(3),r=c(4),s=c(5),t=c(6),u=c(7),v=q.D,w={},x=function(){return q.C(w.SR)()},y=q.k,z=p.GC$,A=p.To,B=p.Commands,C=p.Ul.Nl,D=p.Ul.Pl,E=p.Ul.Ol,F=y.ac,G=z.isArray,H=z.extend,I=document,J=void 0,K=null,L="normal 11pt calibri",M=parseFloat,N="name",O="style",P="Style",Q="light",R="dark",S="white",T="black",U="solid",V="color",W="Color",X="background-color",Y="width",Z="Width",$="height",_="font",aa="setBorders",ba="back"+W,ca="fore"+W,da="border",ea=da+"Width",fa=da+P,ga=da+W,ha=da+"Left",ia=da+"Top",ja=da+"Right",ka=da+"Bottom",la="textDecoration",ma="WithData"+P,na="WithNoData"+P,oa="electedItem",pa="hovered",qa="wholeSlicer"+P,ra="header"+P,sa="s"+oa+ma,ta="s"+oa+na,ua="unS"+oa+ma,va="unS"+oa+na,wa=pa+"S"+oa+ma,xa=pa+"S"+oa+na,ya=pa+"UnS"+oa+ma,za=pa+"UnS"+oa+na,Aa="div",Ba="px",Ca="default",Da="cursor",Ea="position",Fa="absolute",Ga="padding",Ha="top",Ia="margin-"+Ha,Ja="left",Ka="right",La="text-align",Ma="overflow",Na="hidden",Oa="auto",Pa="text-overflow",Qa="ellipsis",Ra="white-space",Sa="nowrap",Ta="unselectable",Ua="on",Va="font-weight",Wa="font-size",Xa="border-radius",Ya="box-sizing",Za="content-box",$a="button",_a="\u2717",ab="mark",bb="itemValue",cb="Accent ",db="Slicer"+P,eb="#999999",fb="#828282",gb="#CCCCCC",hb="gc-slicer-",ib="container",jb=hb+ib,kb="header",lb=hb+kb,mb=hb+"header-borderDiv",nb=hb+"caption",ob="clearfilter",pb=hb+ob,qb="body",rb=hb+qb,sb=hb+"table",tb=hb+"tr",ub=hb+"td1",vb=hb+"td2",wb="itemscontainer",xb=hb+wb,yb="item",zb=hb+yb,Ab="gc-no-user-select",Bb=function(){var a,b,c,d=[ba,ca,_,ha,ia,ja,ka,la];function e(a,b,c,e,f,g,h,i){for(var j=0,k=F(d);j<k;j++)this[d[j]](arguments[j])}for(a={constructor:e,setBorders:function(a){var b=this;b[ha](a)[ia](a)[ja](a)[ka](a)},fromJSON:function(a){if(a&&!z.isEmptyObject(a)){var b=this;d.forEach(function(c){var d,e=a[c];E(e)&&(c.indexOf(da)>=0?(d=Db(),d.fromJSON(e),b[c](d,!1)):b[c](e,!1))})}},toJSON:function(){var a=this,b={};return d.forEach(function(c){var d=a[c]();a[c].isDefault(d)||(b[c]=d&&d.toJSON?d.toJSON():d)}),b}},b=0,c=F(d);b<c;b++)a[d[b]]=D(d[b]);return e.prototype=a,e}();function Cb(a){var b,c;return a&&0!==F(a)?0===a.indexOf(Q)?(c=parseInt(a.replace(Q,"")),b=f[Q+c]()):0===a.indexOf(R)?(c=parseInt(a.replace(R,"")),b=f[R+c]()):f[a]&&(b=f[a]()):b=new Bb,b}b=function(){var a,b,c,d=[ea,fa,ga],e=F(d);function f(a,b,c){for(var f=0;f<e;f++)this[d[f]](arguments[f])}for(a=function(a,b,c){return D(a,b,c,function(b){var c=typeof b;return a===ea?"number"===c&&b>=0:"string"===c})},b={constructor:f,fromJSON:function(a){var b,c;if(a&&!z.isEmptyObject(a))for(b=0;b<e;b++)c=d[b],E(a[c])&&this[c](a[c],!1)},toJSON:function(){var a,b,c,f={};for(a=0;a<e;a++)f[d[a]]=this[d[a]]();b={};for(c in f)f[c]!==J&&f[c]!==K&&(b[c]=f[c]);return b}},c=0;c<e;c++)b[d[c]]=a(d[c],J,J);return f.prototype=b,f}();function Db(a,c,d){return new b(a,c,d)}function Eb(){var a=new b(0,"",""),c=new Bb(S,T,L);return c.setBorders(a),c}function Fb(a){var b=0,c=17,d=16;return a.indexOf(db+"Light")>-1&&F(a)===c&&(b=parseInt(a[c-1])),a.indexOf(db+"Dark")>-1&&F(a)===d&&(b=parseInt(a[d-1])),b>=1&&b<=6}d=function(){var a,b,c,d;function e(a,b,c,d){return D(a,b,c,d)}function f(){var a=this;a[N](""),a[qa](Eb(),!1)}for(a=[N,qa,ra,sa,ta,ua,va,wa,xa,ya,za],b={constructor:f,name:e(N,""),fromJSON:function(b){var c,d,e,f;if(b&&!z.isEmptyObject(b))return c=this,d=b.name,E(d)&&(c.name(d,!1),Fb(d))?(e=d.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),f=Cb(e),void a.forEach(function(a){c[a](f[a](),!1)})):void a.forEach(function(a){var d,e=b[a];a!==N&&E(e)&&(d=Cb(),d.fromJSON(e),c[a](d,!1))})},toJSON:function(){var a,b,c,d=this;a=Fb(d.name())?{name:d.name()}:d.toJSONInternal(),b={};for(c in a)a[c]===K||a[c]===J||p.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},toJSONInternal:function(){var b,c,d,e=this,f={},g="toJSON";for(f[N]=e.name(),b=1,c=F(a);b<c;b++)d=a[b],f[d]=e[d]()?e[d]()[g]():K;return f}},c=1,d=F(a);c<d;c++)b[a[c]]=e(a[c]);return f.prototype=b,f}();function Gb(){return new d}e=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w,x,y=Gb(),z=db+a+b;return y[N](z),w=Cb(),w[_](c)[ba](d)[aa](e),y[qa](w),x=Cb(),x[ha](f)[ia](f)[ja](f)[ka](g),y[ra](x),y[sa](Ib(h,i,j)),y[ta](Ib(k,l,m)),y[ua](Ib(n,o,p)),y[va](Ib(q,r,s)),Hb(y,Ib(t,u,v)),y};function Hb(a,b){a[wa](b)[xa](b)[ya](b)[za](b)}function Ib(a,b,c){var d=Cb();return d[ca](a)[ba](b)[aa](c),d}function Jb(a){var b=cb+a;return e("Light",a,L,S,Db(1,U,b),Db(0,"",""),Db(1,U,b),T,b+",Lighter 60%",Db(1,U,eb),fb,b+",Lighter 80%",Db(1,U,gb),T,S,Db(1,U,gb),fb,S,Db(1,U,"#E0E0E0"),T,"#F9E36F",Db(1,U,eb))}function Kb(a){var b=cb+a;return e("Dark",a,L,S,Db(1,U,b),Db(0,"",""),Db(1,U,b),S,b,Db(1,U,b),b+",Darker 25%",b+",Lighter 60%",Db(1,U,b+",Lighter 60%"),T,"#C0C0C0",Db(1,U,"#C0C0C0"),"#959595","#DFDFDF",Db(1,U,"#DFDFDF"),T,"#F9E36F",Db(1,U,eb))}f=function(){function a(){}for(var b=1;b<=6;b++)a["light"+b]=function(a){return function(){return Jb(a)}}(b),a["dark"+b]=function(a){return function(){return Kb(a)}}(b);return a.other1=function(){return e("Other",1,L,S,Db(1,U,"#808080"),Db(0,"",""),Db(1,U,"#A6A6A6"),T,"#BFBFBF",Db(1,U,eb),T,"#D9D9D9",Db(1,U,gb),T,S,Db(1,U,gb),"#959595",S,Db(1,U,"#E0E0E0"),T,"#F9E36F",Db(1,U,eb))},a.other2=function(){return e("Other",2,L,S,Db(1,U,"#4F81BD"),Db(0,"",""),Db(1,U,"#4F81BD"),T,"#A9C1E3",Db(1,U,eb),fb,"#D5E2F6",Db(1,U,gb),T,S,Db(1,U,gb),fb,S,Db(1,U,"#E0E0E0"),T,"#F9E36F",Db(1,U,eb))},a}();function Lb(a,b){var c,d,e,f,g,h,i=a.KW,j=a._caption,k=Pb(a.slicerData),l=a.zoomFactor();if(b){b[qa]&&(Rb(a.xo,b[qa],k,j,l),oc(a,ib)),c=a.LW,d=Nb(b[qa],b[ra]),Sb(b)?(e=d[ka],f=e&&e[ea]||0,c[O][$]=(a.MW-f)*Tb(b)*l+Ba,Qb(c,e,k,ka),d[ha]=d[ia]=d[ja]=d[ka]=K):(c[O][ka+Y]=0+Ba,c[O][$]=i[O][$]),Rb(i,d,k,j,l),oc(a,kb);for(g in a.NW)v(a.NW,g)&&(h=parseInt(g),lc(a,h))}}function Mb(a,b,c){var d,e,f={};if(b&&c&&F(b)===F(c)){for(d=0,e=F(b);d<e;d++)f[b[d]]=c[d];z(a).css(f)}}function Nb(a,b){var c={},d;if(b)for(d in b)v(b,d)&&(c[d]=b[d]);if(a)for(d in a)c[d]===J&&a[d]!==J&&(c[d]=a[d]);return c}function Ob(a,b){if(!b)return a;var c;return a&&b.getColor&&(c=b.getColor(a)),c}function Pb(a){var b=a&&a.OW&&a.OW();return b&&b.currentTheme()}function Qb(a,b,c,d){if(a){var e=b&&b[ea]||0,f=b&&b[fa]||"",g=b&&b[ga]||"";a[O][d+Z]=e+Ba,a[O][d+P]=f,a[O][d+W]=Ob(g,c)}}function Rb(a,b,c,d,e){var f,g,h,i;a&&b&&(f=b[ca]||T,g=b[ba]||S,h=b[_]||L,a[O][X]=Ob(g,c),a[O][V]=Ob(f,c),a[O][_]=A.No(h,e)[_],Qb(a,b[ha],c,ha),Qb(a,b[ia],c,ia),Qb(a,b[ja],c,ja),Qb(a,b[ka],c,ka),i=A.So(b[la]),q.u.Bb(a.className,lb)?d[O][la]=i:q.u.Bb(a.className,zb)&&(a[O][la]=i))}function Sb(a){var b,c=a[ra];return!c||!(c[ha]||c[ia]||c[ja]||c[ja])||(b=Nb(a[qa],c),!(!(b[ka]&&b[ka][ea]>0)||b[ha]&&0!==b[ha][ea]||b[ia]&&0!==b[ia][ea]||b[ja]&&0!==b[ja][ea]))}function Tb(a){var b,c,d,e,f,g,h,i,j;return a?(b=Nb(a[qa],a[ra]),b&&b[_]?(c=b[_],d=1,e=A.Ko,f=A.Jo,g=e(f(L)).fontSize,h=e(f(c)).fontSize,g&&h&&(i=M(g),j=M(h),isNaN(j)||(d=j/i)),d):1):1}function Ub(a){var b,c,d,e,f,g=0,h=0;return a&&(b=a[O],c=b[ha+Z],d=b[ia+Z],e=b[ja+Z],f=b[ka+Z],c&&(g+=M(c)),d&&(h+=M(d)),e&&(g+=M(e)),f&&(h+=M(f))),{widthOffset:g,heightOffset:h}}function Vb(a){var b,c,d=[];if(a)for(c=0;c<F(a);c++)b=a[c]===J||a[c]===K||""===a[c]?x().Blank:a[c]+"",d.push(b);return d}function Wb(a){var b=C(Aa);return Mb(b,[Ea,Ga,Ya,Ma],[Fa,6*a.zoomFactor(),Za,Na]),z(b).addClass(jb),oc(a,ib),z(b).append(Xb(a)).append(Yb(a)),b}function Xb(a){var b,c,d,e,f,g,h,i,j=C(Aa),k=C(Aa),l=C("span"),m=C(Aa),n=a.zoomFactor(),o=a.style();return Mb(j,[Y,Ea,Ha,Ja,Ka,Ya,Ma],[Oa,Fa,0,0,0,Za,Na]),z(j).addClass(lb),a.KW=j,b=a.PW*n,Mb(k,[Y,Ea,Ja,Ka,Ya,Ma],[Oa,Fa,b,b,Za,Na]),z(k).addClass(mb),a.LW=k,z(j).append(k),c=a.QW*Tb(o)*n,d=_b(a)*n,Mb(l,[Ya,Ea,Ha,Ma,Y,Pa,Ra],[Za,Fa,c,Na,d,Qa,Sa]),z(l).text(a.captionName()).attr(Ta,Ua).addClass(nb+" "+Ab),a._caption=l,e=a.RW*n,f=a.SW*n,g=a.TW*Tb(o)*n,h=a.UW*n,i=a.VW*n+Ba,Mb(m,[Y,$,Da,Ea,Ha,Ka,La,Ya,Va,Xa,Ma,Wa],[e,f,Ca,Fa,g,h,"center",Za,"normal",2,Na,i]),z(m).attr("title","Clear Filter (Alt+C)").attr(Ta,Ua).text(_a).addClass(pb+" "+Ab),a.WW=m,oc(a,kb),z(k).append(l).append(m),j}function Yb(a){var b,c=C(Aa),d=C("table"),e=C("tr"),f=C("td"),g=C("td"),h=(a.MW-a.PW+a.XW)*Tb(a.style())*a.zoomFactor();return Mb(c,[Y,Ma,Ia,Ya],[Oa,Na,h,Za]),z(c).attr(Ta,Ua).addClass(rb+" "+Ab),a.YW=c,Mb(d,[Ya,"border-spacing"],[Za,0+Ba]),z(d).attr(Ta,Ua).addClass(sb+" "+Ab),a.ZW=d,z(e).css(Ya,Za).addClass(tb),a.$W=e,Mb(f,[Ga,Ya],[0,Za]),z(f).addClass(ub),a._W=f,Mb(g,[Ga,Ya,Da],[0,Za,Ca]),z(g).addClass(vb),a.aX=g,z(f).append(Zb(a)),b=fc(a),z(g).append(b),a.bX=b,z(e).append(f).append(g),z(d).append(e),z(c).append(d),c}function Zb(a){var b,c,d,e,f,g,h,i=C(Aa),j=a.zoomFactor();for(a.cX=i,c=ac(a),a.dX=c,b=bc(a),a.eX=b,Mb(i,[Y,$,Wa],[b*j,c*j,a.VW*j+Ba]),z(i).attr(Ta,Ua).addClass(xb+" "+Ab),d=ec(a),a.fX=d,e=Math.min(dc(a),F(d)),f=0;f<e;f++)g=d[f],h=$b(a,g,f),z(i).append(h),a._items.push(h),a.NW[a.gX.indexOf(g)]=h;return i}function $b(a,b,c){var d=b,e=C($a),f=a.zoomFactor(),g=a.hX*f+Ba;return Mb(e,[La,Ra,Ia,Da,Ya,Xa,Ga,Ma,Pa,X],[Ja,Sa,g,Ca,Za,5,"1px 6px",Na,Qa,S]),z(e).attr("type",$a).attr(Ta,Ua).text(d).addClass(zb+" "+Ab),(c+1)%a.columnCount()!==0&&z(e).css("margin-right",a.hX*f+Ba),oc(a,yb,e),e}function _b(a){var b,c,d=a.xo,e=a.KW,f=1,g=1,h=0,i=0,j=function(a){return a?M(a):0},k=da+"Left"+Z,l=da+"Right"+Z;return d&&(b=d.style,f=j(b[k]),g=j(b[l])),e&&(c=e.style,h=j(c[k]),i=j(c[l])),a.width()-(f+g)-2*a.PW-(h+i)-a.RW}function ac(a){var b=Ub(a.xo),c=a.height()-2*a.PW-b.heightOffset;return a.showHeader()?c-a.MW*Tb(a.style())-a.XW:c}function bc(a){var b=Ub(a.xo),c=a.width()-2*a.PW-b.widthOffset-1;return a.iX()?c-a.jX:c}function cc(a,b){var c=a.columnCount();return(b-(c-1)*a.hX)/c}function dc(a){return Math.ceil(a.dX/(a.itemHeight()+2*(a.kX+a.lX)+a.hX))*a.columnCount()}function ec(a){var b,c,d,e,f,g,h=a.gX,i=a.mX(h.slice(0),a.sortState()),j=a.slicerData.getFilteredOutIndexes(a.columnName,2);if(a.showNoDataItems()){if(a.visuallyNoDataItems()&&a.showNoDataItemsInLast()){for(b=[],d=F(i),e=0;e<d;e++)f=i[e],y.Bb(j,h.indexOf(f))||b.push(f);for(e=0;e<d;e++)f=i[e],y.Bb(j,h.indexOf(f))&&b.push(f);i=b}}else for(b=i.concat(),c=0;c<F(b);c++)y.Bb(j,h.indexOf(b[c]))&&y.Fb(i,b[c]);return g=x().Blank,y.Bb(i,g)&&(y.Fb(i,g),i.push(g)),i}function fc(a){var b,c=new p.hv((!1));return a.nX=c,b=c.Bv(),z(b).bind("scroll.gcScrollbar",function(b,c){var d,e=c.scrollEventType,f=c.scrollOrientation;b.data=a,1===f&&(d=[0,1,2,3,5],d.indexOf(e)>=0&&a.Bw(b,c))}),b}function gc(a){var b=a.slicerData;a.data=b.getData(a.columnName),a.exclusiveDatas=b.getExclusiveData(a.columnName),a.oX=Vb(a.data),a.gX=Vb(a.exclusiveDatas),a.fX=ec(a),nc(a),kc(a)}function hc(a,b){var c,d=a.style(),e=a.xo;e&&(b!==J&&b!==a.zoomFactor()&&(a.zoomFactor(b),Lb(a,d)),z(e).css(Ga,6*b),oc(a,ib),ic(a),c=a.showHeader()?(a.MW+a.XW-a.PW)*Tb(d)*b:0,z(a.YW).css(Ia,c),jc(a),nc(a))}function ic(a){var b,c,d,e,f,g,h,i,j,k=a.zoomFactor(),l=a.KW,m=a.YW,n=a._caption,o=a.WW,p=a.style();a.showHeader()?(a.xo.firstChild!==l&&(z(l).insertBefore(m),z(m).css(Ia,(a.MW+a.XW)*Tb(p)*k)),z(l).css($,a.MW*Tb(p)*k),b=a.PW*k,Mb(a.LW,[Ja,Ka],[b,b]),n.innerHTML!==a.captionName()&&z(n).text(a.captionName()),c=a.QW*Tb(p)*k,d=_b(a)*k,Mb(n,[Ha,Y,Va],[c,d,"bold"]),e=a.pX,f=e&&F(e)>0?1:0,yc(a,f),g=a.RW*k,h=g,i=a.TW*Tb(p)*k,j=a.UW*k,Mb(o,[Y,$,Ha,Ka],[g,h,i,j]),oc(a,kb)):z(l).remove()}function jc(a){var b,c=a.zoomFactor(),d=ac(a);a.dX=d,b=bc(a),a.eX=b,Mb(a.cX,[Y,$,Wa],[b*c,d*c,a.VW*c]),kc(a)}function kc(a){var b,c,d,e,f,g,h,i,j=a.fX;if(j){for(b=a._items,b&&F(b)>0&&z(b).remove(),a._items=[],b=a._items,a.NW={},c=Math.min(dc(a),F(j)),d=a.iX()?a.nX.value()*a.columnCount():0,e=Math.min(d+c,F(j)),f=d;f<e;f++)g=j[f],h=$b(a,g,f),z(a.cX).append(h),b.push(h),a.NW[a.gX.indexOf(g)]=h;if(0!==F(b))for(i in a.NW)v(a.NW,i)&&lc(a,parseInt(i))}}function lc(a,b){var c=a.qX,d=c?a.gX.indexOf(c[bb]):-1,e=a.pX,f=a.rX,g=a.NW[b],h=0;b===d&&(h|=1),h|=y.Bb(e,b)?4:2,h|=y.Bb(f,b)&&a.visuallyNoDataItems()?16:8,mc(a,g,h)}function mc(a,b,c){var d=a.style(),e;if(b&&d){switch(c){case 10:e=sa;break;case 18:e=ta;break;case 12:e=ua;break;case 20:e=va;break;case 11:e=wa;break;case 19:e=xa;break;case 13:e=ya;break;case 21:e=za}Rb(b,Nb(d[qa],d[e]),Pb(a.slicerData),a._caption,a.zoomFactor()),oc(a,yb,b)}}function nc(a){var b,c,d,e,f,g=a.bX,h=a.aX;a.iX()?(g||(g=fc(a)),h.firstChild!==g&&(z(h).append(g),jc(a)),b=a.zoomFactor(),c=a.dX,d=Math.floor(c/(a.itemHeight()+2*a.kX+a.hX)),e=a.nX,e.value(a.sX),e.Vo(a.jX*b,!1),e._v(c*b,!1),e.bw(0),e.cw(Math.ceil(F(a.gX)/a.columnCount())-d),e.dw(d),e.qB(1),e.rB(d-1),e.ew()):(h.firstChild===g&&(f=g.parentElement,f&&f.removeChild(g),jc(a)),a.sX=0)}function oc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.zoomFactor();switch(b){case ib:g=a.xo,h=Ub(g),i=a.PW,d=(a.width()-2*i)*n-h.widthOffset,e=(a.height()-2*i)*n-h.heightOffset,f=g;break;case kb:j=a.KW,k=Ub(j),l=a.MW*Tb(a.style())*n-k.heightOffset,z(j).css($,l),d=a.RW*n,e=a.SW*n,f=a.WW;break;case yb:m=Ub(c),d=cc(a,a.eX)*n-2*a.tX-m.widthOffset,e=a.itemHeight()*n-m.heightOffset,f=c}Mb(f,[Y,$],[d,e])}function pc(a){var b=a.xo,c=".slicer",d="mouse",e="wheel",f="DOMMouseScroll";b&&(z(b).bind(d+"down"+c,function(b){a.AD(b)}).bind(d+"up"+c,function(b){a.CD(b)}).bind(d+"move"+c,function(b){a.BD(b)}).bind(d+"out"+c,function(b){a.uX(b)}),b.addEventListener(d+e,function(b){a.Rw(b)},!1),b.addEventListener(f,function(b){a.Rw(b)},!1),z(I).bind(d+"up"+c,function(b){xc(a,b)}).bind("keydown"+c,function(b){a.nm(b)}).bind("keyup"+c,function(b){a.om(b)}),I.addEventListener(d+e,function(b){a.Rw(b)},!1),I.addEventListener(f,function(b){a.Rw(b)},!1))}function qc(a){var b=a.xo;b&&z(b).unbind(".slicer")}function rc(a,b){var c,d,e,f=a.exclusiveDatas,g=a.pX,h=vc(a,b[bb]),i=a.vX,j=a.wX;for(y.Bb(i,h)?y.Fb(i,h):i.push(h),c=0;c<F(f);c++)y.Bb(g,c)||j.push(c);for(d=0;d<F(i);d++)y.Bb(j,i[d])?y.Fb(j,i[d]):j.push(i[d]);if(0===F(j))for(e=0;e<F(a.gX);e++)j.push(e);a.xX=h}function sc(a,b){var c,d,e,f,g,h,i,j,k=a.fX,l=a.gX,m=l[a.xX];for(uc(a),c=k.indexOf(m),d=k.indexOf(b[bb]),e=Math.min(c,d),f=Math.max(c,d),g=e;g<=f;g++)h=l.indexOf(k[g]),i=a.vX,j=a.wX,i.indexOf(h)===-1&&i.push(h),j.indexOf(h)===-1&&j.push(h)}function tc(a,b){uc(a);var c=vc(a,b[bb]);lc(a,c),a.vX.push(c),a.wX.push(c),a.xX=c}function uc(a){var b,c,d,e,f,g,h=a._items;if(h&&0!==F(h))for(b=a.rX,c=0,d=F(h);c<d;c++)e=h[c],f=a.gX.indexOf(h[c].innerHTML),g=y.Bb(b,f)?20:12,mc(a,e,g)}function vc(a,b){var c,d,e=a.gX;if(e)for(c=0,d=F(e);c<d;c++)if(e[c]===b)return c;return-1}function wc(a,b){var c,d,e=a.pX,f=a.rX;for(c=0;c<F(b);c++)d=0,d|=a.yX?y.Bb(e,b[c])?2:4:2,d|=y.Bb(f,b[c])&&a.visuallyNoDataItems()?16:8,mc(a,a.NW[b[c]],d)}function xc(a,b){var c=a.qX;a.CD(b),c=c?new h(c[ab],c[bb]):K,a.qX=K,zc(a,c)}function yc(a,b){var c,d,e,f=a.WW;if(f)switch(c=a.style(),d=Nb(c[qa],c[ra]),e=d&&d[ba],e||(e=S),a.zX=e,b){case 0:a.AX=!1,Mb(f,[V,X],[a.BX,e]);break;case 1:a.AX=!0,Mb(f,[V,X],[a.CX,e]);break;case 2:z(f).css(X,a.DX)}}function zc(a,b){var c,d;if(b)switch(c=a.vX,b[ab]){case 4:if(!a.WW)return;a.AX?yc(a,1):yc(a,0);break;case 5:d=a.gX.indexOf(b[bb]),c&&y.Bb(c,d)?wc(a,c):lc(a,d)}}function Ac(a,b){if(b)switch(b[ab]){case 4:if(!a.WW||!a.AX)return;yc(a,2);break;case 5:var c=a.gX.indexOf(b[bb]);lc(a,c);break;case 6:a.cX.style.cursor=Ca}}function Bc(a,b){var c,d,e=a._items;if(e&&b!==K)for(c=0;c<F(e);c++)if(d=e[c],d.innerHTML.toLowerCase()===b.toLowerCase())return d;return K}function Cc(a,b){var c,d,e,f,g,i,j,k,l,m,n,o=Dc(a,ib),p=K,q=K;if(!o)return K;if(c=b.pageX,d=b.pageY,e=Dc(a,kb),f=Dc(a,ob),g=Dc(a,qb),i=Dc(a,wb),e&&e.contains(c,d))p=f&&f.contains(c,d)?4:1;else if(g&&g.contains(c,d))if(j=a._items,i&&i.contains(c,d)&&j){for(k=0;k<F(j);k++)if(l=Dc(a,yb,k),l&&l.contains(c,d)){p=5;for(m in a.NW)if(a.NW[m]===j[k]){q=a.gX[m];break}break}k>=F(j)&&(n=Dc(a,yb,F(j)-1),p=d<n.y+a.itemHeight()*a.zoomFactor()?6:7)}else p=8;else p=0;return new h(p,q)}function Dc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=b===ib?J:Dc(a,ib),q=a.xo,r=a.EX,s=a.PW,t=a.zoomFactor(),u=a.style(),v=a.showHeader(),w=a.MW,x=a.RW,y=a.gX;switch(b){case ib:d=0,e=0,f=q.offsetWidth,g=q.offsetHeight;do d+=q.offsetLeft,e+=q.offsetTop,q=q.offsetParent;while(q);break;case kb:if(!o||!v)return K;d=o.x+r*t,e=o.y+r*t,f=a.width()*t,g=w*Tb(u)*t;break;case ob:if(!o||!v)return K;d=o.x+o.width-(r+s+x)*t,e=o.y+r+a.QW*Tb(u)*t,f=x*t,g=a.SW*t;break;case qb:if(!o)return K;h=r+s,i=0,j=w*Tb(u)+a.XW,d=o.x+h*t,e=o.y+i*t+(v?j*t:0),f=(a.width()-2*h)*t,g=o.height-2*i*t-(v?j*t:0);break;case wb:if(k=Dc(a,qb),!k)return K;if(!a.iX())return k;d=k.x,e=k.y,f=k.width-a.jX*a.zoomFactor(),g=k.height;break;case yb:if(!o||0===F(y)||c>=F(y))return K;if(l=Dc(a,wb),!l)return K;m=a.columnCount(),n=a.hX,f=(l.width-(m-2)*n*t)/m,g=a.itemHeight()*t+2*a.lX,d=l.x+c%m*(f+n*t),e=l.y+Math.floor(c/m)*(g+n*t)}return new p.Rect(d,e,f,g)}function Ec(a){return a>0}g=function(){var a,b,c,d;function e(){hc(this)}function f(){var a=this;a.fX=ec(a),hc(a)}function g(a,b,c,d){return c||(c=e),p.Ul.Pl(a,b,c,d)}function i(a,b,c){var d=this;d.name(a,!1),d.xo=K,d.PW=6,d.EX=1,d.VW=14,d.KW=K,d.MW=27,d.XW=5,d._caption=K,d.WW=K,d.RW=28,d.SW=25,d.TW=3,d.UW=0,d.AX=!1,d.QW=3,d.YW=K,d.ZW=K,d.$W=K,d._W=K,d.aX=K,d.cX=K,d.eX=0,d.dX=0,d.bX=K,d.FX=2,d._items=[],d.NW={},d.lX=1,d.kX=1,d.tX=6,d.hX=2,d.jX=17,d.sX=0,d.zX=S,d.DX="#F9E578",d.CX="red",d.BX="#B0ADB0",d.GX=!1,d.HX=!1,d.vX=[],d.wX=[],d.xX=0,d.fX=[],d.pX=[],d.rX=[],d.gX=[],d.oX=[],d.slicerData=b,d.columnName=c,d.data=b.getData(c),d.exclusiveDatas=b.getExclusiveData(c),d.slicerData.attachListener(d),d.IX()}for(i.getDefaultStyle=function(){var a=function(a,b,c,d,e,f,g,h){var i={};return i[ba]=a,i[ca]=b,i[_]=c,i[ha]=d,i[ia]=e,i[ja]=f,i[ka]=g,i[la]=h,i},b=function(a,b,c){var d={};return d[ea]=a,d[fa]=b,d[ga]=c,d},c=b(1,U,"#808080"),d=b(0,"",""),e=b(1,U,"#999999"),f=b(1,U,"#CCCCCC"),g=b(1,U,"#E0E0E0"),h=a("#F9E36F",T,L,e,e,e,e),i={};return i[qa]=a(S,T,L,c,c,c,c),i[ra]=a(S,T,"bold 11pt calibri",d,d,d,b(1,U,"#A6A6A6")),i[sa]=a("#BFBFBF",T,L,e,e,e,e),i[ta]=a("#D9D9D9",T,L,f,f,f,f),i[ua]=a(S,T,L,f,f,f,f),i[va]=a(S,"#959595",L,g,g,g,g),i[wa]=h,i[xa]=h,i[ya]=h,i[za]=h,i},a=[[N],[Y,180],[$,210],["captionName",""],["columnCount",1,K,Ec],["itemHeight",21,K,Ec],["showHeader",!0],["sortState",1,f],["showNoDataItems",!0,f],["showNoDataItemsInLast",!0,f],["visuallyNoDataItems",!0,f],[O,i.getDefaultStyle(),function(a){Lb(this,a),hc(this)}],["zoomFactor",1,K,Ec],["isLocked"],["disableResizingAndMoving"]],b={constructor:i,IX:function(){var a=this;a.oX=Vb(a.data),a.gX=Vb(a.exclusiveDatas),a.xo=Wb(a),a.captionName(a.columnName,!1),pc(a),a.onFiltered(),Lb(a,a.style()),hc(a)},getDOMElement:function(){return this.xo},mX:function(a,b){var c,d,e=[];if(0!==b){for(c=r.jf.quickSort(a),d=0;d<F(c);d++)e[d]=c[d].value;return 2===b&&e.reverse(),e}},iX:function(){var a=this,b=a.gX,c=a.showNoDataItems()?F(b):F(b)-F(a.rX),d=Math.ceil(c/a.columnCount())*(a.itemHeight()+2*(a.lX+a.kX)+a.hX);return d>a.dX},Bw:function(a,b){this.JX(a,b)},JX:function(a,b){var c=this,d=b.newValue;d!==c.sX&&d<=c.nX.cw()&&(c.sX=d,nc(c),kc(c))},onDataChanged:function(){gc(this)},onRowsChanged:function(){gc(this)},onColumnNameChanged:function(a,b){var c=this;c.columnName===a&&c._caption&&(c.columnName=b,c.captionName(b,!1),z(c._caption).text(b))},onColumnRemoved:function(a){var b=this;a===b.columnName&&(b.slicerData.doUnfilter(a),qc(b),z(b.xo).remove(),b.xo=K)},onFiltered:function(){var a=this,b=a.slicerData,c=a.columnName;a.fX=ec(a),a.rX=b.getFilteredOutIndexes(c,2),a.pX=b.getFilteredOutIndexes(c,1),hc(a)},AD:function(a){var b=this,c=Cc(b,a);c&&(8===c[ab]&&(b.HX=!0),5===c[ab]&&(b.wX=[],b.GX=!0,a.ctrlKey?rc(b,c):a.shiftKey?sc(b,c):tc(b,c)),wc(b,b.vX),(5===c[ab]||6===c[ab]||8===c[ab]||4===c[ab]&&b.AX)&&a.stopPropagation())},CD:function(a){var b,c,d,e=this,f=Cc(e,a);f&&(b=e.slicerData,c=e.vX,d=!1,4===f[ab]?e.AX&&(b.doUnfilter(e.columnName),yc(e,0),d=!0):c&&F(c)>0&&!e.yX&&!e.KX&&(b.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),d=!0),e.GX=!1,e.HX=!1,d&&(e.vX=[],e.wX=[]))},BD:function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p=this,q=p.qX,r=q?new h(q[ab],q[bb]):K,s=Cc(p,a),t=p.gX,u=p.wX;if(s&&(!r||r[ab]!==s[ab]||5===r[ab]&&r[bb]!==s[bb])){if(!p.GX)return p.qX=s,zc(p,r),void Ac(p,s);if(5===s[ab])if(b=t.indexOf(s[bb]),c=p.rX,y.Bb(u,b)){for(i=p.fX,j=i.indexOf(t[p.xX]),k=i.indexOf(s[bb]),l=Math.min(j,k),m=Math.max(j,k),n=[],d=0,e=F(u);d<e;d++)o=u[d],f=i.indexOf(t[o]),(f>m||f<l)&&n.push(o);for(d=0,e=F(n);d<e;d++)f=n[d],g=Bc(p,t[f]),y.Bb(c,f)?mc(p,g,20):mc(p,g,12),y.Fb(u,f)}else g=Bc(p,t[b]),y.Bb(c,b)?mc(p,g,18):mc(p,g,10),y.Sb(u,b);p.qX=s}},uX:function(){var a=this,b=a.qX,c=b?new h(b[ab],b[bb]):K;a.qX=K,zc(a,c)},Rw:function(a){var b=Cc(this,a);return 8===b[ab]&&(a.stopPropagation(),!0)},nm:function(a){var b=this;17!==a.keyCode||b.yX||(b.yX=!0),16!==a.keyCode||b.KX||(b.KX=!0)},om:function(a){var b=this,c=b.slicerData;17===a.keyCode&&b.yX&&(b.yX=!1),16===a.keyCode&&b.KX&&(b.KX=!1),!b.yX&&!b.KX&&F(b.vX)>0&&(c.doFilter(b.columnName,{exclusiveRowIndexes:b.wX}),b.vX=[],b.wX=[])}},c=0,d=F(a);c<d;c++)b[a[c][0]]=g(a[c][0],a[c][1],a[c][2],a[c][3]);return z.extend(i.prototype,b),i}(),h=function(){function a(a,b){var c=this;c[ab]=a===J?K:a,c[bb]=b===J?K:b}return a}();function Fc(a,b,c){var d,e,f,g,h=a.sj,i=h.kj,j=h.dataRange(),k=j.row+j.rowCount-1,l=j.col+j.colCount-1;for(d=j.row;d<=k;d++)for(e=[],b.push(e),f=j.col;f<=l;f++)e.push({value:i.getValue(d,f),text:i.getText(d,f)});for(f=0;f<j.colCount;f++)g=h.getColumnName(f)||"",c.push(g)}function Gc(a,b){var c,d,e=a.kj,f=a.sj.rowFilter();for(e.suspendPaint(),c=f&&f.Je||[],d=0;d<F(c);d++)Hc(a,b,[c[d]]);e.resumePaint()}function Hc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(d=0;d<c.length;d++){if(e=a.sj,f=a.xr,g=c[d]-e.range().col,h=e.dataRange(),i=g+h.col,j=a.columnNames[g],k=[],l={},y.Bb(f.Je,i)){for(m=[],n=h.row;n<h.row+h.rowCount;n++)f.WY(n,i)||m.push(n);for(o=0;o<F(m);o++)p=m[o]-h.row,q=a.getExclusiveRowIndex(j,p),l[q]||(l[q]=!0,k.push(q))}else for(r=F(a.getExclusiveData(j)),s=0;s<r;s++)k.push(s);Ic(Jc(a,j),k)||(b.prototype.doFilter.call(a,j,{exclusiveRowIndexes:k}),a.onFiltered(),a.kj.$p())}}function Ic(a,b){var c,d=q.j.Fa;if(d(a)&&d(b))return!0;if(d(a)&&!d(b)||!d(a)&&d(b)||!d(a)&&!d(b)&&(!G(a)||!G(b))||a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function Jc(a,b){var c,d=a.getExclusiveData(b),e=a.getFilteredOutIndexes(b,1),f=[];for(c=0;c<F(d);c++)y.Bb(e,c)&&f.push(c);return f}i=function(a){z.inherit(b,a);function b(b){var c=this,d=[],e=[],f=b.rowFilter();c.sj=b,c.kj=b.kj,c.xr=f,c.MX=K,Fc(c,d,e),a.call(c,d,e),Gc(c,a),f&&(f.filterHandler=function(b){Hc(c,a,b.columns)})}var c={constructor:b,OW:function(){return this.kj},getTable:function(){return this.sj},doFilter:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z=this,A=z.kj,B=z.sj,C=z.xr,D=c.ranges,E=c.exclusiveRowIndexes,G=!!E,H=z.getColumnIndex(b);if(!(H<0||!G&&!D))if(d)a.prototype.doFilter.call(z,b,c,d);else{if(e=G?z.getExclusiveData(b):z.getData(b),f=[],G)f=E;else for(g=z.ef(),h=z.ff(),g[H]||z.We(H),i=g[H],j=0;j<F(D);j++)for(k=D[j],l=z.Xe(i,k),m=l.start;m<=l.end;m++)f.push(h[H][m]);if(A.suspendPaint(),n=B.startColumn()+H,o=B.dataRange().row,C&&(C.NX(n),C.OX(n)),A.AR(),p=[],u)for(q=0;q<F(f);q++)r=new u.$V(2,0,e[f[q]]),C&&C.addFilterItem(n,r),p.push(r);if(a.prototype.hf.call(z,b,c),s=[],t={},z.gf(b,s,t),C){for(v=0;v<F(f);v++)if(w=G?f[v]:z.getExclusiveRowIndex(b,f[v]),t[w])if(C.PX(p[v]),G)for(x=z.getRowIndexes(b,f[v]),y=0;y<F(x);y++)C.QX(x[y]+o,n);else C.QX(f[v]+o,n);C.RX(n,!0),C.onFilter(C.SX(0,[n]))}z.onFiltered(),A.resumePaint()}},doUnfilter:function(b){var c,d=this,e=d.sj,f=d.getColumnIndex(b),g=d.xr;f!==-1&&(c=e.startColumn()+f,g.removeFilterItems(c),a.prototype.if.call(d,b),g.OX(c),g.RX(c,!1),g.onFilter(g.SX(0,[c])),d.onFiltered(),d.kj.$p())},refresh:function(){var a=this,b=[],c=[];Fc(a,b,c),a.bf(b,c),a.cf()},onColumnNameChanged:function(b,c){var d=this;a.prototype.onColumnNameChanged.call(d,b,c),d.kj.slicers.all().forEach(function(a){a.columnName(c)})},onRowsAdded:function(b,c){var d,e,f=this,g=f.kj,h=f.sj,i=h.dataRange();for(a.prototype.onRowsAdded.call(f,b,c,!0),d=b;d<b+c;d++)for(e=0;e<F(f.columnNames);e++)f.data[d][e]={value:g.getValue(i.row+d,i.col+e),text:g.getText(i.row+d,i.col+e)};f.bf(f.data,f.columnNames),f.cf(b,c,!0,"onRowsChanged")},onRowsRemoved:function(b,c){a.prototype.df.call(this,b,c,!1)},onColumnsAdded:function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.sj,j=i.dataRange(),k=g.data,l=g.columnNames;for(c=0;c<F(k);c++)for(d=a;d<a+b;d++)k[c].splice(d,0,{value:h.getValue(j.row+c,j.col+d),text:h.getText(j.row+c,j.col+d)});for(e=a;e<a+b;e++)f=i.getColumnName(e)||"",l.splice(e,0,f);g.bf(k,l)},onColumnsRemoved:function(b,c){var d,e,f=this,g=f.kj,h=f.sj.name(),i=f.columnNames,j=[];for(d=b;d<b+c;d++)j.push(i[d]);a.prototype.onColumnsRemoved.call(f,b,c),e=g&&g.slicers,j.forEach(function(a){e.all(h,a).forEach(function(a){e.remove(a.name())})})},onTableRemoved:function(a){var b,c,d,e=this;a&&a===e.sj&&(e.MX=[],b=e.kj,c=b.slicers,d=a.name(),c.all(d).forEach(function(a){e.MX.push(a),c.remove(a.name())}),c&&Mc(c,e),e.Ze=[])},onTableAdded:function(a){var b,c=this,d=c.kj,e=d.slicers;e&&a&&a.Aq()&&Lc(e,a.getSlicerData()),b=c.MX||[],b.forEach(function(a){e.Cz(a)})}};return z.extend(b.prototype,c),b}(r.GeneralSlicerData),t&&z.extend(t.Table.prototype,{getSlicerData:function(){var a=this;return a.ZX||(a.ZX=new i(a)),a.ZX}});function Kc(a){var b=a.sj,c=b.kj,d=b&&b.rowFilter();return!c.options.isProtected||d&&d.TX(c)}j=function(a){z.inherit(b,a);function b(b,c,d){a.call(this,b,c,d),this.isSelected(!1)}var c={constructor:b,isSelected:D("isSelected",!1),sheet:D("sheet"),slicer:D("slicer"),IX:function(){var b=this,c=b.slicerData;c&&c instanceof i&&(b.sheet(c.OW()),b.sj=c.getTable()),a.prototype.IX.call(this)},onColumnRemoved:function(a){var b,c=this,d=c.sheet(),e=c.sj,f=c.slicerData;a===c.columnName&&(b=f.getFilteredOutIndexes(a,1),0!==F(b)&&f.doUnfilter(a),d&&e&&d.wr.Fb(c.name()))},mX:function(a,b){var c,d,e,f,g,h,i=this,j=i.slicerData,k=j.getColumnIndex(i.columnName),l=i.sj,m=l.dataRange(),n=[];if(0===b)return a;for(c=[],d=j.OW(),e=0;e<F(a);e++)f=j.getRowIndexes(i.columnName,e),c.push(d.getValue(m.row+f[0],m.col+k));for(g=r.jf.quickSort(c),h=0;h<F(g);h++)n[h]=a[g[h].index];return 2===b&&n.reverse(),n},Bw:function(b,c){var d,e,f=this,g=f.sheet(),h=f.slicer();for(h&&g.ER(h)||(c.newValue=c.oldValue),d=Sc(h),e=0;e<F(d);e++)a.prototype.JX.call(d[e],b,c)},AD:function(b){var c,d,e,f=this,g=f.sheet(),h=f.slicer();if(h&&g.ER(h)){if(c=Cc(f,b),!Kc(f)&&(5===c[ab]||6===c[ab]||8===c[ab]))return void b.stopPropagation();for(d=Sc(h),e=0;e<F(d);e++)a.prototype.AD.call(d[e],b)}},CD:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.sheet(),r=p.slicer();if(r&&q.ER(r)&&Kc(p)&&(b=Cc(p,a))){for(c=p.slicerData,d=p.vX,e=p.wX,f=c.getExclusiveData(p.columnName),g=!1,h=K,4===b[ab]||5===b[ab]&&F(e)===F(f)&&!p.yX&&!p.KX?(i=c.getFilteredIndexes(p.columnName),h=q.wu().execute({cmd:"unfilterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,value:i}),g=!0):d&&F(d)>0&&!p.yX&&!p.KX&&(j=c.getFilteredIndexes(p.columnName),k=e.concat(),h=q.wu().execute({cmd:"filterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,oldValue:j,newValue:k}),g=!0),l=Sc(r),m=0,n=F(l);m<n;m++)o=l[m],o.GX=!1,o.HX=!1,g&&(o.vX=[],o.wX=[]);return!!h}},BD:function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&!e.HX&&f.ER(g))for(c=Sc(g),d=0;d<F(c);d++)a.prototype.BD.call(c[d],b)},uX:function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&f.ER(g))for(c=Sc(g),d=0;d<F(c);d++)a.prototype.uX.call(c[d],b)},Rw:function(b){var c,d,e,f,g=this;return!!a.prototype.Rw.call(this,b)||(c=g.sheet(),d=c.slicers,e=d&&d.UX(),f=g.nX,!!(e&&1===F(e)&&g.isSelected()&&g.iX()&&f)&&(f.sC(b),b.stopPropagation(),!0))},om:function(a){var b,c,d,e,f=this,g=f.slicerData,h=f.sheet(),i=f.wX;17===a.keyCode&&f.yX&&(f.yX=!1),16===a.keyCode&&f.KX&&(f.KX=!1),!f.yX&&!f.KX&&F(f.vX)>0&&(b=F(g.getExclusiveData(f.columnName)),F(i)===b?(c=g.getFilteredIndexes(f.columnName),h.wu().execute({cmd:"unfilterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,value:c})):(d=g.getFilteredIndexes(f.columnName),e=i.concat(),h.wu().execute({cmd:"filterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,oldValue:d,newValue:e})),f.vX=[],f.wX=[])}};return z.extend(b.prototype,c),b}(g);function Lc(a,b){var c,d,e=a.VX;if(b){for(c=b.getTable(),d=0;d<F(e);d++)if(e[d].getTable()===c)return;e.push(b)}}function Mc(a,b){y.Fb(a.VX,b)}function Nc(a,b){var c,d,e,f=a.VX;for(c=0;c<F(f);c++)if(d=f[c],e=d.getTable(),d&&e&&e.tableName()===b)return d;return K}function Oc(a,b,c){var d;return b?v(Pc(a),b)&&(d=x().Exp_SlicerNameExist):d=x().Exp_SlicerNameInvalid,d&&c&&(c.error=Error(d)),!d}function Pc(a){var b,c,d,e=a.kj,f={},g=e&&e.parent&&e.parent.sheets;if(g)for(b=0;b<F(g);b++){c=g[b].slicers.XX();for(d in c)v(c,d)&&(f[d]=c[d])}return f}k=function(){function a(a){var b=this;b.kj=a,b.VX=[],b.WX={}}return a.prototype={constructor:a,add:function(a,b,c,d){var e,f=this,g=f.kj,h=g.parent,i=h.jga(b);return i&&i.getColumnIndexInTable(c)!==-1?(g.suspendPaint(),e=new l(a,i,c),d&&e.style(d),f.Cz(e),g.wr.Sb(e),g.resumePaint(),e):K},Cz:function(a){var b,c,d=this;if(a){if(b=a.name(),c={},!Oc(d,b,c))throw c.error;d.WX[b]=a,Lc(d,a.YX())}},get:function(a){return a===K||a===J?K:this.WX[a]},remove:function(a){var b=this,c=b.kj;b.vV(a),c.wr.Fb(a)},vV:function(a){var b,c,d,e=this,f=e.WX,g=e.get(a);if(g&&v(f,a)){for(b=g.YX(),c=Sc(g),d=0;d<F(c);d++)b.detachListener(c[d]);delete e.WX[a]}},U3:function(a,b){var c,d=this,e=d.kj,f={};if(!Oc(d,b,f))throw f.error;c=d.WX[a],delete d.WX[a],d.WX[b]=c,e.wr.U3(a,b)},clear:function(){var a=this,b=a.sheet();b.suspendPaint(),z.each(this.WX,function(b){a.remove(b.name())}),b.resumePaint()},all:function(a,b){var c=[];return z.each(this.WX,function(d,e){a&&(Rc(e).name()!==a||b&&e.columnName()!==b)||c.push(e)}),c},XX:function(){return this.WX},HS:function(a){var b,c,d,e=Pc(this);if(!v(e,a))return a;for(b=1,c=" ",d=a.split(c)[0];v(e,d+c+b);)b++;return d+c+b},UX:function(){var a,b,c,d=this,e=d.WX;if(!e||p.GC$.isEmptyObject(e))return[];a=[];for(b in e)v(e,b)&&(c=e[b],c&&c.isSelected()&&a.push(c));return a},W3:function(a){var b,c,d=this,e=d.UX();if(1!==F(e))return!1;if(b=Sc(e[0]),F(b)>0){for(c=0;c<F(b);c++)b[c].Rw(a);return!0}return!1},toJSON:function(){var a,b=this,c=[],d=b.WX;if(d&&!p.GC$.isEmptyObject(d))for(a in d)v(d,a)&&c.push(d[a].toJSON());return c},fromJSON:function(a){var b,c,d,e,f,g,h,i;if(a&&0!==F(a))for(b=this,c=b.kj,d=c.parent,b.WX={},e=0;e<F(a);e++)f=a[e].tableName,g=a[e].columnName,f&&g&&(h=d.jga(f),h&&h.getColumnIndexInTable(g)!==-1&&(i=new l(a[e].name,h,g),i.sheet(c),i.fromJSON(a[e]),c.slicers.Cz(i),c.wr.Sb(i)))}},a}();function Qc(a,b,c){var d,e,f=a.ZX;f&&(d=f.OW(),e=d.slicers,e.all().forEach(function(d){d===a&&(e.U3(b,c),a.onPropertyChanged(N,c))}))}function Rc(a){return a.ZX.getTable()}function Sc(a){return a.$X}l=function(a){var b,c,d,e,g,h="nameInFormula",i="captionName",k="columnCount",l="columnName",m="itemHeight",n="showHeader",o="sortState",q="disableResizingAndMoving",r="showNoDataItems",s="showNoDataItemsInLast",t="visuallyNoDataItems",u="isSelected",v="dynamicMove",w="dynamicSize",x="tableName",y="Slicer",A=100,B=100,C=192,E=250;z.inherit(K,a),b=[];function G(a,c,d,e){return b.push(a),D(a,c,function(b,c){d.call(this,a,b,c)},e)}function H(a){var b,c,d,e,f;if(!a)return!1;if(b=this,c=b.ZX,a===b.name())return!1;if(c&&(d=c.OW(),e=d&&d.slicers,e&&(f={},!Oc(e,a,f))))throw f.error;return!0}function I(a,b){var c,d,e=this,f=e.$X||[];for(c=0;c<F(f);c++)f[c][a]&&("style"===a?f[c][a](b.toJSONInternal()):f[c][a](b));d=e.sheet(),e.Wq({sheet:d,sheetName:d?d.Cj:"",slicer:e,propertyName:a})}function K(b,c,d){a.call(this,b,A,B,C,E);
var e=this,f,g;e.typeName=y,e.g3=y,c&&(f=c.kj,e.sheet(f),g=Nc(f.slicers,c.tableName())),g||(g=c.getSlicerData()),e.ZX=g,e[l](d),e.$X=[],e._X=d,e[h](y+"_"+d),e[i](d),e[w](!1),e[v](!1)}for(c=[[N,"",function(a,b,c){Qc(this,c,b)},H],[i,"",I],[k,1,I,Ec],[m,21,I,Ec],[n,!0,I],[o,1,I],[q,!1,function(a,b){var c,d=this;d.allowMove(!b,!1),d.allowResize(!b,!1),I.call(d,q,b),c=d.sheet(),c&&c.$p()}],[r,!0,I],[s,!0,I],[t,!0,I],[O,f.light1(),I],[l,"",function(a,b){this._X=b,this.captionName(b,!1)}]],d={constructor:K,sourceName:function(){return this._X},nameInFormula:G(h,"",I),onPropertyChanged:I,cloneContent:function(){var a=this,b=a.sheet(),c=a.ZX,d=new j(a.name(),c,a.columnName());return d[Y](a[Y](),!1)[$](a[$](),!1)[i](a[i]())[k](a[k]())[m](a[m]())[n](a[n]())[o](a[o]()).isLocked(a.isLocked())[q](a[q]())[r](a[r]())[s](a[s]())[t](a[t]())[O](a[O]().toJSONInternal()).zoomFactor(b._zoomFactor)[u](a[u]()).slicer(a),d.sheet()!==b&&d.sheet(b),a.$X.push(d),d.getDOMElement()},YX:function(){return this.ZX},hga:function(){return!1},refresh:function(a){var b,c=this.$X;for(b=0;b<F(c);b++)hc(c[b],a)},refreshContent:function(a){var b=this,c=b.sheet().zoom();c!==b.MP&&(b.MP=c,b.refresh(c))},clone:function(a){var b,c=this;return!c.sheet()&&a&&c.sheet(a,!1),b=new K(c.name(),Rc(c),c.columnName()),b.sheet(c.sheet(),!1),b.fromJSON(c.toJSON(),!1,c.ZX),b},fromJSON:function(c,d,e){var f,g,h,i,j,k,m,n,o,q,r;c&&(f=this,g=c.tableName,h=c[l],g&&h&&(a.prototype.fromJSON.call(this,c),i=f.sheet(),j=i.slicers,k=i.parent,m=e?e:Nc(j,g),m||(n=k.jga(g),m=n.getSlicerData(),Lc(j,m)),f.ZX=m,f[l](h),o=c.x!==J?c.x:A,q=c.y!==J?c.y:B,f.position(new p.Point(o,q),!1),f[Y](c[Y]!==J?c[Y]:C,!1),f[$](c[$]!==J?c[$]:E,!1),c.sourceName!==J&&(f._X=c.sourceName),b.forEach(function(a){var b=c[a];b!==J&&f[a](b,!1)}),c.style!==J&&(r=Gb(),r.fromJSON(c.style),f.style(r,!1))))},toJSON:function(){var a,c,d,e=this,f={},g=["x","y",Y,$,v,w,"isLocked","fixedPosition"];return g.forEach(function(a){var b=e[a]();e[a].isDefault(b)&&a!==v&&a!==w||(f[a]=b)}),a=e._X,a&&(f.sourceName=a),e[O]()&&(f[O]=e[O]().toJSON()),c=e.ZX,d=c.getTable(),d[x]&&(f[x]=d[x]()),b.forEach(function(a){var b=e[a]();a===O||e[a].isDefault(b)||(f[a]=b)}),f},Wq:function(a){var b=this.sheet();b&&b.Wq(p.Events.SlicerChanged,a)}},e=0,g=F(c);e<g;e++)d[c[e][0]]=G(c[e][0],c[e][1],c[e][2],c[e][3]);return z.extend(K.prototype,d),K}(s.FloatingObject),H(p.Worksheet.prototype,{t4:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(e===J&&(e=3),f=this,g=f.tables)for(h=0;h<c;h++)for(i=0;i<d;i++)j=h+a,k=i+b,l=g.find(j,k),3===e&&l&&l.Aq()&&(m=l.dataRange(),m.contains(j,k)&&(n=l.getSlicerData(),n&&n.onDataChanged([{columnName:l.getColumnName(k-m.col),row:j-m.row,data:{value:f.getValue(j,k),text:f.getText(j,k)}}])))}}),m={priority:900,init:function(){var a=this;a.slicers=new k(a)},setHost:function(){var a=this;a.bind("tableRemoved",function(b,c){var d,e,f,g=c.tables;for(d=0;d<F(g);d++)e=a.slicers,f=Nc(e,g[d].name()),f&&Mc(e,f)})},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.slicers.toJSON(),c.length>0&&(a.slicers=c))},preProcessMouseWheel:function(a){var b=this.slicers;b&&b.W3(a.e)&&(a.r=!0)}},p.Worksheet.$n("slicer",m),n=function(a){var b="unfilterSlicerByKey",c="filterSlicer",d="unfilterSlicer",e="changeSlicerProperty";a.register(b,B[b],67,!1,!1,!0,!1),a.register(c,B[c]),a.register(d,B[d]),a.register(e,B[e])},o={init:function(){n(this.commandManager())},fromJson:function(a,b,c){var d,e,f,g,h,i,j=c&&c.ignoreStyle;if(!j)for(d=this,e=0,f=d.getSheetCount();e<f;e++)g=d.getSheet(e),h=a.sheets&&a.sheets[g.name()],i=h&&h.slicers,i&&g.slicers.fromJSON(i)}},p.Workbook.$n("slicer",o),w={ItemSlicer:g,SlicerStyleInfo:Bb,SlicerBorder:b,SlicerStyle:d,SlicerStyles:f,TableSlicerData:i,Slicer:l,SlicerCollection:k},a.exports=w}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Slicers},function(a,b){a.exports=GC.Spread.Sheets.FloatingObjects},function(a,b){a.exports=GC.Spread.Sheets.Tables},function(a,b){a.exports=GC.Spread.Sheets.ConditionalFormatting},function(a,b,c){!function(){"use strict";var a=c(2),b=a.Commands,d=a.GC$,e=b.ActionBase,f=function(a){d.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicerData},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doFilter(c.columnName,{exclusiveRowIndexes:c.newValue}),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicerData},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doFilter(c.columnName,{exclusiveRowIndexes:c.oldValue}),b.Mz(a,!0),!0)}};return d.extend(b.prototype,c),b}(e),g=function(a){d.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicerData},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doUnfilter(c.columnName),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicerData},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doFilter(c.columnName,{exclusiveRowIndexes:c.value}),b.Mz(a,!0),!0)}};return d.extend(b.prototype,c),b}(e),h=function(a){d.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicer},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.newValue),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicer},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.oldValue),b.Mz(a,!0),!0)}};return d.extend(b.prototype,c),b}(e),i=b.h4;b.filterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,f,b,c)}},b.unfilterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,g,b,c)}},b.changeSlicerProperty={canUndo:!0,execute:function(a,b,c){return i(a,h,b,c)}},b.unfilterSlicerByKey={canUndo:!1,execute:function(a,c){var d,e,f,g=b.bT(a,c),h=g.slicers.UX();if(1===h.length&&(d=h[0],e=d.YX()))return f=e.getFilteredIndexes(d.columnName()),g.wu().execute({cmd:"unfilterSlicer",sheetName:g.name(),slicerData:e,columnName:d.columnName(),value:f})}}}()},function(a,b){!function(){"use strict";a.exports={Blank:"(blank)",Exp_SlicerNameInvalid:"The slicer name is not valid.",Exp_SlicerNameExist:"The slicer name is already in use, please enter a unique name."}}()}]);
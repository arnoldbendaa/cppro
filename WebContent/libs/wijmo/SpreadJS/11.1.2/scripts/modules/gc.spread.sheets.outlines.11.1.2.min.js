/*!
 * 
 * Spread.Sheets Library 11.1.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Outlines=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";c(1);var b=c(4);b.SR={},b.SR.en=c(5),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p=c(2),q=c(3),r=q.Commands,s=r.ActionBase,t=q.GC$,u="outlineColumn",v="removeColumnOutline",w="expandColumnOutline",x="expandColumnOutlineForLevel",y="outlineRow",z="removeRowOutline",A="expandRowOutline",B="expandRowOutlineForLevel",C=p.j.Fa;function D(a){var b=a.kj;return a.ML?b.rowOutlines:b.columnOutlines}function E(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ.index,d=g.VQ.count,e=D(g),b&&e&&!C(c)&&!C(d)&&(f=a?e.group:e.ungroupRange,g.Lz(b,!0),f.call(e,c,d),g.Mz(b,!0),h=!0)),h}b=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){return E.call(this,!0)},undo:function(){return E.call(this,!1)}};return t.extend(b.prototype,c),b}(s),d=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(b),e=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(b),f=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){var a,b,c,d=this,e=d.kj,f=!1;return d.canExecute()&&(a=d.VQ.index,b=d.VQ.count,c=D(d),e&&c&&!C(a)&&!C(b)&&((c.getLevel(a)>=0||c.getLevel(a+b-1)>=0)&&(d.Lz(e,!0),c.ungroupRange(a,b),d.Mz(e,!0)),f=!0)),f},undo:function(){var a,b,c,d=this,e=!1,f=d.kj;return d.canUndo()&&(a=d.VQ.index,b=d.VQ.count,c=D(d),f&&c&&!C(a)&&!C(b)&&(d.Lz(f,!0),c.group(a,b),d.Mz(f,!0),e=!0)),e}};return t.extend(b.prototype,c),b}(s),g=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(f),h=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(f);function F(a,b,c,d,e){var f=0,g;for(g=b;g<=c&&g<d;g++)f+=e.call(a,g)*a.zoom();return f}function G(a,b,c,d,e){var f=0,g;for(g=b;g<d&&f<c;g++)b++,f+=e.call(a,g)*a.zoom();return b>=d?d-1:b}function H(a,b,c,d,e){if(b<d)return d;if(b>e)return e;for(var f=b;f<=e;f++)if(c.call(a,f))return f;return-1}function I(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.kj,s=c.index,t=b?r.getRowCount():r.getColumnCount(),u=void 0;s<0||s>=t||(d=D(q),e=1===d.direction(),f=b?r.frozenRowCount():r.frozenColumnCount(),g=b?r.getRowHeight:r.getColumnWidth,h=b?r.getViewportTopRow:r.getViewportLeftColumn,i=b?r.getViewportHeight:r.getViewportWidth,j=h.call(r,1),n=d.find(e?s-1:s+1,c.level),n&&(o=e?n.start:s,p=e?s:n.end,e?(a?o=s:o<f&&(o=f),o<j&&(j=o),k=i.call(r,1),l=F(r,j,p,t,g),l>k&&(j=G(r,j,l-k,t,g)),m=H(r,j,g,f,t-1)):(a?p=s:p>=t&&(p=t-1),o<j?m=H(r,o,g,f,t-1):(k=i.call(r,1),l=F(r,j,p,t,g),l>k&&(m=H(r,o,g,f,t-1)))),b&&m!==u?(r.lq=m,r.os()):b||m===u||(r.qq=m,r.qs())))}function J(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ,d=D(g),e=c.collapsed,f=c.index,!b||!d||C(e)||C(f)||C(c.level)||(g.Lz(b,!0),a||(e=!e),d.setCollapsed(f,e),I.call(g,e,g.ML,c),g.Mz(b,!0),h=!0)),h}i=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){return J.call(this,!0)},undo:function(){return J.call(this,!1)}};return t.extend(b.prototype,c),b}(s),j=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(i),k=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(i),l=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){var a,b,c,d,e=this,f=e.kj,g=!1;if(e.canExecute()&&(b=e.VQ.level,c=D(e),f&&c&&!C(b))){for(f.ITa.startTransaction(),e.Lz(f,!0),a=0;a<b;a++)c.expand(a,!0);c.expand(b,!1),e.Mz(f,!0),d=r.bWa(f.name()),e.VQ[d]=f.ITa.endTransaction(),g=!0}return g},undo:function(){var a,b,c,d=this,e=!1;return d.canUndo()&&(a=d.kj,b=r.bWa(a.name()),c=d.VQ[b],a&&c&&(d.Lz(a,!0),a.ITa.undo(c),e=!0,d.Mz(a,!0))),e}};return t.extend(b.prototype,c),b}(s),m=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(l),n=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(l),o=r.h4,r[u]={canUndo:!0,execute:function(a,b,c){return o(a,d,b,c)}},r[y]={canUndo:!0,execute:function(a,b,c){return o(a,e,b,c)}},r[v]={canUndo:!0,execute:function(a,b,c){return o(a,g,b,c)}},r[z]={canUndo:!0,execute:function(a,b,c){return o(a,h,b,c)}},r[w]={canUndo:!0,execute:function(a,b,c){return o(a,j,b,c)}},r[A]={canUndo:!0,execute:function(a,b,c){return o(a,k,b,c)}},r[x]={canUndo:!0,execute:function(a,b,c){return o(a,m,b,c)}},r[B]={canUndo:!0,execute:function(a,b,c){return o(a,n,b,c)}},r.SL=function(a){a.register(u,r[u]),a.register(y,r[y]),a.register(v,r[v]),a.register(z,r[z]),a.register(w,r[w]),a.register(A,r[A]),a.register(x,r[x]),a.register(B,r[B])},a.exports=r}()},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Sheets},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h=c(2),i=c(3),j=c(1),k={},l=null,m=void 0,n=Math.max,o=Math.min,p=i.GC$,q=p.each,r=i.Im.Lm,s=i.Rect,t=h.k,u=t._b,v=t.$b,w=t.ac,x=i.Ul.Ol,y=h.j.Fa,z=i.Ul.Pl,A=i.Ul.fp,B="rangegroup",C="gc-group",D=C+"-box",E="rgh",F="cgh",G="rg",H="cg",I=function(){return h.C(k.SR)()},J={Gt:function(){var a,b,c,d,e,f,g,h=this,i=h.TL;return i?i:(a={x:0,y:0,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},b=h.rowOutlines,c=h.columnOutlines,d=17,e=4,f=o(d,d*h.zoom()),h.showRowOutline()&&b&&!b.iT()&&(g=b.getMaxLevel(),g>=0&&(a.width=f*(g+2)+e,a.rowMaxLevel=g)),h.showColumnOutline()&&c&&!c.iT()&&(g=c.getMaxLevel(),g>=0&&(a.height=f*(g+2)+e,a.colMaxLevel=g)),h.TL=a,a)},showRowOutline:z("showRowOutline",!0,function(){this.$p()}),showColumnOutline:z("showColumnOutline",!0,function(){this.$p()})};p.extend(i.Worksheet.prototype,J);function K(a,b){a.Wq(i.Events.RangeGroupStateChanging,b)}function L(a,b){a.Wq(i.Events.RangeGroupStateChanged,b)}function M(a,b){var c,d,e,f;a.isEditing&&a.isEditing()||(c=b.info.index,d=b.what===E,e=d?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",f=O(a,d,-1,c,!0),K(a,f),f&&f.cancel===!1&&(a.wu().execute({cmd:e,sheetName:a.name(),level:c}),L(a,O(a,d,-1,c,!1))))}function N(a,b){var c,d,e,f,g,h,i;a.isEditing&&a.isEditing()||(c=b.what===G,T(c,a)&&(d=b.info,e=d.index,f=e,g=d.level,i=c?"expandRowOutline":"expandColumnOutline",1===d.lineDirection?e--:e++,h=O(a,c,e,g,!0),K(a,h),h&&h.cancel===!1&&(a.wu().execute({cmd:i,sheetName:a.name(),index:f,level:g,collapsed:d.isExpanded}),L(a,O(a,c,e,g,!1)))))}function O(a,b,c,d,e){var f={sheet:a,sheetName:a.name(),isRowGroup:b,index:c,level:d};return e&&(f.cancel=!1),f}function P(a,b){var c,d,e,f,g=this,h=g.Gt(),i=h.width,j=h.height;return i||j?(c=g.am(),d=new s(h.x,h.y,i,c.height),e=new s(h.x,h.y,c.width,j),d.contains(a,b)||e.contains(a,b)?(f=Q(g,a,b,h.rowMaxLevel,!0),f||(f=Q(g,a,b,h.colMaxLevel,!1)),f||{what:"empty",info:l}):l):l}function Q(a,b,c,d,e){var f,g,h=new ga(a,e,d),i=h.WL(b,c,e);if(i)return{what:e?E:F,info:i};for(f=R(a,e,d),g=0;g<=2;g++)if(i=f[g].XL(b,c,e))return{what:e?G:H,info:i};return l}function R(a,b,c){var d=[new fa(a,b,0,c),new fa(a,b,1,c),new fa(a,b,2,c)],e;for(e=0;e<=2;e++)d[e].YL();return d}function S(a,b){var c=b?a.width:a.height;return n(0,(c-2*this.PADDING)/(this.ZL+2))}function T(a,b){return a?b.rowOutlines:b.columnOutlines}k.OutlineDirection={backward:0,forward:1},k.OutlineState={expanded:0,collapsed:1},b=function(){function a(a,b,c,d){var e=this;e.children=[],e.parent=l,e.model=a,e.start=b,e.end=c,e.level=d}return a.prototype={state:function(a){var b=this,c=b.model;return arguments.length?void(c&&c.expandGroup(b,0===a)):c?c.getState(b):0},contains:function(a){return this.start<=a&&a<=this.end},addChild:function(a){a&&(this.children.push(a),a.parent=this)}},a}(),k.OutlineInfo=b;function U(a,b,c){var d,e,f,g;if(c>0){for(d=a.items,g=[],e=0;e<c;e++)g.push(l);if(a.items=d=d.slice(0,b).concat(g,d.slice(b)),a.V3<=0&&b>0&&(f=d[b-1]))for(e=0;e<c;e++)d[b+e]=new ea(f);$(a)}}function V(a,b,c){c>0&&(a.items.splice(b,c),$(a))}function W(a,c,d){var e,f,g,h,i,j,k=l,m=a.items;for(f=c,h=w(m);f<h&&(e=m[f],!e||e.level<d||(k||(k=new b(a,f,f,d)),e.level>d&&(g=W(a,f,d+1),f=g.index,k.addChild(g.g)),f>k.end&&(k.end=f),!a.isGroupEnd(f,d)));f++);if(k)for(i=k.end+1,j=k.start;j<i;j++)m[j].groupInfo||(m[j].groupInfo=k);return{g:k,index:f}}function X(a,b){return b>=-1&&b<w(a.items)}function Y(a,b,c){var d,e,f=a&&a.items;if(f)for(d=f[b]&&f[b].groupInfo;d;){if(e=d.level,e===c)return d;if(!(e>c))break;d=d.parent}return l}function Z(a,b){switch(a){case"head":case"tail":return b===l;case"direction":return 1===b;case"itemsData":return 0===w(b);default:return!1}}function $(a){a.Zka=l,a.refresh()}function _(a,b){!b&&a.Wka||(a.Zka=a.createRangeGroup(),ba(a))}function aa(a){a.Wka&&!a.Zka&&(a.Zka=a.createRangeGroup())}function ba(a,b){a.groupChangeHandler&&a.groupChangeHandler(b)}function ca(a,b,c){if(da(a,b),!X(a,b+c-1))throw Error(I().Exp_InvalidCount)}function da(a,b){if(!X(a,b))throw Error(I().Exp_InvalidIndex)}d=function(){function a(a,b,c){var d=this;d.head=l,d.tail=l,d.Zka=l,d.items=Array(a),d.V3=0,d.wz=!0,d.kj=b,d.ML=c}return a.prototype={direction:z("direction",1),group:function(a,b){var c=this,d,e;for(ca(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=a+d,c.items[e]?c.items[e].level++:c.items[e]=new ea;c.Wka&&c.Zka&&(c.Zka=l),_(c),c.wz=!1},Lia:function(){this.Wka=!0,this.Zka=l},Mia:function(){this.Wka=!1,this.refresh()},ungroupRange:function(a,b){var c=this,d,e;for(ca(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=c.items[a+d],e&&e.level>-1&&e.level--;_(c)},ungroup:function(){var a=this,b=w(a.items);a.kj.ITa.vUa(a.ML),a.items=Array(b),_(a),a.wz=!0},expand:function(a,b){var c,d,e,f,g;if(a<-1)throw Error(I().Exp_InvalidLevel);for(c=this,d=c.items,c.kj.ITa.vUa(c.ML),aa(c),f=0,g=d.length;f<g;f++)d[f]&&(e=c.find(f,a),e&&c.expandGroup(e,b))},expandGroup:function(a,b){if(!a)throw Error(I().Exp_GroupInfoIsNull);var c=this,d=c.direction(),e=-1;c.kj.ITa.vUa(c.ML),0===d?e=a.start-1:1===d&&(e=a.end+1),c.setCollapsed(e,!b)},Xr:function(a){return!X(this,a)||!this.isCollapsed(a)},isCollapsed:function(a){var b=this.items[a];return!!(b&&b.viewCollapsed&&b.level>-1)},find:function(a,b){var c=this,d;return aa(c),b===-1?d=c.Zka:(da(c,a),d=Y(c,a,b)),d},getLevel:function(a){var b=this.items[a];return b?b.level:-1},getCollapsed:function(a){var b=this.items[a];return!!b&&!!b.collapsed},B4:function(a,b,c,d){var e,f;for(e=b;e<=c;e++)f=a[e],f||(f=a[e]=new ea,f.level=-1),f.viewCollapsed=d},setCollapsed:function(a,b){var c,d,e,f,g,h,i=this,j=!1,k=i.items;if(i.kj.ITa.vUa(i.ML),aa(i),a<0?(c=i.head,c||(c=i.head=new ea)):a<w(k)?(c=k[a],c||(c=k[a]=new ea,c.level=-1)):(c=i.tail,c||(c=i.tail=new ea)),d=1===i.direction(),c.collapsed!==b&&(c.collapsed=b,j=!0,i.E4(a,b)),j&&(a+=d?-1:1,f=[],g=i.find(a,i.getLevel(a)))){for(h=g.start;h<=g.end;h++)f.push(h);e={indexes:f}}ba(i,e)},dPa:function(a,b){var c,d=this.items;d[a]?d[a].collapsed!==b&&(d[a].collapsed=b):(c=d[a]=new ea,c.level=-1,c.collapsed=b)},E4:function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.items,n=1===l.direction(),o=n?-1:1,p=a+o,q=Y(l,p,l.getLevel(p));if(q)if(b)c=n?q.end+1:q.start-1,l.dPa(c,!0),l.B4(m,q.start,q.end,!0);else{for(d=!1,e=q.parent;e;){if(f=n?e.end+1:e.start-1,m[f]&&m[f].collapsed&&m[f].level>-1){d=!0;break}e=e.parent}if(!d)for(c=n?q.end+1:q.start-1,l.dPa(c,!1),l.B4(m,q.start,q.end,!1),g=[q],h=0;h>=0;)if(i=g[h--],f=n?i.end+1:i.start-1,m[f]&&m[f].collapsed&&m[f].level!==-1)l.B4(m,i.start,i.end,!0);else for(j=i.children,k=0;j&&k<j.length;k++)g[++h]=j[k]}},getMaxLevel:function(){var a=-1,b=this.items,c;return q(b,function(b,d){d&&(c=d.level,c>a&&(a=c))}),a},cB:function(a,b,c,d){var e,f,g,h,i;if(!(c<=0||a===b)){for(e=this,e.kj.ITa.vUa(e.ML),a<0&&(a=0),b<0&&(b=0),f=[],g=e.items,h=u(g,a-1);h>=0&&h<a+c;)i=new ea(g[h]),f.push({index:h-a,value:i}),h=u(g,h);d&&v(g,a,c),v(g,b,c),q(f,function(a,c){g[b+c.index]=c.value}),$(e)}},bB:function(a,b,c,d,e){var f,g,h,i=this;if(i.kj.ITa.vUa(i.ML),b<0&&(b=0),c<0&&(c=0),f=[],a)for(g=u(a.items,b-1);g>=0&&g<b+d;)f[g-b]=new ea(a.items[g]),g=u(a.items,g);if(v(i.items,c,d),f.length>0)for(h in f)f.hasOwnProperty(h)&&(i.items[c+h]=f[h]);e&&v(a.items,b,d)},refresh:function(){this.wz||_(this)},VL:function(a){var b,c,d=this,e=d.items,f=w(e),g=a-f;if(g<0)e.splice(a,-g);else if(b=e[f-1])for(c=0;c<g;c++)e.push(new ea(b));else d.items=e.concat(Array(g));$(d)},getState:function(a){var b=this,c=b.items,d,e=b.direction(),f=-1;return 0===e?f=a.start-1:1===e&&(f=a.end+1),d=f<0?b.head:f<w(c)?c[f]:b.tail,d&&d.collapsed?1:0},Ez:function(a,b){var c=this,d=c.items;a<0?(c.head||(c.head=new ea),c.head.level=b):a<w(d)?(d[a]||(d[a]=new ea),d[a].level=b):(c.tail||(c.tail=new ea),c.tail.level=b),$(c)},suspendAdding:function(){this.V3++},resumeAdding:function(){this.V3--},createRangeGroup:function(){for(var a,c,d=this,e=d.items,f=w(d.items),g=new b(d,0,f-1,(-1)),h=0;h<f;)e[h]&&(e[h].groupInfo=l),h++;for(h=0;h<f;)e[h]?(a=W(d,h,0),c=a.g,h=a.index+1,c&&c.level>-1&&g.addChild(c)):h++;return g},isGroupEnd:function(a,b){var c,d,e,f,g,h,i=this,j=i.items,k=a+1;return!X(i,k)||(!(c=j[k])||(d=c.level,e=j[a].level,f=!1,d<e&&(g=e-d,h=e-b,h>=0&&h<g&&(f=!0)),f))},hitTest:function(a,b,c){return P.call(a,b,c)},jp:function(a,b,c,d){var e,f,g,h,i,j,k,l=a.Gt(),m=a.am(),n=a.ss,o=l.width,p=l.height;if(o||p){if(e=d?o:m.width,f=d?m.height:p,g=d?l.rowMaxLevel:l.colMaxLevel,h=d?n.bn:n.dn,b.save(),b.beginPath(),!c||c.intersect(l.x,l.y,e,f))for(i=new ga(a,d,g),i._L(b),j=h.call(a.ss,function(){return R(a,d,g)}),k=0;k<=2;k++)j[k].aM(b);b.beginPath(),b.restore()}},UL:function(a,b){if(b){var c=b.what;c===E||c===F?M(a,b):c!==G&&c!==H||N(a,b)}},iT:function(){return this.wz},fromJSON:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.ignoreStyle;if(a&&!n)for(c=this,d=c.items,e=a.itemsData,f=a.direction,g=a.head,h=a.tail,l=[],q(e,function(a,b){if(i=b.index,j=b.info,i>=0&&j){for(k=0;k<b.count&&!(i+k>=w(d));k++)b.info.collapsed&&l.push(b),d[i+k]=new ea(j);c.wz=!1}}),y(f)||c.direction(f),g&&(c.head=g),h&&(c.tail=h),_(c,!0),m=0;m<l.length;m++)c.E4(l[m].index,!0)},toJSON:function(a){var b,c,d,e,f,g,h,i,j,k=a&&a.ignoreStyle;if(!k){for(b=this,c=[],d=b.items,f=-1,e=0;e<w(d);e++)g=c[f],h=d[e],h&&(f>=0&&e===g.count+g.index&&h.level===g.info.level&&h.collapsed===g.info.collapsed?c[f].count++:c[++f]={index:e,count:1,info:{level:h.level,collapsed:h.collapsed}});return i={itemsData:c,direction:b.direction(),head:b.head,tail:b.tail},j={},q(i,function(a,b){Z(a,b)||(j[a]=b)}),p.isEmptyObject(j)?m:j}}},a}(),k.Outline=d;function ea(a){return{level:a?a.level:0,collapsed:!!a&&a.collapsed,viewCollapsed:!!a&&a.viewCollapsed}}function fa(a,b,c,d){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.bM=[],e.cM=[],e.dM=[],e.kj=a,e.ML=b,e.eM=c,e.ZL=x(d)?d:T(b,a).getMaxLevel()}fa.prototype={YL:function(){var a,b=this;b.ZL!==-1&&(a=b.fM(0,b.ML),q(a,function(a,c){b.gM(c)}))},gM:function(a){var b,c,d,e,f,g,h,i,j,k,m,p,r,s,t,u,v,x,y=this,z=y.kj,A=y.ML,B=T(A,z).direction(),C=1===B,D=0===B,E=y.hM(!0,A),F=y.hM(!1,A),G=a.start,H=a.end,I=a.level;if(C?b=H+1:D&&(b=G-1),0===a.state()){if(c=!0,d=a.parent,d&&(D&&G===d.start||C&&H===d.end)&&(c=!1),c&&y.iM(!0,I,b,E,F,B),G<=F&&H>=E){for(e=n(E,G),f=o(F,H),c&&(g={start:e,end:f,level:I,startLine:l},(C&&e===G||D&&f===H)&&(g.startLine=!0),y.bM.push(g)),j=[],k=a.children,h=e;h<=f;h++)j.push(!1);for(q(k,function(a,b){var c=b.start,d=b.end,f;if(1===b.state())for(i=c;i<=d;i++)j[i-e]=!0;f=C?d+1:d-1,j[f-e]=!0,y.gM(b)}),m=!0,h=0;h<w(k);h++){if(p=k[h],r=p.start,s=p.end,t=r===G,u=s===H,t&&u){m=!1;break}if(C&&u||D&&t)for(i=r;i<=s;i++)j[i-e]=!0}if(m)for(v=e;v<=f;v++)j[v-e]||(x={index:v,level:I+1},y.cM.push(x))}}else 1===a.state()&&y.iM(!1,I,b,E,F,B)},iM:function(a,b,c,d,e,f){var g={isExpanded:a,level:b};a&&(g.paintLine=!0),c>=d&&c<=e&&(g.index=c,g.lineDirection=f,this.dM.push(g))},jM:function(a){var b=this,c=b.kj,d=b.eM;return b.ML?c.Gr(d).findRow(a):c.Hr(d).findCol(a)},aM:function(a){var b,c,d,e,f,g,h,i=this;i.ZL!==-1&&(b=i.kj.Gt(),c=i.ML,d=S.call(i,b,c),d&&(e=i.START_LINE_SIZE,f=i.PADDING,g=i.LINE_SIZE,h=n(0,(d-e)/2)+f,a.save(),a.fillStyle=r(C).color,i.kM(a,i.cM,c,b,d,h,g),i.lM(a,i.bM,c,b,d,h,g,e),i.mM(a,i.dM,c,b,d,h,g,f),a.beginPath(),a.restore()))},kM:function(a,b,c,d,e,f,g){var h,i,j=this;q(b,function(b,k){var l,m,o,p=j.jM(k.index);p&&(l=c?p.y:p.x,m=(c?p.height:p.width)-g,m>=0&&(h=l+n(0,m/2),i=k.level*e+f,c?(o=h,h=i+.5,i=o):i+=.5,a.fillRect(d.x+h,d.y+i,g,g)))})},lM:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,p,q,r,s,t,u,v,x=this,y=x.kj,z=T(c,y).direction();for(i=0;i<w(b);i++){j=b[i],k=j.start,l=j.end;do m=x.jM(k),k++;while(!m&&k<=l);do p=x.jM(l),l--;while(!p&&l>=k);(m||p)&&(m?p||(p=m):m=p,q=c?m.y:m.x,r=j.level*e+f,s=c?g:n(0,p.x+p.width-m.x),t=c?n(0,p.y+p.height-m.y):g,1===z&&(q+=1),c?(u=q,q=r+.5,r=u):r+=.5,a.fillRect(d.x+q,d.y+r,s,t),j.startLine&&(v=o(h,e-g),v>0&&(0===z&&(c?r=r+t-g:q=q+s-g),c&&r>=m.y&&r<p.y+p.height?a.fillRect(d.x+q,d.y+r,v,g):!c&&q>=m.x&&q<p.x+p.width&&a.fillRect(d.x+q,d.y+r,g,v))))}},mM:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,p,q,s,t,u,v,x,y,z,A,B,E,F,G,H,I=this;for(i=0;i<w(b);i++)j=b[i],k=I.jM(j.index),k&&(l=c?k.height:k.width,l<=0||(m=n(0,(l-e)/2),s=(c?k.y:k.x)+m,t=j.level*e+h,u=o(e,l),v=e,z=l-u,c?(A=s,s=t,t=A,B=u,u=v,v=B,x=.5,y=0):(x=0,y=.5),a.strokeStyle=r(D).borderTopColor,a.lineWidth=1,a.fillStyle=r(D).backgroundColor,a.fillRect(d.x+s,d.y+t,u,v),p=d.x+s+x,q=d.y+t+y,a.strokeRect(p,q,u,v),a.fillStyle=r(C).color,I.nM(a,j.isExpanded,p,q,u,v),j.paintLine&&z>0&&(s=c?k.y:k.x,t=j.level*e+f,E=0===j.lineDirection,F=c?g:m,G=c?m:g,c?(H=s,s=t,t=H,E&&(t+=m+v,G=z-m)):E&&(s+=m+u,F=z-m),a.fillRect(d.x+s+x,d.y+t+y,F,G))))},nM:function(a,b,c,d,e,f){b||a.fillRect(c+e/2-1,d+4,2,f-8),a.fillRect(c+4,d+f/2-1,e-8,2)},fM:function(a,b){var c,d,e,f=this,g=f.kj,h=[],i=-1,j=-1,k=T(b,g),l=b?g.Gr:g.Hr,m=l.call(g,f.eM),p=w(m);for(p&&(d=m[0],e=m[p-1],i=n(0,(b?d.row:d.col)-1),j=b?o(g.getRowCount(),e.row+2):o(g.getColumnCount(),e.col+2));i<j;)c=k.find(i,a),c?(i=c.end+1,h.push(c)):i++;return h},hM:function(a,b){var c=-1,d=this,e=d.kj,f=d.eM,g=e.frozenRowCount(),h=e.frozenColumnCount(),i=e.frozenTrailingRowCount(),j=e.frozenTrailingColumnCount(),k=e.getRowCount(),l=e.getColumnCount();return 0===f?c=a?0:(b?g:h)-1:1===f?c=a?b?g:h:(b?k-i:l-j)-1:2===f&&(c=a?b?k-i:l-j:(b?k:l)-1),c},oM:function(a){a&&this.kj.CH&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},XL:function(a,b,c){var d,e,f,g,h,i,j,k,m,p,q,r,t,u,v,x,y,z=this,A=z.ZL;if(A<0)return l;if(d=z.kj,e=d.Gt(),f=S.call(z,e,c),!f)return l;for(g=z.dM,j=0;j<w(g);j++)if(k=g[j],m=k.index,p=k.level*f+z.PADDING,q=z.jM(m),q&&(h=c?q.height:q.width,!(h<=0)&&(r=o(f,h),t=f,u=(c?q.y:q.x)+n(0,(h-f)/2),v=p,c&&(x=r,r=t,t=x,y=u,u=v,v=y),i=new s(e.x+u+.5,e.y+v+.5,r,t),z.oM(i),i.contains(a,b))))return k;return l}};function ga(a,b,c){var d=this;d.PADDING=2,d.kj=a,d.ML=b,d.ZL=x(c)?c:T(b,a).getMaxLevel()}ga.prototype={_L:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,s,t,u,v,w,x,y,z,B,E,F,G,H=this,I=H.kj,J=H.ZL;if(!(J<0)&&(b=H.ML,c=I.Gt(),d=S.call(H,c,b),d&&(e=J+2,f=H.PADDING,g=I.options,h=c.width,i=c.height,j=c.x,k=c.y,l=I.am(),m=l.width,o=l.height,p=l.Cr,q=l.Br,s=l.zr,t=l.Ar,a.fillStyle=r(C).backgroundColor,a.strokeStyle=r(D).borderTopColor,a.font="8.25pt Arial",a.lineWidth=1,a.fillRect(j,k,b?h:m,b?o:i),a.strokeRect(j-.5,k-.5,b?h:m+1,b?o+1:i),b?a.strokeRect(j-.5,t-.5,h,p):a.strokeRect(s-.5,k-.5,q,i),u=(b?p:q)-d,w=n(0,(b?t:s)+u/2),x=f,b&&(z=w,w=x,x=z),v=b?g.colHeaderVisible:g.rowHeaderVisible,v&&u>=0)))for(y=0;y<e;y++)B=d-1,F=j+w,G=k+x,b?F+=.5:G+=.5,a.fillStyle=r(D).backgroundColor,a.fillRect(F,G,B,B),a.strokeRect(F,G,B,B),a.fillStyle=r(D).color,E=A(a.font),H.pM(a,F,G,B,d,y+1,E),b?w+=d:x+=d},pM:function(a,b,c,d,e,f,g){var h=""+f,i=a.measureText(h).width;i<=d&&g<=e&&(a.textBaseline="middle",a.fillText(h,b+(d-i)/2,c+d/2))},WL:function(a,b,c){var d,e,f,g=this,h=g.kj,i=g.ZL;return i<0?l:(d=i+2,e=h.am(),f=h.options,c?g.qM(h,a,b,c,f.colHeaderVisible,e.Cr,e.Ar,d):g.qM(h,a,b,c,f.rowHeaderVisible,e.Br,e.zr,d))},qM:function(a,b,c,d,e,f,g,h){var j,k,m,o,p,q=this,r=a.Gt(),s=S.call(q,r,d),t=f-s;if(s&&e&&t>=0)for(j=n(0,g+t/2),k=q.PADDING,d&&(p=j,j=k,k=p),o=0;o<h;o++){if(m=new i.Rect(r.x+j,r.y+k,s,s),m.contains(b,c))return{index:o};d?j+=s:k+=s}return l}},e=i.lUa;function ha(a){return a&&new ea(a)}function ia(a){return{items:a.items.map(ha),head:ha(a.head),tail:ha(a.tail),wz:a.wz,direction:a.direction()}}function ja(a,b){a.items=b.items.map(ha),a.head=ha(b.head),a.tail=ha(b.tail),a.wz=b.wz,a.direction(b.direction),_(a,!0)}p.extend(e.prototype,{vUa:function(a){var b=this,c=b.zTa;c&&(c.wUa||(c.wUa=[]),a&&!c.wUa[0]?c.wUa[0]=ia(b.xUa):a||c.wUa[1]||(c.wUa[1]=ia(b.yUa)))},zUa:function(a){var b,c;a&&(b=this,c=a[0],c&&ja(b.xUa,c),c=a[1],c&&ja(b.yUa,c))}}),e.$n("RANGE_GROUP",{init:function(){var a=this,b=a.kj;a.yUa=new d(a.getColumnCount(),b,(!1)),a.xUa=new d(a.getRowCount(),b,(!0))},undo:function(a){var b=a.wUa;b&&(this.zUa(b),this.kj.$p())}}),f={init:function(){var a=this;a.rowOutlines=a.ITa.xUa,a.columnOutlines=a.ITa.yUa,a.rowOutlines.groupChangeHandler=function(b){var c,d,e,f=b&&b.indexes;f&&a.recalcRows&&a.recalcRows(f),a.au(),c=a.charts,c&&(f?(d=f[0],e=f[f.length-1]):(d=0,e=a.getRowCount()-1),c.tTa(d,e,!0))},a.columnOutlines.groupChangeHandler=function(b){var c,d,e,f;a.bu(),c=b&&b.indexes,d=a.charts,d&&(c?(e=c[0],f=c[c.length-1]):(e=0,f=a.getColumnCount()-1),d.tTa(e,f,!1))},a.Wr.push(a.rowOutlines),a.Zr.push(a.columnOutlines)},dispose:function(){var a=this;p(a.Ws()).unbind("mousedown.group")},setHost:function(a){if(a){var b=this;a.bind("mousedown.group",function(a){var c,d=b.Vs(),e=P.call(b,a.pageX-d.left,a.pageY-d.top);e&&(c=e.what,c===G||c===E?b.rowOutlines.UL(b,e):c!==H&&c!==F||b.columnOutlines.UL(b,e))})}},onPaintSuspend:function(a){var b=this;a.suspend?(b.rowOutlines.Lia(),b.columnOutlines.Lia()):(b.rowOutlines.Mia(),b.columnOutlines.Mia())},onLayoutChanged:function(a){var b=this,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=a.sheetArea,i=b.rowOutlines,j=b.columnOutlines,k=this.ITa;"addRows"===c?(k.vUa(!0),U(i,d,e)):"deleteRows"===c?(k.vUa(!0),V(i,d,e)):"addColumns"===c?(k.vUa(!1),U(j,f,g)):"deleteColumns"===c?(k.vUa(!1),V(j,f,g)):"invalidateLayout"===c?b.TL=l:"setColumnCount"===c?(k.vUa(!1),3!==h&&1!==h||j.VL(g)):"setRowCount"!==c||3!==h&&2!==h||(k.vUa(!0),i.VL(e))},paint:function(a){var b=a.ctx,c=a.clipRect,d=this,e=d.rowOutlines,f=d.columnOutlines;e&&e.jp(d,b,c,!0),f&&f.jp(d,b,c,!1)},fromJson:function(a,b,c){if(a){var d=this,e,f=a.showRowRangeGroup,g=a.showColumnRangeGroup,h=x(f)?f:a.showRowOutline,i=x(g)?g:a.showColumnOutline;y(h)||d.showRowOutline(h),y(i)||d.showColumnOutline(i),e=a.rowRangeGroup||a.rowOutlines,e&&d.rowOutlines.fromJSON(e,c),e=a.colRangeGroup||a.columnOutlines,e&&d.columnOutlines.fromJSON(e,c)}},toJson:function(a,b){var c,d=this,e=d.rowOutlines,f=d.columnOutlines,g=d.showRowOutline();g!==!0&&(a.showRowOutline=g),c=d.showColumnOutline(),c!==!0&&(a.showColumnOutline=c),a.rowOutlines=e?e.toJSON(b):m,a.columnOutlines=f?f.toJSON(b):m}},i.Worksheet.$n(B,f),g={init:function(){j.SL(this.commandManager())}},i.Workbook.$n(B,g),a.exports=k}()},function(a,b){!function(){"use strict";a.exports={Exp_InvalidIndex:"Invalid index",Exp_InvalidCount:"Invalid count",Exp_InvalidLevel:"Invalid level",Exp_GroupInfoIsNull:"groupInfo is null"}}()}]);
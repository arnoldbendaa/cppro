var wijmo;!function(a){!function(a){function b(a,b){if(e.ensure(a),b&&b.length>0&&!e.check(b)){var c=window.console;c&&c.error&&c.error("["+a+"]: One or more dependency in ["+b+"] are not found!")}}var c=jQuery,d=null,e=function(){function b(a,b,c){this.prop=a,this.getter=b,this.setter=c}return b.parse=function(c){if(void 0!==c&&c!==d&&c.length>0){var e=c.split("."),f=d;do{var g=e.shift(),h=new b(g,function(){var b=this;return b.base?b.base.getter()[b.prop]:a.features[b.prop]},function(b){var c=this;if(c.base){var e=c.base.getter();(e===d||void 0===e)&&c.base.setter(e={}),e[c.prop]=b}else a.features[c.prop]=b});f&&(h.base=f),f=h}while(e.length>0);return f}return d},b.ensure=function(a){var c=b.parse(a);c&&c.setter(!0)},b.check=function(a){var d=!0;return c.each(a,function(a,c){var e=b.parse(c);return e&&!e.getter()?d=!1:!0}),d},b}();a.feature=b,a.features=function(a){return a?a:{core:{migrate:!1,mousewheel:!1,stringResource:!1,common:!1,imageLoader:!1,theme:!1,globalize:!1,spreadpanelex:!1,basecelltype:!1,sheet_model:!1,sheet_action:!1,sheet_event:!1,sheet_border:!1,sheet_render:!1,sheet_ui:!1,sheet:!1,spread:!1,spread_ui:!1},calc:{common:!1,functions:!1,functions_db:!1,functions_eng:!1,functions_fin:!1,functions_lookup:!1,functions_stat:!1},filter:!1,filter_ui:!1,sparkline:!1,table:!1,binding:!1,group:!1,celltype:!1,conditionalFormat:!1,dataValidator:!1,fill:!1,fill_ui:!1,formatter:!1,search:!1,touch:!1,floatingObject:!1,comment:!1,sparklineEx:!1,formulatextbox:!1,formulatextbox_resource:!1,basedialog:!1}}(a.features)}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(){a.feature("core.migrate"),function(a,b){var c=b().jquery?b().jquery.split("."):"";if(parseInt(c[0],10)>1||1===parseInt(c[0],10)&&parseInt(c[1],10)>=9){b.event.handle=b.event.dispatch;var d,e;b.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},b.browser||(d=b.uaMatch(navigator.userAgent),e={},d.browser&&(e[d.browser]=!0,e.version=d.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),b.browser=e);var f=b.fn.toggle;b.fn.toggle=function(a,c){if(!b.isFunction(a)||!b.isFunction(c))return f.apply(this,arguments);var d,e=arguments,g=a.guid||b.guid++,h=0;for(d=function(c){var d=(b._data(this,"lastToggle"+a.guid)||0)%h;return b._data(this,"lastToggle"+a.guid,d+1),c.preventDefault(),e[d].apply(this,arguments)||!1},d.guid=g;h<e.length;)e[h++].guid=g;return this.click(d)};var g=b.fn.andSelf||b.fn.addBack;b.fn.andSelf=function(){return g.apply(this,arguments)}}var h=navigator.userAgent.toLowerCase(),i=h.indexOf("compatible")<0&&null!==/(trident)(?:.*? rv ([\w.]+)|)/.exec(h);i&&b.browser&&(b.browser.mozilla=void 0,b.browser.msie=!0);var j=function(){var a=null,b=null;try{new ActiveXObject("")}catch(c){a=c.name}try{b=!!new ActiveXObject("htmlfile")}catch(c){b=!1}return b="ReferenceError"!=a&&0==b?!1:!0,!b};b.browser.msie&&j()&&(b.browser.metroMode=!0)}(window,jQuery)}(a.migrate||(a.migrate={}));a.migrate}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(){a.feature("core.mousewheel",["core.migrate"]);var b="DOMMouseScroll",c="mousewheel",d="undefined",e="on",f=[b,c];typeof jQuery.event.special.gcmousewheel===d&&!function(a){function g(b){var e=[].slice.call(arguments,1),f=0;return b=a.event.fix(b||window.event),b.type="gc"+c,typeof b.wheelDelta!==d&&null!==b.wheelDelta||typeof b.detail!==d&&null!==b.detail||(b.wheelDelta=b.originalEvent.wheelDelta,b.detail=b.originalEvent.detail),b.wheelDelta&&(f=b.wheelDelta/120),b.detail&&(f=-b.detail/3),e.unshift(b,f),a.event.handle.apply(b.target||b.srcElement,e)}a.event.special.gcmousewheel={setup:function(){if(this.addEventListener)for(var a=f.length;a;){var d=f[--a];d===c&&this.addEventListener(b,g,!1),this.addEventListener(d,g,!1)}else this.attachEvent(e+c,g)},teardown:function(){if(this.removeEventListener)for(var a=f.length;a;){var d=f[--a];d===c&&this.removeEventListener(b,g,!1),this.removeEventListener(d,g,!1)}else this.detachEvent(e+c,g)}},a.fn.extend({handlegcmousewheel:function(a){return a?this.bind(c,a):this.trigger(c)},unhandlegcmousewheel:function(a){return this.unbind(c,a)}})}(jQuery)}(a.mousewheel||(a.mousewheel={}));a.mousewheel}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){b.feature("core.stringResource");var c=function(){function b(){}return b.getHelpFuncs=function(){var b=a.spread.FormulaTextBoxResource_EN;return b?b.Functions:null},b.Exp_InvalidArgument="Invalid argument",b.Exp_InvalidCast="InvalidCastException",b.Exp_NotSupport="NotSupportException",b.Exp_FormulaInvalid="The formula you typed contains an invalid char: ",b.Exp_InvalidTokenAt="invalid token at ",b.Exp_InvalidArrayAt="Invalid array at ",b.Exp_InvalidCellReference="Invalid cell reference or name at ",b.Exp_InvalidFunctionName="Invalid function name",b.Exp_InvalidOverrideFunction="Cannot override built-in function",b.Exp_OverrideNotAllowed="Attempt to override function while override is not allowed",b.Exp_NoSyntax="no syntax '",b.Exp_MatchSyntax="'to match the syntax '",b.SingleQuotesFullStop="'.",b.SingleQuote="'",b.Exp_IsValid="' is invalid.",b.Exp_InvalidArray="Invalid array",b.AtIndexOn="' at index on ",b.FullStop=".",b.SingleQuoteAt="' at ",b.Exp_InvalidParameters="Invalid function parameters at ",b.Exp_InvalidArrayColumns="The length of array columns are unequal at ",b.Exp_ExprIsNull="The argument 'expr' is null",b.Exp_RuleIsNull="The argument 'rule' is null",b.CopyCells="Copy Cells",b.FillSeries="Fill Series",b.FillFormattingOnly="Fill Formatting Only",b.FillWithoutFormatting="Fill Without Formatting",b.Exp_NumberOnly="Only works for Numbers",b.Exp_RangeContainsMergedCell="Range should not have merged cell.",b.Exp_ChangeMergedCell="Cannot change part of merged cell.",b.Exp_TargetContainsMergedCells="Target range should not have merged cells.",b.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",b.SortAscending="Sort Ascending",b.SortDescending="Sort Descending",b.OK="OK",b.Cancel="Cancel",b.Search="Search",b.CheckAll="Check all",b.UncheckAll="Uncheck all",b.Blanks="(Blanks)",b.Exp_FilterItemIsNull="FilterItem is null.",b.Exp_InvalidColumnIndex="Invalid column index.",b.Exp_TokenIsNull="token is null",b.Exp_InvalidBackslash="the '\\' cannot be evaluated",b.Exp_FormatIllegal="format is illegal.",b.Exp_ValueIsNull="value is null",b.Exp_PartIsNull="part is null",b.Exp_DuplicatedDescriptor="The type of descriptor was added.",b.Exp_TokenIllegal="token is illegal.",b.Exp_ValueIllegal="value is illegal.",b.Exp_StringIllegal="string is illegal.",b.Exp_InvalidNull="InvalidNullException",b.Exp_InvalidOperation="InvalidOperationException",b.Exp_ArgumentNull="ArgumentNullException",b.Exp_CriteriaIsNull="criteria is null",b.Exp_InvalidString="Invalid string",b.Exp_InvalidDateFormat="Invalid date format pattern",b.Exp_InvalidOADate="invalid OADate",b.Exp_InvalidExponentFormat="invalid exponent format",b.Exp_InvalidSemicolons="invalid format: too many semicolons",b.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9.",b.Exp_BadFormatSpecifier="Bad Format Specifier",b.Exp_InvalidNumberFormat="Invalid number format pattern",b.Exp_InvalidIndex="Invalid index",b.Exp_InvalidCount="Invalid count",b.Exp_InvalidLevel="Invalid level",b.Exp_GroupInfoIsNull="groupInfo is null",b.Exp_SheetIsNull="sheet is null.",b.Exp_DestSheetIsNull="destSheet is null",b.Exp_PasteExtentIsNull="pasteExtent is null",b.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",b.Exp_ChangePartOfArray="Cannot change part of an array.",b.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",b.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",b.Exp_CellReadOnly="The row you are trying to change is protected and therefore read-only.",b.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",b.Exp_FillCellsReadOnly="The cells you are trying to fill is protected and therefore read-only.",b.Exp_OverlappingSpans="This operation will cause overlapping spans.",b.Exp_InvalidAndSpace="Invalid ",b.ColonSpace=": ",b.MustBeBetween=" (must be between ",b.SpaceAndSpace=" and ",b.RightBracketFullStop=").",b.Exp_SrcIsNull="The argument 'src' is null",b.Exp_DestIsNull="The argument 'dest' is null",b.Exp_InvalidCustomFunction="invalid custom function",b.Exp_InvalidCustomName="invalid custom name",b.Exp_IndexOutOfRange="Index is out of range!",b.Exp_InvalidRange="Invalid range",b.Exp_RangeIsNull="range is null",b.Exp_NotAFunction="is not a function",b.Exp_Format="Format",b.Exp_BraceMismatch="format: brace mis-match",b.Exp_InvalidFormat="invalid format",b.Exp_ArgumentOutOfRange="ArgumentOutOfRange",b.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",b.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",b.Exp_TableEmptyNameError="The table name cannot be empty.",b.Exp_TableInvalidRow="Invalid row index or row count.",b.Exp_TableInvalidColumn="Invalid column index or column count.",b.Exp_TableIntersectError="The tables cannot be intersected.",b.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",b.Exp_TableDataSourceNullError="Table datasource cannot be null.",b.Exp_TableStyleAddCustomStyleError="The style with the same name already exists in the styles.",b.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",b.Exp_TableResizeOutOfRange="The invalid row count, column count and table cannot be resize out of the sheet.",b.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",b.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",b.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",b.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",b.Tip_Row="Row: ",b.Tip_Column="Column: ",b.Tip_Height="Height: ",b.Tip_Width="Width: ",b.Tip_pixels=" pixels",b.NewTab="New...",b.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",b.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",b.Exp_FloatingObjectNameEmptyError="Floating object must have name",b.ToolStrip_PasteText="Paste",b.ToolStrip_CutText="Cut",b.ToolStrip_CopyText="Copy",b.ToolStrip_AutoFillText="AutoFill",b.Exp_ArrayFromulaPart="You cannot change part of an array.",b.Exp_ArrayFromulaSpan="Array formulas are not valid in merged cells.",b.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",b.Fbx_Summary="Summary",b}();b._ENStringResource=c;var d=function(){function b(){}return b.getHelpFuncs=function(){var b=a.spread.FormulaTextBoxResource_JP;return b?b.Functions:null},b.Exp_InvalidArgument="無効な引数",b.Exp_InvalidCast="例外:無効なキャスト",b.Exp_NotSupport="例外:サポートされていない機能の利用を試みました",b.Exp_FormulaInvalid="入力された数式は無効な文字を含んでいます : ",b.Exp_InvalidTokenAt="無効なトークン : ",b.Exp_InvalidArrayAt="無効な配列 : ",b.Exp_InvalidCellReference="セル名もしくはセル参照が無効です : ",b.Exp_InvalidFunctionName="無効な関数名",b.Exp_InvalidOverrideFunction="組込関数をオーバーライドすることはできません",b.Exp_OverrideNotAllowed="許可されていない関数オーバーライドの実行です",b.Exp_NoSyntax="構文 '",b.Exp_MatchSyntax="' は次の構文 '",b.SingleQuotesFullStop="' とマッチしませんでした。",b.SingleQuote="'",b.Exp_IsValid="' は無効です。",b.Exp_InvalidArray="無効な配列 : ",b.AtIndexOn="' 該当するインデックス : ",b.FullStop="",b.SingleQuoteAt="' 位置 : ",b.Exp_InvalidParameters="無効なパラメータの検出 : ",b.Exp_InvalidArrayColumns="配列のカラム長が一致しません 位置 : ",b.Exp_ExprIsNull="引数 'expr' が null です",b.Exp_RuleIsNull="引数 'rule' が null です",b.CopyCells="セルのコピー",b.FillSeries="連結データ",b.FillFormattingOnly="書式のみコピー",b.FillWithoutFormatting="書式なしコピー",b.Exp_NumberOnly="数字のみ有効です",b.Exp_RangeContainsMergedCell="結合されたセルが範囲に含まれています。",b.Exp_ChangeMergedCell="結合されたセルの一部を変更することはできません。",b.Exp_TargetContainsMergedCells="結合されたセルが指定の範囲に含まれています。",b.Exp_MergedCellsIdentical="この操作には同じサイズの結合セルが必要です。",b.SortAscending="昇順",b.SortDescending="降順",b.OK="OK",b.Cancel="キャンセル",b.Search="検索",b.CheckAll="すべて選択",b.UncheckAll="すべて解除",b.Blanks="(空白セル)",b.Exp_FilterItemIsNull="フィルタ項目が null です。",b.Exp_InvalidColumnIndex="無効な列インデックスです。",b.Exp_TokenIsNull="トークンが null です",b.Exp_InvalidBackslash="'\\' を評価できません。",b.Exp_FormatIllegal="フォーマットが不正です。",b.Exp_ValueIsNull="値は null です",b.Exp_PartIsNull="part は null です",b.Exp_DuplicatedDescriptor="その種類の記述子は既に追加されています。",b.Exp_TokenIllegal="トークンが不正です。",b.Exp_ValueIllegal="値が不正です。",b.Exp_StringIllegal="文字列が不正です。",b.Exp_InvalidNull="無効な null による例外",b.Exp_InvalidOperation="無効な操作による例外",b.Exp_ArgumentNull="null 引数による例外",b.Exp_CriteriaIsNull="条件となる引数が null です",b.Exp_InvalidString="無効な文字列",b.Exp_InvalidDateFormat="無効な日付フォーマット",b.Exp_InvalidOADate="無効な OADate",b.Exp_InvalidExponentFormat="無効な指数のフォーマットです",b.Exp_InvalidSemicolons="無効なフォーマット: セミコロンが多すぎます",b.Exp_InvalidNumberGroupSize="NumberGroupSize は1から9の値である必要があります。",b.Exp_BadFormatSpecifier="誤ったフォーマット指示子",b.Exp_InvalidNumberFormat="無効な数値フォーマットのパターンです",b.Exp_InvalidIndex="無効なインデックスです",b.Exp_InvalidCount="無効なカウントです",b.Exp_InvalidLevel="無効なレベルです",b.Exp_GroupInfoIsNull="groupInfo が null です",b.Exp_SheetIsNull="sheet が nullです。",b.Exp_DestSheetIsNull="destSheet が null です。",b.Exp_PasteExtentIsNull="pasteExtent が null です",b.Exp_InvalidPastedArea="貼り付け領域はコピー/切り取り範囲と同サイズである必要があります。",b.Exp_ChangePartOfArray="配列の一部を変更することはできません。",b.Exp_ColumnReadOnly="変更しようとしている列は保護されているため、読み取り専用となっています。",b.Exp_RowReadOnly="変更しようとしている行は保護されているため、読み取り専用となっています。",b.Exp_CellReadOnly="変更しようとしているセルは保護されているため、読み取り専用となっています。",b.Exp_FillRangeContainsMergedCell="結合したセルが含まれる範囲をフィルすることはできません。",b.Exp_FillCellsReadOnly="フィルしようとしている範囲は保護されているため、読み取り専用となっています。",b.Exp_OverlappingSpans="この操作は結合部分の重複を引き起こします。",b.Exp_InvalidAndSpace="無効な ",b.ColonSpace=" : ",b.MustBeBetween=" は ",b.SpaceAndSpace=" から ",b.RightBracketFullStop=" の間である必要があります。",b.Exp_SrcIsNull="引数 'src' は null です",b.Exp_DestIsNull="引数 'dest' は null です",b.Exp_InvalidCustomFunction="無効なカスタム関数",b.Exp_InvalidCustomName="無効な名前",b.Exp_IndexOutOfRange="範囲外のインデックスです!",b.Exp_InvalidRange="無効な範囲",b.Exp_RangeIsNull="範囲が null です",b.Exp_NotAFunction="は関数ではありません",b.Exp_Format="フォーマット",b.Exp_BraceMismatch="フォーマット: 括弧の個数が一致していません",b.Exp_InvalidFormat="無効なフォーマット",b.Exp_ArgumentOutOfRange="範囲外の引数",b.Exp_DragDropShiftTableCell="この操作はワークシート上のテーブル内でセルをシフトしようとしているため許可されません。",b.Exp_DragDropChangePartOfTable="操作を完了できません。許可されていない方法でテーブルの行または列の一部を変更しようとしています。",b.Exp_TableEmptyNameError="テーブル名を空にすることはできません。",b.Exp_TableInvalidRow="無効な行インデックスもしくは行数です。",b.Exp_TableInvalidColumn="無効な列インデックスもしくは列数です。",b.Exp_TableIntersectError="テーブルを重ね合わせることは出来ません。",b.Exp_TableHasSameNameError="すでに同名のワークシートが存在します。",b.Exp_TableDataSourceNullError="テーブルのデータソースを null にすることはできません。",b.Exp_TableStyleAddCustomStyleError="すでに同名のスタイル名が存在します。",b.Exp_TableMoveOutOfRange="テーブルをシート外に移動することはできません。",b.Exp_TableResizeOutOfRange="無効な行数、列数です。テーブルをシート範囲外にリサイズすることはできません。",b.Exp_PasteSourceCellsLocked="参照元となっているシートのセルはロックされています。",b.Exp_InvalidCopyPasteSize="コピーと貼り付けの範囲サイズが異なっています。",b.Exp_PasteDestinationCellsLocked="変更しようとしているセルは保護されているため、読み取り専用となっています。",b.Exp_PasteChangeMergeCell="結合したセルの一部は変更できません。",b.Tip_Row="行: ",b.Tip_Column="列: ",b.Tip_Height="高さ: ",b.Tip_Width="幅: ",b.Tip_pixels=" ピクセル",b.NewTab="New...",b.Exp_EmptyNamedStyle="名前付きスタイルの名称を空にすることはできません。",b.Exp_FloatingObjectHasSameNameError="すでに同名のオブジェクト名が存在します。",b.Exp_FloatingObjectNameEmptyError="オブジェクト名を空にすることはできません。",b.ToolStrip_PasteText="貼り付け",b.ToolStrip_CutText="切り取り",b.ToolStrip_CopyText="コピー",b.ToolStrip_AutoFillText="オートフィル",b.Exp_ArrayFromulaPart="配列の一部を変更できません。",b.Exp_ArrayFromulaSpan="配列数式は、結合したセルでは無効です。",b.Exp_ArrayFormulaTable="複数セルの配列数式はテーブルでは許可されていません。",b.Fbx_Summary="概要",b}();b._JPStringResource=d,b.SR=c}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){function c(a){if(e.browser.safari)return a.font;var b="",c="normal",d="400";return a.fontStyle!==c&&(b=a.fontStyle),a.fontVariant!==c&&(b+=" "+a.fontVariant),a.fontWeight!==c&&a.fontWeight!==d&&(b+=" "+a.fontWeight),b+=" "+a.fontSize,a.lineHeight!==c&&(b+="/"+a.lineHeight),b+=" "+a.fontFamily}function d(){var a=document.createElement("span");return e(a).css("visibility","hidden").css("top","-10000px").css("left","-10000px").css("position","absolute").attr("className","gcFontDetectSpanStyle").attr("gcUIElement","gcFontDetectSpan"),document.body.insertBefore(a,j),{span:a,dispose:function(){document.body.removeChild(a),delete this.span}}}b.feature("core.common",["core.migrate","core.stringResource"]);var e=jQuery,f="boolean",g="date",h="undefined",i=void 0,j=null,k=Math.abs,l=Math.floor,m=Math.min,n=Math.max;typeof e.wijmo===h&&(e.wijmo=a);var o=function(){function a(){}return a.createEventHandler=function(a,b){return function(){return b.apply(a,arguments)}},a.cancelDefault=function(a){return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1),!1},a._isStandardCanvas=function(){return typeof a.canvasApiFound===h&&(a.canvasApiFound=typeof document.createElement("canvas").getContext!==h),a.canvasApiFound},a._isSilverlightCanvas=function(){return a._isStandardCanvas()?!0:(typeof a.slCanvasApiFound===h&&(a.slCanvasApiFound=typeof window.slcanvas!==h),a.slCanvasApiFound)},a._useDoubleBuffer=function(){var b=a;return b._isStandardCanvas()||b._isSilverlightCanvas()},a.getHAlignByValueType=function(a,b){if(3===a){var c=e.type(b);a="boolean"===c?1:"number"===c||"date"===c?2:0}return a},a.inArray=function(a,b,c){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a,c);var d=b.length;for(c=c?0>c?n(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},a.parseColorString=function(b){var c=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,d=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,f=/^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,g=/^rgba\(([\s\d]*),([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,i=function(a){var b,c;return a?function(a){if(!c){var b=window.document.createElement("canvas");b&&b.getContext&&(c=b.getContext("2d"))}return c?(c.fillStyle=a,a=c.fillStyle):a}:function(a){return typeof b===h&&(b=e("<span></span>")),b.css("color",a),b.css("color")}}(a._isStandardCanvas()),k=function(a){return parseInt(a,16)},l=function(a){return parseInt(a+a,16)},m=function(a){return a.indexOf("%")>0?2.55*parseFloat(a):0|a},n=i(b),o=RegExp;if(c.test(n))return[o.$1,o.$2,o.$3].map(k);if(g.test(n)){var p=[o.$1,o.$2,o.$3].map(m);return p.splice(0,0,255*parseFloat(o.$4)),p}return f.test(n)?[o.$1,o.$2,o.$3].map(m):d.test(n)?[o.$1,o.$2,o.$3].map(l):j},a.position=function(b,c){if(!c||!c.offset)return a._position.call(b,c);var d=c.offset.split(" "),f=c.at.split(" ");return 1===d.length&&(d[1]=d[0]),/^\d/.test(d[0])&&(d[0]="+"+d[0]),/^\d/.test(d[1])&&(d[1]="+"+d[1]),1===f.length&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center")),a._position.call(b,e.extend(c,{at:f[0]+d[0]+" "+f[1]+d[1],offset:""}))},a.hasCalc=function(){return b.features.calc&&b.features.calc.common},a.toString=function(a){return a=a===j||a===i?"":e.type(a)===f?a.toString().toUpperCase():e.type(a)===g?new b._DateTimeHelper(a).format(0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()?"M/d/yyyy":"M/d/yyyy h:mm:ss"):a.toString()},a._applyBackgroundImageLayout=function(a,b,c,d,f,g){var h=e(a),i=b,j=c,k="background-position",l="background-size";switch(g){case 0:h.css(k,"0% 0%").css(l,"100% 100%");break;case 1:var m="50%",n="50%";d>i&&(m="0%"),f>j&&(n="0%"),h.css(k,m+" "+n).css(l,"auto auto");break;case 2:var o=0,p=0,q=i,r=j;j>0&&f>0&&i/j>d/f?(q=d/f*j,o=o+i/2-q/2):i>0&&d>0&&j/i>f/d&&(r=f/d*i,p=p+j/2-r/2),h.css(k,o+"px "+p+"px").css(l,q+"px "+r+"px");break;case 3:h.css(k,"0% 0%").css(l,"auto auto")}},a.device=function(){var a,b,c,d=navigator.userAgent,e=d.match(/iPad/i);return e&&(a=e[0],a&&(b="ipad"===a.toLowerCase())),e=d.match(/iPhone/i),e&&(a=e[0],a&&(c="iphone"===a.toLowerCase())),{ipad:b,iphone:c}},a.initPaint=function(b){var c=a._isStandardCanvas();if(!c){var d=document.getElementById(b),f=e(d).data("spread");if(f){f._initPaintTimeout!==i&&f._initPaintTimeout!==j&&window.clearTimeout(f._initPaintTimeout);var g=f.canvas.firstChild;if(g&&g.loaded){var h=g.Content.SpreadsheetObject;f.attachSpreadsheetObject(h)}else f._initPaintTimeout=window.setTimeout(function(){a.initPaint(b)},10)}}},a.isType=function(a,b){if(a===i||a===j)return"null"===b;if(!b)return!1;var c={undefined:"undefined",number:"number","boolean":"boolean",string:"string"};if(c[typeof a]===b)return!0;if("function"===b&&/^\s*\bfunction\b/.test(""+a))return!0;if(Object.prototype.toString.call(a).slice(8,-1).toLowerCase()===b.toLowerCase())return!0;if(a&&a._classNames){for(var d=0;d<a._classNames.length;d++){var e=a._classNames[d];if(e===b)return!0}return!1}return a===i||a===j?!1:"DateTime"===b||"TimeSpan"===b?a instanceof Date:"string"==typeof b&&c[b]?!1:a instanceof b},a.asType=function(b,c){return a.isType(b,c)?b:j},a._position=e.fn.position,a}();b.util=o;var p=function(){function a(){this._eventSuspended=0,typeof window.gcGlobal==h&&this._init()}return a.prototype._isIELessThan9=function(a,b){return a.browser.msie&&(typeof b===h||9>b)},a.prototype._createDummyObjects=function(){var b=a.prototype;if(!b._dummyContent){var c=function(a){var b=document.createElement("span");return b.className=a,b.style.display="none",document.body.insertBefore(b,j),b};b._dummyHeader=c("ui-widget-header ui-state-default wijmoThemeHelper"),b._dummyContent=c("ui-widget-content wijmoThemeHelper"),b._dummyHover=c("ui-state-hover wijmoThemeHelper"),b._dummyHighlight=c("ui-state-highlight wijmoThemeHelper")}},a.prototype._init=function(){window.gcGlobal=this,this._eventSuspended=0;var b=a.prototype;window.addEventListener&&(window.addEventListener("keydown",b.keyDown,!0),window.addEventListener("keyup",b.keyUp,!0),window.addEventListener("compositionstart",b.compositionStart,!0),document.addEventListener("selectstart",b.docSelectStart,!0)),e(document).mousedown(function(a){var c=window.gcGlobal.activeElement;if(c){var d=b.getUIElement(a.target),e=d&&"gcAttachedFormulaTextBox"===d.getAttribute("gcUIElement");d||!c._endEditImp||e||(c._endEditImp(!1),c.repaint()),!d&&c._disposeValidationUI&&c._disposeValidationUI(),d||(window.gcGlobal.activeElement=j)}}),e(document).ready(function(){a.prototype._createDummyObjects()})},a.prototype.keyDown=function(a){var b=window.gcGlobal;if(!(b._eventSuspended>0)){var c=b.activeElement,d=c&&c._validationSelect;if(d){var f=e(d);if(f.is(":visible"))return}c&&c.doKeyDown&&(c.doKeyDown(a),c.isEditing()||90!==a.keyCode&&89!==a.keyCode||!a.ctrlKey||a.altKey||o.cancelDefault(a))}},a.prototype.keyUp=function(a){var b=window.gcGlobal;if(!(b._eventSuspended>0)){var c=b.activeElement;c&&c.doKeyUp&&c.doKeyUp(a)}},a.prototype.compositionStart=function(){var a=window.gcGlobal;if(!(a._eventSuspended>0)){var b=a.activeElement;b&&b.doCompositionStart&&b.doCompositionStart()}},a.prototype.docSelectStart=function(a){return document.all===i&&window.gcGlobal&&window.gcGlobal.activeElement&&o.cancelDefault(a),!1},a.prototype.getUIElement=function(a){for(var b=a;b&&"BODY"!==b.tagName&&"function"==typeof b.getAttribute;){var c=b.getAttribute("gcUIElement");if(c||(c=b.gcUIElement),c)return b;b=b.parentNode}return j},a.prototype.getWijmoThemeStyle=function(b){var c=a.prototype,d=c._dummyHeader;1===b||2===b?d=c._dummyHighlight:4===b&&(d=c._dummyHover);var e=d.currentStyle;return document.defaultView&&document.defaultView.getComputedStyle&&(e=document.defaultView.getComputedStyle(d,"")),e},a.prototype.suspendEvent=function(){var a=window.gcGlobal;a._eventSuspended++},a.prototype.resumeEvent=function(){var a=window.gcGlobal;a._eventSuspended--,a._eventSuspended<0&&(a._eventSuspended=0)},a}();b.Global=p,window.gcGlobal=new p;var q=Array;q.prototype.remove=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return void this.splice(b,1)},q.prototype.contains=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return!0;return!1},q.prototype.indexOf=function(a,b){(b===i||b===j||isNaN(b))&&(b=0);for(var c=b;c<this.length;c++)if(this[c]===a)return c;return-1},q.prototype.map||(q.prototype.map=function(a,c){var d,e,f,g=window.Object(this),h=g.length>>>0;if("function"!=typeof a)throw new TypeError(a+b.SR.Exp_NotAFunction);for(c&&(d=c),e=new Array(h),f=0;h>f;){var i,j;f in g&&(i=g[f],j=a.call(d,i,f,g),e[f]=j),f++}return e}),function(a){a[a.left=37]="left",a[a.right=39]="right",a[a.up=38]="up",a[a.down=40]="down",a[a.tab=9]="tab",a[a.enter=13]="enter",a[a.shift=16]="shift",a[a.ctrl=17]="ctrl",a[a.space=32]="space",a[a.altkey=18]="altkey",a[a.home=36]="home",a[a.end=35]="end",a[a.pup=33]="pup",a[a.pdn=34]="pdn",a[a.backspace=8]="backspace",a[a.del=46]="del",a[a.esc=27]="esc",a[a.a=65]="a",a[a.c=67]="c",a[a.v=86]="v",a[a.x=88]="x",a[a.z=90]="z",a[a.y=89]="y"}(b.Key||(b.Key={}));var r=(b.Key,function(){function a(a,b,c,d,e,f){var g=this;g.key=a,g.ctrl=b,g.shift=c,g.alt=d,g.meta=f&&e||!1,g.action=f||e}return a}());b.KeyMap=r;var s=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.clone=function(){return new a(this.x,this.y)},a}();b.Point=s;var t=function(){function a(a,b,c,d){var e=this;e.x=a,e.y=b,e.width=c,e.height=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return a<e.x+e.width&&e.x<a+c&&b<e.y+e.height&&e.y<b+d},a.prototype.intersectRect=function(a){var b=this;return a.x<b.x+b.width&&b.x<a.x+a.width&&a.y<b.y+b.height&&b.y<a.y+a.height},a.prototype.contains=function(a,b){var c=this;return a<c.x+c.width&&c.x<a&&b<c.y+c.height&&c.y<b},a.prototype.containsRect=function(a){var b=this;return b.x<a.x&&a.x+a.width<b.x+b.width&&b.y<a.y&&a.y+a.height<b.y+b.height},a.prototype.getIntersectRect=function(a){return this.getIntersect(a.x,a.y,a.width,a.height)},a.prototype.getIntersect=function(b,c,d,e){var f=this,g=f.x,h=f.y,i=f.x+f.width,k=f.y+f.height,l=b,o=c,p=b+d,q=c+e,r=n(g,l),s=n(h,o),t=m(i,p),u=m(k,q),v=r,w=s,x=t-r,y=u-s;return x>0&&y>0?new a(v,w,x,y):j},a.empty=function(){return new a(0,0,0,0)},a}();b.Rect=t;var u=function(){function a(a,b,c,d){var e=this;e.row=a,e.rowCount=c,e.col=b,e.colCount=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return(-1===a||-1===e.row||e.row<a+c&&a<e.row+e.rowCount)&&(-1===b||-1===e.col||e.col<b+d&&b<e.col+e.colCount)},a.prototype.getIntersect=function(b,c,d){if(b==j)return j;var e=this;if(!e.intersect(b.row,b.col,b.rowCount,b.colCount))return j;var f=-1==e.col?d:e.col+e.colCount-1,g=-1==b.col?d:b.col+b.colCount-1,h=-1==e.row?c:e.row+e.rowCount-1,i=-1==b.row?c:b.row+b.rowCount-1,k=n(e.col,b.col),l=m(f,g),o=n(e.row,b.row),p=m(h,i),q=-1==o?-1:p-o+1,r=-1==k?-1:l-k+1;return new a(o,k,q,r)},a.prototype.contains=function(b,c,d,e){var f=this;return 2===arguments.length?(-1===f.row||f.row<=b&&b<f.row+f.rowCount)&&(-1===f.col||f.col<=c&&c<f.col+f.colCount):4===arguments.length?f.containsRange(new a(b,c,d,e)):!1},a.prototype.containsRange=function(a){var b=this;return(-1===b.row||b.row<=a.row&&a.row+a.rowCount<=b.row+b.rowCount)&&(-1===b.col||b.col<=a.col&&a.col+a.colCount<=b.col+b.colCount)},a.prototype.offset=function(b,c){var d=this,e=d.col,f=d.row;return-1!==d.col&&(e+=b),-1!==d.row&&(f+=c),new a(f,e,d.rowCount,d.colCount)},a.prototype.union=function(b){var c=this,d=m(c.row,b.row),e=m(c.col,b.col),f=n(c.row+c.rowCount-1,b.row+b.rowCount-1),g=n(c.col+c.colCount-1,b.col+b.colCount-1);return new a(d,e,f-d+1,g-e+1)},a.prototype.equals=function(b){var c=this;return b instanceof a?c.row===b.row&&c.col===b.col&&c.rowCount===b.rowCount&&c.colCount===b.colCount:!1},a}();b.Range=u,function(a){a[a.up=1]="up",a[a.down=2]="down",a[a.left=3]="left",a[a.right=4]="right"}(b.Direction||(b.Direction={}));b.Direction;!function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.general=3]="general"}(b.HorizontalAlign||(b.HorizontalAlign={}));b.HorizontalAlign;!function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom"}(b.VerticalAlign||(b.VerticalAlign={}));b.VerticalAlign;!function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.nearest=3]="nearest"}(b.HorizontalPosition||(b.HorizontalPosition={}));b.HorizontalPosition;!function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom",a[a.nearest=3]="nearest"}(b.VerticalPosition||(b.VerticalPosition={}));b.VerticalPosition;!function(a){a[a.blank=0]="blank",a[a.numbers=1]="numbers",a[a.letters=2]="letters"}(b.HeaderAutoText||(b.HeaderAutoText={}));b.HeaderAutoText;!function(a){a[a.All=0]="All",a[a.Values=1]="Values",a[a.Formatting=2]="Formatting",a[a.Formulas=3]="Formulas"}(b.ClipboardPasteOptions||(b.ClipboardPasteOptions={}));b.ClipboardPasteOptions;!function(a){a[a.None=0]="None",a[a.IncludeRowHeader=1]="IncludeRowHeader",a[a.IncludeColumnHeader=2]="IncludeColumnHeader",a[a.UnFormatted=8]="UnFormatted",a[a.ImportFormula=16]="ImportFormula"}(b.TextFileOpenFlags||(b.TextFileOpenFlags={}));b.TextFileOpenFlags;!function(a){a[a.Normal=0]="Normal",a[a.Highlight=1]="Highlight",a[a.Selected=2]="Selected",a[a.Active=3]="Active",a[a.Hover=4]="Hover"}(b.VisualState||(b.VisualState={}));b.VisualState;!function(a){a[a.A1=0]="A1",a[a.R1C1=1]="R1C1"}(b.ReferenceStyle||(b.ReferenceStyle={}));b.ReferenceStyle;!function(a){a[a.empty=0]="empty",a[a.thin=1]="thin",a[a.medium=2]="medium",a[a.dashed=3]="dashed",a[a.dotted=4]="dotted",a[a.thick=5]="thick",a[a["double"]=6]="double",a[a.hair=7]="hair",a[a.mediumDashed=8]="mediumDashed",a[a.dashDot=9]="dashDot",a[a.mediumDashDot=10]="mediumDashDot",a[a.dashDotDot=11]="dashDotDot",a[a.mediumDashDotDot=12]="mediumDashDotDot",a[a.slantedDashDot=13]="slantedDashDot"}(b.LineStyle||(b.LineStyle={}));b.LineStyle;!function(a){a[a.corner=0]="corner",a[a.colHeader=1]="colHeader",a[a.rowHeader=2]="rowHeader",a[a.viewport=3]="viewport"}(b.SheetArea||(b.SheetArea={}));b.SheetArea;!function(a){a[a.Value=1]="Value",a[a.Formula=2]="Formula",a[a.Comment=4]="Comment",a[a.RangeGroup=8]="RangeGroup",a[a.Sparkline=16]="Sparkline",a[a.Span=32]="Span",a[a.Style=64]="Style",a[a.Tag=128]="Tag",a[a.BindingPath=256]="BindingPath",a[a.ConditionalFormat=512]="ConditionalFormat",a[a.All=1023]="All"}(b.CopyToOption||(b.CopyToOption={}));b.CopyToOption;!function(a){a[a.Single=0]="Single",a[a.Range=1]="Range",a[a.MultiRange=2]="MultiRange"}(b.SelectionPolicy||(b.SelectionPolicy={}));b.SelectionPolicy;!function(a){a[a.Cell=0]="Cell",a[a.Row=1]="Row",a[a.Column=2]="Column"}(b.SelectionUnit||(b.SelectionUnit={}));b.SelectionUnit;!function(a){a[a.CopyCells=0]="CopyCells",a[a.FillSeries=1]="FillSeries",a[a.FillFormattingOnly=2]="FillFormattingOnly",a[a.FillWithoutFormatting=3]="FillWithoutFormatting",a[a.ClearValues=4]="ClearValues"}(b.AutoFillType||(b.AutoFillType={}));b.AutoFillType;!function(a){a[a.Left=0]="Left",a[a.Right=1]="Right",a[a.Up=2]="Up",a[a.Down=3]="Down"}(b.FillDirection||(b.FillDirection={}));b.FillDirection;!function(a){a[a.Column=0]="Column",a[a.Row=1]="Row"}(b.FillSeries||(b.FillSeries={}));b.FillSeries;!function(a){a[a.Data=1]="Data",a[a.Style=2]="Style",a[a.Comment=4]="Comment",a[a.Sparkline=16]="Sparkline",a[a.Axis=32]="Axis",a[a.BindingPath=64]="BindingPath"}(b.StorageType||(b.StorageType={}));b.StorageType;!function(a){a[a.Left=0]="Left",a[a.Right=1]="Right",a[a.Up=2]="Up",a[a.Down=3]="Down",a[a.LeftClear=4]="LeftClear",a[a.UpClear=5]="UpClear"}(b.DragFillDirection||(b.DragFillDirection={}));b.DragFillDirection;!function(a){a[a.Ready=0]="Ready",a[a.Enter=1]="Enter",a[a.Edit=2]="Edit"}(b.EditorStatus||(b.EditorStatus={}));b.EditorStatus;!function(a){a[a.AnyValue=0]="AnyValue",a[a.WholeNumber=1]="WholeNumber",a[a.DecimalValues=2]="DecimalValues",a[a.List=3]="List",a[a.Date=4]="Date",a[a.Time=5]="Time",a[a.TextLength=6]="TextLength",a[a.Custom=7]="Custom"
}(b.CriteriaType||(b.CriteriaType={}));b.CriteriaType;!function(a){a[a.ForceApply=0]="ForceApply",a[a.Discard=1]="Discard",a[a.Retry=2]="Retry"}(b.DataValidationResult||(b.DataValidationResult={}));b.DataValidationResult;!function(a){a[a.Stop=0]="Stop",a[a.Warning=1]="Warning",a[a.Information=2]="Information"}(b.ErrorStyle||(b.ErrorStyle={}));b.ErrorStyle;!function(a){a[a.EqualsTo=0]="EqualsTo",a[a.NotEqualsTo=1]="NotEqualsTo",a[a.GreaterThan=2]="GreaterThan",a[a.GreaterThanOrEqualsTo=3]="GreaterThanOrEqualsTo",a[a.LessThan=4]="LessThan",a[a.LessThanOrEqualsTo=5]="LessThanOrEqualsTo"}(b.GeneralCompareType||(b.GeneralCompareType={}));b.GeneralCompareType;!function(a){a[a.Or=0]="Or",a[a.And=1]="And"}(b.RelationCompareType||(b.RelationCompareType={}));b.RelationCompareType;!function(a){a[a.EqualsTo=0]="EqualsTo",a[a.NotEqualsTo=1]="NotEqualsTo",a[a.GreaterThan=2]="GreaterThan",a[a.GreaterThanOrEqualsTo=3]="GreaterThanOrEqualsTo",a[a.LessThan=4]="LessThan",a[a.LessThanOrEqualsTo=5]="LessThanOrEqualsTo",a[a.Between=6]="Between",a[a.NotBetween=7]="NotBetween"}(b.ComparisonOperator||(b.ComparisonOperator={}));b.ComparisonOperator;!function(a){a[a.Contains=0]="Contains",a[a.DoesNotContain=1]="DoesNotContain",a[a.BeginsWith=2]="BeginsWith",a[a.EndsWith=3]="EndsWith"}(b.TextComparisonOperator||(b.TextComparisonOperator={}));b.TextComparisonOperator;!function(a){a[a.EqualsTo=0]="EqualsTo",a[a.NotEqualsTo=1]="NotEqualsTo",a[a.BeginsWith=2]="BeginsWith",a[a.DoesNotBeginWith=3]="DoesNotBeginWith",a[a.EndsWith=4]="EndsWith",a[a.DoesNotEndWith=5]="DoesNotEndWith",a[a.Contains=6]="Contains",a[a.DoesNotContain=7]="DoesNotContain"}(b.TextCompareType||(b.TextCompareType={}));b.TextCompareType;!function(a){a[a.BackgroundColor=0]="BackgroundColor",a[a.ForegroundColor=1]="ForegroundColor"}(b.ColorCompareType||(b.ColorCompareType={}));b.ColorCompareType;!function(a){a[a.Empty=0]="Empty",a[a.NonEmpty=1]="NonEmpty",a[a.Error=2]="Error",a[a.NonError=3]="NonError",a[a.Formula=4]="Formula"}(b.CustomValueType||(b.CustomValueType={}));b.CustomValueType;!function(a){a[a.EqualsTo=0]="EqualsTo",a[a.NotEqualsTo=1]="NotEqualsTo",a[a.Before=2]="Before",a[a.BeforeEqualsTo=3]="BeforeEqualsTo",a[a.After=4]="After",a[a.AfterEqualsTo=5]="AfterEqualsTo"}(b.DateCompareType||(b.DateCompareType={}));b.DateCompareType;!function(a){a[a.Top=0]="Top",a[a.Bottom=1]="Bottom"}(b.Top10ConditionType||(b.Top10ConditionType={}));b.Top10ConditionType;!function(a){a[a.Today=0]="Today",a[a.Yesterday=1]="Yesterday",a[a.Tomorrow=2]="Tomorrow",a[a.Last7Days=3]="Last7Days",a[a.ThisMonth=4]="ThisMonth",a[a.LastMonth=5]="LastMonth",a[a.NextMonth=6]="NextMonth",a[a.ThisWeek=7]="ThisWeek",a[a.LastWeek=8]="LastWeek",a[a.NextWeek=9]="NextWeek"}(b.DateOccurringType||(b.DateOccurringType={}));b.DateOccurringType;!function(a){a[a.Quarter1=0]="Quarter1",a[a.Quarter2=1]="Quarter2",a[a.Quarter3=2]="Quarter3",a[a.Quarter4=3]="Quarter4"}(b.QuarterType||(b.QuarterType={}));b.QuarterType;!function(a){a[a.None=0]="None",a[a.Ascending=1]="Ascending",a[a.Descending=2]="Descending"}(b.SortState||(b.SortState={}));b.SortState;!function(a){a[a.Above=0]="Above",a[a.Below=1]="Below",a[a.EqualOrAbove=2]="EqualOrAbove",a[a.EqualOrBelow=3]="EqualOrBelow",a[a.Above1StdDev=4]="Above1StdDev",a[a.Below1StdDev=5]="Below1StdDev",a[a.Above2StdDev=6]="Above2StdDev",a[a.Below2StdDev=7]="Below2StdDev",a[a.Above3StdDev=8]="Above3StdDev",a[a.Below3StdDev=9]="Below3StdDev"}(b.AverageConditionType||(b.AverageConditionType={}));b.AverageConditionType;!function(a){a[a.Number=0]="Number",a[a.LowestValue=1]="LowestValue",a[a.HighestValue=2]="HighestValue",a[a.Percent=3]="Percent",a[a.Percentile=4]="Percentile",a[a.Automin=5]="Automin",a[a.Formula=6]="Formula",a[a.Automax=7]="Automax"}(b.ScaleValueType||(b.ScaleValueType={}));b.ScaleValueType;!function(a){a[a.LeftToRight=0]="LeftToRight",a[a.RightToLeft=1]="RightToLeft"}(b.BarDirection||(b.BarDirection={}));b.BarDirection;!function(a){a[a.Automatic=0]="Automatic",a[a.CellMidPoint=1]="CellMidPoint",a[a.None=2]="None"}(b.DataBarAxisPosition||(b.DataBarAxisPosition={}));b.DataBarAxisPosition;!function(a){a[a.ThreeArrowsColored=0]="ThreeArrowsColored",a[a.ThreeArrowsGray=1]="ThreeArrowsGray",a[a.ThreeTriangles=2]="ThreeTriangles",a[a.ThreeStars=3]="ThreeStars",a[a.ThreeFlags=4]="ThreeFlags",a[a.ThreeTrafficLightsUnrimmed=5]="ThreeTrafficLightsUnrimmed",a[a.ThreeTrafficLightsRimmed=6]="ThreeTrafficLightsRimmed",a[a.ThreeSigns=7]="ThreeSigns",a[a.ThreeSymbolsCircled=8]="ThreeSymbolsCircled",a[a.ThreeSymbolsUncircled=9]="ThreeSymbolsUncircled",a[a.FourArrowsColored=10]="FourArrowsColored",a[a.FourArrowsGray=11]="FourArrowsGray",a[a.FourRedToBlack=12]="FourRedToBlack",a[a.FourRatings=13]="FourRatings",a[a.FourTrafficLights=14]="FourTrafficLights",a[a.FiveArrowsColored=15]="FiveArrowsColored",a[a.FiveArrowsGray=16]="FiveArrowsGray",a[a.FiveRatings=17]="FiveRatings",a[a.FiveQuarters=18]="FiveQuarters",a[a.FiveBoxes=19]="FiveBoxes"}(b.IconSetType||(b.IconSetType={}));b.IconSetType;!function(a){a[a.Number=1]="Number",a[a.Percent=4]="Percent",a[a.Formula=7]="Formula",a[a.Percentile=5]="Percentile"}(b.IconValueType||(b.IconValueType={}));b.IconValueType;!function(a){a[a.Backward=0]="Backward",a[a.Forward=1]="Forward"}(b.RangeGroupDirection||(b.RangeGroupDirection={}));b.RangeGroupDirection;!function(a){a[a.None=0]="None",a[a.Column=1]="Column",a[a.Row=2]="Row",a[a.Both=3]="Both"}(b.ShowResizeTip||(b.ShowResizeTip={}));b.ShowResizeTip;!function(a){a[a.None=0]="None",a[a.Horizontal=1]="Horizontal",a[a.Vertical=2]="Vertical",a[a.Both=3]="Both"}(b.ShowScrollTip||(b.ShowScrollTip={}));b.ShowScrollTip;!function(a){a[a.Cell=0]="Cell",a[a.CellWithHeader=1]="CellWithHeader"}(b.AutoFitType||(b.AutoFitType={}));b.AutoFitType;!function(a){a[a.Stretch=0]="Stretch",a[a.Center=1]="Center",a[a.Zoom=2]="Zoom",a[a.None=3]="None"}(b.ImageLayout||(b.ImageLayout={}));b.ImageLayout;!function(a){a[a.SetFormula=0]="SetFormula",a[a.CopyPaste=1]="CopyPaste",a[a.DragFill=2]="DragFill",a[a.DragDrop=3]="DragDrop",a[a.ChangePartOfArrayFormula=4]="ChangePartOfArrayFormula"}(b.InvalidOperationType||(b.InvalidOperationType={}));b.InvalidOperationType;!function(a){a[a.CurrentCulture=0]="CurrentCulture",a[a.CurrentCultureIgnoreCase=1]="CurrentCultureIgnoreCase",a[a.InvariantCulture=2]="InvariantCulture",a[a.InvariantCultureIgnoreCase=3]="InvariantCultureIgnoreCase",a[a.Ordinal=4]="Ordinal",a[a.OrdinalIgnoreCase=5]="OrdinalIgnoreCase"}(b.StringComparison||(b.StringComparison={}));b.StringComparison;!function(a){a[a.Underline=1]="Underline",a[a.LineThrough=2]="LineThrough",a[a.Overline=4]="Overline",a[a.None=0]="None"}(b.TextDecorationType||(b.TextDecorationType={}));b.TextDecorationType;!function(a){a[a.Auto=1]="Auto",a[a.Active=2]="Active",a[a.Inactive=4]="Inactive",a[a.Disabled=0]="Disabled"}(b.ImeMode||(b.ImeMode={}));b.ImeMode;!function(a){a[a.Active=1]="Active",a[a.Edit=2]="Edit",a[a.Normal=3]="Normal"}(b.CommentState||(b.CommentState={}));var v=(b.CommentState,function(){function a(a,b){this.color=a||"black",this.style=b||0}return a.prototype.width=function(a){if(a&&a.style)switch(a.style){case 9:case 1:case 3:case 4:case 7:case 11:return 1;case 2:case 10:case 12:case 8:case 13:return 2;case 5:case 6:return 3}return 0},a.prototype._weight=function(a){if(a&&a.style)switch(a.style){case 9:case 3:case 4:case 11:case 7:return 100;case 1:return 101;case 13:case 8:case 10:case 12:return 198;case 2:return 199;case 5:return 300;case 6:return 90;case 0:return 0}return-2},a.prototype.toJSON=function(){var a={};return"black"!==this.color&&(a.color=this.color),0!==this.style&&(a.style=this.style),e.isEmptyObject(a)?i:a},a.prototype.fromJSON=function(a){a&&(a.color!==i&&(this.color=a.color),a.style!==i&&(this.style=a.style))},a}());b.LineBorder=v;var w=function(){var a={};return a["font-style"]=function(a,b){a&&e(b).css("fontStyle",a)},a["font-variant"]=function(a,b){a&&e(b).css("fontVariant",a)},a["font-weight"]=function(a,b){a&&e(b).css("fontWeight",a)},a["font-size"]=function(a,b){a&&e(b).css("fontSize",a)},a["line-height"]=function(a,b){a&&e(b).css("lineHeight",a)},a["font-family"]=function(a,b){a&&e(b).css("fontFamily",a)},a}(),x=function(){function a(a){this._sheet=a}return a.prototype.buildFont=function(a,b){var f="";if(a){var g=d(this._sheet);try{b&&e(g.span).css("font",b),e.each(w,function(b,c){c(a.hasOwnProperty(b)?a[b]:j,g.span)})}finally{var h=g.span.currentStyle;document.defaultView&&document.defaultView.getComputedStyle&&(h=document.defaultView.getComputedStyle(g.span,"")),f=c(h),g.dispose()}}return f},a}();b.FontFactory=x;var y=function(){function a(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v){if(0!==arguments.length){var w=this;w.backgroundImage=q,w.backgroundImageLayout=s,w.backColor=a,w.foreColor=b,w.hAlign=c,w.vAlign=d,w.font=e,w.themeFont=f,w.formatter=g,w.borderLeft=h,w.borderTop=j,w.borderRight=k,w.borderBottom=l,w.locked=m,w.textIndent=n,w.wordWrap=o,w.shrinkToFit=p,w.validator=i,w.cellType=r,w.tabStop=t,w.textDecoration=u,w.imeMode=v}}return a.prototype._initDefault=function(){var a=this;a.backgroundImage=i,a.backgroundImageLayout=i,a.backColor=i,a.foreColor=i,a.hAlign=i,a.vAlign=i,a.font=i,a.themeFont=i,a.formatter=i,a.validator=i,a.borderLeft=i,a.borderTop=i,a.borderRight=i,a.borderBottom=i,a.locked=i,a.textIndent=i,a.wordWrap=i,a.shrinkToFit=i,a.cellType=i,a.name=i,a.parentName=i,a.tabStop=i,a.textDecoration=i,a.imeMode=i},a.prototype.copyFrom=function(a){var b=this;if(b.backgroundImage=a.backgroundImage,b.backgroundImageLayout=a.backgroundImageLayout,b.backColor=a.backColor,b.foreColor=a.foreColor,b.hAlign=a.hAlign,b.vAlign=a.vAlign,b.font=a.font,b.themeFont=a.themeFont,b.formatter=a.formatter,b._autoFormatter=a._autoFormatter,b.validator=a.validator,b.locked=a.locked,b.textIndent=a.textIndent,b.wordWrap=a.wordWrap,b.shrinkToFit=a.shrinkToFit,b.cellType=a.cellType,b.name=a.name,b.parentName=a.parentName,b.tabStop=a.tabStop,b.textDecoration=a.textDecoration,b.imeMode=a.imeMode,void 0!==a.borderLeft){var c=new v;c.fromJSON(a.borderLeft),b.borderLeft=c}if(void 0!==a.borderRight){var d=new v;d.fromJSON(a.borderRight),b.borderRight=d}if(void 0!==a.borderTop){var e=new v;e.fromJSON(a.borderTop),b.borderTop=e}if(void 0!==a.borderBottom){var f=new v;f.fromJSON(a.borderBottom),b.borderBottom=f}},a.prototype._cloneLineBorder=function(a){return a&&a instanceof v?new v(a.color,a.style):a},a.prototype.compose=function(a,b){var c=this,d=c._cloneLineBorder;if(b){c._autoFormatter=a._autoFormatter,c.backgroundImage=a.backgroundImage,c.backgroundImageLayout=a.backgroundImageLayout,c.backColor=a.backColor,c.foreColor=a.foreColor,c.hAlign=a.hAlign,c.vAlign=a.vAlign,c.font=a.font,c.themeFont=a.themeFont,c.formatter=a.formatter;var e=a.borderLeft;c.borderLeft=e&&d(e)||e;var f=a.borderTop;c.borderTop=f&&d(f)||f;var g=a.borderRight;c.borderRight=g&&d(g)||g;var h=a.borderBottom;c.borderBottom=h&&d(h)||h,c.locked=a.locked,c.textIndent=a.textIndent,c.wordWrap=a.wordWrap,c.shrinkToFit=a.shrinkToFit,c.validator=a.validator,c.cellType=a.cellType,c.name=a.name,c.parentName=a.parentName,c.tabStop=a.tabStop,c.textDecoration=a.textDecoration,c.imeMode=a.imeMode}else{if(c.backgroundImage===i&&(c.backgroundImage=a.backgroundImage),c.backgroundImageLayout===i&&(c.backgroundImageLayout=a.backgroundImageLayout),c.backColor===i&&(c.backColor=a.backColor),c.foreColor===i&&(c.foreColor=a.foreColor),c.hAlign===i&&(c.hAlign=a.hAlign),c.vAlign===i&&(c.vAlign=a.vAlign),c.font===i&&(c.font=a.font),c.themeFont===i&&(c.themeFont=a.themeFont),c.formatter===i&&(c.formatter=a.formatter),c.validator===i&&(c.validator=a.validator),c._autoFormatter===i&&(c._autoFormatter=a._autoFormatter),c.borderLeft===i){var e=a.borderLeft;c.borderLeft=e&&d(e)||e}if(c.borderTop===i){var f=a.borderTop;c.borderTop=f&&d(f)||f}if(c.borderRight===i){var g=a.borderRight;c.borderRight=g&&d(g)||g}if(c.borderBottom===i){var h=a.borderBottom;c.borderBottom=h&&d(h)||h}c.locked===i&&(c.locked=a.locked),c.textIndent===i&&(c.textIndent=a.textIndent),c.wordWrap===i&&(c.wordWrap=a.wordWrap),c.shrinkToFit===i&&(c.shrinkToFit=a.shrinkToFit),c.cellType===i&&(c.cellType=a.cellType),c.tabStop===i&&(c.tabStop=a.tabStop),c.textDecoration===i&&(c.textDecoration=a.textDecoration),c.imeMode===i&&(c.imeMode=a.imeMode),c.name===i&&(c.name=a.name),c.parentName===i&&(c.parentName=a.parentName)}},a.prototype.clear=function(a){return 0===arguments.length?void this._initDefault():("dataValidator"===a&&(a="validator"),void(this[a]=i))},a.prototype.clone=function(){var b=this,c=b._cloneLineBorder,d=new a(b.backColor,b.foreColor,b.hAlign,b.vAlign,b.font,b.themeFont,b.formatter,b.borderLeft&&c(b.borderLeft)||b.borderLeft,b.borderTop&&c(b.borderTop)||b.borderTop,b.borderRight&&c(b.borderRight)||b.borderRight,b.borderBottom&&c(b.borderBottom)||b.borderBottom,b.locked,b.textIndent,b.wordWrap,b.shrinkToFit,b.backgroundImage,b.cellType,b.backgroundImageLayout,b.tabStop,b.textDecoration,b.imeMode);return d.name=b.name,d.parentName=b.parentName,d._autoFormatter=b._autoFormatter,d.validator=b.validator,d},a.prototype._normalize=function(a){var b=this;if(a&&a.getColor){var c=b.foreColor;c&&(c=a.getColor(c),c&&(b.foreColor=c)),c=b.backColor,c&&(c=a.getColor(c),c&&(b.backColor=c));for(var d=[b.borderLeft,b.borderTop,b.borderRight,b.borderBottom],e=0,f=d.length;f>e;e++){var g=d[e];g&&g.color&&(c=a.getColor(g.color),c&&(g.color=c))}}return b.themeFont&&a&&a.getFont&&(b.font=z.composeFont(b.font,a.getFont(b.themeFont))),b},a.prototype._setActualAutoFormatter=function(a){var b=this;if(b&&b._autoFormatter&&b._autoFormatter._innerFormatter&&a!==j){var c=b._autoFormatter._innerFormatter,d=c.formatCached,e=c.GetPreferredEditingFormatter(a);d!==e.formatCached&&(b._autoFormatter._innerFormatter=e)}},a}();b.Style=y;var z=function(){function a(){}return a.composeFont=function(b,c){return c?a.normalizeFont(b,c):b},a.normalizeFont=function(b,d){if(!b&&!d)return b;var f=a;this.measureSpan||f._createMeasureSpan();var g,h,i=f.measureSpan;if(b){if(g=d?b+"+"+d:b,h=f._fontStringCatch[g])return h;e(i).css("font",b)}else{if(g=d,h=f._fontStringCatch[g])return h;e(i).css("fontSize","10pt")}d&&e(i).css("fontFamily",d);var j=i.currentStyle;return document.defaultView&&document.defaultView.getComputedStyle&&(j=document.defaultView.getComputedStyle(i,"")),h=c(j),f._fontStringCatch[g]=h,f._fontStringCatch[h]=h,h},a._scaleFont=function(b,c,d,e){var f,g=a,h=g.scaleFontInfoCache;if(!e)if(h){if(f=h[b])return f}else h=g.scaleFontInfoCache={};var i=g.measureSpan;i||(g._createMeasureSpan(),i=g.measureSpan),i.style.font=b;var j=i.currentStyle,k=document.defaultView;k&&k.getComputedStyle&&(j=k.getComputedStyle(i,""));var m=j.fontSize,o="px";if(-1!==m.indexOf(o)){var p=n(1,l(parseFloat(m.replace(o,""))*c));d&&1===p&&(d.value=!0),m=p+o}return 1===c?f={font:b,fontSize:p}:(i.style.fontSize=m,f={font:i.style.font,fontSize:p}),e||(h[b]=f),f},a._createMeasureSpan=function(){var a=document.createElement("span"),b=a.style;b.visibility="hidden",b.top="-10000px",b.left="-10000px",document.body.insertBefore(a,j),this.measureSpan=a},a._disposeMeasureSpan=function(){var a=this.measureSpan;a&&(e(a).remove(),this.measureSpan=i)},a._fontStringCatch={},a.scaleFontInfoCache=j,a}();b.StyleHelper=z;var A=function(){function a(a,b,c,d){var e=this;e._name=a,e._baseRow=c,e._baseColumn=d,e._expr=b}return a.prototype.getName=function(){return this._name},a.prototype.getRow=function(){return this._baseRow},a.prototype.getColumn=function(){return this._baseColumn},a.prototype.getExpression=function(){return this._expr},a.prototype.setExpression=function(a){this._expr=a},a}();b.NameInfo=A;var B=function(){function a(a,b,c,d,e){this._init(a,b,c,d,e)}return a.prototype._init=function(a,b,c,d,e){this._bounds=new t(a,b,c,d),this._name=e},a.prototype.getBounds=function(){return this._bounds},a.prototype.setBounds=function(a){var b=this._bounds;b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height},a.prototype._draw=function(a){if(a){var b=this,c=b._bounds;a.save();var d=a.createLinearGradient(c.x,c.y,c.x,c.y+40);d.addColorStop(0,"#00ABEB"),d.addColorStop(1,"#fff"),a.fillStyle=d,a.fillRect(c.x,c.y,c.width,c.height);var e=b._name;e&&e.length>0&&(a.fillStyle="darkblue",a.font="20pt Arial",a.fillText(e,c.x+36,c.y+28)),a.strokeStyle="black",a.strokeRect(c.x,c.y,c.width,c.height),a.restore()}},a.prototype.size=function(a,b){var c=this._bounds;c.width=a,c.height=b},a.prototype.move=function(a,b){var c=this._bounds;c.x=a,c.y=b},a}();b.GcUIElement=B;var C=function(){function a(){}return a.getColor=function(a,b){if(a&&b){var c=a._currentTheme;if(c)return c.getColor(b)}return b},a.getFont=function(a,b){if(a&&b){var c=a._currentTheme;return c?c.getFont(b):b}return j},a}();b._ThemeContext=C;var D=function(){function a(a){var b=this;b.host=a,b.interval=j,b.action=j,b.intervalId=j,b.result=j,b.working=!1,b._needIncrease=!1}return a.prototype.setAction=function(a){"function"==typeof a&&(this.action=a)},a.prototype.setInterval=function(a){var b=this;if(isNaN(a)||0===a)b.stop();else{b._needIncrease=a>0?!0:!1,a=k(a);var c=b.interval;b.interval=a,c!==a&&b.start()}},a.prototype.start=function(){var a=this;a.clear(),isNaN(a.interval)||(a.intervalId=setInterval(function(){a.run()},a.interval))},a.prototype.run=function(){var a=this;a.working=!0,"function"==typeof a.action&&(a.result=a.action.call(a.host,a._needIncrease))},a.prototype.stop=function(){var a=this;a.clear(),a.interval=j,a.intervalId=j,a.result=j,a.working=!1},a.prototype.clear=function(){this.intervalId&&clearInterval(this.intervalId)},a.prototype._dispose=function(){this.stop()},a}();b.Timer=D;var E=function(){function a(){}return a.ValidationError="ValidationError",a.CellClick="CellClick",a.CellDoubleClick="CellDoubleClick",a.EnterCell="EnterCell",a.LeaveCell="LeaveCell",a.ValueChanged="ValueChanged",a.TopRowChanged="TopRowChanged",a.LeftColumnChanged="LeftColumnChanged",a.InvalidOperation="InvalidOperation",a.RangeFiltering="RangeFiltering",a.RangeFiltered="RangeFiltered",a.RangeSorting="RangeSorting",a.RangeSorted="RangeSorted",a.ClipboardChanging="ClipboardChanging",a.ClipboardChanged="ClipboardChanged",a.ClipboardPasting="ClipboardPasting",a.ClipboardPasted="ClipboardPasted",a.ColumnWidthChanging="ColumnWidthChanging",a.ColumnWidthChanged="ColumnWidthChanged",a.RowHeightChanging="RowHeightChanging",a.RowHeightChanged="RowHeightChanged",a.DragDropBlock="DragDropBlock",a.DragDropBlockCompleted="DragDropBlockCompleted",a.DragFillBlock="DragFillBlock",a.DragFillBlockCompleted="DragFillBlockCompleted",a.EditStarting="EditStarting",a.EditStarted="EditStarted",a.EditChange="EditChange",a.EditEnding="EditEnding",a.EditEnd="EditEnd",a.EditEnded="EditEnded",a.RangeGroupStateChanging="RangeGroupStateChanging",a.RangeGroupStateChanged="RangeGroupStateChanged",a.SelectionChanging="SelectionChanging",a.SelectionChanged="SelectionChanged",a.SheetTabClick="SheetTabClick",a.SheetTabDoubleClick="SheetTabDoubleClick",a.SheetNameChanging="SheetNameChanging",a.SheetNameChanged="SheetNameChanged",a.UserZooming="UserZooming",a.UserFormulaEntered="UserFormulaEntered",a.CellChanged="CellChanged",a.ColumnChanged="ColumnChanged",a.RowChanged="RowChanged",a.ActiveSheetChanging="ActiveSheetChanging",a.ActiveSheetChanged="ActiveSheetChanged",a.SparklineChanged="SparklineChanged",a.RangeChanged="RangeChanged",a.ButtonClicked="ButtonClicked",a.EditorStatusChanged="EditorStatusChanged",a.CultureChanged="SpreadJSCultureChanged",a.FloatingObjectChanged="FloatingObjectChanged",a.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",a.PictureChanged="PictureChanged",a.PictureSelectionChanged="PictureSelectionChanged",a.CustomFloatingObjectLoaded="CustomFloatingObjectLoaded",a.TouchToolStripOpening="TouchToolStripOpening",a.CommentChanged="CommentChanged",a}();b.Events=E;var F=function(){function a(){return Array.apply(this,arguments),[]}return a.prototype.pop=function(){return j},a.prototype.push=function(){return 0},a.prototype.splice=function(){for(var a=[],b=0;b<arguments.length-2;b++)a[b]=arguments[b+2];return j},a}();b._XArray=F,F.prototype=[];var G=function(){function a(a){this._cachedCells={},this._cachedColumns={},this._cachedRows={},this._sheet=a}return a.prototype.addCell=function(a,b,c){var d=this._cachedCells,e=d[a];e||(e=d[a]={}),e[b]=c},a.prototype.getCachedCell=function(a,b){var c=this._cachedCells,d=c[a];d||(d=c[a]={});var e=d[b];return e||(e={data:this._sheet.getValue(a,b)},d[b]=e),e},a.prototype.addRow=function(a,b){this._cachedRows[a]=b},a.prototype.getCachedRow=function(a){var b=this._cachedRows,c=b[a];return c||(c={height:this._sheet._getZoomRowHeight(a)},b[a]=c),c},a.prototype.addColumn=function(a,b){this._cachedColumns[a]=b},a.prototype.getCachedColumn=function(a){var b=this._cachedColumns,c=b[a];return c||(c={width:this._sheet._getZoomColumnWidth(a)},b[a]=c),c},a.prototype.clearAll=function(){var a=this;a._cachedCells={},a._cachedColumns={},a._cachedRows={}},a}();b._CachePool=G,function(a){a[a.normal=0]="normal",a[a.arrayFormula=1]="arrayFormula",a[a.sharedFormula=2]="sharedFormula"}(b.EndEditType||(b.EndEditType={}));var H=(b.EndEditType,function(){function a(){}return a}());b.FormulaInformation=H}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("core.imageLoader",["core.common"]);var b=function(){function a(a){this._imageCount=0,this._loadedCount=0,this.onLoadedComplete=a}return a.prototype.addImage=function(a){var b=this,c=b._imgs;c||(c=b._imgs={});var d=c[a];if(!d){d={};var e=$("<img/>");e.bind("load",function(){b.imageLoaded(a)}),e.bind("error",function(){b.imageLoaded(a)}),e.bind("abort",function(){b.imageLoaded(a)}),b._imageCount++,d.state=!1,d.img=e,c[a]=d,e[0].src=a}},a.prototype.getImage=function(a){return this._imgs[a].img[0]},a.prototype.getState=function(a){var b=this._imgs,c=b&&b[a];return c?c.state:!1},a.prototype.imageLoaded=function(a){var b=this;b._loadedCount++,b._imgs[a].state=!0,b._loadedCount>=b._imageCount&&b.onLoadedComplete&&b.onLoadedComplete()},a}();a._GcImageLoader=b}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){function c(a){return a.split(" ").join(" ").toUpperCase()}function d(a){for(var b=[],d=0,e=a.length;e>d;d++)b[d]=c(a[d]);return b}function e(a,b,d){var e=c(a),f=new r(b).indexOf(e);return-1===f&&(f=new r(d).indexOf(e)),f}function f(c){if(0===arguments.length)return b._currentCulture;if(c){var d=c.toLowerCase();if(b._currentCulture!==d){switch(d){case"ja-jp":a.spread.SR=a.spread._JPStringResource,y.currentCulture("ja-jp");break;case"en-us":default:a.spread.SR=a.spread._ENStringResource,y.currentCulture("en-us")}b._currentCulture=c,g(c)}}}function g(a){$("div[gcUIElement='gcSpread']").trigger(b.Events.CultureChanged,[{CultureInfo:a}])}b.feature("core.globalize",["core.stringResource","core.migrate"]);var h=null,i=void 0,j=Math.max,k=Math.min,l=Math.ceil,m=Math.floor,n=Math.abs,o=Math.pow,p=Math.round,q="undefined",r=function(){function a(a){this._array=a}return a.__insert=function(a,b,c){a.splice(b,0,c)},a.__add=function(a,b){a[a.length]=b},a.__indexOf=function(a,b,c){if(typeof b===q)return-1;var d=a.length;if(0!==d){c-=0,isNaN(c)?c=0:(isFinite(c)&&(c-=c%1),0>c&&(c=j(0,d+c)));for(var e=c;d>e;e++)if(typeof a[e]!==q&&a[e]===b)return e}return-1},a.prototype.add=function(b){a.__add(this._array,b)},a.prototype.insert=function(b,c){a.__insert(this._array,b,c)},a.prototype.indexOf=function(b,c){return a.__indexOf(this._array,b,c)},a.prototype.array=function(a){return 0===arguments.length?this._array:(this._array=a,this._array)},a}();b._ArrayHelper=r;var s=function(){function a(a){this._value={},this._len=0,this._init(a)}return a.prototype._init=function(a){this._parts=typeof a!==q&&a!==h&&""!==a?[a.toString()]:[],this._value={},this._len=0},a.prototype._insert=function(a){this._parts.splice(0,0,a)},a.prototype.insert=function(a,b){var c=this;if((b===i||b===h)&&(b=0),0===b)return void c._insert(a);var d=c.toString();if(b>=d.length)return void c.append(a);var e=d.substring(0,b),f=d.substr(b);c._init(e+a+f)},a.prototype.append=function(a){this._parts[this._parts.length]=a},a.prototype.appendLine=function(a){this._parts[this._parts.length]=typeof a===q||a===h||""===a?"\r\n":a+"\r\n"},a.prototype.clear=function(){this._init()},a.prototype.isEmpty=function(){return 0===this._parts.length?!0:""===this.toString()},a.prototype.toString=function(a){var b=this;a=a||"";var c=b._parts;b._len!==c.length&&(b._value={},b._len=c.length);var d=b._value;if(typeof d[a]===q){if(""!==a)for(var e=0;e<c.length;)typeof c[e]===q||""===c[e]||c[e]===h?c.splice(e,1):e++;d[a]=b._parts.join(a)}return d[a]},a}();b._StringBuilder=s;var t=function(){function a(a){this.strValue="",a&&(this.strValue=a)}return a.prototype.Append=function(a){a&&(this.strValue+=a.toString())},a.prototype.toString=function(){return this.strValue.toString()},a.prototype.Length=function(){return this.strValue.length},a.prototype.ToString=function(a,b){var c=this.toString();if(0===arguments.length)return c;var d=c.substr(a,b);return d},a.prototype.Remove=function(a,b){var c=this.toString();this.strValue=A.Remove(c,a,b)},a}();b.StringBuilder=t;var u=function(){function a(a){var b=this;b.CurrencyDecimalDigits=2,b.CurrencyDecimalSeparator=".",b.CurrencyPositivePattern=0,b.CurrencyGroupSeparator=",",b.CurrencySymbol="¤",b.CurrencyGroupSizes=[3],b.CurrencyNegativePattern=0,b.DigitSubstitution=1,b.IsReadOnly=!0,b.NumberGroupSizes=[3],b.NaNSymbol="NaN",b.NativeDigits=["0","1","2","3","4","5","6","7","8","9"],b.NumberNegativePattern=1,b.NegativeInfinitySymbol="-Infinity",b.NegativeSign="-",b.NumberDecimalDigits=2,b.NumberDecimalSeparator=".",b.NumberGroupSeparator=",",b.PositiveInfinitySymbol="Infinity",b.PositiveSign="+",b.PercentDecimalDigits=2,b.PercentDecimalSeparator=".",b.PercentGroupSeparator=",",b.PercentSymbol="%",b.PerMilleSymbol="‰",b.PercentPositivePattern=0,b.PercentNegativePattern=0,b.PercentGroupSizes=[3],a&&a.length>0&&(b.IsReadOnly=!1,b.CurrencySymbol="$")}return a}();b._NumberFormatInfo=u;var v=function(){function a(){var a=this;a.MinSupportedDateTime="@-62135568000000@",a.MaxSupportedDateTime="@253402300799999@",a.AlgorithmType=1,a.CalendarType=1,a.Eras=[1],a.TwoDigitYearMax=2029,a.IsReadOnly=!0}return a}();b._Calendar=v;var w=function(){function a(a){var b=this;b.AMDesignator="AM",b.AbbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],b.AbbreviatedDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],b.AbbreviatedMonthGenitiveNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],b.Calendar=new v,b.CalendarWeekRule=0,b.DateSeparator="/",b.DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b.FirstDayOfWeek=0,b.FullDateTimePattern="dddd, dd MMMM yyyy HH:mm:ss",b.IsReadOnly=!0,b.LongDatePattern="dddd, dd MMMM yyyy",b.LongTimePattern="HH:mm:ss",b.MonthDayPattern="MMMM dd",b.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December",""],b.MonthGenitiveNames=["January","February","March","April","May","June","July","August","September","October","November","December",""],b.NativeCalendarName="Gregorian Calendar",b.PMDesignator="PM",b.RFC1123Pattern="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",b.ShortDatePattern="MM/dd/yyyy",b.ShortTimePattern="HH:mm",b.SortableDateTimePattern="yyyy'-'MM'-'dd'T'HH':'mm':'ss",b.ShortestDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],b.TimeSeparator=":",b.UniversalSortableDateTimePattern="yyyy'-'MM'-'dd HH':'mm':'ss'Z'",b.YearMonthPattern="yyyy MMMM",a&&a.length>0&&(b.Calendar.IsReadOnly=!1,b.FullDateTimePattern="dddd, MMMM dd, yyyy h:mm:ss tt",b.LongDatePattern="dddd, MMMM dd, yyyy",b.LongTimePattern="h:mm:ss tt",b.ShortDatePattern="M/d/yyyy",b.ShortTimePattern="h:mm tt",b.YearMonthPattern="MMMM, yyyy",b.IsReadOnly=!1)}return a}();b._DateTimeFormatInfo=w;var x=function(){function a(){}return a.isValidEraDate=function(a){return a<this.getEraMin()||a>this.getEraMax()?!1:!0},a.getEraDates=function(){var a=window.spreadJSEras;if(a!=i){for(var b=new Array,c=0;c<a.length;c++){var d=new Date(a[c].startDate.replace(/-/g,"/"));b[c]=d}return b}return this.EraDates},a.getEraNames=function(){var a=window.spreadJSEras,b=new Array;if(a!=i){for(var c=0;c<a.length;c++)b[c]=a[c].name;return b}for(var c=0;c<this.EraCount;c++)b[c]=this.EraNames[c+2*this.EraCount];return b},a.getEraSymbols=function(){var a=window.spreadJSEras,b=new Array;if(a!=i){for(var c=0;c<a.length;c++)b[c]=a[c].symbol;return b}for(var c=0;c<this.EraCount;c++)b[c]=this.EraNames[c];return b},a.getEraAbbreviations=function(){var a=window.spreadJSEras,b=new Array;if(a!=i){for(var c=0;c<a.length;c++)b[c]=a[c].abbreviation;return b}for(var c=0;c<this.EraCount;c++)b[c]=this.EraNames[c+this.EraCount];return b},a.getEraShortcuts=function(){var a=window.spreadJSEras,b=new Array;if(a!=i){for(var c=0;c<a.length;c++)b[c]=a[c].shortcuts.split(",")[0];return b}for(var c=0;c<this.EraCount;c++)b[c]=this.EraKeys[c];return b},a.getEraMax=function(){var a=window.spreadJSEras;if(a!=i&&a.length>0){var b=new Date(a[a.length-1].startDate.replace(/-/g,"/"));return b.setFullYear(b.getFullYear()+99),b}return this.EraMax},a.getEraMin=function(){var a=window.spreadJSEras;if(a!=i&&a.length>0){var b=new Date(a[0].startDate.replace(/-/g,"/"));return b}return this.EraMin},a.getEraCount=function(){var a=window.spreadJSEras;return a!=i?a.length:this.EraCount},a.getEraYears=function(){var a=window.spreadJSEras;if(a!=i){for(var b=new Array,c=1;c<a.length;c++){var d=new Date(a[c-1].startDate.replace(/-/g,"/")),e=new Date(a[c].startDate.replace(/-/g,"/"));b[c-1]=e.getFullYear()-d.getFullYear()+1}return b[c-1]=99,b}return this.EraYears},a.getEraDate=function(a){var b=new Object;b.era=-1,b.eraYear=-1;var c=this;if(!c.isValidEraDate(a))return b;for(var d=0;d<c.getEraCount();d++){var e=d+1!=c.getEraCount()?c.getEraDates()[d+1]:c.addMilliseconds(c.getEraMax(),1);if(e>a){b.era=d,b.eraYear=a.getFullYear()-c.getEraDates()[d].getFullYear()+1;break}}return b},a.addMilliseconds=function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());return c.setMilliseconds(c.getMilliseconds()+b),new Date(c.valueOf())},a.getYearFromEra=function(b,c){var d=a.getEraDates()[b].getFullYear(),e=d+c-1;return e},a.parseEraPart=function(b,c){c=c.toUpperCase();var d=a;switch(b){case"g":for(var e=d.getEraSymbols(),f=0;f<e.length;f++)if(e[f]===c)return f;break;case"gg":for(var g=d.getEraAbbreviations(),f=0;f<g.length;f++)if(g[f]===c)return f;break;case"ggg":for(var h=d.getEraNames(),f=0;f<h.length;f++)if(h[f]===c)return f}return-1},a.formatEraPart=function(b,c,d){var e=a,f=e.getEraDate(c);switch(b){case"g":if(f.era<0)break;var g=e.getEraSymbols()[f.era];d.append(g);break;case"gg":if(f.era<0)break;var g=e.getEraAbbreviations()[f.era];d.append(g);break;case"ggg":if(f.era<0)break;var g=e.getEraNames()[f.era];d.append(g);break;case"ee":if(f.eraYear<0)break;var h=f.eraYear.toString();1===h.length&&(h="0"+h),d.append(h);break;case"e":if(f.eraYear<0)break;var h=f.eraYear.toString();d.append(h)}},a.EraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),a.EraCount=4,a.EraYears=new Array(45,15,64,99),a.EraMax=new Date(2087,11,31,23,59,59),a.EraMin=new Date(1868,8,8),a.EraKeys=new Array("1","2","3","4","m","t","s","h"),a.EraIndices=new Array(0,1,2,3,0,1,2,3),a.EraNames=new Array("M","T","S","H","明","大","昭","平","明治","大正","昭和","平成"),a.EraYearMax=99,a}();b._EraHelper=x;var y=function(){function a(a,b,c){this.name=a,this.numberFormat=b,this.dateTimeFormat=c}return a.prototype.Name=function(){return this.name},a.prototype.NumberFormat=function(){return this.numberFormat},a.prototype.DateTimeFormat=function(){return this.dateTimeFormat},a.prototype._getDateTimeFormats=function(){return this._dateTimeFormats||(this._dateTimeFormats=["yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d","MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","yy/MM/dd hh:mm:ss","yy/MM/dd hh:mm:s","yy/MM/dd hh:m:ss","yy/MM/dd hh:m:s","yy/MM/dd h:mm:ss","yy/MM/dd h:mm:s","yy/MM/dd h:m:ss","yy/MM/dd h:m:s","yy/MM/dd hh:mm:ss tt","yy/MM/dd hh:mm:s tt","yy/MM/dd hh:m:ss tt","yy/MM/dd hh:m:s tt","yy/MM/dd h:mm:ss tt","yy/MM/dd h:mm:s tt","yy/MM/dd h:m:ss tt","yy/MM/dd h:m:s tt","yy/MM/d hh:mm:ss","yy/MM/d hh:mm:s","yy/MM/d hh:m:ss","yy/MM/d hh:m:s","yy/MM/d hh:mm:ss","yy/MM/d h:mm:s","yy/MM/d h:m:ss","yy/MM/d h:m:s","yy/MM/d hh:mm:ss tt","yy/MM/d hh:mm:s tt","yy/MM/d hh:m:ss tt","yy/MM/d hh:m:s tt","yy/MM/d h:mm:ss tt","yy/MM/d h:mm:s tt","yy/MM/d h:m:ss tt","yy/MM/d h:m:s tt","yy/M/dd hh:mm:ss","yy/M/dd hh:mm:s","yy/M/dd hh:m:ss","yy/M/dd hh:m:s","yy/M/dd hh:mm:ss","yy/M/dd h:mm:s","yy/M/dd h:m:ss","yy/M/dd h:m:s","yy/M/dd hh:mm:ss tt","yy/M/dd hh:mm:s tt","yy/M/dd hh:m:ss tt","yy/M/dd hh:m:s tt","yy/M/dd h:mm:ss tt","yy/M/dd h:mm:s tt","yy/M/dd h:m:ss tt","yy/M/dd h:m:s tt","yy/M/d hh:mm:ss","yy/M/d hh:mm:s","yy/M/d hh:m:ss","yy/M/d hh:m:s","yy/M/d hh:mm:ss","yy/M/d h:mm:s","yy/M/d h:m:ss","yy/M/d h:m:s","yy/M/d hh:mm:ss tt","yy/M/d hh:mm:s tt","yy/M/d hh:m:ss tt","yy/M/d hh:m:s tt","yy/M/d h:mm:ss tt","yy/M/d h:mm:s tt","yy/M/d h:m:ss tt","yy/M/d h:m:s tt","yyyy/MM/dd hh:mm:ss","yyyy/MM/dd hh:mm:s","yyyy/MM/dd hh:m:ss","yyyy/MM/dd hh:m:s","yyyy/MM/dd hh:mm:ss","yyyy/MM/dd h:mm:s","yyyy/MM/dd h:m:ss","yyyy/MM/dd h:m:s","yyyy/MM/dd hh:mm:ss tt","yyyy/MM/dd hh:mm:s tt","yyyy/MM/dd hh:m:ss tt","yyyy/MM/dd hh:m:s tt","yyyy/MM/dd h:mm:ss tt","yyyy/MM/dd h:mm:s tt","yyyy/MM/dd h:m:ss tt","yyyy/MM/dd h:m:s tt","yyyy/MM/d hh:mm:ss","yyyy/MM/d hh:mm:s","yyyy/MM/d hh:m:ss","yyyy/MM/d hh:m:s","yyyy/MM/d hh:mm:ss","yyyy/MM/d h:mm:s","yyyy/MM/d h:m:ss","yyyy/MM/d h:m:s","yyyy/MM/d hh:mm:ss tt","yyyy/MM/d hh:mm:s tt","yyyy/MM/d hh:m:ss tt","yyyy/MM/d hh:m:s tt","yyyy/MM/d h:mm:ss tt","yyyy/MM/d h:mm:s tt","yyyy/MM/d h:m:ss tt","yyyy/MM/d h:m:s tt","yyyy/M/dd hh:mm:ss","yyyy/M/dd hh:mm:s","yyyy/M/dd hh:m:ss","yyyy/M/dd hh:m:s","yyyy/M/dd hh:mm:ss","yyyy/M/dd h:mm:s","yyyy/M/dd h:m:ss","yyyy/M/dd h:m:s","yyyy/M/dd hh:mm:ss tt","yyyy/M/dd hh:mm:s tt","yyyy/M/dd hh:m:ss tt","yyyy/M/dd hh:m:s tt","yyyy/M/dd h:mm:ss tt","yyyy/M/dd h:mm:s tt","yyyy/M/dd h:m:ss tt","yyyy/M/dd h:m:s tt","yyyy/M/d hh:mm:ss","yyyy/M/d hh:mm:s","yyyy/M/d hh:m:ss","yyyy/M/d hh:m:s","yyyy/M/d hh:mm:ss","yyyy/M/d h:mm:s","yyyy/M/d h:m:ss","yyyy/M/d h:m:s","yyyy/M/d hh:mm:ss tt","yyyy/M/d hh:mm:s tt","yyyy/M/d hh:m:ss tt","yyyy/M/d hh:m:s tt","yyyy/M/d h:mm:ss tt","yyyy/M/d h:mm:s tt","yyyy/M/d h:m:ss tt","yyyy/M/d h:m:s tt","MM/dd/yyyy hh:mm:ss","MM/dd/yyyy hh:mm:s","MM/dd/yyyy hh:m:ss","MM/dd/yyyy hh:m:s","MM/dd/yyyy hh:mm:ss","MM/dd/yyyy h:mm:s","MM/dd/yyyy h:m:ss","MM/dd/yyyy h:m:s","MM/dd/yyyy hh:mm:ss tt","MM/dd/yyyy hh:mm:s tt","MM/dd/yyyy hh:m:ss tt","MM/dd/yyyy hh:m:s tt","MM/dd/yyyy h:mm:ss tt","MM/dd/yyyy h:mm:s tt","MM/dd/yyyy h:m:ss tt","MM/dd/yyyy h:m:s tt","MM/d/yyyy hh:mm:ss","MM/d/yyyy hh:mm:s","MM/d/yyyy hh:m:ss","MM/d/yyyy hh:m:s","MM/d/yyyy hh:mm:ss","MM/d/yyyy h:mm:s","MM/d/yyyy h:m:ss","MM/d/yyyy h:m:s","MM/d/yyyy hh:mm:ss tt","MM/d/yyyy hh:mm:s tt","MM/d/yyyy hh:m:ss tt","MM/d/yyyy hh:m:s tt","MM/d/yyyy h:mm:ss tt","MM/d/yyyy h:mm:s tt","MM/d/yyyy h:m:ss tt","MM/d/yyyy h:m:s tt","M/dd/yyyy hh:mm:ss","M/dd/yyyy hh:mm:s","M/dd/yyyy hh:m:ss","M/dd/yyyy hh:m:s","M/dd/yyyy hh:mm:ss","M/dd/yyyy h:mm:s","M/dd/yyyy h:m:ss","M/dd/yyyy h:m:s","M/dd/yyyy hh:mm:ss tt","M/dd/yyyy hh:mm:s tt","M/dd/yyyy hh:m:ss tt","M/dd/yyyy hh:m:s tt","M/dd/yyyy h:mm:ss tt","M/dd/yyyy h:mm:s tt","M/dd/yyyy h:m:ss tt","M/dd/yyyy h:m:s tt","M/d/yyyy hh:mm:ss","M/d/yyyy hh:mm:s","M/d/yyyy hh:m:ss","M/d/yyyy hh:m:s","M/d/yyyy hh:mm:ss","M/d/yyyy h:mm:s","M/d/yyyy h:m:ss","M/d/yyyy h:m:s","M/d/yyyy hh:mm:ss tt","M/d/yyyy hh:mm:s tt","M/d/yyyy hh:m:ss tt","M/d/yyyy hh:m:s tt","M/d/yyyy h:mm:ss tt","M/d/yyyy h:mm:s tt","M/d/yyyy h:m:ss tt","M/d/yyyy h:m:s tt","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd hh:mm:ss","yy-MM-dd hh:mm:s","yy-MM-dd hh:m:ss","yy-MM-dd hh:m:s","yy-MM-dd h:mm:ss","yy-MM-dd h:mm:s","yy-MM-dd h:m:ss","yy-MM-dd h:m:s","yy-MM-dd hh:mm:ss tt","yy-MM-dd hh:mm:s tt","yy-MM-dd hh:m:ss tt","yy-MM-dd hh:m:s tt","yy-MM-dd h:mm:ss tt","yy-MM-dd h:mm:s tt","yy-MM-dd h:m:ss tt","yy-MM-dd h:m:s tt","yy-MM-d hh:mm:ss","yy-MM-d hh:mm:s","yy-MM-d hh:m:ss","yy-MM-d hh:m:s","yy-MM-d hh:mm:ss","yy-MM-d h:mm:s","yy-MM-d h:m:ss","yy-MM-d h:m:s","yy-MM-d hh:mm:ss tt","yy-MM-d hh:mm:s tt","yy-MM-d hh:m:ss tt","yy-MM-d hh:m:s tt","yy-MM-d h:mm:ss tt","yy-MM-d h:mm:s tt","yy-MM-d h:m:ss tt","yy-MM-d h:m:s tt","yy-M-dd hh:mm:ss","yy-M-dd hh:mm:s","yy-M-dd hh:m:ss","yy-M-dd hh:m:s","yy-M-dd hh:mm:ss","yy-M-dd h:mm:s","yy-M-dd h:m:ss","yy-M-dd h:m:s","yy-M-dd hh:mm:ss tt","yy-M-dd hh:mm:s tt","yy-M-dd hh:m:ss tt","yy-M-dd hh:m:s tt","yy-M-dd h:mm:ss tt","yy-M-dd h:mm:s tt","yy-M-dd h:m:ss tt","yy-M-dd h:m:s tt","yy-M-d hh:mm:ss","yy-M-d hh:mm:s","yy-M-d hh:m:ss","yy-M-d hh:m:s","yy-M-d hh:mm:ss","yy-M-d h:mm:s","yy-M-d h:m:ss","yy-M-d h:m:s","yy-M-d hh:mm:ss tt","yy-M-d hh:mm:s tt","yy-M-d hh:m:ss tt","yy-M-d hh:m:s tt","yy-M-d h:mm:ss tt","yy-M-d h:mm:s tt","yy-M-d h:m:ss tt","yy-M-d h:m:s tt","yyyy-MM-dd hh:mm:ss","yyyy-MM-dd hh:mm:s","yyyy-MM-dd hh:m:ss","yyyy-MM-dd hh:m:s","yyyy-MM-dd hh:mm:ss","yyyy-MM-dd h:mm:s","yyyy-MM-dd h:m:ss","yyyy-MM-dd h:m:s","yyyy-MM-dd hh:mm:ss tt","yyyy-MM-dd hh:mm:s tt","yyyy-MM-dd hh:m:ss tt","yyyy-MM-dd hh:m:s tt","yyyy-MM-dd h:mm:ss tt","yyyy-MM-dd h:mm:s tt","yyyy-MM-dd h:m:ss tt","yyyy-MM-dd h:m:s tt","yyyy-MM-d hh:mm:ss","yyyy-MM-d hh:mm:s","yyyy-MM-d hh:m:ss","yyyy-MM-d hh:m:s","yyyy-MM-d hh:mm:ss","yyyy-MM-d h:mm:s","yyyy-MM-d h:m:ss","yyyy-MM-d h:m:s","yyyy-MM-d hh:mm:ss tt","yyyy-MM-d hh:mm:s tt","yyyy-MM-d hh:m:ss tt","yyyy-MM-d hh:m:s tt","yyyy-MM-d h:mm:ss tt","yyyy-MM-d h:mm:s tt","yyyy-MM-d h:m:ss tt","yyyy-MM-d h:m:s tt","yyyy-M-dd hh:mm:ss","yyyy-M-dd hh:mm:s","yyyy-M-dd hh:m:ss","yyyy-M-dd hh:m:s","yyyy-M-dd hh:mm:ss","yyyy-M-dd h:mm:s","yyyy-M-dd h:m:ss","yyyy-M-dd h:m:s","yyyy-M-dd hh:mm:ss tt","yyyy-M-dd hh:mm:s tt","yyyy-M-dd hh:m:ss tt","yyyy-M-dd hh:m:s tt","yyyy-M-dd h:mm:ss tt","yyyy-M-dd h:mm:s tt","yyyy-M-dd h:m:ss tt","yyyy-M-dd h:m:s tt","yyyy-M-d hh:mm:ss","yyyy-M-d hh:mm:s","yyyy-M-d hh:m:ss","yyyy-M-d hh:m:s","yyyy-M-d hh:mm:ss","yyyy-M-d h:mm:s","yyyy-M-d h:m:ss","yyyy-M-d h:m:s","yyyy-M-d hh:mm:ss tt","yyyy-M-d hh:mm:s tt","yyyy-M-d hh:m:ss tt","yyyy-M-d hh:m:s tt","yyyy-M-d h:mm:ss tt","yyyy-M-d h:mm:s tt","yyyy-M-d h:m:ss tt","yyyy-M-d h:m:s tt","MM-dd-yyyy hh:mm:ss","MM-dd-yyyy hh:mm:s","MM-dd-yyyy hh:m:ss","MM-dd-yyyy hh:m:s","MM-dd-yyyy hh:mm:ss","MM-dd-yyyy h:mm:s","MM-dd-yyyy h:m:ss","MM-dd-yyyy h:m:s","MM-dd-yyyy hh:mm:ss tt","MM-dd-yyyy hh:mm:s tt","MM-dd-yyyy hh:m:ss tt","MM-dd-yyyy hh:m:s tt","MM-dd-yyyy h:mm:ss tt","MM-dd-yyyy h:mm:s tt","MM-dd-yyyy h:m:ss tt","MM-dd-yyyy h:m:s tt","MM-d-yyyy hh:mm:ss","MM-d-yyyy hh:mm:s","MM-d-yyyy hh:m:ss","MM-d-yyyy hh:m:s","MM-d-yyyy hh:mm:ss","MM-d-yyyy h:mm:s","MM-d-yyyy h:m:ss","MM-d-yyyy h:m:s","MM-d-yyyy hh:mm:ss tt","MM-d-yyyy hh:mm:s tt","MM-d-yyyy hh:m:ss tt","MM-d-yyyy hh:m:s tt","MM-d-yyyy h:mm:ss tt","MM-d-yyyy h:mm:s tt","MM-d-yyyy h:m:ss tt","MM-d-yyyy h:m:s tt","M-dd-yyyy hh:mm:ss","M-dd-yyyy hh:mm:s","M-dd-yyyy hh:m:ss","M-dd-yyyy hh:m:s","M-dd-yyyy hh:mm:ss","M-dd-yyyy h:mm:s","M-dd-yyyy h:m:ss","M-dd-yyyy h:m:s","M-dd-yyyy hh:mm:ss tt","M-dd-yyyy hh:mm:s tt","M-dd-yyyy hh:m:ss tt","M-dd-yyyy hh:m:s tt","M-dd-yyyy h:mm:ss tt","M-dd-yyyy h:mm:s tt","M-dd-yyyy h:m:ss tt","M-dd-yyyy h:m:s tt","M-d-yyyy hh:mm:ss","M-d-yyyy hh:mm:s","M-d-yyyy hh:m:ss","M-d-yyyy hh:m:s","M-d-yyyy hh:mm:ss","M-d-yyyy h:mm:s","M-d-yyyy h:m:ss","M-d-yyyy h:m:s","M-d-yyyy hh:mm:ss tt","M-d-yyyy hh:mm:s tt","M-d-yyyy hh:m:ss tt","M-d-yyyy hh:m:s tt","M-d-yyyy h:mm:ss tt","M-d-yyyy h:mm:s tt","M-d-yyyy h:m:ss tt","M-d-yyyy h:m:s tt"]),this._dateTimeFormats
},a.prototype._getMonthIndex=function(a){var b=this;return b._upperMonths||(b._upperMonths=d(b.dateTimeFormat.MonthNames),b._upperMonthsGenitive=d(b.dateTimeFormat.MonthGenitiveNames)),e(a,b._upperMonths,b._upperMonthsGenitive)},a.prototype._getAbbrMonthIndex=function(a){var b=this;return b._upperAbbrMonths||(b._upperAbbrMonths=d(b.dateTimeFormat.AbbreviatedMonthNames),b._upperAbbrMonthsGenitive=d(b.dateTimeFormat.AbbreviatedMonthGenitiveNames)),e(a,b._upperAbbrMonths,b._upperAbbrMonthsGenitive)},a.prototype._getDayIndex=function(a){var b=this;return b._upperDays||(b._upperDays=d(b.dateTimeFormat.DayNames)),new r(b._upperDays).indexOf(c(a))},a.prototype._getAbbrDayIndex=function(a){var b=this;return b._upperAbbrDays||(b._upperAbbrDays=d(b.dateTimeFormat.AbbreviatedDayNames)),new r(b._upperAbbrDays).indexOf(c(a))},a._parseCulture=function(b){var c=b.dateTimeFormat;return new a(b.name,b.numberFormat,c)},a.prototype._parse=function(b){return a._parseCulture(b)},a.invariantCulture=function(){var b=a;return b._invariantCulture||(b._invariantCulture=new a("",new u(""),new w(""))),b._invariantCulture},a.currentCulture=function(b){var c=a;return 0===arguments.length?c._currentCulture||(c._currentCulture=c.invariantCulture()):c._currentCulture=c.getCulture(b),c._currentCulture},a.enCulture=function(){var b=a;return b._enCulture||(b._enCulture=new a("en-US",new u("en-US"),new w("en-US"))),b._enCulture},a.japanCulture=function(){var b=a;if(!b._japanCulture){var c=new a("ja-JP",new u("ja-JP"),new w("ja-JP"));c.numberFormat.CurrencyDecimalDigits=0,c.numberFormat.CurrencySymbol="￥",c.numberFormat.PercentPositivePattern=1,c.numberFormat.PercentNegativePattern=1,c.dateTimeFormat.AbbreviatedDayNames=["日","月","火","水","木","金","土"],c.dateTimeFormat.AbbreviatedMonthNames=["1","2","3","4","5","6","7","8","9","10","11","12",""],c.dateTimeFormat.AbbreviatedMonthGenitiveNames=["1","2","3","4","5","6","7","8","9","10","11","12",""],c.dateTimeFormat.AMDesignator="午前",c.dateTimeFormat.DayNames=["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],c.dateTimeFormat.FullDateTimePattern="yyyy'年'M'月'd'日' H:mm:ss",c.dateTimeFormat.LongDatePattern="yyyy'年'M'月'd'日'",c.dateTimeFormat.LongTimePattern="H:mm:ss",c.dateTimeFormat.MonthDayPattern="M'月'd'日'",c.dateTimeFormat.MonthGenitiveNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],c.dateTimeFormat.MonthNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],c.dateTimeFormat.NativeCalendarName="西暦 (日本語)",c.dateTimeFormat.PMDesignator="午後",c.dateTimeFormat.ShortDatePattern="yyyy/MM/dd",c.dateTimeFormat.ShortTimePattern="H:mm",c.dateTimeFormat.ShortestDayNames=["日","月","火","水","木","金","土"],c.dateTimeFormat.YearMonthPattern="yyyy'年'M'月'",c.dateTimeFormat.eras=x;var d=c._getDateTimeFormats().slice(0);d.push(""),b._japanCulture=c}return b._japanCulture},a.getCulture=function(b){switch(b=b.toLowerCase()){case"ja-jp":return a.japanCulture();case"en-us":return a.enCulture();default:return a.invariantCulture()}},a}();b._CultureInfo=y;var z=function(){function a(a){this._str=a}return a.__toFormattedString=function(a,c){for(var d="",e=c[0],f=0;;){var g=e.indexOf("{",f),i=e.indexOf("}",f);if(0>g&&0>i){d+=e.slice(f);break}if(i>0&&(g>i||0>g)){if("}"!==e.charAt(i+1))throw new Error(b.SR.Exp_BraceMismatch);d+=e.slice(f,i+1),f=i+2}else if(d+=e.slice(f,g),f=g+1,"{"!==e.charAt(f)){if(0>i)throw new Error(b.SR.Exp_BraceMismatch);var j=e.substring(f,i),k=j.indexOf(":"),l=parseInt(0>k?j:j.substring(0,k),10)+1;if(isNaN(l))throw new Error(b.SR.Exp_InvalidFormat);var m=0>k?"":j.substring(k+1),n=c[l];(typeof n===q||n===h)&&(n=""),d+=n.toFormattedString?n.toFormattedString(m):a&&n.localeFormat?n.localeFormat(m):n.format?n.format(m):n.toString(),f=i+1}else d+="{",f++}return d},a.prototype.startsWith=function(a){return this._str.substr(0,a.length)===a},a.prototype.endsWith=function(a){return-1!==this._str.indexOf(a,this._str.length-a.length)},a.prototype.trim=function(){return this._str.replace(/^\s+|\s+$/g,"")},a.prototype.trimEnd=function(){return this._str.replace(/\s+$/,"")},a.prototype.trimStart=function(){return this._str.replace(/^\s+/,"")},a.prototype.format=function(b,c){var d=[];d.push(b);for(var e=0;e<c.length;e++)d.push(c[e]);return a.__toFormattedString(!1,d)},a}();b._StringHelper=z;var A=function(){function a(){}return a.Contains=function(a,b){return""===b||a.indexOf(b)>=0},a.IndexOf=function(a,b,c){if(c){if(1===c){var d=a.toLowerCase(),e=b.toLowerCase();return d.indexOf(e)}return a.indexOf(b)}return a.indexOf(b)},a.TrimStart=function(a,b){if(!b)return a;for(var c=a;;){if(c.substr(0,b.length)!==b)break;c=c.substr(b.length)}return c},a.TrimEnd=function(a,b){if(!b)return a;for(var c=a;;){if(c.substr(c.length-b.length,b.length)!==b)break;c=c.substr(0,c.length-b.length)}return c},a.Trim=function(b,c){var d=c;return c||(d=" "),b=a.TrimStart(b,d),b=a.TrimEnd(b,d)},a.Insert=function(a,b,c){if(0>b||b>a.length||c===h||c===i)throw new Error;var d=a.substr(0,b),e=a.substr(b,a.length-b);return d+c+e},a.Remove=function(a,b,c){if((c===i||c===h)&&(c=a.length-b),0>b||0>c||b+c>a.length)throw new Error;var d=a.substr(0,b),e=a.substr(b+c,a.length-b-c);return d+e},a.StartsWith=function(a,b,c){if(!b)throw new Error;if(""===b)return!0;if(b.length>a.length)return!1;var d=a,e=b;return 1===c&&(d=d.toLowerCase(),e=e.toLowerCase()),d.search(new RegExp("^"+e))>-1},a.EndsWith=function(a,b,c){if(!b)throw new Error;if(""===b)return!0;if(b.length>a.length)return!1;var d=a,e=b;return 1===c&&(d=d.toLowerCase(),e=e.toLowerCase()),d.search(new RegExp(e+"$"))>-1},a.Replace=function(a,b,c){if(!b||""===b)throw new Error;var d=new RegExp(b,"g");return a.replace(d,c)},a}();b.StringHelper=A;var B=function(){function a(a){this._date=a}return a.prototype.Hour=function(){return this._date.getHours()},a.prototype.Minute=function(){return this._date.getMinutes()},a.prototype.Second=function(){return this._date.getSeconds()},a.prototype.Millisecond=function(){return this._date.getMilliseconds()},a.prototype.TotalDays=function(){return m(this.toOADate())},a.prototype.toOADate=function(){return a.___toOADate(this._date)},a.prototype.format=function(a){return this._toFormattedString(a,y.currentCulture())},a.prototype.customCultureFormat=function(a,b){return b||(b=y.currentCulture()),this._toFormattedString(a,b)},a.prototype.localeFormat=function(a){return this._toFormattedString(a,y.currentCulture())},a.prototype._toFormattedString=function(c,d){function e(){return o||p?o:(o=t.test(c),p=!0,o)}function f(a,b){if(q)return q[b];switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate()}}var g=this,h=d.DateTimeFormat(),i=h.Calendar.convert;if(!c||!c.length||"i"===c)return d&&d.Name().length?i?g._toFormattedString(h.FullDateTimePattern,d):g._date.toLocaleString():g._date.toString();var j=h.eras,k="s"===c;c=a.__expandFormat(h,c);var l,o,p,q,r=new s,t=/([^d]|^)(d|dd)([^d]|$)/g,u=0,v=a.__getTokenRegExp();!k&&i&&(q=i.fromGregorian(g._date));for(var w=-2,x=-2,y=0;;y++){var z=v.lastIndex,A=v.exec(c),B=c.slice(z,A?A.index:c.length);if(u+=a.__appendPreOrPostMatch(B,r),!A)break;if(u%2!==1)switch(A[0]){case"dddd":r.append(h.DayNames[g._date.getDay()]);break;case"ddd":r.append(h.AbbreviatedDayNames[g._date.getDay()]);break;case"dd":o=!0,r.append(a.___addLeadingZero(f(g._date,2)));break;case"d":o=!0,r.append(f(g._date,2));break;case"MMMM":r.append(h.MonthGenitiveNames&&e()?h.MonthGenitiveNames[f(g._date,1)]:h.MonthNames[f(g._date,1)]);break;case"MMM":r.append(h.AbbreviatedMonthGenitiveNames&&e()?h.AbbreviatedMonthGenitiveNames[f(g._date,1)]:h.AbbreviatedMonthNames[f(g._date,1)]);break;case"MM":r.append(a.___addLeadingZero(f(g._date,1)+1));break;case"M":r.append(f(g._date,1)+1);break;case"yyyy":case"yyy":w>=0?j.formatEraPart("ee",g._date,r):r.append(a.___padYear(q?q[0]:g._date.getFullYear()));break;case"yy":w>=0?j.formatEraPart("ee",g._date,r):r.append(a.___addLeadingZero((q?q[0]:g._date.getFullYear())%100));break;case"y":w>=0?j.formatEraPart("e",g._date,r):r.append(((q?q[0]:g._date.getFullYear())%100).toString());break;case"hh":l=g._date.getHours()%12,0===l&&(l=12),r.append(a.___addLeadingZero(l));break;case"h":l=g._date.getHours()%12,0===l&&(l=12),r.append(l);break;case"HH":r.append(a.___addLeadingZero(g._date.getHours()));break;case"H":r.append(g._date.getHours().toString());break;case"mm":r.append(a.___addLeadingZero(g._date.getMinutes()));break;case"m":r.append(g._date.getMinutes().toString());break;case"ss":r.append(a.___addLeadingZero(g._date.getSeconds()));break;case"s":r.append(g._date.getSeconds().toString());break;case"tt":r.append(g._date.getHours()<12?h.AMDesignator:h.PMDesignator);break;case"t":r.append((g._date.getHours()<12?h.AMDesignator:h.PMDesignator).charAt(0));break;case"f":r.append(a.___addLeadingZeros(g._date.getMilliseconds()).charAt(0));break;case"ff":r.append(a.___addLeadingZeros(g._date.getMilliseconds()).substr(0,2));break;case"fff":r.append(a.___addLeadingZeros(g._date.getMilliseconds()));break;case"z":l=g._date.getTimezoneOffset()/60,r.append((0>=l?"+":"-")+m(n(l)));break;case"zz":l=g._date.getTimezoneOffset()/60,r.append((0>=l?"+":"-")+a.___addLeadingZero(m(n(l))));break;case"zzz":l=g._date.getTimezoneOffset()/60,r.append((0>=l?"+":"-")+a.___addLeadingZero(m(n(l)))+":"+a.___addLeadingZero(n(g._date.getTimezoneOffset()%60)));break;case"g":case"gg":case"ggg":if(!j)break;if(w===y-1){w=y;break}j.formatEraPart(A[0],g._date,r),w=y;break;case"e":case"ee":if(!j){r.append(a.___padYear(q?q[0]:g._date.getFullYear()));break}if(x===y-1){x=y;break}j.formatEraPart(A[0],g._date,r),x=y;break;case"/":r.append(h.DateSeparator);break;case"[h]":r.append("[h]");break;case"[mm]":r.append("[mm]");break;case"[ss]":r.append("[ss]");break;default:throw new Error(b.SR.Exp_InvalidDateFormat)}else r.append(A[0])}return r.toString()},a.parseLocale=function(b,c){var d;return d=c?[b,c]:[b],a._parseDate(b,y.currentCulture(),d)},a.parseInvariant=function(b,c){return a._parseDate(b,y.invariantCulture(),[b,c])},a.__appendPreOrPostMatch=function(a,b){for(var c=0,d=!1,e=0,f=a.length;f>e;e++){var g=a.charAt(e);switch(g){case"'":case'"':d?b.append("'"):c++,d=!1;break;case"\\":d&&b.append("\\"),d=!d;break;default:b.append(g),d=!1}}return c},a.__expandFormat=function(a,c){c||(c="F");var d=c.length;if(1===d)switch(c){case"d":return a.ShortDatePattern;case"D":return a.LongDatePattern;case"t":return a.ShortTimePattern;case"T":return a.LongTimePattern;case"f":return a.LongDatePattern+" "+a.ShortTimePattern;case"F":return a.FullDateTimePattern;case"M":case"m":return a.MonthDayPattern;case"s":return a.SortableDateTimePattern;case"Y":case"y":return a.YearMonthPattern;case"g":case"G":case"e":return c;case"R":case"r":return a.RFC1123Pattern;case"u":return a.UniversalSortableDateTimePattern;case"U":return a.FullDateTimePattern;case"o":case"O":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffff";default:throw new Error(b.SR.Exp_InvalidString)}else 2===d&&"%"===c.charAt(0)&&(c=c.charAt(1));return c},a.__expandYear=function(a,b){var c=new Date,d=a.DateTimeFormat().eras;if(d&&100>b){var e=d.getEraDate(c).eraYear;b+=e-e%100,b>a.DateTimeFormat().Calendar.TwoDigitYearMax&&(b-=100)}return b},a.__getTokenRegExp=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|ggg|gg|g|ee|e|\[h\]|\[mm\]|\[ss\]/g},a.__getParseRegExp=function(c,d){if(c._parseRegExp){if(c._parseRegExp[d])return c._parseRegExp[d]}else c._parseRegExp={};var e=a.__expandFormat(c,d);e=e.replace("%M","M"),e=e.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var f,g=new s("^"),i=new r([]),j=0,k=0,l=a.__getTokenRegExp();(f=l.exec(e))!==h;){var m=e.slice(j,f.index);if(j=l.lastIndex,k+=a.__appendPreOrPostMatch(m,g),k%2!==1){switch(f[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":g.append("(\\D+)");break;case"tt":case"t":g.append("(\\D*)");break;case"yyy":case"yyyy":g.append("(\\d{4})");break;case"fff":g.append("(\\d{3})");break;case"ff":g.append("(\\d{2})");break;case"f":g.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":g.append("(\\d\\d?)");break;case"zzz":g.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":g.append("([+-]?\\d\\d?)");break;case"/":g.append("(\\"+c.DateSeparator+")");break;default:throw new Error(b.SR.Exp_InvalidDateFormat)}i.add(f[0])}else g.append(f[0])}a.__appendPreOrPostMatch(e.slice(j),g),g.append("$");var n=g.toString().replace(/\s+/g,"\\s+"),o={regExp:n,groups:i.array()};return c._parseRegExp[d]=o,o},a._parseDateExact=function(b,c,d){b=$.trim(b);var e=d.DateTimeFormat(),f=a.__getParseRegExp(e,c),g=new RegExp(f.regExp).exec(b);if(g===h)return h;for(var i,j=f.groups,k=h,l=h,m=h,n=h,o=h,p=0,q=0,r=0,s=0,t=h,u=!1,v=!0,w=0,x=j.length;x>w;w++){var y=g[w+1];if(y)switch(j[w]){case"dd":case"d":if(v=!1,n=parseInt(y,10),1>n||n>31)return h;break;case"MMMM":if(v=!1,m=d._getMonthIndex(y),0>m||m>11)return h;break;case"MMM":if(v=!1,m=d._getAbbrMonthIndex(y),0>m||m>11)return h;break;case"M":case"MM":case"%M":if(v=!1,m=parseInt(y,10)-1,0>m||m>11)return h;break;case"e":case"ee":if(v=!1,l=a.__expandYear(d,parseInt(y,10)),0>l||l>9999)return h;break;case"y":case"yy":case"yyy":case"yyyy":if(v=!1,l=parseInt(y,10),0>l||l>9999)return h;break;case"h":case"hh":case"H":case"HH":if(p=parseInt(y,10),0>p||p>23)return h;break;case"m":case"mm":if(q=parseInt(y,10),0>q||q>59)return h;break;case"s":case"ss":if(r=parseInt(y,10),0>r||r>59)return h;break;case"tt":case"t":var A=y.toUpperCase();if(u=A===e.PMDesignator.toUpperCase(),!u&&A!==e.AMDesignator.toUpperCase())return h;break;case"f":if(s=100*parseInt(y,10),0>s||s>999)return h;break;case"ff":if(s=10*parseInt(y,10),0>s||s>999)return h;break;case"fff":if(s=parseInt(y,10),0>s||s>999)return h;break;case"dddd":if(v=!1,o=d._getDayIndex(y),0>o||o>6)return h;break;case"ddd":if(v=!1,o=d._getAbbrDayIndex(y),0>o||o>6)return h;break;case"zzz":var B=y.split(/:/);if(2!==B.length)return h;if(i=parseInt(B[0],10),-12>i||i>13)return h;var C=parseInt(B[1],10);if(0>C||C>59)return h;t=60*i+(new z(y).startsWith("-")?-C:C);break;case"z":case"zz":if(i=parseInt(y,10),-12>i||i>13)return h;t=60*i;break;case"g":case"gg":case"ggg":var D=y;if(!D||!e.eras)return h;if(k=e.eras.parseEraPart(j[w],D),0>k)return h}}var E,F=new Date,G=e.Calendar.convert;if(G&&(E=G.fromGregorian(F)),G||(E=[F.getFullYear(),F.getMonth(),F.getDate()]),l===h?l=E[0]:100>l&&(e.eras?l=e.eras.getYearFromEra(k||0,l):l+=l>=30?1900:2e3),m===h&&(m=E[1]),n===h&&(n=E[2]),G){if(F=G.toGregorian(l,m,n),F===h)return h}else{if(F.setFullYear(l,m,n),F.getDate()!==n)return h;if(o!==h&&F.getDay()!==o)return h}if(u&&12>p&&(p+=12),F.setHours(p,q,r,s),t!==h){var H=F.getMinutes()-(t+F.getTimezoneOffset());F.setHours(F.getHours()+H/60,H%60)}return F},a.___addLeadingZero=function(a){return 10>a?"0"+a:a.toString()},a.___addLeadingZeros=function(a){return 10>a?"00"+a:100>a?"0"+a:a.toString()},a.___padYear=function(a){return 10>a?"000"+a:100>a?"00"+a:1e3>a?"0"+a:a.toString()},a._parseDate=function(b,c,d){var e,f,g,i,j,k=!1;for(e=1,f=d.length;f>e;e++)if(i=d[e],i&&(k=!0,g=a._parseDateExact(b,i,c)))return g;if(!k)for(j=c._getDateTimeFormats(),e=0,f=j.length;f>e;e++)if(g=a._parseDateExact(b,j[e],c))return g;return h},a.___toOADate=function(a){if(a===i||a===h)return 0;"number"==typeof a&&(a=new Date(a));var b=a.getTime()/864e5+25569-a.getTimezoneOffset()/1440;return b.toString().match(new RegExp("d*.99999999999"))&&(b=Math.round(b)),b},a._fromOADate=function(a){var b=new Date(864e5*(a-25569));return new Date(864e5*a-22091616e5+864e5*b.getTimezoneOffset()/1440)},a.parseExact=a._parseDateExact,a.fromOADate=a._fromOADate,a}();b._DateTimeHelper=B;var C=function(){function a(a,b,c){this.normal=a,this.negative=b,this.zero=c}return a}(),D=function(){function a(){var a=this;a.intPart=h,a.decPart=h,a.group=!1,a.scale=0,a.percent=0,a.permile=0,a.exponent=h}return a}(),E=function(){function a(a){this._num=a}return a.prototype.format=function(a){return this._toFormattedString(a,y.invariantCulture())},a.prototype.localeFormat=function(a){return this._toFormattedString(a,y.currentCulture())},a.prototype.customCultureFormat=function(a,b){return b||(b=y.currentCulture()),this._toFormattedString(a,b)},a.prototype._toFormattedString=function(b,c){var d=this;return b&&0!==b.length&&"i"!==b?a.__getStandardTokenRegExp().test(b)?d._toStandardFormattedString(b,c.NumberFormat()):d._toCustomFormattedString(b,c.NumberFormat()):c&&c.Name().length>0?d._num.toLocaleString():d._num.toString()},a.prototype._toStandardFormattedString=function(c,d){var e=this,f=n(e._num).toString();c||(c="D");var g=-1;c.length>1&&(g=parseInt(c.slice(1),10));var h,i;switch(c.charAt(0)){case"d":case"D":h="n",-1!==g&&(f=a.___zeroPad(""+f,g,!0)),e._num<0&&(f="-"+f);break;case"c":case"C":h=e._num<0?a.___currencyNegativePattern[d.CurrencyNegativePattern]:a.___currencyPositivePattern[d.CurrencyPositivePattern],-1===g&&(g=d.CurrencyDecimalDigits),f=a.___expandNumber(n(e._num),g,d.CurrencyGroupSizes,d.CurrencyGroupSeparator,d.CurrencyDecimalSeparator,d.NegativeSign);break;case"n":case"N":h=e._num<0?a.___numberNegativePattern[d.NumberNegativePattern]:"n",-1===g&&(g=d.NumberDecimalDigits),f=a.___expandNumber(n(e._num),g,d.NumberGroupSizes,d.NumberGroupSeparator,d.NumberDecimalSeparator,d.NegativeSign);break;case"p":case"P":h=e._num<0?a.___percentNegativePattern[d.PercentNegativePattern]:a.___percentPositivePattern[d.PercentPositivePattern],-1===g&&(g=d.PercentDecimalDigits),f=a.___expandNumber(100*n(e._num),g,d.PercentGroupSizes,d.PercentGroupSeparator,d.PercentDecimalSeparator,d.NegativeSign);break;case"F":case"f":i=e._toFixedPoint(f,h,c,g,d),f=i[0],h=i[1];break;case"e":case"E":i=e._toScientificNotation(f,h,c,g,d),f=i[0],h=i[1];break;case"x":case"X":h="n",f=a.___toHexString(e._num,"x"===c.charAt(0),-1===g?0:g);break;case"g":case"G":var j=e._num.toString();i=[],i=-1===j.indexOf("e")&&-1===j.indexOf("E")?e._toFixedPoint(f,h,c,g,d):e._toScientificNotation(f,h,c.replace("g","e").replace("G","E"),g,d),f=i[0],h=i[1];break;default:throw new Error(b.SR.Exp_BadFormatSpecifier)}for(var k=/n|\$|-|%/g,l="";;){var m=k.lastIndex,o=k.exec(h);if(l+=h.slice(m,o?o.index:h.length),!o)break;switch(o[0]){case"n":l+=f;break;case"$":l+=d.CurrencySymbol;break;case"-":/[1-9]/.test(f)&&(l+=d.NegativeSign);break;case"%":l+=d.PercentSymbol;break;default:throw new Error(b.SR.Exp_InvalidNumberFormat)}}return l},a.prototype._toScientificNotation=function(b,c,d,e,f){return c="n",b=a.___toScientific(n(this._num),d.charAt(0),-1===e?6:e,f.NumberGroupSizes,f.NumberGroupSeparator,f.NumberDecimalSeparator,f.NegativeSign),this._num<0&&(b="-"+b),[b,c]},a.prototype._toFixedPoint=function(b,c,d,e,f){c=this._num<0?a.___numberNegativePattern[f.NumberNegativePattern]:"n",-1===e&&(e=2);var g=parseFloat(b),h=m(g),i=g-h;return b=a.___expandNumber(i,e,f.NumberGroupSizes,f.NumberGroupSeparator,f.NumberDecimalSeparator,f.NegativeSign),b=""+h+b.substring(1),[b,c]},a.prototype._toCustomFormattedString=function(b,c){var d=a.___parseCustomNumberFormatter(b),e=h;0===this._num?e=d.zero:this._num<0&&(e=d.negative),e||(e=d.normal);var f=a.___formatNumber(this._num,e,c)+"";return 1===f.indexOf(c.NegativeSign)&&0===f.indexOf(c.CurrencySymbol)&&(f=f[1]+f[0]+f.substring(2)),f},a.parseLocale=function(b){return a.__parseNumber(b,y.currentCulture())},a.parseInvariant=function(b){return a.__parseNumber(b,y.invariantCulture())},a.__getStandardTokenRegExp=function(){return/^(C|c|D|d|E|e|F|f|G|g|N|n|P|p|R|r|X|x)(\d*)$/g},a.___getDigitLength=function(a,b){for(var c=m(n(a)),d={integer:1,decimal:0};c>=10;)c/=10,d.integer++;var e,f=a.toString(),g=f.search(/e/gi),h=f.indexOf(b);if(-1!==g){var i=f.substr(0,g),j=f.substr(g+1),k=0;-1!==h&&(k=i.substr(h+1).length);var l=parseFloat(j);e=k-l,0>e&&(e=0),d.decimal=e}else e=0,-1!==h&&(e=f.substr(h+1).length),d.decimal=e;return d},a.___parseExponentFormat=function(a){for(var c={symbol:a.charAt(0),sign:0,exp:0},d="",e=1;e<a.length;e++)if(d=a.charAt(e),"+"===d)c.sign=1;else{if("-"!==d){if("0"===d){c.exp=a.length-e;break}throw new Error(b.SR.Exp_InvalidExponentFormat)}c.sign=-1}return c},a.___parseCustomNumberFormatter=function(c){for(var d=h,e=h,f=h,g=new D,j="",k=!1,l=!1,m=!1,n=!1,o=!1,p=!1,q=!1,r=!1,s=h,t=h,u=[],v=0;v<c.length;v++)if(s=c.charAt(v),k)"'"!==s?j+=s:(u.push(j),j="",k=!1),t=s;else if(l)'"'!==s?j+=s:(u.push(j),j="",l=!1),t=s;else if(m)u.push(j+s),j="",t=s;else{if(n){if("E"===t||"e"===t){if("+"===s||"-"===s||"0"===s){j+=s;continue}n=!1}else if("+"===t||"-"===t){if("0"===s){j+=s;continue}n=!1,u.push(j),j=""}else if("0"===t){if("0"===s){j+=s;continue}n=!1,q||(q=!0,g.exponent=a.___parseExponentFormat(j)),u.push(j),j=""}}else if("0"===s||"#"===s){if(r=!0,"0"===t||"#"===t){j+=s,t=s;continue}""!==j&&(u.push(j),j="")}else"0"!==t&&"#"!==t||"0"===s||"#"===s||(u.push(j),j="");if(";"===s){if(""!==j&&(n&&!q&&(g.exponent=a.___parseExponentFormat(j)),u.push(j),j=""),o?g.decPart=s:g.intPart=u,u=[],d===i||d===h)d=g;else if(e===i||e===h)e=g;else{if(f!==i&&f!==h)throw new Error(b.SR.Exp_InvalidSemicolons);f=g}o=!1,r=!1,p&&(g.group=!0,p=!1),g=new D}else if(o||"."!==s)if("'"===s)k=!0;else if('"'===s)l=!0;else if("%"===s)g.percent++,u.push(s);else if("‰"===s)g.permile++,u.push(s);else if("0"===s||"#"===s)j+=s;else if(","===s)if(o)""!==j&&(u.push(j),j="");else{if(""!==j&&(u.push(j),j=""),!r)continue;for(var w=!0,x="",y=v+1;y<c.length;y++){var z=c.charAt(y);if(""===x)if("'"===z||'"'===z)x=z;else{if("0"===z||"#"===z){w=!1;break}if("."===z||";"===z)break}else("'"===z||'"'===z)&&(x="")}w?g.scale++:p=!0}else"E"===s||"e"===s?(n=!0,""!==j&&u.push(j),j=s):j+=s;else"#"!==t&&"0"!==t&&(u.push(j),j="#"),""!==j&&(u.push(j),j=""),g.intPart=u,u=[],o=!0,r=!1,p&&(g.group=!0,p=!1);t=s}return""!==j&&(n&&!q&&(g.exponent=a.___parseExponentFormat(j)),u.push(j)),p&&(g.group=!0),o?g.decPart=u:g.intPart=u,d===i||d===h?d=g:e===i||e===h?e=g:(f===i||f===h)&&(f=g),new C(d,e,f)},a.___zeroPad=function(a,b,c){for(var d=a.length;b>d;d++)a=c?"0"+a:a+"0";return a},a.__insertGroupSeparator=function(a,c,d){for(var e=c[0],f=1,g=a.length-1,h=new s(""),i=0,j=!1;g>=0;){if(1>e||e>9)throw new Error(b.SR.Exp_InvalidNumberGroupSize);/\d/gi.test(a[g])?(j&&(h.insert(d,0),j=!1),i++):i=0,h.insert(a[g],0),i===e&&(j=!0,i=0,f<c.length&&(e=c[f],f++)),g--}return h.toString()},a.___expandNumber=function(b,c,d,e,f,g,h){var i=o(10,c),j=p(b*i)/i;isFinite(j)||(j=b),b=j;var k,l,m=b.toString(),n=m.split(/e/i);return m=n[0],l=n.length>1?parseInt(n[1],10):0,n=m.split("."),m=n[0],k=n.length>1?n[1]:"",l>0?(k=a.___zeroPad(k,l,!1),m+=k.slice(0,l),k=k.substr(l)):0>l&&(l=-l,m=0>b?g+a.___zeroPad(m.replace(g,""),l+1,!0):a.___zeroPad(m,l+1,!0),k=m.slice(-l,m.length)+k,m=m.slice(0,-l)),c>0?(k=k.length>c?k.slice(0,c):a.___zeroPad(k,c,!1),k=f+k):k="",h===!0?m+k:a.__insertGroupSeparator(m,d,e,g)+k},a.___formatNumber=function(b,c,d){var e=new s("");b*=o(100,c.percent),b*=o(1e3,c.permile),b/=o(10,3*c.scale);var f=c.intPart,g=c.decPart;if(!f&&!g)return"";var i,j,k,l,m,p=h,q=h;if(f)for(p="",i=0;i<f.length;i++)j=f[i],/^(0|#)+/g.test(j)&&(p+=j);if(g)for(q="",k=0;k<g.length;k++)l=g[k],/^(0|#)+/g.test(l)&&(q+=l);if(!p&&!q)return(f?f.join(""):"")+(g?g.join(""):"");q||(q="");var r=0,t=a.___getDigitLength(b,d.NumberDecimalSeparator);if(c.exponent){var u=n(b),v=p?p.length:1;if(u>=1)t.integer>v?(t.integer-=v,t.decimal+=v,b/=o(10,t.integer),r=t.integer):r=t.integer<v?0:0,-1===c.exponent.sign&&(c.exponent.sign=0);else if(1>u&&u>0){c.exponent.sign=-1,t.integer=v,t.decimal-=v;for(var w=o(10,v);w>10*u;)u*=10,r++;b*=o(10,r)}}var x=q.lastIndexOf("0"),y=q.lastIndexOf("#"),z=t.decimal;x>=0&&(z=x+1),y>x&&y<t.decimal&&(z=y+1),g||(z=0);var A=a.___expandNumber(b,z,d.NumberGroupSizes,d.NumberGroupSeparator,d.NumberDecimalSeparator,d.NegativeSign,!0);if(""===A)return(f?f.join(""):"")+(g?g.join(""):"");var B=!1;if(f){var C=A.split(d.NumberDecimalSeparator)[0],D=C.substr(0,1);D===d.NegativeSign&&(C=C.substr(1));var E=0,F="",G=p.indexOf("0"),H=-1===G?C.length:p.length-G;for(i=f.length-1;i>=0;i--)if(j=f[i],/^(0|#)+/g.test(j))if(F=j+F,F!==p){for(var I=j.length,J=C.length-E-1;J>=0&&I>0;J--){var K=C.charAt(J);e._insert(K),I--,E++}E>=C.length&&H>E&&I>0&&(e._insert(new Array(I+1).join("0")),E+=I)}else{var L=C.substr(0,C.length-E);G>=0&&G<p.length-E-L.length&&(L=new Array(p.length-E-G-L.length+1).join("0")+L),e._insert(L)}else c.exponent&&!B&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(j)?(B=!0,m="",m+=c.exponent.symbol,m+=a.___signs[c.exponent.sign],m+=a.___zeroPad(r.toString(),c.exponent.exp,!0),e._insert(m)):e._insert(j);if(D===d.NegativeSign&&e._insert(D),c.group===!0){var M=a.__insertGroupSeparator(e.toString(),d.NumberGroupSizes,d.NumberGroupSeparator,d.NegativeSign);e=new s(M)}}if(g){var N="";if(z>0){var O=A.indexOf(d.NumberDecimalSeparator);-1!==O&&(N=A.substring(O+1),""===p&&e.append(A.substr(0,O)),e.append(d.NumberDecimalSeparator))}else/^(#+)$/gi.test(q)&&g.join("").length===q.length||(e.append(d.NumberDecimalSeparator),x>0&&(N=new Array(x+1).join("0")));var P=0;for(k=0;k<g.length;k++)l=g[k],/^(0|#)+/g.test(l)?(e.append(N.substr(P,l.length)),P+=l.length):c.exponent&&!B&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(l)?(B=!0,m="",m+=c.exponent.symbol,m+=a.___signs[c.exponent.sign],m+=a.___zeroPad(r.toString(),c.exponent.exp,!0),e.append(m)):e.append(l)}var Q=e.toString(),R=Q.indexOf("0.");return R>=0&&(R+2==Q.length?Q=Q.replace("0.","."):R+2<Q.length&&(/[0-9]+/g.test(Q.charAt(R+2))||(Q=Q.replace("0.",".")))),Q},a.__parseNumberNegativePattern=function(a,b,c){var d=b.NegativeSign,e=b.PositiveSign,f=new z(a);if((4===c||2===c)&&(d=" "+d,e=" "+e),4===c||3===c){if(f.endsWith(d))return["-",a.substr(0,a.length-d.length)];if(f.endsWith(e))return["+",a.substr(0,a.length-e.length)]}else if(2===c||1===c){if(f.startsWith(d))return["-",a.substr(d.length)];if(f.startsWith(e))return["+",a.substr(e.length)]}else{if(0!==c)throw new Error("");if(f.startsWith("(")&&f.endsWith(")"))return["-",a.substr(1,a.length-2)]}return["",a]},a.__parseNumber=function(b,c){if(b=b!==i&&b!==h?new z(b).trim():"",b.match(/^[+-]?infinity$/i))return parseFloat(b);if(b.match(/^0x[a-f0-9]+$/i))return parseInt(b,10);var d=c.numberFormat,e=a.__parseNumberNegativePattern(b,d,d.NumberNegativePattern),f=e[0],g=e[1];""===f&&1!==d.NumberNegativePattern&&(e=a.__parseNumberNegativePattern(b,d,1),f=e[0],g=e[1]),""===f&&(f="+"),g[0]===d.CurrencySymbol&&(g=g.substr(1));var j,k,l=g.indexOf("e");0>l&&(l=g.indexOf("E")),0>l?(k=g,j=h):(k=g.substr(0,l),j=g.substr(l+1));var m,n,o=k.indexOf(d.NumberDecimalSeparator);0>o?(m=k,n=h):(m=k.substr(0,o),n=k.substr(o+d.NumberDecimalSeparator.length)),m=m.split(d.NumberGroupSeparator).join("");var p=d.NumberGroupSeparator.replace(/\u00A0/g," ");d.NumberGroupSeparator!==p&&(m=m.split(p).join(""));var q=f+m;n!==h&&(q+="."+n);var r=q[q.length-1];if(r===d.PercentSymbol){q=q.substr(0,q.length-1),q=new z(q).trimEnd();var t=q.indexOf(d.NumberDecimalSeparator);-1===t&&(t=q.length);var u=new s("");u.append(q.substr(0,t-2)),u.append(d.NumberDecimalSeparator),u.append(q.substr(t-2,2)),u.append(q.substr(t+1)),q=u.toString()}if(j!==h){var v=a.__parseNumberNegativePattern(j,d,1);""===v[0]&&(v[0]="+"),q+="e"+v[0]+v[1]}return q.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?parseFloat(q):0/0},a.___toHexString=function(c,d,e){if(0!==n(m(c)-c))throw new Error(b.SR.Exp_BadFormatSpecifier);var f=c>=0?c.toString(16):(a.___maxInt32+c+1).toString(16);return f=d?f.toLowerCase():f.toUpperCase(),e!==i&&e!==h&&f.length<e?a.___zeroPad(f,e,!0):f},a.___toScientific=function(b,c,d,e,f,g,h){for(var i=0,j=b>=1||0===b;1e3>i;){var k=o(10,i);if(j&&10>b/k||!j&&b*k>=1)break;i++}b=j?n(b)/o(10,i):n(b)*o(10,i);var l=a.___expandNumber(b,d,e,f,g,h);return l+=c+(j?"+":"-")+a.___zeroPad(i.toString(),3,!0)},a.___signs={1:"+",0:"","-1":"-"},a.___maxInt32=4294967295,a.___percentPositivePattern=["n %","n%","%n"],a.___percentNegativePattern=["-n %","-n%","-%n"],a.___numberNegativePattern=["(n)","-n","- n","n-","n -"],a.___currencyPositivePattern=["$n","n$","$ n","n $"],a.___currencyNegativePattern=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],a}();b._NumberHelper=E,b._currentCulture,b.Culture=f,function(){var c=$("meta[name='spreadjs culture']");if(c.length>0){var d=$(c[c.length-1]).attr("content");d!==h&&d!=i&&"ja-jp"===d.toLowerCase()&&(a.spread.SR=a.spread._JPStringResource,b._currentCulture="ja-jp")}}();var F=function(){function a(){}return a._getCtx=function(){if(!a._ctx){var b=document.createElement("canvas");b.getContext&&(a._ctx=b.getContext("2d"))}return a._ctx},a._getWrapInfo=function(b,c,d){var e=[];if(0===b.length)return e;var f=a._getCtx();if(!f)return e;if(f.font=d,0>=c){for(var g=-1,i=!0,j=0;j<b.length;j++){var l=b.charAt(j);" "===l||i?" "!==l&&i&&(g=f.measureText(l).width,i=!1):g=k(g,f.measureText(l).width)}c=g}for(var m=b.split(/\r\n|\r|\n/),n=0;n<m.length;n++){var o=a._getWrapInfoByWord(m[n],c);if(o!=h)for(var p=0;p<o.length;p++)e.push(o[p])}return e},a._getTextWords=function(a){for(var b=[],c=0,d=" ",e=0;e<a.length;e++){b[c]===i&&(b[c]="");var f=a.charAt(e),g="";e+1<a.length&&(g=a.charAt(e+1)),f===d&&g!==d?(b[c]+=f,c++):b[c]+=f}return b},a._measureText=function(b,c){var d=a._getCtx();return d?(d.font!==c&&(d.font=c),d.measureText(b).width):0},a._measureTextWithoutEndSpaces=function(b,c){var d=a._getCtx();if(!d)return 0;c&&(d.font=c);var e=a._removeEndSpace(b);return d.measureText(e).width},a._removeEndSpace=function(a){for(var b=a.length-1;" "===a.charAt(b);)b--;return b!==a.length-1&&(a=a.substring(0,b+1)),a},a._getWrapInfoByCharacter=function(b,c){var d=[],e=a._getCtx();if(!e)return d;var f=e.measureText(b).width,g=f/b.length,i=l(c/g);if(f>c)for(var j=!1;;){var k=b.substring(0,i),m=e.measureText(k).width;if(m==c||j&&c>m)return d.push(k),d.push(b.substring(k.length)),d;if(m>c){if(1===k.length){var n=b.substring(k.length);return 0!==a._measureTextWithoutEndSpaces(n)?(d.push(k),d.push(n)):d.push(b),d}i-=1,j=!0}else{var o=(c-m)/g;o=o>=1?o:1,i+=o}}else b!=h&&b.length>0&&d.push(b);return d},a._getWrapInfoByWord=function(b,c){var d=[],e=a._getTextWords(b),f=a._getCtx();if(!f)return d;for(var g=f.measureText(b).width,h=g/b.length,i=parseInt(c/h+"",10),j=0,k=0,l=0,m=0,n=[],o=!1;m<e.length;){if(o===!1){var p=e[m];if(n.push(p),k+=p.length,i>k){m++;continue}l=k,k=0}var q=a._measureTextWithoutEndSpaces(n.join(""));if(q>c){var r=n.pop();if(0===n.length){var s=a._getWrapInfoByCharacter(r,c);n.push(s[0]),2===s.length?e[m]=s[1]:m++,d[j++]=n.join(""),o=!1,n=[]}else o=!0,m--}else c>q&&o===!0||q===c?(o=!1,d[j++]=a._removeEndSpace(n.join("")),n=[],m++):c>q&&(m++,k=l)}return 0!==n.length&&(d[j]=a._removeEndSpace(n.join(""))),d},a}();b._WordWrapHelper=F;var G=function(){function a(){}return a.IsNumber=function(a){return b.util.isType(a,"number")||b.util.isType(a,"DateTime")||b.util.isType(a,"TimeSpan")||a&&!b.util.isType(a,"boolean")&&!isNaN(a)},a.ToDouble=function(a){return a===h||a===i||""===a?0:b.util.isType(a,"number")?a:b.util.isType(a,"string")&&!isNaN(a)?E.parseLocale(a):b.util.isType(a,"boolean")?a?1:0:b.util.isType(a,"DateTime")?new B(a).toOADate():b.util.isType(a,"TimeSpan")?new B(a).TotalDays():parseFloat(a)},a.toString=function(a){try{return a===h||a===i?"":"boolean"==typeof a?a?"TRUE":"FALSE":"string"==typeof a?a:a.toString()}catch(b){return""}},a}();b.FormatConverter=G}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){function b(b){if(b instanceof e)return b;var c=0,d=0,f=0,g=0;if(b&&""!==b){var h=a.util.parseColorString(b);h&&(3===h.length?(c=255,d=h[0],f=h[1],g=h[2]):4===h.length&&(c=h[0],d=h[1],f=h[2],g=h[3]))}return new e(c,d,f,g)}a.feature("core.theme",["core.migrate","core.common"]);var c=Math.min,d=Math.max,e=function(){function a(a,b,c,d){var e=this;e.a=a,e.r=b,e.g=c,e.b=d}return a.prototype.toString=function(){var a=this;return 255===a.a?"#"+a.getColorUnitString(a.r)+a.getColorUnitString(a.g)+a.getColorUnitString(a.b):"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},a.prototype.getBrightness=function(){return(299*this.r+587*this.g+114*this.b)/1e3
},a.prototype.getColorUnitString=function(a){var b=a.toString(16);return 1===b.length&&(b="0"+b),b},a.hueToRGB=function(a,b,c){return 0>c&&(c+=240),c>240&&(c-=240),40>c?a+((b-a)*c+20)/40:120>c?b:160>c?a+((b-a)*(160-c)+20)/40:a},a.fromHLS=function(b,c,d){var e,f,g;if(0===d)e=f=g=parseInt(255*c/240,10);else{var h,i;i=120>=c?(c*(240+d)+120)/240:c+d-(c*d+120)/240,h=2*c-i,e=parseInt((255*a.hueToRGB(h,i,b+80)+120)/240,10),f=parseInt((255*a.hueToRGB(h,i,b)+120)/240,10),g=parseInt((255*a.hueToRGB(h,i,b-80)+120)/240,10)}return new a(255,e,f,g)},a.parse=function(a){return b(a)},a}();a._Color=e;var f=function(){function a(a){var b=this,e=a.r,f=a.g,g=a.b,h=d(d(e,f),g),i=c(c(e,f),g),j=h+i;b.luminosity=parseInt((240*j+255)/510,10);var k=h-i;if(0===k)b.saturation=0,b.hue=160;else{b.saturation=b.luminosity<=120?parseInt((240*k+j/2)/j,10):parseInt((240*k+(510-j)/2)/(510-j),10);var l=(40*(h-e)+k/2)/k,m=(40*(h-f)+k/2)/k,n=(40*(h-g)+k/2)/k;b.hue=e===h?parseInt(n-m,10):f===h?parseInt(80+l-n,10):parseInt(160+m-l,10),b.hue<0&&(b.hue+=240),b.hue>240&&(b.hue-=240)}}return a.prototype.toColor=function(){return e.fromHLS(this.hue,this.luminosity,this.saturation)},a.prototype.getLighterColor=function(a){var b=this,c=b.luminosity,d=b.newLuma(b.luminosity,500,!0);return e.fromHLS(b.hue,c+(d-c)*a,b.saturation)},a.prototype.getDrakerColor=function(a){var b=this,c=b.newLuma(b.luminosity,-333,!0);return e.fromHLS(b.hue,c*(1-a),b.saturation)},a.prototype.newLuma=function(a,b,c){return 0===b?a:c?b>0?(a*(1e3-b)+241*b)/1e3:a*(b+1e3)/1e3:(a+=240*b/1e3,0>a&&(a=0),a>240&&(a=240),a)},a}();a.HLSColor=f;var g=function(a,b){if(0===b)return a;var c=new f(a),d=parseInt(b>0?(240-c.luminosity)*b:c.luminosity*b,10);return e.fromHLS(c.hue,c.luminosity+d,c.saturation)},h=0,i=1,j=2,k=3,l=4,m=5,n=6,o=7,p=8,q=9,r=10,s=11,t=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n){this._name=a,this._colorList=[b(e),b(f),b(c),b(d),b(g),b(h),b(i),b(j),b(k),b(l),b(m),b(n)]}return a.prototype.name=function(a){return 0===arguments.length?this._name:(this._name=a,this)},a.prototype.background1=function(a){return this._property(h,0===arguments.length,a)},a.prototype.background2=function(a){return this._property(i,0===arguments.length,a)},a.prototype.textColor1=function(a){return this._property(j,0===arguments.length,a)},a.prototype.textColor2=function(a){return this._property(k,0===arguments.length,a)},a.prototype.accent1=function(a){return this._property(l,0===arguments.length,a)},a.prototype.accent2=function(a){return this._property(m,0===arguments.length,a)},a.prototype.accent3=function(a){return this._property(n,0===arguments.length,a)},a.prototype.accent4=function(a){return this._property(o,0===arguments.length,a)},a.prototype.accent5=function(a){return this._property(p,0===arguments.length,a)},a.prototype.accent6=function(a){return this._property(q,0===arguments.length,a)},a.prototype.hyperline=function(a){return this._property(r,0===arguments.length,a)},a.prototype.followedHyperline=function(a){return this._property(s,0===arguments.length,a)},a.prototype._property=function(a,c,d){return c?this._colorList[a]:(this._colorList[a]=b(d),this)},a.prototype.getColor=function(a){if(a){var b=a.split(" ");if(b){var c=-1,d=b.length;if(d>1){if(!b[0])return a;var e=b[0].toLowerCase();"background"===e?c=parseInt(b[1],10)-1:"text"===e?c=parseInt(b[1],10)+1:"accent"===e&&(c=parseInt(b[1],10)+3)}else if(1===d){var e=b[0].toLowerCase();"hyperlink"===e?c=r:"followedhyperlink"===e&&(c=s)}if(c>=0&&11>=c){if(d>2){var f=parseInt(b[2],10)/100;return g(this._colorList[c],f).toString()}return this._colorList[c].toString()}}}return a},a.prototype.toJSON=function(){return{name:this._name,colorList:this._colorList}},a}();a.ThemeColor=t;var u=function(){function a(){}return a.Default=new t("Default","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office=new t("Office","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Apex=new t("Apex","#000000","#69676D","#FFFFFF","#C9C2D1","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),a.Aspect=new t("Aspect","#000000","#323232","#FFFFFF","#E3DED1","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),a.Concourse=new t("Concourse","#000000","#464646","#FFFFFF","#DEF5FA","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),a.Civic=new t("Civic","#000000","#646B86","#FFFFFF","#C5D1D7","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),a.Oriel=new t("Oriel","#000000","#575F6D","#FFFFFF","#FFF39D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),a.Origin=new t("Origin","#000000","#464653","#FFFFFF","#DDE9EC","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),a.Paper=new t("Paper","#000000","#444D26","#FFFFFF","#FEFAC9","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),a.Solstice=new t("Solstice","#000000","#4F271C","#FFFFFF","#E7DEC9","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),a.Technic=new t("Technic","#000000","#3B3B3B","#FFFFFF","#D4D2D0","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),a.Trek=new t("Trek","#000000","#4E3B30","#FFFFFF","#FBEEC9","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),a.Urban=new t("Urban","#000000","#424456","#FFFFFF","#DEDEDE","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),a.Verve=new t("Verve","#000000","#666666","#FFFFFF","#D2D2D2","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),a.Equity=new t("Equity","#000000","#696464","#FFFFFF","#E9E5DC","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),a.Flow=new t("Flow","#000000","#04617B","#FFFFFF","#DBF5F9","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),a.Foundry=new t("Foundry","#000000","#676A55","#FFFFFF","#EAEBDE","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),a.Median=new t("Median","#000000","#775F55","#FFFFFF","#EBDDC3","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),a.Metro=new t("Metro","#000000","#4E5B6F","#FFFFFF","#D6ECFF","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),a.Module=new t("Module","#000000","#5A6378","#FFFFFF","#D4D4D6","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),a.Opulent=new t("Opulent","#000000","#B13F9A","#FFFFFF","#F4E7ED","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),a}();a.ThemeColors=u;var v=function(){function a(a,b,c,d){var e=this;e._name=a,e._themeColor=b?b:new t(a),e._headingFont=c,e._bodyFont=d}return a.prototype.name=function(a){return 0===arguments.length?this._name:(this._name=a,this)},a.prototype.colors=function(a){return 0===arguments.length?this._themeColor:(this._themeColor=a,this)},a.prototype.headerFont=function(a){return 0===arguments.length?this._headingFont:(this._headingFont=a,this)},a.prototype.bodyFont=function(a){return 0===arguments.length?this._bodyFont:(this._bodyFont=a,this)},a.prototype.getColor=function(a){return this._themeColor.getColor(a)},a.prototype.getFont=function(a){return"Body"===a?this.bodyFont():"Headings"===a?this.headerFont():a},a.prototype.toJSON=function(){var a=this;return{name:a._name,themeColor:a._themeColor?a._themeColor.toJSON():void 0,headingFont:a._headingFont,bodyFont:a._bodyFont}},a}();a.SpreadTheme=v;var w=function(){function a(){}return a.Default=new v("Default",u.Default,"Cambria","Calibri"),a.Office=new v("Office",u.Office,"Cambria","Calibri"),a.Apex=new v("Apex",u.Apex,"Lucida Sans","Book Antiqua"),a.Aspect=new v("Aspect",u.Aspect,"Verdana","Verdana"),a.Concourse=new v("Concourse",u.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),a.Civic=new v("Civic",u.Civic,"Georgia","Georgia"),a.Oriel=new v("Oriel",u.Oriel,"Century Schoolbook","Century Schoolbook"),a.Origin=new v("Origin",u.Origin,"Bookman Old Style","Gill Sans MT"),a.Paper=new v("Paper",u.Paper,"Constantia","Constantia"),a.Solstice=new v("Solstice",u.Solstice,"Gill Sans MT","Gill Sans MT"),a.Technic=new v("Technic",u.Technic,"Franklin Gothic Book","Arial"),a.Trek=new v("Trek",u.Trek,"Franklin Gothic Medium","Franklin Gothic Book"),a.Urban=new v("Urban",u.Urban,"Trebuchet MS","Georgia"),a.Verve=new v("Verve",u.Verve,"Century Gothic","Century Gothic"),a.Equity=new v("Equity",u.Equity,"Franklin Gothic Book","Perpetua"),a.Flow=new v("Flow",u.Flow,"Calibri","Constantia"),a.Foundry=new v("Foundry",u.Foundry,"Rockwell","Rockwell"),a.Median=new v("Median",u.Median,"Tw Cen MT","Tw Cen MT"),a.Metro=new v("Metro",u.Metro,"Consolas","Corbel"),a.Module=new v("Module",u.Module,"Corbel","Corbel"),a.Opulent=new v("Opulent",u.Opulent,"Trebuchet MS","Trebuchet MS"),a}();a.SpreadThemes=w}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){b.feature("core.spreadpanelex",["core.common"]);var c=null,d="undefined",e="scroll-container",f="scroll-outContainer",g="scroll-arrow",h="scrollbar-wrapper",i="scroll-bar",j="scroll-arrowUp",k="scroll-arrowDown",l="scroll-arrowLeft",m="scroll-arrowRight",n="scrollbar-vertical",o="scrollbar-horizontal",p="scrollbar-none-user-select",q="scroll-horizontal",r="scroll-vertical",s="scroll-content-wrapper",t="scroll-panel-container",u="scroll-temp-content-wrapper",v="width",w="height",x="left",y="right",z="top",A="bottom",B="margin-left",C="margin-top",D=".gcScrollbar",E="mousedown"+D,F="mouseup"+D,G="mousemove"+D,H="mouseover"+D,I="mouseout"+D,J="mousewheel",K="DOMMouseScroll",I="mouseout"+D,L="keydown"+D,M="scroll"+D,N={addHandler:function(a,b,c){a.addEventListener&&a.addEventListener(b,c,!1)},removeHandler:function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}};!function(a){a[a.pixels=0]="pixels",a[a.continuous=1]="continuous"}(b.ScrollType||(b.ScrollType={}));var O=b.ScrollType;!function(a){a[a.horizontalScroll=0]="horizontalScroll",a[a.verticalScroll=1]="verticalScroll"}(b.ScrollOrientation||(b.ScrollOrientation={}));b.ScrollOrientation;!function(a){a[a.smallDecrement=0]="smallDecrement",a[a.smallIncrement=1]="smallIncrement",a[a.largeDecrement=2]="largeDecrement",a[a.largeIncrement=3]="largeIncrement",a[a.thumbPosition=4]="thumbPosition",a[a.thumbTrack=5]="thumbTrack",a[a.endScroll=8]="endScroll"}(b.ScrollEventType||(b.ScrollEventType={}));var P=(b.ScrollEventType,function(){function a(a,b){var c=this;c._showHorizontalScrollbar=!0,c._showVerticalScrollbar=!0,c._useWijmoTheme=!1,c._hSmallChange=10,c._vSmallChange=10,c._defaultScrollbarSize=18,c._superPanel=a,c._content=b,c.refreshLayout(!0)}return a.prototype.content=function(a){var b=this;return 0===arguments.length?b._content:(a instanceof HTMLElement&&b._content!==a&&(b._content=a,b.refreshLayout(!0)),b)},a.prototype.superPanel=function(a){var b=this;return 0===arguments.length?b._superPanel:(a instanceof HTMLElement&&b._superPanel!==a&&(b._superPanel=a,b.refreshLayout(!0)),b)},a.prototype.horizontalSmallChange=function(a){var b=this;return 0===arguments.length?b._hSmallChange:("number"==typeof a&&b._hSmallChange!==a&&(b._hSmallChange=a),b)},a.prototype.verticalSmallChange=function(a){var b=this;return 0===arguments.length?b._vSmallChange:("number"==typeof a&&b._vSmallChange!==a&&(b._vSmallChange=a),b)},a.prototype.showHorizontalScrollbar=function(){return this._showHorizontalScrollbar},a.prototype.showVerticalScrollbar=function(){return this._showVerticalScrollbar},a.prototype.refreshLayout=function(a){var b=this;if(b._superPanel&&b._content){var c=$(b._superPanel),d=$(b._content),e=b._defaultScrollbarSize,f=d.width(),g=d.height(),h=c.width(),i=c.height(),j=h-e,k=i-e,l=!1;b._container||(b._container=document.createElement("div"),$(b._container).addClass(t),l=!0);var m=$(b._container);m.css({width:h,height:i}),b._contentWrapper||(b._contentWrapper=document.createElement("div"),$(b._contentWrapper).addClass(s),m.append(b._contentWrapper));var n=$(b._contentWrapper);b._tempContentWrapper||(b._tempContentWrapper=document.createElement("div"),$(b._tempContentWrapper).addClass(u),n.append(b._tempContentWrapper));var o=$(b._tempContentWrapper);a&&o.append(b._content),o.css({top:0,left:0});var p=b._isNeedScrollbars(f,g,h,i),v=p.isNeedVScroll,w=p.isNeedHScroll;if(w){if(v||(j+=e),!b._hScrollbar){b._hScrollbar=new Q(!0);var x=b._hScrollbar.getScrollbar();b._hbarContainer=document.createElement("div");var y=$(b._hbarContainer);y.addClass(q),y.append(x),m.append(b._hbarContainer)}$(b._hbarContainer).css({width:j,height:e});var z=b._hScrollbar,A=$(b._hScrollbar.getScrollbar());z.width(j),z.height(e),z.minimum(0),z.maximum(f-j),z.pageValue(j),z.smallChange(b.horizontalSmallChange()),z.largeChange(j),z.refreshLayout(),A.bind(M,function(a,b){o.css("left",0-b.newValue)}),$(b._hbarContainer).show(),b._showHorizontalScrollbar=!0}else b._hbarContainer&&$(b._hbarContainer).hide(),b._showHorizontalScrollbar=!1;if(v){if(w||(k+=e),!b._vScrollbar){b._vScrollbar=new Q(!1);var B=b._vScrollbar.getScrollbar();b._vbarContainer=document.createElement("div");var C=$(b._vbarContainer);C.addClass(r),C.append(B),m.append(b._vbarContainer)}$(b._vbarContainer).css({width:e,height:k});var D=b._vScrollbar,E=$(b._vScrollbar.getScrollbar());D.width(e),D.height(k),D.minimum(0),D.maximum(g-k),D.pageValue(k),D.smallChange(b.verticalSmallChange()),D.largeChange(k),D.refreshLayout(),E.bind(M,function(a,b){o.css("top",0-b.newValue)}),$(b._vbarContainer).show(),b._showVerticalScrollbar=!0}else b._vbarContainer&&$(b._vbarContainer).hide(),b._showVerticalScrollbar=!1;w||v||(j+=e,k+=e),b._pageWidth=j,b._pageHeight=k,n.css({width:j,height:k}),l&&(c.append(b._container),b._initEvent())}},a.prototype.scrollChildIntoView=function(a){var b=this,d=b._getScrollOffset(a),e=d.left,f=d.top;e!==c&&b.hScrollTo(e),f!==c&&b._vScrollbar&&b.vScrollTo(f)},a.prototype.hScrollTo=function(a){var b=this;b._hScrollbar.value(a);var c=b._pageWidth,d=$(b._content).width();a>=0&&d-c>=a&&$(b._tempContentWrapper).css(x,0-a)},a.prototype.useWijmoTheme=function(a){var b=this;if(0===arguments.length)return b._useWijmoTheme;if("boolean"==typeof a&&b._useWijmoTheme!==a){b._useWijmoTheme=a;var c=b._hScrollbar,d=b._vScrollbar;c&&c.useWijmoTheme(a),d&&d.useWijmoTheme(a)}return b},a.prototype.vScrollTo=function(a){var b=this;b._vScrollbar.value(a);var c=b._pageHeight,d=$(b._content).height();a>=0&&d-c>=a&&$(b._tempContentWrapper).css(z,0-a)},a.prototype._isNeedScrollbars=function(a,b,c,d){var e=this._defaultScrollbarSize,f=c-e,g=d-e,h={isNeedHScroll:!1,isNeedVScroll:!1};return a>c&&(h.isNeedHScroll=!0,h.isNeedVScroll=b>g?!0:!1),b>d&&(h.isNeedVScroll=!0,h.isNeedHScroll=a>f?!0:!1),a>f&&b>g&&(h.isNeedVScroll=!0,h.isNeedHScroll=!0),h},a.prototype._getScrollOffset=function(a){var b,d,e,f,g,h,i,j=$(a),k=$(this._contentWrapper),l=$(this._tempContentWrapper),m={left:c,top:c};return a?(b=j.offset(),d=l.offset(),e=k.offset(),b.leftWidth=b.left+j.outerWidth(),b.topHeight=b.top+j.outerHeight(),e.leftWidth=e.left+k.outerWidth(),e.topHeight=e.top+k.outerHeight(),f=b.left-d.left,b.left<e.left?m.left=f:b.leftWidth>e.leftWidth&&(g=b.leftWidth-d.left-k.innerWidth(),m.left=g>f?f:g),h=b.top-d.top,b.top<e.top?m.top=h:b.topHeight>e.topHeight&&(i=b.topHeight-d.top-k.innerHeight(),m.top=i>h?h:i),m):m},a.prototype._initEvent=function(){var a=this;this._tempContentWrapper&&(a._mousewheelHandler=function(b){a._contentContainerMousewheel(b)},N.addHandler(a._tempContentWrapper,J,a._mousewheelHandler),N.addHandler(a._tempContentWrapper,K,a._mousewheelHandler))},a.prototype._contentContainerMousewheel=function(a){var e=this;typeof a.wheelDelta!==d&&a.wheelDelta!==c||typeof a.detail!==d&&a.detail!==c||(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail);var f=a.detail?a.detail:a.wheelDelta/-40,g=f,h=e._vScrollbar,i=parseInt($(e._tempContentWrapper).css(z)),j=e._pageHeight,k=$(e._content).height();j>k&&(k=j),isNaN(i)&&(i=0);var l=i-g*e.verticalSmallChange();l>=0&&(l=0),0>l&&0-l>k-j&&(l=0-(k-j)),l!==i&&($(e._tempContentWrapper).css(z,l),e._showVerticalScrollbar&&h.value(0-l)),b.util.cancelDefault(a)},a.prototype.dispose=function(){var a=this;a._container&&(a._hScrollbar&&a._hScrollbar.dispose(),a._vScrollbar&&a._vScrollbar.dispose(),a._tempContentWrapper&&a._mousewheelHandler&&(N.removeHandler(a._tempContentWrapper,J,a._mousewheelHandler),N.removeHandler(a._tempContentWrapper,K,a._mousewheelHandler)),$(a._container).remove())},a}());b.ScrollablePanel=P;var Q=function(){function q(a,b,d,e,f,g,h){var i=this;i._pageValue=10,i._maximum=100,i._minimum=0,i._value=0,i._largeChange=10,i._smallChange=1,i._scrollType=1,i._useWijmoTheme=!1,i._scrollPosition=0,i._isMousedownInScrollbar=!1,i._scrollTimeOutArrow=c,i._scrollTimeOutContainer=c,i._initialDelay=300,i._trackClickPepeatFreq=70,i._isHorizontalScroll=a,i._width="number"==typeof b?b:0,i._height="number"==typeof d?d:0,i._pageValue="number"==typeof e?e:0,i._maximum="number"==typeof f?f:0,i._minimum="number"==typeof g?g:0,i._scrollType="number"==typeof h?h:1,i._isMouseCapture=!1,i._scrollPosition=0,i._value=i._minimum,i.refreshLayout()}return q.prototype.getScrollbar=function(){return this._scrollContainerDiv},q.prototype.smallChange=function(a){var b=this;return 0===arguments.length?b._smallChange:("number"==typeof a&&b._smallChange!==a&&(b._smallChange=a),b)},q.prototype.largeChange=function(a){var b=this;return 0===arguments.length?b._largeChange:("number"==typeof a&&b._largeChange!==a&&(b._largeChange=a),b)},q.prototype.pageValue=function(a){var b=this;return 0===arguments.length?b._pageValue:("number"==typeof a&&b._pageValue!==a&&(0>=a&&(a=1),b._pageValue=a),b)},q.prototype.maximum=function(a){var b=this;return 0===arguments.length?b._maximum:("number"==typeof a&&b._maximum!==a&&(0>=a&&(a=0),b._maximum=a),b)},q.prototype.minimum=function(a){var b=this;return 0===arguments.length?b._minimum:("number"==typeof a&&b._minimum!==a&&(0>=a&&(a=0),b._minimum=a),b)},q.prototype.value=function(a){var b=this;if(0===arguments.length)return b._value;if("number"==typeof a&&a<=b._maximum&&a>=b._minimum){b._value=a;var c=(a-b._minimum)*b._scrollUnit;b.scrollTo(c,!1,!0)}return b},q.prototype.width=function(a){var b=this;return 0===arguments.length?b._width:("number"==typeof a&&b._width!==a&&(b._width=a),b)},q.prototype.height=function(a){var b=this;return 0===arguments.length?b._height:("number"==typeof a&&b._height!==a&&(b._height=a),b)},q.prototype.scrollType=function(a){var b=this;return 0===arguments.length?b._scrollType:(typeof O[a]!==d&&b._scrollType!==a&&(b._scrollType=a),b)},q.prototype.useWijmoTheme=function(a){var b=this;if(0===arguments.length)return b._useWijmoTheme;if("boolean"==typeof a&&b._useWijmoTheme!==a){b._useWijmoTheme=a;var c=l,d=m,f=o,p="wijmo-wijsuperpanel-hbarcontainer ui-widget-header ui-corner-bottom",q="ui-state-default ui-corner-bl",r="ui-icon ui-icon-triangle-1-w",s="scroll-handle ui-state-default ui-corner-all ui-draggable",t="ui-icon ui-icon-grip-solid-vertical",u="ui-state-default ui-corner-br",v="ui-icon ui-icon-triangle-1-e";b._isHorizontalScroll||(c=j,d=k,f=n,p="wijmo-wijsuperpanel-vbarcontainer ui-widget-header ui-corner-right",q="ui-state-default ui-corner-tr",r="ui-icon ui-icon-triangle-1-n",s="scroll-handle ui-state-default ui-corner-all ui-draggable",t="ui-icon ui-icon-grip-solid-horizontal",u="ui-state-default ui-corner-br",v="ui-icon ui-icon-triangle-1-s"),a?($(b._scrollContainerDiv).removeClass(e).addClass(p),$(b._arrowStartDiv).removeClass(g).addClass(q),$(b._arrowStartSpan).removeClass(c).addClass(r),$(b._scrollbarWrapperDiv).removeClass(h).addClass(h),$(b._scrollbarDiv).removeClass(i).addClass(s),$(b._scrollbarSpan).removeClass(f).addClass(t),$(b._arrowEndDiv).removeClass(g).addClass(u),$(b._arrowEndSpan).removeClass(d).addClass(v)):($(b._scrollContainerDiv).removeClass(p).addClass(e),$(b._arrowStartDiv).removeClass(q).addClass(g),$(b._arrowStartSpan).removeClass(r).addClass(c),$(b._scrollbarWrapperDiv).removeClass(h).addClass(h),$(b._scrollbarDiv).removeClass(s).addClass(i),$(b._scrollbarSpan).removeClass(t).addClass(f),$(b._arrowEndDiv).removeClass(u).addClass(g),$(b._arrowEndSpan).removeClass(v).addClass(d))}return b},q.prototype.refreshLayout=function(){var a=this,b=a._height,c=a._width,d=b,q=c-2*b,r=d,s=x,t=y,u=0,D=0,E=!1,F=2,G=l,H=m,I=o,J=B;a._isHorizontalScroll?a._scrollSize=q:(d=c,q=d,r=b-2*c,s=z,t=A,a._scrollSize=r,G=j,H=k,I=n,J=C);var K=a._scrollSize;a._scrollbarSize=a._pageValue*K/(a._maximum-a._minimum+a._pageValue),a._scrollbarSize>K&&(a._scrollbarSize=K),a._scrollbarSize<10&&(a._scrollbarSize=10);var L=a._scrollbarSize;a._scrollUnit=(K-L)/(a._maximum-a._minimum),a._isHorizontalScroll?(u=L,D=d):(u=d,D=L),a._scrollContainerDiv||(E=!0,a._scrollContainerDiv=document.createElement("div"),$(a._scrollContainerDiv).css({position:"relative",left:0,top:0,overflow:"hidden",outline:"none"}).addClass(e).addClass(f));var M=$(a._scrollContainerDiv);M.css(v,c).css(w,b),a._arrowStartDiv||(a._arrowStartDiv=document.createElement("div"),$(a._arrowStartDiv).css({position:"absolute",display:"inline-block"}).addClass(g),a._arrowStartSpan=document.createElement("span"),$(a._arrowStartSpan).addClass(G),$(a._arrowStartDiv).append(a._arrowStartSpan),M.append(a._arrowStartDiv)),$(a._arrowStartDiv).css(s,0).css(v,d-F).css(w,d-F),$(a._arrowStartSpan).css({width:"100%",height:"100%",display:"block"}),a._scrollbarWrapperDiv||(a._scrollbarWrapperDiv=document.createElement("div"),$(a._scrollbarWrapperDiv).css({position:"absolute",display:"inline-block"}).addClass(h),M.append(a._scrollbarWrapperDiv));var N=$(a._scrollbarWrapperDiv);N.css(s,d).css(v,q).css(w,r),a._scrollbarDiv||(a._scrollbarDiv=document.createElement("div"),$(a._scrollbarDiv).css({position:"absolute"}).addClass(i).addClass(p),a._scrollbarSpan=document.createElement("span"),$(a._scrollbarSpan).addClass(I),$(a._scrollbarDiv).append(a._scrollbarSpan),N.append(a._scrollbarDiv)),$(a._scrollbarDiv).css(s,a._scrollPosition).css(v,u-F).css(w,D-F),$(a._scrollbarSpan).css({width:d-F,height:d-F,display:"block"}),$(a._scrollbarSpan).css(J,(a._scrollbarSize-d)/2),a._arrowEndDiv||(a._arrowEndDiv=document.createElement("div"),$(a._arrowEndDiv).css({position:"absolute",display:"inline-block"}).addClass(g),a._arrowEndSpan=document.createElement("span"),$(a._arrowEndSpan).addClass(H),$(a._arrowEndDiv).append(a._arrowEndSpan),M.append(a._arrowEndDiv)),$(a._arrowEndDiv).css(t,0).css(v,d-F).css(w,d-F),$(a._arrowEndSpan).css({width:"100%",height:"100%",display:"block"}),E&&(M.attr("tabindex")||M.attr("tabindex",-1),a._initEvents())},q.prototype._initEvents=function(){var c=this;$(c._arrowStartDiv).bind(E,function(a){c._arrowMousedown(a,!0)}).bind(F,function(a){c._arrowMouseup(a,!0)}).bind(H,function(a){c._arrowMouseover(a,!0)}).bind(I,function(a){c._arrowMouseout(a,!0)}),$(c._arrowEndDiv).bind(E,function(a){c._arrowMousedown(a,!1)}).bind(F,function(a){c._arrowMouseup(a,!1)}).bind(H,function(a){c._arrowMouseover(a,!1)}).bind(I,function(a){c._arrowMouseout(a,!1)}),$(c._scrollbarDiv).bind(E,function(a){c._scrollbarMousedown(a)}).bind(G,function(a){c._scrollbarMousemove(a)}).bind(F,function(a){c._scrollbarMouseup(a)}).bind(H,function(a){c._scrollbarMouseover(a)}).bind(I,function(a){c._scrollbarMouseout(a)}),$(c._scrollbarWrapperDiv).bind(E,function(a){c._scrollbarContainerMousedown(a)}).bind(F,function(a){c._scrollbarContainerMouseup(a)}),c._mousewheelHandler=function(a){c._scrollContainerMousewheel(a)},N.addHandler(c._scrollContainerDiv,J,c._mousewheelHandler),N.addHandler(c._scrollContainerDiv,K,c._mousewheelHandler),$(c._scrollContainerDiv).bind(L,function(a){c._scrollContainerKeydown(a)}),b.features.touch&&(c._simulateMouseEvents=new a.spread._SimulateMouseEvents,c._simulateMouseEvents.bindUnBindTouchEvents(c._scrollContainerDiv,!0,D))},q.prototype.dispose=function(){var a=this,b=a._scrollContainerDiv;a._arrowEndDiv&&$(a._arrowEndDiv).unbind(D),a._scrollbarDiv&&$(a._scrollbarDiv).unbind(D),a._arrowStartDiv&&$(a._arrowStartDiv).unbind(D),a._scrollbarWrapperDiv&&$(a._scrollbarWrapperDiv).unbind(D),b&&(a._mousewheelHandler&&(N.removeHandler(b,J,a._mousewheelHandler),N.removeHandler(b,K,a._mousewheelHandler)),a._simulateMouseEvents&&a._simulateMouseEvents.bindUnBindTouchEvents(a._scrollContainerDiv,!1,D),$(b).removeAttr("tabindex").unbind(D).remove())},q.prototype._handleDocumentMouseMove=function(){var a=this;a._isMouseCapture||($(document).bind(G,function(b){a._scrollbarMousemove(b)}).bind(F,function(b){a._scrollbarMouseup(b)}),a._isMouseCapture=!0)},q.prototype._unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,$(document).unbind(G).unbind(F))},q.prototype._arrowMousedown=function(a,b){var c=0,d=this,e=!0;if(null===d._scrollTimeOutArrow){b?($(d._arrowStartDiv).addClass(d._useWijmoTheme?"ui-state-active":"scrollbar-stateActive"),c=0-d._smallChange*d._scrollUnit,d._scrollEventType=0):($(d._arrowEndDiv).addClass(d._useWijmoTheme?"ui-state-active":"scrollbar-stateActive"),c=d._smallChange*d._scrollUnit,d._scrollEventType=1);var f=function(){d.scrollTo(d._scrollPosition+c,!0),1===d._scrollType&&(d._scrollTimeOutArrow=setTimeout(f,e?d._initialDelay:d._trackClickPepeatFreq)),e=!1};f()}},q.prototype._arrowMouseup=function(a,b){var c=this,d=$(c._arrowStartDiv);b||(d=$(c._arrowEndDiv)),d.removeClass(c._useWijmoTheme?"ui-state-active":"scrollbar-stateActive"),c._endArrowScroll()},q.prototype._arrowMouseover=function(a,b){var c=this,d=$(c._arrowStartDiv);b||(d=$(c._arrowEndDiv)),d.addClass(c._useWijmoTheme?"ui-state-hover":"scrollbar-stateHover")},q.prototype._arrowMouseout=function(a,b){var c=this,d=$(c._arrowStartDiv);b||(d=$(c._arrowEndDiv)),c._useWijmoTheme?d.removeClass("ui-state-hover").removeClass("ui-state-active"):d.removeClass("scrollbar-stateHover").removeClass("scrollbar-stateActive"),c._endArrowScroll()},q.prototype._scrollbarMousedown=function(a){var b=this;if(0===a.button){b._isMousedownInScrollbar=!0,b._oldPosition={x:a.pageX,y:a.pageY},b._handleDocumentMouseMove(),$(b._scrollbarDiv).addClass(b._useWijmoTheme?"ui-state-active":"scrollbar-stateActive");var c=$(b._scrollbarDiv).offset(),d=$(b._scrollbarDiv).outerWidth(!0),e=$(b._scrollbarDiv).outerHeight(!0),f=$(b._scrollbarWrapperDiv).offset(),g=$(b._scrollbarWrapperDiv).outerWidth(!0),h=$(b._scrollbarWrapperDiv).outerHeight(!0);b._edgePosition={isBeyondEdge:!1,startEdgePosition:{x:f.left+a.pageX-c.left,y:f.top+a.pageY-c.top},endEdgePosition:{x:f.left+g-(d-a.pageX+c.left),y:f.top+h-(e-a.pageY+c.top)}}}},q.prototype._scrollbarMousemove=function(a){var b=this;b._isMousedownInScrollbar&&(b._currentPosition={x:a.pageX,y:a.pageY},b._scrollbarDrag(),b._oldPosition=b._currentPosition,$(document.body).addClass(p))},q.prototype._scrollbarMouseup=function(){var a=this;a._isMousedownInScrollbar=!1,a._scrollEventType=4,a._edgePosition=null;var b={newValue:a._value,oldValue:a._value,scrollOrientation:a._isHorizontalScroll?0:1,scrollEventType:a._scrollEventType};$(a._scrollContainerDiv).trigger(M,b);var c=a._value,d=(c-a._minimum)*a._scrollUnit,e="left";a._isHorizontalScroll||(e="top"),a._scrollPosition=d,$(a._scrollbarDiv).css(e,d),a._unhandleDocumentMouseMove(),$(document.body).removeClass(p),$(a._scrollbarDiv).removeClass(a._useWijmoTheme?"ui-state-active":"scrollbar-stateActive"),a._scrollEventType=8;var b={newValue:a._value,oldValue:a._value,scrollOrientation:a._isHorizontalScroll?0:1,scrollEventType:a._scrollEventType};$(a._scrollContainerDiv).trigger(M,b)},q.prototype._scrollbarMouseover=function(){$(this._scrollbarDiv).addClass(this._useWijmoTheme?"ui-state-hover":"scrollbar-stateHover")},q.prototype._scrollbarMouseout=function(){$(this._scrollbarDiv).removeClass(this._useWijmoTheme?"ui-state-hover":"scrollbar-stateHover")},q.prototype._scrollContainerMousewheel=function(a){var e=this;typeof a.wheelDelta!==d&&a.wheelDelta!==c||typeof a.detail!==d&&a.detail!==c||(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail);var f=a.detail?a.detail:a.wheelDelta/-40,g=f/3*e._smallChange*e._scrollUnit;e._scrollEventType=g>=0?1:0,e.scrollTo(e._scrollPosition+g,!0),e._scrollEventType=8;var h={newValue:e._value,oldValue:e._value,scrollOrientation:e._isHorizontalScroll?0:1,scrollEventType:e._scrollEventType};$(e._scrollContainerDiv).trigger(M,h),b.util.cancelDefault(a)},q.prototype._scrollContainerKeydown=function(a){var b=this,c=a.shiftKey,d=a.keyCode,e=0,f=b._scrollPosition,g=f;b._isHorizontalScroll?(37===d&&(e=b._calcMovingOffsetByKeydown(c,"left"),g=f-e),39===d&&(e=b._calcMovingOffsetByKeydown(c,"right"),g=f+e)):(38===d&&(e=b._calcMovingOffsetByKeydown(c,"top"),g=f-e),40===d&&(e=b._calcMovingOffsetByKeydown(c,"bottom"),g=f+e)),g!==b._scrollPosition&&b.scrollTo(g,!0),b._scrollEventType=8;var h={newValue:b._value,oldValue:b._value,scrollOrientation:b._isHorizontalScroll?0:1,scrollEventType:b._scrollEventType};$(b._scrollContainerDiv).trigger(M,h)},q.prototype._scrollbarContainerMousedown=function(a){var b=this,c=!0,d=a.pageX,e=a.pageY,f=0,g=$(b._scrollbarWrapperDiv).offset(),h=b._largeChange*b._scrollUnit;if(null===b._scrollTimeOutContainer){f=b._isHorizontalScroll?d-g.left-b._scrollPosition:e-g.top-b._scrollPosition;var i=function(){var a=$(b._scrollbarWrapperDiv).offset(),g=0,j=b._scrollPosition;if(g=b._isHorizontalScroll?d-a.left-j:e-a.top-j,0>g*f||g>=0&&g<b._scrollbarSize)return void b._endContainerScroll();if(0>f)b._scrollEventType=2,b.scrollTo(j-h,!0);else{if(!(f>0))return void b._endContainerScroll();b._scrollEventType=3,b.scrollTo(j+h,!0)}1===b._scrollType&&(b._scrollTimeOutContainer=setTimeout(i,c?b._initialDelay:b._trackClickPepeatFreq)),c=!1};i()}},q.prototype._scrollbarContainerMouseup=function(){this._endContainerScroll()},q.prototype._endContainerScroll=function(){var a=this;a._scrollTimeOutContainer&&clearTimeout(a._scrollTimeOutContainer),a._scrollTimeOutContainer=c,a._scrollEventType=8;var b={newValue:a._value,oldValue:a._value,scrollOrientation:a._isHorizontalScroll?0:1,scrollEventType:a._scrollEventType};$(a._scrollContainerDiv).trigger(M,b)},q.prototype._endArrowScroll=function(){var a=this;a._scrollTimeOutArrow&&clearTimeout(a._scrollTimeOutArrow),a._scrollTimeOutArrow=c,a._scrollEventType=8;var b={newValue:a._value,oldValue:a._value,scrollOrientation:a._isHorizontalScroll?0:1,scrollEventType:a._scrollEventType};$(a._scrollContainerDiv).trigger(M,b)},q.prototype._calcMovingOffsetByKeydown=function(a,b){var c=this;return a?(c._scrollEventType="left"===b||"top"===b?2:3,c._largeChange*c._scrollUnit):(c._scrollEventType="left"===b||"top"===b?0:1,c._smallChange*c._scrollUnit)},q.prototype._scrollbarDrag=function(){var a=this,b=0,c=a._scrollPosition,d=a._currentPosition,e=a._edgePosition;if(a._isHorizontalScroll){if(e&&e.isBeyondEdge){var f=e.startEdgePosition.x,g=e.endEdgePosition.x,h=d.x<f,i=d.x>g;if(h||i)return;a._oldPosition.x<f&&(a._oldPosition.x=f),a._oldPosition.x>g&&(a._oldPosition.x=g)}var j=d.x-a._oldPosition.x;b=c+j}else{if(e&&e.isBeyondEdge){var k=e.startEdgePosition.y,l=e.endEdgePosition.y,h=d.y<k,i=d.y>l;if(h||i)return}a._oldPosition.y<k&&(a._oldPosition.y=k),a._oldPosition.y>l&&(a._oldPosition.y=l);var m=d.y-a._oldPosition.y;b=c+m}b!==c&&(a._scrollEventType=5,a.scrollTo(b,!1))},q.prototype.scrollTo=function(a,c,d){{var e=this,f=z,g=e._scrollSize-e._scrollbarSize,h=e._scrollPosition;b.ScrollOrientation}e._isHorizontalScroll&&(f=x);var i=!1;if(a>g&&(a=g,i=!0),0>a&&(a=0,i=!0),e._edgePosition&&(e._edgePosition.isBeyondEdge=i),h!==a){var j=Math.round(a/e._scrollUnit)+e._minimum,k=e._value;if(Math.abs(j-k)>=1){if(!d){var l={newValue:j,oldValue:k,scrollOrientation:e._isHorizontalScroll?0:1,scrollEventType:e._scrollEventType};$(e._scrollContainerDiv).trigger(M,l),j=l.newValue}e._value=j,5!==e._scrollEventType&&(a=(j-e._minimum)*e._scrollUnit)
}if(e._scrollPosition=a,c){var m={};m[f]=a,$(e._scrollbarDiv).animate(m,{duration:250,esaing:"linear",queue:!1,disabled:!1})}else $(e._scrollbarDiv).css(f,a)}},q}();b.Scrollbar=Q}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(b){b.feature("core.basecelltype",["core.common","core.globalize","core.theme"]);var c=window.document,d="position",e="absolute",f="margin",g="font",h="class",i="left",j="right",k="top",l="alphabetic",m="center",n="gcUIElement",o="none",p="0",q="#9fa9c5",r="#f6fafb",s="#d2dbeb",t=".gcEditingInput",u="keydown"+t,v="keyup"+t,w="paste"+t,x="mousedown"+t,y="compositionstart"+t,z="compositionupdate"+t,A="compositionend"+t,B="width",C="height",D="padding",E="padding-left",F="padding-right",G="padding-top",H="padding-bottom",I="text-align",J="hidden",K="visibility",L="word-wrap",M="overflow",N="normal",O="break-word",P="overflow-y",Q="resize",R="border",S="outline",T="box-shadow",U="box-sizing",V="autocomplete",W="color",X="border-width",Y="background-color",Z="z-index",_="text-decoration",ab="ime-mode",bb="overline",cb="line-through",db="underline",eb="undefined",fb=void 0,gb=null,hb=Math.floor,ib=Math.ceil,jb=Math.min,kb=Math.max;!function(a){a[a.BaseCellType=0]="BaseCellType",a[a.TextCellType=1]="TextCellType",a[a.ColumnHeaderCellType=2]="ColumnHeaderCellType",a[a.RowHeaderCellType=3]="RowHeaderCellType",a[a.CornerCellType=4]="CornerCellType",a[a.CheckBoxCellType=5]="CheckBoxCellType",a[a.ButtonCellType=6]="ButtonCellType",a[a.ComboBoxCellType=7]="ComboBoxCellType",a[a.HyperLinkCellType=8]="HyperLinkCellType"}(b.CellTypeKind||(b.CellTypeKind={}));var lb=(b.CellTypeKind,function(){function a(){}return a._getAutoFitWidth=function(a,c,d,e,f){var g=0;if("string"==typeof d&&""!==d){if(e.wordWrap){var h=0,i=e.textIndent;i>0&&(h=8*i);for(var j=d.split(/\r\n|\r|\n/),k=0;k<j.length;k++)g=kb(g,b._WordWrapHelper._measureTextWithoutEndSpaces(j[k],e.font)/a._zoomFactor)}else g=a._getStringWidthByCanvas(d,e.font)/a._zoomFactor;if(1!==e.hAlign&&e.textIndent>0&&(g+=8*e.textIndent/a._zoomFactor),f){var l=jb(a._zoomFactor,1),m=parseInt((a.defaults.rowHeight*l).toString(),10);g+=m}}return g},a._getAutoFitHeight=function(a,c,d,e,f){var g=0;if("string"==typeof d&&""!==d){var h=a._getFontHeight(e.font)/a._zoomFactor;if(e.wordWrap){var i=0,j=e.textIndent;j>0&&(i=8*j);var k=b._WordWrapHelper._getWrapInfo(d,f-3-i,e.font);g=k.length*h}else g=h}return g},a.paintBackground=function(a,b,c,d,e,f,g,h,i){if(f||g){if(a.save(),a.beginPath(),f&&(a.fillStyle!==f&&(a.fillStyle=f),a.fillRect(b,c,d,e)),g&&g!==o&&i)try{if(i.getState(g)){var j=i.getImage(g),k=j.width,l=j.height,m=0,n=0,p=k,q=l,r=d,s=e,t=b,u=c;switch(h){case 0:break;case 1:p=d>=k?k:d,q=e>=l?l:e,t=d>k&&k>0?b+d/2-k/2:b,u=e>l&&l>0?c+e/2-l/2:c,r=p,s=q;break;case 2:e>0&&l>0&&d/e>k/l?(r=k/l*e,t=b+d/2-r/2):d>0&&k>0&&e/d>l/k&&(s=l/k*d,u=c+e/2-s/2);break;case 3:p=d>=k?k:d,q=e>=l?l:e,r=p,s=q}a.drawImage(j,m,n,p,q,t,u,r,s)}else i.addImage(g)}catch(v){}a.restore()}},a.paintConditionalFormats=function(a,c,d,e,f,g,h,i){var j=i.conditionalFormats;if(j&&!(j.count()<=0)){var k=i.sheet,l=i.row,m=i.col,n=j.getRules(l,m),o=n.length;if(0>=o)return!1;a.save(),a.beginPath();var p=!1,q=!1,r=gb,s=gb,t=gb,u=gb;n.sort(function(a,b){return a.priority()-b.priority()});for(var v=0;o>v&&(t=n[v],!(t&&(!r&&t instanceof b.DataBarRule?r=t:!s&&t instanceof b.IconSetRule&&(s=t),t.stopIfTrue()&&(u=t.evaluate(k,l,m,c)))));v++);return r&&(u=r.evaluate(k,l,m,c),u&&(r._paintDataBar(a,u,d,e,f,g),p=u.showBarOnly)),s&&(u=s.evaluate(k,l,m,c),u&&((16>f||16>g)&&(a.rect(d,e,f,g),a.clip(),a.beginPath()),s._paintIconSet(a,u,d,e,f,g,h,i.imageLoader),q=u.showIconOnly)),a.restore(),p||q}},a.paintSparkline=function(a,b,c,d,e,f){f&&f.paintSparkline(a,b,c,d,e)},a.paintSparklineEx=function(a,c,d,e,f,g,h){if(b.features.sparklineEx&&c instanceof b.SparklineExValue){var i=h&&h.parent;if(i){var j=i.getSparklineEx(c.name);if(j)return j._paintSparkline(a,c.value,d,e,f,g,h),!0}}return!1},a}());b.CellTypeContext=lb;var mb=function(){function a(){this.allowOverflow=!1}return a.prototype.paintValue=function(a,c,d,e,f,g,h,k){var n,o={value:gb};if(n=this.format(c,h.formatter||h._autoFormatter,o)){a.save(),a.beginPath();var p=h.foreColor,q=h.font;o.value&&(p=o.value),p&&a.fillStyle!==p&&(a.fillStyle=p),q&&a.font!==q&&(a.font=q);var r=0,s=h.textIndent,t=h.wordWrap,u=h.hAlign,v=h.vAlign,w=h.textDecoration,x=i,y=l,z=2,A=2,B=0,C=k.lineHeight,D=[],E=0,F=k.fontInfo.fontSize;s>0&&(r=8*s),3===u&&(u=b.util.getHAlignByValueType(u,c)),z+=r,1===u?(z=f/2,x=m):2===u&&(z=f-1-2,z-=r,x=j),a.textAlign!==x&&(a.textAlign=x),t&&(D=b._WordWrapHelper._getWrapInfo(n,f-3-r,q),E=D.length,E>1&&0!==v&&(B=(E-1)*C));var G=F>8?hb((F-8)/5+2):1,H=C/2-F/2+G;A+=C-H,1===v?A=(g-B)/2+C/2-H:2===v&&(A=g-B-2-H),a.textBaseline!==y&&(a.textBaseline=y);var I={x:d,y:e,width:f-1,height:g},J=k.cellOverflowLayout,K=J&&J.layout;if(K&&(I={x:K.x,y:K.y,width:K.width,height:K.height}),t){a.rect(I.x,I.y,I.width,I.height),a.clip(),a.beginPath();for(var L=e+A,M=0;E>M;M++){if(a.fillText(D[M],d+z,L),w){var N=a.measureText(D[M]).width;this._renderTextDecoration(a,w,d+z,L,N,F,G)}L+=C}}else{var O=a.measureText(n).width,P=I.width,Q=I.height,R=O>P||C>Q;if(!R)if(1===u){if(J){var S=O/2;(S>J.backgroundLeftWidth||S>J.backgroundRightWidth)&&(R=!0)}}else O+r>P&&(R=!0);R&&(a.rect(I.x,I.y,P,Q),a.clip(),a.beginPath()),a.fillText(n,d+z,e+A),w&&this._renderTextDecoration(a,w,d+z,e+A,O,F,G)}a.restore()}},a.prototype.paint=function(){},a.prototype.createEditorElement=function(){return gb},a.prototype._getLocator=function(){var a=c.createElement("span");return $(a).css(d,e).css(K,J).css(Y,"#68E").css(f,p).css(D,"2px").css(g,"normal 12px Arial").css(W,"white").css(X,p).attr(h,"gc-input-locator").attr(n,"gcEditingLocator"),a},a.prototype.getEditorValue=function(){return gb},a.prototype._formatEditorValue=function(a,b,c){return c},a.prototype.setEditorValue=function(){},a.prototype.getEditingElement=function(){return gb},a.prototype.parse=function(a,c){var d=typeof c===eb||c===gb,e=typeof a===eb||a===gb;if(d||e)return e?"":a.toString();try{if(b.features.formatter){var f="string"==typeof c?new b.GeneralFormatter(c):c;return f.Parse(a)}return a.toString()}catch(g){return a.toString()}},a.prototype.format=function(a,c,d){if(a===fb||a===gb||""===a)return"";if(!c)return"boolean"==typeof a||a instanceof Boolean?a.toString().toUpperCase():a instanceof Date?new b._DateTimeHelper(a).localeFormat("d-MMM-yy"):a.toString();try{if(b.features.formatter){var e=gb;return e="string"==typeof c?new b.GeneralFormatter(c):c,e.Format(a,d)}return a.toString()}catch(f){return a.toString()}},a.prototype.focus=function(a){a&&a.focus&&a.focus()},a.prototype.getThemeStyle=function(a){return b.Global.prototype.getWijmoThemeStyle(a)},a.prototype.activateEditor=function(){},a.prototype.deactivateEditor=function(){},a.prototype.selectAll=function(a){a&&a.select&&a.select()},a.prototype.updateEditor=function(){},a.prototype.setImeMode=function(a,b,c){this.isImeAware(c)?this.updateImeMode(a,b,c):a&&$(a).css(ab,this._getImeModeString(0))},a.prototype.updateImeMode=function(a,b){a&&$(a).css(ab,this._getImeModeString(b))},a.prototype._getImeModeString=function(a){var b="";switch(a===fb&&(a=1),a){case 1:b="auto";break;case 2:b="active";break;case 4:b="inactive";break;case 0:b="disabled"}return b},a.prototype._updateEditorLocator=function(a,b){var c=a&&b&&b.sheet;if(c&&c.isEditing()&&c.showEditingLocator){var d=a._editingLocator,e=$(a);d&&$(d).css(k,parseInt(e.css(k),10)-18).css(i,parseInt(e.css(i),10))}},a.prototype.getHitInfo=function(){return gb},a.prototype.processMouseDown=function(){return!1},a.prototype.processMouseMove=function(){return!1},a.prototype.processMouseUp=function(){return!1},a.prototype.processMouseEnter=function(){},a.prototype.processMouseLeave=function(){},a.prototype.isReservedKey=function(){return!1},a.prototype.isEditingValueChanged=function(a,b){return a!==b},a.prototype.processKeyDown=function(){return!1},a.prototype.processKeyUp=function(){return!1},a.prototype._getAutoFitWidth=function(){return 0},a.prototype._getAutoFitHeight=function(){return 0},a.prototype._renderTextDecoration=function(a,b,c,d,e,f,g){a.strokeStyle=a.fillStyle;var h,i=0,k=0,l=.5;h=12>=f?12:f,k=hb((h-12)/21+1),a.lineWidth=k,0===(1&k)&&(l=0),a.textAlign===m?c-=e/2:a.textAlign===j&&(c-=e),a.beginPath(),4===(4&b)&&(i=ib(d+g-f-1)-l,a.moveTo(c,i),a.lineTo(c+e,i)),2===(2&b)&&(i=ib(d+g-f/2)-l,a.moveTo(c,i),a.lineTo(c+e,i)),1===(1&b)&&(i=ib(d+g-1)-l,a.moveTo(c,i),a.lineTo(c+e,i)),a.stroke()},a.prototype._setEditStatusTextDecoration=function(a,b){var c="";4===(4&b)&&(c=bb),2===(2&b)&&(c+=" "+cb),1===(1&b)&&(c+=" "+db),a.css(_,c)},a.prototype.isImeAware=function(){return!1},a.prototype.isEditting=function(){return!1},a.prototype.toJSON=function(){return{type:0}},a.prototype.fromJSON=function(){},a}();b.BaseCellType=mb;var nb=function(h){function l(){h.call(this),this.allowOverflow=!0}return __extends(l,h),l.prototype.paint=function(a,b,c,d,e,f,g,h){if(a){lb.paintBackground(a,c,d,e,f,g.backColor,g.backgroundImage,g.backgroundImageLayout,h.imageLoader);var i=lb.paintConditionalFormats(a,b,c,d,e,f,g,h);h.showBarIconOnly=i,lb.paintSparkline(a,c,d,e,f,h.sparkline);var j=lb.paintSparklineEx(a,b,c,d,e,f,h.sheet);h.cellOverflowLayout||i||j||this.paintValue(a,b,c,d,e,f,g,h)}},l.prototype.createEditorElement=function(){var a=$("<textarea></textarea>").css(f,p).css(D,"1px").css(U,"content-box").css(g,"normal 10pt Arial").css(L,"normal").css(M,J).css(Q,o).css(R,"2px #5292f7 solid").css(S,o).css(T,"1px 2px 5px rgba(0,0,0,0.4)").attr(V,"off").attr(n,"gcEditingInput"),b=c.createElement("div");return $(b).css(d,e).css(Z,"2000").append(a),b},l.prototype.getEditorValue=function(a){var b=a&&a.children[0];if(b){var c=b.value;if(c!==fb&&c!==gb&&c.length>0)return c}return gb},l.prototype.setEditorValue=function(a,b,c){var d=a&&a.children[0];if(d){var e=c&&c.sheet&&c.sheet._startEditByKeydown?!0:!1;d.value=b===gb||b===fb||e?"":b,d.selectionStart=d.selectionEnd=d.value.length}},l.prototype.focus=function(a){if(a){var b=a.children[0];this.isImeAware()&&b?(b.focus(),b.selectionStart=b.value.length):a.focus()}},l.prototype._formatEditorValue=function(a,c,d,e){var f=a&&e&&e.sheet;if(f){var g=f._activeRowIndex,h=f._activeColIndex,i=c.formatter?c.formatter:c._autoFormatter;if(b.features.formatter&&d!==gb&&d!==fb)if(i instanceof b.AutoFormatter&&i._innerFormatter instanceof b.GeneralFormatter)d=i._innerFormatter.GetPreferredEditingFormatter(d).Format(d);else if("string"==typeof i&&(i=new b.GeneralFormatter(i)),i)try{var j=i.GetFormatType(d);2===j?(i=new b.GeneralFormatter(0===d.getHours()&&0===d.getMinutes()&&0===d.getSeconds()&&0===d.getMilliseconds()?"M/d/yyyy":"M/d/yyyy hh:mm:ss"),f._editingTimeValue=!0):i=new b.GeneralFormatter("General"),d=i.Format(d)}catch(k){d=f.getText(g,h)}else d=f.getText(g,h)}return d!==gb&&d!==fb&&(d=b.util.toString(d)),d},l.prototype.activateEditor=function(a,c,d,e){var f=a&&e&&e.sheet;if(f){var g=$(a),h=f._eventHandler._getCanvasOffset(),j=f._bounds;g.css(k,h.top+j.y+d.y-2).css(i,h.left+j.x+d.x-2);var l=this,m=a.children[0];if(m){var n=$(m);l._editingElement=n.get(0),n.bind(u,function(g){var h=229===g.keyCode||0===g.keyCode;if(h||l._isImeInputing||l._updateEditorImp(a,c,d,g,e),!l._processEditingWrap(g,e)){var i=0===m.selectionStart&&37===g.keyCode&&!g.ctrlKey&&!g.shiftKey&&!g.altKey,j=m.selectionStart===m.value.length&&39===g.keyCode&&!g.ctrlKey&&!g.shiftKey&&!g.altKey,k=m.selectionStart===m.selectionEnd;k&&(i||j)&&2===f._editorStatus&&b.util.cancelDefault(g)}}),n.bind(v,function(g){(46===g.keyCode||8===g.keyCode||(90===g.keyCode||89===g.keyCode)&&g.ctrlKey&&!g.altKey)&&l._updateEditorImp(a,c,d,g,e),(13!==g.keyCode&&9!==g.keyCode||g.ctrlKey||g.altKey)&&f._trigger(b.Events.EditChange,{sheet:f,sheetName:f._name,row:f._activeRowIndex,col:f._activeColIndex,editingText:l.getEditorValue(a,e)})}),n.bind(w,function(b){l._pasteInputSizingToken=window.setTimeout(function(){l._updateEditorImp(a,c,d,b,e),l._pasteInputSizingToken&&(window.clearTimeout(l._pasteInputSizingToken),delete l._pasteInputSizingToken)},10)}),n.bind(x,function(){1===f._editorStatus&&(f._editorStatus=2,f._trigger(b.Events.EditorStatusChanged,{sheet:f,sheetName:f._name,oldStatus:1,newStatus:2}))}),n.bind(y,function(){l._isImeInputing=!0,l._oldValueBeforeImeInputting=n.val()}),n.bind(z,function(b){l._updateEditorImp(a,c,d,b?b.originalEvent:gb,e)}),n.bind(A,function(b){l._updateEditorImp(a,c,d,b?b.originalEvent:gb,e),l._isImeInputing=!1})}}},l.prototype.deactivateEditor=function(a){if(a){var b=a.children[0];b&&$(b).unbind(t);var d=a._editingLocator;d&&c.body.removeChild(d)}this._editingElement=gb},l.prototype.getEditingElement=function(){return this._editingElement},l.prototype.selectAll=function(a){var b=a&&a.children[0];b&&b.select&&b.select()},l.prototype._updateEditorImp=function(a,c,d,e,f){var h=a&&a.children[0],k=f&&f.sheet;if(h&&k){var l=this,n=$(h),o=k._render;if(k.isEditing()){var p=gb,q=i,r=gb;if(c&&(p=b.util.getHAlignByValueType(c.hAlign,a._originalValue),1===p?q=m:2===p&&(q=j),n.css(I,q),c.backColor&&n.css(Y,c.backColor),c.foreColor&&n.css(W,c.foreColor),r=c.font||o._getDefaultFont(),r&&(k._zoomFactor>1&&(r=o._getZoomFont(r)),n.css(g,r)),c.textDecoration&&l._setEditStatusTextDecoration(n,c.textDecoration)),d){$(a).width(d.width).height(d.height);var s=k._getSheetLayout(),t=1,u=1;t=t+parseInt(n.css(E),10)+parseInt(n.css(F),10),u=u+parseInt(n.css(G),10)+parseInt(n.css(H),10);var v=d.width;d.x+d.width>s.width&&(v=s.width-d.x),n.css(B,v-t).css(C,d.height-u),p===fb||p===gb||0===p?h.maxWidth=s.width-d.x-t:1===p?h.maxWidth=2*kb(0,jb(s.width-d.x-d.width-t,d.x-s.rowHeaderWidth-t))+d.width:2===p&&(h.maxWidth=d.x+d.width-s.rowHeaderWidth-t),h.maxHeight=s.height-d.y-u,h.minWidth=parseInt(h.style.width,10),h.minHeight=parseInt(h.style.height,10)}var w=h.value;r=h.style.font,r||(r=o._getZoomFont(o._getDefaultFont()));var x=k._getFontHeight(r);if(e){if(k._eventHandler.allowEnterEditing(e)){var y=h.selectionStart,z=w.substr(0,y),A=w.substr(y,w.length-y);w=z+String.fromCharCode(e.keyCode)+A}l._isImeInputing&&(w=$.browser.msie?n.val():l._oldValueBeforeImeInputting+e.data)}var D=[];D=c&&c.wordWrap?b._WordWrapHelper._getWrapInfo(w,n.width(),r):w.split(/\r\n|\r|\n/);var K,Q,R,S=D.length;if(h.minWidth=jb(h.minWidth,h.maxWidth),h.minHeight=jb(h.minHeight,h.maxHeight),c&&c.wordWrap||S>0){var T=S*x;if(c&&c.wordWrap)n.css(L,O).css(M,J);else{var U=0,V=[];for(K=0;S>K;K++){var X=D[K];Q=k._getStringWidth(X,r),V.push(Q),U=kb(U,Q)}if(U<=h.minWidth)n.css(B,h.minWidth).css(L,N).css(M,J);else if(U>h.minWidth&&U<=h.maxWidth)n.css(B,U).css(L,N).css(M,J);else if(U>h.maxWidth)for(n.css(B,h.maxWidth).css(L,O).css(M,J),T=0,K=0;K<V.length;K++)Q=V[K],Q<=h.maxWidth?T+=x:Q>h.maxWidth&&(R=ib(Q/h.maxWidth),T+=x*R)}T<=h.minHeight?n.css(C,h.minHeight):T>h.minHeight&&T<=h.maxHeight?n.css(C,T):T>h.maxHeight&&n.css(C,h.maxHeight).css(P,"scroll")}else{var v=k._getStringWidth(w,r);if(v>h.minWidth&&v<=h.maxWidth)n.css(B,v).css(C,h.minHeight).css(L,N).css(M,J);else if(v<=h.minWidth)n.css(B,h.minWidth).css(C,h.minHeight).css(L,N).css(M,J);else if(v>h.maxWidth){n.css(B,h.maxWidth).css(L,O),R=ib(v/h.maxWidth);var Z=x*R;Z<=h.minHeight?n.css(C,h.minHeight).css(M,J):Z<=h.maxHeight?n.css(C,Z).css(M,J):Z>h.maxHeight&&n.css(C,h.maxHeight).css(P,"scroll")}}p=n.css(I);var _=n.width()-h.minWidth;p!==fb&&p!==gb&&p!==i&&(p===m?n.css(i,h.originalLeft-_/2):p===j&&n.css(i,h.originalLeft-_)),l._updateEditorLocator(a,f)}}},l.prototype.updateEditor=function(a,b,c,d){var e=d&&d.sheet;if(e&&c){var f=e._eventHandler._getCanvasOffset(),g=e._bounds;$(a).css(k,f.top+g.y+c.y-2).css(i,f.left+g.x+c.x-2)}if(this._updateEditorImp(a,b,c,gb,d),$.browser.msie){var h=$(a.children[0]),j=h.width();h.width(j+1).width(j)}},l.prototype.updateImeMode=function(a,b){if(this.isImeAware()){var c=a&&a.children[0];c&&$(c).css(ab,this._getImeModeString(b))}},l.prototype.isReservedKey=function(a,b){var c=a.srcElement||a.target;return c&&b&&b.isEditing&&"gcEditingInput"===c.getAttribute(n)?13===a.keyCode&&(a.ctrlKey&&!a.shiftKey||a.altKey)||90===a.keyCode&&a.ctrlKey&&!a.altKey||89===a.keyCode&&a.ctrlKey&&!a.altKey:!1},l.prototype._processEditingWrap=function(c,d){var e=c.srcElement||c.target;if(e&&"gcEditingInput"===e.getAttribute(n)&&13===c.keyCode&&(c.ctrlKey||c.altKey)){var f=e.selectionStart,g=e.value,h=g.substr(0,f),i=g.substr(f,g.length-f);e.value=h+"\n"+i,e.selectionStart=f+1,e.selectionEnd=f+1;var j=window.gcGlobal.activeElement,k=a.spread;if(j instanceof k.Sheet){var l=j.getCellType(j._activeRowIndex,j._activeColIndex);l&&l.updateEditor(j._editor,gb,gb,d)}return b.util.cancelDefault(c),!0}return!1},l.prototype._getAutoFitWidth=function(a,b,c,d,e,f){return lb._getAutoFitWidth(a,b,c,d,e,f)},l.prototype._getAutoFitHeight=function(a,b,c,d,e,f){return lb._getAutoFitHeight(a,b,c,d,e,f)},l.prototype.isImeAware=function(){return!0},l.prototype.toJSON=function(){return{type:1}},l}(mb);b.TextCellType=nb;var ob=function(a){function c(){a.apply(this,arguments)}return __extends(c,a),c.prototype._paint=function(a,c,d,e,f,g,h,k,n,p){if(a){var q=this,r=gb,s=k.visualState,t=k.useWijmoTheme;if(typeof s!==eb){if(a.save(),a.beginPath(),t)try{r=q.getThemeStyle(k.visualState);var u=r&&r.backgroundColor,v=r&&r.backgroundImage;if(u)a.fillStyle=u,a.fillRect(d,e,f,g);else if(v&&v!==o){var w=new Image,x=v;x=x.replace('url("',""),x=x.replace('")',""),w.src=x,a.drawImage(w,d,e,f,g)}}catch(y){}else n&&a.fillStyle!==n&&(a.fillStyle=n),a.fillRect(d,e,f,g);a.restore()}var z=q.format(c,h.formatter);if(z){var A={x:d,y:e,width:f,height:g};a.save(),a.beginPath();var B=k.sheet,C=B.rowFilter(),D=!(!C||!C.isFilterHeader(k.row,k.col,p));if(D){var E=jb(B._zoomFactor,1),F=hb(B.defaults.rowHeight*E);f-=F}var G=h.foreColor;t&&r&&(G=r.color),G&&a.fillStyle!==G&&(a.fillStyle=G);var H=h.font;H&&a.font!==H&&(a.font=H);var I=0,J=h.textIndent;J>0&&(I=8*J);var K=h.hAlign,L=h.vAlign,M=i,N=2;N+=I,1===K?(N=f/2,M=m):2===K&&(N=f-1,N-=I,M=j),a.textAlign!==M&&(a.textAlign=M);var O=0,P=l,Q=3,R=h.wordWrap,S=k.lineHeight,T=k.fontInfo.fontSize,U=[],V=0;R&&(U=b._WordWrapHelper._getWrapInfo(z,f-3-I,H),V=U.length,V>1&&0!==L&&(O=(V-1)*S));var W=T>8?hb((T-8)/5+2):1,X=S/2-T/2+W;Q+=S-X,1===L?Q=(g-O)/2+1+S/2-X:2===L&&(Q=g-O-1-X),a.textBaseline!==P&&(a.textBaseline=P);var Y=h.textDecoration;if(h.wordWrap){a.rect(A.x,A.y,A.width,A.height),a.clip(),a.beginPath();for(var Z=e+Q,$=0;V>$;$++){if(a.fillText(U[$],d+N,Z),Y){var _=a.measureText(U[$]).width;q._renderTextDecoration(a,Y,d+N,Z,_,T,W)}Z+=k.lineHeight}}else{var ab=a.measureText(z).width;(ab>A.width||S>A.height)&&(a.rect(A.x,A.y,A.width,A.height),a.clip(),a.beginPath()),a.fillText(z,d+N,e+Q),Y&&q._renderTextDecoration(a,Y,d+N,e+Q,ab,T,W)}a.restore()}}},c.prototype._getAutoFitWidth=function(a,b,c,d,e,f){var g=lb._getAutoFitWidth(a,b,c,d,e,f);return g},c.prototype._getAutoFitHeight=function(a,b,c,d,e,f){var g=lb._getAutoFitHeight(a,b,c,d,e,f);return g},c}(mb);b.HeaderCellType=ob;var pb=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.paint=function(b,c,d,e,f,g,h,i){var j,k=b.createLinearGradient(d+f/2,e,d+f/2,e+g),l=i.visualState;0===l?h.backColor?j=h.backColor:(k.addColorStop(.125,r),k.addColorStop(1,s),j=k):1===l?(k.addColorStop(.125,"#ffd45a"),k.addColorStop(1,"#ffef72"),j=k):2===l?j=q:4===l&&(k.addColorStop(.125,"#ffe165"),k.addColorStop(1,"#fff9a3"),j=k),a.prototype._paint.call(this,b,c,d,e,f,g,h,i,j,1)},b.prototype.toJSON=function(){return{type:2}},b}(ob);b.ColumnHeaderCellType=pb;var qb=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.paint=function(b,c,d,e,f,g,h,i){var j,k=i.visualState;0===k?j=h.backColor?h.backColor:"#e4ecf7":1===k?b.fillStyle="#ffdc61":2===k?b.fillStyle=q:4===k&&(b.fillStyle="#fde47b"),a.prototype._paint.call(this,b,c,d,e,f,g,h,i,j,2)},b.prototype.toJSON=function(){return{type:3}},b}(ob);b.RowHeaderCellType=qb;var rb=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.paint=function(a,b,c,d,e,f,g,h){if(a){a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath();var i=h.visualState,j=h.useWijmoTheme;if(typeof i!==eb){if(j)try{var k=this.getThemeStyle(h.visualState),l=k&&k.backgroundColor,m=k&&k.backgroundImage;if(l)a.fillStyle=l,a.fillRect(c,d,e,f);else if(m&&m!==o){var n=new Image,p=m;p=p.replace('url("',""),p=p.replace('")',""),n.src=p,a.drawImage(n,c,d,e,f)}}catch(t){}else{var u;0===i?u="#a9c4e9":2===i?u=q:4===i&&(u="#a1b0c8"),u&&a.fillStyle!==u&&(a.fillStyle=u),a.fillRect(c,d,e,f)}var v=a.createLinearGradient(c+e/2,d,c+e/2,d+f);if(v.addColorStop(.125,r),j){var w=this.getThemeStyle(4);v.addColorStop(1,w.backgroundColor)}else v.addColorStop(1,s);a.fillStyle=v,a.beginPath();var x=3,y=f;f>e&&(y=e),a.moveTo(c+e-y+x,d+f-x),a.lineTo(c+e-x,d+f-x),a.lineTo(c+e-x,d+f-y+x),a.fill()}a.restore()}},b.prototype.toJSON=function(){return{type:4}},b.prototype._getAutoFitWidth=function(a,b,c,d,e,f){var g=lb._getAutoFitWidth(a,b,c,d,e,f);return g},b.prototype._getAutoFitHeight=function(a,b,c,d,e,f){var g=lb._getAutoFitHeight(a,b,c,d,e,f);return g},b}(mb);b.CornerCellType=rb}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("basedialog",["core.common"]);var b=function(){function b(){var a=this;a._wijpopupClass="wijspread-popup",a._overlayClass="wijspread-overlay",a._useWijmoTheme=!1,a.defaultOverlayCSS={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:999,backgroundColor:"rgba(0,0,0,0)"},a.defaultContainerCSS={position:"absolute",padding:0,margin:0,height:"auto",zIndex:1e3,outline:"none"},a._init()}return b.prototype._init=function(){var a=this;a._hasTargetContainer(a._name)?a.container=$("#"+a._name):(a._name=a._generateName(),a.container=$("<div></div>").addClass(a._wijpopupClass).attr({id:a._name,tabIndex:-1}).css(a.defaultContainerCSS))},b.prototype._generateName=function(){for(var a=0,b="dialog";this._hasTargetContainer(b+a);)a++;return b+a},b.prototype.useWijmoTheme=function(a){var b=this;return"undefined"==typeof a?b._useWijmoTheme:"boolean"==typeof a&&b._useWijmoTheme!==a?(b._useWijmoTheme=a,a?b.container.addClass("ui-widget ui-widget-content"):b.container.removeClass("ui-widget ui-widget-content"),b):null},b.prototype.getContainer=function(){return this.container?this.container:void 0},b.prototype.show=function(a,b,c){var d=this,e=arguments.length,f=d.container;d._hasOverlay()||d._createOverlay(),window.gcGlobal.suspendEvent(),d._hasTargetContainer(d._name)||($(document.body).append(f),d.resetDialogPosition(),f.css("display","none")),3===e?"slide"===b?f.slideDown(a,c):"fade"===b?f.fadeIn(a,c):f.show(a,c):2===e?"slide"===b?f.slideDown(a):"fade"===b?f.fadeIn(a):f.show(a):1===e?f.show(a):f.show()},b.prototype.close=function(){var a=this;a._hasTargetContainer(a._name)&&a.container.remove(),$("."+a._wijpopupClass).is(":visible")||a.closeOverlay(),window.gcGlobal.resumeEvent()},b.prototype.closeOverlay=function(){$("."+this._overlayClass).remove()},b.prototype.resetDialogPosition=function(){var a=this.container;if(0!==a.length){var b=parseInt(a.css("left")),c=parseInt(a.css("top")),d=a.width(),e=a.height();if(!(isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e))){var f=0,g=0,h=document.documentElement.clientWidth,i=document.documentElement.clientHeight,j=a.get(0).getBoundingClientRect();j.left+d>h&&(g=j.left+d-h),j.top+e>i&&(f=j.top+e-i),(0>b||0>c||f>0||g>0)&&(b-=g,c-=f,0>b&&(b=0),0>c&&(c=0),a.css({left:b,top:c}))}}},b.prototype._hasTargetContainer=function(a){return $("#"+a).length?!0:!1},b.prototype._createOverlay=function(){var b=this,c=$("<div></div>").addClass(b._overlayClass);c.css(b.defaultOverlayCSS),$(document.body).append(c);var d="mousedown touchstart touchend touchmove";c.bind(d,function(c){b.close(),a.util.cancelDefault(c)})},b.prototype._hasOverlay=function(){return $("."+this._overlayClass).length>0?!0:!1},b}();a.BaseDialog=b}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(b){b.feature("core.sheet_model",["core.common","core.stringResource"]);var c=null,d=void 0,e=Math.min,f=Math.floor,g=function(a){function f(){a.call(this)}return __extends(f,a),f.prototype.find=function(a,b){for(var d,e=this.length,f=0;e>f;f++)if(d=this[f],d&&d.contains(a,b))return d;return c},f.prototype.remove=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return void this.splice(b,1)},f.prototype.copy=function(a,c,d,e,f,g){var h,i,j,k,l=this,m=!1,n=l.length;if(-1===a){for(k=[],j=0;n>j;j++)h=l[j],c<=h.col&&h.col<c+g?(k.push(new b.Range(h.row,e+h.col-c,h.rowCount,h.colCount)),m=!0):e<=h.col&&h.col<e+g&&(l.splice(j,1),j--,n--,m=!0);for(j=0;j<k.length;j++){if(i=k[j],!l.isValid(l,0,l.length,i))throw new Error(b.SR.Exp_OverlappingSpans);l.push(i)}}else if(-1===c){for(k=[],j=0;n>j;j++)h=l[j],a<=h.row&&h.row<a+f?(k.push(new b.Range(d+h.row-a,h.col,h.rowCount,h.colCount)),m=!0):d<=h.row&&h.row<d+f&&(l.splice(j,1),j--,n--,m=!0);for(j=0;j<k.length;j++){if(i=k[j],!l.isValid(l,0,l.length,i))throw new Error(b.SR.Exp_OverlappingSpans);l.push(i)}}else{for(k=[],j=0;n>j;j++)h=l[j],a<=h.row&&h.row<a+f&&c<=h.col&&h.col<c+g?(k.push(new b.Range(d+h.row-a,e+h.col-c,h.rowCount,h.colCount)),m=!0):d<=h.row&&h.row<d+f&&e<=h.col&&h.col<e+g&&(l.splice(j,1),j--,n--,m=!0);for(j=0;j<k.length;j++){if(i=k[j],!l.isValid(l,0,l.length,i))throw new Error(b.SR.Exp_OverlappingSpans);l.push(i)}}},f.prototype.isValid=function(a,b,c,d){for(var e=b;c>e&&e<a.length;e++){var f=a[e];if(f.intersect(d.row,d.col,d.rowCount,d.colCount))return!1}return!0},f.prototype.getEnumerator=function(a,b,c,d){return new h(this,a,b,c,d)},f.prototype.clear=function(a,b,c,d){for(var e=0;e<this.length;e++){var f=this[e];(-1===a||a<=f.row&&f.row<a+c)&&(-1===b||b<=f.col&&f.col<b+d)&&this.splice(e--,1)}},f.prototype.move=function(a,c,d,e,g,h){var i,j,k,l=this,m=!1,n=new f,o=[],p=l.length;if(-1===a)for(j=0;p>j;j++)i=l[j],c<=i.col&&i.col<c+h?(k=new b.Range(i.row,e+i.col-c,i.rowCount,i.colCount),o.push(k),m=!0):e<i.col&&i.col<e+h?m=!0:n.push(i);else if(-1===c)for(j=0;p>j;j++)i=l[j],a<=i.row&&i.row<a+g?(k=new b.Range(d+i.row-a,i.col,i.rowCount,i.colCount),o.push(k),m=!0):d<=i.row&&i.row<d+g?m=!0:n.push(i);else for(j=0;p>j;j++)i=l[j],a<=i.row&&i.row<a+g&&c<=i.col&&i.col<c+h?(k=new b.Range(d+i.row-a,e+i.col-c,i.rowCount,i.colCount),o.push(k),m=!0):d<=i.row&&i.row<d+g&&e<=i.col&&i.col<e+h?m=!0:n.push(i);if(m){if(o.length>0)for(j=0;j<o.length;j++){if(k=o[j],!l.isValid(n,0,n.length,k))throw new Error(b.SR.Exp_OverlappingSpans);n.push(k)}for(l.length=0,j=0;j<n.length;j++)l.push(n[j])}},f.prototype.isEmpty=function(){return this.length<=0?!0:!1},f.prototype.addRows=function(a,c){for(var d=this,e=!1,f=d.length,g=0;f>g;g++){var h=d[g];h.row>=a?(d[g]=new b.Range(h.row+c,h.col,h.rowCount,h.colCount),e=!0):h.row<a&&a<h.row+h.rowCount&&(d[g]=new b.Range(h.row,h.col,h.rowCount+c,h.colCount),e=!0)}},f.prototype.addColumns=function(a,c){for(var d=this,e=!1,f=d.length,g=0;f>g;g++){var h=d[g];h.col>=a?(d[g]=new b.Range(h.row,h.col+c,h.rowCount,h.colCount),e=!0):h.col<a&&a<h.col+h.colCount&&(d[g]=new b.Range(h.row,h.col,h.rowCount,h.colCount+c),e=!0)}},f.prototype.removeRows=function(a,c){var d,f=this,g=!1,h=[],i=f.length;for(d=0;i>d;d++){var j=f[d];j.row>=a?j.row<a+c?(h.push(d),g=!0):(f[d]=new b.Range(j.row-c,j.col,j.rowCount,j.colCount),g=!0):j.row<a&&a<j.row+j.rowCount&&(f[d]=new b.Range(j.row,j.col,j.rowCount-e(j.row+j.rowCount-a,c),j.colCount),1===f[d].rowCount&&1===f[d].colCount&&h.push(d),g=!0)}for(d=0;d<h.length;d++){var k=h[d];f.splice(k,1)}},f.prototype.removeColumns=function(a,c){var d,f=this,g=!1,h=[],i=f.length;for(d=0;i>d;d++){var j=f[d];j.col>=a?j.col<a+c?(h.push(d),g=!0):(f[d]=new b.Range(j.row,j.col-c,j.rowCount,j.colCount),g=!0):j.col<a&&a<j.col+j.colCount&&(f[d]=new b.Range(j.row,j.col,j.rowCount,j.colCount-e(j.col+j.colCount-a,c)),1===f[d].rowCount&&1===f[d].colCount&&h.push(d),g=!0)}for(d=0;d<h.length;d++){var k=h[d];f.splice(k,1)}},f.prototype.toJSON=function(){for(var a=[],b=0;b<this.length;b++)a.push(this[b]);return 0===a.length?d:a},f.prototype.fromJSON=function(a){if(a)for(var c=a,d=0;d<c.length;d++){var e=c[d];this.push(new b.Range(e.row,e.col,e.rowCount,e.colCount))}},f}(b._XArray);b._SpanModel=g;var h=function(){function a(a,b,c,d,e){var f=this;f.model=a,f.row=b,f.column=c,f.rowCount=d,f.columnCount=e,f.currentIndex=-1,-1===b&&-1===c&&(f.all=!0)}return a.prototype.current=function(){var a=this;return 0<=a.currentIndex&&a.currentIndex<a.model.length?a.model[a.currentIndex]:c},a.prototype.moveNext=function(){var a=this;if(a.currentIndex++,!a.all)for(;a.currentIndex<a.model.length&&!a.model[a.currentIndex].intersect(a.row,a.column,a.rowCount,a.columnCount);)a.currentIndex++;return a.currentIndex<a.model.length},a.prototype.reset=function(){this.currentIndex=-1},a}();b._SpanEnumerator=h;var i=function(a){function b(){a.call(this),this.headingOverflowlayout=c,this.trailingOverflowLayout=c}return __extends(b,a),b.prototype.find=function(a){var b,d=this,e=d.length;if(e>0)for(var f=0;e>f;f++)if(b=d[f],b.contains(a))return b;return c},b}(b._XArray);b._CellOverflowLayoutModel=i;var j=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.column=a,i.startColumn=b,i.endColumn=c,i.valueWidth=d,i.columnWidth=e,i.backgroundWidth=f,i.backgroundLeftWidth=g,i.backgroundRightWidth=h}return a.prototype.contains=function(a){return a>=this.startColumn&&a<=this.endColumn},a}();b._CellOverflowLayout=j;var k=function(a){function f(){a.call(this),this.selectionPolicy=2,this.selectionUnit=0}return __extends(f,a),f.prototype.find=function(a,b){var d,e=this,f=e.length;if(f>0)for(var g=0;f>g;g++)if(d=e[g],d.contains(a,b))return d;return c},f.prototype.clear=function(){this.splice(0,this.length),this.activeSelectedRangeIndex=-1},f.prototype.add=function(a,c,d,f){var g=this;0===g.selectionPolicy?(d=e(d,1),f=e(f,1),g.clear()):1===g.selectionPolicy&&g.clear(),1===g.selectionUnit?(c=-1,f=-1):2===g.selectionUnit&&(a=-1,d=-1);var h=new b.Range(a,c,d,f);g.push(h),g.activeSelectedRangeIndex=g.length-1},f.prototype.toArray=function(){for(var a=[],b=0;b<this.length;b++)a.push(this[b]);return a},f.prototype._isDefaultValue=function(a,b){var c=this;switch(a){case"selectionPolicy":return 2===b;case"selectionUnit":return 0===b;case"activeSelectedRangeIndex":return 0===b;case"0":var d=b;return 1===c.length&&0===d.row&&0===d.col&&1===d.rowCount&&1===d.colCount;case"length":return 1===b;default:return!1}},f.prototype.toJSON=function(){var a=this,b={};for(var c in a)!a._isDefaultValue(c,a[c])&&a.hasOwnProperty(c)&&(b[c]=a[c]);return $.isEmptyObject(b)?d:b},f.prototype.fromJSON=function(a){if(a){var c=this,e=a,f=a.length;f===d&&(f=1);for(var g=0;f>g;g++){var h=e[g];h===d&&(h={row:0,col:0,rowCount:1,colCount:1}),c.push(new b.Range(h.row,h.col,h.rowCount,h.colCount))}var i=a.activeSelectedRangeIndex;i===d&&(i=0),c.activeSelectedRangeIndex=i,a.selectionPolicy!==d&&(c.selectionPolicy=a.selectionPolicy),a.selectionUnit!==d&&(c.selectionUnit=a.selectionUnit)}},f}(b._XArray);b._SelectionModel=k;var l=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.findCell=function(a,b){var d,e=this,f=e.length;if(f>0)for(var g=0;f>g;g++)if(d=e[g],d.contains(a,b))return d;return c},b.prototype.findRow=function(a){var b,d=this,e=d.length;if(e>0)for(var f=0;e>f;f++)if(b=d[f],b.row===a)return b;return c},b.prototype.findCol=function(a){var b,d=this,e=d.length;if(e>0)for(var f=0;e>f;f++)if(b=d[f],b.col===a)return b;return c},b.prototype.findX=function(a){var b,d=this,e=d.length;if(e>0)for(var f=0;e>f;f++)if(b=d[f],b.containsX(a))return b;return c},b.prototype.findY=function(a){var b,d=this,e=d.length;if(e>0)for(var f=0;e>f;f++)if(b=d[f],b.containsY(a))return b;
return c},b.prototype.findNearX=function(a){var b=c,d=this,e=d.length;return e>0&&(b=d.findX(a),b||(b=a<d[0].x?d[0]:d[e-1])),b},b.prototype.findNearY=function(a){var b=c,d=this,e=d.length;return e>0&&(b=d.findY(a),b||(b=a<d[0].y?d[0]:d[e-1])),b},b}(b._XArray);b._LayoutModel=l;var m=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.rowCount=g,i.colCount=h,i.row=a,i.col=b,i.x=c,i.y=d,i.width=e,i.height=f}return a.prototype.contains=function(a,b){var c=this;return a<c.row+c.rowCount&&c.row<=a&&b<c.col+c.colCount&&c.col<=b},a.prototype.intersect=function(a){var b=this;return(b.x<0||a.x<b.x+b.width&&b.x<a.x+a.width)&&(b.y<0||a.y<b.y+b.height&&b.y<a.y+a.height)},a.prototype.containsX=function(a){return this.x<=a&&a<this.x+this.width},a.prototype.containsY=function(a){return this.y<=a&&a<this.y+this.height},a}();b._Layout=m;var n=function(){function e(a,b,e){this._defaultRowCount=200,this._defaultColCount=20,this._isSuspendDirty=!1;var f=this;f.rowCount=a!==c&&a!==d?a:f._defaultRowCount,f.colCount=b!==c&&b!==d?b:f._defaultColCount,f.name=e,f.dataTable={},f._rowDataArray=[],f._columnDataArray=[],f._defaultDataNode=c,f.dirtyNodes={}}return e.prototype.getRowCount=function(){return this.rowCount},e.prototype.getColumnCount=function(){return this.colCount},e.prototype._updateDirty=function(a,b){if(!this._isSuspendDirty&&a>=0&&b>=0){var c=this.dataTable[a];"n"!==c.rs&&(c.rs="e"),this.dirtyNodes[a]=c}},e.prototype._suspendDirty=function(){this._isSuspendDirty=!0},e.prototype._resumeDirty=function(){this._isSuspendDirty=!1},e.prototype.getValue=function(a,b){var e=this.getNode(a,b);return e&&e.value!==d&&e.value!==c?e.value:c},e.prototype.setValue=function(a,b,c){var d=this.getNode(a,b,!0);d.value!==c&&(d.value=c,this._updateDirty(a,b))},e.prototype.getBindingPath=function(a,b){var e=this.getNode(a,b);return e&&e.bindingPath!==d&&e.bindingPath!==c?e.bindingPath:c},e.prototype.setBindingPath=function(a,b,c){var d=this.getNode(a,b,!0);d.bindingPath!==c&&(d.bindingPath=c,this._updateDirty(a,b))},e.prototype.getSparkline=function(a,b){var d=this.getNode(a,b);return d&&d.sparkline||c},e.prototype.setSparkline=function(a,b,c){var d=this.getNode(a,b,!0);d.sparkline!==c&&(d.sparkline=c,this._updateDirty(a,b))},e.prototype.setFormula=function(a,b,c,d){var e=this.getNode(a,b,!0);e.formula!==c&&(e.formula=c,this._updateDirty(a,b)),d&&(e.arrayInfo=d)},e.prototype.getFormula=function(a,b){var c=this.getNode(a,b);return c&&c.formula},e.prototype.getStyle=function(a,b){var c=this.getNode(a,b);return c&&c.style},e.prototype.setStyle=function(a,b,c){var d=this.getNode(a,b,!0);d&&d.style!==c&&(d.style=c,this._updateDirty(a,b))},e.prototype.getComment=function(a,b){var c=this.getNode(a,b);return c&&c.comment},e.prototype.setComment=function(a,b,c){var d=this.getNode(a,b,!0);d&&d.comment!==c&&(d.comment=c,this._updateDirty(a,b))},e.prototype.getVisualState=function(a,b){var c=this.getNode(a,b);return c&&c.visualState},e.prototype.setVisualState=function(a,b,c){var d=this.getNode(a,b,!0);d.visualState!==c&&(d.visualState=c,this._updateDirty(a,b))},e.prototype.addRows=function(a,b){var c=this;if(!(0>a||a>c.rowCount||0>b)){c.addElements(c.dataTable,c.rowCount,a,b),c.addElements(c._rowDataArray,c.rowCount,a,b),c.addElements(c.dirtyNodes,c.rowCount,a,b),c.rowCount+=b;for(var d=0;b>d;d++)c.dataTable[a+d]={rs:"n"},c.dirtyNodes[a+d]=c.dataTable[a+d]}},e.prototype.deleteRows=function(a,b){var c=this,d=c.rowCount;0>a||a>=d||0>=b||(a+b>d&&(b=d-a),c.deleteElements(c.dataTable,d,a,b),c.deleteElements(c._rowDataArray,d,a,b),c.deleteElements(c.dirtyNodes,d,a,b),c.rowCount-=b)},e.prototype.addElements=function(a,b,e,g){if(a&&e>=0&&b>e){var h,i,j=[];for(i=e;b>i;i++)a[i]!==d&&j.push(i);for(h=j.length,i=0;h>i;i++){var k=j[h-i-1],l=a[k];a[k]=c,a[f(k)+g]=l}}},e.prototype.deleteElements=function(a,b,e,g){if(a&&e>=0&&b>e){var h,i,j=[],k=e+g;for(i=e;b>i;i++)a[i]!==d&&(i>=e&&k>i?a[i]=c:i>=k&&j.push(i));for(h=j.length,i=0;h>i;i++){var l=j[i],m=a[l];a[l]=c,a[f(l)-g]=m}}},e.prototype.addColumns=function(a,b){var c=this;if(!(0>a||a>c.colCount||0>b)){for(var d=0;d<c.rowCount;d++){var e=c.dataTable[d];e&&a<c.colCount&&c.addElements(e,c.colCount,a,b)}c.addElements(c._columnDataArray,c.colCount,a,b),c.colCount+=b}},e.prototype.deleteColumns=function(a,b){var c=this,d=c.colCount;if(!(0>a||a>=d||0>b)){for(var e=0;e<c.rowCount;e++){var f=c.dataTable[e];f&&a<c.colCount&&c.deleteElements(f,c.colCount,a,b)}c.deleteElements(c._columnDataArray,c.colCount,a,b),a+b>d&&(b=d-a),c.colCount-=b}},e.prototype.getNode=function(a,b,d){var e=this;if(a>=e.rowCount||b>=e.colCount)return c;var f=c;if(a>=0&&b>=0){var g=e.dataTable[a];d&&!g&&(g=e.dataTable[a]={}),g&&(f=g[b],d&&!f&&(f=g[b]={}))}else-1===a&&b>=0?(f=e._columnDataArray[b],d&&!f&&(f=e._columnDataArray[b]={})):a>=0&&-1===b?(f=e._rowDataArray[a],d&&!f&&(f=e._rowDataArray[a]={})):-1===a&&-1===b&&(f=e._defaultDataNode,d&&!f&&(f=e._defaultDataNode={}));return f},e.prototype._setNode4Swap=function(a,b,c,d,e){var f=this;if(c>=0&&d>=0){var g=f.dataTable[c];g||(g=f.dataTable[c]={}),g[d]=e,e&&e.cellCalc&&delete e.cellCalc}else c>=0&&-1===d&&a>=0&&-1===b?f._rowDataArray[c]=e:d>=0&&-1===c&&b>=0&&-1===a&&(f._columnDataArray[d]=e)},e.prototype.swapNode=function(a,b,d,e){var f=this,g=f.getNode(a,b),h=f.getNode(d,e);g?f._setNode4Swap(a,b,d,e,g):h&&f._setNode4Swap(a,b,d,e,c),h?f._setNode4Swap(d,e,a,b,h):g&&f._setNode4Swap(d,e,a,b,c)},e.prototype.getDataRowIndex=function(a){return a},e.prototype.nextNonNullRow=function(a){a++;for(var b=this.rowCount,c=this.dataTable;a>=0&&b>a&&!c[a];)a++;return b>a?a:-1},e.prototype.nextNonNullColumn=function(a,b){var d=this,e=c,f=d.colCount;if(a>=0&&a<d.rowCount&&(e=d.dataTable[a]),!e)return-1;for(b++;b>=0&&f>b&&!e[b];)b++;return f>b?b:-1},e.prototype.clear=function(a,b,c,d,e,f,g){var h,i,j,k=this,l=[];if(a>=0&&b>=0){if(a+c>k.rowCount&&(c=k.rowCount-a),0>=c)return;if(b+d>k.colCount&&(d=k.colCount-b),0>=d)return;for(j=a;a+c>j;j++)if(!(f&&f.indexOf(j)>=0))for(i=b;b+d>i;i++){h=k.getNode(j,i);var m=void 0!==g&&(0==g.isProtected||1==g.isProtected&&g.getCell(j,i).locked()===!1);h&&m===!0&&l.push(h)}}else if(a>=0&&-1===b){if(a+c>k.rowCount&&(c=k.rowCount-a),0>=c)return;for(j=a;a+c>j;j++)h=k.getNode(j,-1),h&&l.push(h)}else if(-1===a&&b>=0){if(b+d>k.colCount&&(d=k.colCount-b),0>=d)return;for(i=b;b+d>i;i++)h=k.getNode(-1,i),h&&l.push(h)}else-1===a&&-1===b&&(h=k._defaultDataNode,h&&l.push(h));k.clearCore(l,e)},e.prototype.clearCore=function(a,b){for(var d=0;d<a.length;d++)a[d]&&((2&b)>0&&(a[d].style=c),(1&b)>0&&(a[d].value=c,a[d].formula=c),(16&b)>0&&(a[d].sparkline=c),(64&b)>0&&(a[d].bindingPath=c),(4&b)>0&&(a[d].comment=c))},e.prototype.toJSON=function(a){var b=this,c={};2===a?(b.rowCount!==b._defaultRowCount&&(c.rowCount=b.rowCount),1!==b.colCount&&(c.colCount=b.colCount)):1===a?(1!==b.rowCount&&(c.rowCount=b.rowCount),b.colCount!==b._defaultColCount&&(c.colCount=b.colCount)):(b.rowCount!==b._defaultRowCount&&(c.rowCount=b.rowCount),b.colCount!==b._defaultColCount&&(c.colCount=b.colCount));for(var d={},e=b.nextNonNullRow(-1);e>=0;){for(var f=d[e]={},g=b.nextNonNullColumn(e,-1);g>=0;){var h=b.getNode(e,g);h&&(f[g]=b._toJSONNode(h)),g=b.nextNonNullColumn(e,g)}e=b.nextNonNullRow(e)}$.isEmptyObject(d)||(c.dataTable=d);for(var i=[],j=b._rowDataArray,e=0;e<b.rowCount;e++)j.hasOwnProperty(e)&&j[e]&&(i[e]=b._toJSONNode(j[e]));i.length>0&&(c.rowDataArray=i);for(var k=[],l=b._columnDataArray,g=0;g<b.colCount;g++)l.hasOwnProperty(g)&&l[g]&&(k[g]=b._toJSONNode(l[g]));k.length>0&&(c.columnDataArray=k);var m=b._toJSONNode(b._defaultDataNode,a);return $.isEmptyObject(m)||(c.defaultDataNode=m),c},e.prototype.fromJSON=function(a){if(a){var b=this,c=a;this._suspendDirty(),c.name!==d&&(b.name=c.name),c.rowCount!==d&&(b.rowCount=c.rowCount),c.colCount!==d&&(b.colCount=c.colCount);var e=c.dataTable;if(e)for(var f,g,h=b.rowCount,i=b.colCount,j=0;h>j;j++)if(f=e[j])for(var k=0;i>k;k++)g=f[k],g&&b._copyFromJSONNode(j,k,g);var l=c.rowDataArray?c.rowDataArray:c._rowDataArray;if(l)for(var j=0;j<b.rowCount;j++)l.hasOwnProperty(j)&&l[j]&&b._copyFromJSONNode(j,-1,l[j]);var m=c.columnDataArray?c.columnDataArray:c._columnDataArray;if(m)for(var k=0;k<b.colCount;k++)m.hasOwnProperty(k)&&m[k]&&b._copyFromJSONNode(-1,k,m[k]);var n=c.defaultDataNode?c.defaultDataNode:c._defaultDataNode;n&&b._copyFromJSONNode(-1,-1,n),this._resumeDirty()}},e.prototype._getCellTypeKinds=function(){if(!this._dict){var b={},c=a.spread,d=c.CellTypeKind;b[d.BaseCellType]=c.BaseCellType,b[d.TextCellType]=c.TextCellType,b[d.ColumnHeaderCellType]=c.ColumnHeaderCellType,b[d.RowHeaderCellType]=c.RowHeaderCellType,b[d.CornerCellType]=c.CornerCellType,b[d.CheckBoxCellType]=c.CheckBoxCellType,b[d.ButtonCellType]=c.ButtonCellType,b[d.ComboBoxCellType]=c.ComboBoxCellType,b[d.HyperLinkCellType]=c.HyperLinkCellType,this._dict=b}return this._dict},e.prototype._saveStyle=function(a,b,c){b.backgroundImage!==d&&(a.backgroundImage=b.backgroundImage),b.backgroundImageLayout!==d&&(a.backgroundImageLayout=b.backgroundImageLayout),b.backColor!==d&&(a.backColor=b.backColor),b.font!==d&&(a.font=b.font),b.themeFont!==d&&(a.themeFont=b.themeFont),b.formatter!==d&&(a.formatter=b.formatter),b.validator!==d&&(a.validator=b.validator),b.borderLeft!==d&&(a.borderLeft=b.borderLeft),b.borderTop!==d&&(a.borderTop=b.borderTop),b.borderRight!==d&&(a.borderRight=b.borderRight),b.borderBottom!==d&&(a.borderBottom=b.borderBottom),b.locked!==d&&(a.locked=b.locked),b.textIndent!==d&&(a.textIndent=b.textIndent),b.wordWrap!==d&&(a.wordWrap=b.wordWrap),b.shrinkToFit!==d&&(a.shrinkToFit=b.shrinkToFit),b.cellType!==d&&(a.cellType=b.cellType),b.tabStop!==d&&(a.tabStop=b.tabStop),b.textDecoration!==d&&(a.textDecoration=b.textDecoration),b.name!==d&&(a.name=b.name),b.parentName!==d&&(a.parentName=b.parentName),b.foreColor!==d&&"#000000"!==b.foreColor&&(a.foreColor=b.foreColor),b.imeMode!==d&&1!==b.imeMode&&(a.imeMode=b.imeMode),2===c?(b.hAlign!==d&&1!==b.hAlign&&(a.hAlign=b.hAlign),b.vAlign!==d&&1!==b.vAlign&&(a.vAlign=b.vAlign)):1===c?(b.hAlign!==d&&1!==b.hAlign&&(a.hAlign=b.hAlign),b.vAlign!==d&&1!==b.vAlign&&(a.vAlign=b.vAlign)):(b.hAlign!==d&&3!==b.hAlign&&(a.hAlign=b.hAlign),b.vAlign!==d&&0!==b.vAlign&&(a.vAlign=b.vAlign))},e.prototype._toJSONNode=function(a,e){if(!a)return c;var f={};a.value!==d&&a.value!==c&&(f.value=a.value),a.formula!==d&&a.formula!==c&&(f.formula=a.formula,a.arrayInfo&&(f.arrayInfo=a.arrayInfo));var g=a.style;if("string"==typeof g)f.style=g;else if(g){var h={};this._saveStyle(h,g,e),$.isEmptyObject(h)||(f.style=h,g.font&&(f.style.font=b.StyleHelper.normalizeFont(g.font)))}return a.bindingPath!==d&&a.bindingPath!==c&&(f.bindingPath=a.bindingPath),f},e.prototype._copyFromJSONNode=function(e,f,g){if(g){var h=this,i=e,j=f,k=h.getNode(i,j,!0);if(h._updateDirty(i,j),g.value!==d){if(g.value!=c&&g.value._calcError){var l=b.Calc.CalcError._parseCore(g.value._calcError);l!==d&&(g.value=l)}k.value=g.value}if(g.formula!==d&&(k.formula=g.formula,g.arrayInfo&&(k.arrayInfo=g.arrayInfo)),g.style!==d){var m=c;if("string"==typeof g.style)m=g.style;else if(g.style){if(m=new b.Style,m.copyFrom(g.style),g.style.validator!==d){var n;b.features.dataValidator&&(n=new a.spread.DefaultDataValidator,n.fromJSON(g.style.validator)),m.validator=n}if(g.style.cellType!==d){var o,p=h._getCellTypeKinds(),q=p[g.style.cellType.type];q&&(o=new q,o.fromJSON(g.style.cellType)),m.cellType=o}}k.style=m}g.visualState!==d&&(k.visualState=g.visualState),g.bindingPath!==d&&(k.bindingPath=g.bindingPath)}},e}();b._GcSheetModel=n;var o=function(){function a(a,b,d){this.changed=c;var e=this;e._context=a,parseInt(b.toString(),10)<0&&(b=2147483647),e._maxLength=b,e._allowUndo=d,e._undoStack=[],e._redoStack=[]}return a.prototype.context=function(){return this._context},a.prototype.canUndo=function(){return this._undoStack.length>0},a.prototype.canRedo=function(){return this._redoStack.length>0},a.prototype._shrinkUndoStack=function(a){for(var b=0;a>b;b++)this._undoStack.shift()},a.prototype._raiseChanged=function(){var a=this;a.changed&&"function"==typeof a.changed&&a.changed(a)},a.prototype.doAction=function(a){if(!a||!a.execute)return!1;var b=this,c=!0;try{a.execute(b._context)}catch(d){c=!1}return b._allowUndo&&c&&a.canUndo()&&a.undo&&(b._maxLength>0&&b._undoStack.length>=b._maxLength&&b._shrinkUndoStack(b._undoStack.length-b._maxLength+1),b._undoStack.push(a),b._redoStack=[],b._raiseChanged()),c},a.prototype.undo=function(){var a=this,b=!0;if(a._allowUndo&&a.canUndo()){var c=a._undoStack[a._undoStack.length-1];try{c&&c.canUndo&&c.canUndo()&&c.undo&&(b=c.undo(a._context))}catch(d){b=!1}b&&(a._redoStack.push(a._undoStack.pop()),a._raiseChanged())}return b},a.prototype.redo=function(){var a=this,b=!0;if(a._allowUndo&&a.canRedo()){var c=a._redoStack[a._redoStack.length-1];try{c&&c.execute&&c.execute(a._context)}catch(d){b=!1}b&&(a._undoStack.push(a._redoStack.pop()),a._raiseChanged())}return b},a.prototype.getUndoList=function(){return this._undoStack.slice(0)},a.prototype.getRedoList=function(){return this._redoStack.slice(0)},a}();b._UndoManager=o;var p=function(a){function c(b,c,d){a.call(this,b,c,d)}return __extends(c,a),c.prototype.getExpr=function(a,b){var c=this.getNode(a,b);return c&&c.expr},c.prototype.setExpr=function(a,b,c,e,f){var g=this.getNode(a,b,!0);g.expr=c,e?g.arrayInfo=e:g.arrayInfo&&(g.arrayInfo=d),g.workingExpr=f?f:d},c.prototype.clearExpr=function(a,b){var c=this.getNode(a,b,!0);c&&(c.expr=c.workingExpr=c.arrayInfo=d)},c.prototype.CopyExpr=function(a,c,d,e,f){var g=this.getNode(c,d);if(g&&g.expr){var h=a.getNode(e,f,!0);g.arrayInfo&&(h.arrayInfo=new b.Range(e,f,g.arrayInfo.rowCount-(c-g.arrayInfo.row),g.arrayInfo.colCount-(d-g.arrayInfo.col))),h.expr=g.expr,g.workingExpr&&(h.workingExpr=g.workingExpr)}},c.prototype.getWorkingExpr=function(a,b){var c=this.getNode(a,b);return c&&(c.workingExpr||c.expr)},c.prototype.containsNoe=function(a,b){var c=this.dataTable,d=c[a];return d&&d[b]},c.prototype.clearCore=function(b,c){a.prototype.clearCore.call(this,b,c);for(var e=0;e<b.length;e++){var f=b[e];f&&(1&c)>0&&(f.arrayInfo&&(f.arrayInfo=d),f.expr&&(f.expr=d),f.workingExpr&&(f.workingExpr=d))}},c}(n);b._CalcModel=p}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(b){function c(a,b){if(a){if(2===a._editorStatus)return!1;var c=a._formulaTextBox;return c&&c.canAppendRange()?a._moveFormulaTextBoxCell(b,!1):a.moveActiveCell(b,!1),!0}return!1}function d(a,b,c,d){if(a){if(2===a._editorStatus)return!1;var e=a._formulaTextBox;return e&&e.canAppendRange()?a._moveFormulaTextBoxCell(b,!1,c,d):a.moveActiveCell(b,!1,c,d),!0}return!1}function e(a,b,c){if(a){if(2===a._editorStatus)return!1;var d=a._formulaTextBox;return d&&d.canAppendRange()?a._changeFormulaTextBoxActiveRange(b,c):(a.endEdit(),a._changeActiveSelectedRange(b,c)),!0}return!1}function f(a,b){for(var c=[],d=0,e=a._floatingObjectArray.length;e>d;d++){var f=a._floatingObjectArray[d];c.push(b&&f.isSelected()?f.name():f.name)}return c}b.feature("core.sheet_action",["core.common","core.sheet_model"]);var g=null,h=function(){function h(){}return h.navigationLeft=function(){return c(this,3)},h.navigationRight=function(){return c(this,4)},h.navigationUp=function(){return c(this,1)},h.navigationDown=function(){return c(this,2)},h.commitArrayFormula=function(){var a=this;return a.commitArrayFormula(),!0},h.commitInputNavigationDown=function(){var a=this;return a.moveActiveCell(2,!1),!0},h.commitInputNavigationUp=function(){var a=this;return a.moveActiveCell(1,!1),!0},h.navigationHome=function(){var a=this;return d(a,4,g,a.frozenColCount?a.frozenColCount-1:-1)},h.navigationHome2=function(){var a=this;return d(a,4,g,-1)},h.navigationEnd=function(){var a=this;return d(this,3,g,a.getColumnCount()-a._frozenTrailingColCount)},h.navigationEnd2=function(){var a=this;return d(a,3,g,a.getColumnCount())},h.navigationTop=function(){var a=this;return d(a,2,-1,g)},h.navigationBottom=function(){var a=this;return d(a,1,a.getRowCount(),g)},h.navigationPageUp=function(){var a=this;if(!a||2===a._editorStatus)return!1;var c=a._getPrevPageTopRow();if(c===g||c===a._scrollTopRow)return!0;var d=a._getRowLayout(1,3),e=a._getNextVisualRow(a._activeRowIndex-d.length);c>e&&(e=c);var f=a._formulaTextBox;if(f&&f.canAppendRange()){var h=a._getKeyboardAppendingInfo();h.anchorRow=e,h.leadingRow=e;var i=a._eventHandler.rangeToString(new b.Range(h.anchorRow,h.anchorCol,1,1));i&&f.appendRange(i,!1,!0)}else a.endEdit(),a._setActiveCellCore(e,g),a._leadingCellRow=e,a.moveActiveCell();return a._setTopRow(c),!0},h.navigationPageDown=function(){var a=this;if(!a||2===a._editorStatus)return!1;var c=a._getNextPageTopRow();if(c===g||c===a._scrollTopRow)return!0;var d=a._getRowLayout(1,3),e=a._getPrevVisualRow(a._activeRowIndex+d.length);c>e&&(e=c);var f=a._formulaTextBox;if(f&&f.canAppendRange()){var h=a._getKeyboardAppendingInfo();h.anchorRow=e,h.leadingRow=e;var i=a._eventHandler.rangeToString(new b.Range(h.anchorRow,h.anchorCol,1,1));i&&f.appendRange(i,!1,!0)}else a.endEdit(),a._setActiveCellCore(e,g),a._leadingCellRow=e,a.moveActiveCell();return a._setTopRow(c),!0},h.navigationNextSheet=function(){var b=this,c=b.parent,d=a.spread;if(c||c instanceof d.Spread){var e=c.getSheetCount(),f=c.getActiveSheetIndex();e-1>f&&(f++,c.setActiveSheetIndex(f),c.repaint())}},h.navigationPreviousSheet=function(){var b=this,c=b.parent,d=a.spread;if(c||c instanceof d.Spread){var e=c.getActiveSheetIndex();e>0&&(e--,c.setActiveSheetIndex(e),c.repaint())}},h.navigationPrevious=function(){},h.navigationNext=function(){},h.navigationFirst=function(){var a=this;if(!a||2===a._editorStatus)return!1;var b=a.frozenColCount?a.frozenColCount-1:-1,c=a.frozenRowCount?a.frozenRowCount-1:-1,d=a._formulaTextBox;if(d&&d.canAppendRange()){var e,f=a._eventHandler;e=d.isAppending?f._formulaRangeAppendingInfo:f._formulaRangeAppendingInfo={anchorRow:a._activeRowIndex,anchorCol:a._activeColIndex,leadingRow:a._leadingCellRow,leadingCol:a._leadingCellCol},a._moveFormulaTextBoxCell(4,!1,e.anchorRow,b),a._moveFormulaTextBoxCell(2,!1,c,e.anchorCol)}else a.moveActiveCell(4,!1,a._activeRowIndex,b),a.moveActiveCell(2,!1,c,a._activeColIndex);return!0},h.navigationLast=function(){var a=this;if(!a||2===a._editorStatus)return!1;var b=a._formulaTextBox;if(b&&b.canAppendRange()){var c,d=a._eventHandler;c=b.isAppending?d._formulaRangeAppendingInfo:d._formulaRangeAppendingInfo={anchorRow:a._activeRowIndex,anchorCol:a._activeColIndex,leadingRow:a._leadingCellRow,leadingCol:a._leadingCellCol},a._moveFormulaTextBoxCell(3,!1,c.anchorRow,a.getColumnCount()-a._frozenTrailingColCount),a._moveFormulaTextBoxCell(1,!1,a.getRowCount()-a._frozenTrailingRowCount,c.anchorCol)}else a.moveActiveCell(3,!1,a._activeRowIndex,a.getColumnCount()-a._frozenTrailingColCount),a.moveActiveCell(1,!1,a.getRowCount()-a._frozenTrailingRowCount,a._activeColIndex);return!0},h.commitInputNavigationTabNext=function(){var a=this;a._isTabNavigation=!0,a._isNavigateInSelection?a._moveActiveCellInSelection(4):a.moveActiveCell(4,!0),a._isTabNavigation=!1},h.commitInputNavigationTabPrevious=function(){var a=this;a._isTabNavigation=!0,a._isNavigateInSelection?a._moveActiveCellInSelection(3):a.moveActiveCell(3,!0),a._isTabNavigation=!1},h.cancelInput=function(){var a=this;if(a.isEditing()){var b=a.getValue(a._activeRowIndex,a._activeColIndex,3);return a.endEdit(!0),a.setValue(a._activeRowIndex,a._activeColIndex,b,3,!0),!0}var c=a.parent;if(c&&c.sheets)for(var d=c.sheets,e=0,f=d.length;f>e;e++){var g=d[e];g&&g._cutCopyIndicatorManager.cancelIndicator()}},h.clear=function(){var a=this;if(!a.isEditing()){var c=a.getSelections(),d=c.toArray(),e=new b.UndoRedo.ClearValueUndoAction(a,d);a._doCommand(e)}},h.clearAndEditing=function(){var a=this;return a.isEditing()?!1:(a.startEdit(!0,""),!0)},h.copy=function(){var a=this;a._doCopy()},h.cut=function(){var a=this;a._doCut()},h.paste=function(){var a=this;a._doPaste()},h.selectionLeft=function(){return e(this,37)},h.selectionRight=function(){return e(this,39)},h.selectionUp=function(){return e(this,38)},h.selectionDown=function(){return e(this,40)},h.selectionHome=function(){return e(this,37,!0)},h.selectionEnd=function(){return e(this,39,!0)},h.selectionPageUp=function(){return e(this,33)},h.selectionPageDown=function(){return e(this,34)},h.selectionTop=function(){return e(this,38,!0)},h.selectionBottom=function(){return e(this,40,!0)},h.selectionFirst=function(){return e(this,36,!0)},h.selectionLast=function(){return e(this,35,!0)},h.unSelectAllFloatingObjects=function(){var a=this;a._hasFloatingObjectsSelected()&&(a._suspendInvalidate(),a.unSelectAllFloatingObjects(),a._loadAndSetSheetSelections(),a._resumeInvalidate())},h.selectAllFloatingObjects=function(){var a=this;if(a._hasFloatingObjectsSelected()){a._suspendInvalidate();for(var b=0,c=a._floatingObjectArray.length;c>b;b++){var d=a._floatingObjectArray[b];d.isSelected()||d.isSelected(!0)}a._resumeInvalidate()}},h.deleteFloatingObject=function(){var a=this,c=f(a,!0);if(c.length>0){var d={names:c},e=new b.UndoRedo.DeleteFloatingObjectUndoAction(a,d);a._doCommand(e)}},h.navigationNextFloatingObject=function(){var a=this;if(a._hasFloatingObjectsSelected()){a._suspendInvalidate();var b,c,d=0;for(b=0,c=a._floatingObjectArray.length;c>b;b++){var e=a._floatingObjectArray[b];e.isSelected()&&(d=b)}a.unSelectAllFloatingObjects(),d+=1,d==a._floatingObjectArray.length&&(d=0),a._floatingObjectArray[d].isSelected(!0),a._resumeInvalidate()}},h.navigationPreviousFloatingObject=function(){var a=this;if(a._hasFloatingObjectsSelected()){a._suspendInvalidate();var b,c,d=0;for(b=0,c=a._floatingObjectArray.length;c>b;b++){var e=a._floatingObjectArray[b];e.isSelected()&&(d=b)}a.unSelectAllFloatingObjects(),d-=1,0>d&&(d=a._floatingObjectArray.length-1),a._floatingObjectArray[d].isSelected(!0),a._resumeInvalidate()}},h.clipboardCutFloatingObject=function(){var a=this;a._doFloatingObjectCut()},h.clipboardCopyFloatingObject=function(){var a=this;a._doFloatingObjectCopy()},h.clipboardPasteFloatingObject=function(){var a=this;a._doFloatingObjectPaste()},h.moveFloatingObjectUp=function(){var a,c,d=this,e=[];for(a=0,c=d._floatingObjectArray.length;c>a;a++){var f=d._floatingObjectArray[a];f.isSelected()&&e.push(f.name())}var g=new b.UndoRedo.MovingFloatingObjectUndoAction(d,{names:e},{offsetX:0,offsetY:-1});d._doCommand(g)},h.moveFloatingObjectDown=function(){var a,c,d=this,e=[];for(a=0,c=d._floatingObjectArray.length;c>a;a++){var f=d._floatingObjectArray[a];f.isSelected()&&e.push(f.name())}var g=new b.UndoRedo.MovingFloatingObjectUndoAction(d,{names:e},{offsetX:0,offsetY:1});d._doCommand(g)},h.moveFloatingObjectLeft=function(){var a,c,d=this,e=[];for(a=0,c=d._floatingObjectArray.length;c>a;a++){var f=d._floatingObjectArray[a];f.isSelected()&&e.push(f.name())}var g=new b.UndoRedo.MovingFloatingObjectUndoAction(d,{names:e},{offsetX:-1,offsetY:0});d._doCommand(g)},h.moveFloatingObjectRight=function(){var a,c,d=this,e=[];for(a=0,c=d._floatingObjectArray.length;c>a;a++){var f=d._floatingObjectArray[a];f.isSelected()&&e.push(f.name())}var g=new b.UndoRedo.MovingFloatingObjectUndoAction(d,{names:e},{offsetX:1,offsetY:0});d._doCommand(g)},h.deleteComment=function(){var a=this,c=a._commentManager.getActiveComment();if(c){var d=new b.UndoRedo.CommentDeleteUndoAction(a,c);a._doCommand(d)}},h.deactivateComment=function(){var a=this;a._commentManager.deactivateComment(),a._loadAndSetSheetSelections(),a.repaint()},h.moveCommentUp=function(){var a=this,c=a._commentManager.getActiveComment();if(c){var d=new b.UndoRedo.CommentPropertyUndoAction(a,c,c.location().clone(),new b.Point(c.location().x,c.location().y-1),"location");a._doCommand(d)}},h.moveCommentDown=function(){var a=this,c=a._commentManager.getActiveComment();if(c){var d=new b.UndoRedo.CommentPropertyUndoAction(a,c,c.location().clone(),new b.Point(c.location().x,c.location().y+1),"location");a._doCommand(d)}},h.moveCommentLeft=function(){var a=this,c=a._commentManager.getActiveComment();if(c){var d=new b.UndoRedo.CommentPropertyUndoAction(a,c,c.location().clone(),new b.Point(c.location().x-1,c.location().y),"location");a._doCommand(d)}},h.moveCommentRight=function(){var a=this,c=a._commentManager.getActiveComment();if(c){var d=new b.UndoRedo.CommentPropertyUndoAction(a,c,c.location().clone(),new b.Point(c.location().x+1,c.location().y),"location");a._doCommand(d)}},h.changeFormulaReference=function(){var a=this;if(a&&a._formulaTextBox){var b=a._eventHandler;if(b){a._suspendInvalidate();try{b.changeFormulaReference()}finally{a._resumeInvalidate()}}}},h.undo=function(){var a=this,b=a.undoManager();b.canUndo()&&b.undo()},h.redo=function(){var a=this,b=a.undoManager();b.canRedo()&&b.redo()},h}();b.SpreadActions=h}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(b){var c=null,d=void 0,e=Math.min,f=Math.max,g=Math.ceil,h=Math.floor,i=function(){function a(a,b,c){var d=this;d.row=a,d.column=b,d.value=c}return a}();b.CellData=i;var j=function(){function a(){}return a.prototype.saveDefaultStyle=function(a){this._defaultStyle=a,this._defaultStyleSaved=!0},a.prototype.getDefaultStyle=function(){return this._defaultStyle},a.prototype.saveDefaultColumnWidth=function(a){this._defaultColumnWidth=a,this._defaultColumnWidthSaved=!0},a.prototype.getDefaultColumnWidth=function(){return this._defaultColumnWidth},a.prototype.saveDefaultRowHeight=function(a){this._defaultRowHeight=a,this._defaultRowHeightSaved=!0},a.prototype.getDefaultRowHeight=function(){return this._defaultRowHeight},a.prototype.saveColumnHeaderDefaultStyle=function(a){this._columnHeaderDefaultStyle=a,this._columnHeaderDefaultStyleSaved=!0},a.prototype.getColumnHeaderDefaultStyle=function(){return this._columnHeaderDefaultStyle},a.prototype.saveColumnHeaderDefaultRowHeight=function(a){this._columnHeaderDefaultRowHeight=a,this._columnHeaderDefaultRowHeightSaved=!0},a.prototype.getColumnHeaderDefaultRowHeight=function(){return this._columnHeaderDefaultRowHeight},a.prototype.saveRowHeaderDefaultStyle=function(a){this._rowHeaderDefaultStyle=a,this._rowHeaderDefaultStyleSaved=!0},a.prototype.getRowHeaderDefaultStyle=function(){return this._rowHeaderDefaultStyle},a.prototype.saveRowHeaderDefaultColumnWidth=function(a){this._rowHeaderDefaultColumnWidth=a,this._rowHeaderDefaultColumnWidthSaved=!0},a.prototype.getRowHeaderDefaultColumnWidth=function(){return this._rowHeaderDefaultColumnWidth},a.prototype.saveCommentManager=function(a){this._commentManager=a,this._commentManagerSaved=!0},a.prototype.isDefaultStyleSaved=function(){return this._defaultStyleSaved},a.prototype.isDefaultColumnWidthSaved=function(){return this._defaultColumnWidthSaved},a.prototype.isDefaultRowHeightSaved=function(){return this._defaultRowHeightSaved},a.prototype.isColumnHeaderDefaultStyleSaved=function(){return this._columnHeaderDefaultStyleSaved},a.prototype.isColumnHeaderDefaultRowHeightSaved=function(){return this._columnHeaderDefaultRowHeightSaved},a.prototype.isRowHeaderDefaultStyleSaved=function(){return this._rowHeaderDefaultStyleSaved},a.prototype.isRowHeaderDefaultColumnWidthSaved=function(){return this._rowHeaderDefaultColumnWidthSaved},a.prototype.isCommentManagerSaved=function(){return this._commentManagerSaved},a}();b.CopyMoveSheetInfo=j;var k=function(){function a(a,b){var c=this;c._rowCount=a,c._columnCount=b,c._init()}return a.prototype._init=function(){var a=this;a._values=[],a._formulas=[],a._sparklines=[],a._styles=[],a._comments=[],a._tags=[],a._bindingPaths=[],a._spans=c,a._arrayFormulas=[],a._valueSaved=!1,a._formulaSaved=!1,a._sparklineSaved=!1,a._styleSaved=!1,a._commentSaved=!1,a._tagSaved=!1,a._spanSaved=!1,a._arrayFormulaSaved=!1,a._bindingPathSaved=!1},a.prototype.saveValue=function(a,b,e){e!==d&&e!==c&&this._values.push(new i(a,b,e)),this._valueSaved=!0},a.prototype.getValues=function(){return this._values},a.prototype.saveFormula=function(a,b,c){c&&""!==c&&this._formulas.push(new i(a,b,c)),this._formulaSaved=!0},a.prototype.getFormulas=function(){return this._formulas},a.prototype.saveArrayFormula=function(a){this._arrayFormulas.push(a),this._arrayFormulaSaved=!0},a.prototype.getArrayFormula=function(){return this._arrayFormulas},a.prototype.saveSparkline=function(a,b,c){c&&this._sparklines.push(new i(a,b,c)),this._sparklineSaved=!0},a.prototype.getSparklines=function(){return this._sparklines},a.prototype.saveStyle=function(a,b,c){c&&this._styles.push(new i(a,b,c)),this._styleSaved=!0},a.prototype.getStyles=function(){return this._styles},a.prototype.saveComment=function(a,b,c){c&&this._comments.push(new i(a,b,c)),this._commentSaved=!0},a.prototype.getComments=function(){return this._comments},a.prototype.saveTag=function(a,b,e){e!==d&&e!==c&&this._tags.push(new i(a,b,e)),this._tagSaved=!0},a.prototype.getTags=function(){return this._tags},a.prototype.saveBindingPath=function(a,b,e){e!==d&&e!==c&&this._bindingPaths.push(new i(a,b,e)),this._bindingPathSaved=!0},a.prototype.getBindingPaths=function(){return this._bindingPaths},a.prototype.saveSpan=function(a){var b=this;b._spans||(b._spans=[]),b._spans.push(a),b._spanSaved=!0},a.prototype.isValueSaved=function(){return this._valueSaved},a.prototype.isFormulaSaved=function(){return this._formulaSaved},a.prototype.isArrayFormulaSaved=function(){return this._arrayFormulaSaved},a.prototype.isSparklineSaved=function(){return this._sparklineSaved},a.prototype.isStyleSaved=function(){return this._styleSaved},a.prototype.isCommentSaved=function(){return this._commentSaved},a.prototype.isTagSaved=function(){return this._tagSaved},a.prototype.isSpanSaved=function(){return this._spanSaved},a.prototype.isBindingPathSaved=function(){return this._bindingPathSaved},a}();b.CopyMoveCellsInfo=k;var l=function(){function a(a){this._columnCount=a,this._init()}return a.prototype._init=function(){var a=this;a._widths={},a._visibles={},a._resizables={},a._tags={},a._viewportColumnStyles={},a._headerColumnStyles={},a._levels={},a._collapsed={},a._bindingFields={},a._widthSaved=!1,a._visibleSaved=!1,a._resizableSaved=!1,a._tagSaved=!1,a._viewportColumnStyleSaved=!1,a._headerColumnStyleSaved=!1,a._rangeGroupSaved=!1,a._bindingFieldSaved=!1},a.prototype.saveWidth=function(a,b){var d=this;d._widths[a]!==c?d._widths[a]=0>b?c:b:b>=0&&(d._widths[a]=b),d._widthSaved=!0},a.prototype.getWidth=function(a){return this._widths[a]!==c?this._widths[a]:-1},a.prototype.saveVisible=function(a,b){var d=this;d._visibles[a]!==c?d._visibles[a]=b?c:b:b||(d._visibles[a]=b),d._visibleSaved=!0},a.prototype.getVisible=function(a){return this._visibles[a]!==c?this._visibles[a]:!0},a.prototype.saveResizable=function(a,b){var d=this;d._resizables[a]!==c?d._resizables[a]=b?c:b:b||(d._resizables[a]=b),d._resizableSaved=!0},a.prototype.getResizable=function(a){return this._resizables[a]!==c?this._resizables[a]:!0},a.prototype.saveTag=function(a,b){var e=this;e._tags[a]!==c?e._tags[a]=b===d||b===c?c:b:b!==c&&(e._tags[a]=b),e._tagSaved=!0},a.prototype.getTag=function(a){return this._tags[a]!==c?this._tags[a]:c},a.prototype.saveViewportColumnStyle=function(a,b){var d=this;d._viewportColumnStyles[a]?d._viewportColumnStyles[a]=b?b:c:b&&(d._viewportColumnStyles[a]=b),d._viewportColumnStyleSaved=!0},a.prototype.getViewportColumnStyle=function(a){return this._viewportColumnStyles[a]?this._viewportColumnStyles[a]:c},a.prototype.saveHeaderColumnStyle=function(a,b){var d=this;d._headerColumnStyles[a]?d._headerColumnStyles[a]=b?b:c:b&&(d._headerColumnStyles[a]=b),d._headerColumnStyleSaved=!0},a.prototype.getHeaderColumnStyle=function(a){return this._headerColumnStyles[a]?this._headerColumnStyles[a]:c},a.prototype.saveRangeGroup=function(a,b,d){var e=this;e._levels[a]!==c?e._levels[a]=0>b?c:b:b>=0&&(e._levels[a]=b),e._collapsed[a]!==c?e._collapsed[a]=d?d:c:d&&(e._collapsed[a]=d),e._rangeGroupSaved=!0},a.prototype.getRangeGroup=function(a,b){var d=this;
b.level=-1,b.collapsed=!1,d._levels[a]!==c&&(b.level=d._levels[a]),d._collapsed[a]!==c&&(b.collapsed=d._collapsed[a])},a.prototype.saveBindingField=function(a,b){this._bindingFields[a]=b,this._bindingFieldSaved=!0},a.prototype.getBindingField=function(a,b){return b.fieldName=c,this._bindingFields[a]!==c?(b.fieldName=this._bindingFields[a],!0):!1},a.prototype.isWidthSaved=function(){return this._widthSaved},a.prototype.isVisibleSaved=function(){return this._visibleSaved},a.prototype.isResizableSaved=function(){return this._resizableSaved},a.prototype.isTagSaved=function(){return this._tagSaved},a.prototype.isViewportColumnStyleSaved=function(){return this._viewportColumnStyleSaved},a.prototype.isHeaderColumnStyleSaved=function(){return this._headerColumnStyleSaved},a.prototype.isRangeGroupSaved=function(){return this._rangeGroupSaved},a.prototype.isBindingFieldSaved=function(){return this._bindingFieldSaved},a}();b.CopyMoveColumnsInfo=l;var m=function(){function a(a){this._rowCount=a,this._init()}return a.prototype._init=function(){var a=this;a._heights={},a._visibles={},a._resizables={},a._tags={},a._viewportRowStyles={},a._headerRowStyles={},a._levels={},a._collapsed={},a._heightSaved=!1,a._visibleSaved=!1,a._resizableSaved=!1,a._tagSaved=!1,a._viewportRowStyleSaved=!1,a._headerRowStyleSaved=!1,a._rangeGroupSaved=!1},a.prototype.saveHeight=function(a,b){var d=this;d._heights[a]!==c?d._heights[a]=0>b?c:b:b>=0&&(d._heights[a]=b),d._heightSaved=!0},a.prototype.getHeight=function(a){return this._heights[a]!==c?this._heights[a]:-1},a.prototype.saveVisible=function(a,b){var d=this;d._visibles[a]!==c?d._visibles[a]=b?c:b:b||(d._visibles[a]=b),d._visibleSaved=!0},a.prototype.getVisible=function(a){return this._visibles[a]!==c?this._visibles[a]:!0},a.prototype.saveResizable=function(a,b){var d=this;d._resizables[a]!==c?d._resizables[a]=b?c:b:b||(d._resizables[a]=b),d._resizableSaved=!0},a.prototype.getResizable=function(a){return this._resizables[a]!==c?this._resizables[a]:!0},a.prototype.saveTag=function(a,b){var e=this;e._tags[a]!==c?e._tags[a]=b===d||b===c?c:b:b!==c&&(e._tags[a]=b),e._tagSaved=!0},a.prototype.getTag=function(a){return this._tags[a]!==c?this._tags[a]:c},a.prototype.saveViewportRowStyle=function(a,b){var d=this;d._viewportRowStyles[a]?d._viewportRowStyles[a]=b?b:c:b&&(d._viewportRowStyles[a]=b),d._viewportRowStyleSaved=!0},a.prototype.getViewportRowStyle=function(a){return this._viewportRowStyles[a]?this._viewportRowStyles[a]:c},a.prototype.saveHeaderRowStyle=function(a,b){var d=this;d._headerRowStyles[a]?d._headerRowStyles[a]=b?b:c:b&&(d._headerRowStyles[a]=b),d._headerRowStyleSaved=!0},a.prototype.getHeaderRowStyle=function(a){return this._headerRowStyles[a]?this._headerRowStyles[a]:c},a.prototype.saveRangeGroup=function(a,b,d){var e=this;e._levels[a]!==c?e._levels[a]=0>b?c:b:b>=0&&(e._levels[a]=b),e._collapsed[a]!==c?e._collapsed[a]=d?d:c:d&&(e._collapsed[a]=d),e._rangeGroupSaved=!0},a.prototype.getRangeGroup=function(a,b){var d=this;b.level=-1,b.collapsed=!1,d._levels[a]!==c&&(b.level=d._levels[a]),d._collapsed[a]!==c&&(b.collapsed=d._collapsed[a])},a.prototype.isHeightSaved=function(){return this._heightSaved},a.prototype.isVisibleSaved=function(){return this._visibleSaved},a.prototype.isResizableSaved=function(){return this._resizableSaved},a.prototype.isTagSaved=function(){return this._tagSaved},a.prototype.isViewportRowStyleSaved=function(){return this._viewportRowStyleSaved},a.prototype.isHeaderRowStyleSaved=function(){return this._headerRowStyleSaved},a.prototype.isRangeGroupSaved=function(){return this._rangeGroupSaved},a}();b.CopyMoveRowsInfo=m;var n=function(){function a(){}return a.getStyleObject=function(a,b,c,d){return a.getStyleObject(b,c,d)},a.setStyleObject=function(a,b,c,d,e){a.setStyleObject(b,c,e,d)},a.getComment=function(a,b,c){return a.getComment(b,c)},a.setComment=function(a,b,c,d){a.setComment(b,c,d)},a.saveSheetInfo=function(a,b,c){(64&c)>0&&(b.saveDefaultStyle(a.getDefaultStyle()),b.saveColumnHeaderDefaultStyle(a.getDefaultStyle(1)),b.saveRowHeaderDefaultStyle(a.getDefaultStyle(2))),b.saveDefaultColumnWidth(a.defaults.colWidth),b.saveDefaultRowHeight(a.defaults.rowHeight),b.saveColumnHeaderDefaultRowHeight(a.defaults.rowHeight),b.saveRowHeaderDefaultColumnWidth(a.defaults.rowHeaderColWidth)},a.saveColumnHeaderInfo=function(b,c,d,e,f){var g,h,i=c._rowCount,j=c._columnCount;for(g=0;i>g;g++)for(h=0;j>h;h++){if((1&f)>0){var k=b._getModel(1).getValue(g,e+h);c.saveValue(g,h,k)}(64&f)>0&&c.saveStyle(g,h,a.getStyleObject(b,g,e+h,1))}if((1&f)>0)for(h=0;j>h;h++)b.isColumnBound(e+h)&&d.saveBindingField(h,b.getDataColumnName(e+h));if((32&f)>0)for(var l=b._colHeaderSpanModel.getEnumerator(0,e,i,j);l.moveNext();)c.saveSpan(l.current());for(j=d._columnCount,h=0;j>h;h++)d.saveWidth(h,b._getActualColumnWidth(e+h)),d.saveVisible(h,b.getColumnVisible(e+h)),d.saveResizable(h,b.getColumnResizable(e+h));if((64&f)>0)for(h=0;j>h;h++)d.saveViewportColumnStyle(h,a.getStyleObject(b,-1,e+h,3)),d.saveHeaderColumnStyle(h,a.getStyleObject(b,-1,e+h,1));if((8&f)>0){var m=b.colRangeGroup;if(m&&!m._isEmpty())for(h=0;j>h;h++)d.saveRangeGroup(h,m.getLevel(e+h),m.getCollapsed(e+h))}},a.saveRowHeaderInfo=function(b,c,d,e,f){if(!(0>=(1023&f))){var g,h,i=c._rowCount,j=c._columnCount;for(g=0;i>g;g++)for(h=0;j>h;h++){if((1&f)>0){var k=b._getModel(2).getValue(e+g,h);c.saveValue(g,h,k)}(64&f)>0&&c.saveStyle(g,h,a.getStyleObject(b,e+g,h,2))}if((32&f)>0)for(var l=b._rowHeaderSpanModel.getEnumerator(e,0,i,j);l.moveNext();)c.saveSpan(l.current());for(i=d._rowCount,g=0;i>g;g++)d.saveHeight(g,b._getActualRowHeight(e+g)),d.saveVisible(g,b.getRowVisible(e+g)),d.saveResizable(g,b.getRowResizable(e+g));if((64&f)>0)for(g=0;i>g;g++)d.saveViewportRowStyle(g,a.getStyleObject(b,e+g,-1,3)),d.saveHeaderRowStyle(g,a.getStyleObject(b,e+g,-1,2));if((8&f)>0){var m=b.rowRangeGroup;if(m&&!m._isEmpty())for(g=0;i>g;g++)d.saveRangeGroup(g,m.getLevel(e+g),m.getCollapsed(e+g))}}},a.saveViewportInfo=function(b,d,e,f,g){if(!(0>=(1023&g))){for(var h=d._rowCount,i=d._columnCount,j=0;h>j;j++)for(var k=0;i>k;k++){var l;if((2&g)>0&&(l=b.getFormulaInformation(e+j,f+k),l.hasFormula&&(l.isArrayFormula?l.baseRange.row===e+j&&l.baseRange.col===f+k&&d.saveArrayFormula(l):d.saveFormula(j,k,l.formula))),!((1&g)>0)||l&&l.hasFormula||d.saveValue(j,k,b.getValue(e+j,f+k,3)),(16&g)>0){var m=b.getSparkline(e+j,f+k),n=c,o=c;m&&(n=m.data(),o=m.dateAxisData()),m&&n?d.saveSparkline(j,k,m.clone()):d.saveSparkline(j,k,c)}(64&g)>0&&d.saveStyle(j,k,a.getStyleObject(b,e+j,f+k,3)),d.saveComment(j,k,a.getComment(b,e+j,f+k)),(256&g)>0&&d.saveBindingPath(j,k,b.getBindingPath(e+j,f+k,3))}if((32&g)>0)for(var p=b._spanModel.getEnumerator(e,f,h,i);p.moveNext();)d.saveSpan(p.current())}},a.undoCellsInfo=function(b,d,e,f,g){var h,i,j,k,l,m,n=d._rowCount,o=d._columnCount;b.suspendCalcService(),b.suspendEvent();try{for(var p=0;n>p;p++)for(var q=0;o>q;q++)d.isBindingPathSaved()&&b.setBindingPath(e+p,f+q,c,g),d.isFormulaSaved()&&3===g&&b.setFormula(e+p,f+q,c),d.isSparklineSaved()&&3===g&&b.removeSparkline(e+p,f+q),d.isValueSaved()&&b.setValue(e+p,f+q,c,g),d.isStyleSaved()&&a.setStyleObject(b,e+p,f+q,g,c),d.isCommentSaved()&&a.setComment(b,e+p,f+q,c);if(d.isBindingPathSaved()){var r=d.getBindingPaths();for(h=0;h<r.length;h++){var s=r[h];b.setBindingPath(e+s.row,f+s.column,s.value,g)}}if(d.isFormulaSaved()&&3===g){var t=d.getFormulas();for(h=0;h<t.length;h++)k=t[h],b.setFormula(e+k.row,f+k.column,k.value)}if(d.isSparklineSaved()&&3===g)for(var u=d.getSparklines(),v=0;v<u.length;v++){var w=u[v],x=w.value;x?x.dateAxisData()?b.setSparkline(e+w.row,f+w.column,x.data(),x.dataOrientation(),x.sparklineType(),x.setting(),x.dateAxisData(),x.dateAxisOrientation()):b.setSparkline(e+w.row,f+w.column,x.data(),x.dataOrientation(),x.sparklineType(),x.setting()):b.removeSparkline(e+w.row,f+w.column)}if(d.isValueSaved()){var y=d.getValues();for(h=0;h<y.length;h++){var z=y[h];b.setValue(e+z.row,f+z.column,z.value,g)}}if(d.isStyleSaved()){var A=d.getStyles();for(h=0;h<A.length;h++){var B=A[h];a.setStyleObject(b,e+B.row,f+B.column,g,B.value)}}if(d.isCommentSaved()){var C=d.getComments();for(h=0;h<C.length;h++){var D=C[h],E=D.value;a.setComment(b,e+D.row,f+D.column,E)}}if(d.isArrayFormulaSaved()&&3===g){var F=b._getsArrayFormulas(e,f,n,o);if(F&&F.length>0)for(l=F.getLength(0),m=0;l>m;m++)j=F[m][0],b.setArrayFormula(j.row,j.col,j.rowCount,j.colCount,c);if(F=d.getArrayFormula(),F&&F.length>0)for(l=F.length,m=0;l>m;m++){var G=F[m];b.setArrayFormula(G.baseRange.row,G.baseRange.col,G.baseRange.rowCount,G.baseRange.colCount,G.formula)}}}finally{b.resumeCalcService(),b.resumeEvent()}var H=c;if(3===g?H=b._spanModel:1===g?H=b._colHeaderSpanModel:2===g&&(H=b._rowHeaderSpanModel),H&&H.length>0){for(var I=[],J=H.getEnumerator(e,f,n,o);J.moveNext();)i=J.current(),i&&I.push(i);for(h=0;h<I.length;h++)i=I[h],H.remove(i)}if(d.isSpanSaved()&&H)for(h=0;h<d._spans.length;h++)i=d._spans[h],H.push(i)},a.undoColumnsInfo=function(b,d,e){var f,g=d._columnCount;if(d.isBindingFieldSaved()){var h={fieldName:c};for(f=0;g>f;f++)d.getBindingField(f,h)&&b.bindColumn(e+f,h.fieldName)}if(d.isWidthSaved())for(f=0;g>f;f++)b.setColumnWidth(e+f,d.getWidth(f),3);if(d.isVisibleSaved())for(f=0;g>f;f++)b.setColumnVisible(e+f,d.getVisible(f),3);if(d.isResizableSaved())for(f=0;g>f;f++)b.setColumnResizable(e+f,d.getResizable(f),3);if(d.isViewportColumnStyleSaved())for(f=0;g>f;f++)a.setStyleObject(b,-1,e+f,3,d.getViewportColumnStyle(f));if(d.isHeaderColumnStyleSaved())for(f=0;g>f;f++)a.setStyleObject(b,-1,e+f,1,d.getHeaderColumnStyle(f));if(d.isRangeGroupSaved()){var i=b.colRangeGroup;if(i){var j={level:c,collapsed:c};for(f=0;g>f;f++)d.getRangeGroup(f,j),i._setLevel(e+f,j.level),i.setCollapsed(e+f,j.collapsed)}}},a.undoRowsInfo=function(b,d,e){var f,g=d._rowCount;if(d.isHeightSaved())for(f=0;g>f;f++)b.setRowHeight(e+f,d.getHeight(f),3);if(d.isVisibleSaved())for(f=0;g>f;f++)b.setRowVisible(e+f,d.getVisible(f),3);if(d.isResizableSaved())for(f=0;g>f;f++)b.setRowResizable(e+f,d.getResizable(f),3);if(d.isViewportRowStyleSaved())for(f=0;g>f;f++)a.setStyleObject(b,e+f,-1,3,d.getViewportRowStyle(f));if(d.isHeaderRowStyleSaved())for(f=0;g>f;f++)a.setStyleObject(b,e+f,-1,2,d.getHeaderRowStyle(f));if(d.isRangeGroupSaved()){var h=b.rowRangeGroup;if(h){var i={level:c,collapsed:c};for(f=0;g>f;f++)d.getRangeGroup(f,i),h._setLevel(e+f,i.level),h.setCollapsed(e+f,i.collapsed)}}},a.undoSheetInfo=function(a,b){b.isDefaultStyleSaved()&&a.setDefaultStyle(b.getDefaultStyle()),b.isDefaultColumnWidthSaved()&&(a.defaults.colWidth=b.getDefaultColumnWidth()),b.isDefaultRowHeightSaved()&&(a.defaults.rowHeight=b.getDefaultRowHeight()),b.isColumnHeaderDefaultStyleSaved()&&a.setDefaultStyle(b.getColumnHeaderDefaultStyle(),1),b.isColumnHeaderDefaultRowHeightSaved()&&(a.defaults.rowHeight=b.getColumnHeaderDefaultRowHeight()),b.isRowHeaderDefaultStyleSaved()&&a.setDefaultStyle(b.getRowHeaderDefaultStyle(),2),b.isRowHeaderDefaultColumnWidthSaved()&&(a.defaults.rowHeaderColWidth=b.getRowHeaderDefaultColumnWidth())},a.getValues=function(a,b,e,f,g){0>b&&(b=0,f=a.getRowCount()),0>e&&(e=0,g=a.getColumnCount());for(var h=[],j=0;f>j;j++)for(var k=0;g>k;k++){var l=a.getValue(b+j,e+k);l!==d&&l!==c&&h.push(new i(j,k,l))}return h},a.raiseRangeDataChanged=function(a,b,c,d,e){a&&(0>b&&(b=0,d=a.getRowCount()),0>c&&(c=0,e=a.getColumnCount()),a._raiseRangeDataChanged(b,c,d,e))},a.convertToKey=function(a,b){var c=0;return c=a,c<<=32,c|=b},a.remove=function(a,b,d){var e=c,f=-1,g=a.length;if(g>0)for(var h=0;g>h;h++)if(a[h].row===b&&a[h].column===d){f=h;break}return-1!==f&&(e=a[f],a.splice(f,1)),e},a}();b.CopyMoveHelper=n;var o=function(){function a(){this.canExecuteChanged=c}return a.prototype.execute=function(){},a.prototype.canExecute=function(){return!0},a.prototype.canUndo=function(){return!0},a.prototype.saveState=function(){},a.prototype.undo=function(){return!0},a.prototype._raiseCanExecuteChanged=function(){var a=this;a.canExecuteChanged&&"function"==typeof a.canExecuteChanged&&a.canExecuteChanged(a)},a.prototype._suspendInvalidate=function(a){a&&a._suspendInvalidate&&a._suspendInvalidate()},a.prototype._resumeInvalidate=function(a){return a&&a._resumeInvalidate?a._resumeInvalidate():!1},a}();b.ActionBase=o;var p=function(b){function d(a,c,d,e){b.call(this);var f=this;f._sheet=a,f._columns=c,f._size=d,f._rowHeader=e,f._oldSizes=[],f._oldVisibles=[]}return __extends(d,b),d.prototype.canExecute=function(){return!0},d.prototype.execute=function(b){var c=this,d=c._sheet,f=c._columns,g=f&&f.length;if(d&&g>0){c._suspendInvalidate(b);var h=c._getColumnsReiszed(f),i={sheet:d,sheetName:d._name,colList:h,header:c._rowHeader,cancel:!1};if(d._trigger(a.Events.ColumnWidthChanging,i),i&&i.cancel===!0)return c._canUndo=!1,void c._resumeInvalidate(b);c._canUndo=!0,c.saveState();var j=d.isPaintSuspended();d.isPaintSuspended(!0),d.suspendEvent();try{for(var k=2,l=3,m=c._rowHeader,n=d.getColumnCount(m?k:l),o=d._scrollLeftCol,p=o,q=o-1;q>=d.frozenColCount&&!(d.getColumnVisible(q)&&d._getZoomColumnWidth(q)>0);q--)d.getColumnResizable(q)&&(p=q);for(var r=Number.MAX_VALUE,s=c._size,t=0;g>t;t++)for(var u=f[t],v=u.firstCol,w=u.lastCol,x=v;w>=x;x++)x>=0&&n>x&&(m&&d.getColumnResizable(x,k)&&s!==d._getActualColumnWidth(x,k)?d.setColumnWidth(x,s,k):d.getColumnResizable(x,l)&&s!==d._getActualColumnWidth(x,l)&&d.setColumnWidth(x,s,l),r=e(x,r));r!==Number.MAX_VALUE&&o>=r&&p!==o&&(d._scrollLeftCol=p)}finally{d.resumeEvent(),d.isPaintSuspended(j);var y=c._resumeInvalidate(b);y||(d.invalidateLayout(),d.repaint())}d._trigger(a.Events.ColumnWidthChanged,{sheet:d,sheetName:d._name,colList:h,header:c._rowHeader}),d._syncHScollbarPosition()}},d.prototype.saveState=function(){var a=this,b=[],d=[],e=a._sheet,f=a._columns,g=f&&f.length;if(e&&g>0)for(var i,j=a._rowHeader,k=j?2:3,l=e.getColumnCount(k),m=j?e.defaults.rowHeaderColWidth:e.defaults.colWidth,n=e._getColumnInfos(k),o=0;g>o;o++){var p,q,r,s=f[o],t=s.firstCol,u=s.lastCol;b[o]=[],d[o]=[];for(var v=t;u>=v;v++)if(p=v-t,v>=0&&l>v){if(i=n[v],!i)continue;q=i.visible,("undefined"==typeof q||q===c)&&(q=!0),r=i.size,r=isNaN(r)||r===c?m:h(r),b[o][p]=r,d[o][p]=q}else b[o][p]=-1,d[o][p]=!1}a._oldSizes=b,a._oldVisibles=d},d.prototype.undo=function(b){var c=this,d=!1,e=c._sheet,f=c._columns,g=f&&f.length;if(e&&g>0){c._suspendInvalidate(b);var h=c._getColumnsReiszed(f),i={sheet:e,sheetName:e._name,colList:h,header:c._rowHeader,cancel:!1};if(e._trigger(a.Events.ColumnWidthChanging,i),i&&i.cancel===!0)return c._resumeInvalidate(b),!1;var j=e.isPaintSuspended();e.isPaintSuspended(!0),e.suspendEvent();try{for(var k,l,m=2,n=3,o=c._rowHeader,p=e.getColumnCount(o?2:n),q=0;g>q;q++)for(var r=f[q],s=r.firstCol,t=r.lastCol,u=s;t>=u;u++)k=c._oldSizes[q][u-r.firstCol],l=c._oldVisibles[q][u-r.firstCol],u>=0&&p>u&&-1!==k&&(o&&e.getColumnResizable(u,m)?(e.setColumnWidth(u,k,m),d=!0):e.getColumnResizable(u,n)&&(e.setColumnWidth(u,k,n),d=!0),o&&e.getColumnVisible(u,m)!==l?(e.setColumnVisible(u,l,m),d=!0):e.getColumnVisible(u,n)!==l&&(e.setColumnVisible(u,l,n),d=!0))}finally{e.resumeEvent(),e.isPaintSuspended(j);var v=c._resumeInvalidate(b);v||(e.invalidateLayout(),e.repaint())}e._trigger(a.Events.ColumnWidthChanged,{sheet:e,sheetName:e._name,colList:h,header:c._rowHeader})}return d},d.prototype._getColumnsReiszed=function(a){for(var b=[],c=0,d=a.length;d>c;c++)for(var e=a[c],f=e.firstCol,g=e.lastCol,h=f;g>=h;h++)b.push(h);return b},d.prototype.canUndo=function(){return this._canUndo},d}(o);b.ColumnResizeUndoAction=p;var q=function(b){function d(a,c,d,e){b.call(this);var f=this;f._sheet=a,f._rows=c,f._size=d,f._columnHeader=e,f._oldSizes=[],f._oldVisibles=[]}return __extends(d,b),d.prototype.canExecute=function(){return!0},d.prototype.execute=function(b){var c=this,d=c._sheet,f=c._rows,g=f&&f.length;if(d&&g>0){c._suspendInvalidate(b);var h=c._getRowsReiszed(f),i={sheet:d,sheetName:d._name,rowList:h,header:c._columnHeader,cancel:!1};if(d._trigger(a.Events.RowHeightChanging,i),i&&i.cancel===!0)return c._canUndo=!1,void c._resumeInvalidate(b);c._canUndo=!0,c.saveState();var j=d.isPaintSuspended();d.isPaintSuspended(!0),d.suspendEvent();try{for(var k=3,l=1,m=c._columnHeader,n=d.getRowCount(m?l:k),o=d._scrollTopRow,p=o,q=o-1;q>=d.frozenRowCount&&!(d.getRowVisible(q)&&d._getZoomRowHeight(q)>0);q--)d.getRowResizable(q)&&(p=q);for(var r=Number.MAX_VALUE,s=c._size,t=0;g>t;t++)for(var u=f[t],v=u.firstRow,w=u.lastRow,x=v;w>=x;x++)x>=0&&n>x&&(m&&d.getRowResizable(x,l)&&s!==d._getActualRowHeight(x,l)?d.setRowHeight(x,s,l):d.getRowResizable(x,k)&&s!==d._getActualRowHeight(x,k)&&(d.setRowHeight(x,s,k),d.rowFilter()&&d.rowFilter()._addRowFilteredIn(x)),r=e(x,r));r!==Number.MAX_VALUE&&o>=r&&p!==o&&(d._scrollTopRow=p)}finally{d.resumeEvent(),d.isPaintSuspended(j);var y=c._resumeInvalidate(b);y||(d.invalidateLayout(),d.repaint())}d._trigger(a.Events.RowHeightChanged,{sheet:d,sheetName:d._name,rowList:h,header:c._columnHeader}),d._syncVScrollbarPosition()}},d.prototype.saveState=function(){var a=this,b=[],d=[],e=a._sheet,f=a._rows,g=f&&f.length;if(e&&g>0)for(var i,j=a._columnHeader,k=j?1:3,l=e.getRowCount(k),m=j?e.defaults.colHeaderRowHeight:e.defaults.rowHeight,n=e._getRowInfos(k),o=0;g>o;o++){var p,q,r,s=f[o],t=s.firstRow,u=s.lastRow;b[o]=[],d[o]=[];for(var v=t;u>=v;v++)if(p=v-t,v>=0&&l>v){if(i=n[v],!i)continue;q=i.visible,("undefined"==typeof q||q===c)&&(q=!0),r=i.size,r=isNaN(r)||r===c?m:h(r),b[o][p]=r,d[o][p]=q}else b[o][p]=-1,d[o][p]=!1}a._oldVisibles=d,a._oldSizes=b},d.prototype.undo=function(b){var c=this,d=!1,e=c._sheet,f=c._rows,g=f&&f.length;if(e&&g>0){c._suspendInvalidate(b);var h=c._getRowsReiszed(f),i={sheet:e,sheetName:e._name,rowList:h,header:c._columnHeader,cancel:!1};if(e._trigger(a.Events.RowHeightChanging,i),i&&i.cancel===!0)return c._resumeInvalidate(b),!1;var j=e.isPaintSuspended();e.isPaintSuspended(!0),e.suspendEvent();try{for(var k,l,m=3,n=1,o=c._columnHeader,p=e.getRowCount(o?n:m),q=c._oldSizes,r=c._oldVisibles,s=0;g>s;s++)for(var t=f[s],u=t.firstRow,v=t.lastRow,w=u;v>=w;w++)k=q[s][w-u],l=r[s][w-u],w>=0&&p>w&&-1!==k&&(o&&e.getRowResizable(w,n)?(e.setRowHeight(w,k,n),d=!0):e.getRowResizable(w,m)&&(e.setRowHeight(w,k,m),d=!0),o&&e.getRowVisible(w,n)!==l?(e.setRowVisible(w,l,n),d=!0):e.getRowVisible(w,m)!==l&&(e.setRowVisible(w,l,m),d=!0))}finally{e.resumeEvent(),e.isPaintSuspended(j);var x=c._resumeInvalidate(b);x||(e.invalidateLayout(),e.repaint())}e._trigger(a.Events.RowHeightChanged,{sheet:e,sheetName:e._name,rowList:h,header:c._columnHeader})}return d},d.prototype._getRowsReiszed=function(a){for(var b=[],c=0,d=a.length;d>c;c++)for(var e=a[c],f=e.firstRow,g=e.lastRow,h=f;g>=h;h++)b.push(h);return b},d.prototype.canUndo=function(){return this._canUndo},d}(o);b.RowResizeUndoAction=q;var r=function(b){function d(a,c,d,e){b.call(this);var f=this;f._sheet=a,f._columns=c,f._sheetArea=d?2:3,3===arguments.length&&(e=a._getAutoFitType()),f._autofitType=e,f._oldSizes=[],f._oldVisibles=[]}return __extends(d,b),d.prototype.canExecute=function(){return this._sheet&&this._columns&&this._columns.length>0},d.prototype.execute=function(b){var c=this;if(c.canExecute(b)){var d=c._sheet,e=c._sheetArea;c._suspendInvalidate(b);var f=c._getColumnsReiszed(c._columns),g=2===e,h={sheet:d,sheetName:d._name,colList:f,header:g,cancel:!1};if(d._trigger(a.Events.ColumnWidthChanging,h),h&&h.cancel===!0)return c._canUndo=!1,void c._resumeInvalidate(b);c._canUndo=!0,c.saveState();for(var i,j=d.getColumnCount(e),k=j-1,l=0,m=0,n=c._columns.length;n>m;m++)i=c._columns[m].col,k=k>i?i:k,l=i>l?i:l;a._CatchMgr.startCatch(d,0,k,d.getRowCount()-1,l);var o=d.isPaintSuspended();d.isPaintSuspended(!0),d.suspendEvent();try{for(var p,m=0,n=c._columns.length;n>m;m++){var q=c._columns[m];0<=q.col&&q.col<j&&d.getColumnResizable(q.col,e)&&(p=c._getColumnAutoFitValue(q.col),p!==d.getColumnWidth(q.col,e)&&d.setColumnWidth(q.col,p,e))}}finally{a._CatchMgr.clearCatch(),d.resumeEvent(),d.isPaintSuspended(o);var r=c._resumeInvalidate(b);r||(d.invalidateLayout(),d.repaint())}d._trigger(a.Events.ColumnWidthChanged,{sheet:d,sheetName:d._name,colList:f,header:g})}},d.prototype.saveState=function(){var a=this,b=c,d=c,e=a._sheet,f=a._sheetArea;if(e&&a._columns&&a._columns.length>0){var g=e.getColumnCount(f);b=[a._columns.length],d=[a._columns.length];for(var h=0,i=a._columns.length;i>h;h++){var j=a._columns[h];0<=j.col&&j.col<g?(b[h]=e.getColumnWidth(j.col,f),d[h]=e.getColumnVisible(j.col,f)):(b[h]=-1,d[h]=!1)}}a._oldSizes=b,a._oldVisibles=d},d.prototype.undo=function(b){var c=this,d=!1,e=c._sheetArea;if(c._sheet&&c._columns&&c._columns.length>0){var f=2===e,g=c._sheet;c._suspendInvalidate(b);var h=c._getColumnsReiszed(c._columns),i={sheet:g,sheetName:g._name,colList:h,header:f,cancel:!1};if(g._trigger(a.Events.ColumnWidthChanging,i),i&&i.cancel===!0)return c._resumeInvalidate(b),!1;var j=g.isPaintSuspended();g.isPaintSuspended(!0),g.suspendEvent();try{for(var k,l,m=g.getColumnCount(e),n=0;n<c._columns.length;n++){var o=c._columns[n];k=c._oldSizes[n],l=c._oldVisibles[n],n>=0&&m>n&&-1!==k&&g.getColumnResizable(o.col,e)&&(g.setColumnWidth(o.col,k,e),g.setColumnVisible(o.col,l,e),d=!0)}}finally{g.resumeEvent(),g.isPaintSuspended(j);var p=c._resumeInvalidate(b);p||(g.invalidateLayout(),g.repaint())}g._trigger(a.Events.ColumnWidthChanged,{sheet:g,sheetName:g._name,colList:h,header:f})}return d},d.prototype._getColumnsReiszed=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push(d.col)}return b},d.prototype._nextAutoFitRow=function(a,b){for(var c=this._sheet,d=this._sheetArea,e=-1,f=c.getRowCount(d),g=a+1;f>g;g++){var h=c.getText(g,b,d);if(h){e=g;break}var i=c.getActualStyle(g,b,d);if(i&&i.cellType){e=g;break}}return e},d.prototype._getColumnAutoFitValue=function(a){var b=this,c=b._sheet,d=c._render,e=0,f=b._sheetArea,h=[f];1==b._autofitType&&(3==f?h.push(1):2==f&&h.push(0));for(var i=0;i<h.length;i++)for(var j=0,f=h[i],k=c.getRowCount(f);j>=0&&k>j;){var l=c._getSpanModel(f).find(j,a);if(l&&(l.col<a||l.colCount>1||l.row<j))j=l.row+l.rowCount;else{var m=c.getActualStyle(j,a,f),n=0,o=m.cellType||c.getDefaultCellType(f);if(o){var p=m.font||d._getDefaultFont(f);m.font=d._getZoomFont(p);var q=!(!c.rowFilter()||!c.rowFilter().isFilterHeader(j,a,f));if(!q&&3===f){var r=c.findTable(j,a);r&&r.showHeader()&&r.headerIndex()===j&&r.rowFilter().showFilterButton&&(q=!0)}var s=m.formatter?m.formatter:m._autoFormatter,t={sheet:b,row:j,col:a,sheetArea:f},u=c.getValue(j,a,f),v=o.format(u,s,t);n=o._getAutoFitWidth(c,u,v,m,q,t)}n>e&&(e=n),j++}}return 0===e?e=c.defaults.colWidth:e+=g(3/c._zoomFactor),e},d.prototype.canUndo=function(){return this._canUndo},d}(o);b.ColumnAutoFitUndoAction=r;var s=function(b){function d(a,c,d,e){b.call(this);var f=this;f._sheet=a,f._rows=c,f._sheetArea=d?1:3,3===arguments.length&&(e=a._getAutoFitType()),f._autofitType=e,f._oldSizes=[],f._oldVisibles=[]}return __extends(d,b),d.prototype.canExecute=function(){return this._sheet&&this._rows&&this._rows.length>0},d.prototype.execute=function(b){var c=this;if(c.canExecute(b)){var d=c._sheet;c._suspendInvalidate(b);var e=c._getRowsResized(c._rows),f=c._sheetArea,g=1===c._sheetArea,h={sheet:d,sheetName:d._name,rowList:e,header:g,cancel:!1};if(d._trigger(a.Events.RowHeightChanging,h),h&&h.cancel===!0)return c._canUndo=!1,void c._resumeInvalidate(b);c._canUndo=!0,c.saveState();var i=d.isPaintSuspended();d.isPaintSuspended(!0),d.suspendEvent();try{for(var j,k=d.getRowCount(f),l=0,m=c._rows.length;m>l;l++){var n=c._rows[l];0<=n.row&&n.row<k&&d.getRowResizable(n.row,f)&&(j=c._getRowAutoFitValue(n.row),j!==d.getRowHeight(n.row,f)&&d.setRowHeight(n.row,j,f))}}finally{d.resumeEvent(),d.isPaintSuspended(i);var o=c._resumeInvalidate(b);o||(d.invalidateLayout(),d.repaint())}d._trigger(a.Events.RowHeightChanged,{sheet:d,sheetName:d._name,rowList:e,header:g})}},d.prototype.saveState=function(){var a=this,b=c,d=c,e=a._sheet,f=a._sheetArea;if(e&&a._rows&&a._rows.length>0){b=[a._rows.length],d=[a._rows.length];for(var g=e.getRowCount(f),h=0,i=a._rows.length;i>h;h++){var j=a._rows[h];0<=j.row&&j.row<g?(b[h]=e.getRowHeight(j.row,f),d[h]=e.getRowVisible(j.row,f)):(b[h]=-1,d[h]=!1)}}a._oldSizes=b,a._oldVisibles=d},d.prototype.undo=function(b){var c=this,d=!1,e=c._sheet,f=c._sheetArea,g=1===c._sheetArea;if(e&&c._rows&&c._rows.length>0){c._suspendInvalidate(b);var h=c._getRowsResized(c._rows),i={sheet:e,sheetName:e._name,rowList:h,header:g,cancel:!1};if(e._trigger(a.Events.RowHeightChanging,i),i&&i.cancel===!0)return c._resumeInvalidate(b),!1;var j=e.isPaintSuspended();e.isPaintSuspended(!0),e.suspendEvent();try{for(var k,l,m=e.getRowCount(f),n=0,o=c._rows.length;o>n;n++){var p=c._rows[n];k=c._oldSizes[n],l=c._oldVisibles[n],n>=0&&m>n&&-1!==k&&e.getRowResizable(p.row,f)&&(e.setRowHeight(p.row,k,f),e.setRowVisible(p.row,l,f),d=!0)}}finally{e.resumeEvent(),e.isPaintSuspended(j);var q=c._resumeInvalidate(b);q||(e.invalidateLayout(),e.repaint())}e._trigger(a.Events.RowHeightChanged,{sheet:e,sheetName:e._name,rowList:h,header:g})}return d},d.prototype._getRowsResized=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];b.push(e.row)}return b},d.prototype._nextAutoFitColumn=function(a,b){for(var c=this._sheet,d=this._sheetArea,f=1===this._sheetArea,g=c._nextNonNullColumn(a,b,f),h=-1,i=c.getColumnCount(d),j=b+1;i>j;j++){var k=c.getActualStyle(a,j,d);if(k&&k.cellType){h=j;break}}return g>=0&&h>=0?e(g,h):g>=0?g:h>=0?h:-1},d.prototype._getRowAutoFitValue=function(a){var b=this,c=b._sheet,d=c._render,e=0,f=b._sheetArea,h=(1===b._sheetArea,[f]);1==b._autofitType&&(3==f?h.push(2):1==f&&h.push(0));for(var i=0;i<h.length;i++){f=h[i];for(var j,k=0,l=c.getColumnCount(f),m=0;k>=0&&l>k;){var n=c._getSpanModel(f).find(a,k);if(n){if(n.row<a||n.rowCount>1||n.col<k){k=n.col+n.colCount;continue}if(k==n.col&&(m=c.getColumnWidth(k),n.colCount>1))for(j=k+1;j<k+n.colCount;j++)m+=c.getColumnWidth(j)}else m=c.getColumnWidth(k);var o=c.getActualStyle(a,k,f),p=o.font||d._getDefaultFont(f);o.font=d._getZoomFont(p);var q=0,r=c.getCellType(a,k,f);if(r){var s=c.getText(a,k,f),t=c.getValue(a,k,f),u={sheet:c,row:a,col:k,sheetArea:f};q=r._getAutoFitHeight(c,t,s,o,m,u)}q>e&&(e=q),3===f?k=b._nextAutoFitColumn(a,k):k++}}return 0===e?e=c.defaults.rowHeight:e+=g(3/c._zoomFactor),e},d.prototype.canUndo=function(){return this._canUndo},d}(o);b.RowAutoFitUndoAction=s;var t=function(){function a(a,b){this.index=a,this.count=b}return a}();b.GroupExtent=t;var u=function(b){function c(a,c){b.call(this),this._sheet=a,this._columnGroupExtent=c,this._canUndo=!1}return __extends(c,b),c.prototype.canExecute=function(){return!0},c.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._columnGroupExtent&&d.colRangeGroup){c._suspendInvalidate(b);var e=c._columnGroupExtent.index,f=c._columnGroupExtent.count;d.colRangeGroup.group(e,f);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint()),c._canUndo=!0}},c.prototype.canUndo=function(){return this._canUndo},c.prototype.saveState=function(){},c.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&e&&c._columnGroupExtent&&e.colRangeGroup){c._suspendInvalidate(b);var f=c._columnGroupExtent.index,g=c._columnGroupExtent.count;e.colRangeGroup.ungroupRange(f,g),d=!0;var h=c._resumeInvalidate(b);h||(e.invalidateLayout(),e.repaint())}return d},c}(o);b.ColumnGroupUndoAction=u;var v=function(b){function c(a,c){b.call(this),this._sheet=a,this._columnUngroupExtent=c,this._canUndo=!1}return __extends(c,b),c.prototype.canExecute=function(){return!0},c.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._columnUngroupExtent&&d.colRangeGroup){var e=c._columnUngroupExtent.index,f=c._columnUngroupExtent.count;if(d.colRangeGroup.getLevel(e)>=0||d.colRangeGroup.getLevel(e+f-1)>=0){c._suspendInvalidate(b),c._canUndo=!0,d.colRangeGroup.ungroupRange(e,f);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint())}else c._canUndo=!1}},c.prototype.canUndo=function(){return this._canUndo},c.prototype.saveState=function(){},c.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&c._canUndo===!0&&e&&c._columnUngroupExtent&&e.colRangeGroup){c._suspendInvalidate(b);var f=c._columnUngroupExtent.index,g=c._columnUngroupExtent.count;e.colRangeGroup.group(f,g),d=!0;var h=c._resumeInvalidate(b);h||(e.invalidateLayout(),e.repaint())}return d},c}(o);b.ColumnUngroupUndoAction=v;var w=function(b){function c(a,c){b.call(this),this._sheet=a,this._rowGroupExtent=c,this._canUndo=!1}return __extends(c,b),c.prototype.canExecute=function(){return!0},c.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._rowGroupExtent&&d.rowRangeGroup){c._suspendInvalidate(b);var e=c._rowGroupExtent.index,f=c._rowGroupExtent.count;d.rowRangeGroup.group(e,f);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint()),c._canUndo=!0}},c.prototype.canUndo=function(){return this._canUndo},c.prototype.saveState=function(){},c.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&e&&c._rowGroupExtent&&e.rowRangeGroup){c._suspendInvalidate(b);var f=c._rowGroupExtent.index,g=c._rowGroupExtent.count;e.rowRangeGroup.ungroupRange(f,g),d=!0;var h=c._resumeInvalidate(b);h||(e.invalidateLayout(),e.repaint())}return d},c}(o);b.RowGroupUndoAction=w;var x=function(b){function c(a,c){b.call(this),this._sheet=a,this._rowUngroupExtent=c,this._canUndo=!1}return __extends(c,b),c.prototype.canExecute=function(){return!0},c.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._rowUngroupExtent&&d.rowRangeGroup){var e=c._rowUngroupExtent.index,f=c._rowUngroupExtent.count;if(d.rowRangeGroup.getLevel(e)>=0||d.rowRangeGroup.getLevel(e+f-1)>=0){c._suspendInvalidate(b),c._canUndo=!0,d.rowRangeGroup.ungroupRange(e,f);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint())}else c._canUndo=!1}},c.prototype.canUndo=function(){return this._canUndo},c.prototype.saveState=function(){},c.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&c._canUndo===!0&&e&&c._rowUngroupExtent&&e.rowRangeGroup){c._suspendInvalidate(b);var f=c._rowUngroupExtent.index,g=c._rowUngroupExtent.count;e.rowRangeGroup.group(f,g),d=!0;var h=c._resumeInvalidate(b);h||(e.invalidateLayout(),e.repaint())}return d},c}(o);b.RowUngroupUndoAction=x;var y=function(b){function c(a,c){b.call(this),this._sheet=a,this._columnExpandExtent=c,this._canUndo=!1}return __extends(c,b),c.prototype.canExecute=function(){return!0},c.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._columnExpandExtent&&d.colRangeGroup){c._suspendInvalidate(b);var e=c._columnExpandExtent.index,f=c._columnExpandExtent.collapsed;d.colRangeGroup.setCollapsed(e,f),c._showColumnRangeGroup(f);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint()),c._canUndo=!0}},c.prototype.canUndo=function(){return this._canUndo},c.prototype.saveState=function(){},c.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&e&&c._columnExpandExtent&&e.colRangeGroup){c._suspendInvalidate(b);var f=c._columnExpandExtent.index,g=c._columnExpandExtent.collapsed;e.colRangeGroup.setCollapsed(f,!g),d=!0,c._showColumnRangeGroup(!g);var h=c._resumeInvalidate(b);h||(e.invalidateLayout(),e.repaint())}return d},c.prototype._showColumnRangeGroup=function(a){var b=this,c=b._sheet,d=b._columnExpandExtent.index;if(!(0>d||d>=c.getColumnCount())){var f,g,h,i,j,k,l;if(1===c.colRangeGroup.direction){if(f=c.colRangeGroup.find(d-1,b._columnExpandExtent.level),!f)return;g=f.start,h=d,i=1,a?g=d:g<c.frozenColCount&&(g=c.frozenColCount),j=c.getViewportLeftColumn(i),j>g&&(j=g),k=c.getViewportWidth(i),l=b._getColsTotalWidth(c,j,h),l>k&&(j=b._getNewLeftColumn(c,j,l-k)),c._scrollLeftCol=b._tryGetNextScrollableCol(c,j)}else{if(f=c.colRangeGroup.find(d+1,b._columnExpandExtent.level),!f)return;if(g=d,h=f.end,i=1,a)h=d;else{var m=c.getColumnCount();h>=m&&(h=m-1)}j=c.getViewportLeftColumn(i),j>g?c._scrollLeftCol=b._tryGetNextScrollableCol(c,g):(k=c.getViewportWidth(i),l=b._getColsTotalWidth(c,j,h),l>k&&(j=b._getNewLeftColumn(c,j,l-k),c._scrollLeftCol=b._tryGetNextScrollableCol(c,e(g,j))))
}c._syncHScollbarPosition()}},c.prototype._getColsTotalWidth=function(a,b,c){for(var d=0,e=a.getColumnCount(),f=b;c>=f&&e>f;f++)d+=a.getColumnWidth(f)*a._zoomFactor;return d},c.prototype._getNewLeftColumn=function(a,b,c){for(var d=0,e=a.getColumnCount(),f=b;e>f&&c>d;f++)b++,d+=a.getColumnWidth(f)*a._zoomFactor;return b>=e?e-1:b},c.prototype._tryGetNextScrollableCol=function(a,b){var c=a.frozenColCount,d=a.getColumnCount()-1;if(c>b)return c;if(b>d)return d;for(var e=b;d>=e;e++){var f=a.getColumnWidth(e);if(f>0)return e}return-1},c}(o);b.ColumnGroupExpandUndoAction=y;var z=function(b){function c(a,c){b.call(this),this._sheet=a,this._rowExpandExtent=c,this._canUndo=!1}return __extends(c,b),c.prototype.canExecute=function(){return!0},c.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._rowExpandExtent&&d.rowRangeGroup){c._suspendInvalidate(b);var e=c._rowExpandExtent.index,f=c._rowExpandExtent.collapsed;d.rowRangeGroup.setCollapsed(e,f),c._showRowRangeGroup(f);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint()),c._canUndo=!0}},c.prototype.canUndo=function(){return this._canUndo},c.prototype.saveState=function(){},c.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&e&&c._rowExpandExtent&&e.rowRangeGroup){c._suspendInvalidate(b);var f=c._rowExpandExtent.index,g=c._rowExpandExtent.collapsed;e.rowRangeGroup.setCollapsed(f,!g),d=!0,c._showRowRangeGroup(!g);var h=c._resumeInvalidate(b);h||(e.invalidateLayout(),e.repaint())}return d},c.prototype._showRowRangeGroup=function(a){var b=this,c=b._sheet,d=b._rowExpandExtent.index;if(!(0>d||d>=c.getRowCount())){var f,g,h,i,j,k,l;if(1===c.rowRangeGroup.direction){if(f=c.rowRangeGroup.find(d-1,b._rowExpandExtent.level),!f)return;g=f.start,h=d,i=1,a?g=d:g<c.frozenRowCount&&(g=c.frozenRowCount),j=c.getViewportTopRow(i),j>g&&(j=g),k=c.getViewportHeight(i),l=b._getRowsTotalHeight(c,j,h),l>k&&(j=b._getNewTopRow(c,j,l-k)),c._scrollTopRow=b._tryGetNextScrollableRow(c,j)}else{if(f=c.rowRangeGroup.find(d+1,b._rowExpandExtent.level),!f)return;if(g=d,h=f.end,i=1,a)h=d;else{var m=c.getRowCount();h>=m&&(h=m-1)}j=c.getViewportTopRow(i),j>g?c._scrollTopRow=b._tryGetNextScrollableRow(c,g):(k=c.getViewportHeight(i),l=b._getRowsTotalHeight(c,j,h),l>k&&(j=b._getNewTopRow(c,j,l-k),c._scrollTopRow=b._tryGetNextScrollableRow(c,e(g,j))))}c._syncVScrollbarPosition()}},c.prototype._getRowsTotalHeight=function(a,b,c){for(var d=0,e=a.getRowCount(),f=b;c>=f&&e>f;f++)d+=a.getRowHeight(f)*a._zoomFactor;return d},c.prototype._getNewTopRow=function(a,b,c){for(var d=0,e=a.getRowCount(),f=b;e>=f&&c>d;f++)b++,d+=a.getRowHeight(f)*a._zoomFactor;return b>=e?e-1:b},c.prototype._tryGetNextScrollableRow=function(a,b){var c=a.frozenRowCount,d=a.getRowCount()-1;if(c>b)return c;if(b>d)return d;for(var e=b;d>=e;e++){var f=a.getRowHeight(e);if(f>0)return e}return-1},c}(o);b.RowGroupExpandUndoAction=z;var A=function(b){function d(a,c){b.call(this);var d=this;d._sheet=a,d._columnGroupHeaderExpandExtent=c,d._oldStatus={},d._canUndo=!1}return __extends(d,b),d.prototype.canExecute=function(){return!0},d.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._columnGroupHeaderExpandExtent&&d.colRangeGroup){c._suspendInvalidate(b),c.saveState();for(var e=c._columnGroupHeaderExpandExtent.level,f=0;e>f;f++)d.colRangeGroup.expand(f,!0);d.colRangeGroup.expand(e,!1);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint()),c._canUndo=!0}},d.prototype.canUndo=function(){return this._canUndo},d.prototype.saveState=function(){var a=this,b=c,d=a._sheet;if(d&&a._columnGroupHeaderExpandExtent&&d.colRangeGroup){var e=a._columnGroupHeaderExpandExtent.level;b={};for(var f=0;e>=f;f++)for(var g=0,h=d.getColumnCount(),i=d.colRangeGroup.direction;h>g;){var j=d.colRangeGroup.find(g,f);if(j){var k=-1;switch(i){case 0:k=j.start-1;break;case 1:k=j.end+1}var l=1===j.getState();b[k]||(b[k]=l),g+=j.end-j.start+1}g++}}a._oldStatus=b},d.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&e&&c._oldStatus&&e.colRangeGroup){c._suspendInvalidate(b);for(var f in c._oldStatus)f&&(e.colRangeGroup.setCollapsed(f,c._oldStatus[f]),d=!0);var g=c._resumeInvalidate(b);g||(e.invalidateLayout(),e.repaint())}return d},d}(o);b.ColumnGroupHeaderExpandUndoAction=A;var B=function(b){function d(a,c){b.call(this);var d=this;d._sheet=a,d._rowGroupHeaderExpandExtent=c,d._oldStatus={},d._canUndo=!1}return __extends(d,b),d.prototype.canExecute=function(){return!0},d.prototype.execute=function(b){var c=this,d=c._sheet;if(a.features.group&&d&&c._rowGroupHeaderExpandExtent&&d.rowRangeGroup){c._suspendInvalidate(b),c.saveState();for(var e=c._rowGroupHeaderExpandExtent.level,f=0;e>f;f++)d.rowRangeGroup.expand(f,!0);d.rowRangeGroup.expand(e,!1);var g=c._resumeInvalidate(b);g||(d.invalidateLayout(),d.repaint()),c._canUndo=!0}},d.prototype.canUndo=function(){return this._canUndo},d.prototype.saveState=function(){var a=this,b=c,d=a._sheet;if(d&&a._rowGroupHeaderExpandExtent&&d.rowRangeGroup){var e=a._rowGroupHeaderExpandExtent.level;b={};for(var f=0;e>=f;f++)for(var g=0,h=d.getRowCount(),i=d.rowRangeGroup.direction;h>g;){var j=d.rowRangeGroup.find(g,f);if(j){var k=-1;switch(i){case 0:k=j.start-1;break;case 1:k=j.end+1}var l=1===j.getState();b[k]||(b[k]=l),g+=j.end-j.start+1}g++}}a._oldStatus=b},d.prototype.undo=function(b){var c=this,d=!1,e=c._sheet;if(a.features.group&&e&&c._oldStatus&&e.rowRangeGroup){c._suspendInvalidate(b);for(var f in c._oldStatus)f&&(e.rowRangeGroup.setCollapsed(f,c._oldStatus[f]),d=!0);var g=c._resumeInvalidate(b);g||(e.invalidateLayout(),e.repaint())}return d},d}(o);b.RowGroupHeaderExpandUndoAction=B;var C=function(){function a(a,b,c,d,e,f){var g=this;g.fromRow=a,g.fromColumn=b,g.toRow=c,g.toColumn=d,g.rowCount=e,g.columnCount=f}return a}();b.DragDropExtent=C;var D=function(b){function d(a,c,d,e,f){b.call(this);var g=this;g._sheet=a,g._dragDropExtent=c,g._copy=d,g._insert=e,g._option=f}return __extends(d,b),d.prototype.canExecute=function(){var b=this,c=b._sheet,d=b._dragDropExtent;return c._isValidRange(d.fromRow,d.fromColumn,d.rowCount,d.columnCount,b._sheet.getRowCount(),b._sheet.getColumnCount())&&(b._insert||c._isValidRange(d.toRow,d.toColumn,d.rowCount,d.columnCount,b._sheet.getRowCount(),b._sheet.getColumnCount()))?!(c.isProtected&&c._isAnyCellInRangeLocked(new a.Range(d.toRow,d.toColumn,d.rowCount,d.columnCount))||!c._checkArrayFormula(d.toRow,d.toColumn,d.rowCount,d.columnCount)||c.isProtected&&c._isAnyCellInRangeLocked(new a.Range(d.fromRow,d.fromColumn,d.rowCount,d.columnCount))||!c._checkArrayFormula(d.fromRow,d.fromColumn,d.rowCount,d.columnCount)):!1},d.prototype.execute=function(b){var c=this,d=c._sheet;c.saveState();var e,g,h,i,j;if(c._insert){var k=c._dragDropExtent.fromRow,l=c._dragDropExtent.fromColumn;if(l>=0&&0>k){e=c._dragDropExtent.fromColumn,g=c._dragDropExtent.toColumn,h=c._dragDropExtent.columnCount;var m=c._dragDropExtent.toColumn;c._suspendInvalidate(b);var o=d.isPaintSuspended();d.isPaintSuspended(!0);try{c._sheet.addColumns(g,h),c._copy?c._sheet.copyTo(-1,e>=g?e+h:e,-1,g,-1,h,c._option):(c._sheet.moveTo(-1,e>=g?e+h:e,-1,g,-1,h,c._option),c._sheet.deleteColumns(e>=g?e+h:e,h),g>e&&(m=g-h)),d&&(i=d.getSelections().toArray(),d._clearSelectionImp(),d.addSelection(-1,m,d.getRowCount(),h),j=d.getSelections(),d._trigger(a.Events.SelectionChanging,{sheet:d,sheetName:d._name,oldSelections:i,newSelections:j}),d._trigger(a.Events.SelectionChanged,{sheet:d,sheetName:d._name}),d._setActiveCellImp(d._getFirstVisualRow(),m,d.activeRowViewportIndex,d.activeColViewportIndex))}finally{d._dragRect={},d.isPaintSuspended(o);var p=c._resumeInvalidate(b);p||(d.invalidateLayout(),d.repaint())}}else if(c._dragDropExtent.fromRow>=0&&c._dragDropExtent.fromColumn<0){e=c._dragDropExtent.fromRow,g=c._dragDropExtent.toRow,h=c._dragDropExtent.rowCount;var q=c._dragDropExtent.toRow;c._suspendInvalidate(b);var o=d.isPaintSuspended();d.isPaintSuspended(!0);try{c._sheet.addRows(g,h),c._copy?c._sheet.copyTo(e>=g?e+h:e,-1,g,-1,h,-1,c._option):(c._sheet.moveTo(e>=g?e+h:e,-1,g,-1,h,-1,c._option),c._sheet.deleteRows(e>=g?e+h:e,h),g>e&&(q=g-h)),d&&(i=d.getSelections().toArray(),d._clearSelectionImp(),d.addSelection(q,-1,h,d.getColumnCount()),j=d.getSelections(),d._trigger(a.Events.SelectionChanging,{sheet:d,sheetName:d._name,oldSelections:i,newSelections:j}),d._trigger(a.Events.SelectionChanged,{sheet:d,sheetName:d._name}),d._setActiveCellImp(q,d._getFirstVisualColumn(),d.activeRowViewportIndex,d.activeColViewportIndex))}finally{d._dragRect={},d.isPaintSuspended(o);var p=c._resumeInvalidate(b);p||(d.invalidateLayout(),d.repaint())}}}else{var r=c._dragDropExtent.fromRow,s=c._dragDropExtent.fromColumn,t=c._dragDropExtent.toRow,u=c._dragDropExtent.toColumn,v=c._dragDropExtent.rowCount,w=c._dragDropExtent.columnCount;c._suspendInvalidate(b);var o=d.isPaintSuspended();d.isPaintSuspended(!0);try{c._copy?d.copyTo(r,s,t,u,v,w,c._option):d.moveTo(r,s,t,u,v,w,c._option),d&&(i=d.getSelections().toArray(),d._clearSelectionImp(),d.addSelection(t,u,v,w),j=d.getSelections().toArray(),d._trigger(a.Events.SelectionChanging,{sheet:d,sheetName:d._name,oldSelections:i,newSelections:j}),d._trigger(a.Events.SelectionChanged,{sheet:d,sheetName:d._name}),d._setActiveCellImp(f(d._getFirstVisualRow(),t),f(d._getFirstVisualColumn(),u),d.activeRowViewportIndex,d.activeColViewportIndex),!c._copy&&c._savedFromViewportCells&&c._savedFromViewportCells.isValueSaved()&&n.raiseRangeDataChanged(d,r,s,v,w,c._savedFromViewportCells.getValues()),c._savedToViewportCells&&c._savedToViewportCells.isValueSaved()&&n.raiseRangeDataChanged(d,t,u,v,w,c._savedToViewportCells.getValues()))}finally{d._dragRect={},d.isPaintSuspended(o);var p=c._resumeInvalidate(b);p||(d.invalidateLayout(),d.repaint())}}},d.prototype.saveState=function(){var a=this;a.initSaveState();var b=a._dragDropExtent.fromRow<0?0:a._dragDropExtent.fromRow,c=a._dragDropExtent.fromColumn<0?0:a._dragDropExtent.fromColumn,d=a._dragDropExtent.toRow<0?0:a._dragDropExtent.toRow,e=a._dragDropExtent.toColumn<0?0:a._dragDropExtent.toColumn,f=a._dragDropExtent.fromRow<0?a._sheet.getRowCount():a._dragDropExtent.rowCount,g=a._dragDropExtent.fromColumn<0?a._sheet.getColumnCount():a._dragDropExtent.columnCount;if(a._insert){if(a._dragDropExtent.fromColumn>=0&&a._dragDropExtent.fromRow>=0);else if(a._dragDropExtent.fromColumn>=0);else if(a._dragDropExtent.fromRow>=0)if(a._copy);else if(a._sheet._hasTable(d,-1,1,-1)){var h=new k(f,a._sheet.getColumnCount(2)),i=new m(f);n.saveRowHeaderInfo(a._sheet,h,i,b,a._option),a._savedFromRowHeaderCells=h,a._savedFromRows=i;var j=new k(f,g);n.saveViewportInfo(a._sheet,j,b,c,a._option),a._savedFromViewportCells=j}}else{if(a._dragDropExtent.fromRow<0){var o=new k(a._sheet.getRowCount(1),g),p=new l(g);if(n.saveColumnHeaderInfo(a._sheet,o,p,e,a._option),a._savedToColumnHeaderCells=o,a._savedToColumns=p,!a._copy){var q=new k(a._sheet.getRowCount(1),g),r=new l(g);n.saveColumnHeaderInfo(a._sheet,q,r,c,a._option),a._savedFromColumnHeaderCells=q,a._savedFromColumns=r}}if(a._dragDropExtent.fromColumn<0){var s=new k(f,a._sheet.getColumnCount(2)),t=new m(f);if(n.saveRowHeaderInfo(a._sheet,s,t,d,a._option),a._savedToRowHeaderCells=s,a._savedToRows=t,!a._copy){var h=new k(f,a._sheet.getColumnCount(2)),i=new m(f);n.saveRowHeaderInfo(a._sheet,h,i,b,a._option),a._savedFromRowHeaderCells=h,a._savedFromRows=i}}var u=new k(f,g);if(n.saveViewportInfo(a._sheet,u,d,e,a._option),a._savedToViewportCells=u,!a._copy){var j=new k(f,g);n.saveViewportInfo(a._sheet,j,b,c,a._option),a._savedFromViewportCells=j}}a._savedAcitveRowViewportIndex=a._sheet.activeRowViewportIndex,a._savedAcitveColumnViewportIndex=a._sheet.activeColViewportIndex,a._savedActiveRow=a._sheet._activeRowIndex,a._savedActiveColumn=a._sheet._activeColIndex},d.prototype.initSaveState=function(){var a=this;a._savedFromColumnHeaderCells=c,a._savedFromColumns=c,a._savedFromViewportCells=c,a._savedFromRowHeaderCells=c,a._savedFromRows=c,a._savedToColumnHeaderCells=c,a._savedToColumns=c,a._savedToViewportCells=c,a._savedToRowHeaderCells=c,a._savedToRows=c,a._savedAcitveRowViewportIndex=-2,a._savedAcitveColumnViewportIndex=-2,a._savedActiveRow=-1,a._savedActiveColumn=-1},d.prototype.undo=function(b){var d=this,e=d._sheet;if(!e._isValidRange(d._dragDropExtent.fromRow,d._dragDropExtent.fromColumn,d._dragDropExtent.rowCount,d._dragDropExtent.columnCount,d._sheet.getRowCount(),d._sheet.getColumnCount()))return!1;if(!d._insert&&!e._isValidRange(d._dragDropExtent.toRow,d._dragDropExtent.toColumn,d._dragDropExtent.rowCount,d._dragDropExtent.columnCount,d._sheet.getRowCount(),d._sheet.getColumnCount()))return!1;var g,h,i,j,k,l=!1;if(d._insert){if(!(d._dragDropExtent.fromColumn>=0&&d._dragDropExtent.fromRow>=0))if(d._dragDropExtent.fromColumn>=0){var m=d._dragDropExtent.fromColumn;i=d._dragDropExtent.columnCount,d._suspendInvalidate(b);var o=e.isPaintSuspended();e.isPaintSuspended(!0);try{d._copy?d._sheet.deleteColumns(d._dragDropExtent.toColumn,i):(j=d._dragDropExtent.toColumn,k=d._dragDropExtent.fromColumn,d._dragDropExtent.fromColumn<d._dragDropExtent.toColumn?j=d._dragDropExtent.toColumn-i:k=d._dragDropExtent.fromColumn+i,d._sheet.addColumns(k,i),d._sheet.copyTo(-1,j>=k?j+i:j,-1,k,-1,i,d._option),d._sheet.deleteColumns(j>=k?j+i:j,i),k>j&&(m=k-i)),e&&(g=e.getSelections().toArray(),e._clearSelectionImp(),e.addSelection(-1,m,e.getRowCount(),i),h=e.getSelections(),e._trigger(a.Events.SelectionChanging,{sheet:e,sheetName:e._name,oldSelections:g,newSelections:h}),e._trigger(a.Events.SelectionChanged,{sheet:e,sheetName:e._name}))}finally{e.isPaintSuspended(o);var p=d._resumeInvalidate(b);p||(e.invalidateLayout(),e.repaint())}l=!0}else if(d._dragDropExtent.fromRow>=0){i=d._dragDropExtent.rowCount;var q=d._dragDropExtent.fromRow;d._suspendInvalidate(b);var o=e.isPaintSuspended();e.isPaintSuspended(!0);try{d._copy?d._sheet.deleteRows(d._dragDropExtent.toRow,i):(j=d._dragDropExtent.toRow,k=d._dragDropExtent.fromRow,d._dragDropExtent.fromRow<d._dragDropExtent.toRow?j=d._dragDropExtent.toRow-i:k=d._dragDropExtent.fromRow+i,d._sheet.addRows(k,i),d._savedFromViewportCells&&(n.undoCellsInfo(d._sheet,d._savedFromViewportCells,k,0,3),l=!0),d._savedFromRowHeaderCells&&(n.undoCellsInfo(d._sheet,d._savedFromRowHeaderCells,k,0,2),l=!0),d._savedFromRows&&(n.undoRowsInfo(d._sheet,d._savedFromRows,k),l=!0),l||d._sheet.copyTo(j>=k?j+i:j,-1,k,-1,i,-1,d._option),d._sheet.deleteRows(j>=k?j+i:j,i),k>j&&(q=k-i)),e&&(g=e.getSelections().toArray(),e._clearSelectionImp(),e.addSelection(q,-1,i,e.getColumnCount()),h=e.getSelections(),e._trigger(a.Events.SelectionChanging,{sheet:e,sheetName:e._name,oldSelections:g,newSelections:h}),e._trigger(a.Events.SelectionChanged,{sheet:e,sheetName:e._name}))}finally{e.isPaintSuspended(o);var p=d._resumeInvalidate(b);p||(e.invalidateLayout(),e.repaint())}l=!0}}else{var r=d._dragDropExtent.fromRow<0?0:d._dragDropExtent.fromRow,s=d._dragDropExtent.fromColumn<0?0:d._dragDropExtent.fromColumn,t=d._dragDropExtent.toRow<0?0:d._dragDropExtent.toRow,u=d._dragDropExtent.toColumn<0?0:d._dragDropExtent.toColumn,v=d._dragDropExtent.fromRow<0?d._sheet.getRowCount():d._dragDropExtent.rowCount,w=d._dragDropExtent.fromColumn<0?d._sheet.getColumnCount():d._dragDropExtent.columnCount,x=e._getCalcModel();x.clear(t,u,v,w,1);var y=c,z=c;!d._copy&&d._savedFromViewportCells&&d._savedFromViewportCells.isValueSaved()&&(z=n.getValues(d._sheet,r,s,v,w)),d._savedToViewportCells&&d._savedToViewportCells.isValueSaved()&&(y=n.getValues(d._sheet,t,u,v,w)),d._suspendInvalidate(b);var o=e.isPaintSuspended();e.isPaintSuspended(!0);try{d._savedToColumnHeaderCells&&(n.undoCellsInfo(d._sheet,d._savedToColumnHeaderCells,0,u,1),l=!0),d._savedToColumns&&(n.undoColumnsInfo(d._sheet,d._savedToColumns,u),l=!0),d._savedToViewportCells&&(n.undoCellsInfo(d._sheet,d._savedToViewportCells,t,u,3),l=!0),d._savedToRowHeaderCells&&(n.undoCellsInfo(d._sheet,d._savedToRowHeaderCells,t,0,2),l=!0),d._savedToRows&&(n.undoRowsInfo(d._sheet,d._savedToRows,t),l=!0),d._savedFromColumnHeaderCells&&(n.undoCellsInfo(d._sheet,d._savedFromColumnHeaderCells,0,s,1),l=!0),d._savedFromColumns&&(n.undoColumnsInfo(d._sheet,d._savedFromColumns,s),l=!0),d._savedFromViewportCells&&(n.undoCellsInfo(d._sheet,d._savedFromViewportCells,r,s,3),l=!0),d._savedFromRowHeaderCells&&(n.undoCellsInfo(d._sheet,d._savedFromRowHeaderCells,r,0,2),l=!0),d._savedFromRows&&(n.undoRowsInfo(d._sheet,d._savedFromRows,r),l=!0),l&&e&&(g=e.getSelections().toArray(),e._clearSelectionImp(),e.addSelection(d._dragDropExtent.fromRow,d._dragDropExtent.fromColumn,d._dragDropExtent.rowCount,d._dragDropExtent.columnCount),h=e.getSelections(),e._trigger(a.Events.SelectionChanging,{sheet:e,sheetName:e._name,oldSelections:g,newSelections:h}),e._trigger(a.Events.SelectionChanged,{sheet:e,sheetName:e._name}),y&&n.raiseRangeDataChanged(e,t,u,v,w,y),z&&n.raiseRangeDataChanged(e,r,s,v,w,z))}finally{e.isPaintSuspended(o),d._resumeInvalidate(b)}}if(l&&e){if(-1!==d._savedActiveRow&&-1!==d._savedActiveColumn){var A=e.getSelections()[0];A.contains(d._savedActiveRow,d._savedActiveColumn)?e._setActiveCellImp(d._savedActiveRow,d._savedActiveColumn):e._setActiveCellImp(f(e._getFirstVisualRow(),A.row),f(e._getFirstVisualColumn(),A.col))}-2!==d._savedAcitveRowViewportIndex&&-2!==d._savedAcitveColumnViewportIndex&&-1!==d._savedActiveRow&&-1!==d._savedActiveColumn&&e.showCell(d._savedActiveRow,d._savedActiveColumn,3,3),e.invalidateLayout(),e.repaint()}return l},d}(o);b.DragDropUndoAction=D;var E=function(b){function e(a,c){if(b.call(this),this._oldValueCatch={},this._oldValueIsFormulaCatch={},this._eventNS=".cellEditaction",this._sheet=a,this._cellEditInfo=c,this._canUndo=!1,c.ranges&&1===c.endEditType){var d=c.ranges[0];if(-1===d.row&&(d.row=0,d.rowCount=a.getRowCount()),-1===d.col&&(d.col=0,d.colCount=a.getColumnCount()),1===d.rowCount&&1===d.colCount){var e=a._getsArrayFormulas(d.row,d.col,1,1);e&&e.ranges&&e.ranges.length>0&&(c.ranges=[e.ranges[0]])}}}return __extends(e,b),e.prototype.canExecute=function(){var a=this;if(a._cellEditInfo.ranges)for(var b=0;b<a._cellEditInfo.ranges.length;b++){var c=a._cellEditInfo.ranges[b];if(!a._sheet._checkArrayFormula(c.row,c.col,c.rowCount,c.colCount))return!1}else if(!a._sheet._checkArrayFormula(a._cellEditInfo.row,a._cellEditInfo.col,1,1))return!1;return!0},e.prototype.saveState=function(){var a=this;a.iteration(function(b,c){var d=a._sheet.getFormulaInformation(b,c),e=a._positionToString(b,c);d.hasFormula?!d.isArrayFormula||d.baseRange.row===b&&d.baseRange.col===c?(a._oldValueCatch[e]=d.formula,a._oldValueIsFormulaCatch[e]=d):a._oldValueIsFormulaCatch[e]=!1:a._oldValueCatch[e]=a._sheet.getValue(a._cellEditInfo.row,a._cellEditInfo.col)})},e.prototype.iteration=function(a){var b=this;if(b._cellEditInfo.ranges)for(var c=0;c<b._cellEditInfo.ranges.length;c++)for(var d=b._cellEditInfo.ranges[c],e=d.row;e<d.row+d.rowCount;e++)for(var f=d.col;f<d.col+d.colCount;f++)a(e,f);else a(b._cellEditInfo.row,b._cellEditInfo.col)},e.prototype.saveCellState=function(){},e.prototype.undo=function(){var b=this,d=b._sheet,e=b._cellEditInfo.row,f=b._cellEditInfo.col,g=d._paintSuspended;try{d._paintSuspended=!0,d._bind(a.Events.CellChanged+b._eventNS,function(b,c){"value"===c.propertyName&&d._trigger(a.Events.ValueChanged,{sheet:c.sheet,sheetName:c.sheetName,row:c.row,col:c.col,oldValue:c._oldValue,newValue:c.sheet.getValue(c.row,c.col)})}),b.iteration(function(a,g){var h=b._positionToString(a,g),i=b._oldValueIsFormulaCatch[h];if(i!==!1)if(i)i.isArrayFormula?d.setArrayFormula(a,g,i.baseRange.rowCount,i.baseRange.colCount,i.formula):d.setFormula(a,g,b._oldValueCatch[h]);else{var j=d.getFormula(a,g);j!==c&&""!==j&&d.setFormula(a,g,c),d.setValue(e,f,b._oldValueCatch[h])}})}catch(h){return!1}finally{d._unbind(a.Events.CellChanged+b._eventNS),d._paintSuspended=g}var i=d._getSheetLayout(),j=new a.Rect(i.frozenX,i.frozenY,i.width-i.frozenX,i.height-i.frozenY);return d.repaint(j),!0},e.prototype.execute=function(b){var c=this;c.saveState();var d=c._sheet,e=d._paintSuspended;try{d._paintSuspended=!0,d._bind(a.Events.CellChanged+c._eventNS,function(b,c){"value"===c.propertyName&&d._trigger(a.Events.ValueChanged,{sheet:c.sheet,sheetName:c.sheetName,row:c.row,col:c.col,oldValue:c._oldValue,newValue:c.sheet.getValue(c.row,c.col)})}),c.applyResult=c._applyEditing(b)}finally{c._sheet._unbind(a.Events.CellChanged+c._eventNS),d._paintSuspended=e}var f=d._getSheetLayout(),g=new a.Rect(f.frozenX,f.frozenY,f.width-f.frozenX,f.height-f.frozenY);d.repaint(g),c._canUndo=0===c.applyResult},e.prototype._positionToString=function(a,b){return a+"_"+b},e.prototype._stringToPosition=function(a){var b=a.split("_");return{row:parseInt(b[0],10),col:parseInt(b[1],10)}},e.prototype._validateEditingValue=function(){var a=this,b=0,c=a._cellEditInfo.row,d=a._cellEditInfo.col,e=a._sheet,f=a._cellEditInfo.newValue,g=a._cellEditInfo.hasOwnProperty("autoFormat")?a._cellEditInfo.autoFormat:!0;if(f&&f.length>0&&"="===f[0]){if(e.getDataValidator(c,d)){var h=f.substring(1);if(""!==h&&h!==e.getFormula(c,d)){var i=e.getCalcService();if(i){var j=i.parse(h,c>=0?c:0,d>=0?d:0);if(j){var k=i.evaluateParsedFormula(e._getSheetSource(),j,c,d);e.isValid(c,d,k)||(b=e._validationError(c,d,k))}}}}}else{var l=a._getValueFromEditing(c,d,f,g),m=e.isValid(c,d,l);m||(b=e._validationError(c,d,f),e._eventHandler._forceCancelSelectiong=!0)}return b},e.prototype._applyEditing=function(){var b=this,e=b._sheet,f=b._cellEditInfo.newValue,g=b._validateEditingValue();if(1===g||2===g)return g;var h,i=b._cellEditInfo.hasOwnProperty("autoFormat")?b._cellEditInfo.autoFormat:!0,j=e.parent?e.parent.canUserEditFormula():!0,k=b._cellEditInfo.row;k=k>=0?k:0;var l=b._cellEditInfo.col;l=l>=0?l:0;var m,n=e.getCalcService();if(j&&n&&f&&f.length>0&&"="===f[0])try{if(b._cellEditInfo.ranges&&1===b._cellEditInfo.endEditType){var o=b._cellEditInfo.ranges[0];return e.setArrayFormula(o.row,o.col,o.rowCount,o.colCount,f.substring(1)),g}m=n.parse(f.substring(1),k,l)}catch(p){throw e._raiseInvalidOperation(0,"string"==typeof p?p:p.message),p}else if(b._cellEditInfo.ranges&&1===b._cellEditInfo.endEditType){var o=b._cellEditInfo.ranges[0];e.clear(o.row,o.col,o.rowCount,o.colCount,3,1)}if(!m){var q=!1;/^('=)/gi.test(f)&&(f=f.substring(1),q=!0),(h===d||h===c||q)&&(h=b._getValueFromEditing(k,l,f,i))}return b.iteration(function(b,d){if(m)try{b==k&&d==l?e.setFormula(b,d,f.substring(1)):e.setFormula(b,d,n.unparse(m,b,d)),e._trigger(a.Events.UserFormulaEntered,{sheet:e,sheetName:e._name,row:b,col:d,formula:f.substring(1).toUpperCase()})}catch(g){throw e._raiseInvalidOperation(0,"string"==typeof g?g:g.message),g}else{try{e.hasFormula(b,d)&&e.setFormula(b,d,c)}catch(g){throw e._raiseInvalidOperation(0,"string"==typeof g?g:g.message),g}try{e.setValue(b,d,h)}catch(i){e.setValue(b,d,f)}}}),g},e.prototype.canUndo=function(){return this._canUndo},e.prototype._getValueFromEditing=function(b,e,f,g){if(!a.features.formatter)return f;var h=this,i=c,j=h._sheet.getActualStyle(b,e);if(j&&(j.formatter?(i=j.formatter,"string"==typeof i&&(i=new a.GeneralFormatter(i),h._sheet._editingTimeValue)):i=j._autoFormatter),!i||i instanceof a.AutoFormatter){if(g){var k={},l=c;try{l=(new a.GeneralFormatter).GetPreferredDisplayFormatter(f,k)}catch(m){}var n=c;if(i&&i instanceof a.AutoFormatter&&k.value!==c&&l&&"General"!==l.FormatString()?n=new a.AutoFormatter(l):!i&&l&&(n=new a.AutoFormatter(l)),n){var o=h._sheet.getStyleObject(b,e),p="string"==typeof o;if(!o||p){var q=new a.Style;p&&(q.parentName=o),o=q}o._autoFormatter=n,h._sheet.setStyle(b,e,o)}return k.hasOwnProperty("value")&&k.value!==d&&k.value!==c?k.value:f}return f}var r=c;try{r=i.Parse(f)}catch(m){}return r===d||r===c?f:r},e}(o);b.CellEditUndoAction=E;var F=function(a){function b(b,d){a.call(this),this._sheet=b,this._newName=d,this._oldName=c}return __extends(b,a),b.prototype.canUndo=function(){return!!this._oldName},b.prototype.canExecute=function(){var a=this;return a._sheet&&a._newName&&a._newName!==a._oldName},b.prototype.execute=function(a){var b=this,c=b._sheet;c&&b._newName&&b._newName!==b._oldName&&(b.saveState(),b._suspendInvalidate(a),c._name=b._newName,b._resumeInvalidate(a),c._refreshTabStrip())},b.prototype.saveState=function(){this._sheet&&(this._oldName=this._sheet._name)},b.prototype.undo=function(a){var b=this,c=b._sheet;return c?(b._suspendInvalidate(a),c._name=b._oldName,b._resumeInvalidate(a),c._refreshTabStrip(),!0):!1},b}(o);b.SheetRenameUndoAction=F;var G=function(a){function b(b,c){a.call(this),this._sheet=b,.25>c?c=.25:c>4&&(c=4),this._zoomFactor=c,this._prevZoomFactor=-1}return __extends(b,a),b.prototype.canExecute=function(){var a=this;return a._sheet&&a._sheet.parent._allowUserZoom&&a._sheet._zoomFactor!==a._zoomFactor},b.prototype.execute=function(a){var b=this,c=b._sheet;if(b.saveState(),c&&(!c.parent||c.parent._allowUserZoom===!0)&&c._zoomFactor!==b._zoomFactor){c.isEditing()===!0&&c.endEdit(),b._suspendInvalidate(a);var d=c.isPaintSuspended();c.isPaintSuspended(!0),c.zoom(b._zoomFactor),c.isPaintSuspended(d);var e=b._resumeInvalidate(a);e||(c.invalidateLayout(),c.repaint())}},b.prototype.canUndo=function(){return this._sheet&&this._prevZoomFactor>0},b.prototype.saveState=function(){this._sheet&&(this._prevZoomFactor=this._sheet._zoomFactor)},b.prototype.undo=function(a){var b=this,c=b._sheet;if(c){b._suspendInvalidate(a);var d=c.isPaintSuspended();c.isPaintSuspended(!0),c.zoom(b._prevZoomFactor),c.isPaintSuspended(d);var e=b._resumeInvalidate(a);return e||(c.invalidateLayout(),c.repaint()),!0}return!1},b}(o);b.ZoomUndoAction=G;var H=function(){function a(a,b){this.value=a,this.formulaInfo=b}return a}(),I=function(b){function e(a,d){b.call(this),this._cachedFormulaInfos=[],this._eventNS=".clearRangeAction";var e=this;e._sheet=a,e._clearRange=d,e._cachedFilteredColumns=c,e._cachedValues=c,e._cachedTables=c}return __extends(e,b),e.prototype.execute=function(){var b=this;b.saveState();var c=b._sheet;if(c){var d=c._getActualRange(b._clearRange);if(d.colCount>0&&d.rowCount>0)try{c._bind(a.Events.CellChanged+b._eventNS,function(b,d){"value"===d.propertyName&&c._trigger(a.Events.ValueChanged,{sheet:d.sheet,sheetName:d.sheetName,row:d.row,col:d.col})});var e=c.isPaintSuspended();c.isPaintSuspended(!0),c.suspendEvent(),c.clear(d.row,d.col,d.rowCount,d.colCount,3,1),c.resumeEvent(),c.isPaintSuspended(e),n.raiseRangeDataChanged(c,d.row,d.col,d.rowCount,d.colCount)}finally{b._sheet._unbind(a.Events.CellChanged+b._eventNS)}}},e.prototype.canExecute=function(){var a=this._sheet,b=this._clearRange;return!(a.isProtected===!0&&a._isAnyCellInRangeLocked(b))&&a._checkArrayFormula(b.row,b.col,b.rowCount,b.colCount)},e.prototype.canUndo=function(){return!!this._cachedValues},e.prototype.saveState=function(){var a=this,b=a._sheet;if(b){a._cachedTables=[];var e=b.getTables();if(e&&e.length>0)for(var f=0;f<e.length;f++){var g=e[f];a._clearRange.containsRange(g.range())&&a._cachedTables.push(g)}a._cachedFilteredColumns=[];var h,i,j=b.rowFilter();if(j&&j.range&&j.isFiltered()){h=j.range.row;var k=j.range.rowCount;if(j.showFilterButton&&(h=j.range.row-1,k=j.range.rowCount+1,0>h&&(h=-1,k=-1)),(-1===a._clearRange.row||a._clearRange.row<=h&&h+k<=a._clearRange.row+a._clearRange.rowCount)&&(-1===a._clearRange.col||a._clearRange.col<=j.range.col&&j.range.col+j.range.colCount<=a._clearRange.col+a._clearRange.colCount)){i=j.range.col<0?0:j.range.col;for(var l=j.range.colCount<0?b.getColumnCount():j.range.colCount,m=0;l>m;m++)j.isColumnFiltered(i+m)&&a._cachedFilteredColumns.push(i+m)}}var n=b._getActualRange(a._clearRange);if(n.colCount>0&&n.rowCount>0){a._cachedValues=[n.row+n.rowCount];for(var f=0;f<n.rowCount;f++){a._cachedValues[n.row+f]=[n.col+n.colCount],a._cachedFormulaInfos[n.row+f]=[];for(var o=0;o<n.colCount;o++){h=n.row+f,i=n.col+o;var p=b.getFormulaInformation(h,i);if(p.hasFormula)a._cachedValues[h][i]=!p.isArrayFormula||p.baseRange.row===h&&p.baseRange.col===i?new H(p.formula,p):-1;else{var q=b.getValue(h,i);q!==d&&q!==c&&(a._cachedValues[h][i]=new H(q,d))}}}}}},e.prototype.undo=function(){var b=this,d=b._sheet;if(d){var e,f=!1;if(b._cachedTables&&b._cachedTables.length>0){var g=b._cachedTables,h=g.length;for(e=0;h>e;e++)d._addTableInternal(g[e])}var i=d._getActualRange(b._clearRange);if(b._cachedValues&&i.colCount>0&&i.rowCount>0)try{d._bind(a.Events.CellChanged+b._eventNS,function(b,c){"value"===c.propertyName&&d._trigger(a.Events.ValueChanged,{sheet:c.sheet,sheetName:c.sheetName,row:c.row,col:c.col})});var j=i.rowCount,k=i.colCount,l=d.isPaintSuspended();for(d.isPaintSuspended(!0),d.suspendEvent(),e=0;j>e;e++)for(var m=0;k>m;m++){var o=i.row+e,p=i.col+m,q=b._cachedValues[o][p];if(-1!==q)if(q)if(q.formulaInfo){var r=q.formulaInfo;r&&r.isArrayFormula?d.setArrayFormula(o,p,r.baseRange.rowCount,r.baseRange.colCount,r.formula):d.setFormula(o,p,q.value)}else d.setFormula(o,p,c),d.setValue(o,p,q.value);else d.setFormula(o,p,c),d.setValue(o,p,c)}d.resumeEvent(),d.isPaintSuspended(l),n.raiseRangeDataChanged(d,i.row,i.col,i.rowCount,i.colCount),f=!0}finally{d._unbind(a.Events.CellChanged+b._eventNS)}var s=d.rowFilter();if(s&&b._cachedFilteredColumns&&b._cachedFilteredColumns.length>0)for(e=0;e<b._cachedFilteredColumns.length;e++){var t=b._cachedFilteredColumns[e];s.filter(t)}if(f)return d.repaint(),!0}return!1},e}(o);b.ClearRangeValueUndoAction=I;var J=function(a){function b(b,d){a.call(this),this._cachedActions=[];var e=this;if(e._sheet=b,e._cachedActions=c,d&&d.length>0){e._cachedActions=new Array;for(var f=0;f<d.length;f++)e._cachedActions[f]=new I(b,d[f])}}return __extends(b,a),b.prototype.canExecute=function(a){if(this._cachedActions){for(var b=0;b<this._cachedActions.length;b++){var c=this._cachedActions[b];if(!c.canExecute(a))return!1}return!0}return!1},b.prototype.execute=function(a){var b=this;if(b.saveState(),b._cachedActions){b._suspendInvalidate(a);for(var c=0;c<b._cachedActions.length;c++){var d=b._cachedActions[c];d.execute(a)}var e=b._resumeInvalidate(a);e||(b._sheet.invalidateLayout(),b._sheet.repaint())}},b.prototype.canUndo=function(){if(this._cachedActions){for(var a=0;a<this._cachedActions.length;a++){var b=this._cachedActions[a];if(!b.canUndo())return!1}return!0}return!1},b.prototype.saveState=function(){if(this._cachedActions)for(var a=0;a<this._cachedActions.length;a++){var b=this._cachedActions[a];b.saveState()}},b.prototype.undo=function(a){var b=this;if(b._cachedActions){for(var c=b._cachedActions.length-1;c>=0;c--){var d=b._cachedActions[c];b._suspendInvalidate(a);var e=d.undo(a),f=b._resumeInvalidate(a);if(!e)return!1;f||(b._sheet.invalidateLayout(),b._sheet.repaint())}return!0}return!1},b}(o);b.ClearValueUndoAction=J;var K=function(b){function d(a,c){b.call(this);var d=this;d._workSheet=a,d._dragFillExtent=c,4===d._dragFillExtent.autoFillType?d._clearValueUndoAction=new J(a,[d._dragFillExtent.fillRange]):d.initWholeFilledRange(),d._fillSeries=0===d._dragFillExtent.fillDirection||1===d._dragFillExtent.fillDirection?1:0}return __extends(d,b),d.prototype.canExecute=function(){var a=this,b=a._workSheet,c=a._dragFillExtent;return b.isProtected&&b._isAnyCellInRangeLocked(c.fillRange)?!1:b._checkArrayFormula(c.fillRange.row,c.fillRange.col,c.fillRange.rowCount,c.fillRange.colCount)?4===this._dragFillExtent.autoFillType?this.canExecuteDragClear():this.canExecuteDragFill():!1},d.prototype.canExecuteDragClear=function(){return!0},d.prototype.canExecuteDragFill=function(){var a=this._dragFillExtent.startRange,b=this._dragFillExtent.fillRange;return!b.intersect(a.row,a.col,a.rowCount,a.colCount)},d.prototype.execute=function(a){var b=this;if(b.canExecute(a)){var d=b._workSheet,e=d.getSelections()?d.getSelections().toArray():c,f=!1;try{b._suspendInvalidate(d),d.suspendCalcService(),d.suspendEvent(),b.saveState();var g=d.isPaintSuspended();d.isPaintSuspended(!0),4===b._dragFillExtent.autoFillType?b.executeDragFillClear(d):b.executeDragFill(d)}finally{if(d.isPaintSuspended(g),d.resumeCalcService(),d.resumeEvent(),b._savedFilledViewportCells&&b._savedFilledViewportCells.isValueSaved()){var h=b._dragFillExtent.fillRange;
n.raiseRangeDataChanged(d,h.row,h.col,h.rowCount,h.colCount,b._savedFilledViewportCells.getValues())}var i=d.getSelections()?d.getSelections().toArray():c;d._raiseSelectionChanging(e,i)&&d._raiseSelectionChanged(),f=b._resumeInvalidate(d)}f||(d.invalidateLayout(),d.repaint())}},d.prototype.executeDragFillClear=function(b){var c=this;c._clearValueUndoAction.execute(b);var d=c._dragFillExtent.startRange,e=c._dragFillExtent.fillRange;if(!d.equals(e)){var g;0===c._fillSeries?(g=new a.Range(d.row,d.col,f(1,d.rowCount-e.rowCount),d.colCount),b._setActiveCellImp(f(b._getFirstVisualRow(),g.row),f(b._getFirstVisualColumn(),g.col),b.activeRowViewportIndex,b.activeColViewportIndex),b._clearSelectionImp(),b.addSelection(g.row,g.col,g.rowCount,g.colCount)):(g=new a.Range(d.row,d.col,d.rowCount,f(1,d.colCount-e.colCount)),b._setActiveCellImp(f(b._getFirstVisualRow(),g.row),f(b._getFirstVisualColumn(),g.col),b.activeRowViewportIndex,b.activeColViewportIndex),b._clearSelectionImp(),b.addSelection(g.row,g.col,g.rowCount,g.colCount))}},d.prototype.executeDragFill=function(b){var d,e,g=this,h=g._workSheet,i=g._dragFillExtent.startRange,j=g._dragFillExtent.fillRange;if(1===g._dragFillExtent.autoFillType)g.clearData(j,!0),h.fillAuto(i,g._wholeFillRange,g._fillSeries);else if(0===g._dragFillExtent.autoFillType){var k=1019;g.copyCells(i,j,k)}else if(2===g._dragFillExtent.autoFillType)g.copyCells(i,j,64);else if(3===g._dragFillExtent.autoFillType){g.clearData(j,!0);var l=!(1!==i.rowCount||1!==i.colCount||-1===i.row&&-1!==i.col||-1===i.col&&-1!==i.row);if(l){var m=187;g.copyCells(i,j,m)}else{var o=g.adjustRange(g._wholeFillRange),p=new a._GcSheetModel(o.rowCount,o.colCount,c);for(d=0;d<o.rowCount;d++)for(e=0;e<o.colCount;e++)p.setStyle(d,e,n.getStyleObject(g._workSheet,o.row+d,o.col+e,3));for(h.fillAuto(i,g._wholeFillRange,g._fillSeries),d=0;d<o.rowCount;d++)for(e=0;e<o.colCount;e++)n.setStyleObject(g._workSheet,o.row+d,o.col+e,3,p.getStyle(d,e))}}h._setActiveCellImp(f(b._getFirstVisualRow(),g._wholeFillRange.row),f(b._getFirstVisualColumn(),g._wholeFillRange.col),b.activeRowViewportIndex,b.activeColViewportIndex),b._selectionModel&&b._clearSelectionImp(),h.addSelection(g._wholeFillRange.row,g._wholeFillRange.col,g._wholeFillRange.rowCount,g._wholeFillRange.colCount)},d.prototype.clearData=function(a,b){var c=1;this._workSheet.clearCore(a.row,a.col,a.rowCount,a.colCount,3,c,b)},d.prototype.adjustRange=function(b){var c=-1!==b.row?b.row:0,d=-1!==b.col?b.col:0,e=-1!==b.rowCount?b.rowCount:this._workSheet.getRowCount(),f=-1!==b.colCount?b.colCount:this._workSheet.getColumnCount();return new a.Range(c,d,e,f)},d.prototype.copyCells=function(a,b,c){var d,e,f,g,i,j,k,l,m=this,n=m._workSheet,o=m.adjustRange(a),p=m.adjustRange(b);if(0===m._fillSeries){var q=h(p.rowCount/o.rowCount);for(d=0;q>d;d++)e=o.row,f=o.col,3===m._dragFillExtent.fillDirection?g=p.row+d*o.rowCount:(j=p.row+p.rowCount,g=j-(d+1)*o.rowCount),i=p.col,k=o.rowCount,l=o.colCount,n.copyToCore(e,f,g,i,k,l,c,!0);var r=p.rowCount%o.rowCount;if(0!==r){if(3===m._dragFillExtent.fillDirection)e=o.row;else{var s=o.rowCount-(p.rowCount-o.rowCount*q);e=o.row+s}f=o.col,3===m._dragFillExtent.fillDirection?g=p.row+o.rowCount*q:(j=p.row+p.rowCount,g=j-q*o.rowCount-r),i=p.col,k=r,l=o.colCount,n.copyToCore(e,f,g,i,k,l,c,!0)}}else{var t=h(p.colCount/o.colCount);for(d=0;t>d;d++){if(e=o.row,f=o.col,g=p.row,1===m._dragFillExtent.fillDirection)i=p.col+d*o.colCount;else{var u=p.col+p.colCount;i=u-(d+1)*o.colCount}k=o.rowCount,l=o.colCount,n.copyToCore(e,f,g,i,k,l,c,!0)}var v=p.colCount%o.colCount;if(0!==v){if(e=o.row,1===m._dragFillExtent.fillDirection)f=o.col;else{var w=o.colCount-(p.colCount-o.colCount*t);f=o.col+w}if(g=p.row,1===m._dragFillExtent.fillDirection)i=p.col+o.colCount*t;else{var x=p.col+p.colCount;i=x-t*o.colCount-v}k=o.rowCount,l=v,n.copyToCore(e,f,g,i,k,l,c,!0)}}},d.prototype.saveState=function(){4===this._dragFillExtent.autoFillType?this.saveDragClearState():this.saveDragFillState()},d.prototype.saveDragClearState=function(){this._clearValueUndoAction.saveState()},d.prototype.saveDragFillState=function(){var a=this;a._savedFilledViewportCells=a.saveRangeStates(a._dragFillExtent.fillRange),a._savedStartViewportCells=a.saveRangeStates(a._dragFillExtent.startRange)},d.prototype.saveRangeStates=function(a){var b=this.adjustRange(a),c=new k(b.rowCount,b.colCount);return n.saveViewportInfo(this._workSheet,c,b.row,b.col,1023),c},d.prototype.undo=function(){var a=this,b=a._workSheet,c=!1,d=!1;try{a._suspendInvalidate(b),b.suspendCalcService();var e=b.isPaintSuspended();b.isPaintSuspended(!0),c=a._undo(b)}finally{b.isPaintSuspended(e),b.resumeCalcService(),d=a._resumeInvalidate(b)}return d||(b.invalidateLayout(),b.repaint()),c},d.prototype._undo=function(a){var b,d=this,e=a.getSelections()?a.getSelections().toArray():c,f=c,g=d._dragFillExtent.fillRange;d._savedFilledViewportCells&&d._savedFilledViewportCells.isValueSaved()&&(f=n.getValues(d._workSheet,g.row,g.col,g.rowCount,g.colCount)),b=4===d._dragFillExtent.autoFillType?d.undoDragClear(a):d.undoDragFill(a),a._skipCloseDragFillSmartTag!==!0&&a._closeDragFillPopup(),f&&n.raiseRangeDataChanged(a,g.row,g.col,g.rowCount,g.colCount,f);var h=a.getSelections()?a.getSelections().toArray():c;return a._raiseSelectionChanging(e,h)&&a._raiseSelectionChanged(),b},d.prototype.undoDragClear=function(a){var b=this,c=b._clearValueUndoAction.undo(a);return a._setActiveCellImp(f(a._getFirstVisualRow(),b._dragFillExtent.startRange.row),f(a._getFirstVisualColumn(),b._dragFillExtent.startRange.col),a.activeRowViewportIndex,a.activeColViewportIndex),a._clearSelectionImp(),a.addSelection(b._dragFillExtent.startRange.row,b._dragFillExtent.startRange.col,b._dragFillExtent.startRange.rowCount,b._dragFillExtent.startRange.colCount),c},d.prototype.undoDragFill=function(a){var b=this;b._suspendInvalidate(a),a.suspendCalcService();try{b.undoRangeStates(b._savedFilledViewportCells,b._dragFillExtent.fillRange),b.undoRangeStates(b._savedStartViewportCells,b._dragFillExtent.startRange),a._setActiveCellImp(f(a._getFirstVisualRow(),b._dragFillExtent.startRange.row),f(a._getFirstVisualColumn(),b._dragFillExtent.startRange.col),a.activeRowViewportIndex,a.activeColViewportIndex),a._clearSelectionImp(),a.addSelection(b._dragFillExtent.startRange.row,b._dragFillExtent.startRange.col,b._dragFillExtent.startRange.rowCount,b._dragFillExtent.startRange.colCount)}finally{a.resumeCalcService(),b._resumeInvalidate(a)}return a.invalidateLayout(),!0},d.prototype.undoRangeStates=function(a,b){var c=this.adjustRange(b);n.undoCellsInfo(this._workSheet,a,c.row,c.col,3)},d.prototype.initWholeFilledRange=function(){var b=this,c=0,d=0,e=0,f=0,g=b._dragFillExtent.fillDirection,h=b._dragFillExtent.startRange,i=b._dragFillExtent.fillRange;0===g||1===g?(c=h.row,d=h.rowCount,e=0===g?i.col:h.col,f=h.colCount+i.colCount):(c=2===g?i.row:h.row,d=h.rowCount+i.rowCount,e=h.col,f=h.colCount),b._wholeFillRange=new a.Range(c,e,d,f)},d}(o);b.DragFillUndoAction=K;var L=function(a){function b(b,c,d,e,f){a.call(this);var g=this;g._sheet=b,g._fromSheet=c,g._toSheet=d,g._pasteExtent=e,g._pasteOption=f}return __extends(b,a),b.prototype.canUndo=function(){return!0},b.prototype.canExecute=function(){var a=this._sheet,b=this._pasteExtent.targetRange,c=this._pasteExtent.sourceRange;return!(a.isProtected&&a._isAnyCellInRangeLocked(b)||!a._checkArrayFormula(b.row,b.col,b.rowCount,b.colCount)||this._pasteExtent.isCutting&&(a.isProtected&&a._isAnyCellInRangeLocked(c)||!a._checkArrayFormula(c.row,c.col,c.rowCount,c.colCount)))},b.prototype.saveState=function(){var a=this;a.initSaveState();var c=a._pasteExtent.isCutting,d=b.convertPasteOption(a._pasteOption),e=a._pasteExtent.sourceRange,f=a._pasteExtent.targetRange;if(a._fromSheet&&e&&c){var g=e.row<0?0:e.row,h=e.col<0?0:e.col,i=e.row<0?a._fromSheet.getRowCount():e.rowCount,o=e.col<0?a._fromSheet.getColumnCount():e.colCount;if(e.row<0&&e.col<0&&f.row<0&&f.col<0&&a._fromSheet._name!==a._toSheet._name){var p=new j;n.saveSheetInfo(a._fromSheet,p,d),a._savedFromSheetInfo=p}if(e.row<0){var q=new k(a._fromSheet.getRowCount(1),o),r=new l(o);n.saveColumnHeaderInfo(a._fromSheet,q,r,h,d),a._savedFromColumnHeaderCells=q,a._savedFromColumns=r}if(e.col<0){var s=new k(i,a._fromSheet.getColumnCount(2)),t=new m(i);n.saveRowHeaderInfo(a._fromSheet,s,t,g,d),a._savedFromRowHeaderCells=s,a._savedFromRows=t}var u=new k(i,o);n.saveViewportInfo(a._fromSheet,u,g,h,d),a._savedFromViewportCells=u}var v=f.row<0?0:f.row,w=f.col<0?0:f.col,x=f.row<0?a._toSheet.getRowCount():f.rowCount,y=f.col<0?a._toSheet.getColumnCount():f.colCount;if(a._fromSheet&&e){if(e.row<0&&e.col<0&&f.row<0&&f.col<0&&a._fromSheet._name!==a._toSheet._name){var z=new j;n.saveSheetInfo(a._toSheet,z,d),a._savedToSheetInfo=z}if(e.row<0){var A=new k(a._toSheet.getRowCount(1),y),B=new l(y);n.saveColumnHeaderInfo(a._toSheet,A,B,w,d),a._savedToColumnHeaderCells=A,a._savedToColumns=B}if(e.col<0){var C=new k(x,a._toSheet.getColumnCount(2)),D=new m(x);n.saveRowHeaderInfo(a._toSheet,C,D,v,d),a._savedToRowHeaderCells=C,a._savedToRows=D}}var E=new k(x,y);n.saveViewportInfo(a._toSheet,E,v,w,d),a._savedToViewportCells=E},b.prototype.initSaveState=function(){var a=this;a._savedFromSheetInfo=c,a._savedFromColumnHeaderCells=c,a._savedFromColumns=c,a._savedFromViewportCells=c,a._savedFromRowHeaderCells=c,a._savedFromRows=c,a._savedToSheetInfo=c,a._savedToColumnHeaderCells=c,a._savedToColumns=c,a._savedToViewportCells=c,a._savedToRowHeaderCells=c,a._savedToRows=c},b.prototype.pasteOption=function(){return this._pasteOption},b.prototype.pasteRange=function(){return this._pasteExtent.targetRange},b.prototype.execute=function(a){var b=this,c=b._pasteExtent.sourceRange,d=b._pasteExtent.targetRange;if((!b._fromSheet||!c||b._fromSheet._isValidRange(c.row,c.col,c.rowCount,c.colCount,b._fromSheet.getRowCount(),b._fromSheet.getColumnCount()))&&b._toSheet&&d&&b._toSheet._isValidRange(d.row,d.col,d.rowCount,d.colCount,b._toSheet.getRowCount(),b._toSheet.getColumnCount())){b.saveState(),b._suspendInvalidate(a),b._toSheet.suspendEvent(),b._fromSheet&&b._fromSheet.suspendEvent();try{b._toSheet._clipboardPaste(b._fromSheet,c,b._toSheet,d,b._pasteExtent.isCutting,b._pasteExtent.clipboardText,b._pasteOption)}finally{b._toSheet.resumeEvent(),b._fromSheet&&b._fromSheet.resumeEvent(),b._resumeInvalidate(a);var e=b._sheet;e&&(b._pasteExtent.isCutting&&b._savedFromViewportCells&&b._savedFromViewportCells.isValueSaved()&&b._fromSheet&&n.raiseRangeDataChanged(b._fromSheet,c.row,c.col,c.rowCount,c.colCount,b._savedFromViewportCells.getValues()),b._savedToViewportCells&&b._savedToViewportCells.isValueSaved()&&b._toSheet&&n.raiseRangeDataChanged(b._toSheet,d.row,d.col,d.rowCount,d.colCount,b._savedToViewportCells.getValues()))}}},b.prototype.undo=function(a){var b=this,d=b._pasteExtent.sourceRange,e=b._pasteExtent.targetRange;if(!b._toSheet||!e)return!1;if(!b._toSheet._isValidRange(e.row,e.col,e.rowCount,e.colCount,b._toSheet.getRowCount(),b._toSheet.getColumnCount()))return!1;if(b._fromSheet&&d){if(!b._fromSheet._isValidRange(d.row,d.col,d.rowCount,d.colCount,b._fromSheet.getRowCount(),b._fromSheet.getColumnCount()))return!1;if(b._fromSheet&&b._fromSheet._name===b._toSheet._name&&b._toSheet.parent&&!b._toSheet.parent.sheets.contains(b._fromSheet))return!1}b._suspendInvalidate(a);var f=!1;try{var g=c,h=c,i=e.row<0?0:e.row,j=e.col<0?0:e.col,k=e.row<0?b._toSheet.getRowCount():e.rowCount,l=e.col<0?b._toSheet.getColumnCount():e.colCount;b._savedToSheetInfo&&(n.undoSheetInfo(b._toSheet,b._savedToSheetInfo),f=!0),b._savedToViewportCells&&b._savedToViewportCells.isValueSaved()&&(g=n.getValues(b._toSheet,i,j,k,l)),b._savedToColumnHeaderCells&&(n.undoCellsInfo(b._toSheet,b._savedToColumnHeaderCells,0,j,1),f=!0),b._savedToColumns&&(n.undoColumnsInfo(b._toSheet,b._savedToColumns,j),f=!0),b._savedToViewportCells&&(n.undoCellsInfo(b._toSheet,b._savedToViewportCells,i,j,3),f=!0),b._savedToRowHeaderCells&&(n.undoCellsInfo(b._toSheet,b._savedToRowHeaderCells,i,0,2),f=!0),b._savedToRows&&(n.undoRowsInfo(b._toSheet,b._savedToRows,i),f=!0);var m=0,o=0,p=0,q=0;b._fromSheet&&d&&(m=d.row<0?0:d.row,o=d.col<0?0:d.col,p=d.row<0?b._fromSheet.getRowCount():d.rowCount,q=d.col<0?b._fromSheet.getColumnCount():d.colCount,b._savedFromViewportCells&&b._savedFromViewportCells.isValueSaved()&&(h=n.getValues(b._fromSheet,m,o,p,q)),b._savedFromColumnHeaderCells&&(n.undoCellsInfo(b._fromSheet,b._savedFromColumnHeaderCells,0,o,1),f=!0),b._savedFromColumns&&(n.undoColumnsInfo(b._fromSheet,b._savedFromColumns,o),f=!0),b._savedFromViewportCells&&(n.undoCellsInfo(b._fromSheet,b._savedFromViewportCells,m,o,3),f=!0),b._savedFromRowHeaderCells&&(n.undoCellsInfo(b._fromSheet,b._savedFromRowHeaderCells,m,0,2),f=!0),b._savedFromRows&&(n.undoRowsInfo(b._fromSheet,b._savedFromRows,m),f=!0));var r=a;f&&r&&(g&&b._toSheet&&n.raiseRangeDataChanged(b._toSheet,i,j,k,l,g),h&&b._fromSheet&&n.raiseRangeDataChanged(b._fromSheet,m,o,p,q,h))}finally{b._resumeInvalidate(a)}return f},b.convertPasteOption=function(a){var b=0;return(0===a||1===a)&&(b|=1),(0===a||2===a)&&(b|=64),(0===a||3===a)&&(b|=2),0===a&&(b|=32,b|=16,b|=256,b|=4,b|=512),b},b}(o);b.ClipboardPasteRangeUndoAction=L;var M=function(b){function c(c,d,e,f,g){if(b.call(this),this._sheet=c,!e)throw new Error(a.SR.Exp_DestSheetIsNull);if(!f)throw new Error(a.SR.Exp_PasteExtentIsNull);if(f.pastedRanges&&f.pastedRanges.length>0){this._cachedActions=new Array;for(var h=0;h<f.pastedRanges.length;h++){var i={sourceRange:f.fromRange,targetRange:f.pastedRanges[h],isCutting:f.isCutting,clipboardText:f.clipboardText};this._cachedActions[h]=new L(c,d,e,i,g)}}}return __extends(c,b),c.prototype.execute=function(a){var b=this;if(b._cachedActions){var c=b._sheet;b._suspendInvalidate(c);var d=c.isPaintSuspended();c.isPaintSuspended(!0);try{for(var e=0;e<b._cachedActions.length;e++){var f=b._cachedActions[e];if(c){var g=c._raiseClipboardPasting(f.pasteRange(),f.pasteOption());g||(f.execute(a),c._raiseClipboardPasted(f.pasteRange(),f.pasteOption()))}else f.execute(a)}b.refreshSelection(a)}finally{c.isPaintSuspended(d);var h=b._resumeInvalidate(c);h||b.refreshUI(a)}}},c.prototype.refreshSelection=function(){var a=this,b=a._sheet;if(b&&a._cachedActions){var c=b.getSelections().toArray();if(b._clearSelectionImp(),a._cachedActions.length>1)for(var d=0;d<a._cachedActions.length;d++){var e=a._cachedActions[d],g=e.pasteRange();b.addSelection(g.row,g.col,g.rowCount,g.colCount)}else if(a._cachedActions.length>0){var h=a._cachedActions[0].pasteRange();b.addSelection(h.row,h.col,h.rowCount,h.colCount),h.contains(b._activeRowIndex,b._activeColIndex)||b._setActiveCellImp(f(b._getFirstVisualRow(),h.row),f(b._getFirstVisualColumn(),h.col),b.activeRowViewportIndex,b.activeColViewportIndex)}b._raiseSelectionChanging(c,b.getSelections().toArray())&&b._raiseSelectionChanged()}},c.prototype.refreshUI=function(){var a=this._sheet;a&&(a.invalidateLayout(),a.repaint())},c.prototype.canExecute=function(a){if(this._cachedActions){for(var b=0;b<this._cachedActions.length;b++){var c=this._cachedActions[b];if(!c.canExecute(a))return!1}return!0}return!1},c.prototype.canUndo=function(){if(this._cachedActions){for(var a=0;a<this._cachedActions.length;a++){var b=this._cachedActions[a];if(!b.canUndo())return!1}return!0}return!1},c.prototype.saveState=function(){if(this._cachedActions)for(var a=0;a<this._cachedActions.length;a++){var b=this._cachedActions[a];b.saveState()}},c.prototype.undo=function(a){var b=this;if(b._cachedActions){var c=b._sheet,d=!0;b._suspendInvalidate(c);var e=c.isPaintSuspended();c.isPaintSuspended(!0);try{for(var f=0;f<b._cachedActions.length;f++){var g=b._cachedActions[f];d=d&&g.undo(a)}}finally{c.isPaintSuspended(e);var h=b._resumeInvalidate(c);h||b.refreshUI(a)}return d}return!1},c}(o);b.ClipboardPasteUndoAction=M;var N=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.init=function(a,b){this._sheet=a,this._floatingObjectExtent=b,this._savedFloatingObjects=[]},b.prototype.refreshUI=function(){var a=this._sheet;a&&(a.invalidateLayout(),a.repaint())},b.prototype.canExecute=function(){return this._sheet._hasFloatingObjectsSelected()?!0:!1},b.prototype.canUndo=function(){return this._savedFloatingObjects&&this._savedFloatingObjects.length>0?!0:!1},b.prototype.saveState=function(){var a=this;if(a._floatingObjectExtent&&a._floatingObjectExtent.names instanceof Array)for(var b=0,c=a._floatingObjectExtent.names.length;c>b;b++){var d=a._sheet._findFloatingObjectInternal(a._floatingObjectExtent.names[b]);d&&a._savedFloatingObjects.push(d)}},b}(o);b.FloatingObjectUndoActionBase=N;var O=function(b){function c(a,c){b.call(this),this.init(a,c)}return __extends(c,b),c.prototype.execute=function(b){var c=this;if(a.features.floatingObject&&c._floatingObjectExtent&&c._floatingObjectExtent.names instanceof Array){c.saveState();var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._floatingObjectExtent.names.length;g>f;f++){var h=d._findFloatingObjectInternal(c._floatingObjectExtent.names[f]);h&&(d._removeFloatingObjectInternal(c._floatingObjectExtent.names[f]),h.isSelected(!1))}d._loadAndSetSheetSelections(),d.isPaintSuspended(e);var i=c._resumeInvalidate(b);i||c.refreshUI(b)}},c.prototype.undo=function(b){var c=this;if(a.features.floatingObject&&c._savedFloatingObjects&&c._savedFloatingObjects.length>0){var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._savedFloatingObjects.length;g>f;f++){var h=c._savedFloatingObjects[f];h.isSelected(!0),d._addFloatingOjectInternal(h)}d._saveAndClearSheetSelections(),c._savedFloatingObjects.length=0,d.isPaintSuspended(e);var i=c._resumeInvalidate(b);return i||c.refreshUI(b),!0}return!1},c}(N);b.DeleteFloatingObjectUndoAction=O;var P=function(b){function c(a,c,d){b.call(this),this.init(a,c),this._movingSettings=d}return __extends(c,b),c.prototype.execute=function(b){var c=this;if(a.features.floatingObject&&c._floatingObjectExtent&&c._floatingObjectExtent.names instanceof Array){c.saveState();var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._floatingObjectExtent.names.length;g>f;f++){var h=d._findFloatingObjectInternal(c._floatingObjectExtent.names[f]),i=h.position();h.position(new a.Point(i.x+c._movingSettings.offsetX,i.y+c._movingSettings.offsetY))}d.isPaintSuspended(e);var j=c._resumeInvalidate(b);j||c.refreshUI(b)}},c.prototype.undo=function(b){var c=this;if(a.features.floatingObject&&c._savedFloatingObjects&&c._savedFloatingObjects.length>0){var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._savedFloatingObjects.length;g>f;f++){var h=c._savedFloatingObjects[f],i=h.position();h.position(new a.Point(i.x-c._movingSettings.offsetX,i.y-c._movingSettings.offsetY))}c._savedFloatingObjects.length=0,d.isPaintSuspended(e);var j=c._resumeInvalidate(b);return j||c.refreshUI(b),!0}return!1},c}(N);b.MovingFloatingObjectUndoAction=P;var Q=function(b){function c(a,c,d){b.call(this),this.init(a,c),this._resizingSettings=d}return __extends(c,b),c.prototype.execute=function(b){var c=this;if(a.features.floatingObject&&c._floatingObjectExtent&&c._floatingObjectExtent.names instanceof Array){c.saveState();var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._floatingObjectExtent.names.length;g>f;f++){var h=d._findFloatingObjectInternal(c._floatingObjectExtent.names[f]),i=h.position();h.width(h.width()+c._resizingSettings.offsetWidth),h.height(h.height()+c._resizingSettings.offsetHeight),h.position(new a.Point(i.x+c._resizingSettings.offsetX,i.y+c._resizingSettings.offsetY))}d.isPaintSuspended(e);var j=c._resumeInvalidate(b);j||c.refreshUI(b)}},c.prototype.undo=function(b){var c=this;if(a.features.floatingObject&&c._savedFloatingObjects&&c._savedFloatingObjects.length>0){var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._savedFloatingObjects.length;g>f;f++){var h=c._savedFloatingObjects[f],i=h.position();h.position(new a.Point(i.x-c._resizingSettings.offsetX,i.y-c._resizingSettings.offsetY)),h.width(h.width()-c._resizingSettings.offsetWidth),h.height(h.height()-c._resizingSettings.offsetHeight)}c._savedFloatingObjects.length=0,d.isPaintSuspended(e);var j=c._resumeInvalidate(b);return j||c.refreshUI(b),!0}return!1},c}(N);b.ResizingFloatingObjectUndoAction=Q;var R=15,S=9007199254740992,T=function(b){function d(a,d,e){b.call(this),this._sheet=c,this._fromSheet=c,this._floatingObjectExtent=c,this._savedObjects=c;var f=this;f._sheet=a,f._fromSheet=e,f._floatingObjectExtent=d,f._savedObjects=[],f._activeRowIndex=f._sheet.getActiveRowIndex(),f._activeColumnIndex=f._sheet.getActiveColumnIndex()}return __extends(d,b),d.prototype.execute=function(b){var c=this;if(a.features.floatingObject&&c._floatingObjectExtent&&c._floatingObjectExtent.names&&c._floatingObjectExtent.names.length>0){var d=c._sheet,f=c._fromSheet._eventHandler;c._suspendInvalidate(b);var g=d.isPaintSuspended();d.isPaintSuspended(!0);var h,i,j=c._floatingObjectExtent.names,k=[],l=S,m=S;for(h=0,i=j.length;i>h;h++){var n=f._getClipboardFloatingObjectData().findByPropertyName(j[h]).position();l=e(l,n.x),m=e(m,n.y)}var o=[];for(h=0,i=j.length;i>h;h++){var n=f._getClipboardFloatingObjectData().findByPropertyName(j[h]).position();o.push(new a.Point(n.x-l,n.y-m))}var p=0,q=0;if(d._hasFloatingObjectsSelected()){var r=S,s=S,t=d._floatingObjectArray;for(h=0,i=t.length;i>h;h++){var u=t[h];if(u&&u.isSelected()){var n=u.position();r=e(r,n.x),s=e(s,n.y),u.isSelected(!1)}}p=S>r?r+R:0,q=S>s?s+R:0}else{for(var v=0;v<c._activeRowIndex;v++)q+=d._getActualRowHeight(v,3);for(var w=0;w<c._activeColumnIndex;w++)p+=d._getActualColumnWidth(w,3)}for(h=0,i=j.length;i>h;h++){var x=o[h];k.push(new a.Point(p+x.x,q+x.y))}for(h=0,i=j.length;i>h;h++){var y=f._getClipboardFloatingObjectData().findByPropertyName(j[h]).clone();y.isVisible(!0),y.name(c._generateFloatingObjectName()),y.position(k[h]),y.isSelected(!0),d._addFloatingOjectInternal(y),c._savedObjects.push(y)}d.isPaintSuspended(g);var z=c._resumeInvalidate(b);z||c.refreshUI(b)}},d.prototype.refreshUI=function(){var a=this._sheet;a&&(a.invalidateLayout(),a.repaint())},d.prototype.canExecute=function(){var a=this;return!a._sheet.isProtected&&a._floatingObjectExtent&&a._floatingObjectExtent.names&&a._floatingObjectExtent.names.length>0?!0:!1},d.prototype.canUndo=function(){return this._savedObjects&&this._savedObjects.length>0?!0:!1},d.prototype.undo=function(b){var c=this;if(a.features.floatingObject&&c._savedObjects&&c._savedObjects.length>0){var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._savedObjects.length;g>f;f++){var h=c._savedObjects[f];d._removeFloatingObjectInternal(h.name())}c._savedObjects.length=0,d.isPaintSuspended(e);var i=c._resumeInvalidate(b);return i||c.refreshUI(b),!0}return!1},d.prototype._generateFloatingObjectName=function(){for(var a="FloatingObject",b=this._sheet._floatingObjectArray.length+1,d=a+b;this._sheet._findFloatingObjectInternal(d)!==c;)b++,d=a+b;return d},d}(o);b.ClipboardPasteFloatingObjectUndoAction=T;var U=function(b){function d(a,d,e){b.call(this),this._sheet=c,this._floatingObjectExtent=c,this._savedObjects=c,this._movingInfo=c;var f=this;f._sheet=a,f._floatingObjectExtent=d,f._savedObjects=[],f._movingInfo=e}return __extends(d,b),d.prototype.execute=function(b){var c=this;if(a.features.floatingObject&&c._floatingObjectExtent&&c._floatingObjectExtent.names&&c._floatingObjectExtent.names.length>0&&c._movingInfo){var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);var f,g;for(f=0,g=c._floatingObjectExtent.names.length;g>f;f++){var h=d._findFloatingObjectInternal(c._floatingObjectExtent.names[f]);if(h){var i=h.clone(),j=h.position();i.position(new a.Point(j.x+c._movingInfo.offsetX,j.y+c._movingInfo.offsetY)),i.name(c._generateFloatingObjectName()),i.isSelected(!0),h.isSelected(!1),d._addFloatingOjectInternal(i),c._savedObjects.push(i.name())}}d.isPaintSuspended(e);var k=c._resumeInvalidate(b);k||c.refreshUI(b)}},d.prototype.refreshUI=function(){var a=this._sheet;a&&(a.invalidateLayout(),a.repaint())},d.prototype.canExecute=function(){var a=this;return!a._sheet.isProtected&&a._floatingObjectExtent&&a._floatingObjectExtent.names&&a._floatingObjectExtent.names.length>0?!0:!1},d.prototype.canUndo=function(){return this._savedObjects&&this._savedObjects.length>0?!0:!1},d.prototype.undo=function(b){var c=this;if(a.features.floatingObject&&c._savedObjects&&c._savedObjects.length>0){var d=c._sheet;c._suspendInvalidate(b);var e=d.isPaintSuspended();d.isPaintSuspended(!0);for(var f=0,g=c._savedObjects.length;g>f;f++)d._removeFloatingObjectInternal(c._savedObjects[f]);c._savedObjects.length=0,d.isPaintSuspended(e);var h=c._resumeInvalidate(b);return h||c.refreshUI(b),!0}return!1},d.prototype._generateFloatingObjectName=function(){for(var a="FloatingObject",b=this._sheet._floatingObjectArray.length+1,d=a+b;this._sheet._findFloatingObjectInternal(d)!==c;)b++,d=a+b;return d},d}(o);b.DragCopyFloatingObjectUndoAction=U;var V=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.init=function(a,b){this._sheet=a,this._comment=b},b.prototype.refreshUI=function(){var a=this._sheet;a&&(a.invalidateLayout(),a.repaint())},b.prototype.canExecute=function(){return!0},b.prototype.canUndo=function(){return this._savedComment?!0:!1},b.prototype.saveState=function(){this._savedComment=this._comment},b}(o);b.CommentUndoActionBase=V;var W=function(a){function b(b,c){a.call(this),this.init(b,c)}return __extends(b,a),b.prototype.execute=function(a){var b=this;b.saveState();var d=b._sheet;b._suspendInvalidate(a);var e=d.isPaintSuspended();d.isPaintSuspended(!0),d.setComment(b._comment._rowIndex,b._comment._colIndex,c),d._loadAndSetSheetSelections(),d.isPaintSuspended(e);var f=b._resumeInvalidate(a);f||b.refreshUI(a)},b.prototype.undo=function(a){var b=this;if(b._savedComment){var c=b._sheet;b._suspendInvalidate(a);var d=c.isPaintSuspended();c.isPaintSuspended(!0),c.setComment(b._savedComment._rowIndex,b._savedComment._colIndex,b._savedComment),c._saveAndClearSheetSelections(),c.isPaintSuspended(d);var e=b._resumeInvalidate(a);return e||b.refreshUI(a),!0}return!1},b}(V);b.CommentDeleteUndoAction=W;var X=function(a){function b(b,c,d,e,f){a.call(this);var g=this;g.init(b,c),g._oldValue=d,g._newValue=e,g._propertyName=f}return __extends(b,a),b.prototype.execute=function(a){var b=this;if(b._comment){b.saveState();var c=b._sheet;b._suspendInvalidate(a);var d=c.isPaintSuspended();c.isPaintSuspended(!0),b._comment._changeProperty(b._propertyName,b._newValue),c.isPaintSuspended(d);var e=b._resumeInvalidate(a);e||b.refreshUI(a)}},b.prototype.undo=function(a){var b=this;if(b._savedComment){var c=b._sheet;b._suspendInvalidate(a);var d=c.isPaintSuspended();c.isPaintSuspended(!0),b._comment._changeProperty(b._propertyName,b._oldValue),c.isPaintSuspended(d);var e=b._resumeInvalidate(a);return e||b.refreshUI(a),!0}return!1},b}(V);b.CommentPropertyUndoAction=X;var Y=function(a){function b(){a.call(this),this._commentUndoTransaction=[]}return __extends(b,a),b.prototype.execute=function(a){var b=this;if(b._commentUndoTransaction&&b._commentUndoTransaction.length>0)for(var c=0;c<b._commentUndoTransaction.length;c++){var d=b._commentUndoTransaction[c];d&&d.execute(a)}},b.prototype.undo=function(a){var b=this;if(b._commentUndoTransaction&&b._commentUndoTransaction.length>0){for(var c=0;c<b._commentUndoTransaction.length;c++){var d=b._commentUndoTransaction[c];d&&d.undo(a)}return!0}return!1},b.prototype.add=function(a){this._commentUndoTransaction.push(a)},b}(o);b.CommentUndoTransaction=Y}(a.UndoRedo||(a.UndoRedo={}));a.UndoRedo}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){b.feature("core.sheet_event",["core.migrate","core.common","core.sheet_action","core.stringResource"]);var c=null,d=void 0,e=Math.max,f=Math.min,g=Math.abs,h=Math.ceil,i="undefined",j="position",k="absolute",l="border",m="border-radius",n="padding",o="box-shadow",p="font",q="background-color",r="overflow",s="top",t="left",u="z-index",v="outline",w="width",x="height",y="resize",z="hidden",A="visible",B="auto",C="white",D="none",E="size",F="gcUIElement",G=window.document,H=function(){function H(a){this.RESIZETOOLTIP_TOP=30,this.DRAGDROPTOOLTIP_OFFSET=5,this.DRAGFILLTOOLTIP_OFFSET=3,this.VSCROLLTOOLTIP_LEFT=100,this.HSCROLLTOOLTIP_LEFT=30,this.HSCROLLTOOLTIP_TOP=40,this._clipboardFloatingObjectData=c,this._repeatKeyDownTimeoutID=0,this.waittime=100,this.newLeft=0,this.newTop=0,this._focusReleased=!1,this._init(a)}return H.prototype._init=function(a){this._sheet=a,this._elem=c,this._eventSuspended=0},H.prototype._getElem=function(){return this._elem||(this._elem=G.createElement("input")),this._elem},H.prototype._dispose=function(){var a=this;a._hScrollTimer&&a._hScrollTimer._dispose(),a._vScrollTimer&&a._vScrollTimer._dispose()},H.prototype._getHScrollTimer=function(){var a=this;return a._hScrollTimer||(a._hScrollTimer=new b.Timer(a)),a._hScrollTimer},H.prototype._getVScrollTimer=function(){var a=this;return a._vScrollTimer||(a._vScrollTimer=new b.Timer(a)),a._vScrollTimer},H.prototype.doResize=function(){var a=this._sheet,b=a._getCanvas();if(b&&b.parentNode){var c=getComputedStyle(b.parentNode),d=c.width,f=c.height,g=d.indexOf("px");g>0&&(d=d.substring(0,g)),g=f.indexOf("px"),g>0&&(f=f.substring(0,g));var h=parseInt(d),i=parseInt(f);if(isNaN(h)&&(h=$(b.parentNode).width()),isNaN(i)&&(i=$(b.parentNode).height()),0!==h&&0!==i){var j=0,k=0;b.style.display=D,b.width=e(h-j,0),b.height=e(i-k,0),b.style.display="",a._bounds.width=b.clientWidth||b.width,a._bounds.height=b.clientHeight||b.height,a._paintSuspended||(a.invalidateLayout(),a.repaint())}}},H.prototype._getCanvasOffset=function(){var a=this._sheet,b=$(a._getCanvas()).offset();return b?(isNaN(G.body.clientTop)||(b.top+=G.body.clientTop),isNaN(G.body.clientLeft)||(b.left+=G.body.clientLeft)):b={top:0,left:0},window.gcGlobal.canvasOffset&&(b=window.gcGlobal.canvasOffset),b},H.prototype.doMouseDown=function(a){if(2===a.button)return!0;var b=this,c=b._sheet;c.inCanvas||b.handleDocumentMouseMove();var d=b._getCanvasOffset(),e=b.doMouseDownImp(a,a.pageX-d.left,a.pageY-d.top);return c.isEditing()||e||b.setFocus(),c._isMouseDownInSheet=!0,!1},H.prototype.handleDocumentMouseMove=function(){var a=this;a._isMouseCapture||($(G).bind("mousemove.gcSheet",function(b){a.doMouseMove(b)}).bind("mouseup.gcSheet",function(b){a.doMouseUp(b)}),a._isMouseCapture=!0)},H.prototype.unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,$(G).unbind("mousemove.gcSheet").unbind("mouseup.gcSheet"))},H.prototype.doMouseDownImp=function(a,e,f){var g=this,h=g._sheet,i=h.hitTest(e,f),j=i.row,k=i.col,l=i.groupHitInfo,m=i.dragInfo,n=i.filterButtonHitInfo,o=i.formulaRangeHitInfo,p=i.cellTypeHitInfo;"function"==typeof h.unSelectAllFloatingObjects&&h.unSelectAllFloatingObjects();var q=h._commentManager;if(q&&q.deactivateComment(),l)h.isEditing()||g._doClickRangeGroup(l);else if(h._currentTarget=i,g.isMouseDown=!0,i.resizeInfo){if(!h.endEdit())return;g.startResizing(i)}else if(m&&m.side&&"corner"!==m.side){if(!h.endEdit())return;g.startDragDropping(i)}else if(m&&"corner"===m.side){if(!h.endEdit())return;g.startDragFill(i)}else if(n){if(!h.endEdit())return;g._openFilterDialog(n)}else if(o)o.inBorder?g.startFormulaRangeMoving(i):(o.inTopLeft||o.inTopRight||o.inBottomLeft||o.inBottomRight)&&g.startFormulaRangeResizing(i);else{var r=h._formulaTextBox;if(r&&r.canAppendRange())return void g.startFormulaRangeAppending(i);var s=h.getActiveRowIndex(),t=h.getActiveColumnIndex();if(p){if(j!==s||k!==t){var u=h.isPaintSuspended();h.isPaintSuspended(!0);try{if(!h.endEdit())return;var v={sheet:h,sheetName:h._name,row:s,col:t,cancel:!1};if(h._trigger(b.Events.LeaveCell,v),v&&v.cancel===!0)return;
var w=h._selectionModel.toArray(),x=c,y=h._spanModel.find(j,k);x=y?[new b.Range(y.row,y.col,y.rowCount,y.colCount)]:[new b.Range(j,k,1,1)],h._trigger(b.Events.SelectionChanging,{sheet:h,sheetName:h._name,oldSelections:w,newSelections:x}),h.setActiveCell(j,k),h._trigger(b.Events.EnterCell,{sheet:h,sheetName:h._name,row:j,col:k}),h._trigger(b.Events.SelectionChanged,{sheet:h,sheetName:h._name}),g._updateValidationUI(j,k)}finally{h.isPaintSuspended(u)}}var z=h.getCellType(j,k,i.hitTestType);p.sheet||(p.sheet=h),z.processMouseDown(p)}if(p&&p.isReservedLocation)return!0;g.setMetaKeyState(a);try{if(g._hitTestResult=i,h.isEditing()&&s===h.getActiveRowIndex()&&t===h.getActiveColumnIndex()&&!h.endEdit())return}finally{g._hitTestResult=c}if(j===d||j===c||k===d||k===c)return;3===i.hitTestType&&g._updateValidationUI(j,k);var A=h._selectionModel.toArray();g.startSelecting(i);var B=h._selectionModel.toArray();g._notEqualSelecions(A,B)&&h._trigger(b.Events.SelectionChanging,{sheet:h,sheetName:h._name,oldSelections:A,newSelections:B})}},H.prototype._openFilterDialog=function(a){if(a&&b.features.filter_ui){var c=new b._GcFilterDialog(this._sheet,a);this._sheet._filterDialiog=c,c.open()}},H.prototype._doClickRangeGroup=function(a){var c=this._sheet;if(c&&a&&b.features.group){var d,e,f,g,h,i=a.info;if("rgh"===a.what)c&&!c.isEditing()&&(d=i.index,e={sheet:c,sheetName:c._name,isRowGroup:!0,index:-1,level:d,cancel:!1},c._trigger(b.Events.RangeGroupStateChanging,e),e&&e.cancel===!1&&(f=new b.UndoRedo.RowGroupHeaderExpandUndoAction(c,{level:d}),c._doCommand(f),c._trigger(b.Events.RangeGroupStateChanged,{sheet:c,sheetName:c._name,isRowGroup:!0,index:-1,level:d})));else if("cgh"===a.what)c.isEditing()||(d=i.index,e={sheet:c,sheetName:c._name,isRowGroup:!1,index:-1,level:d,cancel:!1},c._trigger(b.Events.RangeGroupStateChanging,e),e&&e.cancel===!1&&(f=new b.UndoRedo.ColumnGroupHeaderExpandUndoAction(c,{level:d}),c._doCommand(f),c._trigger(b.Events.RangeGroupStateChanged,{sheet:c,sheetName:c._name,isRowGroup:!1,index:-1,level:d})));else if("rg"===a.what){if(c.rowRangeGroup&&(g=i.index,h=i.isExpanded,1===i.lineDirection?g--:g++,e={sheet:c,sheetName:c._name,isRowGroup:!0,index:g,level:i.level,cancel:!1},c._trigger(b.Events.RangeGroupStateChanging,e),e&&e.cancel===!1)){var j=new b.UndoRedo.RowGroupExpandUndoAction(c,{index:i.index,level:i.level,collapsed:h});c._doCommand(j),c._trigger(b.Events.RangeGroupStateChanged,{sheet:c,sheetName:c._name,isRowGroup:!0,index:g,level:i.level})}}else if("cg"===a.what&&c.colRangeGroup&&(g=i.index,h=i.isExpanded,1===i.lineDirection?g--:g++,e={sheet:c,sheetName:c._name,isRowGroup:!1,index:g,level:i.level,cancel:!1},c._trigger(b.Events.RangeGroupStateChanging,e),e&&e.cancel===!1)){var k=new b.UndoRedo.ColumnGroupExpandUndoAction(c,{index:i.index,level:i.level,collapsed:h});c._doCommand(k),c._trigger(b.Events.RangeGroupStateChanged,{sheet:c,sheetName:c._name,isRowGroup:!1,index:g,level:i.level})}}},H.prototype._isInvalidRect=function(a){var b=this._sheet;if(!b)return!0;var e=b._getSheetLayout();return a.x===c||a.x===d||a.y===c||a.y===d||a.width===c||a.width===d||a.height===c||a.height===d||a.x+a.width>e.viewportX+e.viewportWidth+e.frozenTrailingWidth||a.y+a.height>e.viewportY+e.viewportHeight+e.frozenTrailingHeight},H.prototype._commitSelectValue=function(a,c,d){for(var e,f=this._sheet,g=0,h=a.options,i=h.length;i>g;g++){var j=h[g];if(j.selected){e=j.value;break}}var k=!1;if(e&&!k){var l={row:c,col:d,newValue:e,autoFormat:!0},m=new b.UndoRedo.CellEditUndoAction(f,l);f._doCommand(m)}$(a).hide()},H.prototype._updateValidationUI=function(a,g){var h=this,i=h._sheet,m=i&&i.parent;if(m&&b.features.dataValidator){i._disposeValidationUI();var r=m.getActiveSheet();if(r&&i.getName()===r.getName()){var w=i.getDataValidator(a,g);if(w){var x=h._getCanvasOffset(),y=i.getCellRect(a,g);if(!h._isInvalidRect(y)){var z=1e3;if(w&&w.showInputMessage&&w.inputMessage){var A=G.createElement("span");$(A).css(j,k).css(l,"1px #C0C0C0 solid").css(n,"3px 8px 3px 8px").css(q,"#FFFFFF").css(o,"1px 2px 5px rgba(0,0,0,0.4)").css(p,"normal normal normal 12px/normal Arial").width(B).height(B).css(s,y.y+y.height+x.top+5).css(t,y.x+y.width/2+x.left).css(u,z).html("<b>"+w.inputTitle+"</b><br/>"+w.inputMessage).attr(F,"gcValidationInputMessage").appendTo(G.body),i._validationInputMessage=A}if(w&&3===w.type&&w.inCellDropdown){for(var H=w.condition.getValidList(i,a,g),I=H.length,J=G.createElement("select"),K=i.getValue(a,g),L=-1,M="",N=0;I>N;N++){var O=H[N];0>L&&O===K&&(L=N),O===c||O===d?O="":O instanceof Date&&(O=new b._DateTimeHelper(O).localeFormat("M/d/yyyy h:mm:ss")),M+='<option value="'+O+'">'+O+"</option>"}J.innerHTML=M,J.selectedIndex=L>0?L:0;var P=i.getActualStyle(a,g),Q=i._render,R=P&&P.font?P.font:Q._getDefaultFont();i._zoomFactor>1&&(R=Q._getZoomFont(R));var S=i.getSpans(new b.Range(a,g,1,1)),T=1;S&&S.length>0&&S[0]&&(T=S[0].colCount);var U=g+T-1===i.getColumnCount()-1,V=i.getRowHeight(a)*i._zoomFactor,W=i.parent&&i.parent.useTouchLayout();V=W?f(50,V):f(15,V);var X,Y,Z,_,ab,bb=b.util.device(),cb=$.browser.safari&&(bb.ipad||bb.iphone);cb?(X=y.width+3,Y=y.height+3,Z=y.y+x.top-1.5,_=y.x+x.left-1.5,ab=C):(X=e(y.width+(U?0:V),i.defaults.colWidth),Y=I>8?140:B,Z=y.y+y.height+x.top,_=y.x+y.width+x.left+(U?0:V)-X,ab="");var db=$(J).css(v,D).css(j,k).css(p,R).css(u,z).css(q,ab).width(X).height(Y).css(s,Z).css(t,_).attr(F,"gcValidationSelect").appendTo(G.body).attr(E,I>2?I:2).hide().bind("click",function(){h._commitSelectValue(J,a,g),cb&&$(i._validationButton).show()}).bind("keydown",function(b){13!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey?27!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||$(J).hide():h._commitSelectValue(J,a,g),cb&&$(i._validationButton).show()});cb&&db.bind("blur",function(){h._commitSelectValue(J,a,g),$(i._validationButton).show()}),i._validationSelect=J;var eb=G.createElement("input");eb.type="image",eb.src=b.DefaultDataValidator.getImageSrc(),eb.alt="v",$(eb).css(j,k).width(V).height(V).css(s,y.y+y.height+x.top-(V+3)).css(t,y.x+y.width+x.left-(U?V:0)).css(q,C).css(l,"1px solid gray").attr(F,"gcValidationButton").appendTo(G.body).click(function(){i.isEditing()&&i.endEdit(),$(i._validationSelect).toggle().focus(),cb&&$(i._validationButton).toggle()}),i._validationButton=eb}}}}}},H.prototype.startScroll=function(){var a=this;if(a.startHitInfo){var b=a.startHitInfo.hitTestType;(3===b||2===b)&&a._getVScrollTimer().setAction(a.processVSScrolled),(3===b||1===b)&&a._getHScrollTimer().setAction(a.processHSScrolled)}},H.prototype.processVSScrolled=function(a){var b=this,c=b.adjustScrollRowViewport();if(!c){var d=b.startHitInfo,e=b._sheet,f=d.scrollRowViewportIndex,g=e.getViewportTopRow(f),h=e.getViewportBottomRow(f);if(a)if(h<e.getRowCount()-e._frozenTrailingRowCount-1)e._setTopRow(e._getNextVisualRow(g));else{var i=e._getRowLayout(f);if(i&&i.length>0){var j=e._getSheetLayout(),k=i[i.length-1];k.y+k.height>=j.viewportY+j.viewportHeight&&e._setTopRow(e._getNextVisualRow(g))}}else g>e.frozenRowCount&&e._setTopRow(e._getPrevVisualRow(g))}b.isSelecting&&b.continueSelecting(),b.isDragDropping&&b.continueDragDropping(),b.isDraggingFill&&b.continueDragFill(),b.isFormulaRangeAppending&&b.continueFormulaRangeAppending(),b.isFormulaRangeMoving&&b.continueFormulaRangeMoving(),b.isFormulaRangeResizing&&b.continueFormulaRangeResizing()},H.prototype.processHSScrolled=function(a){var b=this,c=b.adjustScrollColViewport();if(!c){var d=b._sheet,e=b.startHitInfo,f=e.scrollColViewportIndex,g=d.getViewportLeftColumn(f),h=d.getViewportRightColumn(f);if(a)if(h<d.getColumnCount()-d._frozenTrailingColCount-1)d._setLeftColumn(d._getNextVisualColumn(g));else{var i=d._getColumnLayout(f);if(i&&i.length>0){var j=d._getSheetLayout(),k=i[i.length-1];k.x+k.width>=j.viewportX+j.viewportWidth&&d._setLeftColumn(d._getNextVisualColumn(g))}}else g>d.frozenColCount&&d._setLeftColumn(d._getPrevVisualColumn(g))}b.isSelecting&&b.continueSelecting(),b.isDragDropping&&b.continueDragDropping(),b.isDraggingFill&&b.continueDragFill(),b.isFormulaRangeAppending&&b.continueFormulaRangeAppending(),b.isFormulaRangeMoving&&b.continueFormulaRangeMoving(),b.isFormulaRangeResizing&&b.continueFormulaRangeResizing()},H.prototype.adjustScrollRowViewport=function(){var a=this._sheet,b=a._getSheetLayout(),c=this.mousePosition,d=this.startHitInfo,e=d.scrollRowViewportIndex;if(0===e){if(c.y>b.viewportY)return a._setTopRow(a._getFirstPageTopRow()),d.scrollRowViewportIndex=1,!0}else if(1===e){var g=a._getRowLayout(1);if(g&&g.length>0){var h=g[0];if(a.frozenRowCount>0&&c.y<b.viewportY&&h.row<=a._getFirstPageTopRow())return d.scrollRowViewportIndex=0,!0;if(h=g[g.length-1],a._frozenTrailingRowCount>0&&c.y>b.frozenTrailingY&&h.row>=a._getLastVisualRow()&&h.y+h.height<=b.frozenTrailingY)return d.scrollRowViewportIndex=2,!0}}else if(2===e){var g=a._getRowLayout(1);if(g&&g.length>0&&c.y<b.frozenTrailingY){var h=g[g.length-1];if(h.y+h.height>b.frozenTrailingY){for(var i=b.viewportHeight,j=a.getRowCount()-a._frozenTrailingRowCount-1,k=0,l=j;l>=a.frozenRowCount;l--)if(k+=a._getZoomRowHeight(l),k>i){j=f(l+1,j);break}a._setTopRow(a._getNextVisualRow(j-1))}return d.scrollRowViewportIndex=1,!0}}return!1},H.prototype.adjustScrollColViewport=function(){var a=this._sheet,b=a._getSheetLayout(),c=this.mousePosition,d=this.startHitInfo,e=d.scrollColViewportIndex;if(0===e){if(c.x>b.viewportX)return a._setLeftColumn(a._getFirstPageLeftColumn()),d.scrollColViewportIndex=1,!0}else if(1===e){var g=a._getColumnLayout(1);if(g&&g.length>0){var h=g[0];if(a.frozenColCount>0&&c.x<b.viewportX&&h.col<=a._getFirstPageLeftColumn())return d.scrollColViewportIndex=0,!0;if(h=g[g.length-1],a._frozenTrailingColCount>0&&c.x>b.frozenTrailingX&&h.col>=a._getLastVisualColumn()&&h.x+h.width<=b.frozenTrailingX)return d.scrollColViewportIndex=2,!0}}else if(2===e){var g=a._getColumnLayout(1);if(g&&g.length>0&&c.x<b.frozenTrailingX){var h=g[g.length-1];if(h.x+h.width>b.frozenTrailingX){for(var i=b.viewportWidth,j=a.getColumnCount()-a._frozenTrailingColCount-1,k=0,l=j;l>=a.frozenColCount;l--)if(k+=a._getZoomColumnWidth(l),k>i){j=f(l+1,j);break}a._setLeftColumn(a._getNextVisualColumn(j-1))}return d.scrollColViewportIndex=1,!0}}return!1},H.prototype.continueScroll=function(){var a=this;if(a.isWorking||a.isFloatingObjectWorking||a.isCommentWorking){var b=a._sheet,d=b._getSheetLayout(),e=a.startHitInfo,f=e.scrollRowViewportIndex,g=e.scrollColViewportIndex,h=a.mousePosition,i=c;if(f>=0&&g>=0?i=d.viewportRect(f,g):f>=0?i=d.rowHeaderRect(f):g>=0&&(i=d.colHeaderRect(g)),i){var j=0,k=0;h.x<=i.x?j=h.x-i.x:h.x>=i.x+i.width&&(j=h.x-(i.x+i.width)),h.y<=i.y?k=h.y-i.y:h.y>=i.y+i.height&&(k=h.y-(i.y+i.height)),a._getHScrollTimer().setInterval(a.getIntervalFromDistance(j)),a._getVScrollTimer().setInterval(a.getIntervalFromDistance(k))}}},H.prototype.stopScroll=function(){this._getHScrollTimer().stop(),this._getVScrollTimer().stop()},H.prototype.startResizing=function(a){var b,c,d,e,f=this,g=f._sheet,h=(g._getSheetLayout(),a.resizeInfo);"sizeRow"===h.action?(b=g._getAllRowLayout(h.sheetArea),h.index=f._getPrevVisualRowBeforeFindRow(h.index,h.sheetArea),c=b.findRow(h.index),c||(c=b.findRow(a.row)),h.startY=c.y):(d=g._getAllColumnLayout(h.sheetArea),h.index=f._getPrevVisualColBeforeFindCol(h.index,h.sheetArea),e=d.findCol(h.index),e||(e=d.findCol(a.col)),h.startX=e.x);var i=g.parent,j=a.x,k=a.y;if(i){var l=i.showResizeTip();(1===l&&"sizeCol"===h.action||2===l&&"sizeRow"===h.action||3===l)&&(k-f.RESIZETOOLTIP_TOP<0?k+=f.RESIZETOOLTIP_TOP/2:k-=f.RESIZETOOLTIP_TOP,f._showTooltip(f._getMouseDownResizeTooltipContent(),j,k))}f.isResizing=!0,f.isWorking=!0},H.prototype.continueResizing=function(){var a,b=this,c=b._sheet,d=c._currentTarget,e=d.resizeInfo,f=b.mousePosition,g=f.x,h=f.y,i=c._getSheetLayout();if(e&&b.isWorking&&b.isResizing&&(d.x!==g||d.y!==h)){"sizeRow"===e.action?(e.movingY=h,e.movingY<e.startY&&(e.movingY=e.startY),a=i.y+i.height,e.movingY>a&&(e.movingY=a)):(e.movingX=g,e.movingX<e.startX&&(e.movingX=e.startX),a=i.x+i.width,e.movingX>a&&(e.movingX=a));var j=c._render,k=j._getCtx();j.copyDoubleBuffer(i.x,i.y,i.width,i.height),j.paintAdornment(k);var l=c.parent;if(l){var m=l.showResizeTip();(1===m&&"sizeCol"===e.action||2===m&&"sizeRow"===e.action||3===m)&&b._refreshTooltip(b._getMouseMoveResizeTooltipContent(e))}}},H.prototype.stopResizing=function(){var a=this;a.isResizing=!1,a.isWorking=!1;var f,g,h,i,j=a._sheet,k=j._currentTarget,l=k.resizeInfo;if(l)if(a._removeTooltip(),"sizeRow"===l.action){if(l.movingY!==d&&l.movingY!==c){f=e(0,(l.movingY-l.startY)/j._zoomFactor);var m=[];if(j._isRowSelected(l.index))for(g=0;g<j._selectionModel.length;g++)h=j._selectionModel[g],-1===h.col&&(h=j._getActualRange(h),m.push({firstRow:h.row,lastRow:h.row+h.rowCount-1}));else m.push({firstRow:l.index,lastRow:l.index});var n=1===l.sheetArea;i=new b.UndoRedo.RowResizeUndoAction(j,m,f,n),j._doCommand(i)}}else if(l.movingX!==d&&l.movingX!==c){f=e(0,(l.movingX-l.startX)/j._zoomFactor);var o=[];if(j._isColumnSelected(l.index))for(g=0;g<j._selectionModel.length;g++)h=j._selectionModel[g],-1===h.row&&(h=j._getActualRange(h),o.push({firstCol:h.col,lastCol:h.col+h.colCount-1}));else o.push({firstCol:l.index,lastCol:l.index});var p=2===l.sheetArea;i=new b.UndoRedo.ColumnResizeUndoAction(j,o,f,p),j._doCommand(i)}},H.prototype._startSelectingCore=function(a,c){var d=0,e=0,h=0,i=0,j=this,k=j._sheet;j._lastSelections=k._selectionModel.toArray(),j.ctrl||j.shift||k._clearSelectionImp();var l,m,n,o;if(0===a.hitTestType){if(!j.shift){l=k.frozenRowCount?k._getFirstVisualRow():k._scrollTopRow;var p=k.frozenColCount?k._getFirstVisualColumn():k._scrollLeftCol;if(m={sheet:k,sheetName:k._name,row:k._activeRowIndex,col:k._activeColIndex,cancel:!1},k._trigger(b.Events.LeaveCell,m),m&&m.cancel===!0)return;k._setActiveCellImp(l,p,1,1,c),k._trigger(b.Events.EnterCell,{sheet:k,sheetName:k._name,row:l,col:p}),j._updateValidationUI(l,p)}j.ctrl||k._clearSelectionImp(),k._setSelectedRange(-1,-1,k.getRowCount(),k.getColumnCount(),!0)}else if(1===a.hitTestType){if(!j.shift){if(l=k.frozenRowCount?k._getFirstVisualRow():k._scrollTopRow,n=k._getAvailableActiveCell(l,a.col,!1),m={sheet:k,sheetName:k._name,row:k._activeRowIndex,col:k._activeColIndex,cancel:!1},k._trigger(b.Events.LeaveCell,m),m&&m.cancel===!0)return;k._setActiveCellImp(n.row,n.col,1,a.colViewportIndex,c),k._trigger(b.Events.EnterCell,{sheet:k,sheetName:k._name,row:n.row,col:n.col}),j._updateValidationUI(n.row,n.col)}j.shift?(d=f(k._activeColIndex,a.col),i=g(k._activeColIndex-a.col)+1,k._replaceActiveSelectedRange(-1,d,k.getRowCount(),i,!0)):k._setSelectedRange(-1,k._activeColIndex,k.getRowCount(),1,!0)}else if(2===a.hitTestType){if(!j.shift){var q=k.frozenColCount?k._getFirstVisualColumn():k._scrollLeftCol;if(n=k._getAvailableActiveCell(a.row,q,!0),m={sheet:k,sheetName:k._name,row:k._activeRowIndex,col:k._activeColIndex,cancel:!1},k._trigger(b.Events.LeaveCell,m),m&&m.cancel===!0)return;o=k._activeRowIndex!==n.row,k._setActiveCellImp(n.row,n.col,a.rowViewportIndex,1,c),o&&k.doDataItemChanged(),k._trigger(b.Events.EnterCell,{sheet:k,sheetName:k._name,row:n.row,col:n.col}),j._updateValidationUI(n.row,n.col)}j.shift?(e=f(k._activeRowIndex,a.row),h=g(k._activeRowIndex-a.row)+1,k._replaceActiveSelectedRange(e,-1,h,k.getColumnCount(),!0)):k._setSelectedRange(k._activeRowIndex,-1,1,k.getColumnCount(),!0)}else if(3===a.hitTestType)if(isNaN(a.row)||isNaN(a.col)){if(k.isEditing()){var r=k.getCellRect(k._activeRowIndex,k._activeColIndex,k.activeRowViewportIndex,k.activeColViewportIndex);k._render.update(r.x,r.y,r.width,r.height)}}else{if(!j.shift&&(k._activeRowIndex!==a.row||k._activeColIndex!==a.col)){if(m={sheet:k,sheetName:k._name,row:k._activeRowIndex,col:k._activeColIndex,cancel:!1},k._trigger(b.Events.LeaveCell,m),m&&m.cancel===!0)return;o=k._activeRowIndex!==a.row,k._setActiveCellImp(a.row,a.col,a.rowViewportIndex,a.colViewportIndex,c),o&&k.doDataItemChanged(),k._trigger(b.Events.EnterCell,{sheet:k,sheetName:k._name,row:a.row,col:a.col}),j._updateValidationUI(a.row,a.col)}if(j.shift)k._extendSelectedRange(a.row,a.col,!0);else{var s=k._spanModel.find(a.row,a.col);s?k._setSelectedRange(s.row,s.col,s.rowCount,s.colCount,!0):k._setSelectedRange(a.row,a.col,1,1,!0)}}},H.prototype._startSelectingScroll=function(a){if(a&&(3!==a.hitTestType||!isNaN(a.row)&&!isNaN(a.col))){var b=this;b.isWorking=!0,b.isSelecting=!0,b.startHitInfo={scrollRowViewportIndex:a.rowViewportIndex,scrollColViewportIndex:a.colViewportIndex,hitTestType:a.hitTestType},b.startScroll()}},H.prototype.startSelecting=function(a){this._startSelectingCore(a),this._startSelectingScroll(a)},H.prototype.continueSelecting=function(){var a=this;if(a.startHitInfo&&a.isWorking&&a._forceCancelSelectiong!==!0){var b=a.startHitInfo.hitTestType;3===b?a.continueCellSelecting():2===b?a.continueRowSelecting():1===b&&a.continueColumnSelecting()}},H.prototype.continueCellSelecting=function(){var a=this,c=a._sheet,d=a.getHitRowIndex(),e=a.getHitColumnIndex();if(d>=0&&e>=0){var f=c._selectionModel.toArray();c._extendSelectedRange(d,e,!0);var g=c._selectionModel.toArray();a._notEqualSelecions(f,g)&&c._trigger(b.Events.SelectionChanging,{sheet:c,sheetName:c._name,oldSelections:f,newSelections:g})}a.continueScroll()},H.prototype.continueRowSelecting=function(){var a=this,c=a._sheet,d=a.getHitRowIndex();if(d>=0){var g=f(c._activeRowIndex,d),h=e(c._activeRowIndex,d)-g+1,i=-1,j=c.getColumnCount(),k=c.selectionPolicy();if(0===k)return;var l=c.selectionUnit();2===l&&(g=-1,h=-1);var m=c._selectionModel.toArray();c._replaceActiveSelectedRange(g,i,h,j,!0);var n=c._selectionModel.toArray();a._notEqualSelecions(m,n)&&c._trigger(b.Events.SelectionChanging,{sheet:c,sheetName:c._name,oldSelections:m,newSelections:n})}a.continueScroll()},H.prototype.continueColumnSelecting=function(){var a=this,c=a._sheet,d=a.getHitColumnIndex();if(d>=0){var g=f(c._activeColIndex,d),h=e(c._activeColIndex,d)-g+1,i=-1,j=c.getRowCount(),k=c.selectionPolicy();if(0===k)return;var l=c.selectionUnit();1===l&&(g=-1,h=-1);var m=c._selectionModel.toArray();c._replaceActiveSelectedRange(i,g,j,h,!0);var n=c._selectionModel.toArray();a._notEqualSelecions(m,n)&&c._trigger(b.Events.SelectionChanging,{sheet:c,sheetName:c._name,oldSelections:m,newSelections:n})}a.continueScroll()},H.prototype.stopSelecting=function(){var a=this;a.startHitInfo=c,a.stopScroll(),a._forceCancelSelectiong=c,a.isWorking=!1,a.isSelecting=!1;var d=a._sheet,e=!a._lastSelections;if(!e){var f=d._selectionModel.toArray();e=a._notEqualSelecions(a._lastSelections,f)}e&&d._trigger(b.Events.SelectionChanged,{sheet:a._sheet,sheetName:a._sheet._name})},H.prototype.startDragDropping=function(a){var d=this;if(!d.isDragDropping){var e=d._sheet,f=c;if(1===e._selectionModel.length)f=e._selectionModel[0];else if(e._selectionModel.length<1){var g=e._spanModel.find(e._activeRowIndex,e._activeColIndex);f=g?g:new b.Range(e._activeRowIndex,e._activeColIndex,1,1)}if(f){d.isDragDropping=!0,d.isWorking=!0,d._dragDropFromRange=f;var h=e._getRangeRect(a.rowViewportIndex,a.colViewportIndex,f),i=e._dragRect;i.x=h.x,i.y=h.y,i.width=h.width-1,i.height=h.height-1,i.row=f.row,i.col=f.col,i.rowCount=f.rowCount,i.colCount=f.colCount;var j=e._fixRange(f),k=a.row,l=a.col;k<j.row&&(k=j.row),k>=j.row+j.rowCount&&(k=j.row+j.rowCount-1),l<j.col&&(l=j.col),l>=j.col+j.colCount&&(l=j.col+j.colCount-1),i.hitRow=k,i.hitCol=l,i.rowOffset=k-j.row,i.colOffset=l-j.col,d.startHitInfo={scrollRowViewportIndex:a.rowViewportIndex,scrollColViewportIndex:a.colViewportIndex,hitTestType:a.hitTestType},d.startScroll()}}},H.prototype.continueDragDropping=function(){var a=this;if(a.startHitInfo&&a.isWorking&&a.isDragDropping&&a._dragDropFromRange){var b=a.mousePosition,c=a._sheet,d=c._dragRect;d.hitTarget={x:b.x,y:b.y};var e=a.getHitRowIndex(),f=a.getHitColumnIndex();e>=0&&f>=0&&a.updateDragDropRect(e,f),a.continueScroll()}},H.prototype.updateDragDropRect=function(a,b){var c=this;if(c.isDragDropping&&c._dragDropFromRange){var d=c._sheet,g=d._dragRect,h=d._getActiveSelectedRange();-1===h.row&&-1!==h.col?(g.row=-1,g.col=b):-1!==h.row&&-1===h.col?(g.row=a,g.col=-1):(g.row=g.row<0?-1:e(0,f(d.getRowCount()-g.rowCount,a-g.rowOffset)),g.col=g.col<0?-1:e(0,f(d.getColumnCount()-g.colCount,b-g.colOffset))),g.hitRow=a,g.hitCol=b;var i=d._fixRange(g),j=d._oldDragRange;if(!(j&&i.row===j.row&&i.col===j.col&&i.rowCount===j.rowCount&&i.colCount===j.colCount&&i.row>d._getFirstVisualRow()&&i.col>d._getFirstVisualColumn()&&i.row+i.rowCount-1<d._getLastVisualRow()&&i.col+i.colCount-1<d._getLastVisualColumn())){d._actualDragRange=i,d._render.refreshDragDropIndicator(),d._oldDragRange=i;var k=d.parent;if(k&&k.showDragDropTip()){var l=g.x+g.width+c.DRAGDROPTOOLTIP_OFFSET,m=g.y+g.height+c.DRAGDROPTOOLTIP_OFFSET;c._showTooltip(c._getDragDropRectString(i),l,m)}}}},H.prototype._getDragDropRectString=function(a){if(a&&b.util.hasCalc()){var c,e=this._sheet,f=e._getActiveSelectedRange(),g=e.getActiveRowIndex(),h=e.getActiveColumnIndex();return g=0>g?0:g,h=0>h?0:h,1===f.rowCount&&1===f.colCount?c=new b.Calc.Expressions.CellExpression(a.row-g,a.col-h,!0,!0):(c=new b.Calc.Expressions.RangeExpression,-1===f.row&&f.col>=0?c.initBand(a.col-h,a.col-h+f.colCount-1,!0,!0,!1):-1===f.col&&f.row>=0?c.initBand(a.row-g,a.row-g+f.rowCount-1,!0,!0,!0):f.row>=0&&f.col>=0&&c.init(a.row-g,a.col-h,a.row-g+f.rowCount-1,a.col-h+f.colCount-1,!0,!0,!0,!0)),e.getCalcService().unparse(c,g,h)}return d},H.prototype.stopDragDrop=function(){var a=this,d=!1,e="",f=!1,g=a._sheet,h=c;a.startHitInfo=c,a.stopScroll();var i=g._getActiveSelectedRange();if(h=i&&(i.rowCount>0||i.colCount>0)?{r:i.row,c:i.col,rc:i.rowCount,cc:i.colCount}:{r:g._activeRowIndex,c:g._activeColIndex,rc:1,cc:1},a.isDragDropping===!0&&a.isWorking===!0){var j,k,l,m=h.r,n=h.c,o=h.rc,p=h.cc,q=g._dragRect.row,r=g._dragRect.col;!a._isDragInsert||-1!==m&&-1!==n?(q!==m||r!==n)&&((g._hasPartSpans(m,n,o,p)||g._hasPartSpans(q,r,o,p))&&(d=!0,e=b.SR.Exp_ChangeMergedCell),d||(g._hasPartArrayFormulas(m,n,o,p)||g._hasPartArrayFormulas(q,r,o,p))&&(d=!0,e=b.SR.Exp_ChangePartOfArray),!d&&g.isProtected&&(!a._isDragCopy&&g._isAnyCellInRangeLocked(new b.Range(m,n,o,p))||g._isAnyCellInRangeLocked(new b.Range(q,r,o,p)))&&(d=!0,e=b.SR.Exp_CellReadOnly),d||(l=new b.UndoRedo.DragDropExtent(m,n,q,r,o,p),k=g._raiseDragDropBlock(l.fromRow,l.fromColumn,l.toRow,l.toColumn,l.rowCount,l.columnCount,a._isDragCopy,!1,1023),k||(j=new b.UndoRedo.DragDropUndoAction(g,l,a._isDragCopy,!1,1023),g.doCommand(j),g._raiseDragDropBlockCompleted(l.fromRow,l.fromColumn,l.toRow,l.toColumn,l.rowCount,l.columnCount,a._isDragCopy,!1,1023),f=!0))):n>=0&&0>m?(a._isDragCopy&&(n>=r||r>=n+p)||!a._isDragCopy&&(n>r||r>n+p))&&((g._hasPartSpans(-1,n,-1,p)||g._hasPartSpans(-1,r,-1,0))&&(d=!0,e=b.SR.Exp_ChangeMergedCell),d||(g._hasPartArrayFormulas(-1,n,-1,p)||g._hasPartArrayFormulas(-1,r,-1,0))&&(d=!0,e=b.SR.Exp_ChangePartOfArray),!d&&g.isProtected&&(d=!0,e=b.SR.Exp_ColumnReadOnly),!d&&g._hasPartTable(-1,r,-1,1)&&(d=!0,e=b.SR.Exp_DragDropShiftTableCell),d||a._isDragCopy||!g._hasPartTable(-1,n,-1,p)||(d=!0,e=b.SR.Exp_DragDropChangePartOfTable),d||(l=new b.UndoRedo.DragDropExtent(-1,n,-1,r,-1,p),k=g._raiseDragDropBlock(l.fromRow,l.fromColumn,l.toRow,l.toColumn,l.rowCount,l.columnCount,a._isDragCopy,!0,1023),k||(j=new b.UndoRedo.DragDropUndoAction(g,l,a._isDragCopy,!0,1023),g.doCommand(j),g._raiseDragDropBlockCompleted(l.fromRow,l.fromColumn,l.toRow,l.toColumn,l.rowCount,l.columnCount,a._isDragCopy,!0,1023),f=!0))):m>=0&&0>n&&(a._isDragCopy&&(m>=q||q>=m+o)||!a._isDragCopy&&(m>q||q>m+o))&&((g._hasPartSpans(m,-1,o,-1)||g._hasPartSpans(q,-1,0,-1))&&(d=!0,e=b.SR.Exp_ChangeMergedCell),d||(g._hasPartArrayFormulas(m,-1,o,-1)||g._hasPartArrayFormulas(q,-1,0,-1))&&(d=!0,e=b.SR.Exp_ChangePartOfArray),!d&&g.isProtected&&(d=!0,e=b.SR.Exp_RowReadOnly),d||a._isDragCopy||!g._hasPartTable(m,-1,o,-1)||(d=!0,e=b.SR.Exp_DragDropChangePartOfTable),d||(l=new b.UndoRedo.DragDropExtent(m,-1,q,-1,o,-1),k=g._raiseDragDropBlock(l.fromRow,l.fromColumn,l.toRow,l.toColumn,l.rowCount,l.columnCount,a._isDragCopy,!0,1023),k||(j=new b.UndoRedo.DragDropUndoAction(g,l,a._isDragCopy,!0,1023),g.doCommand(j),g._raiseDragDropBlockCompleted(l.fromRow,l.fromColumn,l.toRow,l.toColumn,l.rowCount,l.columnCount,a._isDragCopy,!0,1023),f=!0)))}a.isWorking=!1,a.isDragDropping=!1,a._dragDropFromRange=c,a._isDragInsert=!1,a._isDragCopy=!1,a._removeTooltip(),f===!1&&(g._dragRect={},g.repaint()),d&&g._raiseInvalidOperation(3,e)},H.prototype.startFormulaRangeAppending=function(a){var c=this,d=c._sheet,e=d._formulaTextBox;if(e){var f=e.isAppending();f&&c._formulaRangeAppendingInfo||(c._formulaRangeAppendingInfo={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1});var g,h=d.getRowCount(),i=d.getColumnCount(),j=a.hitTestType,k=a.row,l=a.col,m=c.shift,n=c.ctrl,o=c._formulaRangeAppendingInfo,p=o.anchorRow,q=o.anchorCol,r=-1,s=-1;0===j?(r=d.frozenRowCount?d._getFirstVisualRow():d._scrollTopRow,s=d.frozenColCount?d._getFirstVisualColumn():d._scrollLeftCol,g=new b.Range(-1,-1,-1,-1),n?e.appendRange(c.rangeToString(g),!1,!1):m?e.appendRange(c.rangeToString(g),!0,!1):e.appendRange(c.rangeToString(g),!1,!0),c.isWorking=!0):1===j?(r=d.frozenRowCount?d._getFirstVisualRow():d._scrollTopRow,s=l,g=d._getExtendedRange(0,l,h-1,l),g=new b.Range(-1,g.col,-1,g.colCount),n?e.appendRange(c.rangeToString(g),!1,!1):m?(q>=0&&(g=d._getExtendedRange(0,l,h-1,q),g=new b.Range(-1,g.col,-1,g.colCount)),e.appendRange(c.rangeToString(g),!0,!1)):e.appendRange(c.rangeToString(g),!1,!0),c.isWorking=!0):2===j?(r=k,s=d.frozenColCount?d._getFirstVisualColumn():d._scrollLeftCol,g=d._getExtendedRange(k,0,k,i-1),g=new b.Range(g.row,-1,g.rowCount,-1),n?e.appendRange(c.rangeToString(g),!1,!1):m?(p>=0&&(g=d._getExtendedRange(k,0,p,i-1),g=new b.Range(g.row,-1,g.rowCount,-1)),e.appendRange(c.rangeToString(g),!0,!1)):e.appendRange(c.rangeToString(g),!1,!0),c.isWorking=!0):3===j&&(r=k,s=l,g=d._getExtendedRange(k,l,k,l),g=new b.Range(g.row,g.col,1,1),n?e.appendRange(c.rangeToString(g),!1,!1):m?(p>=0&&q>=0&&(g=d._getExtendedRange(k,l,p,q)),e.appendRange(c.rangeToString(g),!0,!1)):e.appendRange(c.rangeToString(g),!1,!0),c.isWorking=!0),c.isFormulaRangeAppending=c.isWorking,m&&f||(o.anchorRow=r,o.anchorCol=s,o.leadingRow=r,o.leadingCol=s),c.startHitInfo={scrollRowViewportIndex:a.rowViewportIndex,scrollColViewportIndex:a.colViewportIndex,hitTestType:a.hitTestType},c.startScroll()}},H.prototype.continueFormulaRangeAppending=function(){var a=this,b=a.startHitInfo;if(b&&a.isWorking){var c=b.hitTestType;3===c?a.continueFormulaRangeCellAppending():2===c?a.continueFormulaRangeRowAppending():1===c&&a.continueFormulaRangeColumnAppending()}},H.prototype.continueFormulaRangeCellAppending=function(){var a=this,b=a._formulaRangeAppendingInfo,c=b.anchorRow,d=b.anchorCol,e=a.getHitRowIndex(),f=a.getHitColumnIndex();if(c>=0&&d>=0&&e>=0&&f>=0){var g=a._sheet,h=g._getExtendedRange(e,f,c,d),i=a.rangeToString(h);if(i){var j=g._formulaTextBox;j.appendRange(i,!0,!1)}}a.continueScroll()},H.prototype.continueFormulaRangeRowAppending=function(){var a=this,c=a._formulaRangeAppendingInfo.anchorRow,d=a.getHitRowIndex();if(c>=0&&d>=0){var e=a._sheet,f=e._getExtendedRange(d,0,c,e.getColumnCount()-1);f=new b.Range(f.row,-1,f.rowCount,-1);var g=a.rangeToString(f);if(g){var h=e._formulaTextBox;h.appendRange(g,!0,!1)}}a.continueScroll()},H.prototype.continueFormulaRangeColumnAppending=function(){var a=this,c=a._formulaRangeAppendingInfo.anchorCol,d=a.getHitColumnIndex();if(c>=0&&d>=0){var e=a._sheet,f=e._getExtendedRange(0,d,e.getRowCount()-1,c);f=new b.Range(-1,f.col,-1,f.colCount);var g=a.rangeToString(f);if(g){var h=e._formulaTextBox;h.appendRange(g,!0,!1)}}a.continueScroll()},H.prototype.stopFormulaRangeAppending=function(){var a=this;a.stopScroll(),a.startHitInfo=c,a.isWorking=!1,a.isFormulaRangeAppending=!1},H.prototype.startFormulaRangeMoving=function(a){var b=this,c=b._sheet,d=c._formulaTextBox,e=a.formulaRangeHitInfo;if(e&&e.inBorder&&d){d.isAppending()&&d.stopAppending(),d.close();var f=e.paramRange,g=f&&f.text;if(g){var h=b.stringToRange(g);if(h){var i=c._fixRange(h),j=a.row,k=a.col;j<i.row&&(j=i.row),j>=i.row+i.rowCount&&(j=i.row+i.rowCount-1),k<i.col&&(k=i.col),k>=i.col+i.colCount&&(k=i.col+i.colCount-1);var l=j-i.row,m=k-i.col;b.isWorking=!0,b.isFormulaRangeMoving=!0,b._formulaRangeMovingInfo={paramRange:f,fromRange:h,rowOffset:l,colOffset:m},b.startHitInfo={scrollRowViewportIndex:a.rowViewportIndex,scrollColViewportIndex:a.colViewportIndex,hitTestType:a.hitTestType},b.startScroll()}}}},H.prototype.continueFormulaRangeMoving=function(){var a=this;if(a.isWorking&&a.isFormulaRangeMoving){var c=a.getHitRowIndex(),d=a.getHitColumnIndex();if(c>=0&&d>=0){var g=a._formulaRangeMovingInfo,h=g.fromRange,i=g.rowOffset,j=g.colOffset,k=g.toRow,l=g.toCol,m=c,n=d;if(m!==k||n!==l){g.toRow=m,g.toCol=n;var o=a._sheet,p=o.getRowCount(),q=o.getColumnCount(),r=h.row,s=h.col,t=h.rowCount,u=h.colCount,v=0>r?-1:e(0,f(p-t,c-i)),w=0>s?-1:e(0,f(q-u,d-j)),x=a.rangeToString(new b.Range(v,w,t,u));if(x){var y=o._formulaTextBox;y.repalceRange(g.paramRange.index,x)}}}a.continueScroll()}},H.prototype.stopFormulaRangeMoving=function(){var a=this;a.stopScroll(),a.isWorking=!1,a.isFormulaRangeMoving=!1,a._formulaRangeMovingInfo=c},H.prototype.startFormulaRangeResizing=function(a){var b=this,c=b._sheet,d=c._formulaTextBox,e=a.formulaRangeHitInfo;if(e&&d){d.isAppending()&&d.stopAppending();var f=e.paramRange,g=f&&f.text;if(g){var h=b.stringToRange(g);if(h){var i,j,k,l,m=h.row,n=h.row<0?-1:h.row+h.rowCount-1,o=h.col,p=h.col<0?-1:h.col+h.colCount-1;if(e.inTopLeft)i=n,j=p,k=m,l=o;else if(e.inTopRight)i=n,j=o,k=m,l=p;else if(e.inBottomLeft)i=m,j=p,k=n,l=o;else{if(!e.inBottomRight)return;i=m,j=o,k=n,l=p}b.isWorking=!0,b.isFormulaRangeResizing=!0,b._formulaRangeResizingInfo={paramRange:f,anchorRow:i,anchorCol:j,toRow:k,toCol:l},b.startHitInfo={scrollRowViewportIndex:a.rowViewportIndex,scrollColViewportIndex:a.colViewportIndex,hitTestType:a.hitTestType},b.startScroll()}}}},H.prototype.continueFormulaRangeResizing=function(){var a=this;if(a.isWorking&&a.isFormulaRangeResizing){var c=a.getHitRowIndex(),d=a.getHitColumnIndex();if(c>=0&&d>=0){var g=a._formulaRangeResizingInfo,h=g.anchorRow,i=g.anchorCol,j=g.toRow,k=g.toCol,l=c,m=d;if(l!==j||m!==k){g.toRow=l,g.toCol=m;var n=a._sheet,o=n.getRowCount(),p=n.getColumnCount(),q=0>h?o-1:h,r=0>i?p-1:i,s=f(q,l),t=f(r,m),u=e(q,l)-s+1,v=e(r,m)-t+1;0===s&&u===o&&(s=-1,u=-1),0===t&&v===p&&(t=-1,v=-1);var w=a.rangeToString(new b.Range(s,t,u,v));if(w){var x=n._formulaTextBox;x.repalceRange(g.paramRange.index,w)}}}a.continueScroll()}},H.prototype.stopFormulaRangeResizing=function(){var a=this;a.stopScroll(),a.isWorking=!1,a.isFormulaRangeResizing=!1,a._formulaRangeResizingInfo=c},H.prototype.getFormulaRangeHitInfo=function(a,b,d){var e=this._sheet,f=e._formulaTextBox,g=f&&f.getRanges();if(!g||0===g.length)return c;var h=a.rowViewportIndex,i=a.colViewportIndex;if(this.inGrayArea(h,i,b,d))return c;for(var j,k,l,m=g.length-1;m>=0;m--)if(j=g[m],k=this.stringToRange(j.text),k&&(l=e._getRangeRect(h,i,k),l&&l.width>0&&l.height>0)){var n=5,o=l.x-2,p=l.x+l.width+1-n,q=l.y-2,r=l.y+l.height+1-n;if(b>=o+n&&p>b&&(d>=q+1&&q+3>=d||d>=r+1&&r+3>=d))return{paramRange:j,inBorder:!0};if(d>=q+n&&r>d&&(b>=o+1&&o+3>=b||b>=p+1&&p+3>=b))return{paramRange:j,inBorder:!0};if(b>=p&&p+n>b&&d>=r&&r+n>d)return{paramRange:j,inBottomRight:!0};if(b>=o&&o+n>b&&d>=r&&r+n>d)return{paramRange:j,inBottomLeft:!0};if(b>=p&&p+n>b&&d>=q&&q+n>d)return{paramRange:j,inTopRight:!0};if(b>=o&&o+n>b&&d>=q&&q+n>d)return{paramRange:j,inTopLeft:!0}}return c},H.prototype.changeFormulaReference=function(){var d=this,e=d._sheet,f=e._formulaTextBox;if(f){var g,h,i=(a.spread,b.Calc),j=i.Expressions,k=e._activeRowIndex,l=e._activeColIndex,m=1===e.referenceStyle(),n=new i.ParserContext(m,k,l),o=new i.Parser;if(f.isAppending())for(var p=f.getAppendingRanges(),q=0;q<p.length;q++){g=p[q];try{h=o.parse(g.text,n)}catch(r){h=c}h&&(h instanceof j.RangeExpression?(d.changeRangeExpressionReference(h,k,l,!0,!0),f.repalceRange(g.index,o.unparse(h,n))):h instanceof j.CellExpression&&(d.changeCellExpressionReference(h,k,l),f.repalceRange(g.index,o.unparse(h,n))))
}else{if(g=f.getActiveRange(),!g)return;try{h=o.parse(g.text,n)}catch(r){h=c}if(!h)return;if(h instanceof j.RangeExpression){var s=g.textOffset+g.text.lastIndexOf(":"),t=f.caret()<=s;if(t){d.changeRangeExpressionReference(h,k,l,!0,!1);var u=o.unparse(h,n);f.repalceRange(g.index,u),f.caret(g.textOffset+u.lastIndexOf(":"))}else d.changeRangeExpressionReference(h,k,l,!1,!0),f.repalceRange(g.index,o.unparse(h,n))}else h instanceof j.CellExpression&&(d.changeCellExpressionReference(h,k,l),f.repalceRange(g.index,o.unparse(h,n)))}}},H.prototype.changeRangeExpressionReference=function(a,b,c,d,e){var f=a.startRowRelative,g=a.startColumnRelative;d&&(f&&g?(a.startRowRelative=!1,a.startColumnRelative=!1,a.startRow+=b,a.startColumn+=c):f?(a.startColumnRelative=!0,a.startColumn-=c):g?(a.startRowRelative=!0,a.startColumnRelative=!1,a.startRow-=b,a.startColumn+=c):(a.startColumnRelative=!0,a.startColumn-=c));var h=a.endRowRelative,i=a.endColumnRelative;e&&(h&&i?(a.endRowRelative=!1,a.endColumnRelative=!1,a.endRow+=b,a.endColumn+=c):h?(a.endColumnRelative=!0,a.endColumn-=c):i?(a.endRowRelative=!0,a.endColumnRelative=!1,a.endRow-=b,a.endColumn+=c):(a.endColumnRelative=!0,a.endColumn-=c))},H.prototype.changeCellExpressionReference=function(a,b,c){var d=a.rowRelative,e=a.columnRelative;d&&e?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):d?(a.columnRelative=!0,a.column-=c):e?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)},H.prototype.rangeToString=function(d){if(!d)return c;var e=a.spread,f=b.Calc,g=this._sheet,h=g._activeRowIndex,i=g._activeColIndex,j=1===g.referenceStyle();return d.row<0&&d.col<0&&(d=new e.Range(0,-1,g.getRowCount(),-1)),f.rangeToFormula(d,h,i,15,j)},H.prototype.stringToRange=function(d){if(!d)return c;var e=(a.spread,b.Calc),f=this._sheet,g=f._activeRowIndex,h=f._activeColIndex,i=1===f.referenceStyle();try{return e.formulaToRange(d,g,h,i)}catch(j){}return c},H.prototype.startDragFill=function(a){var b=this;b.isDraggingFill!==!0&&b.isWorking!==!0&&(b.updateDragFillStartRange(),b._dragFillStartRange&&(b.isWorking=!0,b.isDraggingFill=!0,b._isDragAroundIndicator=!0,b._dragStartRowViewport=a.rowViewportIndex,b._dragStartColumnViewport=a.colViewportIndex,b._dragToRowViewport=a.rowViewportIndex,b._dragToColumnViewport=a.colViewportIndex,b.updateDragStartRangeViewports(),b.startHitInfo={scrollRowViewportIndex:a.rowViewportIndex,scrollColViewportIndex:a.colViewportIndex,hitTestType:a.hitTestType},b.startScroll()))},H.prototype.updateDragStartRangeViewports=function(){var a=this,b=a.dragFillStartTopRow();b>=0&&b<a._sheet.frozenRowCount?a._dragFillStartTopRowViewport=0:b>=a._sheet.frozenRowCount&&b<=a._sheet.getRowCount()&&(a._dragFillStartTopRowViewport=1),a._dragFillStartBottomRowViewport=a.isDragFillWholeColumns()?1:a._dragStartRowViewport;var c=a.dragFillStartLeftColumn();c>=0&&c<a._sheet.frozenColCount?a._dragFillStartLeftColumnViewport=0:c>=a._sheet.frozenColCount&&c<=a._sheet.getColumnCount()&&(a._dragFillStartLeftColumnViewport=1),a._dragFillStartRightColumnViewport=a.isDragFillWholeRows()?1:a._dragStartColumnViewport},H.prototype.continueDragFill=function(){var a=this;if(a.startHitInfo&&a.isDraggingFill&&a.isWorking&&a._dragFillStartRange){if(a._dragToRowViewport=a.getHitRowViewportIndex(),a._dragToColumnViewport=a.getHitColumnViewportIndex(),a._dragToRow=a.getHitRowIndex(),a._dragToColumn=a.getHitColumnIndex(),a._dragToRow>=0&&a._dragToColumn>=0){a.updateCurrentFillSettings(),a.updateCurrentFillRange();var b=a._sheet.parent,c=!1,d=a.getDragFillFrameRange();d&&(c=a.validateFillRange(d)),b&&b.showDragFillTip()&&c&&a._showDragFillTooltip(),a.refreshDragFill()}a.continueScroll()}},H.prototype._getDragFillTooltipContent=function(){if(!b.features.fill)return c;var a,d=this,e=d._sheet,f=d._dragFillStartRange,g=d._currentFillRange,h=d.getDragAutoFillType(),i=d.getCurrentFillDirection(),j=d.getDragFillFrameRange();if(1===h){a=0===i||1===i?1:0;var k=new b.FillImp(e),l=c;l=k.fillAuto(j,a,!0);var m=d._getAvailableRange(i,g,f),n=e.getActualStyle(m.row,m.col),o=n.cellType||e.getDefaultCellType(),p=n.formatter?n.formatter:n._autoFormatter;l instanceof Date&&b.features.formatter&&(p=new b.GeneralFormatter(b.DefaultTokens.DateTimeFormatInfo().ShortDatePattern+" hh:mm:ss AM/PM;@",0,b._CultureInfo.currentCulture().Name()));var q=d.startHitInfo,r=3;q&&(r=d.startHitInfo.hitTestType);var s={sheet:e,row:m.row,col:m.col,sheetArea:r};return o.format(l,p,s)}if(0===h){var m=d._getAvailableRange(i,g,f),t=e.getFormula(m.row,m.col);return t?c:e.getText(m.row,m.col)}return c},H.prototype._getAvailableRange=function(a,c,d){var e=new b.Range(d.row,d.col,1,1);if(3===a){var f=c.rowCount%d.rowCount;f=0===f?d.row+d.rowCount-1:d.row+f-1,e.row=f,e.col=d.col}else if(1===a){var f=c.colCount%d.colCount;f=0===f?d.col+d.colCount-1:d.col+f-1,e.row=d.row,e.col=f}else if(0===a){var f=c.colCount%d.colCount;f=0===f?d.col:d.col+d.colCount-f,e.row=d.row,e.col=f}else if(2===a){var f=c.rowCount%d.rowCount;f=0===f?d.row:d.row+d.rowCount-f,e.row=f,e.col=d.col}return e},H.prototype._showDragFillTooltip=function(){var a=this,b=a.getDragAutoFillType();if(4===b||a.isDragFillWholeRows()||a.isDragFillWholeColumns())return a._removeTooltip(),c;var d,e,f,g=a._sheet,h=a.getCurrentFillDirection(),i=a.getDragFillFrameRange(),j=g._getRangeRect2(i);f=a._getDragFillTooltipContent(),3===h?(d=j.x+j.width+a.DRAGFILLTOOLTIP_OFFSET,e=j.y+j.height+a.DRAGFILLTOOLTIP_OFFSET):1===h?(d=j.x+j.width+a.DRAGFILLTOOLTIP_OFFSET,e=j.y+j.height+a.DRAGFILLTOOLTIP_OFFSET):0===h?(d=j.x+a.DRAGFILLTOOLTIP_OFFSET,e=j.y+j.height+a.DRAGFILLTOOLTIP_OFFSET):2===h&&(d=j.x+j.width+a.DRAGFILLTOOLTIP_OFFSET,e=j.y+a.DRAGFILLTOOLTIP_OFFSET),a._showTooltip(f,d,e)},H.prototype.refreshDragFill=function(){var a=this;a.clearDragFill(),a.refreshSelectionBorder(),a.paintDragFill(),a._oldDragFillFrameRange=a.getDragFillFrameRange()},H.prototype.clearDragFill=function(){var a=this._sheet;if(this._oldDragFillFrameRange){var b=a._getRangeRect2(this._oldDragFillFrameRange);b.x-=2,b.y-=2,b.width+=4,b.height+=4,a._render.copyDoubleBufferRect(b)}},H.prototype.refreshSelectionBorder=function(a){var b=this._sheet;b._render.repaintSelection(this._dragFillStartRange,c,a)},H.prototype.paintDragFill=function(){var a=this._sheet,b=a._render,c=this.getDragFillFrameRange();if(c){var d=b._getCtx(),e=a._getRangeRect2(c);d.save(),d.beginPath(),b.paintDragRectangle(d,e),d.restore()}},H.prototype.updateCurrentFillRange=function(){this._currentFillRange=this.getCurrentFillRange()},H.prototype.isDragFillWholeRows=function(){return-1===this._dragFillStartRange.col&&-1!==this._dragFillStartRange.row},H.prototype.isDragFillWholeColumns=function(){return-1===this._dragFillStartRange.row&&-1!==this._dragFillStartRange.col},H.prototype.isDragClear=function(){return 4===this._currentFillDirection||5===this._currentFillDirection},H.prototype.getCurrentFillRange=function(){var a=this,c=-1,d=-1,e=-1,f=-1;switch(a._currentFillDirection){case 0:a.isDragFillWholeColumns()?(c=-1,e=-1):(c=a.dragFillStartTopRow(),e=a._dragFillStartRange.rowCount),d=a._dragToColumn,f=a.dragFillStartLeftColumn()-d;break;case 1:a.isDragFillWholeColumns()?(c=-1,e=-1):(c=a.dragFillStartTopRow(),e=a._dragFillStartRange.rowCount),d=a.dragFillStartRightColumn()+1,f=a._dragToColumn-d+1;break;case 2:c=a._dragToRow,e=a.dragFillStartTopRow()-c,a.isDragFillWholeRows()?(d=-1,f=-1):(d=a.dragFillStartLeftColumn(),f=a._dragFillStartRange.colCount);break;case 3:c=a.dragFillStartBottomRow()+1,e=a._dragToRow-c+1,a.isDragFillWholeRows()?(d=-1,f=-1):(d=a.dragFillStartLeftColumn(),f=a._dragFillStartRange.colCount);break;case 5:c=a._dragToRow,e=a.dragFillStartBottomRow()-c+1,a.isDragFillWholeRows()?(d=-1,f=-1):(d=a.dragFillStartLeftColumn(),f=a._dragFillStartRange.colCount);break;case 4:a.isDragFillWholeColumns()?(c=-1,e=-1):(c=a._dragFillStartRange.row,e=a._dragFillStartRange.rowCount),d=a._dragToColumn,f=a.dragFillStartRightColumn()-d+1}return new b.Range(c,d,e,f)},H.prototype.dragFillStartBottomRowLayout=function(){var a=this.dragFillStartBottomRow();return-1!==a?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(a):c},H.prototype.dragFillToViewportBottomRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportBottomRow())},H.prototype.dragFillToViewportBottomRow=function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},H.prototype.dragFillStartRightColumnLayout=function(){var a=this.dragFillStartRightColumn();return-1!==a?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(a):c},H.prototype.dragFillToViewportRightColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportRightColumn())},H.prototype.dragFillToViewportRightColumn=function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},H.prototype.updateCurrentFillSettings=function(){var a,b,c=this,d=c.isDragFillWholeRows(),e=c.isDragFillWholeColumns(),h=$(c._sheet._getCanvas()).offset(),i=c.mousePosition.e,j=c.mousePosition.x,k=c.mousePosition.y,l=i.pageX-h.left,m=i.pageY-h.top,n=!1;if(d||e)e?c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?c._currentFillDirection=4:c._dragToColumn<c.dragFillStartLeftColumn()?c._currentFillDirection=0:c._dragToColumn>c.dragFillStartRightColumn()&&(c._currentFillDirection=1):d&&(c._dragToRow>=c.dragFillStartTopRow()&&c._dragToRow<=c.dragFillStartBottomRow()?c._currentFillDirection=5:c._dragToRow<c.dragFillStartTopRow()?c._currentFillDirection=2:c._dragToRow>c.dragFillStartBottomRow()&&(c._currentFillDirection=3));else if(c._dragToRow>=c.dragFillStartTopRow()&&c._dragToRow<=c.dragFillStartBottomRow())if(c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn())if(a=g(c._dragToColumn-c.dragFillStartRightColumn()),b=g(c._dragToRow-c.dragFillStartBottomRow()),b>a)c._currentFillDirection=5;else if(a>b)c._currentFillDirection=4;else{var o=c.dragFillStartBottomRowLayout();if(o||(o=c.dragFillToViewportBottomRowLayout()),k>o.y+o.height)c._currentFillDirection=3;else{var p=c.dragFillStartRightColumnLayout();p||(p=c.dragFillToViewportRightColumnLayout());var q=p.x+p.width-j,r=o.y+o.height-k;l>=p.x&&l<=p.x+p.width&&m>=o.y&&m<=o.y+o.height?c._currentFillDirection=q>=r?4:5:n=!0}}else c._dragToColumn<c.dragFillStartLeftColumn()?c._currentFillDirection=0:c._dragToColumn>c.dragFillStartRightColumn()&&(c._currentFillDirection=1);else c._dragToRow<c.dragFillStartTopRow()?c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?c._currentFillDirection=2:c._dragToColumn<c.dragFillStartLeftColumn()?(a=g(c._dragToColumn-c.dragFillStartLeftColumn()),b=g(c._dragToRow-c.dragFillStartTopRow()),c._currentFillDirection=b>=a?2:0):c._dragToColumn>c.dragFillStartRightColumn()&&(a=g(c._dragToColumn-c.dragFillStartRightColumn()),b=g(c._dragToRow-c.dragFillStartTopRow()),c._currentFillDirection=b>=a?2:1):c._dragToRow>c.dragFillStartBottomRow()&&(c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?c._currentFillDirection=3:c._dragToColumn<c.dragFillStartLeftColumn()?(a=g(c._dragToColumn-c.dragFillStartLeftColumn()),b=g(c._dragToRow-c.dragFillStartBottomRow()),c._currentFillDirection=b>=a?3:0):c._dragToColumn>c.dragFillStartRightColumn()&&(a=g(c._dragToColumn-c.dragFillStartRightColumn()),b=g(c._dragToRow-c.dragFillStartBottomRow()),c._currentFillDirection=b>=a?3:1));var s=c._sheet._dragFillIndicatorRect;if(s){var t=c.dragFillStartBottomRow(),u=c.dragFillStartRightColumn(),v=t+1,w=u+1,x=c._sheet.getRowHeight(t,3),y=c._sheet.getColumnWidth(u,3),z=c._sheet.getRowHeight(v,3),A=c._sheet.getColumnWidth(w,3),B=s.x+s.width/2-f(10,y/2),C=s.x+s.width/2+f(10,A/2),D=s.y+s.height/2-f(10,x/2),E=s.y+s.height/2+f(10,z/2),F=!1;d||e?e?F=l>=B&&C>=l:d&&(F=m>=D&&E>=m):F=l>=B&&C>=l&&m>=D&&E>=m,F||n?(c._isDragAroundIndicator=!0,c._currentFillDirection=4):c._isDragAroundIndicator=!1}},H.prototype.dragFillStartTopRow=function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?0:this._dragFillStartRange.row:-1},H.prototype.dragFillStartBottomRow=function(){var a=this;return a._dragFillStartRange?-1===a._dragFillStartRange.row?a._sheet.getRowCount()-1:a._dragFillStartRange.row+a._dragFillStartRange.rowCount-1:-1},H.prototype.dragFillStartLeftColumn=function(){return this._dragFillStartRange?-1===this._dragFillStartRange.col?0:this._dragFillStartRange.col:-1},H.prototype.dragFillStartRightColumn=function(){var a=this;return a._dragFillStartRange?-1===a._dragFillStartRange.col?a._sheet.getColumnCount()-1:a._dragFillStartRange.col+a._dragFillStartRange.colCount-1:-1},H.prototype.endDragFill=function(){var a=this;if(a.startHitInfo=c,a.stopScroll(),a._removeTooltip(),!a.isDraggingFill||!a.isWorking)return void a.resetDragFill();a.isDraggingFill=!1,a.isWorking=!1;var b=a.getDragFillFrameRange();if(b){var d=a.validateFillRange(b);if(!d||a._isDragAroundIndicator)a.resetDragFill(),a.refreshSelection(b);else{var e=a.getDragAutoFillType(),f=a.executeDragFillAction(a._currentFillRange,e);!f&&a.isDragFill()?a.showDragFillSmartTag(e):a.refreshSelection(b),a.resetDragFill()}}},H.prototype.showDragFillSmartTag=function(a){if(b.features.fill_ui){var c=this._sheet,d=c._dragFillIndicatorRect,e={x:d.x+d.width,y:d.y+d.height,fillType:a};c._smartTag=new b._GcFillDialog(c,e),c._smartTag.open()}},H.prototype.updateDragFillStartRange=function(){var a=this._sheet;1===a._selectionModel.length?this._dragFillStartRange=a._selectionModel[0]:a._activeRowIndex>=0&&a._activeColIndex>=0&&(this._dragFillStartRange=new b.Range(a._activeRowIndex,a._activeColIndex,1,1))},H.prototype.resetDragFill=function(){this.isWorking=!1,this.isDraggingFill=!1},H.prototype.refreshSelection=function(a){this._sheet._render.repaintSelection(a)},H.prototype.getDragAutoFillType=function(){var a=this;if(a.isDragClear())return 4;var b=1===a._dragFillStartRange.rowCount&&1===a._dragFillStartRange.colCount&&!a.isDragFillWholeColumns()&&!a.isDragFillWholeRows();return b?a.isControlPressed?1:0:a.isControlPressed?0:1},H.prototype.getDragFillFrameRange=function(){var a=this;if(!a._dragFillStartRange)return c;if(a.isDragClear())return a._dragFillStartRange;if(!a._currentFillRange)return c;var d=0,e=0,f=0,g=0;return a.isVerticalDragFill()?(d=2===a._currentFillDirection?a._currentFillRange.row:a._dragFillStartRange.row,e=a._dragFillStartRange.rowCount+a._currentFillRange.rowCount,f=a._dragFillStartRange.col,g=a._dragFillStartRange.colCount):(d=a._dragFillStartRange.row,e=a._dragFillStartRange.rowCount,f=0===a._currentFillDirection?a._currentFillRange.col:a._dragFillStartRange.col,g=a._dragFillStartRange.colCount+a._currentFillRange.colCount),new b.Range(d,f,e,g)},H.prototype.validateFillRange=function(a){var c=this._sheet,d=!0,e="";return c._hasSpans(a.row,a.col,a.rowCount,a.colCount)&&(d=!1,e=b.SR.Exp_FillRangeContainsMergedCell),d&&c.isProtected&&c._isAnyCellInRangeLocked(a)&&(d=!1,e=b.SR.Exp_FillCellsReadOnly),d||c._raiseInvalidOperation(2,e),d},H.prototype.executeDragFillAction=function(a,c){var d=this,e=d._sheet,f=e._getActualRange(a);d._preFillCellsInfo=new b.UndoRedo.CopyMoveCellsInfo(f.rowCount,f.colCount),b.UndoRedo.CopyMoveHelper.saveViewportInfo(e,d._preFillCellsInfo,f.row,f.col,1023);var g={startRange:d._dragFillStartRange,fillRange:a,autoFillType:c,fillDirection:d.getCurrentFillDirection()},h=e._raiseDragFillBlock(g.fillRange,g.fillDirection,g.autoFillType);if(!h){var i=new b.UndoRedo.DragFillUndoAction(e,g);return e.doCommand(i),e._raiseDragFillBlockCompleted(g.fillRange,g.fillDirection,g.autoFillType),!1}return!0},H.prototype.isDragFill=function(){return this.isIncreaseFill()||this.isDecreaseFill()},H.prototype.isIncreaseFill=function(){return 3===this._currentFillDirection||1===this._currentFillDirection},H.prototype.isDecreaseFill=function(){return 0===this._currentFillDirection||2===this._currentFillDirection},H.prototype.isVerticalDragFill=function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},H.prototype.isDragToRowInView=function(){return this.isRowInViewport(this._dragToRowViewport,this._dragToRow)},H.prototype.isRowInViewport=function(a,b){var c=this._sheet.getViewportTopRow(a),d=this._sheet.getViewportBottomRow(a);return b>=c&&d>=b?!0:!1},H.prototype.getCurrentDragToRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragToRow)},H.prototype.isDragFillStartBottomRowInView=function(){return this.isRowInViewport(this._dragFillStartBottomRowViewport,this.dragFillStartBottomRow())},H.prototype.dragFillStartViewportBottomRowLayout=function(){return this._sheet._getRowLayout(this._dragStartRowViewport).findRow(this.dragFillStartViewportBottomRow())},H.prototype.dragFillStartViewportBottomRow=function(){return this._sheet.getViewportBottomRow(this._dragStartRowViewport)},H.prototype.getValidVerDragToRowLayout=function(){var a,b=this;return a=b.isIncreaseFill()?b.isDragToRowInView()?b.getCurrentDragToRowLayout():b.dragFillToViewportBottomRowLayout():b.isDragFillStartBottomRowInView?b.dragFillStartBottomRowLayout():b.dragFillStartViewportBottomRowLayout()},H.prototype.isDragToColumnInView=function(){return this.isColumnInViewport(this._dragToColumnViewport,this._dragToColumn)},H.prototype.isColumnInViewport=function(a,b){var c=this._sheet.getViewportLeftColumn(a),d=this._sheet.getViewportRightColumn(a);return b>=c&&d>=b?!0:!1},H.prototype.getCurrentDragToColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragToColumn)},H.prototype.isDragFillStartRightColumnInView=function(){return this.isColumnInViewport(this._dragFillStartRightColumnViewport,this.dragFillStartRightColumn())},H.prototype.dragFillStartViewportRightColumnLayout=function(){return this._sheet._getColumnLayout(this._dragStartColumnViewport).findCol(this.dragFillStartViewportRightColumn())},H.prototype.dragFillStartViewportRightColumn=function(){return this._sheet.getViewportRightColumn(this._dragStartColumnViewport)},H.prototype.getValidHorDragToColumnLayout=function(){var a,b=this;return a=b.isIncreaseFill()?b.isDragToColumnInView()?b.getCurrentDragToColumnLayout():b.dragFillToViewportRightColumnLayout():b.isDragFillStartRightColumnInView()?b.dragFillStartRightColumnLayout():b.dragFillStartViewportRightColumnLayout()},H.prototype.dragFillToViewportTopRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportTopRow())},H.prototype.dragFillToViewportTopRow=function(){return this._sheet.getViewportTopRow(this._dragToRowViewport)},H.prototype.dragFillToViewportLeftColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportLeftColumn())},H.prototype.dragFillToViewportLeftColumn=function(){return this._sheet.getViewportLeftColumn(this._dragToColumnViewport)},H.prototype.getCurrentFillDirection=function(){switch(this._currentFillDirection){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 0;case 5:return 2}return 3},H.prototype.getHitRowViewportIndex=function(){var a=this._sheet,b=a._getRowViewportIndexNearY(this.mousePosition.y),c=this.startHitInfo.scrollRowViewportIndex,d=a._getRowLayout(1);return 0===b&&c>0&&d.length>0&&d[0].row>a._getFirstPageTopRow()?b=1:2===b&&2>c&&d.length>0&&d[d.length-1].row<a._getLastVisualRow()&&(b=1),b},H.prototype.getHitColumnViewportIndex=function(){var a=this._sheet,b=a._getColumnViewportIndexNearX(this.mousePosition.x),c=this.startHitInfo.scrollColViewportIndex,d=a._getColumnLayout(1);return 0===b&&c>0&&d.length>0&&d[0].col>a._getFirstPageLeftColumn()?b=1:2===b&&2>c&&d.length>0&&d[d.length-1].col<a._getLastVisualColumn()&&(b=1),b},H.prototype.getHitRowIndex=function(){var a=this._sheet,b=this.mousePosition.y,c=this.getHitRowViewportIndex(),d=a._getViewportRowLayoutNearY(c,b);if(d){var e=a._getSheetLayout(),f=d.row;return 1===c&&b<e.viewportY&&f>a._getFirstPageTopRow()?a._getNextVisualRow(f-1)||f:1===c&&b>e.frozenTrailingY&&f>a._getLastFullyVisibleRow()?a._getPrevVisualRow(f)||f:f}return-1},H.prototype.getHitColumnIndex=function(){var a=this._sheet,b=this.mousePosition.x,c=this.getHitColumnViewportIndex(),d=a._getViewportColumnLayoutNearX(c,b);if(d){var e=a._getSheetLayout(),f=d.col;return 1===c&&b<e.viewportX&&f>a._getFirstPageLeftColumn()?a._getNextVisualColumn(f-1)||f:1===c&&b>e.frozenTrailingX&&f>a._getLastFullyVisibleColumn()?a._getPrevVisualColumn(f)||f:f}return-1},H.prototype.getIntervalFromDistance=function(a){var b=0;if(!isNaN(a)&&0!==a){var c=0>a;a=g(a),b=h(500/a),b=e(20,10*b),b>200&&(b=200),c&&(b=-b)}return b},H.prototype.updateRange=function(a,b,c,d){if(0!==c&&0!==d){var e=this,f=e._sheet,g=3,h=f._getRowLayout(0,g),i=f._getColumnLayout(0,g),j=f._getRowLayout(1,g),k=f._getColumnLayout(1,g),l=0;i&&i.length>0&&(l=i[i.length-1].col),k&&k.length>0&&(l=k[k.length-1].col);var m=e.getYForRow(a,b,c,d,!0,l,h,j),n=e.getYForRow(a,b,c,d,!1,l,h,j),o=0;h&&h.length>0&&(o=h[h.length-1].row),j&&j.length>0&&(o=j[j.length-1].row);var p=e.getXForCol(a,b,c,d,!0,o,i,k),q=e.getXForCol(a,b,c,d,!1,o,i,k),r=f._getSheetLayout(),s=f._render;q>p&&n>m&&s.update(p-r.headerX-2,m-r.headerY-2,q-p+2*r.headerX+2,n-m+2*r.headerY+2),n>m&&s.update(r.headerX,m,r.rowHeaderWidth,n-m),q>p&&(s.update(p,r.headerY,q-p,r.colHeaderHeight),s.update(p,r.footerY,q-p,r.colHeaderHeight))}},H.prototype.getYForRow=function(a,b,c,d,f,g,h,i){var j=this._sheet,k=a;if(f||(k=a+c-1),k<j.frozenRowCount){if(h.length<1)return-1}else{if(i.length<1)return-1;f?k<i[0].row&&(k=i[0].row):k>i[i.length-1].row&&(k=i[i.length-1].row)}var l=0;f&&(l=9e4);for(var m=e(j._scrollLeftCol,b);b+d>m&&g>=m;m++){var n=j.getCellRect(k,m);n&&(f?n.y<l&&(l=n.y):l<n.y+n.height&&(l=n.y+n.height))}return l},H.prototype.getXForCol=function(a,b,c,d,f,g,h,i){var j=this._sheet,k=b;if(f||(k=b+d-1),k<j.frozenColCount){if(h.length<1)return}else{if(i.length<1)return;f?k<i[0].col&&(k=i[0].col):k>i[i.length-1].col&&(k=i[i.length-1].col)}var l=0;f&&(l=9e4);for(var m=e(j._scrollTopRow,a);a+c>m&&g>=m;m++){var n=j.getCellRect(m,k);n&&(f?n.x<l&&(l=n.x):l<n.x+n.width&&(l=n.x+n.width))}return l},H.prototype._getPrevVisualRowBeforeFindRow=function(a,b){var d=this._sheet,e=a;return this._isCellHiddenByGroup(e,0,b)?(e=d._getPrevVisualRow(e,b),e!==c?e:a):a},H.prototype._getPrevVisualColBeforeFindCol=function(a,b){var d=this._sheet,e=a;return this._isCellHiddenByGroup(0,e,b)?(e=d._getPrevVisualColumn(e,b),e!==c?e:a):a},H.prototype._isCellHiddenByGroup=function(a,b,d){(typeof d===i||d===c)&&(d=3);var e,f,g=this._sheet;3===d?(e=g.rowRangeGroup,f=g.colRangeGroup):1===d?f=g.colRangeGroup:2===d&&(e=g.rowRangeGroup);var h=e&&!e._isEmpty()&&e.isCollapsed(a),j=f&&!f._isEmpty()&&f.isCollapsed(b);return h||j},H.prototype._getResizeRowInfo=function(a,b,d,f,g){var h=c,i=a._getRowLayout(b.rowViewportIndex,f);if(i&&!isNaN(b.row)&&!isNaN(b.col)){b.row=this._getPrevVisualRowBeforeFindRow(b.row,f);var j=i.findRow(b.row);if(j)if(j.y+j.height-d<=g&&g<=j.y+j.height+d){h={action:"sizeRow",index:b.row,sheetArea:f};var k=i[i.length-1].row;if(k>=0){var l=a._getLastVisualRow(f);h.index===l&&h.index!==k&&j.y+j.height-d/2<=g&&(h={action:"sizeRow",index:k,sheetArea:f})}}else j.y-d<=g&&g<=j.y+d&&i.indexOf(j)>0&&(h={action:"sizeRow",index:b.row-1,sheetArea:f});if(!h&&1===b.rowViewportIndex&&i.length>0&&(j=i[0],e(0,j.y-d)<=g&&g<=j.y+d)){var m=b.row-1,n=a._getRowLayout(b.rowViewportIndex-1,f);m>=0&&n&&!n.findRow(m)&&0===a.getRowHeight(m)&&(h={action:"sizeRow",index:m,sheetArea:f})}}return h&&!a.getRowResizable(h.index,f)&&(h=c),h},H.prototype._getResizeColInfo=function(a,b,d,f,g){var h=c,i=a._getColumnLayout(b.colViewportIndex,f);if(i&&!isNaN(b.col)&&!isNaN(b.row)){b.col=this._getPrevVisualColBeforeFindCol(b.col,f);var j=i.findCol(b.col);if(j)if(j.x+j.width-d<=g&&g<=j.x+j.width+d){h={action:"sizeCol",index:b.col,sheetArea:f};var k=i[i.length-1].col;if(k>=0){var l=a._getLastVisualColumn(f);h.index===l&&h.index!==k&&j.x+j.width-d/2<=g&&(h={action:"sizeCol",index:k,sheetArea:f})}}else j.x-d<=g&&g<=j.x+d&&i.indexOf(j)>0&&(h={action:"sizeCol",index:b.col-1,sheetArea:f});if(!h&&1===b.colViewportIndex&&i.length>0&&(j=i[0],e(0,j.x-d)<=g&&g<=j.x+d)){var m=b.col-1,n=a._getColumnLayout(b.colViewportIndex-1,f);m>=0&&n&&!n.findCol(m)&&0===a.getColumnWidth(m)&&(h={action:"sizeCol",index:m,sheetArea:f})}}return h&&!a.getColumnResizable(h.index,f)&&(h=c),h},H.prototype.getResizingRowCol=function(a,b,d,e){var f,h,i=this,j=i._sheet,k=c;if(!j.parent||j.parent._allowUserResize){var l=j._getSheetLayout();if(a.rowViewportIndex<0&&a.colViewportIndex>=0&&j.colHeaderVisible)k=i._getResizeColInfo(j,a,e,1,b),k||(k=i._getResizeRowInfo(j,a,e,1,d));else if(a.rowViewportIndex>=0&&a.colViewportIndex<0&&j.rowHeaderVisible)k=i._getResizeRowInfo(j,a,e,2,d),k||(k=i._getResizeColInfo(j,a,e,2,b));else if(a.rowViewportIndex<0&&a.colViewportIndex<0){if(j._getLastVisualRow(2)===c&&g(d-l.colHeaderHeight)<=e){var m=j._getRowLayout(1);m&&m.length>0&&(f=m[m.length-1].row),f>=0&&(k={action:"sizeRow",index:f,sheetArea:2})}else if(j._getLastVisualColumn(1)===c&&g(b-l.rowHeaderWidth)<=e){var n=j._getColumnLayout(1);n&&n.length>0&&(h=n[n.length-1].col),h>=0&&(k={action:"sizeCol",index:h,sheetArea:1})}}else a.rowViewportIndex>=0&&a.colViewportIndex>=0&&(0===l.colHeaderHeight&&e>=d&&j.colHeaderVisible?(f=j.getRowCount(1)-1,f>=0&&(k={action:"sizeRow",index:f,sheetArea:1})):0===l.rowHeaderWidth&&e>=b&&j.rowHeaderVisible&&(h=j.getColumnCount(2)-1,h>=0&&(k={action:"sizeCol",index:h,sheetArea:2})))}return k},H.prototype.getDragInfo=function(a,b,d){var e=this,f=c,g=a.rowViewportIndex,h=a.colViewportIndex;if(typeof g===i||g===c||typeof h===i||h===c)return f;var j=e._sheet,k=j._getActiveSelectedRange();if(-1===k.row&&-1===k.col)return f;if(g>=0&&h>=0&&1===j._selectionModel.length){if(e.inGrayArea(g,h,b,d))return f;var l=j._getRangeRect(g,h,k);if(l.x-4<b&&b<l.x+4&&l.y<=d&&d<l.y+l.height&&(f={action:"drag",side:"left"}),!f){var m=e._sheet._dragFillIndicatorRect;m&&m.x<=b&&b<=m.x+m.width&&m.y<=d&&d<=m.y+m.height&&(f={action:"drag",side:"corner"})}f||l.x+l.width-4<b&&b<l.x+l.width+4&&l.y<=d&&d<l.y+l.height&&(f={action:"drag",side:"right"}),f||l.y-4<d&&d<l.y+4&&l.x<=b&&b<l.x+l.width&&(f={action:"drag",side:"top"}),f||l.y+l.height-4<d&&d<l.y+l.height+4&&l.x<=b&&b<l.x+l.width&&(f={action:"drag",side:"bottom"}),f&&(b<l.x||b>l.x+l.width||d<l.y||d>l.y+l.height)&&(f.outside=!0)}return e._sheet.canUserDragDrop()||f&&"corner"!==f.side&&(f.side=c),e._sheet.canUserDragFill()||f&&"corner"===f.side&&(f.side=c),f},H.prototype.inGrayArea=function(a,b,c,d){var e=this._sheet,f=e._getSheetLayout(),g=f.viewportRect(1,1);if(1===b){var h=e._getColumnLayout(b);if(h&&h.length>0){var i=h[h.length-1];if(i.x+i.width<=c&&c<g.x+g.width)return!0}else if(g.contains(c,d))return!0}if(1===a){var j=e._getRowLayout(a);if(j&&j.length>0){var k=j[j.length-1];if(k.y+k.height<=d&&d<g.y+g.height)return!0}else if(g.contains(c,d))return!0}return!1},H.prototype.doMouseMove=function(a){var b=this._getCanvasOffset();this.doMouseMoveImp(a,a.pageX-b.left,a.pageY-b.top)},H.prototype.doMouseOut=function(){var a=this._sheet,b=a._currentTarget;if(b&&b.cellTypeHitInfo){var d=b.row,e=b.col,f=a.getCellType(d,e,b.hitTestType);f.processMouseLeave(b.cellTypeHitInfo)}if(!this.isWorking){var g={x:-1e4,y:-1e4,rowViewportIndex:c,colViewportIndex:c,row:-1,col:-1,resizeInfo:c,hitTestType:c};a._setHoverCell(g)}},H.prototype._hoverShowComment=function(a){var b=this._sheet,c=-1,d=-1;if(a&&a.rowViewportIndex>=0&&a.colViewportIndex>=0&&(c=a.row,d=a.col),b.parent){if(0>c||0>d)return;var e=b.getComment(c,d);b._commentManager&&b._commentManager.hoverShowComment(e)}},H.prototype.doMouseMoveImp=function(a,d,e){var f=this;f.mousePosition={e:a,x:d,y:e};var g=f._sheet;if(f.isMouseDown&&(window.gcGlobal.activeElement||(window.gcGlobal.activeElement=g)),f.isMouseDown&&f.isWorking)return void(f.isResizing?f.continueResizing():f.isDragDropping?f.continueDragDropping():f.isDraggingFill?f.continueDragFill():f.isFormulaRangeAppending?f.continueFormulaRangeAppending():f.isFormulaRangeMoving?f.continueFormulaRangeMoving():f.isFormulaRangeResizing?f.continueFormulaRangeResizing():f.isSelecting&&f.continueSelecting());var h=g.hitTest(d,e);if(h){b.features.comment&&f._hoverShowComment(h);var i=g._getCanvas();if(i){var j=g._currentTarget,k=!j||h.row!==j.row||h.col!==j.col||h.hitTestType!==j.hitTestType||h.resizeInfo&&!j.resizeInfo||!h.resizeInfo&&j.resizeInfo||h.resizeInfo&&h.resizeInfo.action!==j.resizeInfo.action||h.dragInfo&&!j.dragInfo||!h.dragInfo&&j.dragInfo||h.dragInfo&&h.dragInfo.action!==j.dragInfo.action;if(j&&k&&j.cellTypeHitInfo){var l=j.row,m=j.col,n=g.getCellType(l,m,j.hitTestType);n.processMouseLeave(j.cellTypeHitInfo)}var o=h.resizeInfo,p=h.dragInfo,q=h.formulaRangeHitInfo,r=h.cellTypeHitInfo,s=g._render;if(o)i.style.cursor="sizeCol"===o.action?"w-resize":"sizeRow"===o.action?"n-resize":"default";else if(p&&"drag"===p.action)"corner"===p.side?i.style.cursor="crosshair":p.side&&(i.style.cursor="move");else if(q){q.inBorder?i.style.cursor="move":q.inTopLeft?i.style.cursor="nw-resize":q.inTopRight?i.style.cursor="ne-resize":q.inBottomLeft?i.style.cursor="sw-resize":q.inBottomRight&&(i.style.cursor="se-resize");var t=f.isFormulaRangeHoving,u=f._formulRangeHovingInfo,v=u&&u.paramRange,w=q.paramRange;f.isFormulaRangeHoving=!0,f._formulRangeHovingInfo={paramRange:w},t&&w.index===v.index||s.paintFormulaTextBox()}else{if(r){var x=h.row,y=h.col,n=g.getCellType(x,y,h.hitTestType);r.sheet=g,k&&n.processMouseEnter(r),n.processMouseMove(r)}!k&&r&&r.isReservedLocation||(i.style.cursor="default"),f.isFormulaRangeHoving&&(f.isFormulaRangeHoving=!1,f._formulRangeHovingInfo=c,s.paintFormulaTextBox())}g._setHoverCell(h)}}},H.prototype.doMouseUp=function(a){var b=this,c=b._sheet;c.inCanvas||b.unhandleDocumentMouseMove();var d=b._getCanvasOffset();return c._isMouseDownInSheet?(c._isMouseDownInSheet=!1,b.doMouseUpImp(a,a.pageX-d.left,a.pageY-d.top),!1):!0},H.prototype.doMouseUpImp=function(a){var c=this,d=c._sheet,e=window.gcGlobal.activeElement;if(c.isMouseDown=!1,e&&e!==d&&e.endEdit&&(e.endEdit(),e.repaint()),c.isResizing)c.stopResizing();else if(c.isDragDropping)c.stopDragDrop();else if(c.isDraggingFill)c.endDragFill();else if(c.isFormulaRangeAppending)c.stopFormulaRangeAppending();else if(c.isFormulaRangeMoving)c.stopFormulaRangeMoving();else if(c.isFormulaRangeResizing)c.stopFormulaRangeResizing();else if(d._currentTarget){var f=d._currentTarget;if(f.cellTypeHitInfo){var g=f.row,h=f.col,i=d.getCellType(g,h,f.hitTestType);f.cellTypeHitInfo.sheet||(f.cellTypeHitInfo.sheet=d),i.processMouseUp(f.cellTypeHitInfo)}f.cellTypeHitInfo&&f.cellTypeHitInfo.isReservedLocation||d._trigger(b.Events.CellClick,{sheet:d,sheetName:d._name,sheetArea:f.hitTestType,row:f.row,col:f.col})}window.gcGlobal.activeElement=d,c.stopSelecting(),c.setMetaKeyState(a)},H.prototype.startEdit=function(a){var b=this._sheet,c=b._getCanvas(),d=this._getCanvasOffset();a.shiftKey||a.ctrlKey||b._doStartEdit(c,a.pageX-d.left,a.pageY-d.top)},H.prototype.doKeyDown=function(a){var c=this,d=c._sheet;if(d){var e=d.getActiveRowIndex(),f=d.getActiveColumnIndex(),g=d.getCellType(e,f),h={isEditing:d.isEditing(),sheet:d,row:e,col:f,sheetArea:3},i={sheet:d,row:e,col:f,sheetArea:3};if(g&&g.isReservedKey(a,h))return void(d.isEditing()||g.processKeyDown(a,i));var j=d._formulaTextBox;if(j&&j.isReservedKey(a))return;var k=d.parent&&d.parent._attachedFormulaTextBox;if(k&&k.isReservedKey(a))return}var l=!(d.isEditing()||a.ctrlKey||a.metaKey||34!==a.keyCode&&33!==a.keyCode&&37!==a.keyCode&&39!==a.keyCode&&9!==a.keyCode&&13!==a.keyCode&&38!==a.keyCode&&40!==a.keyCode);if(d._isTouchMode&&(d._isTouchMode=!1,d._render.refreshTouchSelectionIndicator()),l){if(c._keyPressed)return c._keyPressedCount<25&&c._keyPressedCount++,void b.util.cancelDefault(a);c._keyPressed=!0,c._keyPressedCount=1,c._repeatKeyDown(a)
}else c._keyDownImp(a)},H.prototype._getMouseDownResizeTooltipContent=function(){var a=this._sheet,c=a._currentTarget,d=c.resizeInfo;if("sizeRow"===d.action){var e=a._getAllRowLayout(d.sheetArea);d.index=this._getPrevVisualRowBeforeFindRow(d.index,d.sheetArea);var f=e.findRow(d.index);return f||(f=e.findRow(c.row)),b.SR.Tip_Height+f.height.toFixed(0)+b.SR.Tip_pixels}var g=a._getAllColumnLayout(d.sheetArea);d.index=this._getPrevVisualColBeforeFindCol(d.index,d.sheetArea);var h=g.findCol(d.index);return h||(h=g.findCol(c.col)),b.SR.Tip_Width+h.width.toFixed(0)+b.SR.Tip_pixels},H.prototype._getMouseMoveResizeTooltipContent=function(a){return"sizeRow"===a.action?b.SR.Tip_Height+(a.movingY-a.startY).toFixed(0)+b.SR.Tip_pixels:b.SR.Tip_Width+(a.movingX-a.startX).toFixed(0)+b.SR.Tip_pixels},H.prototype._repeatKeyDown=function(a){var b=this;b._keyPressed&&(b._keyDownImp(a),b._keyPressed&&(b._repeatKeyDownTimeoutID=window.setTimeout(function(){b._repeatKeyDown(a)},500/b._keyPressedCount)))},H.prototype._startEditByKeyboard=function(){var a=this._sheet,b=a._getCanvas();if(b){a._startEditByKeydown=!0;try{var d=a.isEditing();if(a._startEditImp(b,a._activeRowIndex,a._activeColIndex,c,c,!0),!d&&a.isEditing()){var e=a.getCellType(a._activeRowIndex,a._activeColIndex);!e._triggerButtonClicked||32!==event.keyCode||event.ctrlKey||event.shiftKey||event.altKey||e._triggerButtonClicked(a,a._activeRowIndex,a._activeColIndex),e._cancelDefaultKeydown&&e._cancelDefaultKeydown(event)}}finally{a._startEditByKeydown=!1}}},H.prototype._keyDownImp=function(a){var d=this,e=d._sheet;if(d.setMetaKeyState(a),9===a.keyCode&&b.util.cancelDefault(a),e.isEditing()||27!==a.keyCode||a.altKey||a.ctrlKey||a.shiftKey||!e._validationInputMessage||($(e._validationInputMessage).remove(),e._validationInputMessage=c),e.isEditing()||34!==a.keyCode&&33!==a.keyCode&&35!==a.keyCode&&36!==a.keyCode&&38!==a.keyCode&&40!==a.keyCode||b.util.cancelDefault(a),e.isEditing()||37!==a.keyCode&&39!==a.keyCode||b.util.cancelDefault(a),!(b.features.floatingObject&&e._processFloatingObjectsKeyMap(a)||b.features.comment&&e._processCommentKeyMap(a)||e._processKeyMap(a))){var f=229===a.keyCode||0===a.keyCode;if(d.allowEnterEditing(a)&&!f){var g=e._formulaTextBox;g&&g.isAppending()&&g.stopAppending();var h=e.isEditing();if(!h){var i=b.Global.prototype.getUIElement(a.target),j=i&&"gcAttachedFormulaTextBox"===i.getAttribute("gcUIElement");j||d._startEditByKeyboard()}}}},H.prototype.doKeyUp=function(a){var b=this;b._keyPressed=!1,b._repeatKeyDownTimeoutID>0&&(window.clearTimeout(b._repeatKeyDownTimeoutID),b._repeatKeyDownTimeoutID=0);var c=b._sheet;if(c){var d=c.getActiveRowIndex(),e=c.getActiveColumnIndex(),f=c.getCellType(d,e),g={isEditing:c.isEditing(),sheet:c,row:d,col:e,sheetArea:3},h={sheet:c,row:d,col:e,sheetArea:3};if(f&&f.isReservedKey(a,g))return void(c.isEditing()||f.processKeyUp(a,h));var i=c._formulaTextBox;if(i&&i.isReservedKey(a))return;var j=c.parent&&c.parent._attachedFormulaTextBox;if(j&&j.isReservedKey(a))return}b.setMetaKeyState(a)},H.prototype.doCompositionStart=function(){this._startEditByKeyboard()},H.prototype.allowEnterEditing=function(a){return a.ctrlKey||a.altKey||a.metaKey?!1:a.keyCode>=65&&a.keyCode<=90?!0:a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105?!0:a.keyCode>=186&&a.keyCode<=192?!0:a.keyCode>=220&&a.keyCode<=222||219===a.keyCode?!0:a.keyCode>=106&&a.keyCode<=111?!0:32===a.keyCode?!0:61===a.keyCode?!0:173===a.keyCode?!0:229===a.keyCode||0===a.keyCode?!0:8===a.keyCode?!0:!1},H.prototype.setMetaKeyState=function(a){var b=this,c=b._sheet;if(b.shift=a.shiftKey&&!a.ctrlKey,b.ctrl=a.ctrlKey&&!a.shiftKey,c._isNavigateInSelection=!1,9===a.keyCode)if(c._selectionModel.length>1)c._isNavigateInSelection=!0;else{var d=c._getActiveSelectedRange();d&&c._selectionModel.length>0&&(c._isNavigateInSelection=!(c._activeRowIndex===d.row&&c._activeColIndex===d.col&&c._activeRowCount===d.rowCount&&c._activeColCount===d.colCount))}if(b.isDragDropping===!0){var e=c._getActiveSelectedRange(),f=b._isDragInsert,g=b._isDragCopy;b._isDragInsert=-1===e.row||-1===e.col?a.shiftKey:!1,b._isDragCopy=a.ctrlKey,(f!==b._isDragInsert||g!==b._isDragCopy)&&c._render.refreshDragDropIndicator()}b.isShiftPressed=a.shiftKey,b.isControlPressed=a.ctrlKey},H.prototype.doMouseWheel=function(a,c){var d=this._sheet;if(a.ctrlKey){if(!d.parent||d.parent._allowUserZoom){var e=d._zoomFactor,f=d._zoomFactor-.05*c,g=new b.UndoRedo.ZoomUndoAction(d,f);d._doCommand(g),f=d._zoomFactor,e!==f&&d._trigger(b.Events.UserZooming,{sheet:d,sheetName:d._name,oldZoomFactor:e,newZoomFactor:f})}}else{var h=d._scrollTopRow,i=h;if(d.frozenRowCount>0&&(0===d._scrollTopRow&&c>0?i=d.frozenRowCount:0>c&&d._scrollTopRow===d.frozenRowCount-c&&(i=0)),0>c){var j=d._getScrollableRow(i+c,!0);-1!=j?i=j:i+=c}else if(c>0){var j=d._getScrollableRow(i+c);-1!=j?i=j:i+=c}i<d._getFirstPageTopRow()?i=d._getFirstPageTopRow():i>d._getLastVisualRow()&&(i=d._getLastVisualRow()),h!==i&&(this.vScrollTo(i),d._syncVScrollbarPosition(),d._trigger(b.Events.TopRowChanged,{sheet:d,sheetName:d._name,oldTopRow:h,newTopRow:i}))}if(b.features.comment){var k=this._getCanvasOffset(),l=d.hitTest(a.pageX-k.left,a.pageY-k.top);this._hoverShowComment(l)}},H.prototype.updateEditingEditor=function(){var a=this._sheet;if(a.isEditing()){var b=a._activeRowIndex,c=a._activeColIndex,d=a.getCellType(b,c),e=a._editor,f=a.getActualStyle(b,c),g=a.getCellRect(b,c);if(g&&g.width>0&&g.height>0){var h={sheet:a,row:b,col:c,sheetArea:3};d.updateEditor(e,f,g,h)}else $(e).css({top:-1e4,left:-1e4});var i=a._formulaTextBox;i&&i.position()}},H.prototype.doVScroll=function(a){var b=this,c=b._sheet;b.scrolling=!0,b.newTop=a,b.newLeft=c._scrollLeftCol,b.scrollTimer||(b.scrollTimer=window.setInterval(function(){b._scrollView()},b.waittime))},H.prototype.doHScroll=function(a){var b=this,c=b._sheet;b.scrolling=!0,b.newLeft=a,b.newTop=c._scrollTopRow,b.scrollTimer||(b.scrollTimer=window.setInterval(function(){b._scrollView()},b.waittime))},H.prototype._scrollView=function(){var a=this;if(a.scrolling)a.scrolling=!1,a._updateView();else if(a.scrollTimer){window.clearInterval(a.scrollTimer),a.scrollTimer=c;var b=a.newTop!==a._sheet._scrollTopRow;if(b){var d=a._sheet.getViewportTopRow(1),f=a._sheet.getViewportBottomRow(1),g=e(0,d-60);g<a._sheet.getRowCount()&&a._loadData(g,2*f-d)}}},H.prototype._showScrollTooltip=function(a,b){var c,d,e=this;a?(c=b.pageY,d=b.pageX-e.VSCROLLTOOLTIP_LEFT):(c=b.pageY-e.HSCROLLTOOLTIP_TOP,d=b.pageX-e.HSCROLLTOOLTIP_LEFT),e._showTooltip(e._getScrollTooltipContent(a),d,c,!0)},H.prototype._getScrollTooltipContent=function(a){var c,d=this._sheet;return c=a?b.SR.Tip_Row+(d._scrollTopRow+1):1===d.colHeaderAutoText?b.SR.Tip_Column+(d._scrollLeftCol+1):b.SR.Tip_Column+d._indexToLetters(d._scrollLeftCol+1)},H.prototype._loadData=function(a){var b=this;b._sheet.parent&&b._sheet.parent._host&&b._sheet.dataContext&&b._sheet.dataContext.read&&(b._dataContextLoadDelegate=function(a,c){return b._dataContextLoaded(a,c)},b.lastLoadedRowIndex=a)},H.prototype._dataContextLoaded=function(a){var b=a.data;if(b&&b.length>0){var c=this._sheet,d=c.getDataSource();if(d&&this.lastLoadedRowIndex===a.start)for(var e=0;e<b.length;e++)d[a.start+e]=b[e];c.recalcAll(),c.repaint()}},H.prototype.getElementById=function(a,b){if(!a)return c;for(var d=a.firstChild;d;){if(d.id===b||d.name===b)return d;var e=this.getElementById(d,b);if(e)return e;d=d.nextSibling}return c},H.prototype._updateView=function(){var a=this,b=a._sheet;if(!a.painting){a.painting=!0;var c=b.parent,d=0;c&&(d=c.showScrollTip()),a.newTop!==b._scrollTopRow?(a.vScrollTo(a.newTop),(2===d||3===d)&&a._refreshTooltip(a._getScrollTooltipContent(!0))):a.newLeft!==b._scrollLeftCol&&(a.hScrollTo(a.newLeft),(1===d||3===d)&&a._refreshTooltip(a._getScrollTooltipContent(!1))),a.painting=!1}},H.prototype.vScrollTo=function(a){var c=this._sheet,d=c._scrollTopRow;if(a!==d&&(c._scrollTopRow=a,!(c._paintSuspended||c._layoutSuspended>0))){var e=!1;if(b.util._useDoubleBuffer()){var f=c._bounds,g=c._getSheetLayout(),h=g.viewportY,i=g.viewportHeight,j=c._render,k=j._getCtx();if(a>d){var l,m,n=c._getRowLayout(1);if(n&&n.length>0&&(l=n.findRow(a)),l){var o=n.length-1;for(m=n[o];m.y+m.height>h+i;)o-=1,m=n[o];if(m.row>a){e=!0;var p=2,q=f?f.x:g.x,r=l.y,s=g.width,t=m.y+m.height-l.y-p;j.copyScreen(q,r,s,t,q,h),c.invalidateLayout(),j.paintBody(k,new b.Rect(q,h+t,s,i-t)),j.paintAdornment(k,new b.Rect(q,h,s,i))}}}else{for(var u=0,o=a;d>o&&i>u;o++)u+=c._getZoomRowHeight(o);if(i>u){e=!0;var p=2,q=f?f.x:g.x,r=h,s=g.width,t=i-u;c.getFrozenTrailingRowCount()>0&&(t-=1),j.copyScreen(q,r,s,t,q,r+u),c.invalidateLayout(),j.paintBody(k,new b.Rect(q,r,s,u+p)),j.paintAdornment(k,new b.Rect(q,h,s,i))}}}if(e||(c.invalidateLayout(),c.repaint()),b.features.comment){var v=c._commentManager;v.updateCommentsLayoutWhenSheetScroll()}this.updateEditingEditor()}},H.prototype.hScrollTo=function(a){var c=this._sheet,d=c._scrollLeftCol;if(a!==d&&(c._scrollLeftCol=a,!(c._paintSuspended||c._layoutSuspended>0))){var e=!1;if(b.util._useDoubleBuffer()){var f=c._bounds,g=c._getSheetLayout(),h=g.viewportX,i=g.viewportWidth,j=c._render,k=j._getCtx();if(a>d){var l,m,n=c._getColumnLayout(1);if(n&&n.length>0&&(l=n.findCol(a)),l){var o=n.length-1;for(m=n[o];m.x+m.width>h+i;)o-=1,m=n[o];if(m.col>a){e=!0;var p=2,q=l.x,r=f?f.y:g.y,s=m.x+m.width-l.x-p,t=g.height;j.copyScreen(q,r,s,t,h,r),c.invalidateLayout(),j.paintBody(k,new b.Rect(h+s,r,i-s,t)),j.paintAdornment(k,new b.Rect(h,r,i,t))}}}else{for(var u=0,o=a;d>o&&i>u;o++)u+=c._getZoomColumnWidth(o);if(i>u){e=!0;var p=2,q=h,r=f?f.y:g.y,s=i-u,t=g.height;c.getFrozenTrailingColumnCount()>0&&(s-=1),j.copyScreen(q,r,s,t,q+u,r),c.invalidateLayout(),j.paintBody(k,new b.Rect(q,r,u+p,t)),j.paintAdornment(k,new b.Rect(h,r,i,t))}}}if(e||(c.invalidateLayout(),c.repaint()),b.features.comment){var v=c._commentManager;v.updateCommentsLayoutWhenSheetScroll()}this.updateEditingEditor()}},H.prototype._notEqualSelecions=function(a,b){var c=!0;if(a.length===b.length)for(var d=0;d<a.length;d++){var e=a[d],f=b[d];if(e.row!==f.row||e.col!==f.col||e.rowCount!==f.rowCount||e.colCount!==f.colCount){c=!0;break}c=!1}return c},H.prototype._createFocusHolder=function(a,b,d,e){var f,g=this,h=g._sheet,m={sheet:h,row:b,col:d,sheetArea:3},n=a.isImeAware(m);if(e&&g._destroyFocusHolder(),n&&!g._cellTypeFocusHolder){f=a.createEditorElement(m),g._focusHolderOldCss||(g._focusHolderOldCss={overflow:A,border:D}),g._focusHolderOldCss.overflow=f.style.overflow,g._focusHolderOldCss.border=f.style.border,$(f).css(j,k).css(r,z).css(w,"0px").css(x,"0px").css(l,D);var h=g._sheet;h._setEditorValue(a,f,b,d,h.getActualStyle(b,d));var o=a.getEditorValue(f,m);$.browser.safari&&(""===o||o===c||typeof o===i)&&a.setEditorValue(f," ",m),G.body.insertBefore(f,c),g._cellTypeFocusHolder=f}if(!g._originalFocusHolder){f=G.createElement("div"),$(f).css(j,k).css(r,z).css(w,"0px").css(x,"0px"),g._originalFocusHolder=f;var p=G.createElement("textarea");$(p).attr(F,"gcSheetFocusInput").css(j,k).css(r,z).css(l,D).css(y,D),p.value=" ",f.insertBefore(p,c),g._focusElem=p;var q=G.createElement("textarea");$(q).css(j,k).css(r,z).attr(F,"gcSheetFocusInput").attr("readonly","readonly"),f.insertBefore(q,c),g._readonlyFocusElem=q,G.body.insertBefore(f,c)}return g._cellTypeFocusHolder&&g._setVisibleLocation(h,g._cellTypeFocusHolder),g._setVisibleLocation(h,g._originalFocusHolder),n?g._cellTypeFocusHolder:g._focusElem},H.prototype._resetFocusHolder=function(){var a=this;a._cellTypeFocusHolder&&a._focusHolderOldCss&&$(a._cellTypeFocusHolder).css(r,a._focusHolderOldCss.overflow).css(l,a._focusHolderOldCss.border)},H.prototype._destroyFocusHolder=function(){var a=this;a._cellTypeFocusHolder&&(a._cellTypeFocusHolder.parentElement&&a._cellTypeFocusHolder.parentElement.removeChild(a._cellTypeFocusHolder),a._cellTypeFocusHolder=c)},H.prototype.setFocus=function(){window.gcGlobal.activeElement||this._setFocusCore(!0,!0)},H.prototype.changeFocusHolder=function(){this._setFocusCore(!0,!0)},H.prototype._clearTouchSetFocusTimeout=function(){this._touchSetFocusTimeout&&(clearTimeout(this._touchSetFocusTimeout),this._touchSetFocusTimeout=c)},H.prototype._setFocusCore=function(a,c){if(!b.util._isSilverlightCanvas()||b.util._isStandardCanvas()){0===arguments.length&&(a=!0);var d=this;d._focusReleased=!1,d._clearTouchSetFocusTimeout();var e,f,g=d._sheet;e=g.getActiveRowIndex(),f=g.getActiveColumnIndex();var h=g.getCellType(e,f);d._createFocusHolder(h,e,f,c);var i,j={sheet:g,row:e,col:f,sheetArea:3};i=h.isImeAware(j)?d._cellTypeFocusHolder:d._focusElem,c&&!$.browser.msie&&h.setImeMode(i,g.getActualStyle(e,f).imeMode,j),G.body.focus();var k=function(){var a=function(){h.isImeAware(j)?(h.focus(i,j),h.selectAll(i,j)):(i.focus(),i.select())};a(),c&&$.browser.msie&&(h.setImeMode(i,g.getActualStyle(e,f).imeMode,j),a())};!g._isTouchMode||!a&&h.isImeAware(j)?k():$.browser.metroMode?c&&h.setImeMode(d._cellTypeFocusHolder,g.getActualStyle(e,f).imeMode,j):d._touchSetFocusTimeout=setTimeout(function(){d._clearTouchSetFocusTimeout(),g.isEditing()||k()},200),window.gcGlobal.activeElement||(window.gcGlobal.activeElement=g),d._updateValidationUI(g._activeRowIndex,g._activeColIndex)}},H.prototype._setVisibleLocation=function(a,b){var c,d,c,d,e=a.getActiveRowIndex(),f=a.getActiveColumnIndex(),g=a.activeRowViewportIndex,h=a.activeColViewportIndex,i=a.getCellRect(e,f,g,h),j=this;if(j._isInvalidRect(i))c=parseInt($(j._cellTypeFocusHolder).css(s),10),d=parseInt($(j._cellTypeFocusHolder).css(t),10);else{var k=j._getCanvasOffset();c=i.y+k.top-2,d=i.x+k.left-2}var l=window.pageYOffset,m=window.innerHeight+l-parseInt($(j._cellTypeFocusHolder).css(x),10),n=window.pageXOffset,o=window.innerWidth+n-parseInt($(j._cellTypeFocusHolder).css(w),10);(isNaN(c)||l>c||c>m)&&(c=l),(isNaN(d)||n>d||d>o)&&(d=n),$(b).css(s,c),$(b).css(t,d)},H.prototype.releaseFocus=function(a){var b=this;if(b._clearTouchSetFocusTimeout(),!b._focusReleased||G.activeElement!==b._readonlyFocusElem){var c,d,e,f,g=b._sheet;a?(c=a.row,d=a.col,e=a.rowViewportIndex,f=a.colViewportIndex):(c=g._activeRowIndex,d=g._activeColIndex,e=g.activeRowViewportIndex,f=g.activeColViewportIndex);var h=g.getCellType(c,d);b._createFocusHolder(h,c,d,!1),b._readonlyFocusElem.focus(),b._focusReleased=!0}},H.prototype.resumeFocus=function(a){var b=this;0===arguments.length&&(a=!0),b._focusReleased&&(b._focusReleased=!1,b._setFocusCore(a))},H.prototype._switchFocusForClipboard=function(a){var b=this;b._focusElem&&(b._focusElem.value=a,b._focusElem.focus(),b._focusElem.select(),b._clipboardFloatingObjectData=c)},H.prototype._switchBackFocusAfterClipboard=function(){this._setFocusCore(!0,!1)},H.prototype._setClipboardFloatingObjectData=function(a){this._clipboardFloatingObjectData=a},H.prototype._getClipboardFloatingObjectData=function(){return this._clipboardFloatingObjectData},H.prototype._getClipboardData=function(){var a=this._focusElem?this._focusElem.value:"",c=new b.StringBuilder;if(a)for(var d='"',e=d.length,f=!1,g=0;g<a.length;g++){var h=a[g];f||"\n"!==h||(h="\r\n"),c.Append(h),c.Length()>=e&&d===c.ToString(c.Length()-e,e)&&(f=!f)}return c.ToString()},H.prototype._disposeFocusHolders=function(){var a=this;a._clearTouchSetFocusTimeout();var b=a._cellTypeFocusHolder;b&&($(b).remove(),a._cellTypeFocusHolder=d),b=a._originalFocusHolder,b&&($(b).remove(),a._focusElem=d,a._originalFocusHolder=c,a._readonlyFocusElem=c)},H.prototype.bind=function(a,b,c){$(this._getElem()).bind(a,b,c)},H.prototype.unbind=function(a,b){$(this._getElem()).unbind(a,b)},H.prototype.trigger=function(a,b){0===this._eventSuspended&&$(this._getElem()).trigger(a,b)},H.prototype._showTooltip=function(a,b,c,d){var e=this._sheet,f=e.parent;if(f&&!f._tooltip){var g=G.createElement("div");f.useWijmoTheme?($(g).addClass("ui-widget-content"),$(g).addClass("ui-state-default")):$(g).addClass("spread-toolTip"),$(g).css(j,k).css(n,"0px 3px 0px 3px").css(p,"normal normal normal 10pt Arial").css(o,"1px 2px 5px rgba(0,0,0,0.4)").css(m,"3px").width(B).height(B).appendTo(G.body),f._tooltip=g}this._refreshTooltip(a,b,c,d)},H.prototype._refreshTooltip=function(a,b,e,f){var g=this._sheet,h=g.parent;if(h){var i=$(h._tooltip);if(i){a===d||a===c||""===a?i.hide():(i.html(a),i.show());var j=this._getCanvasOffset();f&&(e-=j.top,b-=j.left);var k=g._bounds;e+i.outerHeight()>k.y+k.height&&(e=k.y+k.height-i.outerHeight()),b+i.outerWidth()>k.x+k.width&&(b=k.x+k.width-i.outerWidth()),e!==c&&e!==d&&i.css(s,e+j.top),b!==c&&b!==d&&i.css(t,b+j.left)}}},H.prototype._removeTooltip=function(){var a=this._sheet,b=a.parent;b&&b._tooltip&&($(b._tooltip).remove(),b._tooltip=c)},H}();b._SheetEventHandler=H;!function(){function a(){var a=this;a.top=!1,a.bottom=!1,a.left=!1,a.right=!1,a.distanceX=0,a.distanceY=0,a.nearMouseX=0,a.nearMouseY=0}return a}()}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(b){b.feature("core.sheet_border",["core.common"]);var c="undefined",d=null,e=Math.sqrt,f=Math.pow,g=Math.min,h={first:1,second:2},i=function(){function a(){}return a.prototype.adjust=function(a){var b=this;0===a.orientation?(a.offsetEnd&&(b._x2+=a.offsetEnd),a.offsetStart&&(b._x1+=a.offsetStart)):1===a.orientation&&(a.offsetEnd&&(b._y2+=a.offsetEnd),a.offsetStart&&(b._y1+=a.offsetStart))},a.prototype.paint=function(a){var b=this._color||"#9eb6ce",c=this._lineWidth,d=a.lineWidth,e=a.strokeStyle;(d!==c||e!==b)&&(a.closePath(),a.stroke(),a.beginPath(),d!==c&&(a.lineWidth=c),e!==b&&(a.strokeStyle=b)),this.paintLine(a)},a.prototype.paintLine=function(a){var b=this;a.moveTo(b._x1,b._y1),a.lineTo(b._x2,b._y2)},a.Create=function(a,b,e,f,g,h){switch((typeof h===c||h===d)&&(h=1),h){case 1:return new j(a,b,e,f,g,1);case 2:return new j(a,b,e,f,g,2);case 5:return new j(a,b,e,f,g,3);case 3:return new k(a,b,e,f,g,1,[3,1]);case 9:return new k(a,b,e,f,g,1,[8,2,2,2]);case 4:return new k(a,b,e,f,g,1,[2,2]);case 11:return new k(a,b,e,f,g,1,[9,3,3,3,3,3]);case 13:return new l(a,b,e,f,g,a!==e,[11,1,5,1],[10,2,4,2]);case 10:return new k(a,b,e,f,g,2,[9,3,3,3]);case 12:return new k(a,b,e,f,g,2,[9,3,3,3,3,3]);case 8:return new k(a,b,e,f,g,2,[9,3]);case 7:return new k(a,b,e,f,g,1,[1]);case 6:return new m(a,b,e,f,g,a!==e)}return d},a}();b.Line=i;var j=function(a){function b(b,c,d,e,f,g){a.call(this);var h=g%2;h||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5));var i=this;i._x1=b,i._y1=c,i._x2=d,i._y2=e,i._color=f,i._lineWidth=g}return __extends(b,a),b}(i);b.SolidLine=j;var k=function(a){function b(b,c,d,e,f,g,h){a.call(this);var i=g%2;i||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5));var j=this;j._x1=b,j._y1=c,j._x2=d,j._y2=e,j._color=f,j._lineWidth=g,j._pattern=h}return __extends(b,a),b.prototype.paintLine=function(a){var c=this;b.render(a,c._x1,c._y1,c._x2,c._y2,c._pattern)},b.render=function(a,b,c,d,h,i){var j=e(f(d-b,2)+f(h-c,2)),k={x:(d-b)/j,y:(h-c)/j},l=0,m=0;for(i=i&&i.length?i:[4,4];j>l;){var n=g(i[m++%i.length],j-l),o=m%2;l+=n,o&&a.moveTo(b,c),b+=n*k.x,c+=n*k.y,o&&a.lineTo(b,c)}},b}(i);b.DashedLine=k;var l=function(a){function b(b,c,d,e,f,g,h,i){a.call(this),g?(b-=1,d-=1):(c-=1,e-=1);var j=this;j._x1=b,j._y1=c,j._x2=d,j._y2=e,j._color=f,j._horizental=g,j._lineWidth=1,j._pattern1=h,j._pattern2=i}return __extends(b,a),b.prototype.paintLine=function(a){var b=this,c=b._horizental?0:1,d=b._horizental?1:0;k.render(a,b._x1-c,b._y1-d,b._x2-c,b._y2-d,b._pattern1),k.render(a,b._x1,b._y1,b._x2,b._y2,b._pattern2)},b}(i);b.SlantedLine=l;var m=function(a){function b(b,c,d,e,f,g){a.call(this);var h=g?0:1,i=g?1:0,k=this;k._line1=new j(b-h,c-i,d-h,e-i,f,1),k._line2=new j(b+h,c+i,d+h,e+i,f,1),k._color=f,k._horizental=g,k._lineWidth=1}return __extends(b,a),b.prototype.paintLine=function(a){this._line1.paintLine(a),this._line2.paintLine(a)},b.prototype.adjust=function(a){var b=this;a.lineSide?a.lineSide===h.first?b._line1.adjust(a):a.lineSide===h.second&&b._line2.adjust(a):(b._line1.adjust(a),b._line2.adjust(a))},b}(i);b.DoubleLine=m;var n=function(){return 0},o=function(a,c){if(!a)return c?-1:0;if(!c)return 1;var d=b.LineBorder.prototype._weight(a),e=b.LineBorder.prototype._weight(c);return d===e?n(a.color,c.color):d-e},p=function(a){if(a){if(a.isGridLine)return 1;if(a.style)return b.LineBorder.prototype.width(a.style)}return 0},q=function(a){return a&&6===a.style},r=function(a){return a&&13===a.style},s=function(){var a={previous:-1,next:1},b=function(a,b){return a?b?o(a.style,b.style)>0?a:b:a:b?b:d},e=function(a,b){a&&a.line&&a.line.adjust(b)},f=function(a,b){return a===d||typeof a===c?b===d||typeof b===c?0:-1:b===d||typeof b===c?1:a.isGridLine?b.isGridLine?0:-1:b.isGridLine?1:o(a.style,b.style)},g=function(a){return a&&q(a.style)},i=function(a,b,c,d){if(!g(a)){var e=0;return e+=g(b)?1:0,e+=g(c)?1:0,e+=g(d)?1:0,2>e}return!0},j=function(b,c,d,g,i,j){var k={orientation:j?1:0,offsetStart:0,offsetEnd:0},l=f(b,d),m=f(b,g);l>=0&&m>=0?0===l&&0===m?i!==a.previous&&i===a.next&&(k.offsetEnd-=i):i===a.previous?k.offsetStart-=i:i===i.next&&(k.offsetEnd-=2*i):m>=0?(k.lineSide=h.second,k.offsetStart+=i):l>=0&&(k.lineSide=h.first,k.offsetStart+=i),e(b,k)},k=function(b,c,d,i,j,k,l,m,n){var o={orientation:m?1:0,lineSide:n?h.second:h.first,offsetStart:0,offsetEnd:0},q={orientation:m?1:0,lineSide:n?h.first:h.second,offsetStart:0,offsetEnd:0},r=1===k?i:j,s=l===a.next?d:c,t=g(s);if(t){var u=f(b,r);if(0===u){var v=f(b,s);0===v?l===a.next&&(q.offsetEnd-=l):v>0&&(l===a.previous?q.offsetStart-=2*l:l===a.next&&(q.offsetEnd-=2*l))}else if(u>0){var w=f(b,s);0===w?l===a.next&&(q.offsetEnd-=l):w>0&&(l===a.previous?q.offsetStart-=2*l:l===a.next&&(q.offsetEnd-=2*l))}else{var x=f(b,s);0===x?l===a.previous?o.offsetStart+=2*l:l===a.next&&(o.offsetEnd+=2*l):x>0&&(l===a.previous?o.offsetStart-=3*l:l===a.next&&(o.offsetEnd-=3*l))}}else f(b,r)>=0?l===a.previous?q.offsetStart-=2*l:l===a.next&&(q.offsetEnd-=2*l):l===a.previous?o.offsetStart+=2*l:l===a.next&&(o.offsetEnd+=2*l);var y=1===k?2:1,z=1===y?i:j,A=!1,B=0;if(!A&&g(z)&&f(z,b)>0){A=!0;var C=p(z);f(z,r)>0?C>0&&(B=l===a.next&&g(d)?C>=2?2:1:l===a.previous&&g(c)?C>=3?2:1:3===C?3:2):B=3===C?3:2}A||g(s)||!(s&&!s.isGridLine||z&&!z.isGridLine)||(A=!0,B=l===a.previous?2:1),A&&(l===a.previous?(o.offsetStart+=l*B,q.offsetStart+=l*B):l===a.next&&(o.offsetEnd+=l*B,q.offsetEnd+=l*B)),(o.offsetStart||o.offsetEnd)&&e(b,o),(q.offsetStart||q.offsetEnd)&&e(b,q)},l=function(b,c,d,h,i,j){if(f(b,d)>=0&&f(b,h)>=0){var k={orientation:j?1:0,offsetStart:0,offsetEnd:0};i===a.previous?(k.offsetStart-=2*i,g(b)&&f(c,b)>0&&(k.offsetStart-=1)):i===a.next&&(k.offsetEnd-=2*i,g(b)&&f(c,b)>0&&(k.offsetEnd+=1)),e(b,k)}},m=function(c,d,f,h,i,j){if(g(c)){var k=b(f,h);if(k&&!k.isGridLine){var l=p(k);if(l>0){var m={orientation:j?1:0,offsetStart:0,offsetEnd:0};i===a.previous?m.offsetStart+=l*i:m.offsetEnd+=l*i,(m.offsetStart||m.offsetEnd)&&e(c,m)}}}};return{calcLayoutHorizontal:function(a,c,d,h,j,k,l){var m,n;if(c||d||h){var o=b(d,h);i(a,c,d,h)?(n=f(o,a))>0?(m=p(o),g(a)&&(g(d)||g(h)||g(c))||3===m&&e(a,{orientation:0,offsetStart:1})):o&&0>n?(n=f(a,c))>0?(m=p(o),3===m||2===m?e(a,{orientation:0,offsetStart:-2}):1===m&&e(a,{orientation:0,offsetStart:-1})):0!==n&&f(c,o)>0&&(m=p(o),3===m&&e(a,{orientation:0,offsetStart:1})):0===n&&(!c||f(a,c)>0)&&(m=p(o),3===m||2===m?e(a,{orientation:0,offsetStart:-2}):1===m&&e(a,{orientation:0,offsetStart:-1})):e(a,{orientation:0,offsetStart:1})}if(j||k||l){var q=b(k,l);i(a,j,k,l)?(n=f(q,a))>0?(m=p(q),g(a)&&(g(k)||g(l)||g(j))||(3===m?e(a,{orientation:0,offsetEnd:-2}):(2===m||1===m)&&e(a,{orientation:0,offsetEnd:-1}))):0>n?(n=f(a,j))>0?(m=p(q),3===m&&e(a,{orientation:0,offsetEnd:1})):0!==n&&e(a,{orientation:0,offsetEnd:-1}):0===n&&((n=f(a,j))>0?(m=p(q),3===m&&e(a,{orientation:0,offsetEnd:1})):0!==n&&e(a,{orientation:0,offsetEnd:-1})):e(a,{orientation:0,offsetEnd:-2})}},calcLayoutVertical:function(a,c,h,j,k,l,m){var n,o;if(c||h||j){var q=b(h,j);i(a,c,h,j)?(o=f(q,a))>0?(n=p(q),g(a)&&(g(h)||g(j)||g(c))||3===n&&e(a,{orientation:1,offsetStart:1})):0>o?(o=f(a,c))>0?(n=p(q),3===n||2===n?e(a,{orientation:1,offsetStart:-2}):1===n&&e(a,{orientation:1,offsetStart:-1})):0!==o&&f(c,q)>0&&(n=p(q),3===n&&e(a,{orientation:1,offsetStart:1})):0===o&&f(a,c)>0&&(n=p(q),3===n||2===n?e(a,{orientation:1,offsetStart:-2}):1===n&&e(a,{orientation:1,offsetStart:-1})):e(a,{orientation:1,offsetStart:1})}if(k||l||m){var r=b(l,m);i(a,k,l,m)?(o=f(a,r))<0?(n=p(r),g(a)&&(g(l)||g(m)||g(k))||(3===n||2===n?e(a,{orientation:1,offsetEnd:-2}):1===n&&e(a,{orientation:1,offsetEnd:-1}))):r!==d&&o>0?(o=f(a,k))>0?(n=p(r),3===n&&e(a,{orientation:1,offsetEnd:1})):0!==o&&e(a,{orientation:1,offsetEnd:-1}):0===o&&((o=f(a,k))>0?(n=p(r),3===n&&e(a,{orientation:1,offsetEnd:1})):0!==o&&e(a,{orientation:1,offsetEnd:-1})):e(a,{orientation:1,offsetEnd:-2})}},calcDoubleLayout:function(b,c,d,e,f,h,i,n){n?this.calcLayoutVertical(b,c,d,e,f,h,i):this.calcLayoutHorizontal(b,c,d,e,f,h,i);var o=g(d),p=g(e),q=g(c);o&&p&&q?j(b,c,d,e,a.previous,n):o&&!p?k(b,c,f,d,e,1,a.previous,n,!0):!o&&p?k(b,c,f,d,e,2,a.previous,n,!1):o&&p&&!q?l(b,c,d,e,a.previous,n):q&&m(b,c,d,e,a.previous,n),o=g(h),p=g(i);var r=g(f);o&&p&&r?j(b,f,h,i,a.next,n):o&&!p?k(b,c,f,h,i,1,a.next,n,!0):!o&&p?k(b,c,f,h,i,2,a.next,n,!1):o&&p&&!r?l(b,f,h,i,a.next,n):r&&m(b,f,h,i,a.next,n)}}}(),t={layoutHorizontal:function(a,b,c,d,e,f,g){s.calcLayoutHorizontal(a,b,c,d,e,f,g)},layoutVertical:function(a,b,c,d,e,f,g){s.calcLayoutVertical(a,b,c,d,e,f,g)}},u={layoutHorizontal:function(a,b,c,d,e,f,g){s.calcDoubleLayout(a,b,c,d,e,f,g,!1)},layoutVertical:function(a,b,c,d,e,f,g){s.calcDoubleLayout(a,b,c,d,e,f,g,!0)}},v={layoutHorizontal:function(){},layoutVertical:function(){}},w=function(){function b(a,b,c,d){this._isInitialized=!1,this._isMerged=!1;var e=this;e._sheet=a,e._sheetArea=d,e._rowViewportIndex=b,e._colViewportIndex=c}return b.prototype._initialize=function(){var a=this;a._spanCells=[],a._rowIndecies=[],a._colIndecies=[],a._overflowedCells=[],a._adjustingRanges=[],a._hGridLine={},a._vGridLine={},a._hBorders={},a._vBorders={};var b=a._sheet,c=a._sheetArea,d=a._colViewportIndex,e=a._rowViewportIndex,f=b._getRowLayout(e,c),g=b._getColumnLayout(d,c);if(f&&f.length>0&&g&&g.length>0){for(var h,i=a._rowIndecies,j=f.length,k=0;j>k;k++)h=f[k],h.height>0&&i.push(h.row);for(var l,m=a._colIndecies,n=g.length,o=0;n>o;o++)l=g[o],l.width>0&&m.push(l.col)}a._isInitialized=!0},b.prototype.addCellOverlfowLayout=function(a,b){if(b){var c={row:a,startCol:b.startColumn,endCol:b.endColumn};this._overflowedCells.push(c)}},b.prototype.addCellLines=function(a,b,c,d,e,f,g,h){var i=this;if(i._isInitialized||i._initialize(),h)i._spanCells.push(h);else{var j,k,l,m,n;g&&(j=g.borderLeft,k=g.borderTop,l=g.borderRight,m=g.borderBottom,n=g.backColor),!n||j||l||k||m||i._adjustingRanges.push({r:a,c:b,rc:1,cc:1}),i._addCellLineImp(a,b,c,d,e,f,j,k,l,m,n)}},b.prototype._addCellLineImp=function(a,b,d,e,f,g,h,i,j,k,l,m,n){var o=this,p=!1,q=!1,r=!1,s=!1;i&&(p=o._addCellLineSide(a,b,d,e-.5,d+f,e-.5,i,o._hBorders)),h&&(q=o._addCellLineSide(a,b,d-.5,e,d-.5,e+g,h,o._vBorders)),k&&(r=o._addCellLineSide(a+1,b,d,e+g-.5,d+f,e+g-.5,k,o._hBorders)),j&&(s=o._addCellLineSide(a,b+1,d+f-.5,e,d+f-.5,e+g,j,o._vBorders));var t=o._sheet;if(!l||0===t.getRowHeight(a)||0===t.getColumnWidth(b)){var u=!r&&!m,v=!s&&!n;(u||v)&&o._addGridLine(a,b,d,e,f,g,u,v)}(p||typeof l!==c)&&o._removeLineItem(a-1,b,o._hGridLine),(q||typeof l!==c)&&o._removeLineItem(a,b-1,o._vGridLine),!l||h||j||i||k||(o._adjustLineItem(a-1,b-1,o._vGridLine,!1),o._adjustLineItem(a-1,b-1,o._hGridLine,!0))},b.prototype._addCellLineSide=function(a,b,c,e,f,g,h,j){if(h){var k,l=this._queryLineItem(a,b,j,!0);return l.success?(k=l.lineItem,6!==k.style.style&&(6===h.style||o(h,k.style)>0)&&(k.line=i.Create(c,e,f,g,h.color,h.style),k.style=h)):(k=this._queryLineItem(a,b,j).lineItem,k.line=i.Create(c,e,f,g,h.color,h.style),k.style=h),k.line!==d}return!1},b.prototype._addGridLine=function(b,c,d,e,f,g,h,i){var j=this,k=a.spread,l=3===j._sheetArea,m=j._sheet.gridline,n=k.Line;if(!l||m){var o=l?m.color:"#9eb6ce";if(h&&(m.showHorizontalGridline||!l)){var p=j._queryLineItem(b,c,j._hGridLine).lineItem;p.isGridLine=!0,p.line=n.Create(d,e+g-.5,d+f,e+g-.5,o)}if(i&&(m.showVerticalGridline||!l)){var q=j._queryLineItem(b,c,j._vGridLine).lineItem;q.isGridLine=!0,q.line=n.Create(d+f-.5,e,d+f-.5,e+g,o)}}},b.prototype._adjustLineItem=function(a,b,c,d){var e=this._queryLineItem(a,b,c,!0);if(e.success){var f=e.lineItem;f&&f.line&&f.line.adjust({orientation:d?0:1,offsetEnd:-1})}},b.prototype._removeLineItem=function(a,b,c){if(a>=0&&b>=0){var d=c[a];if(d){var e=d[b];e&&delete d[b]}}},b.prototype._queryLineItem=function(a,b,c,d){if(-1===a||-1===b)return{success:!1};var e=c[a];if(!e){if(d)return{success:!1};c[a]=e={}}var f=e[b];if(!f){if(d)return{success:!1};e[b]=f={}}return{success:!0,lineItem:f}},b.prototype._processOverflowCells=function(){for(var a=this,b=a._overflowedCells,c=b.length,d=a._vBorders,e=a._vGridLine,f=0;c>f;f++)for(var g,h=b[f],i=h.row,j=h.startCol,k=h.endCol,l=j;k>l;l++)g=a._queryLineItem(i,l+1,d,!0),g.success?a._removeLineItem(i,l+1,d):(g=a._queryLineItem(i,l,e,!0),g.success&&a._removeLineItem(i,l,e))},b.prototype._processSpans=function(){var a,b=this._spanCells,c=b.length;if(c>0)for(var d=0;c>d;d++)a=b[d],this._processSpanCell(a)},b.prototype._processSpanCell=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=a.row,s=a.col,t=a.x,u=a.y,v=q._sheet.getActualStyle(r,s,q._sheetArea),w=v?v.backColor:d,x=t,y=u;if(1===a.rowCount)for(h=r,j=q._sheet._getZoomRowHeight(h,q._sheetArea),g=0;g<a.colCount;g++)l=0===g,n=g===a.colCount-1,i=s+g,k=q._sheet._getZoomColumnWidth(i,q._sheetArea),p=q._sheet.getActualStyle(h,i,q._sheetArea),p?(b=p.borderLeft,c=p.borderTop,e=p.borderRight,f=p.borderBottom):b=c=e=f=d,l?q._addCellLineImp(h,i,x,y,k,j,b,c,d,f,w,!1,!0):n?q._addCellLineImp(h,i,x,y,k,j,d,c,e,f,w):q._addCellLineImp(h,i,x,y,k,j,d,c,d,f,w,!1,!0),x+=k;else if(1===a.colCount)for(i=s,k=q._sheet._getZoomColumnWidth(i,q._sheetArea),g=0;g<a.rowCount;g++)m=0===g,o=g===a.rowCount-1,h=r+g,j=q._sheet._getZoomRowHeight(h,q._sheetArea),p=q._sheet.getActualStyle(h,i,q._sheetArea),p?(b=p.borderLeft,c=p.borderTop,e=p.borderRight,f=p.borderBottom):b=c=e=f=d,m?q._addCellLineImp(h,i,x,y,k,j,b,c,e,d,w,!0,!1):o?q._addCellLineImp(h,i,x,y,k,j,b,d,e,f,w):q._addCellLineImp(h,i,x,y,k,j,b,d,e,d,w,!0,!1),y+=j;else for(g=0;g<a.rowCount;g++){h=r+g,m=0===g,o=g===a.rowCount-1,j=q._sheet._getZoomRowHeight(h,q._sheetArea);for(var z=0;z<a.colCount;z++)i=s+z,l=0===z,n=z===a.colCount-1,k=q._sheet._getZoomColumnWidth(i,q._sheetArea),p=q._sheet.getActualStyle(h,i,q._sheetArea),p?(b=p.borderLeft,c=p.borderTop,e=p.borderRight,f=p.borderBottom):b=c=e=f=d,m?l?q._addCellLineImp(h,i,x,y,k,j,b,c,d,d,w,!0,!0):n?q._addCellLineImp(h,i,x,y,k,j,d,c,e,d,w,!0,!1):q._addCellLineImp(h,i,x,y,k,j,d,c,d,d,w,!0,!0):o?l?q._addCellLineImp(h,i,x,y,k,j,b,d,d,f,w,!1,!0):n?q._addCellLineImp(h,i,x,y,k,j,d,d,e,f,w):q._addCellLineImp(h,i,x,y,k,j,d,d,d,f,w,!1,!0):l?q._addCellLineImp(h,i,x,y,k,j,b,d,d,d,w,!0,!0):n&&q._addCellLineImp(h,i,x,y,k,j,d,d,e,d,w,!0,!1),x+=k;x=t,y+=j}!w||b||e||c||f||q._adjustingRanges.push({r:r,c:s,rc:a.rowCount,cc:a.colCount})},b.prototype._adjust=function(){var a=this,b=!1,c=!1;for(var d in a._vBorders){b=!0;break}for(var e in a._hBorders){c=!0;break}(b||c)&&a._adjustBorders(),a._adjustingRanges.length>0&&a._adjustGridlines()},b.prototype._adjustGridlines=function(){for(var a=this,b=a._adjustingRanges,c=b.length,d=0;c>d;d++){var e=b[d],f=e.r,g=e.c,h=f,i=f-1,j=g-1,k=g;e.rc>1&&(h+=e.rc-1),e.cc>1&&(k+=e.cc-1);for(var l=!1,m=!1,n=0;c>n;n++){var o=b[n];if(o.c===k+1&&o.r===f&&(m=!0),o.r===h+1&&o.c===g&&(l=!0),l&&m)break;if(o.r>f+1&&o.c>g+1)break}l||a._adjustLineItem(h,j,a._hGridLine,!0),m||a._adjustLineItem(i,k,a._vGridLine,!1)}},b.prototype._adjustBorders=function(){var a,b,d,e,f=this,g=f._rowIndecies,h=f._colIndecies,i=g.length,j=h.length;for(a=0;i>=a;a++)for(d=g[a],typeof d===c&&a===i&&(d=g[a-1]+1),b=0;j>=b;b++)e=h[b],typeof e===c&&b===j&&(e=h[b-1]+1),f._adjustHorizontalBorderLine(a,b,d,e);
for(b=0;j>=b;b++)for(e=h[b],typeof e===c&&b===j&&(e=h[b-1]+1),a=0;i>=a;a++)d=g[a],typeof d===c&&a===i&&(d=g[a-1]+1),f._adjustVerticalBorderLine(a,b,d,e)},b.prototype._adjustHorizontalBorderLine=function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l._queryLineItem(c,d,l._hBorders,!0),n=0;if(m.success)n++;else if(m=l._queryLineItem(c-1,d,l._hGridLine,!0),!m.success)return;e=m.lineItem,f=l._getLineItemImp(c,l._prevCol(b),!1),f&&f.line&&!f.isGridLine&&n++,g=l._getLineItemImp(l._prevRow(a),d,!0),g&&g.line&&!g.isGridLine&&n++,h=l._getLineItemImp(c,d,!0),h&&h.line&&!h.isGridLine&&n++,i=l._getLineItemImp(c,l._nextCol(b),!1),i&&i.line&&!i.isGridLine&&n++,j=l._getLineItemImp(l._prevRow(a),l._nextCol(b),!0),j&&j.line&&!j.isGridLine&&n++,k=l._getLineItemImp(c,l._nextCol(b),!0),k&&k.line&&!k.isGridLine&&n++,n>0&&(q(e.style)?u.layoutHorizontal(e,f,g,h,i,j,k):r(e.style)?v.layoutHorizontal(e,f,g,h,i,j,k):t.layoutHorizontal(e,f,g,h,i,j,k))},b.prototype._adjustVerticalBorderLine=function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l._queryLineItem(c,d,l._vBorders,!0),n=0;if(m.success)n++;else if(m=l._queryLineItem(c,d-1,l._vGridLine,!0),!m.success)return;e=m.lineItem,f=l._getLineItemImp(l._prevRow(a),d,!0),f&&f.line&&!f.isGridLine&&n++,g=l._getLineItemImp(c,l._prevCol(b),!1),g&&g.line&&!g.isGridLine&&n++,h=l._getLineItemImp(c,d,!1),h&&h.line&&!h.isGridLine&&n++,i=l._getLineItemImp(l._nextRow(a),d,!0),i&&i.line&&!i.isGridLine&&n++,j=l._getLineItemImp(l._nextRow(a),l._prevCol(b),!1),j&&j.line&&!j.isGridLine&&n++,k=l._getLineItemImp(l._nextRow(a),d,!1),k&&k.line&&!k.isGridLine&&n++,n>0&&(q(e.style)?u.layoutVertical(e,f,g,h,i,j,k):r(e.style)?v.layoutVertical(e,f,g,h,i,j,k):t.layoutVertical(e,f,g,h,i,j,k))},b.prototype._prevCol=function(a){return 0>a?-1:this._colIndecies[a-1]},b.prototype._nextCol=function(a){var b=this._colIndecies,d=b.length,e=b[a+1];return typeof e===c&&a+1>=d?b[d-1]+1:e},b.prototype._prevRow=function(a){return 0>a?-1:this._rowIndecies[a-1]},b.prototype._nextRow=function(a){var b=this._rowIndecies,d=b.length,e=b[a+1];return typeof e===c&&a+1>=d?b[d-1]+1:e},b.prototype._getLineItemImp=function(a,b,e){if(typeof a===c||0>a||typeof b===c||0>b)return d;var f=this,g=e?f._vBorders:f._hBorders,h=f._queryLineItem(a,b,g,!0);if(h.success)return h.lineItem;if(g=e?f._vGridLine:f._hGridLine,e){if(--b<0)return d}else if(--a<0)return d;return h=f._queryLineItem(a,b,g,!0),h.success?h.lineItem:d},b.prototype.paint=function(a,b){var c=this;c._isInitialized&&(c._isMerged||(c._processSpans(),c._processOverflowCells(),c._adjust(),c._isMerged=!0),a.save(),a.beginPath(),c._paint(a,b),a.closePath(),a.stroke(),a.restore())},b.prototype._paint=function(a){this._paintGridLine(a),this._paintBorderLines(a)},b.prototype._paintGridLine=function(a){var b=this;b._paintLines(a,b._hGridLine),b._paintLines(a,b._vGridLine)},b.prototype._paintBorderLines=function(a){var b=this;b._paintLines(a,b._hBorders),b._paintLines(a,b._vBorders)},b.prototype._paintLines=function(a,b){if(b){var c,d,e;for(var f in b)if(c=b[f])for(var g in c)d=c[g],e=d&&d.line,e&&e.paint(a)}},b}();b._GcBorders=w}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("core.sheet_render",["core.common","core.sheet_border","core.sheet_action","core.sheet_model","core.imageLoader"]);var b=null,c=Math.min,d=Math.max,e=Math.abs,f=Math.PI,g="undefined",h=window.document,i=function(){function i(a){this.ctx=b,this.buffer=b,this.bufferCtx=b,this._rowGroups=b,this._columnGroups=b,this._floatingObjectRenderManager=b,this._existTouchDragFillIndicator=!1,this._showTouchSelectionIndicator=!0,this._init(a)}return i.prototype._init=function(a){this._sheet=a},i.prototype._getCtx=function(){var c=this;c.ctx=b;var d=c._sheet,e=d._getCanvas();if(e){if(!e.getContext&&a.util._isSilverlightCanvas()&&!e.getContext)return;e.getContext&&(c.ctx=e.getContext("2d"))}return c.ctx&&(c.ctx.name="userContext"),c.ctx},i.prototype._getBufferCtx=function(){var b=this,c=b._sheet,d=c._bounds,e=b.buffer;if(e&&e.width===d.width&&e.height===d.height||(b.buffer=e=h.createElement("canvas"),e.width=d.width,e.height=d.height),e.getContext)b.bufferCtx=e.getContext("2d");else if(a.util._isSilverlightCanvas()){if(!e.getContext)return;b.bufferCtx=e.getContext("2d")}return b.bufferCtx&&(b.bufferCtx.beginPath(),b.bufferCtx.font=b._getZoomFont(b._getDefaultFont()),b.bufferCtx.name="bufferContext"),b.bufferCtx},i.prototype._getDefaultFont=function(a){return 3===a||typeof a===g||a===b?"10pt Arial":"11pt "+this._sheet.currentTheme().bodyFont()},i.prototype._getDefaultBackground=function(){return"white"},i.prototype._getSpreadBackColor=function(){var c=this._sheet,d=c.parent,e=d?d._backColor:this._getDefaultBackground(),f=a._ThemeContext.getColor(c,e),g=d?d._backgroundImage:b;return g&&""!==g&&(f="transparent"),f},i.prototype._getGrayAreaBackColor=function(c){var d=this._sheet,e=d.parent,f=e?e._grayAreaBackColor:"gray",g=this._getThemeContentBackgroundColor(a._ThemeContext.getColor(d,f));if(!c)return g;var h=e?e._backgroundImage:b;return h&&""!==h&&(g="transparent"),g},i.prototype._getZoomFont=function(b){var c=this._sheet,d=c._zoomFactor;return 1===d?b:a.StyleHelper._scaleFont(b,d).font},i.prototype.copyDoubleBuffer=function(a,b,c,d,e){if(!(0>=c||0>=d)){var f=this.buffer,g=this._getCtx();if(f&&g){e||(e=this._sheet._bounds);var h=e.getIntersect(a,b,c,d);if(h){a=h.x,b=h.y,c=h.width,d=h.height;var i=f.width;i&&a+c>i&&(c=i-a);var j=f.height;j&&b+d>j&&(d=j-b),$.browser.qtMode&&(a>0&&c--,b>0&&d--),g.clearRect(a,b,c,d),g.drawImage(f,a,b,c,d,a,b,c,d)}}}},i.prototype.copyDoubleBufferRect=function(a,b){a&&this.copyDoubleBuffer(a.x,a.y,a.width,a.height,b)},i.prototype.copyScreen=function(a,b,c,d,e,f){try{var g=this,h=g._sheet,i=g._getCtx(),j=h._getCanvas(),k=g._getBufferCtx(),l=g.buffer;i.clearRect(e,f,c,d),i.drawImage(l,a,b,c,d,e,f,c,d),k.clearRect(e,f,c,d),k.drawImage(j,e,f,c,d,e,f,c,d)}catch(m){}},i.prototype.repaintSelection=function(b,e,f){var g=this;f||(f=g._getCtx());var h=!1,i=g._sheet,j=new a.Range(-1,-1,-1,-1),k=i._isNavigateInSelection;if(b&&(j=i._allowCellOverflow?new a.Range(b.row,0,b.rowCount,i.getColumnCount()):new a.Range(b.row,b.col,b.rowCount,b.colCount),!k)){if(j.col>=0){for(var l=j.col,m=j.col+j.colCount-1,n=i.getRowCount(1),o=0;n>o;o++){var p=i._colHeaderSpanModel.find(o,j.col);p&&(l=c(p.col,l));var p=i._colHeaderSpanModel.find(o,j.col+j.colCount-1);p&&(m=d(p.col+p.colCount-1,m))}j.col=l,j.colCount=m-l+1}if(j.row>=0){for(var q=j.row,r=j.row+j.rowCount-1,s=i.getColumnCount(2),t=0;s>t;t++){var p=i._rowHeaderSpanModel.find(j.row,t);p&&(q=c(p.row,q));var p=i._rowHeaderSpanModel.find(j.row+j.rowCount-1,t);p&&(r=d(p.row+p.rowCount-1,r))}j.row=q,j.rowCount=r-q+1}}var u=i._getRangeRect2(j);if(u.width>=0&&u.height>=0){if(u.x-=9,u.y-=9,u.width+=18,u.height+=30,e&&(u=u.getIntersectRect(e),!u))return;g.paint(f,u);var v=i._getSheetLayout();u.height>0&&!k&&(i._dirty=!0,g.paint(f,new a.Rect(v.x,d(v.frozenY,u.y),v.rowHeaderWidth,u.height))),u.width>0&&!k&&(i._dirty=!0,g.paint(f,new a.Rect(d(v.frozenX,u.x),v.y,u.width,v.colHeaderHeight))),-1!==j.row||-1!==j.col||k||(i._dirty=!0,g.paint(f,v.headerCornerRect())),h=!0}return h},i.prototype.update=function(b,c,d,e,f){var g=this._sheet;if(!(g._layoutSuspended>0)){var h=this._getCtx();h&&(f||(g._dirty=!0),this.paint(h,new a.Rect(b,c,d,e)))}},i.prototype.repaint=function(a){var b=this._sheet;if(!(b._layoutSuspended>0)){var c=this._getCtx();c&&(b._dirty=!0,this.paint(c,a))}},i.prototype.paint=function(a,b){var c=this._sheet;!a||c._layoutSuspended>0||(this.paintBody(a,b),this.paintAdornment(a,b))},i.prototype.paintBody=function(b,c){var d=this,e=d._sheet;if(b&&!(e._layoutSuspended>0)){var f=a.util._useDoubleBuffer(),g=f?d._getBufferCtx():b;g||(f=!1,g=b);var h=e._bounds;c||(c=h),e._dirty&&(e._dirty=!1,f&&(g.clearRect(c.x,c.y,c.width,c.height),g.translate(-h.x,-h.y)),d.paintSheet(g,c),f&&g.translate(h.x,h.y)),f&&d.copyDoubleBufferRect(c)}},i.prototype.paintAdornment=function(a,b){var c=this,d=c._sheet,e=d._isTouchMode;if(!(!a||d._paintSuspended||d._layoutSuspended>0)){var f,g,h,i,j=d._getSheetLayout();if(!d._hoverCell){if(e){for(h=0;2>=h;h++)f=j.rowHeaderRect(h),f&&0!==f.width&&0!==f.height&&c.copyDoubleBufferRect(f);for(i=0;2>=i;i++)f=j.colHeaderRect(i),f&&0!==f.width&&0!==f.height&&c.copyDoubleBufferRect(f)}for(h=0;2>=h;h++)for(i=0;2>=i;i++)f=j.viewportRect(h,i),f&&0!==f.width&&0!==f.height&&(g=b,!e||1===h&&1===i||(c.copyDoubleBufferRect(f),g=f),(!g||f.intersectRect(g))&&c.paintSelection(a,h,i,g));c.paintResizeLine(a);var k=d._formulaTextBox;if(k)for(h=0;2>=h;h++)for(i=0;2>=i;i++)f=j.viewportRect(h,i),f&&0!==f.width&&0!==f.height&&c.paintFormulaTextBoxRange(a,h,i)}e&&(c.paintTouchResizeIndicator(a),c._existTouchDragFillIndicator?c.paintTouchDragFillIndicator(a):c.paintTouchSelectionIndicator(a))}},i.prototype.paintTouchResizeIndicator=function(b){var c,d,e,f,g=this._sheet,h=g.getRowCount(),i=g.getColumnCount(),j=g._getSheetLayout(),k=16,l=g.getSelections();if(g._isTouchMode&&l.length>0){var m=l[l.length-1],n=m.row,o=m.row+m.rowCount-1,p=m.col,q=m.col+m.colCount-1;if(!g.parent||g.parent._allowUserResize){if(-1!==n&&-1===p&&g.getRowResizable(o)){var r;o<g.frozenRowCount?r=0:o<h-g._frozenTrailingRowCount?r=1:h>o&&(r=2),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",d=g.getCellRect(o,g.getColumnCount(2)-1,r,-1),f=j.rowHeaderRect(r),f.y<=d.y&&d.y+d.height<=f.y+f.height&&(e=new a.Rect(j.frozenX-k,d.y+d.height-k/2,k,k))}else if(-1===n&&-1!==p&&g.getColumnResizable(q)){var s;q<g.frozenColCount?s=0:q<i-g._frozenTrailingColCount?s=1:i>q&&(s=2),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0AAAAAElFTkSuQmCC",d=g.getCellRect(g.getRowCount(1)-1,q,-1,s),f=j.colHeaderRect(s),f.x<=d.x&&d.x+d.width<=f.x+f.width&&(e=new a.Rect(d.x+d.width-k/2,j.frozenY-k,k,k))}if(c&&e){var t=g._getImageLoader();t.getState(c)?b.drawImage(t.getImage(c),e.x,e.y,e.width,e.height):t.addImage(c)}}}},i.prototype._getFloatingObjectRender=function(c,d){var e=this;if(a.features.floatingObject){e._floatingObjectRenderManager||(e._floatingObjectRenderManager=[]);var f=e._floatingObjectRenderManager[c];f||(e._floatingObjectRenderManager[c]=[]);var g=e._floatingObjectRenderManager[c][d];return g||(e._floatingObjectRenderManager[c][d]=new a._FloatingObjectRenderManager(e._sheet)),g=e._floatingObjectRenderManager[c][d]}return b},i.prototype._paintFloatingObject=function(a,c){var d=this._sheet;if(!d._hoverCell){var e,f=d._getSheetLayout();(c===b||typeof c===g)&&(c=d._zoomFactor);for(var h=0;2>=h;h++)for(var i=0;2>=i;i++)if(e=f.viewportRect(h,i),e&&0!==e.width&&0!==e.height&&(!a||e.intersectRect(a))){var j=this._getFloatingObjectRender(h,i);j&&!d._eventHandler.isFloatingObjectWorking&&j._render(h,i,c)}}},i.prototype.paintSheet=function(b,c){var e=this,f=e._sheet;if(b&&!(f._layoutSuspended>0)){a._CatchMgr.startCatch(f,0,0,f.getRowCount()-1,f.getColumnCount()-1);var g=f._bounds;b.save(),c?b.rect(c.x,c.y,c.width,c.height):b.rect(g.x,g.y,g.width,g.height),b.clip(),b.beginPath(),b.fillStyle=e._getSpreadBackColor(),b.fillRect(g.x,g.y,g.width,g.height);var h=f._getSheetLayout();a.features.group&&e.paintGroup(b,c),a.features.floatingObject&&e._paintFloatingObject(c);var i,j;for(j=0;2>=j;j++){var k=h.colHeaderRect(j);if(k)if(c){var l=k.getIntersectRect(c);l&&e.paintColHeader(b,j,l)}else e.paintColHeader(b,j,k)}for(i=0;2>=i;i++){var m=h.rowHeaderRect(i);if(m)if(c){var l=m.getIntersectRect(c);l&&e.paintRowHeader(b,i,l)}else e.paintRowHeader(b,i,m);for(j=0;2>=j;j++){var n=h.viewportRect(i,j);if(n)if(c){var l=n.getIntersectRect(c);l&&e.paintViewport(b,i,j,l)}else e.paintViewport(b,i,j,n)}}a.features.comment&&e._paintComment(c);var o=h.headerCornerRect();if(o)if(c){var l=o.getIntersectRect(c);l&&e.paintColHeaderCorner(b,l)}else e.paintColHeaderCorner(b,o);var p=f._getRowLayout(1);if(p.length>0){var q=p[p.length-1];q.y+q.height<h.frozenTrailingY&&(b.fillStyle=e._getGrayAreaBackColor(!1),b.fillRect(h.headerX,q.y+q.height,h.width,h.frozenTrailingY-(q.y+q.height)))}else 0===p.length&&(b.fillStyle=e._getGrayAreaBackColor(!1),b.fillRect(h.headerX,h.viewportY,h.width,h.frozenTrailingY-h.viewportY));var r=f._getColumnLayout(1);if(r.length>0){var s=r[r.length-1];s.x+s.width<h.frozenTrailingX&&(b.fillStyle=e._getGrayAreaBackColor(!1),b.fillRect(s.x+s.width,h.headerY,h.frozenTrailingX-(s.x+s.width),h.height))}else 0===r.length&&(b.fillStyle=e._getGrayAreaBackColor(!1),b.fillRect(h.viewportX,h.headerY,h.frozenTrailingX-h.viewportX,h.height));e.paintFrozenLine(b),f.borderWidth>0&&(b.strokeStyle=f.borderColor,b.lineWidth=f.borderWidth,b.strokeRect(g.x+b.lineWidth/2,g.y+b.lineWidth/2,d(0,g.width-b.lineWidth),d(0,g.height-b.lineWidth))),a._CatchMgr.clearCatch(),b.beginPath(),b.restore()}},i.prototype._getThemeContentBackgroundColor=function(b){var c=this._sheet;if(c.parent&&c.parent.useWijmoTheme){var d=a.Global.prototype._dummyContent,e=d.currentStyle;h.defaultView&&h.defaultView.getComputedStyle&&(e=h.defaultView.getComputedStyle(d,"")),e&&e.backgroundColor&&""!==e.backgroundColor&&(b=e.backgroundColor)}return b},i.prototype.refreshDragDropIndicator=function(){var b=this,c=b._sheet,d=c._currentTarget;if(d&&d.dragInfo){var e=b._getCtx(),f=c._getSheetLayout(),g=c._actualDragRange,h=c._dragRect,i=c._getRangeRect2(g),j=c._frozenTrailingColCount,k=c._frozenTrailingRowCount,l=c.getColumnCount()-j,m=c.getRowCount()-k,n=f.viewportRect(1,1);j>0&&g.col+g.colCount<=l&&i.x+i.width>n.x+n.width&&i.intersectRect(n)&&(i=i.getIntersectRect(n)),k>0&&g.row+g.rowCount<=m&&i.y+i.height>n.y+n.height&&i.intersectRect(n)&&(i=i.getIntersectRect(n));var o=new a.Rect(f.frozenX,f.frozenY,f.frozenTrailingX+f.frozenTrailingWidth,f.frozenTrailingY+f.frozenTrailingHeight);i.width>0&&i.height>0?(h.x=i.x,h.y=i.y,h.width=i.width-1,h.height=i.height-1,b.paintDragDropIndicator(e,o)):(0===i.width||0===i.height)&&(h.x=i.x,h.y=i.y,h.width=i.width,h.height=i.height,b.paintDragDropIndicator(e,o));var p=c._eventHandler._isDragInsert;c._dragOldRect=p===!0?c._insertDragRect:new a.Rect(h.x,h.y,h.width,h.height)}},i.prototype.paintDragDropIndicator=function(b,c){var d,e,f=this,g=f._sheet,h=g._dragRect,i=g._eventHandler._isDragInsert,j=h.hitTarget;if(g&&h&&j){if(b.save(),i!==!0||-1!==h.row&&-1!==h.col)d=g._dragOldRect,d&&(e=new a.Rect(d.x-2,d.y-2,d.width+4,d.height+4),f.copyDoubleBufferRect(e,c),f.repaintSelection(g._getActiveSelectedRange(),c)),b.rect(c.x,c.y,c.width,c.height),b.clip(),b.beginPath(),f.paintDragRectangle(b,h);else if(-1===h.row&&-1!==h.col){var k=g._getColumnLayout(0).findCol(h.hitCol);if(k||(k=g._getColumnLayout(1).findCol(h.hitCol)),k||(k=g._getColumnLayout(2).findCol(h.hitCol)),k){var l=k.x,m=k.width;h.col=h.hitCol,j.x>l+m/2&&(h.col<g._getLastFullyVisibleColumn()||h.col===g._getLastVisualColumn())&&(l=k.x+k.width,h.col++),d=g._dragOldRect,d&&0===d.width||(d=g._dragRect),d&&(e=new a.Rect(d.x-2,d.y-2,d.width+4,d.height+4),f.copyDoubleBufferRect(e,c),f.repaintSelection(g._getActiveSelectedRange(),c)),g._insertDragRect=new a.Rect(l,h.y,0,h.height),b.rect(c.x,c.y,c.width,c.height),b.clip(),b.beginPath(),f.paintDragLine(b,l,h.y,l,h.y+h.height)}}else if(-1!==h.row&&-1===h.col){var n=g._getRowLayout(0).findRow(h.hitRow);if(n||(n=g._getRowLayout(1).findRow(h.hitRow)),n||(n=g._getRowLayout(2).findRow(h.hitRow)),n){var o=n.y,p=n.height;h.row=h.hitRow,j.y>o+p/2&&(h.row<g._getLastFullyVisibleRow()||h.row===g._getLastVisualRow())&&(o=n.y+n.height,h.row++),d=g._dragOldRect,d&&0===d.height||(d=g._dragRect),d&&(e=new a.Rect(d.x-2,d.y-2,d.width+4,d.height+4),f.copyDoubleBufferRect(e,c),f.repaintSelection(g._getActiveSelectedRange(),c)),g._insertDragRect=new a.Rect(h.x,o,h.width,0),b.rect(c.x,c.y,c.width,c.height),b.clip(),b.beginPath(),f.paintDragLine(b,h.x,o,h.x+h.width,o)}}b.beginPath(),b.restore()}},i.prototype.paintDragRectangle=function(a,b){var c=this;c.paintDragLine(a,b.x,b.y,b.x+b.width,b.y),c.paintDragLine(a,b.x,b.y+b.height,b.x+b.width,b.y+b.height),c.paintDragLine(a,b.x,b.y,b.x,b.y+b.height),c.paintDragLine(a,b.x+b.width,b.y,b.x+b.width,b.y+b.height)},i.prototype.paintDragLine=function(b,c,d,f,g){b.save();var h,i,j;c===f?(b.rect(c-2,d,7,e(g-d)),b.clip(),b.beginPath(),g>d?(d-=3,g+=3):(d+=3,g-=3),h=a.Line.Create(c-1,d-1,f-1,g+1,"black",7),i=a.Line.Create(c,d,f,g,"black",7),j=a.Line.Create(c+1,d-1,f+1,g+1,"black",7)):d===g&&(b.rect(c,d-2,e(f-c),7),b.clip(),b.beginPath(),f>c?(c-=3,f+=3):(c+=3,f-=3),h=a.Line.Create(c-1,d-1,f+1,g-1,"black",7),i=a.Line.Create(c,d,f,g,"black",7),j=a.Line.Create(c-1,d+1,f+1,g+1,"black",7)),h.paintLine(b),i.paintLine(b),j.paintLine(b),b.stroke(),b.beginPath(),b.restore()},i.prototype.paintResizeLine=function(a){var b,c,e,f,g,h,i=this._sheet;if(i._eventHandler.isResizing){var j=i._currentTarget;if(j){var k=j.resizeInfo;if(k){var l=i._getSheetLayout(),m="#000000";if(a.save(),a.strokeStyle!==m&&(a.strokeStyle=m),1!==a.lineWidth&&(a.lineWidth=1),a.beginPath(),"sizeRow"===k.action)for(c=d(0,k.startY-.5),f=k.movingY-.5,g=l.x+l.width,b=l.x;g>b;b+=2)a.moveTo(b,c),a.lineTo(b+1,c),a.moveTo(b,f),a.lineTo(b+1,f);else for(b=d(0,k.startX-.5),e=k.movingX-.5,h=l.y+l.height,c=l.y;h>c;c+=2)a.moveTo(b,c),a.lineTo(b,c+1),a.moveTo(e,c),a.lineTo(e,c+1);a.stroke(),a.beginPath(),a.restore()}}}},i.prototype.paintColHeaderCorner=function(c,d){var e=this._sheet;c.beginPath();var f=e._getSheetLayout().headerCornerRect(),g=e.getActualStyle(-1,-1,0);this.paintCells(c,[{data:b,row:-1,col:-1,x:f.x,y:f.y,width:f.width,height:f.height,style:g}],0);var h=new a._GcBorders(e,0,0,0);h.addCellLines(0,0,f.x,f.y,f.width,f.height),h.paint(c,d)},i.prototype.paintFrozenLine=function(b){var c=this._sheet;if(c.frozenRowCount||c.frozenColCount||c._frozenTrailingRowCount||c._frozenTrailingColCount){var d=c._getSheetLayout();b.save(),b.strokeStyle=a._ThemeContext.getColor(c,c._frozenlineColor),b.lineWidth=1,b.beginPath(),c.frozenColCount&&(b.moveTo(d.viewportX-.5,d.y),b.lineTo(d.viewportX-.5,d.y+d.height)),c.frozenRowCount&&(b.moveTo(d.x,d.viewportY-.5),b.lineTo(d.x+d.width,d.viewportY-.5)),c._frozenTrailingColCount&&(b.moveTo(d.frozenTrailingX-.5,d.y),b.lineTo(d.frozenTrailingX-.5,d.y+d.height)),c._frozenTrailingRowCount&&(b.moveTo(d.x,d.frozenTrailingY-.5),b.lineTo(d.x+d.width,d.frozenTrailingY-.5)),b.stroke(),b.restore()}},i.prototype.paintColHeader=function(a,b,c){this.paintViewportImp(a,-1,b,1,c)},i.prototype.paintRowHeader=function(a,b,c){this.paintViewportImp(a,b,-1,2,c)},i.prototype.paintViewport=function(a,b,c,d){this.paintViewportImp(a,b,c,3,d);var e=this._sheet._cutCopyIndicatorManager;e&&e.paintCutCopyIndicator(a,d,b,c)},i.prototype.getTouchDragFillIndicatorRect=function(){var c=this._sheet,d=b,e=c.getSelections(),f=e.length;if(c._isTouchMode&&f>0){var g=e[f-1],h=c._getRangeRect2(g),i=17,j=20;d=new a.Rect(h.x+h.width-i,h.y+h.height,i,j)}return d},i.prototype.getCurrentViewportRange=function(b,c){var d=this._sheet,e=d.getRowCount(),f=d.getColumnCount(),g=1;b>=0&&b<d.frozenRowCount?g=0:e>b&&b>=e-d._frozenTrailingRowCount&&(g=2);var h=1;c>=0&&c<d.frozenColCount?h=0:f>c&&c>=f-d._frozenTrailingColCount&&(h=2);var i=d._getViewportRowLayout(g),j=d._getViewportColumnLayout(h),k=0,l=0,m=0,n=0;return i.length>0&&(k=i[0].row,l=i[i.length-1].row),j.length>0&&(m=j[0].col,n=j[j.length-1].col),new a.Range(k,m,l-k+1,n-m+1)},i.prototype.isContainedByCurrentViewport=function(a,b){var c=this._sheet,d=c.getRowCount(),e=c.getColumnCount(),f=1;a>=0&&a<c.frozenRowCount?f=0:d>a&&a>=d-c._frozenTrailingRowCount&&(f=2);var g=1;b>=0&&b<c.frozenColCount?g=0:e>b&&b>=e-c._frozenTrailingColCount&&(g=2);var h=c._getSheetLayout(),i=h.viewportRect(f,g),j=!1,k=c._getViewportColumnLayout(g),l=-1===b?k[0]:k.findCol(b);l&&(j=i.x<=l.x&&l.x+l.width<=i.x+i.width);var m=!1,n=c._getViewportRowLayout(f),o=-1===a?n[0]:n.findRow(a);return o&&(m=i.y<=o.y&&o.y+o.height<=i.y+i.height),j&&m},i.prototype.getSelectionIndicatorRects=function(){var b=this,c=b._sheet,d=c.getSelections(),e=[];if(c._isTouchMode&&d.length>0){var f,g,h=d[d.length-1],i=c._getRangeRect2(h),j=8,k=c._getSheetLayout(),l=h.row,m=h.row+h.rowCount-1,n=h.col,o=h.col+h.colCount-1,p=b.getCurrentViewportRange(l,n),q=b.getCurrentViewportRange(m,o),r=p.row,s=q.row+q.rowCount-1,t=p.col,u=q.col+q.colCount-1,v=m===s&&b.isContainedByCurrentViewport(s,-1),w=o===u&&b.isContainedByCurrentViewport(-1,u);if(-1!==h.row&&-1!==h.col)n>=t&&u>=n&&l>=r&&s>=l&&(e[0]=new a.Rect(i.x-j,i.y-j,2*j,2*j)),(o>=t&&u>o||w)&&(m>=r&&s>m||v)&&(e[1]=new a.Rect(i.x+i.width-j,i.y+i.height-j,2*j,2*j));else if(-1!==h.row){f=k.viewportRect(1,0),g=k.viewportRect(1,1);var x=f.x+(f.width+g.width)/2-j,y=c.getColumnCount()-1-c.getFrozenTrailingColumnCount(),z=c._getViewportColumnLayout(1),A=z.findCol(y);if(A){var B=c._getViewportColumnLayout(0),C=B[0]||z[0];C&&(x=C.x+(A.x+A.width-C.x)/2-j)}l>=r&&s>=l&&(e[0]=new a.Rect(x,i.y-j,2*j,2*j)),(m>=r&&s>m||v)&&(e[1]=new a.Rect(x,i.y+i.height-j,2*j,2*j))}else if(-1!==h.col){f=k.viewportRect(0,1),g=k.viewportRect(1,1);var D=f.y+(f.height+g.height)/2-j,E=c.getRowCount()-1-c.getFrozenTrailingRowCount(),F=c._getViewportRowLayout(1),G=F.findRow(E);if(G){var H=c._getViewportRowLayout(0),I=H[0]||F[0];I&&(D=I.y+(G.y+G.height-I.y)/2-j)}n>=t&&u>=n&&(e[0]=new a.Rect(i.x-j,D,2*j,2*j)),(o>=t&&u>o||w)&&(e[1]=new a.Rect(i.x+i.width-j,D,2*j,2*j))}for(var J,K=e.length-1;K>=0;K--)J=e[K],(!J||J.x<0||J.y<0)&&e.splice(K,1)}return e},i.prototype.paintTouchSelectionIndicator=function(a){if(!this._sheet.isEditing()&&this._showTouchSelectionIndicator){var b,c=this.getSelectionIndicatorRects(),d=c.length;if(d>0){a.save(),a.fillStyle="white",a.strokeStyle="black";for(var e=0;d>e;e++)b=c[e],a.beginPath(),a.arc(b.x+b.width/2,b.y+b.height/2,b.width/2,0,2*f,!1),a.fill(),a.stroke();a.restore()}}},i.prototype.refreshTouchSelectionIndicator=function(){var a=this._sheet,b=a.getSelections();!a._paintSuspended&&b.length>0&&this.repaintSelection(b[b.length-1])},i.prototype.paintTouchDragFillIndicator=function(a){var b=this._sheet,c=17,d=20,e=this.getTouchDragFillIndicatorRect();if(e){var f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1AAAAAElFTkSuQmCC",g=b._getImageLoader();g.getState(f)?a.drawImage(g.getImage(f),e.x,e.y,c,d):g.addImage(f)}},i.prototype.paintSelection=function(b,c,e,f){var g=this,h=g._sheet,i=h._eventHandler,j=h._getSheetLayout(),k=j.viewportRect(c,e),l=h._selectionModel,m=l.length;if(f=g._getClipRect(c,e,f)){var n,o=g._getPaintingRects(c,e,l,f),p=o.length;if(!(0>=p)){for(var q=!1,r=!1,s=0;p>s;s++)if(n=o[s],!f.containsRect(n)){q=!0;break}if(b.save(),q&&(b.rect(f.x,f.y,f.width,f.height),b.clip(),r=!0),b.beginPath(),p>0){var t=a._ThemeContext.getColor(h,h.selectionBackColor());b.fillStyle!==t&&(b.fillStyle=t);for(var s=0;s<o.length;s++)n=o[s],b.fillRect(n.x,n.y,n.width,n.height)}var u=h.getCellRect(h._activeRowIndex,h._activeColIndex,c,e);if(k.intersectRect(u)&&(u.x=d(u.x,k.x),u.y=d(u.y,k.y)),u&&u.intersectRect(f)&&(g.copyDoubleBuffer(u.x+1,u.y+1,u.width-2,u.height-2),m>1&&(b.strokeStyle="black",b.lineWidth=1,b.strokeRect(u.x+1.5,u.y+1.5,u.width-4,u.height-4))),1===m){if(i.isDraggingFill&&i.isDragClear()&&!i._isDragAroundIndicator){var v=i.getCurrentFillRange(),w=h._getRangeRect(c,e,v);w&&w.width>0&&w.height>0&&(b.fillStyle="rgba(110,110,110, 0.5)",b.fillRect(w.x,w.y,w.width,w.height))}n&&n.width>=0&&n.height>=0&&g.paintSelectionBorder(b,c,e,n,f)}b.beginPath(),b.restore()}}},i.prototype.paintSelectionBorder=function(b,c,d,e,f){var g=this._sheet,h=g._eventHandler;if(e.width>=0&&e.height>=0&&(!f||e.intersect(f.x-1,f.y-1,f.width+2,f.height+2))){if(b.save(),f&&!f.containsRect(e)&&(b.rect(f.x,f.y,f.width,f.height),b.clip()),b.beginPath(),b.strokeStyle=a._ThemeContext.getColor(g,g.selectionBorderColor()),b.lineWidth=2,e.width>0&&e.height>0){if(h.isDraggingFill)switch(h._currentFillDirection){case 2:b.moveTo(e.x+.5,e.y-.5),b.lineTo(e.x+e.width-1,e.y-.5);break;case 3:b.moveTo(e.x+.5,e.y+e.height-.5),b.lineTo(e.x+e.width-1,e.y+e.height-.5);break;case 0:b.moveTo(e.x-.5,e.y+.5),b.lineTo(e.x-.5,e.y+e.height-1);break;case 1:b.moveTo(e.x+e.width-.5,e.y+.5),b.lineTo(e.x+e.width-.5,e.y+e.height-1);break;case 5:case 4:}else b.rect(e.x-.5,e.y-.5,e.width,e.height);b.stroke(),g.canUserDragFill()&&this.paintDragFillIndicator(b,c,d,e,f)}else(0===e.width||0===e.height)&&b.strokeRect(e.x-1,e.y-1,e.width+1,e.height+1);b.beginPath(),b.restore()}},i.prototype._getClipRect=function(a,d,e){var f=this._sheet,g=f._getSheetLayout(),h=g.viewportRect(a,d);if(1===d){var i=f._getColumnLayout(d),j=i.length>0?i[i.length-1]:b;j&&(h.width=c(h.width,j.x+j.width-g.viewportX))}if(1===a){var k=f._getRowLayout(a),l=k.length>0?k[k.length-1]:b;l&&(h.height=c(h.height,l.y+l.height-g.viewportY))}return e=e?e.getIntersect(h.x,h.y,h.width,h.height):h},i.prototype._getPaintingRects=function(a,b,c,d){for(var e,f,g,h=this._sheet,i=h._spanModel,j=c.length,k=[],l=0;j>l;l++)f=c[l],f&&(e=i.find(f.row,f.col),e&&e.containsRange(f)&&(f=e),g=h._getRangeRect(a,b,f),g&&g.x<=d.x+d.width&&g.y<=d.y+d.height&&d.x<=g.x+g.width&&d.y<=g.y+g.height&&k.push(g));return k},i.prototype.paintFormulaTextBox=function(){var a=this,b=a._sheet;if(!(b._paintSuspended||b._layoutSuspended>0)){var c=b._getSheetLayout(),d=a._getCtx();a.copyDoubleBuffer(c.x,c.y,c.width,c.height),a.paintAdornment(d)}},i.prototype.paintFormulaTextBoxRange=function(b,c,d){var e=this,f=e._sheet,g=f._eventHandler,h=f._formulaTextBox,i=h&&h.getRanges(),j=i&&i.length;if(!(0>=j)){var k=e._getClipRect(c,d);if(k){b.save(),b.rect(k.x,k.y,k.width,k.height),b.clip(),b.beginPath();for(var l,m,n,o,p,q=g.isFormulaRangeHoving,r=g._formulRangeHovingInfo,s=g.isFormulaRangeMoving,t=g._formulaRangeMovingInfo,u=g.isFormulaRangeResizing,v=g._formulaRangeResizingInfo,w=0;j>w;w++)if(l=i[w],m=l.text,n=g.stringToRange(m),n&&(o=e._getPaintingRects(c,d,[n],k)[0],o&&o.width>0&&o.height>0)){if(p=h.getRangeColor(w),h.isAppendingRange(l)?(q&&r.paramRange.index===w&&(b.beginPath(),b.lineWidth=2,b.strokeStyle=p,b.rect(o.x+1,o.y+1,o.width-3,o.height-3),b.stroke()),e.paintDashRect(b,o,p)):q&&r.paramRange.index===w||s&&t.paramRange.index===w||u&&v.paramRange.index===w?(b.beginPath(),b.lineWidth=2,b.strokeStyle=p,b.rect(o.x+1,o.y+1,o.width-3,o.height-3),b.stroke()):(b.beginPath(),b.lineWidth=2,b.strokeStyle=p,b.rect(o.x,o.y,o.width-1,o.height-1),b.stroke()),h.isActiveRange(l)){var x=.1,y=0,z=0,A=0,B=a.util.parseColorString(p);3===B.length?(y=B[0],z=B[1],A=B[2]):4===B.length&&(y=B[1],z=B[2],A=B[3]),b.beginPath(),b.fillStyle="rgba("+y+","+z+","+A+","+x+")",b.fillRect(o.x+1,o.y+1,o.width-3,o.height-3)}var C=5,D=o.x-2,E=o.x+o.width+1-C,F=o.y-2,G=o.y+o.height+1-C;b.beginPath(),b.fillStyle=p,b.fillRect(D,F,C,C),b.fillRect(E,F,C,C),b.fillRect(D,G,C,C),b.fillRect(E,G,C,C)}b.beginPath(),b.restore()}}},i.prototype.paintDashRect=function(a,b,c){a.save();var d=[6,6];if(a.setLineDash&&!$.browser.qtMode)a.beginPath(),a.lineWidth=2,a.strokeStyle=c,a.setLineDash(d),a.rect(b.x,b.y,b.width-1,b.height-1),a.stroke();else{a.beginPath(),a.lineWidth=2,a.strokeStyle=c;var f,g,h,i,j=d[0],k=d[1];for(f=b.x,g=b.y,h=b.width;h>0;)if(h>=j+k)a.moveTo(f,g),a.lineTo(f+j,g),f=f+j+k,h=h-j-k;else{if(h>=j){a.moveTo(f,g),a.lineTo(f+j,g),h=h-j-k;break}if(h>0){a.moveTo(f,g),a.lineTo(f+h,g),h=h-j-k;break}}for(f=b.x+b.width-1,g=b.y+1,i=b.height-1,0>h&&(h=e(h),h>k&&(a.moveTo(f,g-2),a.lineTo(f,g+(h-k))),g+=h,i-=h);i>0;)i>=j+k?(a.moveTo(f,g),a.lineTo(f,g+j),g=g+j+k,i=i-j-k):i>=j?(a.moveTo(f,g),a.lineTo(f,g+j),i=i-j-k):i>0&&(a.moveTo(f,g),a.lineTo(f,g+i),i=i-j-k);for(f=b.x+b.width-2,g=b.y+b.height-1,h=b.width-1,0>i&&(i=e(i),i>k&&(a.moveTo(f+2,g),a.lineTo(f-(i-k),g)),f-=i,h-=i);h>0;)if(h>=j+k)a.moveTo(f,g),a.lineTo(f-j,g),f=f-j-k,h=h-j-k;else{if(h>=j){a.moveTo(f,g),a.lineTo(f-j,g),h=h-j-k;break}if(h>0){a.moveTo(f,g),a.lineTo(f-h,g),h=h-j-k;break}}for(f=b.x,g=b.y+b.height-2,i=b.height-1,0>h&&(h=e(h),h>k&&(a.moveTo(f,g+2),a.lineTo(f,g-(h-k))),g-=h,i-=h);i>0;)i>=j+k?(a.moveTo(f,g),a.lineTo(f,g-j),g=g-j-k,i=i-j-k):i>=j?(a.moveTo(f,g),g-j===b.y?a.lineTo(f,g-j-1):a.lineTo(f,g-j),i=i-j-k):i>0&&(g>b.y&&(a.moveTo(f,g),a.lineTo(f,g-i)),i=i-j-k);a.stroke()}a.beginPath(),a.restore()},i.prototype.getDragFillIndicatorRect=function(b){var c=this._sheet,d=c._getActiveSelectedRange(),e=c._getSheetLayout(),f=new a.Rect(-4,-4,4,4);return-1===d.col?(f.x=e.frozenX,f.y=b.y+b.height-.5-2):-1===d.row?(f.x=b.x+b.width-.5-2,f.y=e.frozenY):(f.x=b.x+b.width-.5-2,f.y=b.y+b.height-.5-2),f},i.prototype.paintDragFillIndicator=function(b,c,e,f,g){var h=this._sheet,i=h._getSheetLayout(),j=this.getDragFillIndicatorRect(f),k=i.viewportRect(c,e);if((!g||j.intersectRect(g))&&j.intersectRect(k)){var l=new a.Rect(j.x-1.5,j.y-1.5,j.width+2,j.height+2);l.x=d(l.x,k.x),l.y=d(l.y,k.y),this.copyDoubleBufferRect(l),b.save(),g&&!g.containsRect(j)&&(b.rect(g.x,g.y,g.width,g.height),b.clip()),b.beginPath(),b.fillStyle=a._ThemeContext.getColor(h,h.selectionBorderColor()),b.fillRect(j.x,j.y,j.width,j.height),h._dragFillIndicatorRect=new a.Rect(j.x,j.y,4,4),b.beginPath(),b.restore()}},i.prototype._paintCommentFloatLayoutPanel=function(a){var b=this;if(3===a){var c=b._sheet._commentRender;c&&c.renderCommentFloatPanel(b._sheet)}},i.prototype._paintCommentCellAdorner=function(a,b,c){var d=this,e=d._sheet._commentRender;e&&e.renderCommentCellAdorner(a,b,c)},i.prototype._paintComment=function(a){var b=this,c=b._sheet,d=c._commentRender;if(!c._hoverCell)for(var e,f=b._sheet._getSheetLayout(),g=0;2>=g;g++)for(var h=0;2>=h;h++)if(e=f.viewportRect(g,h),e&&0!==e.width&&0!==e.height&&(!a||e.intersectRect(a))){var i=c._commentManager;d&&i&&d.renderComment(i)}},i.prototype.paintViewportImp=function(c,d,e,f,h){var i=this;(typeof f===g||f===b)&&(f=3);var k=i._sheet,l=k._getRowLayout(d,f),m=k._getColumnLayout(e,f),n=l.length,o=m.length;if(!(0>n||0>o)){var p,q,r,s,t=k._getCellLayout(d,e,f),u=t.length>0,v=b,w=b,x=b,y=0,z=0,A=0,B=0,C=new a._GcBorders(k,d,e,f),D=[],E=[],F=3===f&&k._allowCellOverflow,G=k._cachePool,H=b,I=k._getFilterButtonModel(),J=[],K=3===f&&k.parent&&k.parent.highlightInvalidData();a.features.comment&&i._paintCommentFloatLayoutPanel(f),c.save(),h&&(c.rect(h.x,h.y,h.width,h.height),c.clip()),c.beginPath();for(var L=0;n>L;L++){v=l[L];for(var M=0;o>M;M++)if(w=m[M],x=u&&t.findCell(v.row,w.col),x?(p=x.row,q=x.col,y=x.x,z=x.y,A=x.width,B=x.height):(p=v.row,q=w.col,y=w.x,z=v.y,A=w.width,B=v.height),!(h&&(y+A<=h.x||y>=h.x+h.width||z+B<=h.y||z>=h.y+h.height)||0===A||0===B||x&&D.contains(x))){if(r=k.getValue(p,q,f),s=k.getActualStyle(p,q,f),F&&G.addCell(p,q,{data:r,style:s}),I&&A>0&&B>0){var N=I.find(p,q,f);N&&(H||(H=new a._FilterButtonInfoModel),H.push(new a._FilterButtonInfo(N.rowFilter,N.row,N.col,N.sheetArea,y,z,A,B)))}K&&!k.isValid(p,q,r)&&J.push({x:y,y:z,width:A,height:B}),C.addCellLines(p,q,y,z,A,B,s,x),E.push({data:r,row:p,col:q,x:y,y:z,width:A,height:B,style:s}),x&&D.push(x)}}if(E.length>0){if(F){var O=new j(k,d,e);i.buildCellOverflowValueLayout(O,E,C)}i.paintCells(c,E,f)}H&&H.length>0&&i._paintFilterButtons(c,H),C.paint(c,h),J.length>0&&i._paintValidationUI(c,J),c.restore()}},i.prototype._getFilterButtonRect=function(a){var b=this._sheet,d=b._zoomFactor,e=d>1?1:d,f=parseInt((c(20,b.defaults.rowHeight)*e).toString(),10);b.parent&&b.parent.useTouchLayout()&&(f=parseInt((b.defaults.rowHeight*d).toString(),10));var g=f,h=a.x+a.width-f,i=a.y+a.height-g;return{x:h,y:i,width:f,height:g}},i.prototype._paintFilterButtons=function(b,c){var d=this._sheet;b.save(),b.beginPath(),b.lineWidth=1,b.fillStyle="#FFFFFF",b.strokeStyle="#CCCCCC";
for(var e=(this._getCtx(),0);e<c.length;e++){var f=c[e],g=this._getFilterButtonRect(new a.Rect(f.x,f.y,f.width,f.height)),h=g.width,i=g.height,j=g.x,k=g.y;b.save(),b.rect(f.x,f.y,f.width,f.height),b.clip(),b.beginPath(),b.fillRect(j+1,k+1,h-3,i-3),b.strokeRect(j+1-.5,k+2-.5,h-3,i-4);var l=f.getState(),m=a._GcFilterDialog.getImageSrc(l),n=d._getImageLoader();try{n.getState(m)?b.drawImage(n.getImage(m),j,k+1,h-3,i-3):n.addImage(m)}catch(o){}b.beginPath(),b.restore()}b.restore()},i.prototype._paintValidationUI=function(a,b){if(b)for(var c=b.length,d=0;c>d;d++){var e=b[d],f=e.x-4,g=e.y-4,h=e.width+8,i=e.height+8,j=.5522848,k=h/2*j,l=i/2*j,m=f+h,n=g+i,o=f+h/2,p=g+i/2;a.save(),a.lineWidth=2,a.strokeStyle="red",a.beginPath(),a.moveTo(f,p),a.bezierCurveTo(f,p-l,o-k,g,o,g),a.bezierCurveTo(o+k,g,m,p-l,m,p),a.bezierCurveTo(m,p+l,o+k,n,o,n),a.bezierCurveTo(o-k,n,f,p+l,f,p),a.closePath(),a.stroke(),a.restore()}},i.prototype.paintCells=function(c,e,f){var g=this,h=g._sheet,i=3===f,j=a.StyleHelper._scaleFont,k=h._zoomFactor,l=j(g._getDefaultFont(f),k),m=h.getDefaultStyle(f),n=h.getDefaultCellType(f),o=h.parent&&h.parent.useWijmoTheme,p=h._conditionalFormats,q=h._getImageLoader();c.save(),c.beginPath(),c.fillStyle=m&&m.foreColor||"#000000",c.font=l.font,c.textAlign=i?"right":"center";for(var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=e.length,I=a.features.sparkline,J=h._getModel(f),K=[],L={sheet:h,row:-1,col:-1,fontInfo:b,lineHeight:-1,imageLoader:q,conditionalFormats:p,useWijmoTheme:o,sheetArea:f},M=0;H>M;M++){r=e[M],t=r.data,u=r.row,v=r.col,w=r.x,x=r.y,y=r.width,z=r.height,A=r.style,B=r.cellOverflowLayout,D=A.font?j(A.font,k):l;var N=!A.wordWrap&&A.shrinkToFit;if(N){var O=h.getText(u,v,f);if(O)for(var P={value:!1},Q=0;3>Q&&P.value===!1;Q++){var R=h._getStringWidthByCanvas(O,D.font),S=d(0,y-4);if(1!==A.hAlign&&A.textIndent&&(S=d(0,S-8*A.textIndent)),!(R>S))break;D=j(D.font,S/R,P,!0)}}A.font=D.font,y>0&&z>0&&(s=A.cellType||n,w--,x--,y++,z++,i?(F=I&&J.getSparkline(u,v),L.sparkline=F):(C=g.getVisualState(u,v,f),L.visualState=C),E=h._getFontHeight(D.font,N),L.lineHeight=E,L.row=u,L.col=v,L.fontInfo=D,L.cellOverflowLayout=B,s.paint(c,t,w,x,y,z,A,L),B&&!L.showBarIconOnly&&K.push({cellType:s,data:t,x:w,y:x,width:y,height:z,style:A,options:{sheet:h,row:u,col:v,fontInfo:D,lineHeight:E,cellOverflowLayout:B}})),a.features.comment&&g._paintCommentCellAdorner(c,f,r)}if(H=K.length,H>0)for(var T=h.isEditing(),U=h._activeRowIndex,V=h._activeColIndex,W=a.features.sparklineEx,M=0;H>M;M++)G=K[M],s=G.cellType,t=G.data,w=G.x,x=G.y,y=G.width,z=G.height,A=G.style,L=G.options,T&&L.row===U&&L.col===V||W&&t instanceof a.SparklineExValue||s.paintValue&&s.paintValue(c,t,w,x,y,z,A,L);c.restore()},i.prototype.getVisualState=function(a,c,d){var e=this._sheet,f=0;return 3===d||typeof d===g||d===b?!e.isEditing()&&e._isActiveCell(a,c)?f=3:e._isSelected(a,c,d)&&(f=2):(e._isSelected(a,c,d)&&(f=1,e._isAllSelected(a,c,d)&&(f=2)),e._isHover(a,c,d)&&(f=4)),f},i.prototype.paintLine=function(a,b,c,d,e,f){a.lineWidth=b.width(),a.strokeStyle=b.color,a.moveTo(c,d),a.lineTo(e,f)},i.prototype.paintGroup=function(b,c){var d=this._sheet,e=d._getGroupLayout();if(0!==e.width||0!==e.height){b.save(),b.beginPath();var f=d._getSheetLayout();if(e.width>0&&(!c||c.intersect(e.x,e.y,e.width,f.height))){var g=e.rowMaxLevel,h=new a._RangeGroupHeaderPresenter(d,!0,g);h.paintGroupHeader(b);for(var i=[new a._RangeGroupPresenter(d,!0,0,g),new a._RangeGroupPresenter(d,!0,1,g),new a._RangeGroupPresenter(d,!0,2,g)],j=0;2>=j;j++){var k=i[j];k.createGroupInfo(),k.paintGroups(b)}}if(e.height>0&&(!c||c.intersect(e.x,e.y,f.width,e.height))){var l=e.colMaxLevel,m=new a._RangeGroupHeaderPresenter(d,!1,l);m.paintGroupHeader(b);for(var n=[new a._RangeGroupPresenter(d,!1,0,l),new a._RangeGroupPresenter(d,!1,1,l),new a._RangeGroupPresenter(d,!1,2,l)],j=0;2>=j;j++){var o=n[j];o.createGroupInfo(),o.paintGroups(b)}}b.beginPath(),b.restore()}},i.prototype.groupHitTest=function(c,d){if(!a.features.group)return b;var e=this._sheet,f=e._getGroupLayout();if(0===f.width&&0===f.height)return b;var g=e._getSheetLayout(),h=new a.Rect(f.x,f.y,f.width,g.height);if(!h.contains(c,d)&&(h=new a.Rect(f.x,f.y,g.width,f.height),!h.contains(c,d)))return b;var i,j,k={what:"empty",info:b};if(f.width>0){var l=f.rowMaxLevel,m=new a._RangeGroupHeaderPresenter(e,!0,l);if(j=m.getGroupButton(c,d),j&&(k={what:"rgh",info:j}),"empty"===k.what){var n=[new a._RangeGroupPresenter(e,!0,0,l),new a._RangeGroupPresenter(e,!0,1,l),new a._RangeGroupPresenter(e,!0,2,l)];for(i=0;2>=i;i++)if(n[i].createGroupInfo(),j=n[i].getRowGroupButton(c,d)){k={what:"rg",info:j};break}}}if(f.height>0){var o=f.colMaxLevel;if("empty"===k.what){var p=new a._RangeGroupHeaderPresenter(e,!1,o);j=p.getGroupButton(c,d),j&&(k={what:"cgh",info:j})}if("empty"===k.what){var q=[new a._RangeGroupPresenter(e,!1,0,o),new a._RangeGroupPresenter(e,!1,1,o),new a._RangeGroupPresenter(e,!1,2,o)];for(i=0;2>=i;i++)if(q[i].createGroupInfo(),j=q[i].getColGroupButton(c,d)){k={what:"cg",info:j};break}}}return k},i.prototype.buildCellOverflowValueLayout=function(a,b,c){for(var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this._sheet,v=b.length,w=0;v>w;w++)d=b[w],g=d.row,h=d.col,i=d.x,j=d.y,l=d.height,q=a.getCellOverflowLayoutModel(g),r=q.headingOverflowlayout,s=q.trailingOverflowLayout,t=q.find(h),t&&t.column===h?(k=d.width,m=t.backgroundWidth,n=t.backgroundLeftWidth<0?i:t.backgroundRightWidth<0?i+k-m:i+k/2-t.backgroundLeftWidth,d.cellOverflowLayout=t,t.layout={x:n,y:j,width:m,height:l},c.addCellOverlfowLayout(g,t)):r&&r.endColumn===h?(h=r.column,f=u.getActualStyle(g,h),e=u.getValue(g,h),k=r.columnWidth,m=r.backgroundWidth,n=i+d.width-m,p={data:e,row:g,col:h,x:n,y:d.y,width:k,height:l,style:f,cellOverflowLayout:r},b.push(p),r.layout={x:n,y:j,width:m,height:l},c.addCellOverlfowLayout(g,r)):s&&s.startColumn===h&&(h=s.column,f=u.getActualStyle(g,h),e=u.getValue(g,h),k=s.columnWidth,m=s.backgroundWidth,n=i,o=i+m-k,p={data:e,row:g,col:h,x:o,y:j,width:k,height:l,style:f,cellOverflowLayout:s},b.push(p),s.layout={x:n,y:j,width:m,height:l},c.addCellOverlfowLayout(g,s))},i}();a._SheetRender=i;var j=function(){function c(b,c,d){this.TEXT_WIDTH_OFFSET=2;var e=this;e._sheet=b,e._rowViewportIndex=c,e._colViewportIndex=d,e._colLayoutModel=b._getColumnLayout(d),e._cellLayoutModel=b._getCellLayout(c,d),e.maxCellOverflowDistance=b.maxCellOverflowDistance,e.scaleFont=a.StyleHelper._scaleFont,e.zoomFactor=b._zoomFactor,e.defaultFont=e.scaleFont(b._render._getDefaultFont(),e.zoomFactor).font,e.defaultCellType=b.getDefaultCellType(),e.cachedCellOverflowModels={}}return c.prototype.getCellOverflowLayoutModel=function(c){var d=this,e=d.cachedCellOverflowModels[c];if(e)return e;var f,h,i,j,k,l,m,n,o,p=d._sheet,q=d._colLayoutModel,r=q.length,s=q[0].col,t=q[r-1].col,u=p._cachePool,v=new a._CellOverflowLayoutModel;v.headingOverflowlayout=d._buildHeadingCellOverflowLayout(c);for(var w=0;r>w;w++)f=q[w],f.width<=0||(h=f.col,i=u.getCachedCell(c,h),l=i.data,l!==b&&typeof l!==g&&(k=i.style,k||(k=i.style=p.getActualStyle(c,h)),k.shrinkToFit||k.wordWrap||(j=u.getCachedColumn(h),m=j.width,n=k.hAlign,3===n&&(n=a.util.getHAlignByValueType(n,l)),0===n?(o=d._buildCellOverflowLayoutModelForLeft({data:l,style:k,width:m},c,h,t),o&&v.push(o)):2===n?(o=d._buildCellOverflowLayoutModelForRight({data:l,style:k,width:m},c,h,s),o&&v.push(o)):1===n&&(o=d._buildCellOverflowLayoutModelForCenter({data:l,style:k,width:m},c,h,s,t),o&&v.push(o)))));return v.trailingOverflowLayout=d._buildTrailingCellOverflowLayout(c),d.cachedCellOverflowModels[c]=v,v},c.prototype._buildCellOverflowLayoutModelForLeft=function(c,d,e,f){var h,i,j,k,l,m=this,n=m._sheet,o=m._cellLayoutModel,p=n._cachePool,q=c.width,r=c.width,s=c.data,t=c.style;if(o.findCell(d,e)!==b)return b;var u=t.cellType||m.defaultCellType;if(!u.allowOverflow)return b;var v=t.formatter||t._autoFormatter,w={sheet:n,row:d,col:e,sheetArea:n._getSheetArea(m._rowViewportIndex,m._colViewportIndex)};if(k=u.format(s,v,w),!k)return b;var x=t.font,y=t.textIndent;if(x=x?m.scaleFont(x,m.zoomFactor).font:m.defaultFont,l=a._WordWrapHelper._measureText(k,x)+(y?8*y:0)+m.TEXT_WIDTH_OFFSET,r>=l)return b;var z=e,A=e;for(h=e+1;f>=h&&o.findCell(d,h)===b&&(i=p.getCachedCell(d,h),s=i.data,s===b||typeof s===g)&&(A=h,j=p.getCachedColumn(h),r+=j.width,!(r>=l));h++);return A==e?b:new a._CellOverflowLayout(e,z,A,l,q,r,-1,r)},c.prototype._buildCellOverflowLayoutModelForRight=function(c,d,e,f){var h,i,j,k,l,m=this,n=m._sheet,o=m._cellLayoutModel,p=n._cachePool,q=c.width,r=c.width,s=c.data,t=c.style;if(o.findCell(d,e)!==b)return b;var u=t.cellType||m.defaultCellType;if(!u.allowOverflow)return b;var v=t.formatter||t._autoFormatter,w={sheet:n,row:d,col:e,sheetArea:n._getSheetArea(m._rowViewportIndex,m._colViewportIndex)};if(k=u.format(s,v,w),!k)return b;var x=t.font,y=t.textIndent;if(x=x?m.scaleFont(x,m.zoomFactor).font:m.defaultFont,l=a._WordWrapHelper._measureText(k,x)+(y?8*y:0)+m.TEXT_WIDTH_OFFSET,r>=l)return b;var z=e,A=e;for(h=e-1;h>=f&&o.findCell(d,h)===b&&(i=p.getCachedCell(d,h),s=i.data,s===b||typeof s===g)&&(z=h,j=p.getCachedColumn(h),r+=j.width,!(r>=l));h--);return z==e?b:new a._CellOverflowLayout(e,z,A,l,q,r,r,-1)},c.prototype._buildCellOverflowLayoutModelForCenter=function(c,d,e,f,h){var i,j,k,l,m,n=this,o=n._sheet,p=n._cellLayoutModel,q=o._cachePool,r=c.width,s=c.width,t=c.data,u=c.style;if(p.findCell(d,e)!==b)return b;var v=u.cellType||n.defaultCellType;if(!v.allowOverflow)return b;var w=u.formatter||u._autoFormatter,x={sheet:o,row:d,col:e,sheetArea:o._getSheetArea(n._rowViewportIndex,n._colViewportIndex)};if(l=v.format(t,w,x),!l)return b;var y=u.font,z=u.textIndent;if(y=y?n.scaleFont(y,n.zoomFactor).font:n.defaultFont,m=a._WordWrapHelper._measureText(l,y)+(z?8*z:0)+n.TEXT_WIDTH_OFFSET,s>=m)return b;var A=e,B=s/2;for(i=e-1;i>=f&&p.findCell(d,i)===b&&(j=q.getCachedCell(d,i),t=j.data,t===b||typeof t===g)&&(A=i,k=q.getCachedColumn(i),B+=k.width,!(B>=m/2));i--);var C=e,D=s/2;for(i=e+1;h>=i&&p.findCell(d,i)===b&&(j=q.getCachedCell(d,i),t=j.data,t===b||typeof t===g)&&(C=i,k=q.getCachedColumn(i),D+=k.width,!(D>=m/2));i++);return A===C?b:new a._CellOverflowLayout(e,A,C,m,r,B+D,B,D)},c.prototype._buildHeadingCellOverflowLayout=function(c){for(var d,e,f,h,i,j,k,l,m=this,n=m._sheet,o=m._colLayoutModel,p=o[0].col,q=o[o.length-1].col,r=n._getSpanModel(),s=n._cachePool,t=m.maxCellOverflowDistance,u=p,v=1;t>v;v++){if(i=u-v,0>i)return b;if(r.find(c,i))return b;if(j=s.getCachedCell(c,i),e=j.data,k=s.getCachedColumn(i),f=k.width,f>0&&e!==b&&typeof e!==g){if(d=j.style,d||(d=j.style=n.getActualStyle(c,i)),h=d.hAlign,3===h&&(h=a.util.getHAlignByValueType(h,e)),0===h){if(l=m._buildCellOverflowLayoutModelForLeft({data:e,style:d,width:f},c,i,q),l&&l.endColumn>=p)return l}else if(l=m._buildCellOverflowLayoutModelForCenter({data:e,style:d,width:f},c,i,p,q),l&&l.endColumn>=p)return l;return b}}},c.prototype._buildTrailingCellOverflowLayout=function(c){for(var d,e,f,h,i,j,k,l,m=this,n=m._sheet,o=m._colLayoutModel,p=o[0].col,q=o[o.length-1].col,r=n._getSpanModel(),s=n._cachePool,t=m.maxCellOverflowDistance,u=n.getColumnCount(),v=q,w=1;t>w;w++){if(i=v+w,i>=u)return b;if(r.find(c,i))return b;if(j=s.getCachedCell(c,i),e=j.data,k=s.getCachedColumn(i),f=k.width,f>0&&e!==b&&typeof e!==g){if(d=j.style,d||(d=j.style=n.getActualStyle(c,i)),h=d.hAlign,3===h&&(h=a.util.getHAlignByValueType(h,e)),2===h){if(l=m._buildCellOverflowLayoutModelForRight({data:e,style:d,width:f},c,i,p),l&&l.startColumn<=q)return l}else if(l=m._buildCellOverflowLayoutModelForCenter({data:e,style:d,width:f},c,i,p,q),l&&l.startColumn<=q)return l;return b}}},c}();a._CellOverflowLayoutBuilder=j;var k=function(){function c(a){this._needPaintIndicator=!1,this._eventNS=".cutCopyIndicator",this._ch=b,this._sheet=a,this._bindEvents()}return c.prototype.needPaintIndicator=function(a){var b=this;if(0===arguments.length)return b._needPaintIndicator;if("boolean"==typeof a){if(b._needPaintIndicator===a&&a===!1)return b;b._needPaintIndicator=a;var c=b._sheet;c&&c.invalidate()}return b},c.prototype.getClipboardHelper=function(){var a=this,b=a._sheet;return b&&!a._ch&&(a._ch=b._getClipboardHelper()),a._ch},c.prototype._bindEvents=function(){var b=this,c=b._sheet,d=!1;c&&(c._bind(a.Events.ClipboardChanged+b._eventNS,function(){b.needPaintIndicator(!0)}),c._bind(a.Events.ValueChanged+b._eventNS,function(){b.needPaintIndicator(!1)}),c._eventHandler.bind(a.Events.CellChanged+b._eventNS,function(){b.needPaintIndicator(!1)}),c._bind(a.Events.ColumnChanged+b._eventNS,function(a,c){"resizable"!==c.propertyName&&"width"!==c.propertyName&&"isVisible"!==c.propertyName&&b.needPaintIndicator(!1)}),c._bind(a.Events.RowChanged+b._eventNS,function(a,c){"resizable"!==c.propertyName&&"height"!==c.propertyName&&"isVisible"!==c.propertyName&&b.needPaintIndicator(!1)}),c._bind(a.Events.RangeChanged+b._eventNS,function(){b.needPaintIndicator(!1)}),c._bind(a.Events.ClipboardPasting+b._eventNS,function(){d=b.needPaintIndicator()}),c._bind(a.Events.ClipboardPasted+b._eventNS,function(a,c){var e=c.cellRange,f=c.sheet,g=b.getClipboardHelper();e&&g&&g.range&&g.fromSheet&&f&&b.needPaintIndicator(g.range.intersect(e.row,e.col,e.rowCount,e.colCount)||!f._isPastedInternal(g.fromSheet,g.range,f,f._eventHandler._getClipboardData())?!1:d)}))},c.prototype.paintCutCopyIndicator=function(b,c,d,e){var f=this._sheet,g=f._render,h=this.getClipboardHelper(),i=f.parent,j=i&&i.cutCopyIndicatorVisible?i.cutCopyIndicatorVisible():!0;if(j&&this._needPaintIndicator&&h&&h.fromSheet===f&&h.range){var k=f._getSheetLayout(),l=k.viewportRect(d,e),m=g._getPaintingRects(d,e,[h.range],c)[0];if(m&&l){if(b.save(),b.rect(l.x,l.y,l.width,l.height),b.clip(),m){var n=i&&i.cutCopyIndicatorBorderColor?i.cutCopyIndicatorBorderColor():"blue",o=a._ThemeContext.getColor(f,n);g.paintDashRect(b,m,o)}b.beginPath(),b.restore()}}},c.prototype.addRows=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},c.prototype.deleteRows=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},c.prototype.addColumns=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},c.prototype.deleteColumns=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},c.prototype.cancelIndicator=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},c.prototype._dispose=function(){this._sheet._eventHandler.unbind(a.Events.CellChanged+this._eventNS)},c}();a.CutCopyIndicatorManager=k}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("core.sheet_ui",["core.common"]);var b=void 0,c="backColor",d="foreColor",e="hAlign",f="vAlign",g="themeFont",h="font",i="formatter",j="borderLeft",k="borderTop",l="borderRight",m="borderBottom",n="locked",o="textIndent",p="wordWrap",q="shrinkToFit",r="backgroundImage",s="backgroundImageLayout",t="validator",u="cellType",v="tabStop",w="textDecoration",x="imeMode",y=function(){function y(a,c,d,e){var f=this;f.sheet=a,f.row=c,f.row2=c,f.col=d,f.col2=d,(e===b||null===e)&&(e=3),f.sheetArea=e}return y.prototype.value=function(a){var b=this;if(0===arguments.length)return b.sheet.getValue(b.row,b.col,b.sheetArea);for(var c=b.row;c<=b.row2;c++)for(var d=b.col;d<=b.col2;d++)b._isValidIndex(c,d)&&b.sheet.setValue(c,d,a,b.sheetArea);return b},y.prototype.text=function(a){var b=this;if(0===arguments.length)return b.sheet.getText(b.row,b.col,b.sheetArea);for(var c=b.row;c<=b.row2;c++)for(var d=b.col;d<=b.col2;d++)b._isValidIndex(c,d)&&b.sheet.setText(c,d,a,b.sheetArea);return b},y.prototype.formula=function(a){var b=this;if(0===arguments.length)return b.sheet.getFormula(b.row,b.col,b.sheetArea);for(var c=b.row;c<=b.row2;c++)for(var d=b.col;d<=b.col2;d++)b._isValidIndex(c,d)&&b.sheet.setFormula(c,d,a,b.sheetArea);return b},y.prototype.bindingPath=function(a){var b=this;if(0===arguments.length)return b.sheet.getBindingPath(b.row,b.col,b.sheetArea);for(var c=b.row;c<=b.row2;c++)for(var d=b.col;d<=b.col2;d++)b._isValidIndex(c,d)&&b.sheet.setBindingPath(c,d,a,b.sheetArea);return b},y.prototype.comment=function(a){var b=this;if(0===arguments.length)return b.sheet.getComment(b.row,b.col);for(var c=b.row;c<=b.row2;c++)for(var d=b.col;d<=b.col2;d++)b._isValidIndex(c,d)&&b.sheet.setComment(c,d,a);return b},y.prototype.dataValidator=function(a){return 0==arguments.length?this._getStyleProperty(t):this._setStyleProperty(t,a)},y.prototype.cellType=function(a){return 0==arguments.length?this._getStyleProperty(u):this._setStyleProperty(u,a)},y.prototype.backgroundImage=function(a){return 0==arguments.length?this._getStyleProperty(r):this._setStyleProperty(r,a)},y.prototype.backgroundImageLayout=function(a){return 0==arguments.length?this._getStyleProperty(s):this._setStyleProperty(s,a)},y.prototype.backColor=function(a){return 0===arguments.length?this._getStyleProperty(c):this._setStyleProperty(c,a)},y.prototype.foreColor=function(a){return 0===arguments.length?this._getStyleProperty(d):this._setStyleProperty(d,a)},y.prototype.hAlign=function(a){return 0===arguments.length?this._getStyleProperty(e):this._setStyleProperty(e,a)},y.prototype.vAlign=function(a){return 0===arguments.length?this._getStyleProperty(f):this._setStyleProperty(f,a)},y.prototype.themeFont=function(a){return 0===arguments.length?this._getStyleProperty(g):this._setStyleProperty(g,a)},y.prototype.font=function(a){return 0===arguments.length?this._getStyleProperty(h):this._setStyleProperty(h,a)},y.prototype.formatter=function(a){return 0===arguments.length?this._getStyleProperty(i):this._setStyleProperty(i,a)},y.prototype.borderLeft=function(a){return 0===arguments.length?this._getStyleProperty(j):this._setStyleProperty(j,a)},y.prototype.borderTop=function(a){return 0===arguments.length?this._getStyleProperty(k):this._setStyleProperty(k,a)},y.prototype.borderRight=function(a){return 0===arguments.length?this._getStyleProperty(l):this._setStyleProperty(l,a)},y.prototype.borderBottom=function(a){return 0===arguments.length?this._getStyleProperty(m):this._setStyleProperty(m,a)},y.prototype.locked=function(a){return 0===arguments.length?this._getStyleProperty(n):this._setStyleProperty(n,a)},y.prototype.textIndent=function(a){return 0===arguments.length?this._getStyleProperty(o):this._setStyleProperty(o,a)},y.prototype.wordWrap=function(a){return 0===arguments.length?this._getStyleProperty(p):this._setStyleProperty(p,a)},y.prototype.shrinkToFit=function(a){return 0===arguments.length?this._getStyleProperty(q):this._setStyleProperty(q,a)},y.prototype.tabStop=function(a){return 0===arguments.length?this._getStyleProperty(v):this._setStyleProperty(v,a)},y.prototype.textDecoration=function(a){return 0===arguments.length?this._getStyleProperty(w):this._setStyleProperty(w,a)},y.prototype.imeMode=function(a){return 0===arguments.length?this._getStyleProperty(x):this._setStyleProperty(x,a)},y.prototype.clearStyleProperty=function(a){for(var b=this,c=b.row;c<=b.row2;c++)for(var d=b.col;d<=b.col2;d++)if(b._isValidIndex(c,d)){var e=b.sheet.getStyle(c,d,b.sheetArea);e&&e.clear(a)}},y.prototype._getStyleProperty=function(a){var b=this;return b.sheet.getStyleProperty(b.row,b.col,a,b.sheetArea)},y.prototype._setStyleProperty=function(b,c){for(var d=this,e=d.row;e<=d.row2;e++)for(var f=d.col;f<=d.col2;f++)if(d._isValidIndex(e,f)){var g=d.sheet.getStyle(e,f,d.sheetArea);g||(g=new a.Style),g[b]=c,d.sheet.setStyle(e,f,g,d.sheetArea)}return d},y.prototype._isValidIndex=function(a,b){var c=this,d=c.sheet,e=c.sheetArea;if(d){var f=d.getRowCount(e),g=d.getColumnCount(e);if(a>=0&&f>a&&b>=0&&g>b)return!0}return!1},y}();a.Cell=y;var z=function(){function y(a,c,d){var e=this;e.sheet=a,e.index=c,e.index2=c,(d===b||null===d)&&(d=3),e.sheetArea=d}return y.prototype.height=function(a){var b=this;if(0===arguments.length)return b.sheet.getRowHeight(b.index,b.sheetArea);for(var c=b.index;c<=b.index2;c++)b._isValidIndex(c)&&b.sheet.setRowHeight(c,a,b.sheetArea);return b},y.prototype.visible=function(a){var b=this;if(0===arguments.length)return b.sheet.getRowVisible(b.index,b.sheetArea);for(var c=b.index;c<=b.index2;c++)b._isValidIndex(c)&&b.sheet.setRowVisible(c,a,b.sheetArea);return b},y.prototype.resizable=function(a){var b=this;if(0===arguments.length)return b.sheet.getRowResizable(b.index,b.sheetArea);for(var c=b.index;c<=b.index2;c++)b._isValidIndex(c)&&b.sheet.setRowResizable(c,a,b.sheetArea);return b},y.prototype.dataValidator=function(a){return 0==arguments.length?this._getStyleProperty(t):this._setStyleProperty(t,a)},y.prototype.cellType=function(a){return 0==arguments.length?this._getStyleProperty(u):this._setStyleProperty(u,a)},y.prototype.backgroundImage=function(a){return 0==arguments.length?this._getStyleProperty(r):this._setStyleProperty(r,a)},y.prototype.backgroundImageLayout=function(a){return 0==arguments.length?this._getStyleProperty(s):this._setStyleProperty(s,a)},y.prototype.backColor=function(a){return 0===arguments.length?this._getStyleProperty(c):this._setStyleProperty(c,a)},y.prototype.foreColor=function(a){return 0===arguments.length?this._getStyleProperty(d):this._setStyleProperty(d,a)},y.prototype.hAlign=function(a){return 0===arguments.length?this._getStyleProperty(e):this._setStyleProperty(e,a)},y.prototype.vAlign=function(a){return 0===arguments.length?this._getStyleProperty(f):this._setStyleProperty(f,a)},y.prototype.themeFont=function(a){return 0===arguments.length?this._getStyleProperty(g):this._setStyleProperty(g,a)},y.prototype.font=function(a){return 0===arguments.length?this._getStyleProperty(h):this._setStyleProperty(h,a)},y.prototype.formatter=function(a){return 0===arguments.length?this._getStyleProperty(i):this._setStyleProperty(i,a)},y.prototype.borderLeft=function(a){return 0===arguments.length?this._getStyleProperty(j):this._setStyleProperty(j,a)},y.prototype.borderTop=function(a){return 0===arguments.length?this._getStyleProperty(k):this._setStyleProperty(k,a)},y.prototype.borderRight=function(a){return 0===arguments.length?this._getStyleProperty(l):this._setStyleProperty(l,a)},y.prototype.borderBottom=function(a){return 0===arguments.length?this._getStyleProperty(m):this._setStyleProperty(m,a)},y.prototype.locked=function(a){return 0===arguments.length?this._getStyleProperty(n):this._setStyleProperty(n,a)},y.prototype.textIndent=function(a){return 0===arguments.length?this._getStyleProperty(o):this._setStyleProperty(o,a)},y.prototype.wordWrap=function(a){return 0===arguments.length?this._getStyleProperty(p):this._setStyleProperty(p,a)},y.prototype.shrinkToFit=function(a){return 0===arguments.length?this._getStyleProperty(q):this._setStyleProperty(q,a)},y.prototype.tabStop=function(a){return 0===arguments.length?this._getStyleProperty(v):this._setStyleProperty(v,a)},y.prototype.textDecoration=function(a){return 0===arguments.length?this._getStyleProperty(w):this._setStyleProperty(w,a)},y.prototype.imeMode=function(a){return 0===arguments.length?this._getStyleProperty(x):this._setStyleProperty(x,a)},y.prototype.clearStyleProperty=function(b){for(var c=this,d=c.sheet,e=c.index;e<=c.index2;e++)if(c._isValidIndex(e)){var f=d.getStyle(e,-1,c.sheetArea);f&&(f.clear(b),d._trigger(a.Events.RowChanged,{sheet:d,sheetName:d._name,row:e,sheetArea:c.sheetArea,propertyName:b}))}},y.prototype._getStyleProperty=function(a){var c=this.sheet.getStyle(this.index,-1,this.sheetArea);return c?c[a]:b},y.prototype._setStyleProperty=function(b,c){for(var d=this,e=d.index;e<=d.index2;e++)if(d._isValidIndex(e)){var f=d.sheet.getStyle(e,-1,d.sheetArea);f||(f=new a.Style),f[b]=c,d.sheet.setStyle(e,-1,f,d.sheetArea)}return d},y.prototype._isValidIndex=function(a){if(this.sheet){var b=this.sheet.getRowCount(this.sheetArea);if(a>=0&&b>a)return!0}return!1},y}();a.Row=z;var A=function(){function y(a,c,d){var e=this;e.sheet=a,e.index=c,e.index2=c,(d===b||null===d)&&(d=3),e.sheetArea=d}return y.prototype.width=function(a){var b=this;if(0===arguments.length)return b.sheet.getColumnWidth(b.index,b.sheetArea);for(var c=b.index;c<=b.index2;c++)b._isValidIndex(c)&&b.sheet.setColumnWidth(c,a,b.sheetArea);return b},y.prototype.visible=function(a){var b=this;if(0===arguments.length)return b.sheet.getColumnVisible(b.index,b.sheetArea);for(var c=b.index;c<=b.index2;c++)b._isValidIndex(c)&&b.sheet.setColumnVisible(c,a,b.sheetArea);return b},y.prototype.resizable=function(a){var b=this;if(0===arguments.length)return b.sheet.getColumnResizable(b.index,b.sheetArea);for(var c=b.index;c<=b.index2;c++)b._isValidIndex(c)&&b.sheet.setColumnResizable(c,a,b.sheetArea);return b},y.prototype.dataValidator=function(a){return 0==arguments.length?this._getStyleProperty(t):this._setStyleProperty(t,a)},y.prototype.cellType=function(a){return 0==arguments.length?this._getStyleProperty(u):this._setStyleProperty(u,a)},y.prototype.backgroundImage=function(a){return 0==arguments.length?this._getStyleProperty(r):this._setStyleProperty(r,a)},y.prototype.backgroundImageLayout=function(a){return 0==arguments.length?this._getStyleProperty(s):this._setStyleProperty(s,a)},y.prototype.backColor=function(a){return 0===arguments.length?this._getStyleProperty(c):this._setStyleProperty(c,a)},y.prototype.foreColor=function(a){return 0===arguments.length?this._getStyleProperty(d):this._setStyleProperty(d,a)},y.prototype.hAlign=function(a){return 0===arguments.length?this._getStyleProperty(e):this._setStyleProperty(e,a)},y.prototype.vAlign=function(a){return 0===arguments.length?this._getStyleProperty(f):this._setStyleProperty(f,a)},y.prototype.themeFont=function(a){return 0===arguments.length?this._getStyleProperty(g):this._setStyleProperty(g,a)},y.prototype.font=function(a){return 0===arguments.length?this._getStyleProperty(h):this._setStyleProperty(h,a)},y.prototype.formatter=function(a){return 0===arguments.length?this._getStyleProperty(i):this._setStyleProperty(i,a)},y.prototype.borderLeft=function(a){return 0===arguments.length?this._getStyleProperty(j):this._setStyleProperty(j,a)},y.prototype.borderTop=function(a){return 0===arguments.length?this._getStyleProperty(k):this._setStyleProperty(k,a)},y.prototype.borderRight=function(a){return 0===arguments.length?this._getStyleProperty(l):this._setStyleProperty(l,a)},y.prototype.borderBottom=function(a){return 0===arguments.length?this._getStyleProperty(m):this._setStyleProperty(m,a)},y.prototype.locked=function(a){return 0===arguments.length?this._getStyleProperty(n):this._setStyleProperty(n,a)},y.prototype.textIndent=function(a){return 0===arguments.length?this._getStyleProperty(o):this._setStyleProperty(o,a)},y.prototype.wordWrap=function(a){return 0===arguments.length?this._getStyleProperty(p):this._setStyleProperty(p,a)},y.prototype.shrinkToFit=function(a){return 0===arguments.length?this._getStyleProperty(q):this._setStyleProperty(q,a)},y.prototype.tabStop=function(a){return 0===arguments.length?this._getStyleProperty(v):this._setStyleProperty(v,a)},y.prototype.textDecoration=function(a){return 0===arguments.length?this._getStyleProperty(w):this._setStyleProperty(w,a)},y.prototype.imeMode=function(a){return 0===arguments.length?this._getStyleProperty(x):this._setStyleProperty(x,a)},y.prototype.clearStyleProperty=function(b){for(var c=this,d=c.sheet,e=c.index;e<=c.index2;e++)if(c._isValidIndex(e)){var f=d.getStyle(-1,e,c.sheetArea);f&&(f.clear(b),d._trigger(a.Events.ColumnChanged,{sheet:d,sheetName:d._name,col:e,sheetArea:c.sheetArea,propertyName:b}))}},y.prototype._getStyleProperty=function(a){var c=this.sheet.getStyle(-1,this.index,this.sheetArea);return c?c[a]:b},y.prototype._setStyleProperty=function(b,c){for(var d=this,e=d.index;e<=d.index2;e++)if(d._isValidIndex(e)){var f=d.sheet.getStyle(-1,e,d.sheetArea);f||(f=new a.Style),f[b]=c,d.sheet.setStyle(-1,e,f,d.sheetArea)}return d},y.prototype._isValidIndex=function(a){if(this.sheet){var b=this.sheet.getColumnCount(this.sheetArea);if(a>=0&&b>a)return!0}return!1},y}();a.Column=A}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){function c(a,c,d,e){throw new Error(b.SR.Exp_InvalidAndSpace+a+b.SR.ColonSpace+c+b.SR.MustBeBetween+d+b.SR.SpaceAndSpace+e+b.SR.RightBracketFullStop)}function d(a,b,c){for(var d in s)s[d]&&(a=a.replace(s[d],s[d].source));return b===!0?(a=a.replace(/~\?/g,t.source),a=a.replace(/~\*/g,u.source),a=a.replace(/\?/g,"."),a=c?a.replace(/\*/g,"((.|\\n)+)"):a.replace(/\*/g,"((.|\\n)*)"),a=a.replace(t,"\\?"),a=a.replace(u,"\\*")):(a=a.replace(/\?/g,"\\?"),a=a.replace(/\*/g,"\\*")),a}b.feature("core.sheet",["core.common","core.stringResource","core.sheet_event","core.sheet_render","core.basecelltype","core.sheet_ui","core.sheet_model","core.sheet_action","core.sheet_border"]);var e=null,f=void 0,g=Math.min,h=Math.max,i=Math.floor,j="undefined",k="function",l="number",m="string",n="boolean",o=window.document,p=window.ko,q=function(){function a(a){var b=1,c=2,d=8,e=16,f=this;f.rowHeader=(a&b)===b,f.columnHeader=(a&c)===c,f.unFormatted=(a&d)===d,f.formula=(a&e)===e,f.expandRows=!0,f.expandColumns=!0}return a.prototype.fixOptions=function(a){a&&(a.getColumnCount(2)<=0&&(this.rowHeader=!1),a.getRowCount(1)<=0&&(this.columnHeader=!1))},a}(),r=function(){function a(){}return a.copyTo=function(b,c,d,f,g,h,i,j,k,l){a.checkArguments(b,c,d,f,g,h,i,j),b.suspendCalcService(),f.suspendCalcService();var m=e;(256&k)>0&&(m=a.copyBindingPath(b,c,d,f,g,h,i,j,l));try{if((1&k)>0&&(a.copyValue(b,c,d,f,g,h,i,j,l),0===(2&k)&&a.clearFormula(f,g,h,i,j,l),(256&k)>0))for(var n=m.length,o=0>g?0:g,p=0>h?0:h,q=0;n>q;q++){var r=m[q];l&&f.isRowFilterOut(o+r.row)||f.setValue(o+r.row,p+r.col,r.value)}(2&k)>0&&a.copyFormula(b,c,d,f,g,h,i,j,l)}finally{b.resumeCalcService(),f.resumeCalcService()}(64&k)>0&&a.copyStyle(b,c,d,f,g,h,i,j,l),(512&k)>0&&a.copyConditionalFormatRules(b,c,d,f,g,h,i,j),(4&k)>0&&a.copyComment(b,c,d,f,g,h,i,j,l),(16&k)>0&&a.copySparkline(b,c,d,f,g,h,i,j),(8&k)>0&&(0>c&&a.copyColumnRangeGroup(b,d,f,h,j),0>d&&a.copyRowRangeGroup(b,c,f,g,i)),(32&k)>0&&a.copySpan(b,c,d,f,g,h,i,j),0>c&&a.copyColumnAxis(b,d,f,h,j,k),0>d&&a.copyRowAxis(b,c,f,g,i,k,l),0>c&&0>g&&0>d&&0>h&&a.copySheetInfo(b,f,k)},a.checkArguments=function(a,d,e,f,h,i,j,k){if(!a)throw new Error(b.SR.Exp_SrcIsNull);if(!f)throw new Error(b.SR.Exp_DestIsNull);(-1>d||d>=a.getRowCount())&&c("from row index",d,"-1",a.getRowCount()-1),(-1>e||e>=a.getColumnCount())&&c("from column index",e,"-1",a.getColumnCount()-1),(-1>h||h>=f.getRowCount())&&c("to row index",h,"-1",f.getRowCount()-1),(-1>i||i>=f.getColumnCount())&&c("to column index",i,"-1",f.getColumnCount()-1);var l=e;0>e&&(l=0,k=a.getColumnCount());var m=0>i?0:i;(1>k||l+k>a.getColumnCount()||m+k>f.getColumnCount())&&c("column count",k,"1",g(a.getColumnCount()-l,f.getColumnCount()-m));var n=d;0>d&&(n=0,j=a.getRowCount());var o=0>h?0:h;(1>j||n+j>a.getRowCount()||o+j>f.getRowCount())&&c("row count",j,"1",g(a.getRowCount()-n,f.getRowCount()-o))},a.copyValue=function(c,d,f,h,i,k,l,m,n){var o,p,q,r,s,t=!(c===h&&c._name===h._name);if(0>d){var u=1,v=f,w=k;if(o=g(c.getRowCount(u),h.getRowCount(u)),p=m,0>f&&(v=0,p=c.getColumnCount()),0>k&&(w=0),t)for(q=0;o>q;q++)for(r=0;p>r;r++)s=c.getValue(q,v+r,u),(typeof s===j||s===e)&&c.isColumnBound(v+r)&&(q===c.colHeaderAutoTextIndex||q===o-1&&-1===c.colHeaderAutoTextIndex)&&(s=c.getDataColumnName(v+r)),typeof s===j||s===e?h._setValueInternal(q,w+r,e,u,!1):h._setValueInternal(q,w+r,a.cloneObject(s),u,!1);else{var x=new b._GcSheetModel(o,p,e);for(q=0;o>q;q++)for(r=0;p>r;r++)s=c._getModel(u).getValue(q,v+r),(typeof s===j||s===e)&&c.isColumnBound(v+r)&&(q===c.colHeaderAutoTextIndex||q===o-1&&-1===c.colHeaderAutoTextIndex)&&(s=c.getDataColumnName(v+r)),typeof s!==j&&s!==e&&x.setValue(q,r,a.cloneObject(s));for(q=0;o>q;q++)for(r=0;p>r;r++)h._setValueInternal(q,w+r,x.getValue(q,r),u,!1)}}if(0>f){var y=2,z=d,A=i;if(o=l,p=g(c.getColumnCount(y),h.getColumnCount(y)),0>d&&(z=0,o=c.getRowCount()),0>i&&(A=0),t)for(q=0;o>q;q++)for(r=0;p>r;r++)s=c.getValue(z+q,r,y),typeof s===j||s===e?h._setValueInternal(A+q,r,e,y,!1):h._setValueInternal(A+q,r,a.cloneObject(s),y,!1);else{var B=new b._GcSheetModel(o,p,e);for(q=0;o>q;q++)for(r=0;p>r;r++)s=c._getModel(y).getValue(z+q,r),typeof s!==j&&s!==e&&B.setValue(q,r,a.cloneObject(s));
for(q=0;o>q;q++)for(r=0;p>r;r++)h._setValueInternal(A+q,r,B.getValue(q,r),y,!1)}}var C=3,D=d,E=f,F=i,G=k,H=l,I=m;if(0>d&&(D=0,H=g(c.getRowCount(),h.getRowCount())),0>f&&(E=0,I=g(c.getColumnCount(),h.getColumnCount())),0>i&&(F=0),0>k&&(G=0),t){for(q=0;H>q;q++)if(!n||!h.isRowFilterOut(F+q))for(r=0;I>r;r++)s=c.getValue(D+q,E+r,C),typeof s===j||s===e?h._setValueInternal(F+q,G+r,e,C,!1):h._setValueInternal(F+q,G+r,a.cloneObject(s),C,!1)}else{var J=new b._GcSheetModel(H,I,e);for(q=0;H>q;q++)for(r=0;I>r;r++)s=c.getValue(D+q,E+r,C),typeof s!==j&&s!==e&&J.setValue(q,r,a.cloneObject(s));for(q=0;H>q;q++)if(!n||!h.isRowFilterOut(F+q))for(r=0;I>r;r++)h._setValueInternal(F+q,G+r,J.getValue(q,r),C,!1)}},a._copyMoveBindingPath=function(a,c,d,f,h,i,j,k,l,m){var n=c,o=d,p=h,q=i,r=j,s=k;0>c&&(n=0,r=g(a.getRowCount(),f.getRowCount())),0>d&&(o=0,s=g(a.getColumnCount(),f.getColumnCount())),0>h&&(p=0),0>i&&(q=0);var t=[],u=!(a===f&&a._name===f._name);if(u)for(var v,w=0;r>w;w++)for(var x=0;s>x;x++)v=a.getBindingPath(n+w,o+x),f.setBindingPath(p+w,q+x,v),v&&t.push({row:w,col:x,value:a.getValue(n+w,o+x)}),l&&a.setBindingPath(n+w,o+x,e);else{for(var v,y=new b._GcSheetModel(r,s,e),w=0;r>w;w++)for(var x=0;s>x;x++)v=a.getBindingPath(n+w,o+x),y.setBindingPath(w,x,v),v&&t.push({row:w,col:x,value:a.getValue(n+w,o+x)}),l&&a.setBindingPath(n+w,o+x,e);for(var w=0;r>w;w++)if(!m||!f.isRowFilterOut(p+w))for(var x=0;s>x;x++)f.setBindingPath(p+w,q+x,y.getBindingPath(w,x))}return t},a.copyBindingPath=function(b,c,d,e,f,g,h,i,j){return a._copyMoveBindingPath(b,c,d,e,f,g,h,i,!1,j)},a.cloneObject=function(b){var c;if(typeof b===l||typeof b===m||typeof b===n||typeof b===j)return c=b;if(b instanceof Date)return c=new Date(b);c=b instanceof Object?new b.constructor:new b.constructor(b.valueOf());for(var d in b)b.hasOwnProperty(d)&&c[d]!==b[d]&&(c[d]="object"==typeof this[d]?a.cloneObject(b[d]):b[d]);return c.toString=b.toString,c.valueOf=b.valueOf,c},a.clearFormula=function(a,b,c,d,f,g){0>b&&(b=0,d=a.getRowCount()),0>c&&(c=0,f=a.getColumnCount());for(var h=b;d>h;h++)if(!g||!a.isRowFilterOut(h))for(var i=c;f>i;i++)a.setFormula(h,i,e)},a._copyExpression=function(c,d,e,f,g){var h=c;if(!b.util.hasCalc())return h;var i=b.Calc.Expressions,j=(b.Calc.Functions,b.Calc.Parser),k=b.Calc.Errors.Reference,l=i.ErrorExpression,m=i.ExternalErrorExpression;if(c instanceof i.ParenthesesExpression)h=new i.ParenthesesExpression,h.argument=a._copyExpression(c.argument,d,e,f,g);else if(c instanceof i.CellExpression){if(c.rowRelative&&(c.row+d<0||c.row+d>j.maxRowCount))return new l(k);if(c.columnRelative&&(c.column+e<0||c.column+e>j.maxColumnCount))return new l(k);h=new i.CellExpression(c.row,c.column,c.rowRelative,c.columnRelative)}else if(c instanceof i.ExternalCellExpression){if(c.rowRelative&&(c.row+d<0||c.row+d>j.maxRowCount))return new m(c.source,k);if(c.columnRelative&&(c.column+e<0||c.column+e>j.maxColumnCount))return new m(c.source,k);h=new i.ExternalCellExpression(c.source,c.row,c.column,c.rowRelative,c.columnRelative)}else if(c instanceof i.RangeExpression){var n=c;if(n.startRowRelative&&(n.startRow+d<0||n.startRow+d>j.maxRowCount))return new l(k);if(n.startColumnRelative&&(n.startColumn+e<0||n.startColumn+e>j.maxColumnCount))return new l(k);if(n.endRowRelative&&(n.endRow+d<0||n.endRow+d>j.maxRowCount))return new l(k);if(n.endColumnRelative&&(n.endColumn+e<0||n.endColumn+e>j.maxColumnCount))return new l(k);h=new i.RangeExpression(n.startRow,n.startColumn,n.endRow,n.endColumn,n.startRowRelative,n.startColumnRelative,n.endRowRelative,n.endColumnRelative),h.isFullRow=n.isFullRow,h.isFullColumn=n.isFullColumn}else if(c instanceof i.ExternalRangeExpression){var o=c;if(o.startRowRelative&&(o.startRow+d<0||o.startRow+d>j.maxRowCount))return new m(o.source,k);if(o.startColumnRelative&&(o.startColumn+e<0||o.startColumn+e>j.maxColumnCount))return new m(o.source,k);if(o.endRowRelative&&(o.endRow+d<0||o.endRow+d>j.maxRowCount))return new m(o.source,k);if(o.endColumnRelative&&(o.endColumn+e<0||o.endColumn+e>j.maxColumnCount))return new m(o.source,k);h=new i.ExternalRangeExpression(o.source,o.startRow,o.startColumn,o.endRow,o.endColumn,o.startRowRelative,o.startColumnRelative,o.endRowRelative,o.endColumnRelative),h.isFullRow=o.isFullRow,h.isFullColumn=o.isFullColumn}else if(c instanceof i.SheetRangeExpression){var p=c;if(p.startRowRelative&&(p.startRow+d<0||p.startRow+d>j.maxRowCount))return new i.SheetRangeErrorExpression(p.startSource,p.endSource,k);if(p.startColumnRelative&&(p.startColumn+e<0||p.startColumn+e>j.maxColumnCount))return new i.SheetRangeErrorExpression(p.startSource,p.endSource,k);if(p.endRowRelative&&(p.endRow+d<0||p.endRow+d>j.maxRowCount))return new i.SheetRangeErrorExpression(p.startSource,p.endSource,k);if(p.endColumnRelative&&(p.endColumn+e<0||p.endColumn+e>j.maxColumnCount))return new i.SheetRangeErrorExpression(p.startSource,p.endSource,k);h=new i.SheetRangeExpression(p.startSource,p.endSource,p.startRow,p.startColumn,p.endRow,p.endColumn,p.startRowRelative,p.startColumnRelative,p.endRowRelative,p.endColumnRelative),h.isFullRow=p.isFullRow,h.isFullColumn=p.isFullColumn}else if(c instanceof i.UnaryOperatorExpression)h=new i.UnaryOperatorExpression(c.operator,a._copyExpression(c.operand,d,e,f,g));else if(c instanceof i.BinaryOperatorExpression)h=new i.BinaryOperatorExpression(c.operator,a._copyExpression(c.left,d,e,f,g),a._copyExpression(c.right,d,e,f,g));else if(c instanceof i.FunctionExpression){if(h=new i.FunctionExpression(c.fn,[]),c.args&&c.args.length>0)for(var q=0;q<c.args.length;q++)h.args[q]=a._copyExpression(c.args[q],d,e,f,g)}else c instanceof i.StructReferenceExpression&&(h=c.offsetWhenCopy(f,g));return h},a.copyFormula=function(c,d,h,i,j,k,l,m,n){var o=c._getCalcModel(),p=i._getCalcModel(),q=(c._getSheetSource(),i._getSheetSource());if(o&&p){var r=d,s=h,t=j,u=k,v=l,w=m;0>d&&(r=0,v=g(c.getRowCount(),i.getRowCount())),0>h&&(s=0,w=g(c.getColumnCount(),i.getColumnCount())),0>j&&(t=0),0>k&&(u=0);var x=(!(c===i&&c._name===i._name),i._getSheetSource());x&&x.unlinkCellExpression(t,u,v,w);var y,z,A=new b._CalcModel(v,w,e);for(y=0;v>y;y++)for(z=0;w>z;z++)o.CopyExpr(A,y+r,z+s,y,z);var B={},C=i.getCalcService();for(y=0;v>y;y++)if(!n||!i.isRowFilterOut(y+t)){var D=y+t;for(z=0;w>z;z++){var E=A.getNode(y,z,!1),F=E&&E.expr,G=z+u;if(F){if(F===B)continue;F=a._copyExpression(F,D,G,j-d,k-h);var H=E.arrayInfo;if(x)if(H){for(var I=v-y<H.rowCount?v-y:H.rowCount,J=w-z<H.colCount?w-z:H.colCount,K=0;I>K;K++)for(var L=0;J>L;L++)A.getNode(y+K,z+L).expr=B;i._setArrayFormulaCore(D,G,I,J,C.unparse(F,D,G),!1,3)}else{var M=F?C.unparse(F,D,G):f;i._getModel().setFormula(D,G,M);var N=E.workingExpr;N&&(N=a._copyExpression(N,D,G,j-d,k-h)),q._setCellExpression(D,G,F,N,H)}else q.setExpression(D,G,F,H,!0)}else x&&x.getExpression(D,G)&&p.setExpr(D,G,f,f,f)}}}},a.copyStyle=function(a,c,d,f,h,i,j,k,l){var m,n,o,p,q,r=!(a===f&&a._name===f._name);if(0>c){var s=d,t=i;if(m=g(a.getRowCount(1),f.getRowCount(1)),n=k,0>d&&(s=0,n=a.getColumnCount()),0>i&&(t=0),r)for(o=0;m>o;o++)for(p=0;n>p;p++)q=a.getCompositeStyle(o,s+p,1),q?f.setStyle(o,t+p,q.clone(),1):f.setStyle(o,t+p,e,1);else{var u=new b._GcSheetModel(m,n,e);for(o=0;m>o;o++)for(p=0;n>p;p++)q=a.getCompositeStyle(o,s+p,1),q&&u.setValue(o,p,q.clone());for(o=0;m>o;o++)for(p=0;n>p;p++)f.setStyle(o,t+p,u.getValue(o,p),1)}}if(0>d){var v=c,w=h;if(m=j,n=g(a.getColumnCount(2),f.getColumnCount(2)),0>c&&(v=0,m=a.getRowCount()),0>h&&(w=0),r)for(o=0;m>o;o++)for(p=0;n>p;p++)q=a.getCompositeStyle(v+o,p,2),q?f.setStyle(w+o,p,q.clone(),2):f.setStyle(w+o,p,e,2);else{var x=new b._GcSheetModel(m,n,e);for(o=0;m>o;o++)for(p=0;n>p;p++)q=a.getCompositeStyle(v+o,p,2),q&&x.setValue(o,p,q.clone());for(o=0;m>o;o++)for(p=0;n>p;p++)f.setStyle(w+o,p,x.getValue(o,p),2)}}var y=c,z=d,A=h,B=i,C=j,D=k;if(0>c&&(y=0,C=g(a.getRowCount(),f.getRowCount())),0>d&&(z=0,D=g(a.getColumnCount(),f.getColumnCount())),0>h&&(A=0),0>i&&(B=0),r){for(o=0;C>o;o++)if(!l||!f.isRowFilterOut(A+o))for(p=0;D>p;p++)q=a.getCompositeStyle(y+o,z+p,3),q?f.setStyle(A+o,B+p,q.clone(),3):f.setStyle(A+o,B+p,e,3)}else{var E=new b._GcSheetModel(C,D,e);for(o=0;C>o;o++)for(p=0;D>p;p++)q=a.getCompositeStyle(y+o,z+p,3),q&&E.setValue(o,p,q.clone());for(o=0;C>o;o++)if(!l||!f.isRowFilterOut(A+o))for(p=0;D>p;p++)f.setStyle(A+o,B+p,E.getValue(o,p),3)}},a.copyConditionalFormatRules=function(a,c,d,e,f,g,h,i){var j=new Array,k=a.getConditionalFormats();if(k)for(var l=0;h>l;l++)for(var m=0;i>m;m++)for(var n=k.getRules(c+l,d+m),o=0;o<n.length;o++){for(var p=n[o],q=new Array,r=0;r<p.ranges.length;r++){var s=p.ranges[r];if(!(j.indexOf(s)>-1)&&s.contains(c+l,d+m)){j.push(s);var t=new b.Range(-1,-1,-1,-1);t.row=f+l,t.col=g+m,t.rowCount=s.row+s.rowCount>=h+c?h-l:c<s.row?s.rowCount:s.row+s.rowCount-c,t.colCount=s.col+s.colCount>=i+d?i-m:d<s.col?s.colCount:s.col+s.colCount-d,q.push(t)}}p.ranges=p.ranges.concat(q)}},a.copyComment=function(a,b,c,d,e,f,h,i,j){var k=b,l=c,m=e,n=f,o=h,p=i;0>b&&(k=0,o=g(a.getRowCount(),d.getRowCount())),0>c&&(l=0,p=g(a.getColumnCount(),d.getColumnCount())),0>e&&(m=0),0>f&&(n=0);for(var q=[],r=0;o>r;r++)if(!j||!d.isRowFilterOut(m+r))for(var s=0;p>s;s++){var t=a.getComment(k+r,l+s);if(t){var u=t.clone();u._sheet=d,u._rowIndex=m+r,u._colIndex=n+s,u._location=u._defaultLocation,q.push(u)}}for(var v=0,w=q.length;w>v;v++){var t=q[v];d.setComment(t._rowIndex,t._colIndex,t)}},a.copyColumnRangeGroup=function(b,c,d,e,f){var h=c,i=e,j=f;0>h&&(h=0,j=g(b.getColumnCount(),d.getColumnCount())),0>e&&(i=0);var k=!(b===d&&b._name===d._name);if(k)b.colRangeGroup&&d.colRangeGroup&&a.crossSheetCopyRangeGroup(b.colRangeGroup,h,d.colRangeGroup,i,j);else{var l=b.colRangeGroup;l&&l._copy(h,i,j)}},a.crossSheetCopyRangeGroup=function(a,c,d,e,f){0>c&&(c=0),0>e&&(e=0);var g=[];if(a)for(var h=a.items.nextNonEmptyIndex(c-1);h>=0&&c+f>h;)g[h-c]=new b.RangeGroupItemInfo(a.items[h]),h=a.items.nextNonEmptyIndex(h);if(d&&(d.items.clear(e,f),g.length>0))for(var i in g)if(g.hasOwnProperty(i)){var j=g[i];d.items[e+i]=j}},a.copySparkline=function(a,b,c,d,e,f,h,i,j){var k=b,l=c,m=e,n=f,o=h,p=i;0>b&&(k=0,o=g(a.getRowCount(),d.getRowCount())),0>c&&(l=0,p=g(a.getColumnCount(),d.getColumnCount())),0>e&&(m=0),0>f&&(n=0);var q,r=!(a===d&&a._name===d._name);r?(q=d._sparklineGroupManager,q&&q._exCopy(a,k,l,m,n,o,p,j)):(q=a._sparklineGroupManager,q&&q._copy(k,l,m,n,o,p,j))},a.copyRowRangeGroup=function(b,c,d,e,f){var h=c,i=e,j=f;0>c&&(h=0,j=g(b.getRowCount(),d.getRowCount())),0>e&&(i=0);var k=!(b===d&&b._name===d._name);if(k)b.rowRangeGroup&&d.rowRangeGroup&&a.crossSheetCopyRangeGroup(b.rowRangeGroup,h,d.rowRangeGroup,i,j);else{var l=b.rowRangeGroup;l&&l._copy(h,i,j)}},a.copySpan=function(b,c,d,e,f,h,i,j){var k=c,l=d,m=f,n=h,o=i,p=j;0>c&&(k=0,o=g(b.getRowCount(),e.getRowCount())),0>l&&(l=0,p=g(b.getColumnCount(),e.getColumnCount())),0>f&&(m=0),0>h&&(n=0);var q=!(b===e&&b._name===e._name);if(0>c)if(q)a.crossSheetCopySpans(b._colHeaderSpanModel,-1,l,e._colHeaderSpanModel,-1,n,-1,p);else{var r=b._getSpanModel(1);r&&r.copy(-1,l,-1,n,-1,p)}if(0>d)if(q)a.crossSheetCopySpans(b._rowHeaderSpanModel,k,-1,e._rowHeaderSpanModel,m,-1,o,-1);else{var s=b._getSpanModel(2);s&&s.copy(k,-1,m,-1,o,-1)}if(q)a.crossSheetCopySpans(b._spanModel,k,l,e._spanModel,m,n,o,p);else{var t=b._getSpanModel(3);t&&t.copy(k,l,m,n,o,p)}},a.crossSheetCopySpans=function(c,d,e,f,g,h,i,j){var k,l,m,n,o=a.getSpans(c),p=a.getSpans(f),q=[];if(-1===d){if(o&&o.length>0)for(k=0;k<o.length;k++)m=o[k],m.col>=e&&m.col+m.colCount<=e+j&&q.push(new b.Range(m.row,h+m.col-e,m.rowCount,m.colCount));if(p&&p.length>0)for(k=0;k<p.length;k++)if(m=p[k],m.col>=h&&m.col<h+j)for(l=0;l<f.length;l++)if(n=f[l],n.row===m.row&&n.col===m.col){f.splice(l,1);break}}else if(-1===e){if(o&&o.length>0)for(k=0;k<o.length;k++)m=o[k],d<=m.row&&m.row+m.rowCount<=d+i&&q.push(new b.Range(g+m.row-d,m.col,m.rowCount,m.colCount));if(p&&p.length>0)for(k=0;k<p.length;k++)if(m=p[k],m.row>=g&&m.row<g+i)for(l=0;l<f.length;l++)if(n=f[l],n.row===m.row&&n.col===m.col){f.splice(l,1);break}}else{if(o&&o.length>0)for(k=0;k<o.length;k++)m=o[k],d<=m.row&&m.row<d+i&&e<=m.col&&m.col<e+j&&q.push(new b.Range(g+m.row-d,h+m.col-e,m.rowCount,m.colCount));if(p&&p.length>0)for(k=0;k<p.length;k++)if(m=p[k],m.row>=g&&m.row<g+i&&m.col>=h&&m.col<h+j)for(l=0;l<f.length;l++)if(n=f[l],n.row===m.row&&n.col===m.col){f.splice(l,1);break}}if(q.length>0&&f)for(k=0;k<q.length;k++){var r=q[k];f.push(r)}},a.getSpans=function(a){return a&&a.length>0?a.slice(0):e},a.copyColumnAxis=function(a,b,c,d,h,i){var j=b,k=d,l=h;0>b&&(j=0,l=g(a.getColumnCount(),c.getColumnCount())),0>d&&(k=0);for(var m=1,n=0;l>n;n++){var o=a._getActualColumnWidth(n+j);o!==f&&o!==e&&c.setColumnWidth(n+k,o);var p=a.getColumnVisible(n+j);if(p!==f&&p!==e&&c.setColumnVisible(n+k,p),(64&i)>0){var q=a.getActualStyle(-1,n+j);q?c.setStyle(-1,n+k,q.clone()):c.setStyle(-1,n+k,e),q=a.getActualStyle(-1,n+j,m),q?c.setStyle(-1,n+k,q.clone(),m):c.setStyle(-1,n+k,e,m)}}for(var r=g(a.getRowCount(m),c.getRowCount(m)),s=0;r>s;s++){var t=a._getActualRowHeight(s,m);t!==f&&t!==e&&c.setRowHeight(s,t,m)}},a.cloneAxisInfo=function(a,b,c){for(var d=[],f=0;c>f;f++){var g=a[b+f];if(g){var h={};for(var i in g)g.hasOwnProperty(i)&&(h[i]=g[i]);d.push(h)}else d.push(e)}return d},a.getAxisInfo=function(a,b,c){for(var d=[],e=0;c>e;e++)d.push(a[b+e]);return d},a.setAxisInfo=function(a,b,c){if(b)for(var d=0;d<a.length;d++)b[c+d]=a[d]},a.copyRowAxis=function(a,b,c,d,h,i,j){var k=b,l=d,m=h;0>b&&(k=0,m=g(a.getRowCount(),c.getRowCount())),0>d&&(l=0);for(var n=2,o=0;m>o;o++)if(!j||!c.isRowFilterOut(o+l)){var p=a._getActualRowHeight(o+k);p!==f&&p!==e&&c.setRowHeight(o+l,p);var q=a.getRowVisible(o+k);if(q!==f&&q!==e&&c.setRowVisible(o+l,q),(64&i)>0){var r=a.getActualStyle(o+k,-1);r?c.setStyle(o+l,-1,r.clone()):c.setStyle(o+l,-1,e),r=a.getActualStyle(o+k,-1,n),r?c.setStyle(o+l,-1,r.clone(),n):c.setStyle(o+l,-1,e,n)}}for(var s=g(a.getColumnCount(n),c.getColumnCount(n)),t=0;s>t;t++){var u=a._getActualColumnWidth(t,n);u!==f&&u!==e&&c.setColumnWidth(t,u,n)}},a.copySheetInfo=function(a,b,c){if(a!==b||a._name!==b._name){if((64&c)>0){var d=1,e=2;b.setDefaultStyle(a.getDefaultStyle().clone()),b.setDefaultStyle(a.getDefaultStyle(d).clone(),d),b.setDefaultStyle(a.getDefaultStyle(e).clone(),e)}b.defaults.colWidth=a.defaults.colWidth,b.defaults.rowHeight=a.defaults.rowHeight,b.defaults.rowHeaderColWidth=a.defaults.rowHeaderColWidth}},a.moveTo=function(b,c,d,f,h,i,j,k,l){a.checkArguments(b,c,d,f,h,i,j,k),b.suspendCalcService(),f.suspendCalcService();var m=e;(256&l)>0&&(m=a.moveBindingPath(b,c,d,f,h,i,j,k));try{if((1&l)>0&&(a.moveValue(b,c,d,f,h,i,j,k),0===(2&l)&&a.clearFormula(f,h,i,j,k),(256&l)>0))for(var n=m.length,o=0>h?0:h,p=0>i?0:i,q=0;n>q;q++){var r=m[q];f.setValue(o+r.row,p+r.col,r.value)}(2&l)>0&&a.moveFormula(b,c,d,f,h,i,j,k)}finally{b.resumeCalcService(),f.resumeCalcService()}if((64&l)>0&&a.moveStyle(b,c,d,f,h,i,j,k),(512&l)>0&&a.moveConditionalFormatRules(b,c,d,f,h,i,j,k),(4&l)>0&&a.moveComment(b,c,d,f,h,i,j,k),(16&l)>0&&a.moveSparkline(b,c,d,f,h,i,j,k),(8&l)>0&&(0>c&&a.moveColumnRangeGroup(b,d,f,i,k),0>d&&a.moveRowRangeGroup(b,c,f,h,j)),(32&l)>0&&a.moveSpan(b,c,d,f,h,i,j,k),0>c&&a.moveColumnAxis(b,d,f,i,k,l),0>d&&a.moveRowAxis(b,c,f,h,j,l),0>c&&0>h&&0>d&&0>i&&a.moveSheetInfo(b,f,l),0>c){var s=d,t=k;0>d&&(s=0,t=g(b.getColumnCount(),f.getColumnCount()));for(var u=0;t>u;u++)b.isColumnBound(s+u)&&(b._colInfos[s+u]=e)}},a.moveValue=function(a,c,d,f,h,i,k,l){var m,n,o,p,q,r=!(a===f&&a._name===f._name);if(0>c){var s=1,t=d,u=i;if(m=g(a.getRowCount(s),f.getRowCount(s)),n=l,0>d&&(t=0,n=a.getColumnCount()),0>i&&(u=0),r)for(o=0;m>o;o++)for(p=0;n>p;p++)q=a._getModel(s).getValue(o,t+p),(typeof q===j||q===e)&&a.isColumnBound(t+p)&&(o===a.colHeaderAutoTextIndex||o===m-1&&-1===a.colHeaderAutoTextIndex)&&(q=a.getDataColumnName(t+p)),typeof q===j||q===e?f._setValueInternal(o,u+p,e,s,!1):(f._setValueInternal(o,u+p,q,s,!1),a._setValueInternal(o,t+p,e,s,!1));else{var v=new b._GcSheetModel(m,n,e);for(o=0;m>o;o++)for(p=0;n>p;p++)q=a._getModel(s).getValue(o,t+p),(typeof q===j||q===e)&&a.isColumnBound(t+p)&&(o===a.colHeaderAutoTextIndex||o===m-1&&-1===a.colHeaderAutoTextIndex)&&(q=a.getDataColumnName(t+p)),typeof q!==j&&q!==e&&v.setValue(o,p,q),a._setValueInternal(o,t+p,e,s,!1);for(o=0;m>o;o++)for(p=0;n>p;p++)f._setValueInternal(o,u+p,v.getValue(o,p),s,!1)}}var w=2;if(0>d){var x=c,y=h;if(m=k,n=g(a.getColumnCount(w),f.getColumnCount(w)),0>c&&(x=0,m=a.getRowCount()),0>h&&(y=0),r)for(o=0;m>o;o++)for(p=0;n>p;p++)q=a.getValue(x+o,p,w),typeof q===j||q===e?f._setValueInternal(y+o,p,e,w,!1):(f._setValueInternal(y+o,p,q,w,!1),a._setValueInternal(x+o,p,e,w,!1));else{var z=new b._GcSheetModel(m,n,e);for(o=0;m>o;o++)for(p=0;n>p;p++)q=a._getModel(w).getValue(x+o,p),typeof q!==j&&q!==e&&z.setValue(o,p,q),a._setValueInternal(x+o,p,e,w,!1);for(o=0;m>o;o++)for(p=0;n>p;p++)f._setValueInternal(y+o,p,z.getValue(o,p),w,!1)}}var A=3,B=c,C=d,D=h,E=i,F=k,G=l;if(0>c&&(B=0,F=g(a.getRowCount(),f.getRowCount())),0>d&&(C=0,G=g(a.getColumnCount(),f.getColumnCount())),0>h&&(D=0),0>i&&(E=0),r)for(o=0;F>o;o++)for(p=0;G>p;p++)q=a.getValue(B+o,C+p),typeof q===j||q===e?f._setValueInternal(D+o,E+p,e,A,!1):(f._setValueInternal(D+o,E+p,q,A,!1),a._setValueInternal(B+o,C+p,e,A,!1));else{var H=new b._GcSheetModel(F,G,e);for(o=0;F>o;o++)for(p=0;G>p;p++)q=a.getValue(B+o,C+p),typeof q!==j&&q!==e&&H.setValue(o,p,q);for(o=0;F>o;o++)for(p=0;G>p;p++)a._setValueInternal(B+o,C+p,e,A,!1);for(o=0;F>o;o++)for(p=0;G>p;p++)f._setValueInternal(D+o,E+p,H.getValue(o,p),A,!1)}},a.moveFormula=function(a,c,d,h,i,j,k,l){var m=a._getCalcModel(),n=h._getCalcModel();if(m&&n){var o=c,p=d,q=i,r=j,s=k,t=l;0>c&&(o=0,s=g(a.getRowCount(),h.getRowCount())),0>d&&(p=0,t=g(a.getColumnCount(),h.getColumnCount())),0>i&&(q=0),0>j&&(r=0);var u=!(a===h&&a._name===h._name),v=a._getSheetSource(),w=h._getSheetSource();v&&(v.unlinkCellExpression(o,p,s,t),v._addDependentsToAdjust(o,p,s,t)),w&&(w.unlinkCellExpression(q,r,s,t),w._addDependentsToAdjust(q,r,s,t));var x,y,z=a._getModel(),A=h._getModel(),B=[];for(x=0;s>x;x++)for(y=0;t>y;y++){var C=m.getNode(x+o,y+p);C?(B.push({expr:C.expr,workingExpr:C.workingExpr,arrayInfo:C.arrayInfo}),z.setFormula(x+o,y+p,e),m.clearExpr(x+o,y+p)):B.push(e)}var D,E=h.getCalcService();for(x=0;s>x;x++)for(y=0;t>y;y++){var F=B.shift();if(F){var G=F.expr,H=F.arrayInfo;E&&H&&H.row===o+x&&H.col===p+y&&(D=new b.Range(x+q,y+r,H.rowCount,H.colCount),A.setFormula(x+q,y+r,E.unparse(G,x+q,y+r),D)),H&&(H.row=x+q,H.col=y+r),n.setExpr(x+q,y+r,G,H?D:f,F.workingExpr)}else E&&A.setFormula(x+q,y+r,f),n.setExpr(x+q,y+r,f,f,f)}v&&v._addCellsToAdjust(o,p,s,t),w&&w._addCellsToAdjust(q,r,s,t),v&&v._controller&&v._controller.adjustFormulasOnMove(v,o,p,w,q,r,s,t),u===!0&&w&&w._controller&&w._controller.adjustFormulasOnMove(v,o,p,w,q,r,s,t)}},a.moveStyle=function(a,c,d,f,h,i,j,k){var l,m,n,o,p,q=!(a===f&&a._name===f._name),r=1;if(0>c){var s=d,t=i;if(l=g(a.getRowCount(r),f.getRowCount(r)),m=k,0>d&&(s=0,m=a.getColumnCount()),0>i&&(t=0),q)for(n=0;l>n;n++)for(o=0;m>o;o++)p=a.getCompositeStyle(n,s+o,r),p?(f.setStyle(n,t+o,p.clone(),r),a.setStyle(n,s+o,e,r)):f.setStyle(n,t+o,e,r);else{var u=new b._GcSheetModel(l,m,e);for(n=0;l>n;n++)for(o=0;m>o;o++)p=a.getCompositeStyle(n,s+o,r),p&&u.setValue(n,o,p.clone()),a.setStyle(n,s+o,e,r);for(n=0;l>n;n++)for(o=0;m>o;o++)f.setStyle(n,t+o,u.getValue(n,o),r)}}var v=2;if(0>d){var w=c,x=h;if(l=j,m=g(a.getColumnCount(v),f.getColumnCount(v)),0>c&&(w=0,l=a.getRowCount()),0>h&&(x=0),q)for(n=0;l>n;n++)for(o=0;m>o;o++)p=a.getCompositeStyle(w+n,o,v),p?(f.setStyle(x+n,o,p.clone(),v),a.setStyle(w+n,o,e,v)):f.setStyle(x+n,o,e,v);else{var y=new b._GcSheetModel(l,m,e);for(n=0;l>n;n++)for(o=0;m>o;o++)p=a.getCompositeStyle(w+n,o,v),p&&y.setValue(n,o,p.clone()),a.setStyle(w+n,o,e,v);for(n=0;l>n;n++)for(o=0;m>o;o++)f.setStyle(x+n,o,y.getValue(n,o),v)}}var z=c,A=d,B=h,C=i,D=j,E=k;if(0>c&&(z=0,D=g(a.getRowCount(),f.getRowCount())),0>d&&(A=0,E=g(a.getColumnCount(),f.getColumnCount())),0>h&&(B=0),0>i&&(C=0),q)for(n=0;D>n;n++)for(o=0;E>o;o++)p=a.getCompositeStyle(z+n,A+o),p?(f.setStyle(B+n,C+o,p.clone()),a.setStyle(z+n,A+o,e)):f.setStyle(B+n,C+o,e);else{var F=new b._GcSheetModel(D,E,e);for(n=0;D>n;n++)for(o=0;E>o;o++)p=a.getCompositeStyle(z+n,A+o),p&&F.setValue(n,o,p.clone()),a.setStyle(z+n,A+o,e);for(n=0;D>n;n++)for(o=0;E>o;o++)f.setStyle(B+n,C+o,F.getValue(n,o))}},a.moveConditionalFormatRules=function(a,b,c,d,e,f,g,h){this.copyConditionalFormatRules(a,b,c,d,e,f,g,h),this._deleteConditionalFormatRange(a,b,c,d,e,f,g,h)},a._deleteConditionalFormatRange=function(a,c,d,e,f,i,j,k){var l=new Array,m=a.getConditionalFormats();if(m)for(var n=0;j>n;n++)for(var o=0;k>o;o++)for(var p=m.getRules(c+n,d+o),q=0;q<p.length;q++){for(var r=p[q],s=new Array,t=0;t<r.ranges.length;t++){var u=r.ranges[t];if(!(l.indexOf(u)>-1)&&u.contains(c+n,d+o)){if(l.push(u),c>u.row){var v=new b.Range(-1,-1,-1,-1);v.row=u.row,v.col=u.col,v.rowCount=c-u.row,v.colCount=u.colCount,s.push(v)}if(d>u.col){var w=new b.Range(-1,-1,-1,-1);w.row=h(c,u.row),w.col=u.col,w.rowCount=g(c+j,u.row+u.rowCount)-w.row,w.colCount=d-u.col,s.push(w)}if(d+k<u.col+u.colCount){var x=new b.Range(-1,-1,-1,-1);x.row=h(c,u.row),x.col=d+k,x.rowCount=g(c+j,u.row+u.rowCount)-x.row,x.colCount=u.col+u.colCount-(d+k),s.push(x)}if(c+j<u.row+u.rowCount){var y=new b.Range(-1,-1,-1,-1);y.row=c+j,y.col=u.col,y.rowCount=u.row+u.rowCount-(c+j),y.colCount=u.colCount,s.push(y)}}}for(var z=0;z<l.length;z++)r.ranges.remove(l[z]);r.ranges=r.ranges.concat(s)}},a.moveComment=function(a,b,c,d,f,h,i,j){var k=b,l=c,m=f,n=h,o=i,p=j;0>b&&(k=0,o=g(a.getRowCount(),d.getRowCount())),0>c&&(l=0,p=g(a.getColumnCount(),d.getColumnCount())),0>f&&(m=0),0>h&&(n=0);for(var q=[],r=0;o>r;r++)for(var s=0;p>s;s++){var t=a.getComment(k+r,l+s);if(t){var u=t.clone();u._sheet=d,u._rowIndex=m+r,u._colIndex=n+s,q.push(u),a.setComment(k+r,l+s,e)}}for(var v=0,w=q.length;w>v;v++){var t=q[v];d.setComment(t._rowIndex,t._colIndex,t)}},a.moveSparkline=function(a,b,c,d,e,f,h,i){var j=b,k=c,l=e,m=f,n=h,o=i;0>b&&(j=0,n=g(a.getRowCount(),d.getRowCount())),0>c&&(k=0,o=g(a.getColumnCount(),d.getColumnCount())),0>e&&(l=0),0>f&&(m=0);var p,q=!(a===d&&a._name===d._name);q?(p=d._sparklineGroupManager,p&&p._exMove(a,j,k,l,m,n,o)):(p=a._sparklineGroupManager,p&&p._move(j,k,l,m,n,o))},a.moveColumnRangeGroup=function(b,c,d,e,f){var h=c,i=e,j=f;0>h&&(h=0,j=g(b.getColumnCount(),d.getColumnCount())),0>e&&(i=0);var k=!(b===d&&b._name===d._name);if(k)b.colRangeGroup&&d.colRangeGroup&&(a.crossSheetCopyRangeGroup(b.colRangeGroup,h,d.colRangeGroup,i,j),b.colRangeGroup.items.clear(h,j));else{var l=b.colRangeGroup;l&&l._move(h,i,j)}},a.moveRowRangeGroup=function(b,c,d,e,f){var h=c,i=e,j=f;0>c&&(h=0,j=g(b.getRowCount(),d.getRowCount())),0>e&&(i=0);var k=!(b===d&&b._name===d._name);if(k)b.rowRangeGroup&&d.rowRangeGroup&&(a.crossSheetCopyRangeGroup(b.rowRangeGroup,h,d.rowRangeGroup,i,j),b.rowRangeGroup.items.clear(h,j));else{var l=b.rowRangeGroup;l&&l._move(h,i,j)}},a.moveSpan=function(b,c,d,e,f,h,i,j){var k=c,l=d,m=f,n=h,o=i,p=j;0>c&&(k=0,o=g(b.getRowCount(),e.getRowCount())),0>l&&(l=0,p=g(b.getColumnCount(),e.getColumnCount())),0>f&&(m=0),0>h&&(n=0);var q=!(b===e&&b._name===e._name);if(0>c)if(q)a.crossSheetCopySpans(b._colHeaderSpanModel,-1,l,e._colHeaderSpanModel,-1,n,-1,p),b._colHeaderSpanModel&&b._colHeaderSpanModel.clear(-1,l,-1,p);else{var r=b._getSpanModel(1);r&&r.move(-1,l,-1,n,-1,p)}if(0>d)if(q)a.crossSheetCopySpans(b._rowHeaderSpanModel,k,-1,e._rowHeaderSpanModel,m,-1,o,-1),b._rowHeaderSpanModel&&b._rowHeaderSpanModel.clear(k,-1,o,-1);else{var s=b._getSpanModel(2);s&&s.move(k,-1,m,-1,o,-1)}if(q)a.crossSheetCopySpans(b._spanModel,k,l,e._spanModel,m,n,o,p),b._spanModel&&b._spanModel.clear(k,l,o,p);else{var t=b._getSpanModel();t&&t.move(k,l,m,n,o,p)}},a.moveColumnAxis=function(a,b,c,d,h,i){var j=b,k=d,l=h;0>b&&(j=0,l=g(a.getColumnCount(),c.getColumnCount())),0>d&&(k=0);for(var m=1,n=0;l>n;n++){var o=a._getActualColumnWidth(n+j);o!==f&&o!==e&&(a.setColumnWidth(n+j,a.defaults.colWidth),c.setColumnWidth(n+k,o));var p=a.getColumnVisible(n+j);if(p!==f&&p!==e&&(a.setColumnVisible(n+j,!0),c.setColumnVisible(n+k,p)),(64&i)>0){var q=a.getActualStyle(-1,n+j);q?(c.setStyle(-1,n+k,q.clone()),a.setStyle(-1,n+j,e)):c.setStyle(-1,n+k,e),q=a.getActualStyle(-1,n+j,m),q?(c.setStyle(-1,n+k,q.clone(),m),a.setStyle(-1,n+j,e,m)):c.setStyle(-1,n+k,e,m)}}for(var r=g(a.getRowCount(m),c.getRowCount(m)),s=0;r>s;s++){var t=a._getActualRowHeight(s,m);t!==f&&t!==e&&(a.setRowHeight(s,a.defaults.colHeaderRowHeight,m),c.setRowHeight(s,t,m))}},a.moveRowAxis=function(a,b,c,d,h,i){var j=b,k=d,l=h;0>b&&(j=0,l=g(a.getRowCount(),c.getRowCount())),0>d&&(k=0);for(var m=2,n=0;l>n;n++){var o=a._getActualRowHeight(n+j);o!==f&&o!==e&&(a.setRowHeight(n+j,a.defaults.rowHeight),c.setRowHeight(n+k,o));var p=a.getRowVisible(n+j);if(p!==f&&p!==e&&(a.setRowVisible(n+j,!0),c.setRowVisible(n+k,p)),(64&i)>0){var q=a.getActualStyle(n+j,-1);q?(c.setStyle(n+k,-1,q.clone()),a.setStyle(n+j,-1,e)):c.setStyle(n+k,-1,e),q=a.getActualStyle(n+j,-1,m),q?(c.setStyle(n+k,-1,q.clone(),m),a.setStyle(n+j,-1,e,m)):c.setStyle(n+k,-1,e,m)}}for(var r=g(a.getColumnCount(m),c.getColumnCount(m)),s=0;r>s;s++){var t=a._getActualColumnWidth(s,m);t!==f&&t!==e&&(a.setColumnWidth(s,a.defaults.rowHeaderColWidth,m),c.setColumnWidth(s,t,m))}},a.moveSheetInfo=function(a,b,c){if(a!==b||a._name!==b._name){if((64&c)>0){var d=1,f=2;b.setDefaultStyle(a.getDefaultStyle()),b.setDefaultStyle(a.getDefaultStyle(d),d),b.setDefaultStyle(a.getDefaultStyle(f),f),a.setDefaultStyle(e),a.setDefaultStyle(e,d),a.setDefaultStyle(e,f)}b.defaults.colWidth=a.defaults.colWidth,b.defaults.rowHeight=a.defaults.rowHeight,b.defaults.rowHeaderColWidth=a.defaults.rowHeaderColWidth,a.defaults.colWidth=62,a.defaults.rowHeight=20,a.defaults.rowHeaderColWidth=40}},a.moveBindingPath=function(b,c,d,e,f,g,h,i){return a._copyMoveBindingPath(b,c,d,e,f,g,h,i,!0)},a.setRangeText=function(d,g,h,i,j,k,l,m){if(!d)throw new Error(b.SR.Exp_SheetIsNull);if((-1>g||g>=d.getRowCount())&&c("row",g,"-1",d.getRowCount()-1),(-1>h||h>=d.getColumnCount())&&c("column",h,"-1",d.getColumnCount()-1),i!==f&&i!==e&&""!==i){-1===g&&(g=0),-1===h&&(h=0);var n=a.parseText(i,j,k,l);n&&n.length>0&&a.setSheetData(d,g,h,n,m)}},a.getRangeText=function(a,d,g,h,i,j,k,l,m){if(!a)throw new Error(b.SR.Exp_SheetIsNull);(-1>d||d>=a.getRowCount())&&c("row",d,"-1",a.getRowCount()-1),(-1>g||d+g>a.getRowCount())&&c("rowCount",d,"-1",a.getRowCount()-d),(-1>h||h>=a.getColumnCount())&&c("column",h,"-1",a.getColumnCount()-1),(-1>i||h+i>a.getColumnCount())&&c("columnCount",h,"-1",a.getColumnCount()-h);var n=-1,o=-1;-1===d&&-1===h&&-1===g&&-1===i?(d=0,h=0,n=a.getRowCount()-1,o=a.getColumnCount()-1):(-1===d&&(d=0),-1===h&&(h=0),-1===g&&(g=a.getRowCount()-d),-1===i&&(i=a.getColumnCount()-h),n=d+g-1,o=h+i-1),(j===f||j===e||""===j)&&(j="\r\n"),(k===f||k===e||""===k)&&(k="	"),(l===f||l===e||""===l)&&(l='"');for(var p="",q=d;n>=q;q++){for(var r=!0,s=h;o>=s;s++){r||(p+=k),r=!1;var t="",u=a.getText(q,s);u!==f&&u!==e&&(t=u,t=t.replace(new RegExp(l,"g"),l+l)),p+=m||-1!==t.indexOf(l)||-1!==t.indexOf(k)||-1!==t.indexOf(j)||-1!==t.indexOf("\n")?l+t+l:t}p+=j}return p.toString()},a.parseText=function(a,c,d,g){if(a===f||a===e||""===a)return e;(c===f||c===e||""===c)&&(c="\r\n"),(d===f||d===e||""===d)&&(d="	"),(g===f||g===e||""===g)&&(g='"'),b.StringHelper.EndsWith(a,c)||(a+=c);for(var h=[],i=[],j=new b.StringBuilder,k=!1,l=g.length,m=c.length,n=d.length,o=0;o<a.length;o++)if(j.Append(a[o]),j.Length()>=l&&g===j.ToString(j.Length()-l,l))if(k&&a.length>=o+1+l&&g===a.substr(o+1,l))o+=l;else if(k)j.Remove(j.Length()-l,l),k=!1;else{var p=j.ToString();0===p.indexOf(g)&&(j.Remove(j.Length()-l,l),k=!0)}else!k&&j.Length()>=n&&d===j.ToString(j.Length()-n,n)?(j.Remove(j.Length()-n,n),i.push(j.toString()),j.Remove(0,j.Length())):!k&&j.Length()>=m&&c===j.ToString(j.Length()-m,m)?(j.Remove(j.Length()-m,m),i.push(j.toString()),h.push(i),i=[],j.Remove(0,j.Length())):k&&a.length>=o+1+n&&d===a.substr(o+1,n)&&","!=d&&(o+=l);if(k){if(i.length>0){for(var q=0;q<h.length&&h[q]!==i;q++);q>=h.length&&h.push(i)}var r=j.toString();r&&(r=r.replace(new RegExp(d,"g"),""),b.StringHelper.EndsWith(r,c)&&(r=r.substr(0,r.length-m)),0==h.length&&h.push([r]))}if(0==h.length&&a){var s=a;b.StringHelper.EndsWith(a,c)&&(s=s.substr(0,s.length-m)),h.push([s])}return h},a.setSheetData=function(b,c,d,e,f){var g=e.length,h=a.getMaxLength(e);if(0!==g&&0!==h){var i=new q(f);i.fixOptions(b);var j=i.rowHeader?b.getColumnCount(2):0,k=i.columnHeader?b.getRowCount(1):0,l=0;h-=j,0>=h&&(h=0),g-=k,0>=g&&(l=0),g-=l,0>=g&&(g=0),i.expandRows&&c+g>b.getRowCount()&&b.setRowCount(c+g),i.expandColumns&&d+h>b.getColumnCount()&&b.setColumnCount(d+h);for(var m=0,n=0;m<e.length;m++,n++){var o=e[m];o.length<=0||(k>0&&k>m?a.setRowData(b,o,n,d,h,1,i):g>0&&n<b.getRowCount()&&(m===k&&(n=c),a.setRowData(b,o,n,0,j,2,i),o.splice(0,j),a.setRowData(b,o,n,d,h,3,i)))}}},a.setRowData=function(b,c,d,e,f,g,h){for(var i=0,j=e;i<c.length;i++,j++)f>0&&j<b.getColumnCount(g)&&a.setCellData(b,g,d,j,c[i],h)},a.setCellData=function(a,c,d,g,h,i){var j=h,k=e;if(i.unFormatted===!1&&b.features.formatter){var l={value:h};k=(new b.GeneralFormatter).GetPreferredDisplayFormatter(h,l),j=l.value}if(1!=a.isProtected||a.getCell(d,g).locked()!==!0)if(j===f||j===e)a.setValue(d,g,j,c);else if(""!==h)if(i.formula&&"="===h[0])try{a.setFormula(d,g,h.substr(1),c)}catch(m){a.setText(d,g,h,c)}else{var n=a.getActualStyle(d,g,c);if(n)if(i.unFormatted===!1&&b.features.formatter)if(n.formatter)"@"===n.formatter.toString()&&(j=h.toString());else{var o=new b.AutoFormatter(k);a.getCell(d,g,c)._setStyleProperty("_autoFormatter",o)}else n.formatter&&a.getCell(d,g,c).formatter(e);a.setValue(d,g,j,c)}else a.setValue(d,g,e,c)},a.getMaxLength=function(a){if(a===f||a===e)return 0;for(var b=0,c=0;c<a.length;c++){var d=a[c];b=h(d.length,b)}return b},a.parseCsv=function(b,c,d,f){var g=e,h=a.parseText(b,c,d,f);if(h){for(var i=h.length,j=a.getMaxLength(h),k=[],l=0;i>l;l++){k[l]=[];for(var m=0;j>m;m++)k[l][m]=m<h[l].length?h[l][m]:e}g=k}return g},a}(),s=[/\\/g,/\(/g,/\[/g,/\{/g,/\^/g,/\$/g,/\|/g,/\)/g,/\+/g,/\./g],t=new RegExp("{113E2532-EAF5-444c-A5CB-3D7446971C4D}","g"),u=new RegExp("{E21523B3-0F1F-458f-B547-23D25713D0EC}","g"),v=function(){function a(a,b,c,d){var e=this;e.read=a,e.create=b,e.update=c,e.remove=d}return a}();b.DataContext=v;var w=".gcSheet",x=".gcSheetInternal",y="mousedown"+w,z="mousemove"+w,A="mouseup"+w,B="mouseout"+w,C="dblclick"+w,D="gcmousewheel"+w,E="resize"+w,F="value",G="left",H="top",I="width",J="height",K="hidden",L="visibility",M="POST",N="json",O="application/json;charset=UTF-8",P=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),Q=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),R=function(){function c(a){var c=this;c._name="",c._visible=!0,c.defaults=e,c.gridline=e,c.borderColor="black",c.borderWidth=0,c._zoomFactor=1,c.frozenRowCount=0,c.frozenColCount=0,c.rowHeaderVisible=!0,c.colHeaderVisible=!0,c.rowHeaderAutoText=1,c.colHeaderAutoText=2,c.rowHeaderAutoTextIndex=-1,c.colHeaderAutoTextIndex=-1,c.rowRangeGroup=e,c.colRangeGroup=e,c._activeRowIndex=0,c._activeColIndex=0,c.activeRowViewportIndex=0,c.activeColViewportIndex=0,c._allowCellOverflow=!1,c.maxCellOverflowDistance=100,c.showEditingLocator=!0,c.keyMap=e,c.isProtected=!1,c._allowUndo=!0,c._paintSuspended=!1,c._layoutSuspended=0,c.checkingChanges=!1,c.autoGenerateColumns=!0,c._allowEditorReservedLocations=!0,c._sheetTabColor=e,c._frozenlineColor="black",c._frozenTrailingRowCount=0,c._frozenTrailingColCount=0,c._rowLayoutCache=e,c._colLayoutCache=e,c._dragRect=e,c._scrollTopRow=0,c._scrollLeftCol=0,c._activeRowDirty=!1,c.floatingObjectKeyMap=e,c._commentKeyMap=e,c._cachePool=new b._CachePool(this),c._composedDefaultStyle={},c._defaultRowCount=200,c._defaultColCount=20,c._defaultRowHeight=20,c._defaultColWidth=62,c._defaultRowHeaderColWidth=40,c._defaultColHeaderRowHeight=20,c._defaultGridLineColor="#d0d7e5",c._defaultShowVerticalGridline=!0,c._defaultShowHorizontalGridline=!0,c.fontHeightCache=e,c._init(a)
}return c.prototype._addFloatingOjectInternal=function(a){var c=this,d=c._floatingObjectArray;if(d&&b.features.floatingObject)try{var e=c.isPaintSuspended();c.isPaintSuspended(!0),d.add(a)}finally{c.isPaintSuspended(e)}},c.prototype._findFloatingObjectInternal=function(a){var c=this._floatingObjectArray;return b.features.floatingObject&&c&&c.length>0?c.find(a):e},c.prototype._removeFloatingObjectInternal=function(a){var c=this._floatingObjectArray;if(b.features.floatingObject&&c&&c.length){var d=c.find(a);d&&c.remove(d)}},c.prototype._saveAndClearSheetSelections=function(){var a=this,c=a._selectionModel;if(c&&c.length>0){var d=new b._SelectionModel;a._selectionModelCache=d,d.selectionPolicy=c.selectionPolicy,d.selectionUnit=c.selectionUnit,d.activeSelectedRangeIndex=c.activeSelectedRangeIndex;for(var e=0,f=c.length;f>e;e++)d.push(c[e]);a._clearSelectionImp();for(var e=0,f=d.length;f>e;e++)a._render.repaintSelection(d[e])}},c.prototype._loadAndSetSheetSelections=function(){var a=this._selectionModelCache;if(a){var c=new b._SelectionModel;this._selectionModel=c,c.selectionPolicy=a.selectionPolicy,c.selectionUnit=a.selectionUnit,c.activeSelectedRangeIndex=a.activeSelectedRangeIndex;for(var d=0,e=a.length;e>d;d++)c.push(a[d])}},c.prototype._updateFloatingObjectsLayout=function(){var a=this,c=a._floatingObjectArray,d=a._render;b.features.floatingObject&&c&&c.length>0&&(c._updateFloatingsObjectlayoutOnColumnRowChanged(),d&&d._paintFloatingObject(a._bounds))},c.prototype.unSelectAllFloatingObjects=function(){var a=this._floatingObjectArray;if(b.features.floatingObject&&a&&a.length>0)for(var c=0;c<a.length;c++)a[c].isSelected(!1)},c.prototype.addFloatingObject=function(a){this._floatingObjectArray&&b.features.floatingObject&&a instanceof b.CustomFloatingObject&&this._addFloatingOjectInternal(a)},c.prototype.findFloatingObject=function(a){var c=this._findFloatingObjectInternal(a);return c instanceof b.CustomFloatingObject?c:e},c.prototype.removeFloatingObject=function(a){var c=this._findFloatingObjectInternal(a);c instanceof b.CustomFloatingObject&&this._floatingObjectArray.remove(c)},c.prototype.getFloatingObjects=function(){var a=[];if(!b.features.floatingObject)return a;for(var c=this._floatingObjectArray,d=0,e=c.length;e>d;d++){var f=c[d];f instanceof b.CustomFloatingObject&&a.push(f)}return a},c.prototype.addPicture=function(a,c,d,f,g,h,i,k,l,m){var n=this,o=n._floatingObjectArray;if(!o||!b.features.floatingObject)return e;try{var p=n.isPaintSuspended();n.isPaintSuspended(!0);var q=new b.Picture(a);return q.owner(n),q.src(c),q.startRow(d),q.startColumn(f),q.endRow(g),q.endColumn(h),(typeof g===j||typeof h===j)&&(q._isTakeOriginalSize=!0),"number"==typeof i&&q.startRowOffset(i),"number"==typeof k&&q.startColumnOffset(k),"number"==typeof l&&q.endRowOffset(l),"number"==typeof m&&q.endColumnOffset(m),o.add(q),q}finally{n.isPaintSuspended(p)}},c.prototype.findPicture=function(a){var c=this._findFloatingObjectInternal(a);return c instanceof b.Picture?c:e},c.prototype.removePicture=function(a){var c=this._findFloatingObjectInternal(a);c instanceof b.Picture&&this._floatingObjectArray.remove(c)},c.prototype.getPictures=function(){var a=[];if(!b.features.floatingObject)return a;for(var c=this._floatingObjectArray,d=0,e=c.length;e>d;d++){var f=c[d];f instanceof b.Picture&&a.push(f)}return a},c.prototype.setFloatingObjectZIndex=function(a,c){if(!isNaN(c)&&b.features.floatingObject){var d=this._render,e=d&&d._floatingObjectRenderManager;if(e){var f,g,h,i;for(f=0,h=e.length;h>f;f++){var j=e[f];if(j)for(g=0,i=j.length;i>g;g++){var k=j[g];k&&k.setFloatingObjectZIndex(a,c)}}}}},c.prototype.getFloatingObjectZIndex=function(a){var c=this._render,d=c&&c._floatingObjectRenderManager;if(b.features.floatingObject&&d){var e,f,g,h;for(e=0,g=d.length;g>e;e++){var i=d[e];if(i)for(f=0,h=i.length;h>f;f++){var j=i[f];if(j)return j.getFloatingObjectZIndex(a)}}}return-1},c.prototype.getDataSource=function(){var a=this._bindingManager;return a?a.getSource():e},c.prototype.getBindingPath=function(a,b,c){if((c===f||c===e)&&(c=3),3===c){var d=this._getModel(c);if(d)return d.getBindingPath(a,b)}return e},c.prototype.setBindingPath=function(a,b,c,d){var g=this;return g._bindToAutoRefresh(function(a,b,c,d){if((d===f||d===e)&&(d=3),3===d){var h=g._getModel(d);h&&h.setBindingPath(a,b,c)}return g})(a,b,c,d)},c.prototype._autoGenerateColumnCellType=function(a){var c=this,d=c._bindingManager,e=c._colInfos;if(d&&e&&e[a]){var f=d.getDataItem(0);if(f){var g=f[e[a].name];typeof g===n&&c.setCellType(-1,a,new b.CheckBoxCellType)}}},c.prototype.setDataSource=function(a,c){var d=this,e=d._bindingManager;e&&e.getSource()!==a&&d._bindToAutoRefresh(function(a,c){if((!a||c)&&d.reset(),e=d._bindingManager,a){if(e.bind(a),b._BindingManager.isCellBindingSource(a))return;if(d.setRowCount(e.getRowCount()),d.autoGenerateColumns){d.setColumnCount(e.getColumnCount()),d._colInfos={};var f=e.getFields();if(f)for(var g in f)d._colInfos[g]={name:f[g]}}else d._colInfos||(d._colInfos={});d.calcService.IsSuspended()||d.recalcAll()}})(a,c)},c.prototype.bindColumn=function(a,b){var c=this,d=c.isPaintSuspended();c.isPaintSuspended(!0);try{typeof b===m&&(b={name:b});var e=c._colInfos;e||(c._colInfos=e={}),e[a]=b,b&&b.formatter&&c.setFormatter(-1,a,b.formatter),b&&b.cellType&&c.setCellType(-1,a,b.cellType)}finally{c.isPaintSuspended(d)}},c.prototype.bindColumns=function(a){var b=this,c=b.isPaintSuspended();b.isPaintSuspended(!0);try{if(b._colInfos={},a){isNaN(a.length)||b.setColumnCount(a.length);for(var d=0;d<a.length;d++){var e=a[d];typeof e===m&&(e={name:e}),b._colInfos[d]=e,e&&e.formatter&&b.setFormatter(-1,d,e.formatter),e&&e.cellType&&b.setCellType(-1,d,e.cellType)}}}finally{b.isPaintSuspended(c)}},c.prototype.getDataContext=function(){return this.dataContext},c.prototype.setDataContext=function(a){this.dataContext=a,this.load()},c.prototype.getDataItem=function(a){var b=this,c=b._bindingManager,d=b._colInfos;if(!c||0===c.getRowCount())return e;var f=b.getColumnCount(),g={},h=c.getDataItem(a);if(h)for(var i in h)h.hasOwnProperty(i)&&typeof i!==k&&(g[i]=h[i]);if(d)for(var j=0;f>j;j++){var l=d[j];l&&l.name&&l.name.length>0&&(g[l.name]=b.getValue(a,j))}return g},c.prototype.getDirtyRows=function(){var a=this,b=[],c=a._dataModel.dirtyNodes;if(c){var d=a._bindingManager,f=a.getDataSource();for(var g in c)c.hasOwnProperty(g)&&c[g]&&"e"===c[g].rs&&b.push({row:g,item:a.getDataItem(g),originalItem:f?d.getDataItem(g):e})}return b},c.prototype.getInsertRows=function(){var a=[],b=this._dataModel.dirtyNodes;if(b)for(var c in b)b.hasOwnProperty(c)&&b[c]&&"n"===b[c].rs&&a.push({row:c,item:this.getDataItem(c)});return a},c.prototype._getDeleteRows=function(){var a=[];return this.deletedRows&&$.each(this.deletedRows,function(b,c){typeof c!==k&&c&&c.data!==f&&c.data!==e&&a.push({row:b,originalItem:c.data})}),a},c.prototype.hasPendingChanges=function(){var a,b=this,c=b._dataModel.dirtyNodes;if(c)for(a in c)if(c[a]&&("e"===c[a].rs||"n"===c[a].rs))return!0;var d=b.deletedRows;if(d)for(a in d){var e=d[a];if(e&&typeof e!==k)return!0}return!1},c.prototype.clearPendingChanges=function(){function a(a){$.each(a,function(a,b){typeof a!==k&&b&&b.dirty&&(b.dirty=e)})}var b=this,c=b._dataModel.dirtyNodes;for(var d in c){var f=c[d];f&&f.rs&&delete f.rs}b._dataModel.dirtyNodes={},b.deletedRows=[],a(b._rowInfos),a(b._colInfos)},c.prototype.load=function(){var a=this,b=a.dataContext;b&&b.read&&(a._dataReceivedDelegate=function(b){return a._onDataReceived(b)},$.getJSON(b.read,a._dataReceivedDelegate))},c.prototype.updateRecord=function(){var a=this,b=a.dataContext;if(a.autoUpdate&&b&&b.update&&""!==b.update){var c=a._bindingManager,d=a.getDataSource();if(d&&0!==c.getRowCount()){a._dataUpdatedDelegate=function(b){return a._onDataUpdated(b)};var e=a._activeRowIndex;if(e>=0){var f=a.getDataItem(e),g=b.update;a._dataModel.dataTable&&a._dataModel.dataTable[e]&&"n"===a._dataModel.dataTable[e].rs&&(g=b.create),$.ajax({url:g,type:M,data:JSON.stringify(f),dataType:N,contentType:O,success:a._dataUpdatedDelegate})}}}},c.prototype._onDataUpdated=function(){},c.prototype._onDataReceived=function(a){if(a){var b=a.data;if(b){var c=this;if(c.setDataSource(b),isNaN(a.total)||c.setRowCount(a.total),window.localStorage)for(var d=c.getColumnCount(),e=0;d>e;e++)window.localStorage["col,"+e]&&c.setColumnWidth(e,parseInt(window.localStorage["col,"+e],10));c.parent&&c.parent._doResize(),c.invalidateLayout(),c.repaint()}}},c.prototype._getProperties=function(a){var b=[];if(a)for(var c in a)typeof a[c]!==k?b.push(c):typeof p!==j&&p.isObservable(a[c])&&b.push(c);return b},c.prototype.referenceStyle=function(a){var c=(b.ReferenceStyle,this.getCalcService());return 0===arguments.length?c&&c.useR1C1?1:0:(c&&(c.useR1C1=1===a),this)},c.prototype.recalcAll=function(){var a=this.getCalcService();a&&a.recalculateAll(!0)},c.prototype._recalcCell=function(a,b,c){var d=this.getCalcService();d&&!d.ignoreDirty()&&d.recalculate({target:this,model:a},b,c)},c.prototype.getCalcService=function(){var a=this;return!a.calcService&&b.util.hasCalc()&&(a.calcService=new b.Calc.Service(a)),a.calcService},c.prototype._getCalcContexts=function(){var a=this,b=[],c=a._getModel();return b.push({name:a._name,target:a,refModel:c}),b},c.prototype.updateCalcContexts=function(){var a=this.getCalcService();a&&a.contextChanged()},c.prototype.suspendCalcService=function(a){this.calcService&&this.calcService.suspend(a)},c.prototype.resumeCalcService=function(a){this.calcService&&this.calcService.resume(a)},c.prototype._getSheetSource=function(a){return a===f||a===e||3===a?this._vpSheetSource:e},c.prototype.getCustomFunction=function(a){return this._functions&&a&&""!==a?this._functions[a.toUpperCase()]:e},c.prototype.addCustomFunction=function(a){if(b.util.hasCalc()){if(!(a&&a instanceof b.Calc.Functions.Function))throw new Error(b.SR.Exp_InvalidCustomFunction);var c=this,d=a.name.toUpperCase();c._functions||(c._functions={}),c._functions[d]=a,c.recalcAll()}},c.prototype.removeCustomFunction=function(a){var b=this;b._functions&&a&&""!==a&&(a=a.toUpperCase(),b._functions.hasOwnProperty(a)&&(delete b._functions[a],b.recalcAll()))},c.prototype.clearCustomFunctions=function(){this._functions&&(delete this._functions,this.recalcAll())},c.prototype._findCustomFunction=function(a){if(!a||""===a)return e;var b=this,c=b.parent,d=b.getCustomFunction(a);return!d&&c&&c.getCustomFunction&&(d=c.getCustomFunction(a)),d},c.prototype.addCustomFunctionDescription=function(a){if(a&&a.name&&!this.getCustomFunctionDescription(a.name)){var b=this._functionDescriptions;b||(b=this._functionDescriptions=[]),b.push(a)}},c.prototype.getCustomFunctionDescription=function(a){var b=this._functionDescriptions;if(b&&a){a=a.toUpperCase();for(var c,d=b.length,f=0;d>f;f++)if(c=b[f],c.name&&c.name.toUpperCase()===a)return c}return e},c.prototype.removeCustomFunctionDescription=function(a){var b=this._functionDescriptions;if(b&&a){a=a.toUpperCase();for(var c,d=b.length,e=0;d>e;e++)if(c=b[e],c.name&&c.name.toUpperCase()===a){b.splice(e,1);break}}},c.prototype.clearCustomFunctionDescriptions=function(){this._functionDescriptions&&(this._functionDescriptions=e)},c.prototype.getCustomName=function(a){var b=this._names;return b?b[a]:e},c.prototype.getCustomNames=function(){var a=[],b=this._names;return b&&$.each(b,function(b,c){a.push(c)}),a},c.prototype.addCustomName=function(a,b,c,d){this._addCustomNameCore(a,b,c,d,!1)},c.prototype._addCustomNameCore=function(a,c,d,e,f){if(!a||""===a||!c||""===c)throw new Error(b.SR.Exp_InvalidCustomName);var g=this;g._names||(g._names={});var h=g.getCalcService(),i=g._getSheetSource();if(h&&i){var j;if(f)try{j=h.parse(c,d,e)}catch(k){}else j=h.parse(c,d,e);g._names[a]=new b.NameInfo(a,j,d,e);var l=i._getNameCalc(a,!0);l&&(l.updateListening(!0,!0),l.addToDirty()),g.recalcAll()}},c.prototype.removeCustomName=function(a){var b=this;if(b._names&&a&&""!==a&&b._names.hasOwnProperty(a)){delete b._names[a];var c=b._getSheetSource();if(c){var d=c._getNameCalc(a);d&&(d.updateListening(!0,!1),d.addToDirty())}b.recalcAll()}},c.prototype.clearCustomNames=function(){var a=this;if(a._names){var b=a._names;delete a._names;var c=a._getSheetSource();if(c)for(var d=b.length,e=0;d>e;e++){var f=c._getNameCalc(b[e]);f&&(f.updateListening(!0,!1),f.addToDirty())}a.recalcAll()}},c.prototype._findCustomName=function(a){if(!a||""===a)return e;var b=this,c=b.parent,d=b.getCustomName(a);return!d&&c&&c.getCustomName&&(d=c.getCustomName(a)),d},c.prototype.setFormula=function(a,b,c,d){this._setFormulaCore(a,b,c,!1,d)},c.prototype._setFormulaCore=function(a,c,d,g,h){var i=this;if(1!==h&&2!==h){(h===f||h===e)&&(h=3);var j=b.Events;if(0>a||a>=i.getRowCount()||0>c||c>=i.getColumnCount())return void i._raiseInvalidOperation(0,b.SR.Exp_IndexOutOfRange);var k=i._tableManager;if(3===h&&a>=0&&c>=0&&k){var l=k.find(a,c);if(l){if(l.showHeader()&&a===l.headerIndex()&&d)return;l.showFooter()&&a===l.footerIndex()&&l._setFooterFormula(a,c,d)}}var m=i._getSheetSource(),n=i._conditionalFormats;m&&(m.setFormula(a,c,d,g),n&&n._clearCache(),i._eventHandler._eventSuspended<1&&i._trigger(j.CellChanged,{sheet:i,sheetName:i._name,row:a,col:c,sheetArea:h,propertyName:"formula"})),i._paintSuspended||(i.invalidateLayout(),i.repaint())}},c.prototype.setArrayFormula=function(a,b,c,d,e,f){this._setArrayFormulaCore(a,b,c,d,e,!1,f)},c.prototype._setArrayFormulaCore=function(a,c,d,g,h,i,j){var k=this;k._bindToAutoRefresh(function(a,c,d,g,h,j){if(1!==j&&2!==j){(j===f||j===e)&&(j=3);var l=b.Events;if(0>a||a+d>k.getRowCount()||0>c||c+g>k.getColumnCount())return void k._raiseInvalidOperation(0,b.SR.Exp_IndexOutOfRange);var m=k._tableManager;if(3===j&&a>=0&&c>=0&&m){var n=m.find(a,c);if(n){if(d>1||g>1)return void k._raiseInvalidOperation(0,b.SR.Exp_ArrayFormulaTable);if(n.showHeader()&&a===n.headerIndex()&&h)return;n.showFooter()&&a===n.footerIndex()&&n._setFooterFormula(a,c,h)}}var o=k._getSheetSource(),p=k._conditionalFormats;o&&(o.setArrayFormula(a,c,d,g,h,i),p&&p._clearCache(),k._eventHandler._eventSuspended<1&&k._trigger(l.RangeChanged,{sheet:k,sheetName:k._name,row:a,col:c,rowCount:d,colCount:g,sheetArea:j,propertyName:"formula"}))}})(a,c,d,g,h,j)},c.prototype.getFormula=function(a,b,c){if(c===f||c===e||3===c){var d=this._getSheetSource();if(d)return d.getFormula(a,b)}return e},c.prototype.getFormulaInformation=function(a,c,d){var g=new b.FormulaInformation;if(d===f||d===e||3===d){var h=this._getCalcModel(d);if(h){var i=h.getNode(a,c);if(i&&i.expr){g.hasFormula=!0;var j=i.arrayInfo;j&&(g.baseRange=new b.Range(j.row,j.col,j.rowCount,j.colCount)),g.isArrayFormula=!!i.arrayInfo}}var k=this._getSheetSource();k&&(g.formula=k.getFormula(a,c),g.hasFormula=!!g.formula)}return g},c.prototype.hasFormula=function(a,b,c){if(c===f||c===e||3===c){var d=this._getSheetSource();if(d)return d.hasFormula(a,b)}return!1},c.prototype._findFormulas=function(){},c.prototype._rebuildCalcNodes=function(){var a=this._getCalcModel();if(a){var b=this._getSheetSource();if(b)for(var c=a.nextNonNullRow(-1),d=a.getRowCount(),e=a.getColumnCount();c>=0&&d>c;){for(var f=a.nextNonNullColumn(c,-1);f>=0&&e>f;){var g=b._getCellCalc(c,f);g&&(g.stopListening(),g.startListening()),f++}c++}}},c.prototype.toJSON=function(){var a=this,b=a._bindingManager,c=a._sparklineGroupManager,d=a._commentManager,g=a.getConditionalFormats(),h=a._tableManager,i=a._floatingObjectArray,j=a._rowFilter,k={defaults:a.defaults,columns:a._toArray(a._colInfos,a.getColumnCount()),rows:a._toArray(a._rowInfos,a.getRowCount()),autoGenerateColumns:a.autoGenerateColumns,dataBinding:b?b.toJSON():e,frozenRowCount:a.frozenRowCount,frozenColCount:a.frozenColCount,frozenTrailingRowCount:a._frozenTrailingRowCount,frozenTrailingColCount:a._frozenTrailingColCount,rowCount:a.getRowCount(),columnCount:a.getColumnCount(),sparklineGroupManager:c?c.toJSON():e,commentManager:d?d.toJSON():e,spans:a._spanModel.toJSON(),selectionBackColor:a._selectionBackColor,selectionBorderColor:a._selectionBorderColor,activeRow:a._activeRowIndex,activeCol:a._activeColIndex,gridline:a.gridline,allowCellOverflow:a._allowCellOverflow,referenceStyle:a.referenceStyle(),zoomFactor:a._zoomFactor,theme:a.currentTheme(),showRowRangeGroup:a._showRowRangeGroup,showColumnRangeGroup:a._showColumnRangeGroup,conditionalFormats:g?g.toJSON():e,sheetTabColor:a._sheetTabColor,frozenlineColor:a._frozenlineColor,rowHeaderAutoText:a.rowHeaderAutoText,colHeaderAutoText:a.colHeaderAutoText,rowHeaderAutoTextIndex:a.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:a.colHeaderAutoTextIndex,rowHeaderVisible:a.rowHeaderVisible,colHeaderVisible:a.colHeaderVisible,rowHeaderColCount:a.getColumnCount(2),colHeaderRowCount:a.getRowCount(1),rowHeaderSpan:a._rowHeaderSpanModel.toJSON(),colHeaderSpan:a._colHeaderSpanModel.toJSON(),rowHeaderColInfos:a._toArray(a._rowHeaderColInfos,a.getColumnCount(2)),colHeaderRowInfos:a._toArray(a._colHeaderRowInfos,a.getRowCount(1)),clipBoardOptions:a._clipBoardOptions,isProtected:a.isProtected,borderColor:a.borderColor,borderWidth:a.borderWidth,allowDragDrop:a._allowDragDrop,allowDragFill:a._allowDragFill,allowUndo:a._allowUndo,allowEditorReservedLocations:a._allowEditorReservedLocations,tableManager:h?h.toJSON():e,floatingObjectArray:i?i.toJSON():e,visible:a._visible,rowHeaderData:a._rowHeaderModel.toJSON(2),colHeaderData:a._colHeaderModel.toJSON(1),data:a._dataModel.toJSON(),rowRangeGroup:a.rowRangeGroup.toJSONCore(!0),colRangeGroup:a.colRangeGroup.toJSONCore(!1)},l={name:a._name,selections:a._selectionModel.toJSON(),rowFilter:j?j.toJSON():f};for(var m in k){var n=k[m];a._isDefaultValue(m,n)||(l[m]=n)}var o=[],p=a._namedStyles;if(p)for(var m in p)o.push(p[m]);o.length>0&&(l.namedStyles=o);var q=[],r=a._names;if(r&&a.calcService)for(var s in r)if(a._names.hasOwnProperty(s)){var t=r[s],u=t.getName(),v=t.getRow(),w=t.getColumn(),x=t.getExpression(),y=a.calcService.unparse(x,v,w);q.push({name:u,formula:y,row:v,col:w})}return q.length>0&&(l.names=q),l},c.prototype._isDefaultTheme=function(a){if(!a)return!1;if("Office"===a._name){var c=JSON.stringify(a._themeColor),d=JSON.stringify(b.ThemeColors.Office);if("Calibri"===a._bodyFont&&"Cambria"===a._headingFont&&c===d)return!0}return!1},c.prototype._isDefaultValue=function(a,b){var c=this;switch(a){case"defaults":return b.rowHeight===c._defaultRowHeight&&b.colWidth===c._defaultColWidth&&b.rowHeaderColWidth===c._defaultRowHeaderColWidth&&b.colHeaderRowHeight===c._defaultColHeaderRowHeight;case"columns":return!b||0===b.length;case"rows":return!b||0===b.length;case"autoGenerateColumns":return b===!0;case"dataBinding":return b===e;case"sparklineGroupManager":return b===e;case"commentManager":return b===e;case"frozenRowCount":return 0===b;case"frozenColCount":return 0===b;case"frozenTrailingRowCount":return 0===b;case"frozenTrailingColCount":return 0===b;case"rowCount":return 200===b;case"columnCount":return 20===b;case"selectionBackColor":return"rgba(180,180,200,0.2)"===b;case"selectionBorderColor":return"black"===b;case"activeRow":return 0===b;case"activeCol":return 0===b;case"gridline":return b.color===c._defaultGridLineColor&&b.showHorizontalGridline===c._defaultShowHorizontalGridline&&b.showVerticalGridline===c._defaultShowVerticalGridline;case"allowCellOverflow":return b===!1;case"referenceStyle":return 0===b;case"zoomFactor":return 1===b;case"theme":return c._isDefaultTheme(b);case"showRowRangeGroup":return b===!0;case"showColumnRangeGroup":return b===!0;case"conditionalFormats":return b===e;case"sheetTabColor":return b===e;case"frozenlineColor":return"black"===b;case"rowHeaderAutoText":return 1===b;case"colHeaderAutoText":return 2===b;case"rowHeaderAutoTextIndex":return-1===b;case"colHeaderAutoTextIndex":return-1===b;case"rowHeaderVisible":return b===!0;case"colHeaderVisible":return b===!0;case"rowHeaderColCount":return 1===b;case"colHeaderRowCount":return 1===b;case"rowHeaderColInfos":return!b||0===b.length;case"colHeaderRowInfos":return!b||0===b.length;case"clipBoardOptions":return 0===b;case"isProtected":return b===!1;case"borderColor":return"black"===b;case"borderWidth":return 0===b;case"allowDragDrop":return b===!0;case"allowDragFill":return b===!0;case"allowUndo":return b===!0;case"allowEditorReservedLocations":return b===!0;case"tableManager":return b===e;case"floatingObjectArray":return b===e;case"visible":return b===!0;case"data":return $.isEmptyObject(b);case"rowHeaderData":return $.isEmptyObject(b);case"colHeaderData":return $.isEmptyObject(b);default:return!1}},c.prototype.fromJSON=function(c,d){if(c){1==arguments.length&&(d=!0);var e=this,f=e.isPaintSuspended();e.isPaintSuspended(!0);var g=c.rowCount,h=c.columnCount;try{if(e._name=c.name,c.defaults&&(e.defaults=c.defaults),typeof g===j&&(g=e._defaultRowCount),e.setRowCount(g),typeof h===j&&(h=e._defaultColCount),e.setColumnCount(h),typeof c.activeRow!==j&&(e._activeRowIndex=c.activeRow),typeof c.activeCol!==j&&(e._activeColIndex=c.activeCol),typeof c.frozenRowCount!==j&&e.setFrozenRowCount(c.frozenRowCount),typeof c.frozenColCount!==j&&e.setFrozenColumnCount(c.frozenColCount),typeof c.frozenTrailingRowCount!==j&&e.setFrozenTrailingRowCount(c.frozenTrailingRowCount),typeof c.frozenTrailingColCount!==j&&e.setFrozenTrailingColumnCount(c.frozenTrailingColCount),typeof c.gridline!==j&&(e.gridline=c.gridline),typeof c.allowCellOverflow!==j&&(e._allowCellOverflow=c.allowCellOverflow),typeof c.autoGenerateColumns!==j&&(e.autoGenerateColumns=c.autoGenerateColumns),c.dataSource){var i=e._bindingManager;i&&i.bind(c.dataSource)}if(c.dataBinding){var i=e._bindingManager;i&&i.fromJSON(c.dataBinding)}if(c.rows&&(e._rowInfos=c.rows,e._rowInfos.length=g),c.columns&&(e._colInfos=c.columns,e._colInfos.length=h),c.colStyles)for(var l in c.colStyles)if(!isNaN(l)){var m=parseInt(l,10);e.setStyle(-1,m,c.colStyles[l],3)}if(c.rowStyles)for(var l in c.rowStyles)if(!isNaN(l)){var n=parseInt(l,10);e.setStyle(n,-1,c.rowStyles[l],3)}if(typeof c.rowHeaderAutoText!==j&&(e.rowHeaderAutoText=c.rowHeaderAutoText),typeof c.colHeaderAutoText!==j&&(e.colHeaderAutoText=c.colHeaderAutoText),typeof c.rowHeaderAutoTextIndex!==j&&(e.rowHeaderAutoTextIndex=c.rowHeaderAutoTextIndex),typeof c.colHeaderAutoTextIndex!==j&&(e.colHeaderAutoTextIndex=c.colHeaderAutoTextIndex),typeof c.rowHeaderVisible!==j&&(e.rowHeaderVisible=c.rowHeaderVisible),typeof c.colHeaderVisible!==j&&(e.colHeaderVisible=c.colHeaderVisible),typeof c.rowHeaderColCount!==j&&e.setColumnCount(c.rowHeaderColCount,2),typeof c.colHeaderRowCount!==j&&e.setRowCount(c.colHeaderRowCount,1),c.rowHeaderData&&e._rowHeaderModel.fromJSON(c.rowHeaderData),c.colHeaderData&&e._colHeaderModel.fromJSON(c.colHeaderData),c.rowHeaderSpan&&e._rowHeaderSpanModel.fromJSON(c.rowHeaderSpan),c.colHeaderSpan&&e._colHeaderSpanModel.fromJSON(c.colHeaderSpan),c.rowHeaderColInfos&&(e._rowHeaderColInfos=c.rowHeaderColInfos),c.colHeaderRowInfos&&(e._colHeaderRowInfos=c.colHeaderRowInfos),(typeof c._zoomFactor!==j||typeof c.zoomFactor!==j)&&(e._zoomFactor=typeof c.zoomFactor===j?c._zoomFactor:c.zoomFactor),c.spans&&e._spanModel.fromJSON(c.spans),c.selections&&(e._clearSelectionImp(),e._selectionModel.fromJSON(c.selections)),e.referenceStyle(0),c.data){e._dataModel.fromJSON(c.data);var o=c.data.dataTable;if(d&&o)for(var p in o)if(typeof p!==k)for(var q in o[p])if(typeof q!==k){var r=o[p][q],s=r.formula;s&&(r.arrayInfo?e._setArrayFormulaCore(parseInt(p,10),parseInt(q,10),parseInt(r.arrayInfo.rowCount,10),parseInt(r.arrayInfo.colCount,10),s,!0):e._setFormulaCore(parseInt(p,10),parseInt(q,10),s,!0))}}if(d&&c.sparklineGroupManager){var t=e._sparklineGroupManager;if(t){t.fromJSON(c.sparklineGroupManager);for(var u,v,w=t.groups(),x=e._getModel(),y=0;y<w.length;y++){u=w[y]._innerList;for(var z=0;z<u.length;z++)v=u[z],x.setSparkline(v.row,v.column,v)}}}if(c.commentManager&&e._commentManager.fromJSON(c.commentManager),c.theme){var A=c.theme;if("string"==typeof A||typeof A===j)e.currentTheme(A);else{var B=A.themeColor?A.themeColor:A._themeColor,C=B.colorList?B.colorList:B._colorList,D=B.name?B.name:B._name,E=0,F=1,G=2,H=3,I=4,J=5,K=6,L=7,M=8,N=9,O=10,P=11,Q=C[G],R=C[H],S=C[E],T=C[F],U=C[I],V=C[J],W=C[K],X=C[L],Y=C[M],Z=C[N],$=C[O],_=C[P],ab=new b.ThemeColor(D,new b._Color(Q.a,Q.r,Q.g,Q.b),new b._Color(R.a,R.r,R.g,R.b),new b._Color(S.a,S.r,S.g,S.b),new b._Color(T.a,T.r,T.g,T.b),new b._Color(U.a,U.r,U.g,U.b),new b._Color(V.a,V.r,V.g,V.b),new b._Color(W.a,W.r,W.g,W.b),new b._Color(X.a,X.r,X.g,X.b),new b._Color(Y.a,Y.r,Y.g,Y.b),new b._Color(Z.a,Z.r,Z.g,Z.b),new b._Color($.a,$.r,$.g,$.b),new b._Color(_.a,_.r,_.g,_.b)),bb=new b.SpreadTheme(A.name?A.name:A._name,ab,A.headingFont?A.headingFont:A._headingFont,A.bodyFont?A.bodyFont:A._bodyFont);e.currentTheme(bb)}}if(typeof c.showRowRangeGroup!==j&&(e._showRowRangeGroup=c.showRowRangeGroup),typeof c.showColumnRangeGroup!==j&&(e._showColumnRangeGroup=c.showColumnRangeGroup),c.rowRangeGroup&&e.rowRangeGroup&&e.rowRangeGroup.fromJSON(c.rowRangeGroup),c.colRangeGroup&&e.colRangeGroup&&e.colRangeGroup.fromJSON(c.colRangeGroup),c.rowFilter&&b.features.filter){var cb=new b.HideRowFilter;e._rowFilter=cb,cb.sheet=e,cb.fromJSON(c.rowFilter)}if(c.conditionalFormats&&b.features.conditionalFormat&&e.getConditionalFormats().fromJSON(c.conditionalFormats),c.sheetTabColor&&e.sheetTabColor(c.sheetTabColor),c.frozenlineColor&&e.frozenlineColor(c.frozenlineColor),typeof c.clipBoardOptions!==j&&(e._clipBoardOptions=c.clipBoardOptions),typeof c.isProtected!==j&&(e.isProtected=c.isProtected),c.borderColor&&(e.borderColor=c.borderColor),typeof c.borderWidth!==j&&(e.borderWidth=c.borderWidth),typeof c.allowDragDrop!==j&&(e._allowDragDrop=c.allowDragDrop),typeof c.allowDragFill!==j&&(e._allowDragFill=c.allowDragFill),typeof c.allowUndo!==j&&e.allowUndo(c.allowUndo),typeof c.allowEditorReservedLocations!==j&&e.allowEditorReservedLocations(c.allowEditorReservedLocations),d&&c.names){for(var db=0;db<c.names.length;db++){var eb=c.names[db];e._addCustomNameCore(eb.name,eb.formula,eb.row,eb.col,!0)}e._rebuildCalcNodes()}if(e._namedStyles={},c.namedStyles)for(var y=0;y<c.namedStyles.length;y++){var fb=c.namedStyles[y],gb=new b.Style;if(gb.copyFrom(fb),typeof fb.validator!==j){var hb;b.features.dataValidator&&(hb=new a.spread.DefaultDataValidator,hb.fromJSON(fb.validator)),gb.validator=hb}e._addNamedStyleImp(gb,!1)}c.selectionBackColor&&e.selectionBackColor(c.selectionBackColor),c.selectionBorderColor&&e.selectionBorderColor(c.selectionBorderColor),typeof c.tableManager!==j&&e._tableManager&&e._tableManager.fromJSON(c.tableManager),typeof c.floatingObjectArray!==j&&e._floatingObjectArray&&e._floatingObjectArray.fromJSON(c.floatingObjectArray),d&&typeof c.referenceStyle!==j&&e.referenceStyle(c.referenceStyle),typeof c.visible!==j&&(e._visible=c.visible)}finally{e.isPaintSuspended(f)}}},c.prototype.formulaFromJSON=function(a){var b=this;typeof a.referenceStyle!==j&&b.referenceStyle(a.referenceStyle);var c=a.names;if(c)for(var d=0;d<c.length;d++){var e=c[d];b._addCustomNameCore(e.name,e.formula,e.row,e.col,!0)}var f=a.data;if(f){var g=f.dataTable;if(g)for(var h in g)if(typeof h!==k)for(var i in g[h])if(typeof i!==k){var l=g[h][i],m=l.formula;m&&(l.arrayInfo?b._setArrayFormulaCore(parseInt(h,10),parseInt(i,10),parseInt(l.arrayInfo.rowCount,10),parseInt(l.arrayInfo.colCount,10),m,!0):b._setFormulaCore(parseInt(h,10),parseInt(i,10),m,!0))}}var n=a.sparklineGroupManager;if(n){var o=b._sparklineGroupManager;if(o){o.fromJSON(n);for(var p,q,r=o.groups(),s=b._getModel(),t=0;t<r.length;t++){p=r[t]._innerList;for(var u=0;u<p.length;u++)q=p[u],s.setSparkline(q.row,q.column,q)}}}},c.prototype._toArray=function(a,b){if(!a)return e;for(var c=[],d=0;b>d;d++)a[d]!==f&&(c[d]=a[d]);return c},c.prototype.isPaintSuspended=function(a){var b=this;return 0===arguments.length?b._paintSuspended:(b._paintSuspended!==a&&(b._paintSuspended=a,!a&&b._layoutSuspended<=0&&(!b.parent||b.parent.getActiveSheet&&b.parent.getActiveSheet()===b)&&(b.invalidateLayout(),b.repaint())),b)},c.prototype.getName=function(){return this._name},c.prototype.setName=function(a){var c=this,d=c.parent;if(!c._isValidSheetName(a))throw b.SR.Exp_NotSupport;c._name=a,d&&d._doTabHSResize&&d._doTabHSResize()},c.prototype.visible=function(a){var c=this;if(0==arguments.length)return c._visible;c._visible=a;var d=c.parent;if(d){var e=d.sheets,f=e.length,g=b.util.inArray(c,e),h=d.getActiveSheetIndex();if(-1!=g){if(a)0>h?d.setActiveSheetIndex(g):d._doTabHSResize();else if(g===h){for(var i=g+1;f>i&&!e[i]._visible;)i++;if(i>=f)for(i=g-1;i>=0&&!e[i]._visible;)i--;-1!==i&&i<d._tab._firstTab&&(d._tab._firstTab=i),d.setActiveSheetIndex(i)}else d._doTabHSResize();return c}}},c.prototype.allowCellOverflow=function(a){var b=this;return 0===arguments.length?b._allowCellOverflow:b._bindToAutoRefresh(function(a){return b._allowCellOverflow=a,b})(a)},c.prototype.allowUndo=function(a){var b=this;if(0===arguments.length)return b._allowUndo;b._allowUndo=a;var c=b.undoManager();return c&&(c._allowUndo=a),b},c.prototype.allowEditorReservedLocations=function(a){return 0===arguments.length?this._allowEditorReservedLocations:(this._allowEditorReservedLocations=a,this)},c.prototype.sheetTabColor=function(a){var b=this,c=b.parent;return 0===arguments.length?b._sheetTabColor:(b._sheetTabColor=a,c&&c._doTabHSResize&&c._doTabHSResize(),b)},c.prototype.frozenlineColor=function(a){var b=this;return 0===arguments.length?b._frozenlineColor:b._bindToAutoRefresh(function(a){return a&&(b._frozenlineColor=a),b})(a)},c.prototype.addRows=function(a,c){if(!(0>=c)){var d=this,e=d.getDataSource();if(e&&b._BindingManager.isDataViewSource(e)){if(!e.canAdd||!e.canAdd())return;a=d.getRowCount()}var f=d.isPaintSuspended();d.isPaintSuspended(!0);try{(0>a||a>d.getRowCount())&&(a=d.getRowCount());var g=d._getSheetSource();if(g){if(!d._checkArrayFormula(a,0,0,d.getColumnCount()))return;g.onBeforeAddRemoveRows(a)}var h=d._getModel();h.addElements(d._rowInfos,d.getRowCount(),a,c),h.addRows(a,c);var i=d._cutCopyIndicatorManager;i&&i.addRows();var j=d._bindingManager;j&&j.addItems(a,c);var k=d._getCalcModel();k&&k.addRows(a,c);var l=d._getModel(2);l.addRows(a,c);var m=d._getSpanModel(2);m.addRows(a,c),m=d._getSpanModel(),m.addRows(a,c);var n=d._rowFilter;n&&n._addRows(a,c);var o=d.rowRangeGroup;o&&o._add(a,c);var p=d._sparklineGroupManager;p&&p._addRows(a,c);var q=d._conditionalFormats;q&&q._addRows(a,c);var r=d._tableManager;r&&r.addRows(a,c),g&&g.onAfterAddRows(a,c);var s=d._floatingObjectArray;s&&s.length>0&&s.addRows(a,c);var t=d._commentManager;t&&t.addRows(a,c),d._needSyncScrollbarSize=!0}finally{d.isPaintSuspended(f)}}},c.prototype._onDataDeleted=function(){},c.prototype.deleteRows=function(a,c){var d=this;if(!(0>a||a>=d.getRowCount()||0>=c)){var f=d.getDataSource();if(!f||!b._BindingManager.isDataViewSource(f)||f.canRemove&&f.canRemove()){var g=d.isPaintSuspended();d.isPaintSuspended(!0);try{var h=d._getSheetSource();if(h){if(!d._checkArrayFormula(a,0,c,d.getColumnCount()))return;h.onBeforeAddRemoveRows(a)}var i=d._getModel();if(d.autoUpdate&&d.dataContext&&d.dataContext.remove&&f&&f.length>0){d._dataDeleteDelegate=function(a){return d._onDataDeleted(a)};var j=a;if(j>=0){var k=d.getDataItem(j);$.ajax({url:d.dataContext.remove,type:M,data:JSON.stringify(k),dataType:N,contentType:O,success:d._dataDeleteDelegate})}}d.deletedRows||(d.deletedRows=[]);var l=d._bindingManager;if(l)for(var m=l.getRowCount(),n=0;c>n&&a+n<i.rowCount;n++){var o=e;m>a+n&&(o=l.getDataItem(a+n));var p=e;i.dataTable&&i.dataTable[a+n]&&(p=i.dataTable[a+n].key),d.deletedRows.push({row:a+n,data:o,key:p})}i.deleteElements(d._rowInfos,d.getRowCount(),a,c),i.deleteRows(a,c),l&&l.removeItems(a,c);var q=d._cutCopyIndicatorManager;q&&q.deleteRows();var r=d._getCalcModel();r&&r.deleteRows(a,c);var s=d._getModel(2);s.deleteRows(a,c);var t=d._getSpanModel(2);t.removeRows(a,c),t=d._getSpanModel(),t.removeRows(a,c);var u=d._rowFilter;u&&u._removeRows(a,c);var v=d.rowRangeGroup;v&&v._remove(a,c);var w=d._sparklineGroupManager;w&&w._removeRows(a,c);var x=d._conditionalFormats;x&&x._removeRows(a,c);
var y=d._tableManager;y&&y.removeRows(a,c);var z=d._scrollTopRow;if(z>=0){for(var A=-1,B=z;B>=d.frozenRowCount;B--)if(d.getRowVisible(B)&&d._getZoomRowHeight(B)>0){A=B;break}-1===A&&(A=0),z!==A&&(d._scrollTopRow=A,d._syncVScrollbarPosition(),d._trigger(b.Events.TopRowChanged,{sheet:d,sheetName:d._name,oldTopRow:z,newTopRow:A}))}h&&h.onAfterRemoveRows(a,c);var C=d._floatingObjectArray;C&&C.length>0&&C.removeRows(a,c);var D=d._commentManager;D&&D.removeRows(a,c),d._needSyncScrollbarSize=!0}finally{d.isPaintSuspended(g)}}}},c.prototype.addColumns=function(a,b){if(!(0>=b)){var c=this;c._bindToAutoRefresh(function(a,b){if((0>a||a>c.getColumnCount())&&(a=c.getColumnCount()),!c.parent||!c.parent.gcSpreadsheet){var d=c._getSheetSource();if(d){if(!c._checkArrayFormula(0,a,c.getRowCount(),0))return;d.onBeforeAddRemoveColumns(a)}var e=c._getModel();e.addElements(c._colInfos,c.getColumnCount(),a,b),e.addColumns(a,b);var f=c._cutCopyIndicatorManager;f&&f.addColumns();var g=c._getCalcModel();g&&g.addColumns(a,b);var h=c._getModel(1);h.addColumns(a,b);var i=c._getSpanModel(1);i.addColumns(a,b),i=c._getSpanModel(),i.addColumns(a,b);var j=c._rowFilter;j&&j._addColumns(a,b);var k=c.colRangeGroup;k&&k._add(a,b);var l=c._sparklineGroupManager;l&&l._addColumns(a,b);var m=c._conditionalFormats;m&&m._addColumns(a,b);var n=c._tableManager;n&&n.addColumns(a,b),d&&d.onAfterAddColumns(a,b);var o=c._floatingObjectArray;o&&o.length>0&&o.addColumns(a,b);var p=c._commentManager;p&&p.addColumns(a,b),c._needSyncScrollbarSize=!0}})(a,b)}},c.prototype.deleteColumns=function(a,c){var d=this;0>a||a>=d.getColumnCount()||0>=c||d.parent&&d.parent.gcSpreadsheet||d._bindToAutoRefresh(function(a,c){var e=d._getSheetSource();if(e){if(!d._checkArrayFormula(0,a,d.getRowCount(),c))return;e.onBeforeAddRemoveColumns(a)}var f=d._getModel();f.deleteElements(d._colInfos,d.getColumnCount(),a,c),f.deleteColumns(a,c);var g=d._cutCopyIndicatorManager;g&&g.deleteColumns();var h=d._getCalcModel();h&&h.deleteColumns(a,c);var i=d._getModel(1);i.deleteColumns(a,c);var j=d._getSpanModel(1);j.removeColumns(a,c),j=d._getSpanModel(3),j.removeColumns(a,c);var k=d._rowFilter;k&&k._removeColumns(a,c);var l=d.colRangeGroup;l&&l._remove(a,c);var m=d._sparklineGroupManager;m&&m._removeColumns(a,c);var n=d._conditionalFormats;n&&n._removeColumns(a,c);var o=d._tableManager;o&&o.removeColumns(a,c);var p=d._scrollLeftCol;if(p>=0){for(var q=-1,r=p;r>=d.frozenColCount;r--)if(d.getColumnVisible(r)&&d._getZoomColumnWidth(r)>0){q=r;break}-1===q&&(q=0),p!==q&&(d._trigger(b.Events.LeftColumnChanged,{sheet:d,sheetName:d._name,oldLeftCol:p,newLeftCol:q}),d._scrollLeftCol=q,d._syncHScollbarPosition())}e&&e.onAfterRemoveColumns(a,c);var s=d._floatingObjectArray;s&&s.length>0&&s.removeColumns(a,c);var t=d._commentManager;t&&t.removeColumns(a,c),d._needSyncScrollbarSize=!0})(a,c)},c.prototype.setFrozenCount=function(a,b){(typeof a===j||a===e||0>a||isNaN(a))&&(a=0),(typeof b===j||b===e||0>b||isNaN(b))&&(b=0);var c=this;(c.frozenRowCount!==a||c.frozenColCount!==b)&&c._bindToAutoRefresh(function(a,b){var d=!1;c.frozenRowCount!==a&&(c._scrollTopRow+=a-c.frozenRowCount,c.frozenRowCount=a,d=!0),c.frozenColCount!==b&&(c._scrollLeftCol+=b-c.frozenColCount,c.frozenColCount=b,d=!0),d&&(c._needSyncScrollbarSize=!0)})(a,b)},c.prototype.setFrozenColumnCount=function(a){(typeof a===j||a===e||0>a||isNaN(a))&&(a=0);var b=this;b.frozenColCount!==a&&b._bindToAutoRefresh(function(a){b._scrollLeftCol+=a-b.frozenColCount,b.frozenColCount=a,b._needSyncScrollbarSize=!0})(a)},c.prototype.setFrozenRowCount=function(a){(typeof a===j||a===e||0>a||isNaN(a))&&(a=0);var b=this;b.frozenRowCount!==a&&b._bindToAutoRefresh(function(a){b._scrollTopRow+=a-b.frozenRowCount,b.frozenRowCount=a,b._needSyncScrollbarSize=!0})(a)},c.prototype.setFrozenTrailingRowCount=function(a){(typeof a===j||a===e||0>a||isNaN(a))&&(a=0);var b=this;b._frozenTrailingRowCount!==a&&b._bindToAutoRefresh(function(a){b._frozenTrailingRowCount=a,b._needSyncScrollbarSize=!0})(a)},c.prototype.setFrozenTrailingColumnCount=function(a){(a===f||a===e||0>a||isNaN(a))&&(a=0);var b=this;b._frozenTrailingColCount!==a&&b._bindToAutoRefresh(function(a){b._frozenTrailingColCount=a,b._needSyncScrollbarSize=!0})(a)},c.prototype.getRowCount=function(a){var b=this._getModel(a);return b&&b.rowCount||0},c.prototype.getColumnCount=function(a){var b=this._getModel(a);return b&&b.colCount||0},c.prototype.setRowCount=function(a,b){if(a=parseInt(a,10),!isNaN(a)){var c=this;0>a||a===c.getRowCount(b)||c._bindToAutoRefresh(function(a,b){if((b===f||b===e)&&(b=3),3===b||2===b)c._dataModel.rowCount>a&&c.deleteRows(a,c._dataModel.rowCount-a),c._dataModel.rowCount=c._rowHeaderModel.rowCount=a,c._calcDataModel&&(c._calcDataModel.rowCount=a),c.frozenRowCount>a&&c.setFrozenRowCount(a),c._rowInfos||(c._rowInfos={}),c.rowRangeGroup&&c.rowRangeGroup._setCount(a);else if(1===b){c._colHeaderRowInfos||(c._colHeaderRowInfos={});var d=c._colHeaderModel;d.rowCount>a&&d.deleteElements(c._colHeaderRowInfos,d.rowCount,a,d.rowCount-a),d.rowCount=a}c._needSyncScrollbarSize=!0,c._activeRowIndex>=a&&(3===b||2===b)&&(c._clearSelectionImp(),c._setActiveCellImp(-1,-1,c.activeRowViewportIndex,c.activeColViewportIndex))})(a,b)}},c.prototype.setColumnCount=function(a,b){if(a=parseInt(a,10),!isNaN(a)){var c=this;0>a||a===c.getColumnCount(b)||c._bindToAutoRefresh(function(a,b){if((b===f||b===e)&&(b=3),3===b||1===b)c._dataModel.colCount>a&&c.deleteColumns(a,c._dataModel.colCount-a),c._dataModel.colCount=c._colHeaderModel.colCount=c._colFooterModel.colCount=a,c._calcDataModel&&(c._calcDataModel.colCount=a),c.frozenColCount>a&&c.setFrozenColumnCount(a),c._colInfos||(c._colInfos={}),c.colRangeGroup&&c.colRangeGroup._setCount(a);else if(2===b){c._rowHeaderColInfos||(c._rowHeaderColInfos={});var d=c._rowHeaderModel;d.colCount>a&&d.deleteElements(c._rowHeaderColInfos,d.colCount,a,d.colCount-a),d.colCount=a}c._needSyncScrollbarSize=!0,c._activeColIndex>=a&&(3===b||1===b)&&(c._clearSelectionImp(),c._setActiveCellImp(-1,-1,c.activeRowViewportIndex,c.activeColViewportIndex))})(a,b)}},c.prototype.getText=function(a,b,c){(typeof c===j||c===e)&&(c=3);var d=this,f=d.getValue(a,b,c);if(f===e||typeof f===j)return"";var g=d.getCellType(a,b,c),h=d.getActualStyle(a,b,c),i=h.formatter?h.formatter:h._autoFormatter,k={sheet:d,row:a,col:b,sheetArea:c};return f=g.format(f,i,k)},c.prototype.setText=function(a,b,c,d){var g=this;g._bindToAutoRefresh(function(a,b,c,d){(d===f||d===e)&&(d=3);var h=c,i=g.getCellType(a,b,d),j=g.getCell(a,b,d).formatter();if(i&&j){var k={sheet:g,row:a,col:b,sheetArea:d};h=i.parse(c,j,k)}g.setValue(a,b,h,d)})(a,b,c,d)},c.prototype.getValue=function(a,c,d){(typeof d===j||d===e)&&(d=3);var f=this,g=f._getModel(d);if(!g)return e;var h,i=f._getValueImp(g,a,c,d);if(1===d){if(typeof i===j||i===e){var k=f.getDataSource();if(k){var l=window.ko;if(b._BindingManager.isDataViewSource(k)||k.length>0||l&&l.isObservable(k)){var m=f._colInfos[c],n=f.colHeaderAutoTextIndex;m&&(n>=0&&a===n||-1===n&&a===g.rowCount-1)&&(i=m.displayName||m.name)}}if((typeof i===j||i===e)&&(h=f.colHeaderAutoTextIndex,(0>h||h>=g.rowCount)&&(h=g.rowCount-1),a===h)){var o=f.colHeaderAutoText;2===o?i=f._indexToLetters(c+1):1===o&&(i=c+1)}}}else if(2===d&&(typeof i===j||i===e)&&(h=f.rowHeaderAutoTextIndex,(0>h||h>=g.colCount)&&(h=g.colCount-1),c===h)){var p=f.rowHeaderAutoText;2===p?i=f._indexToLetters(a+1):1===p&&(i=a+1)}return i},c.prototype._getCurrentValue=function(a,b){var c=this;return c._isValidatingCell&&c._validatingRow===a&&c._validatingColumn===b?c._validatingValue:c.getValue(a,b)},c.prototype._getValuesForCalc=function(a,b,c,d,e,f,g){var h=this,i=h._getModel();if(i){for(var j,k,l=h.getRowCount(),m=h.getColumnCount(),n=(h._getValueImp(i,b,c,3),0);d>n;n++){j=(n+b)%l;for(var o=0;e>o;o++)k=(o+c)%m,a[0][f+n][g+o]=h._getValueImp(i,j,k,3)}h._isValidatingCell&&h._validatingRow>=b&&h._validatingRow<b+d&&h._validatingColumn>=c&&h._validatingColumn<c+e&&(a[0][f+h._validatingRow][g+h._validatingColumn]=h._validatingValue)}},c.prototype.setValue=function(a,b,c,d,e){this._setValueInternal(a,b,c,d,e),this.invalidate()},c.prototype._setValueInternal=function(a,c,d,f,g){(typeof f===j||f===e)&&(f=3);var h=this,i=h._getModel(f);if(i){var k=i.rowCount,l=i.colCount;if(!(0>a||a>=k||0>c||c>=l)){var m=3===f;typeof d!==j&&d!==e&&d.constructor===Date&&((void 0==h.getCell(a,c).formatter()||"General"==h.getCell(a,c).formatter())&&h.getCell(a,c).formatter("d-mmm-yy;;"),d="/OADate("+new b._DateTimeHelper(d).toOADate()+")/");var n=h._tableManager;if(m&&n&&n._tableList.length>0){var o=n.find(a,c);if(o)if(o.showHeader()&&a===o.headerIndex()){if(o._hasColumnName(d))return;o._setHeader(a,c,d)}else o.showFooter()&&a===o.footerIndex()&&o._setFooterValue(a,c,d)}var p,q=h._eventHandler._eventSuspended>0;if(q||(p=h._getValueImp(i,a,c,f)),m){var r=!1,s=h._bindingManager;s&&s._dataSource&&(r=s.setValue(a,c,d)),(!r||h.checkingChanges)&&(i.setValue(a,c,d),h._activeRowDirty=!0)}else i.setValue(a,c,d);m&&!g&&h._recalcCell(i,a,c);var t=h._conditionalFormats;t&&t._clearCache(),q||p===d||h._trigger(b.Events.CellChanged,{sheet:h,sheetName:h._name,row:a,col:c,sheetArea:f,propertyName:F,_oldValue:p})}}},c.prototype.sortRange=function(a,c,d,e,f,g){var h=this;return h._bindToAutoRefresh(function(a,c,d,e,f,g){var i=h.isPaintSuspended();h.isPaintSuspended(!0),h.suspendEvent(),h.suspendCalcService();try{var j=h.getSpans(new b.Range(a,c,d,e));if(j&&j.length>0)return!1;var k,l,m,n,o,p,q,s,t,u,v,w=h.getRowCount(),x=h.getColumnCount();if(-1===a&&(a=0),-1===d&&(d=w),-1===c&&(c=0),-1===e&&(e=x),0>a||a>=w||0>c||c>=x||0>d||a+d>w||0>e||c+e>x||!g)return!1;if(q=h._quickSort(a,c,d,e,f,g)){var y,z,A,B=h._getModel(),C=h._getCalcModel(),D=h._getSheetSource();if(f){for(l=a;a+d>l;l++)if(y=h._getSwapIndex(q,a,l),l!==y)for(m=l,o=y,k=c;c+e>k;k++){if(n=k,s=h.getValue(m,n),t=h.getValue(o,n),u=h.getComment(m,n),v=h.getComment(o,n),C&&D){var E=D._getCellCalc(m,n,!1);E&&E.hasListeners()&&E.addListenersToAdjust();var F=D._getCellCalc(o,n,!1);F&&F.hasListeners()&&F.addListenersToAdjust(),C.swapNode(m,n,o,n),z=r._copyExpression(C.getExpr(m,n),m,n,0,0),C.setFormula(m,n,z),A=D._getCellCalc(m,n,!!z),A&&A.startListening(),z=r._copyExpression(C.getExpr(o,n),o,n,0,0),C.setFormula(o,n,z),A=D._getCellCalc(o,n,!!z),A&&A.startListening(),D._controller.adjustFormulasOnSwap(C,m,n,C,o,n,1,1)}B.swapNode(m,n,o,n),h.setComment(m,n,v),h.setComment(o,n,u),h.setValue(m,n,t),h.setValue(o,n,s)}}else for(k=c;c+e>k;k++)if(y=h._getSwapIndex(q,c,k),k!==y)for(n=k,p=y,l=a;a+d>l;l++){if(m=l,s=h.getValue(m,n),t=h.getValue(m,p),u=h.getComment(m,n),v=h.getComment(m,p),C&&D){var E=D._getCellCalc(m,n,!1);E&&E.hasListeners()&&E.addListenersToAdjust();var F=D._getCellCalc(m,p,!1);F&&F.hasListeners()&&F.addListenersToAdjust(),C.swapNode(m,n,m,p),z=r._copyExpression(C.getExpr(m,n),m,n,0,0),C.setFormula(m,n,z),A=D._getCellCalc(m,n,!!z),A&&A.startListening(),z=r._copyExpression(C.getExpr(m,p),m,p,0,0),C.setFormula(m,p,z),A=D._getCellCalc(m,p,!!z),A&&A.startListening(),D._controller.adjustFormulasOnSwap(C,m,n,C,m,p,1,1)}B.swapNode(m,n,m,p),h.setComment(m,n,v),h.setComment(m,p,u),h.setValue(m,n,t),h.setValue(m,p,s)}return!0}return!1}finally{h.resumeCalcService(),h.resumeEvent(),h.isPaintSuspended(i),h._raiseRangeDataChanged(a,c,d,e)}})(a,c,d,e,f,g)},c.prototype.getActualStyle=function(a,c,d,f){(typeof d===j||d===e)&&(d=3);var g,h=this,i=h.getCompositeStyle(a,c,d);if(3===d&&!f){var k=i.formatter;if(k&&k.HasFormatedColor&&k.HasFormatedColor()){var l={value:e};k.Format(h.getValue(a,c),l),l.value&&(g=new b.Style,g.foreColor=l.value)}var m=h._conditionalFormats;if(m&&m.count()>0){var n,o=m.getRules(a,c),p=o.length,q=e;if(p>0){g||(g=new b.Style),o.sort(function(a,b){return a.priority()-b.priority()});for(var r=0;p>r&&(n=o[r],!(n&&(n.isScaleRule()?(n instanceof b.TwoScaleRule||n instanceof b.ThreeScaleRule)&&(q=n.evaluate(h,a,c,h.getValue(a,c,d)),q&&(g.backColor=q)):(q=n.evaluate(h,a,c,h.getValue(a,c,d)),q&&g.compose(q)),n.stopIfTrue()&&q)));r++);}}}return g?g.compose(i):g=i,(typeof g.locked===j||g.locked===e)&&(g.locked=!0),g._normalize(h._currentTheme)},c.prototype.getStyleProperty=function(a,c,d,g){(typeof g===j||g===e)&&(g=3);var h,i,k,l=this,m=l._getModel(g);if(!m)return f;var n,o=!1;if(3===g){if("foreColor"===d){var p=l.getStyleProperty(a,c,"formatter",g);if(p&&p.HasFormatedColor&&p.HasFormatedColor()){var q={value:e};p.Format(l.getValue(a,c),q),q.value&&(n=q.value,o=!0)}}var r=l._conditionalFormats;if(r&&r.count()>0){var s,t=r.getRules(a,c),u=t.length,v=e;if(u>0){t.sort(function(a,b){return a.priority()-b.priority()});for(var w=0;u>w;w++)if(s=t[w]){if(s.isScaleRule()){if("backColor"===d&&(s instanceof b.TwoScaleRule||s instanceof b.ThreeScaleRule)&&(v=s.evaluate(l,a,c,l.getValue(a,c,g)))){n=v,o=!0;break}}else if(v=s.evaluate(l,a,c,l.getValue(a,c,g)),v&&v[d]!==f){n=v[d],o=!0;break}if(s.stopIfTrue()&&v)break}}}}for(var x=0;!o&&4>=x;){if(0===x)h=m.getStyle(a,c);else if(1===x){var y=l._tableManager;if(y&&y.getCount()>0&&3===g){var z=y.find(a,c);z&&(h=new b.Style,z._compose(a,c,h))}}else h=2===x?m.getStyle(a,-1):3===x?m.getStyle(-1,c):l.getDefaultStyle();if(x++,h){if(h.charAt&&"string"==typeof h&&(h=l._name2Style(h)),h[d]!==f){n=h[d],o=!0;break}for(i=h.parentName;i&&(k=l._name2Style(i));){if(k[d]!==f){n=k[d],o=!0;break}i=k.parentName}}}if("locked"===d)return n===f||n===e?!0:n;if(o){if("foreColor"===d||"backColor"===d||"font"===d||"borderLeft"===d||"borderTop"===d||"borderRight"===d||"borderBottom"===d){if(h=new b.Style,h[d]=n,"font"===d){var A=l.getStyleProperty(a,c,"themeFont",g);h.themeFont=A}h._normalize(l._currentTheme),n=h[d]}return n}return f},c.prototype.getStyle=function(a,c,d){(d===f||d===e)&&(d=3);var g=this._getModel(d);if(g){var h=g.getStyle(a,c);if(h instanceof b.Style)return h;if("string"==typeof h){var i=this._name2Style(h);if(i!==e){var j=new b.Style;return j.compose(i),j}}}return e},c.prototype.addNamedStyle=function(a){this._addNamedStyleImp(a,!0)},c.prototype._addNamedStyleImp=function(a,c){if(a!==e&&a!==f){if(a.name===e||a.name===f||""===a.name)throw new Error(b.SR.Exp_EmptyNamedStyle);if(c)this._bindToAutoRefresh(function(a){var b=a.name.toUpperCase();this._namedStyles[b]=a})(a);else{var d=a.name.toUpperCase();this._namedStyles[d]=a}}},c.prototype.getNamedStyle=function(a){var b=this._namedStyles;return b&&a?(a=a.toUpperCase(),b[a]||e):e},c.prototype.getNamedStyles=function(){var a=[],b=this._namedStyles;return b&&$.each(b,function(b,c){a.push(c)}),a},c.prototype.removeNamedStyle=function(a){var b=this;b._namedStyles&&a!==f&&a!=e&&""!==a&&(a=a.toUpperCase(),b._namedStyles.hasOwnProperty(a)&&(delete b._namedStyles[a],b.invalidate()))},c.prototype.setStyle=function(a,b,c,d){this.setStyleObject(a,b,c,d),this.invalidate()},c.prototype.getStyleName=function(a,c,d){var e=this.getStyleObject(a,c,d);return e instanceof b.Style?e.name:e},c.prototype.setStyleName=function(a,b,c,d){"string"==typeof c&&(this.setStyleObject(a,b,c,d),this.invalidate())},c.prototype.getStyleObject=function(a,b,c){(c===f||c===e)&&(c=3);var d=e,g=this._getModel(c);return g&&(d=g.getStyle(a,b),d!==f&&d!==e)?d:e},c.prototype.setStyleObject=function(a,c,d,f){(typeof f===j||f===e)&&(f=3);var g=this,h=g._getModel(f);if(h){if(h.setStyle(a,c,d),d&&d.formatter&&b.features.formatter){var i=d.formatter;i&&typeof i.Init===k&&i.Init()}var l="[styleinfo]";-1!==a&&-1!==c?g._trigger(b.Events.CellChanged,{sheet:g,sheetName:g._name,row:a,col:c,sheetArea:f,propertyName:l}):-1!==a&&-1===c?g._trigger(b.Events.RowChanged,{sheet:g,sheetName:g._name,row:a,sheetArea:f,propertyName:l}):-1===a&&-1!==c&&g._trigger(b.Events.ColumnChanged,{sheet:g,sheetName:g._name,col:c,sheetArea:f,propertyName:l})}},c.prototype.getDefaultStyle=function(a){(typeof a===j||a===e)&&(a=3);var c=this._composedDefaultStyle,d=c[a];if(d)return d;var f=this._getModel(a);if(f){var g=f.getStyle(-1,-1);"string"==typeof g&&(g=this._name2Style(g)),g||(g=new b.Style,f.setStyle(-1,-1,g));var h=1===a||2===a;return g.foreColor||(g.foreColor="#000000"),typeof g.hAlign===j&&(g.hAlign=h?1:3),typeof g.vAlign===j&&(g.vAlign=h?1:0),typeof g.imeMode===j&&(g.imeMode=1),c[a]=g,g}return e},c.prototype.setDefaultStyle=function(a,b){(typeof b===j||b===e)&&(b=3);var c=this._getModel(b);c&&c.setStyle(-1,-1,a),this._composedDefaultStyle[b]=e},c.prototype._name2Style=function(a){var b=this.getNamedStyle(a);if(b)return b;var c=this.parent;return c&&c.getNamedStyle?c.getNamedStyle(a):e},c.prototype.getCompositeStyle=function(a,c,d){(typeof d===j||d===e)&&(d=3);var f,g,h=this,i=new b.Style,k=!1,l=h._getModel(d);if(l){var m,n=l.rowCount,o=l.colCount;if(a>=0&&n>a&&c>=0&&o>c&&(m=l.getStyle(a,c),m&&m.charAt&&(m=h._name2Style(m)),m))for(i.compose(m,!0),k=!0,g=m.parentName;g&&(f=h._name2Style(g));)i.compose(f),g=f.parentName;var p=h._tableManager;if(p&&p.getCount()>0&&3===d){var q=p.find(a,c);q&&(q._compose(a,c,i),k=!0)}if(a>=0&&n>a&&(m=l.getStyle(a,-1),m&&m.charAt&&(m=h._name2Style(m)),m))for(i.compose(m,!k),k=!0,g=m.parentName;g&&(f=h._name2Style(g));)i.compose(f),g=f.parentName;if(c>=0&&o>c&&(m=l.getStyle(-1,c),m&&m.charAt&&(m=h._name2Style(m)),m))for(i.compose(m,!k),k=!0,g=m.parentName;g&&(f=h._name2Style(g));)i.compose(f),g=f.parentName}var r=h.getDefaultStyle(d);if(r&&r.charAt&&(r=h._name2Style(r)),r)for(i.compose(r,!k),g=r.parentName;g&&(f=h._name2Style(g));)i.compose(f),g=f.parentName;return i},c.prototype.getCellType=function(a,b,c){return this.getStyleProperty(a,b,"cellType",c)||this.getDefaultCellType(c)},c.prototype.getDefaultCellType=function(a){(typeof a===j||a===e)&&(a=3);var c=this._defaultCellType;return c||(c=this._defaultCellType=new b.TextCellType),3===a?c:1===a?new b.ColumnHeaderCellType:2===a?new b.RowHeaderCellType:0===a?new b.CornerCellType:c},c.prototype.setCellType=function(a,c,d,e){var f=this.getStyle(a,c,e);f||(f=new b.Style),f.cellType=d,this.setStyle(a,c,f,e)},c.prototype.getFormatter=function(a,b,c){return this.getStyleProperty(a,b,"formatter",c)},c.prototype.setFormatter=function(a,c,d,e){var f=this.getStyle(a,c,e);f||(f=new b.Style),f.formatter=d,this.setStyle(a,c,f,e)},c.prototype.getDataValidator=function(a,b,c){return this.getStyleProperty(a,b,"validator",c)},c.prototype.setDataValidator=function(a,c,d,g){(g===f||g===e)&&(g=3);var h=this,i=h.getStyle(a,c,g);i||(i=new b.Style),i.validator=d,h.suspendEvent(),h.setStyle(a,c,i,g),h.resumeEvent(),b.features.conditionalFormat&&d&&(d.condition instanceof b.FormulaCondition&&(d.condition._baseRow===f||d.condition._baseRow===e)&&(d.condition._baseRow=-1!==a?a:0),d.condition instanceof b.FormulaCondition&&(d.condition._baseCol===f||d.condition._baseCol===e)&&(d.condition._baseCol=-1!==c?c:0));var j=b.Events,k="validator";h._trigger(j.CellChanged,{sheet:h,sheetName:h._name,row:a,col:c,sheetArea:g,propertyName:k}),-1!==a&&-1===c?h._trigger(j.RowChanged,{sheet:h,sheetName:h._name,row:a,sheetArea:g,propertyName:k}):-1===a&&-1!==c&&h._trigger(j.ColumnChanged,{sheet:h,sheetName:h._name,col:c,sheetArea:g,propertyName:k})},c.prototype.isValid=function(a,b,c){try{var d=this;d._validatingRow=a,d._validatingColumn=b,d._validatingValue=c,d._isValidatingCell=!0;var f=d.getDataValidator(a,b);if(f)return f.isValid(d,a,b,c)}finally{d._validatingRow=-1,d._validatingColumn=-1,d._validatingValue=e,d._isValidatingCell=!1}return!0},c.prototype.addSelection=function(a,c,d,e){var f=this;f._bindToAutoRefresh(function(a,c,d,e){var g=a,h=c,i=d,j=e;if(-1!==g&&-1!==h){var k=f._getSpanModel().slice(0);if(k&&k.length>0){var l=f._cellRangeInflate(k,new b.Range(a,c,d,e));g=l.row,h=l.col,i=l.rowCount,j=l.colCount}}f._selectionModel.add(g,h,i,j)})(a,c,d,e)},c.prototype.setSelection=function(a,b,c,d){var e=this,f=e.getRowCount(),g=e.getColumnCount();a>=f&&(a=f-1);var h=a;0>h&&(h=0);var i=b;b>=g&&(b=g-1),0>i&&(i=0),e._clearSelectionImp(),e._setActiveCellImp(h,i),e.addSelection(a,b,c,d)},c.prototype.getSelections=function(){return this._selectionModel},c.prototype._addSpanImp=function(a,c,d,g,h){var i=this;i._bindToAutoRefresh(function(a,c,d,g,h){(h===f||h===e)&&(h=3);var j=i._getSpanModel(h);j.clear(a,c,d,g);var k=new b.Range(a,c,d,g),l=i._getActualRange(k,h);if(j.push(l),3===h)for(var m=i.getSelections(),n=0;n<m.length;n++)m[n].intersect(a,c,d,g)&&(m[n]=m[n].union(k))})(a,c,d,g,h)},c.prototype.addSpan=function(a,c,d,e,f){if((1!==d||1!==e)&&0!==f){var g=!0;if((3===f||void 0===f)&&(g=this._checkArrayFormula(a,c,d,e,!1)),g)for(var h=this._getSpanModel(f),i=h.getEnumerator(a,c,d,e);i.moveNext();){var j=i.current(),k=new b.Range(a,c,d,e);if(!k.containsRange(j)){g=!1;break}}if(!g)throw new Error(b.SR.Exp_InvalidRange);this._addSpanImp(a,c,d,e,f)}},c.prototype.removeSpan=function(a,b,c){this._bindToAutoRefresh(function(a,b,c){(c===f||c===e)&&(c=3);for(var d=this._getSpanModel(c),g=0;g<d.length;g++){var h=d[g];if(h.row===a&&h.col===b)return void d.splice(g,1)}})(a,b,c)},c.prototype.repaint=function(a){this._paintSuspended||this._render.repaint(a)},c.prototype.startEdit=function(a,b){var c=this;c._startEditImp(c._getCanvas(),c._activeRowIndex,c._activeColIndex,e,e,a,b)},c.prototype.editorStatus=function(){return this._editorStatus?this._editorStatus:0},c.prototype.isEditing=function(){return 1===this._editorStatus||2===this._editorStatus},c.prototype.doKeyDown=function(a){this._eventHandler.doKeyDown(a)},c.prototype.doKeyUp=function(a){this._eventHandler.doKeyUp(a)},c.prototype.doCompositionStart=function(){this._eventHandler.doCompositionStart()},c.prototype.removeKeyMap=function(a,b,c,d,e){var f=this.keyMap;if(f){e="function"==typeof e?!1:e;for(var g=0;g<f.length;g++){var h=f[g];if(h&&h.key===a&&h.ctrl===b&&h.shift===c&&h.alt===d&&h.meta===e){f.splice(g,1);break}}}},c.prototype.removeFloatingObjectKeyMap=function(a,b,c,d,e,f){var g=this.floatingObjectKeyMap;if(g)for(var h=f&&e||!1,i=f||e,e=h,f=i,j=0;j<g.length;j++){var k=g[j];if(k&&k.key===a&&k.ctrl===b&&k.shift===c&&k.alt===d&&k.meta===e){g.splice(j,1);break}}},c.prototype.removeCommentKeyMap=function(a,b,c,d,e,f){var g=this;if(g._commentKeyMap)for(var h=f&&e||!1,i=f||e,e=h,f=i,j=0;j<g._commentKeyMap.length;j++){var k=g._commentKeyMap[j];if(k&&k.key===a&&k.ctrl===b&&k.shift===c&&k.alt===d&&k.meta===e){g._commentKeyMap.splice(j,1);break}}},c.prototype.addKeyMap=function(a,c,d,e,f,g){var h=this;h.keyMap||(h.keyMap=[]);var i=g&&f||!1,j=g||f,f=i,g=j,k=h._getKeyAction(a,c,d,e,f);k?k.action=g:h.keyMap.push(new b.KeyMap(a,c,d,e,f,g))},c.prototype.addFloatingObjectKeyMap=function(a,c,d,e,f,g){var h=this;h.floatingObjectKeyMap||(h.floatingObjectKeyMap=[]);var i=g&&f||!1,j=g||f,f=i,g=j,k=h._getFloatingObjectKeyAction(a,c,d,e,f);k?k.action=g:h.floatingObjectKeyMap.push(new b.KeyMap(a,c,d,e,f,g))},c.prototype.addCommentKeyMap=function(a,c,d,e,f,g){var h=this;h._commentKeyMap||(h._commentKeyMap=[]);var i=g&&f||!1,j=g||f,f=i,g=j,k=h._getCommentKeyAction(a,c,d,e,f);k?k.action=g:h._commentKeyMap.push(new b.KeyMap(a,c,d,e,f,g))},c.prototype._moveFormulaTextBoxCell=function(a,c,d,f){var g=this,h=g._formulaTextBox;if(h&&h.canAppendRange()){var i=g._getKeyboardAppendingInfo(),k=i.anchorRow,l=i.anchorCol,m=i.leadingRow,n=i.leadingCol;(typeof d===j||d===e)&&(d=k),(typeof f===j||f===e)&&(f=l);var o,p,q,r,s,t=g._eventHandler;switch(a){case 3:case 4:if(s=3===a?g._getMoveLeftCell(d,f,c,m):g._getMoveRightCell(d,f,c,m),!s)return;if(o=s.row,p=s.col,q=s.leadingCellRow,!g._canMoveCurrentTo(o,p))return;i.anchorRow=o,i.anchorCol=p,i.leadingRow=q,i.leadingCol=p;var u=t.rangeToString(new b.Range(o,p,1,1));u&&h.appendRange(u,!1,!0);break;case 1:case 2:if(s=1===a?g._getMoveUpCell(d,f,c,n):g._getMoveDownCell(d,f,c,n),!s)return;if(o=s.row,p=s.col,r=s.leadingCellCol,!g._canMoveCurrentTo(o,p))return;i.anchorRow=o,i.anchorCol=p,i.leadingRow=o,i.leadingCol=r;var u=t.rangeToString(new b.Range(o,p,1,1));u&&h.appendRange(u,!1,!0)}o>=0&&p>=0&&g._scrollByMoveCell(o,p)}},c.prototype._changeFormulaTextBoxActiveRange=function(a,c){var d=this,e=d._formulaTextBox;if(e&&e.canAppendRange()){var f,g=d._eventHandler,h=d._getKeyboardAppendingInfo(),i=h.anchorRow,j=h.anchorCol;if(e.isAppending()){var k=e.getActiveRange();f=g.stringToRange(k.text)}else f=new b.Range(i,j,1,1);if(f){var l=d._getKeyboardSelectedRange(f,a,c,i,j),m=g.rangeToString(l);m&&e.appendRange(m,!0,!1)}}},c.prototype._getKeyboardAppendingInfo=function(){var a,b=this,c=b._formulaTextBox,d=b._eventHandler;return a=c.isAppending()?d._formulaRangeAppendingInfo:d._formulaRangeAppendingInfo={anchorRow:b._activeRowIndex,anchorCol:b._activeColIndex,leadingRow:b._leadingCellRow,leadingCol:b._leadingCellCol}},c.prototype.moveActiveCell=function(a,c,d,g){var h=this,i={sheet:h,sheetName:h._name,row:h._activeRowIndex,col:h._activeColIndex,cancel:!1};if(h._trigger(b.Events.LeaveCell,i),(!i||i.cancel!==!0)&&h.endEdit()){h._activeRowDirty&&(h.updateRecord(),h._activeRowDirty=!1);var j=h._activeRowIndex,k=h._activeColIndex;(d===f||d===e)&&(d=h._activeRowIndex),(g===f||g===e)&&(g=h._activeColIndex);{b.Direction}3===a?h._moveActiveCellLeft(d,g,c):4===a?h._moveActiveCellRight(d,g,c):1===a?h._moveActiveCellUp(d,g,c):2===a&&h._moveActiveCellDown(d,g,c),h.moveActiveCellEnd(a,j,k)}},c.prototype._moveActiveCellInSelection=function(a){var c=this,d={sheet:c,sheetName:c._name,row:c._activeRowIndex,col:c._activeColIndex,cancel:!1};if(c._trigger(b.Events.LeaveCell,d),!d||d.cancel!==!0){c.endEdit(),c._activeRowDirty&&(c.updateRecord(),c._activeRowDirty=!1);var e=c._activeRowIndex,f=c._activeColIndex;3===a?c._moveActiveCellLeftInSelection(c._activeRowIndex,c._activeColIndex):4===a&&c._moveActiveCellRightInSelection(c._activeRowIndex,c._activeColIndex),c.moveActiveCellEnd(a,e,f)}},c.prototype.doDataItemChanged=function(){var a=this._bindingManager;a&&a.doDataItemChanged()},c.prototype.moveActiveCellEnd=function(a,c,d){var e=this,f=e._eventHandler,g=e._selectionModel.toArray(),i=!1;if(!e.shift&&!e._isNavigateInSelection){var j=e._fixRange(e._getActiveSelectedRange());(e._selectionModel.length>1||j.rowCount>1||j.colCount>1)&&(i=!0),e._clearSelectionImp()}var k=e._activeRowIndex,l=e._activeColIndex,m=e._spanModel.find(k,l);if(m?(e._activeRowCount=m.rowCount,e._activeColCount=m.colCount):(e._activeRowCount=1,e._activeColCount=1),!e._isNavigateInSelection){var n=e._getExtendedRange(k,l),o=e.selectionPolicy(),p=e.selectionUnit();0===o?e._selectionModel.clear():1===o&&e._selectionModel.clear(),1===p?(n.col=-1,n.colCount=-1):2===p&&(n.row=-1,n.rowCount=-1),e._replaceActiveSelectedRange(n.row,n.col,n.rowCount,n.colCount,!1);var q=e._selectionModel.toArray();if(f._notEqualSelecions(g,q)){var r=b.Events;e._trigger(r.SelectionChanging,{sheet:e,sheetName:e._name,oldSelections:g,newSelections:q}),e._trigger(r.SelectionChanged,{sheet:e,sheetName:e._name})}}var s=e._scrollTopRow;e._scrollByMoveCell(k,l),c!=k&&e.doDataItemChanged();var t=e._render;if(i){var u=e._getSheetLayout(),v=u.headerX,w=u.headerY,x=u.width-v,y=u.height-w;t.copyDoubleBuffer(v,w,x,y),t.repaint(new b.Rect(v,w,x,u.colHeaderHeight)),t.repaint(new b.Rect(v,w,u.rowHeaderWidth,y)),t.paintAdornment(t._getCtx())}else{var z,A,B=e._spanModel.find(c,d);B?(z=B.rowCount,A=B.colCount):(z=1,A=1),t.repaintSelection(new b.Range(k,l,e._activeRowCount,e._activeColCount).union(new b.Range(c,d,z,A)))}var C=s!==e._scrollTopRow;if(C){var D=e._getViewportRowLayout(1),E=D&&D.length;if(E>0){var F=D[0].row,G=D[E-1].row,H=h(0,F-60);H<e.getRowCount()&&f._loadData(H,2*G-F)}}e._trigger(b.Events.EnterCell,{sheet:e,sheetName:e._name,row:k,col:l}),f._updateValidationUI(k,l)},c.prototype._scrollByMoveCell=function(a,b){var c=this,d=c.frozenColCount?c._getNextVisualColumn(c.frozenColCount-1):c._getFirstVisualColumn(),e=c.frozenRowCount?c._getNextVisualRow(c.frozenRowCount-1):c._getFirstVisualRow();if(b<c._scrollLeftCol&&b>=d&&c._setLeftColumn(c._getPrevVisualColumn(b+1)),b>c._getLastFullyVisibleColumn()&&b<=c._getLastVisualColumn()){var f=0,g=b,h=c._getSheetLayout(),i=c._spanModel.find(a,g);for(i&&(g=i.col+i.colCount-1);g>c._scrollLeftCol&&(f+=c._getZoomColumnWidth(g),!(f>h.viewportWidth));)g--;var j=c._getNextVisualColumn(g);c._setLeftColumn(j)}if(a<c._scrollTopRow&&a>=e&&c._setTopRow(c._getPrevVisualRow(a+1)),a>c._getLastFullyVisibleRow()&&a<=c._getLastVisualRow()){var k=0,l=a,m=c._spanModel.find(l,b);m&&(l=m.row+m.rowCount-1);for(var n=c._getSheetLayout();l>c._scrollTopRow&&(k+=c._getZoomRowHeight(l),!(k>n.viewportHeight));)l--;var o=c._getNextVisualRow(l);c._setTopRow(o)}a===c._getLastVisualRow()&&c._setTopRow(c._getLastPageTopRow()),b===c._getLastVisualColumn()&&c._setLeftColumn(c._getLastPageLeftColumn())},c.prototype.commitArrayFormula=function(){this._endEditImp(!1,1)},c.prototype._endEditImp=function(a,c){var d=this,f=d._eventHandler;if(!d.isEditing())return!0;var g,h=d._editor,i=d.getCellType(d._activeRowIndex,d._activeColIndex),j={sheet:d,row:d._activeRowIndex,col:d._activeColIndex,sheetArea:3};if(!i.isImeAware(j)&&f&&f.changeFocusHolder(),h&&h.parentNode){var k=i.getEditorValue(h,j),l={sheet:d,sheetName:d._name,row:d._activeRowIndex,col:d._activeColIndex,editingText:k,cancel:!1};if(d._trigger(b.Events.EditEnd,l),l&&l.cancel===!0)return;if(l.editor=h,d._trigger(b.Events.EditEnding,l),l&&l.cancel===!0)return;d._detachFormulaTextBox();var m=this.parent&&this.parent._attachedFormulaTextBox;if(o.activeElement===(m&&m._host)&&f.changeFocusHolder(),d._activeRowIndex>=0&&d._activeColIndex>=0){var n=h._oldValue;if(i.isEditingValueChanged(n,k,j)||1===c){if(a)i.setEditorValue(h,n,j);else{var p=i.hasOwnProperty("_autoFormatValue")?i._autoFormatValue:!0,q={row:d._activeRowIndex,col:d._activeColIndex,newValue:k,autoFormat:p};if(1===c){var r=[d._getActiveSelectedRange()];q.ranges=r,q.endEditType=c}g=new b.UndoRedo.CellEditUndoAction(d,q),d._doCommand(g);var s=2===g.applyResult;if(s===!0)return i.focus(h,j),d._attachFormlulaTextBox(i.getEditingElement()),!1}try{i.selectAll(h,j)}catch(t){}}}if(d._dirty=!0,i.deactivateEditor(h,j),i.isImeAware(j))$(h).css("width","0"),$(h).css("height","0"),$(h).css("overflow","hidden");else for(var u=h;u;)u.parentNode===o.body?o.body.removeChild(u):u=u.parentNode}if(d._editingTimeValue=!1,d._trigger(b.Events.EditEnded,{sheet:d,sheetName:d._name,row:d._activeRowIndex,col:d._activeColIndex,editingText:k}),0!==d._editorStatus){var v=d._editorStatus;d._editorStatus=0,d._trigger(b.Events.EditorStatusChanged,{sheet:d,sheetName:d._name,oldStatus:v,newStatus:0})}return d._editor=e,g&&1===g.applyResult?!1:!0},c.prototype.endEdit=function(a){return this._endEditImp(a)},c.prototype.hitTest=function(a,b,c){var d=this;d._getSheetLayout();var g,h,i={x:a,y:b,rowViewportIndex:e,colViewportIndex:e,row:-1,col:-1,resizeInfo:e,hitTestType:e,groupHitInfo:e,filterButtonHitInfo:e,dragInfo:e,cellTypeHitInfo:e,floatingObjectHitInfo:e,formulaRangeHitInfo:e,commentHitInfo:e},j=d._render.groupHitTest(a,b);if(j)i.groupHitInfo=j;else{if(g=d._getRowViewportIndexFromY(b),h=d._getColumnViewportIndexFromX(a),i.rowViewportIndex=g,i.colViewportIndex=h,i.row=d._getRowIndexFromY(b,g),i.col=d._getColumnIndexFromX(a,h),g>=0&&2>=g&&h>=0){var k=d._getCellLayoutByCell(g,h,f,i.row,i.col);k&&c!==!0&&(i.row=k.row,i.col=k.col)}i.hitTestType=d._getSheetArea(g,h);var l,m,n,o,p,q,r=d._eventHandler;(l=r.getResizingRowCol(i,a,b,5))?i.resizeInfo=l:(p=r.getFormulaRangeHitInfo(i,a,b))?i.formulaRangeHitInfo=p:(q=this._getCommentHitInfo(a,b))?i.commentHitInfo=q:(m=this._getFloatingObjectHitInfo(a,b))?i.floatingObjectHitInfo=m:(n=r.getDragInfo(i,a,b))?i.dragInfo=n:(o=d._getFilterButtonHitInfo(i,a,b))?i.filterButtonHitInfo=o:i.cellTypeHitInfo=d._getCellTypeHitInfo(i,a,b)}return i},c.prototype.getCellRect=function(a,c,d,f){var g=3;-1===d?g=1:-1===f&&(g=2);var h=this,i=h._getSheetLayout();if(-1===d&&-1===f)return new b.Rect(i.headerX,i.headerY,i.rowHeaderWidth,i.colHeaderHeight);var k=h._bounds,l=h.getRowCount(),m=h.getColumnCount();(typeof d===j||d===e)&&(a<h.frozenRowCount?d=0:a<l-h._frozenTrailingRowCount?d=1:l>a&&(d=2)),(typeof f===j||f===e)&&(c<h.frozenColCount?f=0:c<m-h._frozenTrailingColCount?f=1:m>c&&(f=2));var n=h._getRowLayout(d,g).findRow(a),o=h._getColumnLayout(f,g).findCol(c),p=h._getCellLayout(d,f,g).findCell(a,c);
return p?new b.Rect(p.x-k.x,p.y-k.y,p.width,p.height):n&&o?new b.Rect(o.x-k.x,n.y-k.y,o.width,n.height):new b.Rect},c.prototype._setActiveCellCore=function(a,b,c){var d=this,g=d._eventHandler,h=!1;a!==e&&a!==f&&(d._activeRowIndex=a,h=!0),b!==e&&b!==f&&(d._activeColIndex=b,h=!0),!c&&g&&h&&g.changeFocusHolder()},c.prototype._setActiveCellImp=function(a,c,d,e,f){var g=this;g._activeRowIndex!==a&&g._activeRowDirty&&(g.updateRecord(),g._activeRowDirty=!1);var h=g._spanModel.find(a,c);h?(g._activeRowCount=h.rowCount,g._activeColCount=h.colCount):(g._activeRowCount=1,g._activeColCount=1),g._paintSuspended||g._render.repaintSelection(new b.Range(g._activeRowIndex,g._activeColIndex,1,1)),g.activeRowViewportIndex=d,g.activeColViewportIndex=e,g._setActiveCellCore(a,c,f),g._leadingCellRow=a,g._leadingCellCol=c},c.prototype.setActiveCell=function(a,b,c,d){this._setActiveCellAndSelection(a,b,c,d)},c.prototype._setActiveCellAndSelection=function(a,b,c,d,e){var f=this;f._bindToAutoRefresh(function(a,b,c,d,e){var g=f.getRowCount(),h=f.getColumnCount();0>a?a=0:a>=g&&(a=g-1),0>b?b=0:b>=h&&(b=h-1),f._clearSelectionImp(),f._setActiveCellImp(a,b,c,d,e);var i=f._spanModel.find(a,b);i?f._setSelectedRange(i.row,i.col,i.rowCount,i.colCount):f._setSelectedRange(a,b,1,1)})(a,b,c,d,e)},c.prototype.getActiveRowIndex=function(){return this._activeRowIndex},c.prototype.getActiveColumnIndex=function(){return this._activeColIndex},c.prototype.selectionPolicy=function(a){return 0===arguments.length?this._selectionModel.selectionPolicy:(this._selectionModel.selectionPolicy=a,this)},c.prototype.selectionUnit=function(a){return 0===arguments.length?this._selectionModel.selectionUnit:(this._selectionModel.selectionUnit=a,this)},c.prototype.getRowResizable=function(a,b){(typeof b===j||b===e)&&(b=3);var c=!0,d=this._getRowInfos(b),f=d&&d[a];return f&&typeof f.resizable!==j&&f.resizable!==e&&(c=f.resizable),c},c.prototype.setRowResizable=function(a,c,d){(typeof d===j||d===e)&&(d=3);var f=this,g=f._getRowInfos(d);g[a]||(g[a]={}),g[a].resizable=c,g[a].dirty=!0,f._trigger(b.Events.RowChanged,{sheet:f,sheetName:f._name,row:a,sheetArea:d,propertyName:"resizable"})},c.prototype.getColumnResizable=function(a,b){(typeof b===j||b===e)&&(b=3);var c=!0,d=this._getColumnInfos(b),f=d&&d[a];return f&&typeof f.resizable!==j&&f.resizable!==e&&(c=f.resizable),c},c.prototype.setColumnResizable=function(a,c,d){(typeof d===j||d===e)&&(d=3);var f=this,g=f._getColumnInfos(d);g[a]||(g[a]={}),g[a].resizable=c,g[a].dirty=!0,f._trigger(b.Events.ColumnChanged,{sheet:f,sheetName:f._name,col:a,sheetArea:d,propertyName:"resizable"})},c.prototype.getRowHeight=function(a,b){var c=this;if((typeof b===j||b===e)&&(b=3),3===b||2===b){var d=c._getModel(b),f=d&&d.rowCount||0;if(0>a||a>=f)return 0;var g=c._rowFilter;if(g&&g.isHideRowFilter()&&g.isFiltered()&&g.isRowFilteredOut(a))return 0;var h=c._tableManager,k=h&&h.getTables();if(k&&k.length>0)for(var l,m,n=k.length,o=0;n>o;o++)if(l=k[o],l&&(m=l.rowFilter(),m&&m.isHideRowFilter()&&m.isFiltered()&&m.isRowFilteredOut(a)))return 0;var p=c.rowRangeGroup;if(p&&!p._isEmpty()&&p.isCollapsed(a))return 0}var q=c.defaults.rowHeight;1===b&&(q=c.defaults.colHeaderRowHeight);var r,s,t=c._getRowInfos(b),u=t&&t[a];if(u){if(r=u.visible,r===!1)return 0;s=u.size,isNaN(s)||s===e||(q=i(s))}return q},c.prototype._getActualRowHeight=function(a,b){(typeof b===j||b===e)&&(b=3);var c=this.defaults.rowHeight;1===b&&(c=this.defaults.colHeaderRowHeight);var d,f=this._getRowInfos(b),g=f&&f[a];return g&&(d=g.size,isNaN(d)||d===e||(c=i(d))),c},c.prototype.setRowHeight=function(a,c,d){(typeof d===j||d===e)&&(d=3);var f=this,g=f._getRowInfos(d),h=g[a];h||(g[a]=h={}),h.size!==c&&(h.size=c,h.dirty=!0,f._trigger(b.Events.RowChanged,{sheet:f,sheetName:f._name,row:a,sheetArea:d,propertyName:J}),f.invalidate())},c.prototype.getRowVisible=function(a,b){var c=this;if((typeof b===j||b===e)&&(b=3),c.isRowFilterOut(a,b))return!1;if(3===b||2===b){var d=c.rowRangeGroup;if(d&&!d._isEmpty()&&a>=0&&a<c.getRowCount(b)&&d.isCollapsed(a))return!1}var f=!0,g=c._getRowInfos(b),h=g&&g[a];return h&&typeof h.visible!==j&&h.visible!==e&&(f=h.visible),f},c.prototype.isRowFilterOut=function(a,b){var c=this;if((typeof b===j||b===e)&&(b=3),3===b||2===b){var d=c._rowFilter;if(d&&d.isHideRowFilter()&&d.isFiltered()&&d.isRowFilteredOut(a))return!0;var f=c._tableManager,g=f&&f.getTables();if(g&&g.length>0)for(var h,i,k=g.length,l=0;k>l;l++)if(h=g[l],h&&(i=h.rowFilter(),i&&i.isHideRowFilter()&&i.isFiltered()&&i.isRowFilteredOut(a)))return!0}return!1},c.prototype.setRowVisible=function(a,c,d){var f=this;f._bindToAutoRefresh(function(a,c,d){(typeof d===j||d===e)&&(d=3);var g=f._getRowInfos(d),h=g[a];h||(g[a]=h={}),h.visible!==c&&(h.visible=c,h.dirty=!0,f._trigger(b.Events.RowChanged,{sheet:f,sheetName:f._name,row:a,sheetArea:d,propertyName:"isVisible"}))})(a,c,d)},c.prototype.getColumnWidth=function(a,b){var c=this;(typeof b===j||b===e)&&(b=3);var d=c.defaults.colWidth;if(2===b&&(d=c.defaults.rowHeaderColWidth),3===b||1===b){var f=c._getModel(b),g=f&&f.colCount||0;if(0>a||a>=g)return 0;var h=c.colRangeGroup;if(h&&!h._isEmpty()&&h.isCollapsed(a))return 0}var k,l,m=c._getColumnInfos(b),n=m&&m[a];if(n){if(k=n.visible,k===!1)return 0;l=n.size,isNaN(l)||l===e||(d=i(l))}return d},c.prototype._getActualColumnWidth=function(a,b){(typeof b===j||b===e)&&(b=3);var c=this.defaults.colWidth;2===b&&(c=this.defaults.rowHeaderColWidth);var d,f=this._getColumnInfos(b),g=f&&f[a];return g&&(d=g.size,isNaN(d)||d===e||(c=i(d))),c},c.prototype.setColumnWidth=function(a,c,d){(typeof d===j||d===e)&&(d=3);var f=this,g=f._getColumnInfos(d),h=g[a];h||(g[a]=h={}),h.size=c,h.dirty=!0,f._trigger(b.Events.ColumnChanged,{sheet:f,sheetName:f._name,col:a,sheetArea:d,propertyName:I}),f.invalidate()},c.prototype.getColumnVisible=function(a,b){if((typeof b===j||b===e)&&(b=3),3===b||1===b){var c=this.colRangeGroup;if(c&&!c._isEmpty()&&a>=0&&a<this.getColumnCount(b)&&c.isCollapsed(a))return!1}var d=!0,f=this._getColumnInfos(b),g=f&&f[a];return g&&typeof g.visible!==j&&g.visible!==e&&(d=g.visible),d},c.prototype.setColumnVisible=function(a,c,d){var g=this;g._bindToAutoRefresh(function(a,c,d){(d===f||d===e)&&(d=3);var h=g._getColumnInfos(d),i=h[a];i||(h[a]=i={}),i.visible!==c&&(i.visible=c,i.dirty=!0,g._trigger(b.Events.ColumnChanged,{sheet:g,sheetName:g._name,col:a,sheetArea:d,propertyName:"isVisible"}))})(a,c,d)},c.prototype.zoom=function(a){if(a=parseFloat(a),!isNaN(a)&&isFinite(a)){a>4?a=4:.25>a&&(a=.25);var b=this;b._bindToAutoRefresh(function(a){b.showEditingLocator&&b._showEditingLocator(),b._zoomFactor=a})(a)}},c.prototype.invalidateLayout=function(){var a=this,c=a._eventHandler;a._layoutModel=e,a._cachedGroupLayout=e,a._rowLayoutCache={colHeader:e,viewport:e,colFooter:e},a._colLayoutCache={rowHeader:e,viewport:e},a._filterButtonsModel=e,a._cachePool.clearAll(),b.StyleHelper.scaleFontInfoCache=e,c&&window.gcGlobal.activeElement===a&&c._updateValidationUI(a._activeRowIndex,a._activeColIndex),a._needSyncScrollbarSize&&(a._syncScrollbarSize(),a._needSyncScrollbarSize=!1),a._dirty=!0},c.prototype.invalidate=function(){var a=this;!a._paintSuspended&&a._layoutSuspended<=0&&(a.invalidateLayout(),a.repaint())},c.prototype.getViewportHeight=function(a){var b=this._getSheetLayout();return 0===a?b.frozenHeight:1===a?b.viewportHeight:2===a?b.frozenTrailingHeight:0},c.prototype.getViewportWidth=function(a){var b=this._getSheetLayout();return 0===a?b.frozenWidth:1===a?b.viewportWidth:2===a?b.frozenTrailingWidth:0},c.prototype.getViewportTopRow=function(a){var b=this;return 0===a?0:1===a?h(b.frozenRowCount,b._scrollTopRow):2===a?h(b.frozenRowCount,b.getRowCount()-b._frozenTrailingRowCount):-1},c.prototype.getViewportBottomRow=function(a){var b=this;if(2===a)return b.getRowCount()-1;var c=b.getViewportTopRow(a),d=b.getViewportHeight(a),e=0,f=0,h=b.getRowCount()-b._frozenTrailingRowCount;0===a&&(h=g(b.frozenRowCount,h));for(var i=c;h>i&&d>e;i++,f++)e+=b._getZoomRowHeight(i);return c+f-1},c.prototype.getViewportLeftColumn=function(a){var b=this;return 0===a?0:1===a?h(b.frozenColCount,b._scrollLeftCol):2===a?h(b.frozenColCount,b.getColumnCount()-b._frozenTrailingColCount):-1},c.prototype.getViewportRightColumn=function(a){var b=this;if(2===a)return b.getColumnCount()-1;var c=b.getViewportLeftColumn(a),d=b.getViewportWidth(a),e=0,f=0,h=b.getColumnCount()-b._frozenTrailingColCount;0===a&&(h=g(b.frozenColCount,h));for(var i=c;h>i&&d>f;i++,e++)f+=b._getZoomColumnWidth(i);return c+e-1},c.prototype.clearSelection=function(){this._bindToAutoRefresh(function(){this._clearSelectionImp(),this._setActiveCellImp(0,0)})()},c.prototype._clearSelectionImp=function(){this._selectionModel.clear()},c.prototype._validationError=function(a,c){var d=this,e=d.getDataValidator(a,c),f={sheet:d,sheetName:d._name,row:a,col:c,validator:e,validationResult:0};return d._trigger(b.Events.ValidationError,f),f.validationResult},c.prototype.getSpans=function(a,b){(b===f||b===e)&&(b=3);var c=this._getSpanModel(b);if(!a)return c.slice(0);for(var d=[],g=0;g<c.length;g++){var h=c[g];(!a||h.intersect(a.row,a.col,a.rowCount,a.colCount))&&d.push(h)}return d},c.prototype.getSpan=function(a,b,c){(c===f||c===e)&&(c=3);var d=this._getSpanModel(c);return d.find(a,b)},c.prototype.getCell=function(a,c,d){return new b.Cell(this,a,c,d)},c.prototype.getCells=function(a,b,c,d,e){var f=this.getCell(a,b,e);return f.row2=c,f.col2=d,f},c.prototype.getRow=function(a,c){return new b.Row(this,a,c)},c.prototype.getRows=function(a,b,c){var d=this.getRow(a,c);return d.index2=b,d},c.prototype.getColumn=function(a,c){return new b.Column(this,a,c)},c.prototype.getColumns=function(a,b,c){var d=this.getColumn(a,c);return d.index2=b,d},c.prototype.setBorder=function(a,b,c,d){(d===f||d===e)&&(d=3);var g=this,h=g.isPaintSuspended();g.isPaintSuspended(!0);try{var i,j,k=g._getActualRange(a,d),l=k.row,m=k.col,n=k.rowCount,o=k.colCount;if(c.left||c.all||c.outline)for(i=0;n>i;i++)g.getCell(l+i,m,d).borderLeft(b);if(c.top||c.all||c.outline)for(j=0;o>j;j++)g.getCell(l,m+j,d).borderTop(b);if(c.right||c.all||c.outline)for(i=0;n>i;i++)g.getCell(l+i,m+o-1,d).borderRight(b);if(c.bottom||c.all||c.outline)for(j=0;o>j;j++)g.getCell(l+n-1,m+j,d).borderBottom(b);if(c.innerHorizontal||c.all||c.inside)for(i=0;n-1>i;i++)for(j=0;o>j;j++)g.getCell(l+i,m+j,d).borderBottom(b),g.getCell(l+i+1,m+j,d).borderTop(b);if(c.innerVertical||c.all||c.inside)for(j=0;o-1>j;j++)for(i=0;n>i;i++)g.getCell(l+i,m+j,d).borderRight(b),g.getCell(l+i,m+j+1,d).borderLeft(b)}finally{g.isPaintSuspended(h)}},c.prototype.search=function(a){if(!a||!b.features.search)return e;var c=this,d=a.sheetArea,f=a.searchString,g=a.searchTarget,h=a.searchFlags,i=c.getRowCount(d),j=c.getColumnCount(d);if(!f||0===g||0>=i&&0>=j)return new b.SearchResult;-1===a.rowStart&&(a.rowStart=0),-1===a.columnStart&&(a.columnStart=0),-1===a.findBeginRow&&(a.findBeginRow=a.rowStart),-1===a.findBeginColumn&&(a.findBeginColumn=a.columnStart),-1===a.rowEnd&&(a.rowEnd=i-1),-1===a.columnEnd&&(a.columnEnd=j-1);var k=new b.SearchResult,l=new b.CellsEnumerator(c,a);for((8&h)>0&&(l.isBlockRange=!0);l.moveNext();){var n=l.currentRow,o=l.currentColumn,p=l.current();if(p){if((1&g)>0){var q=p.text();c._trySearch(q,f,h)&&""!==q&&(k.searchFoundFlag|=1,k.foundString=q)}if((8&g)>0){var r=p.formula();r=typeof r===m?r.toString():e,c._trySearch(r,f,h)&&""!==r&&(k.searchFoundFlag|=8,k.foundString=r)}if(0!==k.searchFoundFlag)return k.foundRowIndex=n,k.foundColumnIndex=o,k}}return new b.SearchResult},c.prototype.showCell=function(a,b,c,d){var e=this,f=e.getRowCount(),g=e.getColumnCount(),h=e._zoomFactor;if(!(0>a||a>=f||0>b||b>=g)){var j=isNaN(e.frozenRowCount)?0:e.frozenRowCount,k=isNaN(e.frozenColCount)?0:e.frozenColCount,l=isNaN(e._frozenTrailingRowCount)?0:e._frozenTrailingRowCount,m=isNaN(e._frozenTrailingColCount)?0:e._frozenTrailingColCount,n=e._scrollTopRow,o=e._scrollLeftCol,p=1,q=1;if(j>a?(n=0,q=0):a>=f-l&&(n=f-l,q=2),k>b?(o=0,p=0):b>=g-m&&(o=g-m,p=2),1===p){var r;if(0!==d)if(1===d)for(r=i((e.getViewportWidth(p)-i(e.getColumnWidth(b)*h))/2);b>0&&(r-=i(e.getColumnWidth(b-1)*h),!(0>r));b--);else if(2===d)for(r=e.getViewportWidth(p)-i(e.getColumnWidth(b)*h);b>0&&(r-=i(e.getColumnWidth(b-1)*h),!(0>r));b--);else if(3===d&&b>=o)for(r=e.getViewportWidth(p)-i(e.getColumnWidth(b)*h);b>o&&(r-=i(e.getColumnWidth(b-1)*h),!(0>r));b--);}if(1===q){var s;if(0!==c)if(1===c)for(s=i((e.getViewportHeight(q)-i(e.getRowHeight(a)*h))/2);a>0&&(s-=i(e.getRowHeight(a-1)*h),!(0>s));a--);else if(2===c)for(s=e.getViewportHeight(q)-i(e.getRowHeight(a)*h);a>0&&(s-=i(e.getRowHeight(a-1)*h),!(0>s));a--);else if(3===c&&!(n>a||-1===n))for(s=e.getViewportHeight(q)-i(e.getRowHeight(a)*h);a>n&&(s-=i(e.getRowHeight(a-1)*h),!(0>s));a--);}var t=!1;1===q&&a!==n&&(e._scrollTopRow=a,e._syncVScrollbarPosition(),t=!0),1===p&&b!==o&&(e._scrollLeftCol=b,e._syncHScollbarPosition(),t=!0),t&&(e.invalidateLayout(),e.repaint())}},c.prototype.showColumn=function(a,b){this.showCell(this._scrollTopRow,a,0,b)},c.prototype.showRow=function(a,b){this.showCell(a,this._scrollLeftCol,b,0)},c.prototype.bind=function(a,b,c){this._eventHandler.bind(a+w,b,c)},c.prototype.unbind=function(a,b){this._eventHandler.unbind(a+w,b)},c.prototype.unbindAll=function(){this._eventHandler.unbind(w)},c.prototype._bind=function(a,b,c){a.indexOf(".")>=0?this._eventHandler.bind(a,b,c):this._eventHandler.bind(a+x,b,c)},c.prototype._unbind=function(a,b){a.indexOf(".")>=0?this._eventHandler.unbind(a,b):this._eventHandler.unbind(a+x,b)},c.prototype._unbindAll=function(){this._eventHandler.unbind(x)},c.prototype.suspendEvent=function(){this._eventHandler._eventSuspended++},c.prototype.resumeEvent=function(){var a=this._eventHandler;a._eventSuspended--,a._eventSuspended<0&&(a._eventSuspended=0)},c.prototype.currentTheme=function(a){var c=this;return 0===arguments.length?(c._currentTheme||(c._currentTheme=b.SpreadThemes.Office),c._currentTheme):(typeof a===m&&(a=b.SpreadThemes.hasOwnProperty(a)?b.SpreadThemes[a]:new b.SpreadTheme(a)),c._bindToAutoRefresh(function(a){c._currentTheme=a})(a),c)},c.prototype.reset=function(){var a=this;a.defaults={rowHeight:a._defaultRowHeight,colWidth:a._defaultColWidth,rowHeaderColWidth:a._defaultRowHeaderColWidth,colHeaderRowHeight:a._defaultColHeaderRowHeight},a.gridline={color:a._defaultGridLineColor,showVerticalGridline:a._defaultShowVerticalGridline,showHorizontalGridline:a._defaultShowHorizontalGridline},a._rowLayoutCache={colHeader:e,viewport:e,colFooter:e},a._colLayoutCache={rowHeader:e,viewport:e},a._dragRect={},a._render=new b._SheetRender(a);var c=e;a._eventHandler&&(c=a._eventHandler._elem),a._eventHandler=new b._SheetEventHandler(a),a._eventHandler._elem=c,a._composedDefaultStyle={},a._dataModel=new b._GcSheetModel,a._dataModel.name=a._name,b.util.hasCalc()&&(a._calcDataModel=new b._CalcModel(a._dataModel.rowCount,a._dataModel.colCount,a._name+"_calc")),a._rowHeaderModel=new b._GcSheetModel(a._dataModel.rowCount,1),a._colHeaderModel=new b._GcSheetModel(1,a._dataModel.colCount),a._colFooterModel=new b._GcSheetModel(1,a._dataModel.colCount,a._name+"cf"),a._spanModel=new b._SpanModel,a._colHeaderSpanModel=new b._SpanModel,a._rowHeaderSpanModel=new b._SpanModel,a._selectionModel=new b._SelectionModel,a._selectionBackColor="rgba(180,180,200,0.2)",a._selectionBorderColor="black",a._currentTheme=b.SpreadThemes.Office,a._allowDragDrop=!0,a._allowDragFill=!0,b.util.hasCalc()&&(a._vpSheetSource=new b.Calc._SheetSource(a,3)),b.features.group&&(a.rowRangeGroup=new b.RangeGroup(a.getRowCount()),a.colRangeGroup=new b.RangeGroup(a.getColumnCount())),a._showRowRangeGroup=!0,a._showColumnRangeGroup=!0,a._rowInfos=e,a._colInfos=e,a.dataContext=e,a.autoGenerateColumns=!0,a.autoUpdate=!0,a._rowFilter=e,a._initDefaultKeyMap(),b.features.floatingObject&&a._initDefaultFloatingObjectKeyMap(),b.features.comment&&a._initDefaultCommentKeyMap(),a._scrollTopRow=0,a._scrollLeftCol=0,a.frozenRowCount=0,a.frozenColCount=0,a._frozenTrailingRowCount=0,a._frozenTrailingColCount=0,b.features.binding&&(a._bindingManager=new b._BindingManager(a)),b.features.sparkline&&(a._sparklineGroupManager=new b.WorksheetSparklineGroupManager(a,a)),b.features.table&&(a._tableManager=new b._SheetTableManager(a)),b.features.floatingObject&&(a._floatingObjectArray=new b._FloationgObjectArray(a)),a._namedStyles={},a._needSyncScrollbarSize=!0,a._cutCopyIndicatorManager=new b.CutCopyIndicatorManager(a),a.invalidateLayout(),a._dirty=!0,a._clipBoardOptions=0,a._containerDiv=e,b.features.comment&&(a._commentManager=new b.CommentManager(a))},c.prototype.undoManager=function(){var a=this,c=a.parent;return a._undoManager||(a._undoManager=c&&c._undoManager?c._undoManager:new b._UndoManager(a,-1,a.allowUndo())),a._undoManager},c.prototype.clipBoardOptions=function(a){return 0===arguments.length?this._clipBoardOptions:(this._clipBoardOptions=a,this)},c.prototype.doCommand=function(a){this._doCommand(a)},c.prototype.copyTo=function(a,b,c,d,e,f,g){this.copyToCore(a,b,c,d,e,f,g)},c.prototype.copyToCore=function(a,b,c,d,e,f,g,h){var i=this,j=i.isPaintSuspended();i.isPaintSuspended(!0),i.suspendEvent(),r.copyTo(i,a,b,i,c,d,e,f,g,h),i.resumeEvent(),i.isPaintSuspended(j)},c.prototype.moveTo=function(a,b,c,d,e,f,g){var h=this,i=h.isPaintSuspended();h.isPaintSuspended(!0),h.suspendEvent(),r.moveTo(h,a,b,h,c,d,e,f,g),h.resumeEvent(),h.isPaintSuspended(i)},c.prototype.setCsv=function(a,b,c,d,e,f){var g=this,h=g.isPaintSuspended();g.isPaintSuspended(!0),g.suspendEvent(),r.setRangeText(g,a,b,c,d,e,'"',f),g.resumeEvent(),g.isPaintSuspended(h)},c.prototype.getCsv=function(a,b,c,d,e,f){return r.getRangeText(this,a,c,b,d,e,f,'"',!0,0)},c.prototype.canUserDragDrop=function(a){var b=this,c=b.parent;return 0===arguments.length?(c&&c.canUserDragDrop&&(b._allowDragDrop=c.canUserDragDrop()),b._allowDragDrop):(c&&c.canUserDragDrop?c.canUserDragDrop(a):b._allowDragDrop=a,b)},c.prototype.canUserDragFill=function(a){var c=this,d=c.parent;if(0===arguments.length)return b.features.fill?(d&&d.canUserDragFill&&(c._allowDragFill=d.canUserDragFill()),c._allowDragFill):!1;var e=c.canUserDragFill();return e!==a&&(d&&d.canUserDragFill?d.canUserDragFill(a):c._allowDragFill=a,1!==c.getSelections().length||c._paintSuspended||c._render.repaintSelection(c.getSelections().toArray()[0])),c},c.prototype.isColumnBound=function(a){var b=this;if(0>a||a>=b.getColumnCount())return!1;var c=b.getDataSource();if(c&&b._colInfos){var d=b._colInfos[a];return!(!d||!d.name)}return!1},c.prototype.getDataColumnName=function(a){var b=this;if(0>a||a>=b.getColumnCount())return e;var c=b.getDataSource();if(c&&b._colInfos){var d=b._colInfos[a];return d.displayName||d.name}return e},c.prototype.getSparkline=function(a,b){if(!this._sparklineGroupManager)return e;var c=3,d=this._getModel(c);return d.getSparkline(a,b)},c.prototype.setSparkline=function(a,c,d,g,h,i,j,k){var l=this,m=l._sparklineGroupManager;return m?l._bindToAutoRefresh(function(a,c,d,g,h,i,j,k){var n=d,o=new b.Sparkline(a,c,n,g,h,i);j&&k!==f&&k!==e&&(o.dateAxisData(j),o.dateAxisOrientation(k),o.group().displayDateAxis=!0),l.removeSparkline(a,c);var p=l._getModel();return p.setSparkline(a,c,o),m.add(o.group()),l._raiseCellChanged("sparkline",a,c,3),o})(a,c,d,g,h,i,j,k):e},c.prototype.removeSparkline=function(a,b){var c=this,d=c._sparklineGroupManager;d&&c._bindToAutoRefresh(function(a,b){var f=3,g=c._getModel(f),h=g.getSparkline(a,b);if(h){var i=h.group();i.remove(h),i.count()<=0&&d.remove(i)}g.setSparkline(a,b,e)})(a,b)},c.prototype.groupSparkline=function(a){var b=this._sparklineGroupManager;return b?this._bindToAutoRefresh(function(a){for(var c=e,d=0;d<a.length;d++){var f=a[d];if(f)if(c){var g=f.group();g.remove(f),c.add(f),g.count()<=0&&b.remove(g)}else c=f.group()}return c})(a):e},c.prototype.ungroupSparkline=function(a){var b=this,c=b._sparklineGroupManager;c&&b._bindToAutoRefresh(function(a){if(a){var b=[];b=b.concat(a._innerList);for(var d=0;d<b.length;d++){var e=b[d];if(e){a.remove(e);var f=a.clone();f.add(e),c.add(f)}}c.remove(a)}})(a)},c.prototype.fillAuto=function(a,c,d){if(b.features.fill){if(!c)throw new Error(b.SR.Exp_RangeIsNull);var e=this;e._checkFillRange(a,c,d)&&e._bindToAutoRefresh(function(a,c,d){a&&(e._eventHandler._dragFillStartRange=a);var f=new b.FillImp(e);f.fillAuto(c,d)})(a,c,d)}},c.prototype.fillAutobyDirection=function(a,c,d){if(b.features.fill){if(!c)throw new Error(b.SR.Exp_RangeIsNull);var f=this;f._checkFillRange(a,c,e,d)&&f._bindToAutoRefresh(function(a,c,d){a&&(f._eventHandler._dragFillStartRange=a);var e=new b.FillImp(f);e.fillAutobyDirection(c,d)})(a,c,d)}},c.prototype.fillLinear=function(a,c,d,e,f){if(b.features.fill){if(!c)throw new Error(b.SR.Exp_RangeIsNull);var g=this;g._checkFillRange(a,c,d)&&g._bindToAutoRefresh(function(a,c,d,e,f){a&&(g._eventHandler._dragFillStartRange=a);var h=new b.FillImp(g);h.fillLinear(c,d,e,f)})(a,c,d,e,f)}},c.prototype.fillGrowth=function(a,c,d,e,f){if(b.features.fill){if(!c)throw new Error(b.SR.Exp_RangeIsNull);var g=this;g._checkFillRange(a,c,d)&&g._bindToAutoRefresh(function(a,c,d,e,f){a&&(g._eventHandler._dragFillStartRange=a);var h=new b.FillImp(g);h.fillGrowth(c,d,e,f)})(a,c,d,e,f)}},c.prototype.fillDate=function(a,c,d,g,h,i){if(b.features.fill){if(!c)throw new Error(b.SR.Exp_RangeIsNull);var j=this;j._checkFillRange(a,c,d)&&j._bindToAutoRefresh(function(a,c,d,g,h,i){a&&(j._eventHandler._dragFillStartRange=a);var k=new b.FillImp(j),l=e;i!==f&&i!==e&&(l=new b._DateTimeHelper(i).toOADate()),k.fillDate(c,d,g,h,l)})(a,c,d,g,h,i)}},c.prototype._checkFillRange=function(a,b,c,d){if(!a||!b)return!1;if(!b.containsRange(a))return!1;if(c!==f&&c!==e)if(1===c){if(a.row===b.row&&a.rowCount===b.rowCount)return!0}else if(0===c&&a.col===b.col&&a.colCount===b.colCount)return!0;if(d!==f&&d!==e)if(2===d||3===d){if(a.col===b.col&&a.colCount===b.colCount)return!0}else if((0===d||1===d)&&a.row===b.row&&a.rowCount===b.rowCount)return!0;return!1},c.prototype.clear=function(a,b,c,d,e,f){this.clearCore(a,b,c,d,e,f)},c.prototype._checkArrayFormula=function(a,c,d,e,f){return f=void 0===f?!0:!1,f&&this._hasPartArrayFormulas(a,c,d,e)||!f&&this._hasArrayFormula(a,c,d,e)?(this._raiseInvalidOperation(4,b.SR.Exp_ChangePartOfArray),!1):!0},c.prototype.clearCore=function(a,b,c,d,g,h,i){var j=this;j._bindToAutoRefresh(function(a,b,c,d,g,h){j.suspendCalcService();try{var k,l,m,n,o=3;if(g===f||g===e||g===o){if(!j._checkArrayFormula(a,b,c,d))return!1;if(1===(1&h)){if(j.getDataSource()||j.dataContext){for(j.suspendEvent(),k=a;a+c>k;k++)if(!i||!j.isRowFilterOut(k))for(l=b;b+d>l;l++)j.setValue(k,l,e,g);j.resumeEvent()}j._conditionalFormats&&j._conditionalFormats._clearCache(),j._rowFilter&&j._rowFilter.range&&j._rowFilter._clear(a,b,c,d)}16===(16&h)&&j._sparklineGroupManager&&j._sparklineGroupManager.clear(a,b,c,d),j._tableManager&&j._tableManager.clear(a,b,c,d,h),4===(4&h)&&j._commentManager&&j._commentManager.clear(a,b,c,d)}var p=j._getModel(g),q=j._getCalcModel(g);if(p){k=-1===a?0:a;var r=-1===a?p.rowCount:c;l=-1===b?0:b;for(var s=-1===b?p.colCount:d,t=[],u=k;r>u;u++)i&&j.isRowFilterOut(u)&&t.push(u);if(p.clear(k,l,r,s,h,t,j),q&&q.clear(k,l,r,s,h,void 0,j),2===(2&h)&&!(a>=0&&b>=0))if(b>=0)for(n=0;s>n;n++)j.setStyle(-1,l+n,e,g);else if(a>=0)for(m=0;r>m;m++)i&&j.isRowFilterOut(k+m)||j.setStyle(k+m,-1,e,g);else j.setStyle(-1,-1,e,g);if(32===(32&h)&&!(a>=0&&b>=0))if(b>=0)for(n=0;s>n;n++)j.setColumnVisible(l+n,!0,g),j.setColumnResizable(l+n,!0,g),j.setColumnWidth(l+n,2===g?j.defaults.rowHeaderColWidth:j.defaults.colWidth,g);else if(a>=0)for(m=0;r>m;m++)i&&j.isRowFilterOut(k+m)||(j.setRowVisible(k+m,!0,g),j.setRowResizable(k+m,!0,g),j.setRowHeight(k+m,1===g?j.defaults.colHeaderRowHeight:j.defaults.rowHeight,g));else{for(n=0;s>n;n++)j.setColumnVisible(l+n,!0,g),j.setColumnResizable(l+n,!0,g),j.setColumnWidth(l+n,2===g?j.defaults.rowHeaderColWidth:j.defaults.colWidth,g);for(m=0;r>m;m++)i&&j.isRowFilterOut(k+m)||(j.setRowVisible(k+m,!0,g),j.setRowResizable(k+m,!0,g),j.setRowHeight(k+m,1===g?j.defaults.colHeaderRowHeight:j.defaults.rowHeight,g))}for(m=0;r>m;m++)for(n=0;s>n;n++)k=a+m,l=b+n,1===(1&h)&&j._raiseCellChanged(F,k,l,g),2===(2&h)&&j._raiseCellChanged("style",k,l,g),16===(16&h)&&j._raiseCellChanged("sparkline",k,l,g),4===(4&h)&&j._raiseCellChanged("comment",k,l,g),32===(32&h)&&j._raiseCellChanged("axis",k,l,g),64===(64&h)&&j._raiseCellChanged("bindingPath",k,l,g)}if((g===f||g===e||g===o)&&1===(1&h)){var v=j._getSheetSource();v&&v._addCellsToDirty(a,b,c,d)}}finally{j.resumeCalcService()}})(a,b,c,d,g,h)},c.prototype.getConditionalFormats=function(){var a=this;return!a._conditionalFormats&&b.features.conditionalFormat&&(a._conditionalFormats=new b.ConditionalFormats(a)),a._conditionalFormats},c.prototype.rowFilter=function(a){var b=this;return 0===arguments.length?b._rowFilter:b._bindToAutoRefresh(function(a){return b._rowFilter&&b._rowFilter.reset(),b._rowFilter=a,b._rowFilter&&(b._rowFilter.sheet=b),b})(a)},c.prototype.autoFitColumn=function(a){if(!(0>a||a>=this.getColumnCount())){var c=new b.UndoRedo.ColumnAutoFitUndoAction(this,[{col:a}],!1);c.execute(this)}},c.prototype.autoFitRow=function(a){if(!(0>a||a>=this.getRowCount())){var c=new b.UndoRedo.RowAutoFitUndoAction(this,[{row:a}],!1);c.execute(this)}},c.prototype.setGridlineOptions=function(a){var b=this;b._bindToAutoRefresh(function(a){if(a){b.gridline||(b.gridline={});var c=b.gridline;a.color&&(c.color=a.color),a.showVerticalGridline!==e&&a.showVerticalGridline!==f&&(c.showVerticalGridline=a.showVerticalGridline),a.showHorizontalGridline!==e&&a.showHorizontalGridline!==f&&(c.showHorizontalGridline=a.showHorizontalGridline)}})(a)},c.prototype.getGridlineOptions=function(){var a=this;a.gridline||(a.gridline={});var b=a.gridline,c={};return c.color=b.color,c.showVerticalGridline=b.showVerticalGridline,c.showHorizontalGridline=b.showHorizontalGridline,c},c.prototype.getFrozenRowCount=function(){return this.frozenRowCount},c.prototype.getFrozenColumnCount=function(){return this.frozenColCount},c.prototype.getFrozenTrailingRowCount=function(){return this._frozenTrailingRowCount},c.prototype.getFrozenTrailingColumnCount=function(){return this._frozenTrailingColCount},c.prototype.setRowHeaderVisible=function(a){this._bindToAutoRefresh(function(){this.rowHeaderVisible=a})(a)},c.prototype.getRowHeaderVisible=function(){return this.rowHeaderVisible},c.prototype.setColumnHeaderVisible=function(a){this._bindToAutoRefresh(function(){this.colHeaderVisible=a})(a)},c.prototype.getColumnHeaderVisible=function(){return this.colHeaderVisible},c.prototype.setRowHeaderAutoText=function(a){this._bindToAutoRefresh(function(a){this.rowHeaderAutoText=a})(a)},c.prototype.getRowHeaderAutoText=function(){return this.rowHeaderAutoText},c.prototype.setColumnHeaderAutoText=function(a){this._bindToAutoRefresh(function(a){this.colHeaderAutoText=a})(a)},c.prototype.getColumnHeaderAutoText=function(){return this.colHeaderAutoText},c.prototype.setRowHeaderAutoTextIndex=function(a){this._bindToAutoRefresh(function(a){this.rowHeaderAutoTextIndex=a})(a)},c.prototype.getRowHeaderAutoTextIndex=function(){return this.rowHeaderAutoTextIndex},c.prototype.setColumnHeaderAutoTextIndex=function(a){this._bindToAutoRefresh(function(a){this.colHeaderAutoTextIndex=a})(a)},c.prototype.getColumnHeaderAutoTextIndex=function(){return this.colHeaderAutoTextIndex},c.prototype.setIsProtected=function(a){this._bindToAutoRefresh(function(){this.isProtected=a})(a)},c.prototype.getIsProtected=function(){return this.isProtected},c.prototype.setArray=function(a,b,c,d){var e=this,f=e.getRowCount(),g=e.getColumnCount();if(c&&a>=0&&f>a&&b>=0&&g>b){e.suspendCalcService();var h=e.isPaintSuspended();e.isPaintSuspended(!0);try{$.each(c,function(c,h){if(h instanceof Array)$.each(h,function(h,i){var j=a+c,k=b+h;f>j&&g>k&&(d?e.setFormula(j,k,i,3):e.setValue(j,k,i,3,!0))});else{var i=a+c,j=b;f>i&&g>j&&(d?e.setFormula(i,j,h,3):e.setValue(i,j,h,3,!0))}})}finally{e.resumeCalcService(),e.isPaintSuspended(h)}}},c.prototype.getArray=function(a,b,c,d,e){var f=this,g=[],h=f.getRowCount(),i=f.getColumnCount();if(a>=0&&h>a&&b>=0&&i>b){a+c>h&&(c=h-a),b+d>i&&(d=i-b);for(var j=0;c>j;j++){g[j]=[];for(var k=0;d>k;k++)g[j][k]=e?f.getFormula(a+j,b+k):f.getValue(a+j,b+k)}}return g},c.prototype.showRowRangeGroup=function(a){var c=this;return 0===arguments.length?b.features.group?c._showRowRangeGroup:!1:(c._showRowRangeGroup!==a&&c._bindToAutoRefresh(function(a){c._showRowRangeGroup=a})(a),c)},c.prototype.showColumnRangeGroup=function(a){var c=this;return 0===arguments.length?b.features.group?c._showColumnRangeGroup:!1:(c._showColumnRangeGroup!==a&&c._bindToAutoRefresh(function(a){c._showColumnRangeGroup=a})(a),c)},c.prototype.addTable=function(a,c,d,g,h,i){var j=this,k=j._tableManager;if(!k)return e;j._checkCanAddTable(a,c,d,g,h,!0),i===f&&(i=b.TableStyles.medium2());var l=j.isPaintSuspended();j.isPaintSuspended(!0);try{return k.add(new b.SheetTable(a,c,d,g,h,i))}finally{j.isPaintSuspended(l)}},c.prototype.addTableByDataSource=function(a,c,d,g,h){var i=this,j=i._tableManager;if(!j||!b.features.binding)return e;if(!g)throw new Error(b.SR.Exp_TableDataSourceNullError);i._checkCanAddTable(a,c,d,1,1,!0);var k=new b._BindingManager;k.bind(g);var l=k.getRowCount(),m=k.getColumnCount();l+=1,c+l>i.getRowCount()&&i.setRowCount(c+l),d+m>i.getColumnCount()&&i.setColumnCount(d+m),i._checkCanAddTable(a,c,d,l,m,!0),h===f&&(h=b.TableStyles.medium2());var n=i.isPaintSuspended();i.isPaintSuspended(!0);try{var o=j.add(new b.SheetTable(a,c,d,l,m,h));return o._bind(k),o}finally{i.isPaintSuspended(n)}},c.prototype.findTable=function(a,b){var c=this._tableManager;return c?c.find(a,b):e},c.prototype.findTableByName=function(a){var b=this._tableManager;return b?b.findByName(a):e},c.prototype.removeTable=function(a){var b=this,c=b._tableManager;if(!a||!c)return b;var d=b.isPaintSuspended();b.isPaintSuspended(!0);try{return c.remove(a),b}finally{b.isPaintSuspended(d)}},c.prototype.removeTableByName=function(a){var b=this.findTableByName(a);return b&&this.removeTable(b),this},c.prototype.moveTable=function(a,b,c){var d=this,e=d._tableManager;if(!e||!a||0>b||0>c)return d;var f=a.range(),g=f.rowCount,h=f.colCount,i=e.findByRange(b,c,g,h);if(i){if(i.length>1)return d;if(1===i.length&&i[0]!==a)return d}var j=d.isPaintSuspended();d.isPaintSuspended(!0);try{return a._moveTo(b,c),d}finally{d.isPaintSuspended(j)}},c.prototype.moveTableByName=function(a,b,c){var d=this.findTableByName(a);return d&&this.moveTable(d,b,c),this},c.prototype.resizeTable=function(a,b,c){var d=this,e=d._tableManager;if(!e||!a||0>b||0>c)return d;var f=a.range(),g=f.row,h=f.col,i=e.findByRange(g,h,b,c);if(i&&i.length>1)return d;var j=d.isPaintSuspended();d.isPaintSuspended(!0);try{return a._resize(b,c),d}finally{d.isPaintSuspended(j)}},c.prototype.resizeTableByName=function(a,b,c){var d=this.findTableByName(a);return d&&this.resizeTable(d,b,c),this},c.prototype.getTables=function(){var a=this._tableManager;return a?a.getTables():void 0},c.prototype.selectionBackColor=function(a){var b=this;return 0===arguments.length?b._selectionBackColor:b._bindToAutoRefresh(function(a){return a&&(b._selectionBackColor=a),b})(a)},c.prototype.selectionBorderColor=function(a){var b=this;return 0===arguments.length?b._selectionBorderColor:b._bindToAutoRefresh(function(a){return a&&(b._selectionBorderColor=a),b})(a)},c.prototype._addTableInternal=function(a){var b=this._tableManager;if(b){var c=a.range();this._checkCanAddTable(a.name(),c.row,c.col,c.rowCount,c.colCount)&&b.add(a)}},c.prototype._checkCanAddTable=function(a,c,d,e,f,g){var h=this;if(!a){if(g)throw new Error(b.SR.Exp_TableEmptyNameError);return!1}if(0>c||1>e||c+e>h.getRowCount()){if(g)throw new Error(b.SR.Exp_TableInvalidRow);return!1}if(0>d||1>f||d+f>h.getColumnCount()){if(g)throw new Error(b.SR.Exp_TableInvalidColumn);return!1}if(h._hasTable(c,d,e,f)){if(g)throw new Error(b.SR.Exp_TableIntersectError);return!1}if(h.parent&&h.parent._findTable(a)||!h.parent&&h.findTableByName(a)){if(g)throw new Error(b.SR.Exp_TableHasSameNameError);
return!1}var i=h._getsArrayFormulas(c,d,e,f);if(i&&i.ranges&&i.ranges.length>0)for(var j=0;j<i.ranges.length;j++){var k=i.ranges[j];if(k.rowCount>1||k.colCount>1){if(g)throw new Error(b.SR.Exp_ArrayFormulaTable);return!1}}return!0},c.prototype._bindToAutoRefresh=function(a,b){return b||(b=this),function(){var c=a.apply(b,arguments);return b._paintSuspended||(typeof b.invalidateLayout===k&&b.invalidateLayout(),typeof b.repaint===k&&b.repaint()),c}},c.prototype._isValidSheetName=function(a){if(!a||""===a)return!1;var b=this,c=b.parent;if(!c)return!0;for(var d=c.sheets.length,e=0;d>e;e++){var f=c.sheets[e];if(f!==b&&a===f._name)return!1}return!0},c.prototype._init=function(a){this._name=a,this._bounds=new b.Rect(0,0,0,0),this.reset()},c.prototype.applyOptions=function(a){if(a){var b=this,c=b.defaults,d=b.gridline;typeof a.name===m&&a.name.length>0&&(b._name=a.name),a.data&&b.setDataSource(a.data),typeof a.defaultRowHeight===l&&(c.rowHeight=a.defaultRowHeight),typeof a.defaultColWidth===l&&(c.colWidth=a.defaultColWidth),typeof a.defaultRowHeaderColWidth===l&&(c.rowHeaderColWidth=a.defaultRowHeaderColWidth),typeof a.defaultColHeaderRowHeight===l&&(c.colHeaderRowHeight=a.defaultColHeaderRowHeight),typeof a.rowCount===l&&b.setRowCount(a.rowCount),typeof a.colCount===l&&b.setColumnCount(a.colCount),typeof a.frozenRowCount===l&&(b.frozenRowCount=a.frozenRowCount),typeof a.frozenColCount===l&&(b.frozenColCount=a.frozenColCount),typeof a.frozenTrailingRowCount===l&&(b._frozenTrailingRowCount=a.frozenTrailingRowCount),typeof a.frozenTrailingColCount===l&&(b._frozenTrailingColCount=a.frozenTrailingColCount),a.gridlineColor&&(d.color=a.gridlineColor),typeof a.showVerticalGridline===n&&(d.showVerticalGridline=a.showVerticalGridline),typeof a.showHorizontalGridline===n&&(d.showHorizontalGridline=a.showHorizontalGridline),a.borderColor&&(b.borderColor=a.borderColor),typeof a.borderWidth===l&&(b.borderWidth=a.borderWidth),typeof a._zoomFactor===l&&(b._zoomFactor=a._zoomFactor),typeof a.rowHeaderVisible===n&&(b.rowHeaderVisible=a.rowHeaderVisible),typeof a.colHeaderVisible===n&&(b.colHeaderVisible=a.colHeaderVisible),typeof a.autoUpdate===n&&(b.autoUpdate=a.autoUpdate),typeof a.autoGenerateColumns===n&&(b.autoGenerateColumns=a.autoGenerateColumns),a.rowHeaderAutoText&&(b.rowHeaderAutoText=a.rowHeaderAutoText),a.colHeaderAutoText&&(b.colHeaderAutoText=a.colHeaderAutoText);var e,f;typeof a._activeRowIndex===l&&(e=a._activeRowIndex),typeof a._activeColIndex===l&&(f=a._activeColIndex),b._setActiveCellCore(e,f),typeof a._allowCellOverflow===n&&(b._allowCellOverflow=a._allowCellOverflow),typeof a.isProtected===n&&(b.isProtected=a.isProtected),typeof a.allowUndo===n&&b.allowUndo(a.allowUndo);var g=a.columns;g&&g.length>0&&(b.autoGenerateColumns=!1,b.bindColumns(g));var h=a.dataContext;if(h){var i=new v(h.read,h.create,h.update,h.remove);b.setDataContext(i)}}},c.prototype._initDefaultFloatingObjectKeyMap=function(){var a,c,d=navigator.platform,e=d&&d.indexOf("Mac")>-1;e?(a=!1,c=!0):(a=!0,c=!1);var f=this;f.addFloatingObjectKeyMap(27,!1,!1,!1,!1,b.SpreadActions.unSelectAllFloatingObjects),f.addFloatingObjectKeyMap(46,!1,!1,!1,!1,b.SpreadActions.deleteFloatingObject),f.addFloatingObjectKeyMap(9,!1,!1,!1,!1,b.SpreadActions.navigationNextFloatingObject),f.addFloatingObjectKeyMap(9,!1,!0,!1,!1,b.SpreadActions.navigationPreviousFloatingObject),f.addFloatingObjectKeyMap(88,a,!1,!1,c,b.SpreadActions.clipboardCutFloatingObject),f.addFloatingObjectKeyMap(67,a,!1,!1,c,b.SpreadActions.clipboardCopyFloatingObject),f.addFloatingObjectKeyMap(86,a,!1,!1,c,b.SpreadActions.clipboardPasteFloatingObject),f.addFloatingObjectKeyMap(65,a,!1,!1,c,b.SpreadActions.selectAllFloatingObjects),f.addFloatingObjectKeyMap(38,!1,!1,!1,!1,b.SpreadActions.moveFloatingObjectUp),f.addFloatingObjectKeyMap(40,!1,!1,!1,!1,b.SpreadActions.moveFloatingObjectDown),f.addFloatingObjectKeyMap(37,!1,!1,!1,!1,b.SpreadActions.moveFloatingObjectLeft),f.addFloatingObjectKeyMap(39,!1,!1,!1,!1,b.SpreadActions.moveFloatingObjectRight)},c.prototype._initDefaultCommentKeyMap=function(){var a,c,d=navigator.platform,e=d&&d.indexOf("Mac")>-1;e?(a=!1,c=!0):(a=!0,c=!1);var f=this;f.addCommentKeyMap(46,!1,!1,!1,!1,b.SpreadActions.deleteComment),f.addCommentKeyMap(27,!1,!1,!1,!1,b.SpreadActions.deactivateComment),f.addCommentKeyMap(38,!1,!1,!1,!1,b.SpreadActions.moveCommentUp),f.addCommentKeyMap(40,!1,!1,!1,!1,b.SpreadActions.moveCommentDown),f.addCommentKeyMap(37,!1,!1,!1,!1,b.SpreadActions.moveCommentLeft),f.addCommentKeyMap(39,!1,!1,!1,!1,b.SpreadActions.moveCommentRight)},c.prototype._initDefaultKeyMap=function(){var a,c,d=navigator.platform,e=d&&d.indexOf("Mac")>-1;e?(a=!1,c=!0):(a=!0,c=!1);var f=this;f.addKeyMap(37,!1,!1,!1,!1,b.SpreadActions.navigationLeft),f.addKeyMap(39,!1,!1,!1,!1,b.SpreadActions.navigationRight),f.addKeyMap(38,!1,!1,!1,!1,b.SpreadActions.navigationUp),f.addKeyMap(40,!1,!1,!1,!1,b.SpreadActions.navigationDown),f.addKeyMap(37,a,!1,!1,c,b.SpreadActions.navigationHome2),f.addKeyMap(39,a,!1,!1,c,b.SpreadActions.navigationEnd2),f.addKeyMap(38,a,!1,!1,c,b.SpreadActions.navigationTop),f.addKeyMap(40,a,!1,!1,c,b.SpreadActions.navigationBottom),f.addKeyMap(36,!1,!1,!1,!1,b.SpreadActions.navigationHome),f.addKeyMap(36,!0,!1,!1,!1,b.SpreadActions.navigationFirst),f.addKeyMap(35,!1,!1,!1,!1,b.SpreadActions.navigationEnd),f.addKeyMap(35,!0,!1,!1,!1,b.SpreadActions.navigationLast),f.addKeyMap(9,!1,!1,!1,!1,b.SpreadActions.commitInputNavigationTabNext),f.addKeyMap(9,!1,!0,!1,!1,b.SpreadActions.commitInputNavigationTabPrevious),f.addKeyMap(33,!1,!1,!1,!1,b.SpreadActions.navigationPageUp),f.addKeyMap(34,!1,!1,!1,!1,b.SpreadActions.navigationPageDown),f.addKeyMap(33,a,!1,!1,c,b.SpreadActions.navigationPreviousSheet),f.addKeyMap(34,a,!1,!1,c,b.SpreadActions.navigationNextSheet),f.addKeyMap(46,!1,!1,!1,!1,b.SpreadActions.clear),f.addKeyMap(8,!1,!1,!1,!1,b.SpreadActions.clearAndEditing),f.addKeyMap(13,!1,!1,!1,!1,b.SpreadActions.commitInputNavigationDown),f.addKeyMap(13,!1,!0,!1,!1,b.SpreadActions.commitInputNavigationUp),f.addKeyMap(27,!1,!1,!1,!1,b.SpreadActions.cancelInput),f.addKeyMap(13,!0,!0,!1,!1,b.SpreadActions.commitArrayFormula),f.addKeyMap(37,!1,!0,!1,!1,b.SpreadActions.selectionLeft),f.addKeyMap(39,!1,!0,!1,!1,b.SpreadActions.selectionRight),f.addKeyMap(38,!1,!0,!1,!1,b.SpreadActions.selectionUp),f.addKeyMap(40,!1,!0,!1,!1,b.SpreadActions.selectionDown),f.addKeyMap(36,!1,!0,!1,!1,b.SpreadActions.selectionHome),f.addKeyMap(35,!1,!0,!1,!1,b.SpreadActions.selectionEnd),f.addKeyMap(33,!1,!0,!1,!1,b.SpreadActions.selectionPageUp),f.addKeyMap(34,!1,!0,!1,!1,b.SpreadActions.selectionPageDown),f.addKeyMap(37,a,!0,!1,c,b.SpreadActions.selectionHome),f.addKeyMap(39,a,!0,!1,c,b.SpreadActions.selectionEnd),f.addKeyMap(38,a,!0,!1,c,b.SpreadActions.selectionTop),f.addKeyMap(40,a,!0,!1,c,b.SpreadActions.selectionBottom),f.addKeyMap(36,!0,!0,!1,!1,b.SpreadActions.selectionFirst),f.addKeyMap(35,!0,!0,!1,!1,b.SpreadActions.selectionLast),f.addKeyMap(67,a,!1,!1,c,b.SpreadActions.copy),f.addKeyMap(88,a,!1,!1,c,b.SpreadActions.cut),f.addKeyMap(86,a,!1,!1,c,b.SpreadActions.paste),f.addKeyMap(90,a,!1,!1,c,b.SpreadActions.undo),f.addKeyMap(89,a,!1,!1,c,b.SpreadActions.redo)},c.prototype._setHost=function(a){var c=b.util._isStandardCanvas(),d=b.util._isSilverlightCanvas();if(c||!d){var e=this,f=e._eventHandler,g=o.createElement("canvas");g.setAttribute("id",a.getAttribute("id")+"_vp"),$(g).html("You need a browser which full supports HTML5 Canvas to run SpreadJS"),a.appendChild(g),g.gcObject=!0;var h=e._canvas;h&&($(h).unbind(y).unbind(z).unbind(A).unbind(B).unbind(C).unbind(D),e._unbindTouchEvents(),h.parentNode&&h.parentNode.removeChild(h)),e._canvas=g,b.features.comment&&(e._commentRender=e.parent?e.parent._commentRender:new b.CommentRender(e._getContainerDiv())),g.setAttribute("renderMethod","auto");var i=b.util.device(),j=i.ipad||i.iphone;if(e._mouseDownDelegate=function(a){if(!j){var c=e._touchManager;return c&&c.preProcessMouseDown(a)?void b.util.cancelDefault(a):f.doMouseDown(a)}},e._mouseMoveDelegate=function(a){if(!j){var c=e._touchManager;return c&&c.preProcessMouseMove(a)?void b.util.cancelDefault(a):void(f._isMouseCapture||f.doMouseMove(a))}},e._mouseUpDelegate=function(a){if(!j){var c=e._touchManager;if(c&&c.preProcessMouseUp(a))return void b.util.cancelDefault(a);if(!e._continueMouseUpBubble){if(f._isMouseCapture)return;return f.doMouseUp(a)}}},e._mouseOutDelegate=function(a){return j?void 0:f.doMouseOut(a)},e._dblClickDelegate=function(a){if(!j){var c,d,g,h=e;if(!h._isTouchMode){var i=h._currentTarget;if(i){h._trigger(b.Events.CellDoubleClick,{sheet:h,sheetName:h._name,sheetArea:i.hitTestType,row:i.row,col:i.col});var k=i.resizeInfo;if(k){if("sizeRow"===k.action){var l=[];if(h._isRowSelected(k.index)){for(c=0;c<h._selectionModel.length;c++)if(d=h._selectionModel[c],-1===d.col){d=h._getActualRange(d);for(var m=0;m<d.rowCount;m++)l.push({row:d.row+m})}}else l.push({row:k.index});g=new b.UndoRedo.RowAutoFitUndoAction(h,l,1===k.sheetArea),h._doCommand(g)}else{var n=[];if(h._isColumnSelected(k.index)){for(c=0;c<h._selectionModel.length;c++)if(d=h._selectionModel[c],-1===d.row){d=h._getActualRange(d);for(var o=0;o<d.colCount;o++)n.push({col:d.col+o})}}else n.push({col:k.index});g=new b.UndoRedo.ColumnAutoFitUndoAction(h,n,2===k.sheetArea),h._doCommand(g)}return}}return f.startEdit(a)}}},e._mouseWheelDelegate=function(a){if(!j){a=a?a:window.event;var c=a.detail?a.detail:a.wheelDelta/-40;return f.doMouseWheel(a,parseInt(c,10)),b.util.cancelDefault(a),!1}},$(g).bind(y,e._mouseDownDelegate).bind(z,e._mouseMoveDelegate).bind(A,e._mouseUpDelegate).bind(B,e._mouseOutDelegate).bind(C,e._dblClickDelegate).bind(D,e._mouseWheelDelegate),e._bindTouchEvents(),e._initializeActiveCell(),f.doResize(),e.parent&&e.parent._paintSpreadBackgroundImage(),b.features.floatingObject&&($(window.document.body).scroll(function(){var a=e.parent.getActiveSheet(),b=a._render,c=a._floatingObjectArray;c&&c.length>0&&b&&b._paintFloatingObject(a._bounds)}),e._bind(b.Events.ColumnChanged,function(a,b){var c=b.propertyName;("width"===c||"isVisible"===c)&&e._updateFloatingObjectsLayout()}),e._bind(b.Events.RowChanged,function(a,b){var c=b.propertyName;("height"===c||"isVisible"===c)&&e._updateFloatingObjectsLayout()}),e._bind(b.Events.ColumnWidthChanged,function(){e._updateFloatingObjectsLayout()}),e._bind(b.Events.RowHeightChanged,function(){e._updateFloatingObjectsLayout()})),b.features.comment){var k=e._commentManager;e._bind(b.Events.ColumnChanged,function(a,b){var c=b.propertyName;("width"===c||"isVisible"===c)&&k.updateCommentsLayoutWhenRowColumnChanged()}),e._bind(b.Events.RowChanged,function(a,b){var c=b.propertyName;("height"===c||"isVisible"===c)&&k.updateCommentsLayoutWhenRowColumnChanged()}),e._bind(b.Events.ColumnWidthChanged,function(){k.updateCommentsLayoutWhenRowColumnChanged()}),e._bind(b.Events.RowHeightChanged,function(){k.updateCommentsLayoutWhenRowColumnChanged()}),e._bind(b.Events.CommentChanged,function(a,b){var c=b.propertyName,d=k.getCommentView(b.comment);"autoSize"===c?d.updateLayoutWhenAutosizeChanged():"location"===c?d.updateLayoutWhenLocationChanged():("width"===c||"height"===c)&&d.updateLayoutWhenWidthHeightChanged()})}}},c.prototype._unbindTouchEvents=function(){this._touchManager&&this._touchManager.detach()},c.prototype._bindTouchEvents=function(){if(b.features.touch){var a=this,c=a.parent,d=c&&c._touchEventProvider?c._touchEventProvider:new b.TouchEventProvider,e=new b.TouchManager(a._canvas,a,d);e.attach(),a._touchManager=e}},c.prototype._disposeValidationUI=function(){var a=this,b=a._validationInputMessage;if(b){var c=b.parentNode;c&&c.removeChild(b),a._validationInputMessage=e}var d=a._validationButton;if(d){var c=d.parentNode;c&&c.removeChild(d),a._validationButton=e}var f=a._validationSelect;if(f){var c=f.parentNode;c&&c.removeChild(f),a._validationSelect=e}},c.prototype._disposeFloatingObjectUI=function(){var a=this._render,b=a&&a._floatingObjectRenderManager;if(b){var c,d,f,g;for(c=0,f=b.length;f>c;c++){var h=b[c];if(h){for(d=0,g=h.length;g>d;d++){var i=h[d];i&&i._dispose()}h.length=0}}b.length=0,b=e}},c.prototype._disposeComment=function(){var a=this,b=a._commentManager;b&&b.hideAllComments()},c.prototype._dispose=function(){var a=this;a.isEditing()&&a.endEdit();var c=a._canvas;c&&($(c).unbind(y).unbind(z).unbind(A).unbind(B).unbind(C).unbind(D),c.parentNode.removeChild(c),a._canvas=e),$(window).unbind(E),b.StyleHelper._disposeMeasureSpan();var d=a._eventHandler;d&&(d._dispose(),d._disposeFocusHolders());var f=a._filterDialiog;f&&f.close();var g=a._smartTag;g&&g.close();var h=a._editor;h&&$(h).remove();var i=a._cutCopyIndicatorManager;i&&i._dispose(),a._disposeValidationUI(),a._disposeFloatingObjectUI(),a._disposeComment(),a._disposeStringWidthPre(),a._disposeStringWidthSpan()},c.prototype._disposeStringWidthSpan=function(){var a=this._editingSpan;a&&($(a).remove(),this._editingSpan=f)},c.prototype._disposeStringWidthPre=function(){var a=this._editingPre;a&&($(a).remove(),this._editingPre=f)},c.prototype._getModel=function(a){var b=this;return 3===a||typeof a===j||a===e?b._dataModel:2===a?b._rowHeaderModel:1===a?b._colHeaderModel:e},c.prototype._getCalcModel=function(a){return a===f||a===e||3===a?this._calcDataModel:e},c.prototype._getValueImp=function(a,c,d,f){var g=this;(typeof f===j||f===e)&&(f=3);var h=3===f,i=e,k=!1,l=g._tableManager;if(h&&l&&l._tableList.length>0){var n=l.find(c,d);if(n&&n.showHeader()&&c===n.headerIndex()){var o=n._getColumn(d);o&&(k=!0,(typeof i===j||i===e)&&(i=o.name()))}}if(typeof i===j||i===e){var p=g._bindingManager,q=p&&p._dataSource;q&&h&&(i=p.getValue(c,d))}if((typeof i===j||i===e)&&(i=a.getValue(c,d)),typeof i===m&&"/"===i.charAt(0)){var r;Q.test(i)?(r=i.match(Q),i=b._DateTimeHelper.fromOADate(parseFloat(r[1]))):P.test(i)&&(r=i.match(P),i=new Date(parseFloat(r[1])))}return k&&i!==e&&typeof i!==j&&(i=b.util.toString(i)),i},c.prototype._getSwapIndex=function(a,b,c){for(var d=a[c-b];d.index<c;)d=a[d.index-b];return d.index},c.prototype._quickSortImp=function(a){if(a.length<=1)return a;for(var b=i(a.length/2),c=a[b],d=[],e=[],f=[],g=0;g<a.length;g++){var h=this._sortCompare(a[g],c);0>h?d.push(a[g]):h>0?e.push(a[g]):f.push(a[g])}return this._quickSortImp(d).concat(f,this._quickSortImp(e))},c.prototype._quickSort=function(a,b,c,d,e,f){var g,h=e?c:d,i=[];if(e)for(g=0;h>g;g++)i[g]={sheet:this,index:a+g,byRows:e,sortInfo:f};else for(g=0;h>g;g++)i[g]={sheet:this,index:b+g,byRows:e,sortInfo:f};return i=this._quickSortImp(i)},c.prototype._isEquals=function(a,c){return a instanceof Date&&c instanceof Date?new b._DateTimeHelper(a).toOADate()===new b._DateTimeHelper(c).toOADate():a===c},c.prototype._isGreaterThan=function(a,c){return"boolean"==typeof a?a=a?1:0:a instanceof Date&&(a=new b._DateTimeHelper(a).toOADate()),"boolean"==typeof c?c=c?1:0:c instanceof Date&&(c=new b._DateTimeHelper(c).toOADate()),typeof a==typeof c||"number"!=typeof a&&"number"!=typeof c?a>c:"number"==typeof c},c.prototype._sortCompare=function(a,b){if(a.sortInfo&&a.sortInfo.length>0){for(var c,d,g,h,i=this,j=0,k=0;k<a.sortInfo.length;k++){if(a.sortInfo[k]){var l=a.sortInfo[k].ascending,m=a.sortInfo[k].index;m>=0&&(a.byRows?(c=a.sheet.getValue(a.index,m),d=b.sheet.getValue(b.index,m),g=c===f||c===e||""===c,h=d===f||d===e||""===d,g||h?g&&h?j=0:g&&!h?j=1:!g&&h&&(j=-1):j=i._isEquals(c,d)?0:i._isGreaterThan(c,d)?l?1:-1:l?-1:1):(c=a.sheet.getValue(m,a.index),d=b.sheet.getValue(m,b.index),g=c===f||c===e||""===c,h=d===f||d===e||""===d,g||h?g&&h?j=0:g&&!h?j=1:!g&&h&&(j=-1):j=i._isEquals(c,d)?0:i._isGreaterThan(c,d)?l?1:-1:l?-1:1))}if(0!==j)break}return j}return 0},c.prototype._getActualRange=function(a,c){(typeof c===j||c===e)&&(c=3);var d=new b.Range(-1,-1,-1,-1);return a===e||typeof a===j?d:(d.col=a.col,d.row=a.row,d.colCount=a.colCount,d.rowCount=a.rowCount,-1===d.col&&(d.col=0,d.colCount=this.getColumnCount(c)),-1===d.row&&(d.row=0,d.rowCount=this.getRowCount(c)),d)},c.prototype._getRangeRect=function(a,c,d){var e=new b.Rect(-1,-1,-1,-1),f=this,g=f._getSheetLayout();if(0===g.width||0===g.height)return e;var h=f._getViewportColumnLayout(c),i=f._getViewportRowLayout(a);if(!h||0===h.length||!i||0===i.length)return e;var j=f._getActualRange(d),k=f._cachePool,l=function(a,b){for(var c,d=0,e=a;b>=e;e++)c=k.getCachedColumn(e),d+=c.width;return d},m=function(a,b){for(var c,d=0,e=a;b>=e;e++)c=k.getCachedRow(e),d+=c.height;return d},n=j.row,o=j.row+j.rowCount-1,p=j.col,q=j.col+j.colCount-1,r=f.frozenRowCount,s=f.getRowCount()-f._frozenTrailingRowCount-1,t=f.frozenColCount,u=f.getColumnCount()-f._frozenTrailingColCount-1,v=h[0].col,w=h[h.length-1].col,x=i[0].row,y=i[i.length-1].row,z=function(a,b){for(;a>b;)if(a--,f.getColumnVisible(a))return a;return a},A=function(a,b){for(;b>a;)if(a++,f.getColumnVisible(a))return a;return a},B=function(a,b){for(;a>b;)if(a--,f.getRowVisible(a))return a;return a},C=function(a,b){for(;b>a;)if(a++,f.getRowVisible(a))return a;return a};return v>p&&(p=z(v,p)),q>w&&(q=A(w,q)),x>n&&(n=B(x,n)),o>y&&(o=C(y,o)),p>q||n>o?e:(0===c?t>p&&(e.x=g.frozenX+l(0,p-1),e.width=l(p,q)):1===c?u>=p&&q>=t&&(e.x=v>p?g.viewportX-l(p,v-1):g.viewportX+l(v,p-1),e.width=l(p,q)):2===c&&q>u&&(e.x=v>p?g.frozenTrailingX-l(p,v-1):g.frozenTrailingX+l(v,p-1),e.width=l(p,q)),0===a?r>n&&(e.y=g.frozenY+m(0,n-1),e.height=m(n,o)):1===a?s>=n&&o>=r&&(e.y=x>n?g.viewportY-m(n,x-1):g.viewportY+m(x,n-1),e.height=m(n,o)):2===a&&o>s&&(e.y=x>n?g.frozenTrailingY-m(n,x-1):g.frozenTrailingY+m(x,n-1),e.height=m(n,o)),e)},c.prototype._getRangeRect2=function(a){var c=this,d=new b.Rect(-1,-1,-1,-1),e=c._getSheetLayout();if(0===e.width||0===e.height)return d;var f,i,j=c._getActualRange(a),k=isNaN(c.frozenColCount)?0:c.frozenColCount,l=isNaN(c.frozenRowCount)?0:c.frozenRowCount,m=isNaN(c._frozenTrailingColCount)?0:c._frozenTrailingColCount,n=isNaN(c._frozenTrailingRowCount)?0:c._frozenTrailingRowCount,o=c._cachePool,p=function(a,b){for(var c,d=0,e=a;b>=e;e++)c=o.getCachedColumn(e),d+=c.width;return d},q=function(a,b){for(var c,d=0,e=a;b>=e;e++)c=o.getCachedRow(e),d+=c.height;return d},r=j.row,s=j.row+j.rowCount-1,t=j.col,u=j.col+j.colCount-1,v=c.getRowCount(),w=c.getColumnCount();if(k>t)d.x=e.frozenX+p(0,t-1),d.width=p(t,g(u,k-1)),u>=k&&w-m>u?(f=c._getViewportColumnLayout(1),f&&f.length>0&&(d.width+=p(f[0].col,g(u,f[f.length-1].col)))):u>=w-m&&(f=c._getViewportColumnLayout(2),f&&f.length>0&&(d.width=f[0].x-d.x,d.width+=p(w-m,g(u,w-1))));else if(w-m>t){if(f=c._getViewportColumnLayout(1),!f||0===f.length||t>f[f.length-1].col||u<f[0].col)return d;d.x=e.viewportX+p(f[0].col,t-1),u>=k&&w-m>u?d.width=p(h(t,f[0].col),g(u,f[f.length-1].col)):u>=w-m&&(f=c._getViewportColumnLayout(2),f&&f.length>0&&(d.width=f[0].x-d.x,d.width+=p(w-m,g(u,w-1))))}else w>t&&(f=c._getViewportColumnLayout(2),f&&f.length>0&&(d.x=e.frozenTrailingX+p(f[0].col,t-1),d.width=p(t,g(u,w-1))));if(l>r)d.y=e.frozenY+q(0,r-1),d.height=q(r,g(s,l-1)),s>=l&&v-n>s?(i=c._getViewportRowLayout(1),i&&i.length>0&&(d.height+=q(i[0].row,g(s,i[i.length-1].row)))):s>=v-n&&(i=c._getViewportRowLayout(2),i&&i.length>0&&(d.height=i[0].y-d.y,d.height+=q(v-n,g(s,v-1))));else if(v-n>r){if(i=c._getViewportRowLayout(1),!i||0===i.length||r>i[i.length-1].row||s<i[0].row)return d;d.y=e.viewportY+q(i[0].row,r-1),s>=l&&v-n>s?d.height=q(h(r,i[0].row),g(s,i[i.length-1].row)):s>=v-n&&(i=c._getViewportRowLayout(2),i&&i.length>0&&(d.height=i[0].y-d.y,d.height+=q(v-n,g(s,v-1))))}else v>r&&(i=c._getViewportRowLayout(2),i&&i.length>0&&(d.y=e.frozenTrailingY+q(i[0].row,r-1),d.height+=q(r,g(s,v-1))));return d},c.prototype._getCanvas=function(){var a=this._canvas;return!a&&this.parent&&(a=this.parent.canvas),a&&!a.getContext&&a.firstChild&&(a.getContext=a.firstChild.getContext),a},c.prototype._draw=function(a,b){var c=this._render,d=c._getCtx();d&&c.paint(d,b)},c.prototype._getStringWidth=function(a,b){return this._getStringWidthByCanvas(a,b)+1},c.prototype._getStringWidthByCanvas=function(a,c){var d="",e=this._render;return d=c?c:e._getZoomFont(e._getDefaultFont()),b._WordWrapHelper._measureText(a,d)},c.prototype._getFontHeight=function(a,b){var c=this,d=c.fontHeightCache;if(!b)if(d){var e=d[a];if(e)return e}else d=c.fontHeightCache={};var f=c._getEditingSpan();f.style.font=a?a:c._render._getDefaultFont(),f.innerHTML="H";var g=f.offsetHeight;return b||(d[a]=g),g},c.prototype._getEditingSpan=function(){if(!this._editingSpan){var a=o.createElement("span"),b=a.style;b.visibility=K,b.top="-10000px",b.left="-10000px",b.position="absolute",a.className="gcStringWidthSpanStyle",a.setAttribute("gcUIElement","gcStringWidthSpan"),o.body.insertBefore(a,e),this._editingSpan=a}return this._editingSpan},c.prototype._getColumnViewportIndexFromX=function(a){var b=this._getSheetLayout(),c=e;return b.headerX<a&&a<b.headerX+b.rowHeaderWidth?c=-1:b.frozenX<a&&a<b.frozenX+b.frozenWidth?c=0:b.viewportX<a&&a<b.viewportX+b.viewportWidth?c=1:b.frozenTrailingX<a&&a<b.frozenTrailingX+b.frozenTrailingWidth&&(c=2),c},c.prototype._getRowViewportIndexFromY=function(a){var b=this._getSheetLayout(),c=e;return b.headerY<a&&a<b.headerY+b.colHeaderHeight?c=-1:b.frozenY<a&&a<b.frozenY+b.frozenHeight?c=0:b.viewportY<a&&a<b.viewportY+b.viewportHeight?c=1:b.frozenTrailingY<a&&a<b.frozenTrailingY+b.frozenTrailingHeight&&(c=2),c},c.prototype._getRowIndexFromY=function(a,b){var c=e;if(c=-1===b?this._getColumnHeaderRowLayout():this._getViewportRowLayout(b)){var d=c.findY(a);if(d)return d.row}},c.prototype._getColumnIndexFromX=function(a,b){var c=e;if(c=-1===b?this._getRowHeaderColumnLayout():this._getViewportColumnLayout(b)){var d=c.findX(a);if(d)return d.col}},c.prototype._isActiveCell=function(a,b){var c=this;return c._activeRowIndex<=a&&a<c._activeRowIndex+c._activeRowCount&&c._activeColIndex<=b&&b<c._activeColIndex+c._activeColCount},c.prototype._isColumnSelected=function(a){for(var b=0;b<this._selectionModel.length;b++){var c=this._selectionModel[b],d=-1===c.col?0:c.col;if(-1===c.row&&a>=d&&a<d+c.colCount)return!0}return!1},c.prototype._isRowSelected=function(a){for(var b=0;b<this._selectionModel.length;b++){var c=this._selectionModel[b],d=-1===c.row?0:c.row;if(-1===c.col&&a>=d&&a<d+c.rowCount)return!0}return!1},c.prototype._isSelected=function(a,b,c){for(var d=!1,f=this._selectionModel,g=0,h=f.length;h>g;g++){var i=f[g],k=this._getActualRange(i);if(3===c||typeof c===j||c===e?d=k.row<=a&&a<k.row+k.rowCount&&k.col<=b&&b<k.col+k.colCount:2===c?d=k.row<=a&&a<k.row+k.rowCount:1===c?d=k.col<=b&&b<k.col+k.colCount:0===c&&(d=-1===i.row&&-1===i.col),d)return d}return d},c.prototype._isAllSelected=function(a,b,c){for(var d=this,g=!1,h=d.getRowCount(),i=d.getColumnCount(),j=0;j<d._selectionModel.length;j++){var k=d._selectionModel[j];if(c!==f&&c!==e&&3!==c)if(2===c){var l=-1===k.row?0:k.row;g=-1===k.col&&a>=l&&a<l+k.rowCount}else if(1===c){var m=-1===k.col?0:k.col;g=-1===k.row&&b>=m&&b<m+k.colCount}else 0===c&&(g=-1===k.row&&-1===k.col&&k.rowCount===h&&k.colCount===i);if(g)return g}return g},c.prototype._isHover=function(a,b,c){var d=!1,f=this._currentTarget;if(f&&typeof c!==j&&c!==e){if(1===c){var g=!1,h=this._colHeaderSpanModel.find(f.row,f.col);h&&(g=h.contains(a,b,1,1));var i=a===f.row&&b===f.col||g;return f.hitTestType===c&&i}if(2===c){var g=!1,h=this._rowHeaderSpanModel.find(f.row,f.col);h&&(g=h.contains(a,b,1,1));var i=a===f.row&&b===f.col||g;return f.hitTestType===c&&i}if(3===c)return f.hitTestType===c&&a===f.row&&b===f.col;if(0===c)return f.hitTestType===c}return d},c.prototype._indexToLetters=function(a){for(var b="A",c=b.charCodeAt(0),d="";a>0;a=(a-1)/26){var e=parseInt((a-1)%26,10);(1===a||e>=0&&a>1)&&(d=String.fromCharCode(c+e)+d)}return d},c.prototype._doStartEdit=function(a,b,c){var d=this,e=d.hitTest(b,c);if(e){var f=e.row,g=e.col;if(f>=0&&g>=0&&e.rowViewportIndex>=0&&e.colViewportIndex>=0&&!e.resizeInfo&&!e.dragInfo&&f===d._activeRowIndex&&g===d._activeColIndex){var h=d.isEditing();if(d._startEditImp(a,f,g),!h&&d.isEditing()){var i=e.hitTestType,j=d.getCellType(f,g);if(j._triggerButtonClicked){var k=d.getCellRect(f,g),l=d.getActualStyle(f,g,i),m={sheet:d,row:f,col:g,sheetArea:i},n=j.getHitInfo(b,c,l,k,m);n&&n.isReservedLocation&&j._triggerButtonClicked(d,f,g)}}}}},c.prototype._getSheetArea=function(a,b){return a>=0&&2>=a&&b>=0?3:a>=0&&2>=a&&0>b?2:0>a&&b>=0?1:0>a&&0>b?0:e},c.prototype.setFocus=function(){var a=this._eventHandler;a&&a.setFocus()},c.prototype._startEditImp=function(a,c,d,g,h,i,j){if(!(0>c||0>d)){var k=this;if(!k.isEditing()){var l=k._eventHandler;l&&l.setFocus();var m=c,n=d,p=k.getCellRect(m,n);if(!(!p||p.width<=0||p.height<=0)){k.showCell(k._activeRowIndex,k._activeColIndex,3,3);var q=k.getActualStyle(c,d);if(!k.isProtected||q.locked===!1){var r=k.getCellType(m,n);if(r){var s,t={sheet:k,row:c,col:d,sheetArea:3};if(r.isImeAware(t)?l&&(s=l._cellTypeFocusHolder):s=r.createEditorElement(t),s){k._editor=s;var u={sheet:k,sheetName:k._name,row:m,col:n,cancel:!1};if(k._trigger(b.Events.EditStarting,u),!u||u.cancel!==!0){var v=k.getValue(m,n),w=k.getFormula(m,n),x=k._editorStatus;k._editorStatus=k._startEditByKeydown?1:v!==e&&v!==f||w!==e&&w!==f?2:1,k._trigger(b.Events.EditorStatusChanged,{sheet:k,sheetName:k._name,oldStatus:x,newStatus:k._editorStatus});var y=k._getSheetLayout(),p=k.getCellRect(m,n,g,h);r.isImeAware(t)&&l._resetFocusHolder(),r.activateEditor(k._editor,q,p,t),k._setEditorValue(r,k._editor,m,n,q,j);var z=1,A=2;if(k.showEditingLocator){var B=r._getLocator();s._editingLocator=B;var C=k.getValue(k._getModel(z).rowCount-1,d,z),D=k.getValue(c,k._getModel(A).colCount-1,A);B.innerHTML=C+""+D,r._updateEditorLocator(k._editor,t),o.body.insertBefore(B,e)}if(r.isImeAware(t)||o.body.insertBefore(k._editor,e),r.updateEditor(k._editor,q,p,t),r.isImeAware(t)&&i||r.focus(k._editor,t),i&&r.selectAll(k._editor,t),k._allowCellOverflow){var E=k.getCellRect(c,d,g,h);E.x-=2,E.y-=2,E.width+=4,E.height+=4,E.x=y.frozenX,E.width=y.viewportWidth,k.repaint(E)}k._render.refreshTouchSelectionIndicator(),k._attachFormlulaTextBox(r.getEditingElement()),window.gcGlobal.activeElement=k,k._trigger(b.Events.EditStarted,{sheet:k,sheetName:k._name,row:m,col:n})}}}}}}}},c.prototype._setEditorValue=function(a,b,c,d,g,h){var i=this,j=i.getFormula(c,d);j&&(j="="+j);var k=j,l={sheet:i,row:c,col:d,sheetArea:3};if(!j||0===j.length){j=i.getValue(c,d);var m=i.parent?i.parent.canUserEditFormula():!0;j&&j.length>0&&/^=/gi.test(j)&&m&&(j="'"+j),k=j,j=a._formatEditorValue(b,g,j,l)}b._oldValue=j,h!==e&&h!==f&&(j=h),a.setEditorValue(b,j,l),b._originalValue=k},c.prototype._attachFormlulaTextBox=function(a){if(b.features.formulatextbox&&a){var c=this;c._formulaTextBox&&c._formulaTextBox.destroy(),c._formulaTextBox=new b.FormulaTextBox(a);var d=c._formulaTextBox,e=c._eventHandler,f=c._render;d.bind("AppendStarted",function(){d.close();var a=$.wijmo.wijspread.EditorStatus,b=c._editorStatus;b!==a.Enter&&(c._editorStatus=a.Enter,c._trigger("EditorStatusChanged",{sheet:c,sheetName:c._name,oldStatus:b,newStatus:a.Enter}))}),d.bind("AppendEnded",function(){f.paintFormulaTextBox()}),d.bind("TextChanged",function(a,g){if(g&&"input"!==g.type){e.updateEditingEditor();var h=c._activeRowIndex,i=c._activeColIndex,j=c.getCellType(h,i);c._trigger(b.Events.EditChange,{sheet:c,sheetName:c._name,row:h,col:i,editingText:j.getEditorValue(c._editor)})}f.paintFormulaTextBox(),c._trigger("FormulaTextBoxTextChanged",{sheet:c,sheetName:c._name,text:d.text()})}),d.bind("CaretChanged",function(){f.paintFormulaTextBox(),c._trigger("FormulaTextBoxCaretChanged",{sheet:c,sheetName:c._name,caret:d.caret()})}),d.add(b.SR.getHelpFuncs());var g=this._functionDescriptions;g&&g.length>0&&d.add(g),g=this.parent&&this.parent._functionDescriptions,g&&g.length>0&&d.add(g),f.paintFormulaTextBox()}},c.prototype._detachFormulaTextBox=function(){var a=this;a._formulaTextBox&&(a._formulaTextBox.destroy(),a._formulaTextBox=e,a._render.paintFormulaTextBox())},c.prototype._showEditingLocator=function(){var a=this;if(a.isEditing()!==!1){var b=a._editor,c=b&&b._editingLocator;if(c){var d=$(b),e=parseInt(d.css(G),10)+a.getColumnWidth(a._activeColIndex)/2,f=parseInt(d.css(H),10)+a.getRowHeight(a._activeRowIndex)/2,g=$(a._getCanvas()).offset();e-=g.left,f-=g.top;var h=a._getRowIndexFromY(f,a._getRowViewportIndexFromY(f)),i=a._getColumnIndexFromX(e,a._getColumnViewportIndexFromX(e));h===a._activeRowIndex&&i===a._activeColIndex?$(c).css(L,K):$(c).css(L,"visible")}}},c.prototype._getKeyAction=function(a,b,c,d,f){var g=this.keyMap;if(!g)return e;for(var h,i=g.length,j=0;i>j;j++)if(h=g[j],h&&h.key===a&&h.ctrl===b&&h.shift===c&&h.alt===d&&h.meta===f)return h;return e},c.prototype._getFloatingObjectKeyAction=function(a,b,c,d,f){var g=this.floatingObjectKeyMap;if(!g)return e;for(var h,i=g.length,j=0;i>j;j++)if(h=g[j],h&&h.key===a&&h.ctrl===b&&h.shift===c&&h.alt===d&&h.meta===f)return h;return e},c.prototype._getCommentKeyAction=function(a,b,c,d,f){if(!this._commentKeyMap)return e;for(var g,h=0;h<this._commentKeyMap.length;h++)if(g=this._commentKeyMap[h],g&&g.key===a&&g.ctrl===b&&g.shift===c&&g.alt===d&&g.meta===f)return g;return e},c.prototype._moveActiveCellUp=function(a,b,c){var d=this,e=d._getMoveUpCell(a,b,c,d._leadingCellCol||0);if(e){var f=e.row,g=e.col,h=e.leadingCellCol;d._canMoveCurrentTo(f,g)&&(d._leadingCellRow=f,d._leadingCellCol=h,d._setActiveCellCore(f,g))}},c.prototype._getMoveUpCell=function(a,b,c,d){var g=a,h=b;if(0===g&&!c)return e;var i=this,j=i.getRowCount(),k=i.getColumnCount(),l=i._getPrevRow(g,d);return c||i._adjustCell(l),g=l.r,h=l.c,0>g&&c&&(h=i._getPrevVisualColumn(h),(0>h||h===f||h===e)&&(h=i._getPrevVisualColumn(k)),d=h,l=i._getPrevRow(j,h),g=l.r,h=l.c,h===b&&a>=g)?e:{row:g,col:h,leadingCellCol:d}},c.prototype._moveActiveCellDown=function(a,b,c){var d=this,e=d._getMoveDownCell(a,b,c,d._leadingCellCol||0);if(e){var f=e.row,g=e.col,h=e.leadingCellCol;d._canMoveCurrentTo(f,g)&&(d._leadingCellRow=f,d._leadingCellCol=h,d._setActiveCellCore(f,g))}},c.prototype._getMoveDownCell=function(a,b,c,d){var g=this,h=g.getRowCount(),i=g.getColumnCount(),j=a,k=b;if(j!==h-1||c){var l=g._getNextRow(j,d);if(c||g._adjustCell(l),j=l.r,k=l.c,!(j===h&&c&&(k=g._getNextVisualColumn(k),(k>=i||k===f||k===e)&&(k=g._getNextVisualColumn(-1)),d=k,l=g._getNextRow(-1,k),j=l.r,k=l.c,k===b&&j>=a)))return{row:j,col:k,leadingCellCol:d}}},c.prototype._moveActiveCellLeft=function(a,b,c){var d=this,e=d._getMoveLeftCell(a,b,c,d._leadingCellRow||0);if(e){var f=e.row,g=e.col,h=e.leadingCellRow;d._canMoveCurrentTo(f,g)&&(d._leadingCellRow=h,d._leadingCellCol=g,d._setActiveCellCore(f,g))}},c.prototype._getMoveLeftCell=function(a,b,c,d){var g=a,h=b;if(0===h&&!c)return e;var i=this,j=i.getRowCount(),k=i.getColumnCount(),l=i._getPrevColumn(d,h);for(c||i._adjustCell(l),g=l.r,h=l.c;0>h&&c;)if(g=i._getPrevVisualRow(g,3,!0),(0>g||g===f||g===e)&&(g=i._getPrevVisualRow(j,3,!0)),d=g,l=i._getPrevColumn(g,k),g=l.r,h=l.c,g===a&&b>=h)return e;return{row:g,col:h,leadingCellRow:d}},c.prototype._adjustCell=function(a){var b=this;a.r<0?a.r=b._getFirstVisualRow():a.r>=b.getRowCount()&&(a.r=b._getLastVisualRow()),a.c<0?a.c=b._getFirstVisualColumn():a.c>=b.getColumnCount()&&(a.c=b._getLastVisualColumn())},c.prototype._fixRange=function(a){var c=a.row<0?0:a.row,d=a.col<0?0:a.col,e=a.row<0?this.getRowCount():a.rowCount,f=a.col<0?this.getColumnCount():a.colCount;return new b.Range(c,d,e,f)},c.prototype._moveActiveCellLeftInSelection=function(a,b){for(var c,d=this,e=d._selectionModel,f=e.activeSelectedRangeIndex,g=-1,h=d._fixRange(d._getActiveSelectedRange()),i=h.row,j=h.col,k=h.col+h.colCount-1,l=a,m=b;;){if(c=d._getPrevColumnInSelection(l,m),l=c.r,m=c.c,m>=j)break;if(g===f&&l===a&&b>=m)return;if(l--,l>=i)m=k+1;else{var n=d._fixRange(d._getActiveSelectedRange(3));g=e.activeSelectedRangeIndex,i=n.row,j=n.col,k=n.col+n.colCount-1,l=n.row+n.rowCount-1,m=n.col+n.colCount}}l>=0&&(d._setActiveCellCore(l,m),d._leadingCellRow=l,d._leadingCellCol=m)},c.prototype._moveActiveCellRightInSelection=function(a,b){for(var c,d=this,e=d._selectionModel,f=e.activeSelectedRangeIndex,g=-1,h=d._fixRange(d._getActiveSelectedRange()),i=h.col,j=h.row+h.rowCount-1,k=h.col+h.colCount-1,l=a,m=b;;){if(c=d._getNextColumnInSelection(l,m),l=c.r,m=c.c,k>=m)break;
if(g===f&&l===a&&m>=b)return;if(l++,j>=l)m=i-1;else{var n=d._fixRange(d._getActiveSelectedRange(4));g=e.activeSelectedRangeIndex,i=n.col,j=n.row+n.rowCount-1,k=n.col+n.colCount-1,l=n.row,m=n.col-1}}l>=0&&(d._setActiveCellCore(l,m),d._leadingCellRow=l,d._leadingCellCol=m)},c.prototype._moveActiveCellRight=function(a,b,c){var d=this,e=d._getMoveRightCell(a,b,c,d._leadingCellRow||0);if(e){var f=e.row,g=e.col,h=e.leadingCellRow;d._canMoveCurrentTo(f,g)&&(d._leadingCellRow=h,d._leadingCellCol=g,d._setActiveCellCore(f,g))}},c.prototype._getMoveRightCell=function(a,b,c,d){var g=this,h=g.getRowCount(),i=g.getColumnCount(),j=a,k=b;if(k===i-1&&!c)return e;var l=g._getNextColumn(d,k);if(!c){if(l.c===i)return e;g._adjustCell(l)}for(j=l.r,k=l.c;k===i&&c;)if(j=g._getNextVisualRow(j,!0),(j>=h||j===f||j===e)&&(j=g._getNextVisualRow(-1,!0)),d=j,l=g._getNextColumn(j,-1),j=l.r,k=l.c,j===a&&k>=b)return e;return{row:j,col:k,leadingCellRow:d}},c.prototype._getPrevColumn=function(a,c){for(var d={r:a,c:c};c>=0&&(a=d.r,c--,!(0>c));){var e=this.getSpans(new b.Range(a,c,1,1));if(e&&e.length>0){var f=e[0];c>=f.col&&(c=f.col,a=f.row)}if(this._canMoveCurrentTo(a,c))return{r:a,c:c}}return{r:a,c:c}},c.prototype._getPrevColumnInSelection=function(a,b){for(;b>=0&&(b--,!(0>b));){var c=this._spanModel.find(a,b);if(c){var d=this._getActiveSelectedRange();if(!(d.row<=c.row&&c.row+c.rowCount<=d.row+d.rowCount&&d.col<=c.col&&c.col+c.colCount<=d.col+d.colCount))continue;if(c.row!==a||c.col!==b)continue;b>=c.col&&(b=c.col,a=c.row)}if(this._canMoveCurrentTo(a,b))return{r:a,c:b}}return{r:a,c:b}},c.prototype._getNextColumn=function(a,c){for(var d=this,e=d.getColumnCount(),f={r:a,c:c};e>c;){a=f.r;var g=d._spanModel.find(a,c);if(g?c+=g.colCount:c++,c>=e)break;var i=d.getSpans(new b.Range(a,c,1,1));if(i&&i.length>0){var j=i[0];c>j.col?c=h(c,j.col+j.colCount):a=j.row}if(d._canMoveCurrentTo(a,c))return{r:a,c:c}}return{r:a,c:c}},c.prototype._getNextColumnInSelection=function(a,b){for(var c=this,d=c.getColumnCount();d>b;){var e=c._spanModel.find(a,b);if(e?b+=e.colCount:b++,b>=d)break;var f=c._spanModel.find(a,b);if(f){var g=c._getActiveSelectedRange();if(!(g.row<=f.row&&f.row+f.rowCount<=g.row+g.rowCount&&g.col<=f.col&&f.col+f.colCount<=g.col+g.colCount))continue;if(f.row!==a||f.col!==b)continue;b>f.col?b=h(b,f.col+f.colCount):a=f.row}if(c._canMoveCurrentTo(a,b))return{r:a,c:b}}return{r:a,c:b}},c.prototype._canMoveCurrentTo=function(a,b){var c=this,d=!1,e=c.getRowVisible(a),f=c.getColumnVisible(b),g=c._getZoomRowHeight(a),h=c._getZoomColumnWidth(b);d=a>=0&&a<c.getRowCount()&&b>=0&&b<c.getColumnCount()&&e&&f&&g>0&&h>0;var i=!!c._isTabNavigation;if(d===!0&&i===!0){var j=c.getActualStyle(a,b);j&&j.tabStop===!1&&(d=!1)}return d},c.prototype._getPrevRow=function(a,c){for(;a>=0&&(a--,!(0>a));){var d=this.getSpans(new b.Range(a,c,1,1));if(d&&d.length>0){var e=d[0];a>=e.row&&(a=e.row,c=e.col)}if(this._canMoveCurrentTo(a,c))return{r:a,c:c}}return{r:a,c:c}},c.prototype._getNextRow=function(a,c){for(var d=this,e=d.getRowCount();e>a;){var f=d._spanModel.find(a,c);if(f?a+=f.rowCount:a++,a>=e)break;var g=d.getSpans(new b.Range(a,c,1,1));if(g&&g.length>0){var i=g[0];a>i.row?a=h(a,i.row+i.rowCount):c=i.col}if(d._canMoveCurrentTo(a,c))return{r:a,c:c}}return{r:a,c:c}},c.prototype._setSelectedRange=function(a,b,c,d,e){this._selectionModel.add(a,b,c,d),e&&!this._paintSuspended&&this._render.repaintSelection()},c.prototype._extendSelectedRange=function(a,b,c){var d=this,e=d._getExtendedRange(a,b,d._activeRowIndex,d._activeColIndex),f=e.row,g=e.col,h=e.rowCount,i=e.colCount,j=d.selectionPolicy(),k=d.selectionUnit();0!==j&&(1===j&&d._selectionModel.clear(),1===k?(g=-1,i=-1):2===k&&(f=-1,h=-1),d._replaceActiveSelectedRange(f,g,h,i,c))},c.prototype._getExtendedRange=function(a,c,d,e){var f=this;typeof d===j&&(d=f._activeRowIndex),typeof e===j&&(e=f._activeColIndex);var g=new b.Range(d,e,1,1),h=f._spanModel.find(d,e);h&&(g=h);var i=new b.Range(a,c,1,1),k=f._spanModel.find(a,c);k&&(i=k);var l=g.union(i),m=f.getSpans();return m&&m.length>0&&(l=f._inflateRangeToCoverSpans(m,l)),l},c.prototype._replaceActiveSelectedRange=function(a,c,d,e,f){var g=this,h=g._getActiveSelectedRange();if(g._selectionModel.length>0?g._selectionModel.splice(g._selectionModel.activeSelectedRangeIndex,1,new b.Range(a,c,d,e)):g._selectionModel.add(a,c,d,e),f&&!g._paintSuspended){var i=g._getActiveSelectedRange();if(i.row===h.row&&i.col===h.col&&i.rowCount===h.rowCount&&i.colCount===h.colCount)return;var j=g._render;h.containsRange(i)?j.repaintSelection(h):i.containsRange(h)?j.repaintSelection(i):(j.repaintSelection(h),j.repaintSelection(i))}},c.prototype._changeActiveSelectedRange=function(a,c){var d=this;if(!(d._selectionModel.length<=0)){var e=d._getActiveSelectedRange(),f=d._getKeyboardSelectedRange(e,a,c);if(f){var g=d._selectionModel.toArray(),h=f.row,i=f.col,j=f.rowCount,k=f.colCount,l=d.selectionPolicy(),m=d.selectionUnit();if(0===l)return;1===l&&d._selectionModel.clear(),1===m?(i=-1,k=-1):2===m&&(h=-1,j=-1),d._replaceActiveSelectedRange(h,i,j,k,!0);var n=d._selectionModel.toArray();d._eventHandler._notEqualSelecions(g,n)&&(d._trigger(b.Events.SelectionChanging,{sheet:d,sheetName:d._name,oldSelections:g,newSelections:n}),d._trigger(b.Events.SelectionChanged,{sheet:d,sheetName:d._name}))}}},c.prototype._getKeyboardSelectedRange=function(a,b,c,d,f){var g=this,h=g._fixRange(a),i=e;return 37===b?i=c?g._searchSelectedRangebyLeftCtrl(h,!1,d,f):g._searchSelectedRangebyLeft(h,d,f):39===b?i=c?g._searchSelectedRangebyRightCtrl(h,!1,d,f):g._searchSelectedRangebyRight(h,d,f):38===b?i=c?g._searchSelectedRangebyUpCtrl(h,!1,d,f):g._searchSelectedRangebyUp(h,d,f):40===b?i=c?g._searchSelectedRangebyDownCtrl(h,!1,d,f):g._searchSelectedRangebyDown(h,d,f):36===b?i=c?g._searchSelectedRangebyHomeCtrl(h,d,f):g._searchSelectedRangebyHome(h,d,f):35===b?i=c?g._searchSelectedRangebyEndCtrl(h,d,f):g._searchSelectedRangebyEnd(h,d,f):33===b?i=g._searchSelectedRangebyPageUp(h,d,f):34===b&&(i=g._searchSelectedRangebyPageDown(h,d,f)),i&&(a.row<0&&(i.row=-1,i.rowCount=-1),a.col<0&&(i.col=-1,i.colCount=-1)),i},c.prototype._searchSelectedRangebyLeft=function(a,c,d){for(var f,i,j,k,l,m,n,o=this,p=a.col+a.colCount-1,q=0,r={r:a.row+a.rowCount-1,c:p};p>q;)if(p--,o._canMoveCurrentTo(r.r,p)&&(f=o._getExtendedRange(r.r,p,c,d),i=g(a.row,f.row),j=g(a.col,f.col),k=h(a.row+a.rowCount-1,f.row+f.rowCount-1),l=g(a.col+a.colCount-1,f.col+f.colCount-1),m=k-i+1,n=l-j+1,i!==a.row||j!==a.col||m!==a.rowCount||n!==a.colCount)){var s=o._getPrevVisualColumn(o._scrollLeftCol);return(j===s||l===s)&&o._setLeftColumn(s),new b.Range(i,j,m,n)}return e},c.prototype._searchSelectedRangebyLeftCtrl=function(a,c,d,i){var j=this,k=j.frozenColCount?j._getNextVisualColumn(j.frozenColCount-1):j._getFirstVisualColumn(),l=c?k:j._getFirstVisualColumn();if(l!==f&&l!==e){(j.frozenColCount<=0||c)&&j._setLeftColumn(l);var m,n,o,p,q,r,s;return m=j._getExtendedRange(a.row,l,d,i),n=g(a.row,m.row),o=g(a.col,m.col),p=h(a.row+a.rowCount-1,m.row+m.rowCount-1),q=g(a.col+a.colCount-1,m.col+m.colCount-1),r=p-n+1,s=q-o+1,new b.Range(n,o,r,s)}},c.prototype._searchSelectedRangebyRight=function(a,c,d){for(var i,j,k,l,m,n,o,p=this,q=a.col,r=p.getColumnCount()-1,s={r:a.row+a.rowCount-1,c:q};r>q;)if(q++,p._canMoveCurrentTo(s.r,q)&&(i=p._getExtendedRange(s.r,q,c,d),j=g(a.row,i.row),k=h(a.col,i.col),l=h(a.row+a.rowCount-1,i.row+i.rowCount-1),m=h(a.col+a.colCount-1,i.col+i.colCount-1),n=l-j+1,o=m-k+1,j!==a.row||k!==a.col||n!==a.rowCount||o!==a.colCount)){var t=p.frozenColCount?p._getNextVisualColumn(p.frozenColCount-1):e,u=p._getPageRightColumn();return t===f||t===e||k!==t&&m!==t?(k===u||m===u)&&p._setLeftColumn(p._getNextVisualColumn(p._scrollLeftCol)):p._setLeftColumn(t),new b.Range(j,k,n,o)}return e},c.prototype._searchSelectedRangebyRightCtrl=function(a,c,d,i){var j=this,k=j._getLastPageLeftColumn();if(k!==f&&k!==e){j._setLeftColumn(k);var l=j._getLastVisualColumn();c||(l+=j._frozenTrailingColCount);var m,n,o,p,q,r,s;return m=j._getExtendedRange(a.row,l,d,i),n=g(a.row,m.row),o=h(a.col,m.col),p=h(a.row+a.rowCount-1,m.row+m.rowCount-1),q=h(a.col+a.colCount-1,m.col+m.colCount-1),r=p-n+1,s=q-o+1,new b.Range(n,o,r,s)}},c.prototype._searchSelectedRangebyUp=function(a,c,d){for(var f,i,j,k,l,m,n,o=this,p=a.row+a.rowCount-1,q=0,r={r:p,c:a.col+a.colCount-1};p>q;)if(p--,o._canMoveCurrentTo(p,r.c)&&(f=o._getExtendedRange(p,r.c,c,d),i=g(a.row,f.row),j=g(a.col,f.col),k=g(a.row+a.rowCount-1,f.row+f.rowCount-1),l=h(a.col+a.colCount-1,f.col+f.colCount-1),m=k-i+1,n=l-j+1,i!==a.row||j!==a.col||m!==a.rowCount||n!==a.colCount)){var s=o._getPrevVisualRow(o._scrollTopRow);return(i===s||k===s)&&o._setTopRow(s),new b.Range(i,j,m,n)}return e},c.prototype._searchSelectedRangebyUpCtrl=function(a,c,d,i){var j=this,k=j.frozenRowCount?j._getNextVisualRow(j.frozenRowCount-1):j._getFirstVisualRow(),l=c?k:j._getFirstVisualRow();if(l!==f&&l!==e){(j.frozenRowCount<=0||c)&&j._setTopRow(l);var m,n,o,p,q,r,s;return m=j._getExtendedRange(l,a.col,d,i),n=g(a.row,m.row),o=g(a.col,m.col),p=g(a.row+a.rowCount-1,m.row+m.rowCount-1),q=h(a.col+a.colCount-1,m.col+m.colCount-1),r=p-n+1,s=q-o+1,new b.Range(n,o,r,s)}},c.prototype._searchSelectedRangebyDown=function(a,c,d){for(var i,j,k,l,m,n,o,p=this,q=a.row,r=p.getRowCount()-1,s={r:q,c:a.col+a.colCount-1};r>q;)if(q++,p._canMoveCurrentTo(q,s.c)&&(i=p._getExtendedRange(q,s.c,c,d),j=h(a.row,i.row),k=g(a.col,i.col),l=h(a.row+a.rowCount-1,i.row+i.rowCount-1),m=h(a.col+a.colCount-1,i.col+i.colCount-1),n=l-j+1,o=m-k+1,j!==a.row||k!==a.col||n!==a.rowCount||o!==a.colCount)){var t=p.frozenRowCount?p._getNextVisualRow(p.frozenRowCount-1):e,u=p._getPageBottomRow();return t===f||t===e||j!==t&&l!==t?(j===u||l===u)&&p._setTopRow(p._getNextVisualRow(p._scrollTopRow)):p._setTopRow(t),new b.Range(j,k,n,o)}return e},c.prototype._searchSelectedRangebyDownCtrl=function(a,c,d,i){var j=this,k=j._getLastPageTopRow();if(k!==f&&k!==e){j._setTopRow(k);var l=j._getLastVisualRow();c||(l+=j._frozenTrailingRowCount);var m,n,o,p,q,r,s;return m=j._getExtendedRange(l,a.col,d,i),n=h(a.row,m.row),o=g(a.col,m.col),p=h(a.row+a.rowCount-1,m.row+m.rowCount-1),q=h(a.col+a.colCount-1,m.col+m.colCount-1),r=p-n+1,s=q-o+1,new b.Range(n,o,r,s)}},c.prototype._searchSelectedRangebyHome=function(a,c,d){for(var f,i,j,k,l,m,n,o=this,p=o.frozenColCount?o.frozenColCount-1:-1,q=o._activeColIndex,r={r:a.row+a.rowCount-1,c:a.col};q>p;)if(p++,o._canMoveCurrentTo(r.r,p)){if(a.col<=p&&a.col+a.colCount-1===o._activeColIndex)break;return f=o._getExtendedRange(r.r,p,c,d),i=g(a.row,f.row),j=g(a.col,f.col),k=h(a.row+a.rowCount-1,f.row+f.rowCount-1),l=g(a.col+a.colCount-1,f.col+f.colCount-1),m=k-i+1,n=l-j+1,o._setLeftColumn(o._getFirstVisualColumn()),new b.Range(i,j,m,n)}return e},c.prototype._searchSelectedRangebyHomeCtrl=function(a,b,c){return a=this._searchSelectedRangebyLeftCtrl(a,!0,b,c),a=this._searchSelectedRangebyUpCtrl(a,!0,b,c)},c.prototype._searchSelectedRangebyEnd=function(a,c,d){for(var f,i,j,k,l,m,n,o=this,p=o.getColumnCount(),q=o._activeColIndex,r={r:a.row+a.rowCount-1,c:a.col+a.colCount-1};p>q;)if(p--,o._canMoveCurrentTo(r.r,p)){if(a.col+a.colCount-1>=p&&a.col===o._activeColIndex)break;return f=o._getExtendedRange(r.r,p,c,d),i=g(a.row,f.row),j=h(a.col,f.col),k=h(a.row+a.rowCount-1,f.row+f.rowCount-1),l=h(a.col+a.colCount-1,f.col+f.colCount-1),m=k-i+1,n=l-j+1,o._setLeftColumn(o._getLastPageLeftColumn()),new b.Range(i,j,m,n)}return e},c.prototype._searchSelectedRangebyEndCtrl=function(a,b,c){return a=this._searchSelectedRangebyRightCtrl(a,!0,b,c),a=this._searchSelectedRangebyDownCtrl(a,!0,b,c)},c.prototype._searchSelectedRangebyPageUp=function(a,c,d){var i=this,j=i._getPrevPageTopRow();if(j===f||j===e)return e;var k=i._getRowLayout(1),l=i._setTopRow(j),m=-1;l?m=i._getNextVisualRow(a.row+a.rowCount-1-k.length):i.frozenRowCount<=0&&(m=i._getFirstVisualRow()),m<i._scrollTopRow?m=i._scrollTopRow:m>=i._getPageBottomRow()&&(m=i._getPrevVisualRow(i._getPageBottomRow()));var n,o,p,q,r,s,t;return n=i._getExtendedRange(m,a.col,c,d),o=g(a.row,n.row),p=g(a.col,n.col),q=g(a.row+a.rowCount-1,n.row+n.rowCount-1),r=h(a.col+a.colCount-1,n.col+n.colCount-1),s=q-o+1,t=r-p+1,new b.Range(o,p,s,t)},c.prototype._searchSelectedRangebyPageDown=function(a,c,d){var i=this,j=i._getNextPageTopRow();if(j===f||j===e)return e;var k=i._getRowLayout(1);i._setTopRow(j);var l=i._getPrevVisualRow(a.row+a.rowCount-1+k.length);l<i._scrollTopRow?l=i._scrollTopRow:l>=i._getPageBottomRow()&&(l=i._scrollTopRow>=i._getLastPageTopRow()?i._getPageBottomRow():i._getPrevVisualRow(i._getPageBottomRow()));var m,n,o,p,q,r,s;return m=i._getExtendedRange(l,a.col,c,d),n=h(a.row,m.row),o=g(a.col,m.col),p=h(a.row+a.rowCount-1,m.row+m.rowCount-1),q=h(a.col+a.colCount-1,m.col+m.colCount-1),r=p-n+1,s=q-o+1,new b.Range(n,o,r,s)},c.prototype._getPrevPageTopRow=function(){var a=this,b=a._getRowLayout(1);if(!b||b.length<=0)return e;for(var c=a.frozenRowCount?a._getNextVisualRow(a.frozenRowCount-1):a._getFirstVisualRow(),d=0,f=a._scrollTopRow,g=a._getSheetLayout();f>c&&(d+=a._getZoomRowHeight(f),!(d>g.viewportHeight));)f--;return f},c.prototype._getPrevPageLeftColumn=function(){var a=this,b=a._getColumnLayout(1);if(!b||b.length<=0)return e;for(var c=a.frozenColCount?a._getNextVisualColumn(a.frozenColCount-1):a._getFirstVisualColumn(),d=0,f=a._scrollLeftCol,g=a._getSheetLayout();f>c&&(d+=a._getZoomColumnWidth(f),!(d>g.viewportWidth));)f--;return f},c.prototype._getNextPageTopRow=function(){var a=this._getRowLayout(1);return!a||a.length<=0?e:this._getLastVisualRow()===a[a.length-1].row?this._scrollTopRow:a[a.length-1].row},c.prototype._getLastPageTopRow=function(){var a=this;if(a._getLastVisualRow()===a._getPageBottomRow()){var b=a._getSheetLayout(),c=a._getRowLayout(1);if(c&&c.length>=1){var d=c[c.length-1];if(d.y+d.height<=b.viewportY+b.viewportHeight)return a._scrollTopRow}}var e=a._scrollTopRow;try{a._scrollTopRow=a._getLastVisualRow();var f=a._getPrevPageTopRow();return f=a._getNextVisualRow(f)}catch(g){}finally{a._scrollTopRow=e}},c.prototype._getLastPageLeftColumn=function(){var a,b=this;if(b._getLastVisualColumn()===b._getPageRightColumn()){a=b._getSheetLayout();var c=b._getColumnLayout(1);if(c&&c.length>=1){var d=c[c.length-1];if(d.x+d.width<=a.viewportX+a.width)return b._scrollLeftCol}}a=b._getSheetLayout();for(var e=0,f=b._getLastVisualColumn();f>0&&(e+=b._getZoomColumnWidth(f),!(e>a.viewportWidth));)f--;return f>0&&(f=b._getNextVisualColumn(f)),f},c.prototype._getPageBottomRow=function(){var a=this._getRowLayout(1);return!a||a.length<=0?e:a[a.length-1].row},c.prototype._getPageRightColumn=function(){var a=this._getColumnLayout(1);return!a||a.length<=0?e:a[a.length-1].col},c.prototype._getLastFullyVisibleRow=function(){var a=this._getRowLayout(1);if(!a||a.length<=0)return e;var b=this._getSheetLayout(),c=a.length-1;return a[c].y+a[c].height<=b.viewportY+b.viewportHeight?a[c].row:a[h(c-1,0)].row},c.prototype._getLastFullyVisibleColumn=function(){var a=this._getColumnLayout(1);if(!a||a.length<=0)return e;var b=this._getSheetLayout(),c=a.length-1;return a[c].x+a[c].width<=b.viewportX+b.viewportWidth?a[c].col:a[h(c-1,0)].col},c.prototype._getFirstVisualRow=function(){return this._getNextVisualRow(-1)},c.prototype._getLastVisualRow=function(a){(a===f||a===e)&&(a=3);var b=this.getRowCount(a);return(3===a||2===a)&&(b-=this._frozenTrailingRowCount),this._getPrevVisualRow(b,a)},c.prototype._getFirstVisualColumn=function(){return this._getNextVisualColumn(-1)},c.prototype._getLastVisualColumn=function(a){(a===f||a===e)&&(a=3);var b=this.getColumnCount(a);return(3===a||1===a)&&(b-=this._frozenTrailingColCount),this._getPrevVisualColumn(b,a)},c.prototype._getFirstPageLeftColumn=function(){var a=this,b=0,c=isNaN(a.frozenColCount)?0:a.frozenColCount;return b=c>0?a._getNextVisualColumn(c-1):a._getFirstVisualColumn()},c.prototype._getFirstPageTopRow=function(){var a=this,b=0,c=isNaN(a.frozenRowCount)?0:a.frozenRowCount;return b=c>0?a._getNextVisualRow(c-1):a._getFirstVisualRow()},c.prototype._getNextVisualRow=function(a,b){for(var c=this,d=b?c.getRowCount()-1:c.getRowCount()-1-c._frozenTrailingRowCount;d>a;)if(a++,c.getRowVisible(a)&&c._getZoomRowHeight(a)>0)return a;return e},c.prototype._getPrevVisualRow=function(a,b,c){for(var d=c?0:this.frozenRowCount;a>d;)if(a--,this.getRowVisible(a,b)&&this._getZoomRowHeight(a,b)>0)return a;return e},c.prototype._getNextVisualColumn=function(a){for(var b=this,c=b.getColumnCount()-1-b._frozenTrailingColCount;c>a;)if(a++,b.getColumnVisible(a)&&b._getZoomColumnWidth(a)>0)return a;return e},c.prototype._getPrevVisualColumn=function(a,b){for(;a>this.frozenColCount;)if(a--,this.getColumnVisible(a,b)&&this._getZoomColumnWidth(a,b)>0)return a;return e},c.prototype._inflateRangeToCoverSpans=function(a,b){if(a&&a.length>0)for(var c=0;c<a.length;c++){var d=a[c];if(b.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(c--,1),this._inflateRangeToCoverSpans(a,b.union(d))}return b},c.prototype._getActiveSelectedRange=function(a){var c=this,d=new b.Range(-1,-1,0,0);return c._selectionModel.length<=0?d:(3===a?(c._selectionModel.activeSelectedRangeIndex--,c._selectionModel.activeSelectedRangeIndex<0&&(c._selectionModel.activeSelectedRangeIndex=c._selectionModel.length-1)):4===a&&(c._selectionModel.activeSelectedRangeIndex++,c._selectionModel.activeSelectedRangeIndex>=c._selectionModel.length&&(c._selectionModel.activeSelectedRangeIndex=0)),c._selectionModel.activeSelectedRangeIndex>=0&&(d=c._selectionModel[c._selectionModel.activeSelectedRangeIndex]),d)},c.prototype._initializeActiveCell=function(){var a=this,b=a._activeRowIndex,c=a._activeColIndex,d=a._selectionModel;if(b===f||b===e||c===f||c===e||d.length<=0){var g=0,h=0,i=a._spanModel.find(g,h);if(i?(d.add(g,h,i.rowCount,i.colCount),a._activeRowIndex=g,a._activeColIndex=h,a._activeRowCount=i.rowCount,a._activeColCount=i.colCount):(d.add(g,h,1,1),a._activeRowIndex=g,a._activeColIndex=h,a._activeRowCount=1,a._activeColCount=1),d.length>0&&!a._paintSuspended){var j=d[0];a._render.repaintSelection(j)}}},c.prototype._setHoverCell=function(a){var b=this,c=!1,d=b._currentTarget;d||(c=!0),c||a||(c=!0),c||(c=a.col!==d.col||a.row!==d.row||a.colViewportIndex!==d.colViewportIndex||a.rowViewportIndex!==d.rowViewportIndex||a.hitTestType!==d.hitTestType),b._currentTarget=a;var f,g,h;if(c){b._hoverCell=!0;var i=b._getSheetLayout(),j=b._render,k=e;d&&(d.rowViewportIndex<0||d.colViewportIndex<0)&&(k=b.getCellRect(d.row,d.col,d.rowViewportIndex,d.colViewportIndex),k&&k.width>0&&k.height>0&&(f=0,g=0,h=b._getGroupLayout(),h&&(f=h.width,g=h.height),(k.x<i.rowHeaderWidth+f||k.y<i.colHeaderHeight+g||k.y>=i.height-i.footerHeight)&&j.update(k.x,k.y,k.width,k.height))),a&&(a.rowViewportIndex<0||a.colViewportIndex<0)&&(k=b.getCellRect(a.row,a.col,a.rowViewportIndex,a.colViewportIndex),k&&k.width>0&&k.height>0&&(f=0,g=0,h=b._getGroupLayout(),h&&(f=h.width,g=h.height),(k.x<i.rowHeaderWidth+f||k.y<i.colHeaderHeight+g||k.y>=i.height-i.footerHeight)&&j.update(k.x,k.y,k.width,k.height))),b._hoverCell=!1}},c.prototype._getAvailableActiveCell=function(a,b,c){var d=this._skipSpanCell(a,b,c);return this._skipInvisibleCell(d)},c.prototype._skipSpanCell=function(a,c,d){var e=this._spanModel.find(a,c);return e?d&&1===e.rowCount||!d&&1===e.colCount?e:(d?c++:a++,this._skipSpanCell(a,c,d)):new b.Range(a,c,1,1)},c.prototype._skipInvisibleCell=function(a){var c,d=this,e=a.row,f=d.getRowCount();for(c=e;f>c&&d.getRowVisible(c)!==!0;c++);f>c&&(e=c);var g=a.col,h=d.getColumnCount();for(c=g;h>c&&d.getColumnVisible(c)!==!0;c++);return h>c&&(g=c),new b.Range(e,g,a.rowCount,a.colCount)},c.prototype._processKeyMap=function(a){var c=a.ctrlKey,d=a.shiftKey,e=a.altKey,f=a.metaKey,g=a.keyCode,h=this._getKeyAction(g,c,d,e,f);if(h&&typeof h.action===k){var i=h.action.call(this);return i&&b.util.cancelDefault(a),i}return!1},c.prototype._processFloatingObjectsKeyMap=function(a){if(!b.features.floatingObject)return!1;var c=90===a.keyCode&&a.ctrlKey===!0||89===a.keyCode&&a.ctrlKey===!0;if(c)return!1;var d=this,e=d._eventHandler,f=86===a.keyCode&&a.ctrlKey===!0,g=d._getFloatingObjectClipboardHelper(),h=g.fromSheet,i=h&&h._eventHandler;if(e||i){var j=e._getClipboardFloatingObjectData();!j&&i&&(j=i._getClipboardFloatingObjectData()),j&&j.length||(f=!1)}if(d._hasFloatingObjectsSelected()||f){var k=d._getFloatingObjectKeyAction(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey);if(k&&k.action){var l=k.action.call(d);return l&&b.util.cancelDefault(a),!0}}return!1},c.prototype._processCommentKeyMap=function(a){if(!b.features.comment)return!1;var c=90===a.keyCode&&a.ctrlKey===!0||89===a.keyCode&&a.ctrlKey===!0;if(c)return!1;var d=this,e=d._commentManager.getActiveComment();if(e){if(9===a.keyCode)return!0;var f=d._getCommentKeyAction(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey);if(f&&f.action){var g=f.action.call(d);return g&&b.util.cancelDefault(a),!0}if(d._eventHandler.allowEnterEditing(a))return e.commentState(2),!0}return!1},c.prototype._hasFloatingObjectsSelected=function(){var a=this,c=a._floatingObjectArray;if(b.features.floatingObject&&c&&c.length>0){var d,e;for(d=0,e=c.length;e>d;d++){var f=c[d];if(f.isSelected())return!0}}return!1},c.prototype._getRowInfos=function(a){(typeof a===j||a===e)&&(a=3);var b=this;if(3===a||2===a){var c=b._rowInfos;return c||(b._rowInfos=c={}),c}if(1===a){var d=b._colHeaderRowInfos;return d||(b._colHeaderRowInfos=d={}),d}return e},c.prototype._getZoomRowHeight=function(a,b){var c=this.getRowHeight(a,b),d=this._zoomFactor;return 1!==d&&(c*=d),i(c)},c.prototype._getColumnInfos=function(a){var b=this;if(3===a||1===a){var c=b._colInfos;return c||(b._colInfos=c={}),c}if(2===a){var d=b._rowHeaderColInfos;return d||(b._rowHeaderColInfos=d={}),d}return e},c.prototype._getZoomColumnWidth=function(a,b){var c=this.getColumnWidth(a,b),d=this._zoomFactor;return 1!==d&&(c*=d),i(c)},c.prototype._getGroupLayout=function(){var a=this;return a._cachedGroupLayout||(a._cachedGroupLayout=a._createGroupLayout()),a._cachedGroupLayout},c.prototype._getGroupButtonWidth=function(){return 17},c.prototype._getGroupButtonHeight=function(){return 17},c.prototype._getGroupPadding=function(){return 2},c.prototype._createGroupLayout=function(){var a={x:0,y:0,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},b=this,c=b._getGroupButtonWidth(),d=b._getGroupButtonHeight(),e=b._getGroupPadding(),f=b.rowRangeGroup,h=b.colRangeGroup,i=b._showRowRangeGroup,j=b._showColumnRangeGroup,k=b._zoomFactor;if(i&&f&&!f._isEmpty()){var l=f.getMaxLevel();if(l>=0){var m=g(c,c*k);a.width=m*(l+2)+2*e,a.rowMaxLevel=l}}if(j&&h&&!h._isEmpty()){var n=h.getMaxLevel();if(n>=0){var o=g(d,d*k);a.height=o*(n+2)+2*e,a.colMaxLevel=n}}return a},c.prototype._createLayout=function(){var a=this,c=new b.Rect(a._bounds.x+a.borderWidth,a._bounds.y+a.borderWidth,h(0,a._bounds.width-2*a.borderWidth),h(0,a._bounds.height-2*a.borderWidth)),d=c.width,g=c.height,i={x:c.x,y:c.y,width:c.width,height:c.height,rowHeaderWidth:0,colHeaderHeight:0,frozenWidth:0,frozenHeight:0,frozenTrailingWidth:0,frozenTrailingHeight:0,footerHeight:0,footerWidth:0,footerX:0,footerY:0,frozenX:0,frozenY:0,frozenTrailingX:0,frozenTrailingY:0,viewportX:0,viewportY:0,viewportHeight:0,viewportWidth:0,headerX:0,headerY:0,headerCornerRect:function(){var a=this;return new b.Rect(a.x,a.y,a.rowHeaderWidth,a.colHeaderHeight)},colHeaderRect:function(a){var c=this;return 0===a?new b.Rect(c.frozenX,c.y,c.frozenWidth,c.colHeaderHeight):1===a?new b.Rect(c.viewportX,c.y,c.viewportWidth,c.colHeaderHeight):2===a?new b.Rect(c.frozenTrailingX,c.y,c.frozenTrailingWidth,c.colHeaderHeight):e},rowHeaderRect:function(a){var c=this;return 0===a?new b.Rect(c.x,c.frozenY,c.rowHeaderWidth,c.frozenHeight):1===a?new b.Rect(c.x,c.viewportY,c.rowHeaderWidth,c.viewportHeight):2===a?new b.Rect(c.x,c.frozenTrailingY,c.rowHeaderWidth,c.frozenTrailingHeight):e},viewportRect:function(a,c){var d=this;return 0===a?0===c?new b.Rect(d.frozenX,d.frozenY,d.frozenWidth,d.frozenHeight):1===c?new b.Rect(d.viewportX,d.frozenY,d.viewportWidth,d.frozenHeight):2===c?new b.Rect(d.frozenTrailingX,d.frozenY,d.frozenTrailingWidth,d.frozenHeight):e:1===a?0===c?new b.Rect(d.frozenX,d.viewportY,d.frozenWidth,d.viewportHeight):1===c?new b.Rect(d.viewportX,d.viewportY,d.viewportWidth,d.viewportHeight):2===c?new b.Rect(d.frozenTrailingX,d.viewportY,d.frozenTrailingWidth,d.viewportHeight):e:2===a?0===c?new b.Rect(d.frozenX,d.frozenTrailingY,d.frozenWidth,d.frozenTrailingHeight):1===c?new b.Rect(d.viewportX,d.frozenTrailingY,d.viewportWidth,d.frozenTrailingHeight):2===c?new b.Rect(d.frozenTrailingX,d.frozenTrailingY,d.frozenTrailingWidth,d.frozenTrailingHeight):e:e},footerRect:function(a){var c=this;return 0===a?new b.Rect(c.frozenX,c.footerY,c.frozenWidth,c.footerHeight):1===a?new b.Rect(c.viewportX,c.footerY,c.viewportWidth,c.footerHeight):2===a?new b.Rect(c.frozenTrailingX,c.footerY,c.frozenTrailingWidth,c.footerHeight):e},footerCornerRect:function(){var a=this;return new b.Rect(a.footerX,a.footerY,a.footerWidth,a.footerHeight)}},j=a._getGroupLayout();i.x+=j.width,i.y+=j.height,d-=j.width,g-=j.height;var k,l,m,n;if(a.rowHeaderVisible===e||a.rowHeaderVisible===f||a.rowHeaderVisible)for(n=a.getColumnCount(2),m=0;n>m;m++)i.rowHeaderWidth+=a._getZoomColumnWidth(m,2);if(a.colHeaderVisible===e||a.colHeaderVisible===f||a.colHeaderVisible)for(l=a.getRowCount(1),k=0;l>k;k++)i.colHeaderHeight+=a._getZoomRowHeight(k,1);if(a.frozenColCount>0)for(n=a.getColumnCount(),m=0;m<a.frozenColCount&&n>m;m++)a.getColumnVisible(m)&&(i.frozenWidth+=a._getZoomColumnWidth(m));if(a.frozenRowCount>0)for(l=a.getRowCount(),k=0;k<a.frozenRowCount&&l>k;k++)a.getRowVisible(k)&&(i.frozenHeight+=a._getZoomRowHeight(k));if(a._frozenTrailingColCount>0)for(n=a.getColumnCount(),m=h(a.frozenColCount,n-a._frozenTrailingColCount);n>m;m++)i.frozenTrailingWidth+=a._getZoomColumnWidth(m);if(a._frozenTrailingRowCount>0)for(l=a.getRowCount(),k=h(a.frozenRowCount,l-a._frozenTrailingRowCount);l>k;k++)i.frozenTrailingHeight+=a._getZoomRowHeight(k);return d-=i.rowHeaderWidth,g-=i.colHeaderHeight,d-=i.frozenWidth,g-=i.frozenHeight,d-=i.frozenTrailingWidth,g-=i.frozenTrailingHeight,g-=i.footerHeight,i.viewportWidth=h(0,d),i.viewportHeight=h(0,g),i.headerX=i.x,i.headerY=i.y,i.frozenX=i.headerX+i.rowHeaderWidth,i.frozenY=i.headerY+i.colHeaderHeight,i.viewportX=i.frozenX+i.frozenWidth,i.viewportY=i.frozenY+i.frozenHeight,i.frozenTrailingX=i.viewportX+i.viewportWidth,i.frozenTrailingY=i.viewportY+i.viewportHeight,i.footerX=i.headerX,i.footerY=i.y+i.height-i.footerHeight,i},c.prototype._getSheetLayout=function(){var a=this;return a._layoutModel||(a._layoutModel=a._createLayout()),a._layoutModel},c.prototype._getColumnLayout=function(a,b){return typeof b===j||b===e||3===b||1===b?this._getViewportColumnLayout(a):2===b?this._getRowHeaderColumnLayout():e},c.prototype._getRowHeaderColumnLayout=function(){var a=this;return a._colLayoutCache.rowHeader||(a._colLayoutCache.rowHeader=a._createRowHeaderColumnLayout()),a._colLayoutCache.rowHeader},c.prototype._getViewportColumnLayout=function(a){var b=this;return b._colLayoutCache.viewport||(b._colLayoutCache.viewport={}),b._colLayoutCache.viewport[a]||(b._colLayoutCache.viewport[a]=b._createViewportColumnLayout(a)),b._colLayoutCache.viewport[a]},c.prototype._createRowHeaderColumnLayout=function(){for(var a,c=new b._LayoutModel,d=this._getSheetLayout(),e=d.headerX,f=this.getColumnCount(2),g=0;f>g;g++)a=this._getZoomColumnWidth(g,2),c.push(new b._Layout(-1,g,e,-1,a,-1)),e+=a;return c},c.prototype._createViewportColumnLayout=function(a){var c,d,e,f=this,i=new b._LayoutModel,j=f._getSheetLayout(),k=f.getColumnCount(),l=f._cachePool;if(0===a)for(d=j.frozenX,k=isNaN(f.frozenColCount)?0:g(f.frozenColCount,k),c=0;k>c;c++)e=l.getCachedColumn(c).width,i.push(new b._Layout(-1,c,d,-1,e,-1)),d+=e;else if(1===a){d=j.viewportX,k-=f._frozenTrailingColCount;var m=j.viewportWidth,n=h(f.frozenColCount,f._scrollLeftCol);for(c=n;m>0&&k>c;c++)e=l.getCachedColumn(c).width,i.push(new b._Layout(-1,c,d,-1,e,-1)),d+=e,m-=e}else if(2===a)for(d=j.frozenTrailingX,c=h(f.frozenColCount,k-f._frozenTrailingColCount);k>c;c++)e=l.getCachedColumn(c).width,i.push(new b._Layout(-1,c,d,-1,e,-1)),d+=e;return i},c.prototype._getRowLayout=function(a,b){return typeof b===j||b===e||3===b||2===b?this._getViewportRowLayout(a):1===b?this._getColumnHeaderRowLayout():e},c.prototype._getAllRowLayout=function(a){for(var c=new b._LayoutModel,d=0;3>d;d++){var e=this._getRowLayout(d,a);e&&e.length>0&&(c=$.merge(c,e))}return c},c.prototype._getAllColumnLayout=function(a){for(var c=new b._LayoutModel,d=0;3>d;d++){var e=this._getColumnLayout(d,a);e&&e.length>0&&(c=$.merge(c,e))}return c},c.prototype._getColumnHeaderRowLayout=function(){var a=this;return a._rowLayoutCache.colHeader||(a._rowLayoutCache.colHeader=a._createColumnHeaderRowLayout()),a._rowLayoutCache.colHeader},c.prototype._getViewportRowLayout=function(a){var b=this;return b._rowLayoutCache.viewport||(b._rowLayoutCache.viewport={}),b._rowLayoutCache.viewport[a]||(b._rowLayoutCache.viewport[a]=b._createViewportRowLayout(a)),b._rowLayoutCache.viewport[a]},c.prototype._createColumnHeaderRowLayout=function(){for(var a,c=new b._LayoutModel,d=this._getSheetLayout(),e=d.headerY,f=this.getRowCount(1),g=0;f>g;g++)a=this._getZoomRowHeight(g,1),c.push(new b._Layout(g,-1,-1,e,-1,a)),e+=a;return c},c.prototype._createViewportRowLayout=function(a){var c,d,e,f=this,i=new b._LayoutModel,j=f._getSheetLayout(),k=f.getRowCount(),l=f._cachePool;if(0===a)for(d=j.frozenY,k=isNaN(f.frozenRowCount)?0:g(f.frozenRowCount,k),c=0;k>c;c++)e=l.getCachedRow(c).height,i.push(new b._Layout(c,-1,-1,d,-1,e)),d+=e;else if(1===a){d=j.viewportY,k-=f._frozenTrailingRowCount;var m=j.viewportHeight,n=h(f.frozenRowCount,f._scrollTopRow);for(c=n;m>0&&k>c;c++)e=l.getCachedRow(c).height,i.push(new b._Layout(c,-1,-1,d,-1,e)),d+=e,m-=e}else if(2===a)for(d=j.frozenTrailingY,c=h(f.frozenRowCount,k-f._frozenTrailingRowCount);k>c;c++)e=l.getCachedRow(c).height,i.push(new b._Layout(c,-1,-1,d,-1,e)),d+=e;return i},c.prototype._getCellLayout=function(a,c,d){var e=this,f=e.getRowCount(d),g=e.getColumnCount(d),h=e._getRowLayout(a,d),i=e._getColumnLayout(c,d),j=new b._LayoutModel;if(h&&h.length>0&&i&&i.length>0){var k=h[0].row,l=i[0].col,m=h[h.length-1].row,n=i[i.length-1].col,o=e.getSpans(new b.Range(k,l,m-k+1,n-l+1),d);o&&o.length>0&&e._addCellLayout(o,k,l,m,n,j,f,g,d,h,i)}return j},c.prototype._getCellLayoutByCell=function(a,c,d,f,g){var h=this,i=h.getRowCount(d),j=h.getColumnCount(d),k=h._getRowLayout(a,d),l=h._getColumnLayout(c,d),m=new b._LayoutModel;if(k&&k.length>0&&l&&l.length>0){var n=k[0].row,o=l[0].col,p=h.getSpan(f,g,d);if(p){var q=[];q.push(p),h._addCellLayout(q,n,o,p.row+p.rowCount,p.col+p.colCount,m,i,j,d,k,l)}return m.length>0?m[0]:e}return e},c.prototype._addCellLayout=function(a,c,d,e,f,g,h,i,j,k,l){var m=a.length;if(!(0>=m)){for(var n=this,o=e+1,p=f+1,q=new Array(o),r=new Array(p),s=new Array(p),t=new Array(o),u=0,v=0,w=c-1;w>=0;w--)q[w]=n._getZoomRowHeight(w,j),v-=q[w],t[w]=v;v=0;for(var w=c;o>w;w++)t[w]=v,q[w]=n._getZoomRowHeight(w,j),v+=q[w];for(var w=d-1;w>=0;w--)r[w]=n._getZoomColumnWidth(w,j),u-=r[w],s[w]=u;u=0;for(var w=d;p>w;w++)s[w]=u,r[w]=n._getZoomColumnWidth(w,j),u+=r[w];for(var x=0;m>x;x++){var y=a[x];if(y.intersect(c,d,e-c+1,f-d+1)){var z=y.row+y.rowCount;if(z>o){for(var w=o;z>w;w++)q.push(n._getZoomRowHeight(w,j)),t.push(t[w-1]+q[w]);o=z}var A=y.col+y.colCount;if(A>p){for(var w=p;A>w;w++)r.push(n._getZoomColumnWidth(w,j)),s.push(s[w-1]+r[w]);p=A}var B,C,u=s[y.col],v=t[y.row],D=0,E=0;for(C=y.col;C<y.col+y.colCount&&i>C;C++)D+=r[C];for(B=y.row;B<y.row+y.rowCount&&h>B;B++)E+=q[B];g.push(new b._Layout(y.row,y.col,l[0].x+u,k[0].y+v,D,E,y.rowCount,y.colCount))}}}},c.prototype._getRowViewportIndexNearY=function(a){var b=this._getSheetLayout();return this.frozenRowCount>0&&a<b.frozenY+b.frozenHeight?0:this._frozenTrailingRowCount>0&&a>b.frozenTrailingY?2:1},c.prototype._getColumnViewportIndexNearX=function(a){var b=this._getSheetLayout();return this.frozenColCount>0&&a<b.frozenX+b.frozenWidth?0:this._frozenTrailingColCount>0&&a>b.frozenTrailingX?2:1
},c.prototype._getViewportColumnLayoutNearX=function(a,b){var c=this._getColumnLayout(a);return c?c.findNearX(b):e},c.prototype._getViewportRowLayoutNearY=function(a,b){var c=this._getRowLayout(a);return c?c.findNearY(b):e},c.prototype._syncHScollbarPosition=function(){var a=this,b=a.parent,c=a._getScrollableColumn(a._scrollLeftCol);-1!=c&&c!=a._scrollLeftCol&&(a._scrollLeftCol=c),b&&b._scrollbarH&&b._scrollbarH.value(a._scrollLeftCol)},c.prototype._syncVScrollbarPosition=function(){var a=this,b=a.parent,c=a._getScrollableRow(a._scrollTopRow);-1!==c&&c!=a._scrollTopRow&&(a._scrollTopRow=c),b&&b._scrollbarV&&b._scrollbarV.value(a._scrollTopRow)},c.prototype._syncScrollbarSize=function(){var a=this;a.parent&&a.parent._resizeScrollBar&&a.parent._resizeScrollBar()},c.prototype._getScrollableRow=function(a,b){var c=this,d=c.getFrozenRowCount(),f=c.getRowCount()-c.getFrozenTrailingRowCount()-1;if(b){a>f&&(a=f);var g=c._getPrevVisualRow(a+1);if(g!=e&&g>=d)return g}else{d>a&&(a=d);var g=c._getNextVisualRow(a-1);if(g!=e&&f>=g)return g}return-1},c.prototype._getScrollableColumn=function(a,b){var c=this,d=c.getFrozenColumnCount(),f=c.getColumnCount()-c.getFrozenTrailingColumnCount()-1;if(b){a>f&&(a=f);var g=c._getPrevVisualColumn(a+1);if(g!=e&&g>=d)return g}else{d>a&&(a=d);var g=c._getNextVisualColumn(a-1);if(g!=e&&f>=g)return g}return-1},c.prototype._setTopRow=function(a){var c=this,d=c._scrollTopRow;a>=c._getFirstPageTopRow()&&a<=c._getLastVisualRow()&&a!==d&&(c._eventHandler.vScrollTo(a),c._syncVScrollbarPosition(),c._trigger(b.Events.TopRowChanged,{sheet:c,sheetName:c._name,oldTopRow:d,newTopRow:a}))},c.prototype._setLeftColumn=function(a){var c=this,d=c._scrollLeftCol;a>=c._getFirstPageLeftColumn()&&a<=c._getLastVisualColumn()&&a!==d&&(c._eventHandler.hScrollTo(a),c._syncHScollbarPosition(),c._trigger(b.Events.LeftColumnChanged,{sheet:c,sheetName:c._name,oldLeftCol:d,newLeftCol:a}))},c.prototype._getSpanModel=function(a){return a===f||a===e||3===a?this._spanModel:1===a?this._colHeaderSpanModel:2===a?this._rowHeaderSpanModel:void 0},c.prototype._clipboardFloatingObjectCopy=function(a,c){if(b.features.floatingObject){var d=this,f=d._getFloatingObjectClipboardHelper(),g=f.fromSheet,h=g&&g._eventHandler;h&&h._setClipboardFloatingObjectData(e),f.fromSheet=d,f.isCutting=c;for(var i=new b._HelperArray,j=0;j<a.length;j++){var k=d._findFloatingObjectInternal(a[j]);k&&i.push(k)}d._eventHandler._setClipboardFloatingObjectData(i)}},c.prototype._clipboardCopy=function(a,c,d){if(a){var f="	",g="\r\n",h='"',i=this,j=i._eventHandler,k=r.getRangeText(i,a.row,a.rowCount,a.col,a.colCount,g,f,h,!1,0),l=i._getClipboardHelper();l.fromSheet=i,l.range=a,l.isCutting=c;try{var m={sheet:i,sheetName:i._name,copyData:k,cancel:!1};i._trigger(b.Events.ClipboardChanging,m),m&&m.cancel===!1?(j&&!d&&j._switchFocusForClipboard(k),i._trigger(b.Events.ClipboardChanged,{sheet:i,sheetName:i._name,copyData:k}),setTimeout(function(){j&&!d&&j._switchBackFocusAfterClipboard()},100)):(l.fromSheet=e,l.range=e)}catch(n){}finally{return k}}},c.prototype._trySearch=function(a,c,e){if(a){{b.SearchFlags}a=a.toString(),c=c.toString();var f=(2&e)>0;if(f&&0===(4&e)){if((1&e)>0){var g=a.toLowerCase(),h=c.toLowerCase();return g===h}return a===c}var i,j=(1&e)>0,k=(4&e)>0;i=j?new RegExp(d(c,k,f),"i"):new RegExp(d(c,k,f));var l=a.search(i)>-1;return f&&l&&c.search(/\*/)<=-1&&(l=a.length===c.length),l}return!1},c.prototype._getFilterButtonModel=function(){var a=this;return!a._filterButtonsModel&&b.features.filter_ui&&(a._filterButtonsModel=a._createFilterButtonModle()),a._filterButtonsModel},c.prototype._createFilterButtonModle=function(){var a=this,c=new b._FilterButtonInfoModel,d=a.rowFilter();if(d&&d.range&&d.showFilterButton){var e,f,g=d.range,h=g.col<0?0:g.col,i=g.col<0?a.getColumnCount():g.col+g.colCount;if(g.row<1?(e=a.getRowCount(1)-1,f=1):(e=g.row-1,f=3),e>=0)for(;i>h;){var j=new b._FilterButtonInfo(d);j.sheetArea=f,j.row=e;var k=a.getSpans(new b.Range(e,h,1,1),f);if(k&&k.length>0){var l=k[0];j.row=l.row,j.col=l.col,h+=l.colCount}else j.col=h,h++;c.push(j)}}for(var m,n=a.getTables(),o=n?n.length:0,p=0;o>p;p++)if(m=n[p],m&&m.showHeader()&&m.rowFilter().showFilterButton){var e=m.headerIndex();if(e>=0)for(var g=m.range(),q=0;q<g.colCount;q++){var h=g.col+q,j=new b._FilterButtonInfo(m.rowFilter(),e,h,3);c.push(j)}}return c},c.prototype._getFilterButtonHitInfo=function(a,c,d){if(!b.features.filter_ui)return e;var f,g,h,i=this,j=a.rowViewportIndex,k=a.colViewportIndex;if(1===a.hitTestType?(f=i._getColumnHeaderRowLayout().findY(d),g=i._getViewportColumnLayout(k).findX(c),h=1):3===a.hitTestType&&(f=i._getViewportRowLayout(j).findY(d),g=i._getViewportColumnLayout(k).findX(c),h=3),!f||!g)return e;var l=f.row,m=g.col,n=i.getSpan(l,m,h);if(n){if(l!==n.row+n.rowCount-1||m!==n.col+n.colCount-1)return e;l=n.row,m=n.col}var o=i._getFilterButtonModel().find(l,m,h);if(o){var p=i.getCellRect(l,m,j,k),q=i._render._getFilterButtonRect(p);if(q.x<=c&&c<=q.x+q.width&&q.y<=d&&d<=q.y+q.height)return new b._FilterButtonInfo(o.rowFilter,o.row,o.col,o.sheetArea,q.x,q.y,q.width,q.height)}return e},c.prototype._getCellTypeHitInfo=function(a,b,c){var d=this,f=a.row,g=a.col,h=a.hitTestType,i=d.getActualStyle(f,g,h),j=i.cellType||d.getDefaultCellType(h);if(d.isProtected&&i.locked)return e;var k=d.getCellRect(f,g),l={sheet:d,row:f,col:g,sheetArea:h};return d._allowEditorReservedLocations?j.getHitInfo(b,c,i,k,l):e},c.prototype._getFloatingObjectHitInfo=function(a,c){var d=this,f=d._floatingObjectArray,g=d._getSheetLayout();if(b.features.floatingObject&&g&&f&&f.length>0)for(var h=f.length-1;h>=0;h--){var i=f[h],j=i.position().x*d._zoomFactor+g.headerX+g.rowHeaderWidth,k=i.position().y*d._zoomFactor+g.headerY+g.colHeaderHeight,l=i.width(),m=i.height();if(a>=j&&j+l>a&&c>=k&&k+m>c)return{x:a,y:c,floatingObject:i}}return e},c.prototype._getCommentHitInfo=function(a,c){return b.features.comment?this._commentManager.getCommentHitInfo(a,c):e},c.prototype._trigger=function(a,b){var c=this._eventHandler;0===c._eventSuspended&&c.trigger(a,b)},c.prototype._disposeUserEvents=function(){this.unbindAll(),this._unbindAll()},c.prototype._doCommand=function(a){var b=this.undoManager();b.doAction(a)},c.prototype._refreshTabStrip=function(){var a=this;a.parent&&a.parent._tab&&a.parent._tab.repaint&&a.parent._tab.repaint()},c.prototype._isAnyCellInRangeLocked=function(a){for(var b,c=this._getActualRange(a),d=c.row,e=c.col,f=d+c.rowCount,g=e+c.colCount,h=d;f>h;h++)for(var i=e;g>i;i++)if(b=this.getActualStyle(h,i),b.locked===!0)return!0;return!1},c.prototype._isValidRange=function(a,b,c,d,e,f){if(a>=-1&&e>a&&b>=-1&&f>b){if(-1===a&&-1===b)return!0;if(-1===a){if(0!==d&&f>=b+d)return!0}else if(-1===b){if(0!==c&&e>=a+c)return!0}else if(0!==d&&f>=b+d&&0!==c&&e>=a+c)return!0}return!1},c.prototype._hasPartSpans=function(a,b,c,d){var f,g;if(0>a&&0>b)return!1;if(0>a){var h=this._colHeaderSpanModel;if(h&&0!==h.length)for(f=h.getEnumerator(-1,b,-1,d),g=e;f.moveNext();)if(g=f.current(),g.col<b||g.col+g.colCount>b+d)return!0}else if(0>b){var i=this._rowHeaderSpanModel;if(i&&0!==i.length)for(f=i.getEnumerator(a,-1,c,-1),g=e;f.moveNext();)if(g=f.current(),g.row<a||g.row+g.rowCount>a+c)return!0}var j=this._spanModel;if(j&&0!==j.length){var k=j.getEnumerator(a,b,c,d);for(g=e;k.moveNext();){if(g=k.current(),-1!==a&&(g.row<a||g.row+g.rowCount>a+c))return!0;if(-1!==b&&(g.col<b||g.col+g.colCount>b+d))return!0}}return!1},c.prototype._hasSpans=function(a,b,c,d){var e=this._spanModel;if(e)for(var f=0,g=e.length;g>f;f++){var h=e[f];if(h.intersect(a,b,c,d))return!0}return!1},c.prototype._hasPartTable=function(a,c,d,e){var f=this.getTables();if(f&&f.length>0)for(var g,h=new b.Range(a,c,d,e),i=f.length,j=0;i>j;j++)if(g=f[j].range(),h.intersect(g.row,g.col,g.rowCount,g.colCount)&&!h.containsRange(g))return!0;return!1},c.prototype._hasTable=function(a,b,c,d){return this._tableManager&&this._tableManager.has(a,b,c,d)?!0:!1},c.prototype._hasPartArrayFormulas=function(a,b,c,d){return this._getSheetSource()&&this._getSheetSource()._getFormulaExps(a,b,c,d,!0,!0)},c.prototype._getsArrayFormulas=function(a,b,c,d){return this._getSheetSource()&&this._getSheetSource()._getFormulaExps(a,b,c,d,!1,!0)},c.prototype._hasArrayFormula=function(a,b,c,d){var e=this._getsArrayFormulas(a,b,c,d);return e&&e.formulas&&e.formulas.length>0},c.prototype._raiseDragDropBlock=function(a,c,d,e,f,g,h,i,j){var k={sheet:this,sheetName:this._name,fromRow:a,fromCol:c,toRow:d,toCol:e,rowCount:f,colCount:g,copy:h,insert:i,copyOption:j,cancel:!1};return this._trigger(b.Events.DragDropBlock,k),k&&k.cancel===!0},c.prototype._raiseDragDropBlockCompleted=function(a,c,d,e,f,g,h,i,j){var k={sheet:this,sheetName:this._name,fromRow:a,fromCol:c,toRow:d,toCol:e,rowCount:f,colCount:g,copy:h,insert:i,copyOption:j};this._trigger(b.Events.DragDropBlockCompleted,k)},c.prototype._raiseInvalidOperation=function(a,c){var d={sheet:this,sheetName:this._name,invalidType:a,message:c};this._trigger(b.Events.InvalidOperation,d)},c.prototype._suspendInvalidate=function(){this._layoutSuspended++},c.prototype._resumeInvalidate=function(){var a=this;if(a._layoutSuspended--,a._layoutSuspended<=0){if(!a.isPaintSuspended())return a.invalidateLayout(),a.repaint(),!0;a._layoutSuspended=0}return!1},c.prototype._raiseSelectionChanging=function(a,c){var d=this,e=d._eventHandler._notEqualSelecions(a,c);return e===!0?(d._trigger(b.Events.SelectionChanging,{sheet:d,sheetName:d._name,oldSelections:a,newSelections:c}),!0):!1},c.prototype._raiseSelectionChanged=function(){this._trigger(b.Events.SelectionChanged,{sheet:this,sheetName:this._name})},c.prototype._raiseDragFillBlock=function(a,c,d){var e={sheet:this,sheetName:this._name,fillRange:a,autoFillType:d,fillDirection:c,cancel:!1};return this._trigger(b.Events.DragFillBlock,e),e&&e.cancel===!0},c.prototype._raiseDragFillBlockCompleted=function(a,c,d){var e={sheet:this,sheetName:this._name,fillRange:a,autoFillType:d,fillDirection:c};this._trigger(b.Events.DragFillBlockCompleted,e)},c.prototype._raiseCellChanged=function(a,c,d,e){var f={sheet:this,sheetName:this._name,row:c,col:d,sheetArea:e,propertyName:a};this._trigger(b.Events.CellChanged,f)},c.prototype._raisePropertyChanged=function(){},c.prototype._nextNonNullRow=function(a,b){var c=this,d=c._bindingManager,e=c.getDataSource();a++;var f=c._getModel(b?2:3),g=f.rowCount;for(b===!1&&e&&(g=h(g,d.getRowCount()));!(!(a>=0&&g>a)||f.dataTable.hasOwnProperty(a)&&f.dataTable[a]||b===!1&&e&&d.getDataItem(a));)a++;return g>a?a:-1},c.prototype._nextNonNullColumn=function(a,b,c){var d=this,g=d._bindingManager,h=d.getDataSource(),i=e,j=d._getModel(c?1:3);if(a>=0&&a<j.rowCount&&j.dataTable.hasOwnProperty(a)&&(i=j.dataTable[a]),c===!1&&!i&&h&&a>=0&&a<g.getRowCount()&&(i=g.getDataItem(a)),!i)return-1;for(b++;b>=0&&(b<j.colCount||b<i.length)&&(!i.hasOwnProperty(b)||!i[b]);){if(c===!1&&h){var k=d._getValueImp(j,a,b);if(k!==f&&k!==e)break}b++}return b<j.colCount||c===!1&&i&&b<i.length?b:-1},c.prototype._closeDragFillPopup=function(){this._smartTag&&this._smartTag.close()},c.prototype._cellRangeInflate=function(a,b){if(a&&a.length>0)for(var c=0;c<a.length;c++){var d=a[c];if(b.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(c--,1),this._cellRangeInflate(a,this._unionCellRange(b,d))}return b},c.prototype._unionCellRange=function(a,c){var d=g(a.row,c.row),e=g(a.col,c.col),f=h(a.row+a.rowCount-1,c.row+c.rowCount-1),i=h(a.col+a.colCount-1,c.col+c.colCount-1);return d>=0&&e>=0?new b.Range(d,e,f-d+1,i-e+1):d>=0?new b.Range(d,-1,f-d+1,-1):e>=0?new b.Range(-1,e,-1,i-e+1):new b.Range(-1,-1,-1,-1)},c.prototype._getClipboardHelper=function(){var a=this;return!a._clipboardHelper&&a.parent&&a.parent._clipboardHelper?a._clipboardHelper=a.parent._clipboardHelper:a._clipboardHelper||(a._clipboardHelper={fromSheet:e,range:e,isCutting:!1}),a._clipboardHelper},c.prototype._getFloatingObjectClipboardHelper=function(){var a=this;return!a._floatingObjectClipboardHelper&&a.parent&&a.parent._floatingObjectClipboardHelper?a._floatingObjectClipboardHelper=a.parent._floatingObjectClipboardHelper:a._floatingObjectClipboardHelper||(a._floatingObjectClipboardHelper={fromSheet:e,isCutting:!1}),a._floatingObjectClipboardHelper},c.prototype._checkPastedRange=function(a,c,d,f,g,h){var j=b.SR.Exp_PasteSourceCellsLocked,k=b.SR.Exp_InvalidCopyPasteSize,l=(b.SR.Exp_PasteDestinationCellsLocked,b.SR.Exp_PasteChangeMergeCell),m=b.SR.Exp_ChangePartOfArray;if(h.pastedInternal=!1,h.pastedRange=e,!(a||g&&""!==g))return!1;var n=this,o=n;if(n._isPastedInternal(a,c,o,g)||!g){if(h.pastedInternal=!0,f&&a.isProtected&&a._isAnyCellInRangeLocked(c))return n._raiseInvalidOperation(1,j),!1;h.pastedRange=n._getPastedRange(a,c,o,d,f)}else h.pastedRange=n._getPastedRangefromText(d,g);if(!h.pastedRange)return n._raiseInvalidOperation(1,k),!1;if(h.pastedInternal){if(a._hasPartSpans(c.row,c.col,c.rowCount,c.colCount))return n._raiseInvalidOperation(1,l),!1;if(f&&a._hasPartArrayFormulas(c.row,c.col,c.rowCount,c.colCount))return n._raiseInvalidOperation(1,m),!1;var p=h.pastedRange.row<0?o.getRowCount():h.pastedRange.rowCount,q=h.pastedRange.col<0?o.getColumnCount():h.pastedRange.colCount,r=c.row<0?a.getRowCount():c.rowCount,s=c.col<0?a.getColumnCount():c.colCount;if(p>r||q>s){var t=d.row,u=d.col;d.row<0&&r<o.getRowCount()&&(t=0),d.col<0&&s<o.getColumnCount()&&(u=0),p%r===0&&1===q?(q=s,h.pastedRange=new b.Range(t,u,p,q)):1===p&&q%s===0?(p=r,h.pastedRange=new b.Range(t,u,p,q)):(p%r!==0||q%s!==0)&&(p=r,q=s,h.pastedRange=new b.Range(t,u,p,q));for(var v=i(p/r),w=i(q/s),x=0;v>x;x++)for(var y=0;w>y;y++){if(o._hasPartSpans(0>t?-1:t+x*r,0>u?-1:u+y*s,0>t?-1:r,0>u?-1:s))return n._raiseInvalidOperation(1,l),!1;if(o._hasPartArrayFormulas(0>t?-1:t+x*r,0>u?-1:u+y*s,0>t?-1:r,0>u?-1:s))return n._raiseInvalidOperation(1,m),!1}}else{if(o._hasPartSpans(h.pastedRange.row,h.pastedRange.col,h.pastedRange.rowCount,h.pastedRange.colCount))return n._raiseInvalidOperation(1,l),!1;if(o._hasPartArrayFormulas(h.pastedRange.row,h.pastedRange.col,h.pastedRange.rowCount,h.pastedRange.colCount))return n._raiseInvalidOperation(1,m),!1}}else{if(o._hasPartSpans(h.pastedRange.row,h.pastedRange.col,h.pastedRange.rowCount,h.pastedRange.colCount))return n._raiseInvalidOperation(1,l),!1;if(o._hasPartArrayFormulas(h.pastedRange.row,h.pastedRange.col,h.pastedRange.rowCount,h.pastedRange.colCount))return n._raiseInvalidOperation(1,m),!1;if(h.pastedRange.row+h.pastedRange.rowCount>o.getRowCount()||h.pastedRange.col+h.pastedRange.colCount>o.getColumnCount())return n._raiseInvalidOperation(1,k),!1}return!0},c.prototype._isPastedInternal=function(a,b,c,d){if(a&&b&&c){var e=r.getRangeText(a,b.row,b.rowCount,b.col,b.colCount,"\r\n","	",'"',!1,0),f=e===d;return!f&&($.browser.chrome||$.browser.safari||$.browser.webkit)&&(f=e===d+"\r\n"),f}return!1},c.prototype._getPastedRange=function(a,c,d,f,g){var h=c.row<0?0:c.row,i=c.col<0?0:c.col,j=c.row<0?a.getRowCount():c.rowCount,k=c.col<0?a.getColumnCount():c.colCount,l=f.row<0?0:f.row,m=f.col<0?0:f.col,n=f.row<0?d.getRowCount():f.rowCount,o=f.col<0?d.getColumnCount():f.colCount;if(g?(n=j,o=k):n%j===0&&1===o?o=k:1===n&&o%k===0?n=j:(n%j!==0||o%k!==0)&&(n=j,o=k),!this._isValidRange(h,i,j,k,a.getRowCount(),a.getColumnCount()))return e;if(!this._isValidRange(l,m,n,o,d.getRowCount(),d.getColumnCount()))return e;var p=new b.Range(l,m,n,o);if(!g&&a._name===d._name)if(p.contains(h,i,j,k)){if((h-l)%j!==0||(i-m)%k!==0)return e}else if(p.intersect(h,i,j,k)&&(n>j||o>k))return e;return-1===f.row&&(l=-1,n=-1),-1===f.col&&(m=-1,o=-1),new b.Range(l,m,n,o)},c.prototype._getPastedRangefromText=function(a,c){var d=e,f=r.parseCsv(c,"\r\n","	",'"');if(f){var g=a.row<0?0:a.row,h=a.col<0?0:a.col,i=f.length,j=r.getMaxLength(f);i>0&&j>0&&(d=new b.Range(g,h,i,j))}return d},c.prototype._clipboardPaste=function(a,c,d,f,g,h,j){if(!a||d._name!==a._name||!d.parent||d.parent.sheets.contains(a)){var k,l,m,n,o,p;if(a&&c){var q=b.UndoRedo.ClipboardPasteRangeUndoAction.convertPasteOption,s=q(j);if(0!==(2&s)&&(g&&a._hasPartArrayFormulas(c.row,c.col,c.rowCount,c.colCount)||d._hasPartArrayFormulas(f.row,f.col,f.rowCount,f.colCount)))throw b.SR.Exp_ChangePartOfArray;if(g)r.moveTo(a,c.row,c.col,d,f.row,f.col,c.rowCount,c.colCount,s);else{var t=f.row<0?d.getRowCount():f.rowCount,u=f.col<0?d.getColumnCount():f.colCount;if(m=c.row<0?a.getRowCount():c.rowCount,n=c.col<0?a.getColumnCount():c.colCount,t>m||u>n){k=f.row,l=f.col,f.row<0&&m<d.getRowCount()&&(k=0),f.col<0&&n<d.getColumnCount()&&(l=0),t%m===0&&1===u?u=n:1===t&&u%n===0?t=m:(t%m!==0||u%n!==0)&&(t=m,u=n);var v=i(t/m),w=i(u/n);a.suspendCalcService(),d.suspendCalcService();try{for(o=0;v>o;o++)for(p=0;w>p;p++)r.copyTo(a,c.row,c.col,d,0>k?-1:k+o*m,0>l?-1:l+p*n,0>k?-1:m,0>l?-1:n,s)}finally{a.resumeCalcService(),d.resumeCalcService()}}else r.copyTo(a,c.row,c.col,d,f.row,f.col,c.rowCount,c.colCount,s)}}else{k=f.row,l=f.col,m=f.rowCount,n=f.colCount;for(var x=d._spanModel.getEnumerator(k,l,m,n),y=[];x.moveNext();){var z=x.current();z&&y.push(z)}for(var A=0,B=y.length;B>A;A++)d._spanModel.remove(y[A]);if(h&&""!==h)d.setCsv(k,l,h,"\r\n","	",16);else for(o=0;m>o;o++)for(p=0;n>p;p++)d.setValue(k+o,l+p,e)}}},c.prototype._raiseClipboardPasting=function(a,c){var d={sheet:this,sheetName:this._name,cellRange:a,pasteOption:c,cancel:!1};return this._trigger(b.Events.ClipboardPasting,d),d.cancel===!0},c.prototype._raiseClipboardPasted=function(a,c){var d={sheet:this,sheetName:this._name,cellRange:a,pasteOption:c};this._trigger(b.Events.ClipboardPasted,d)},c.prototype._raiseValueChanged=function(a,c){var d={sheet:this,sheetName:this._name,row:a,col:c};this._trigger(b.Events.ValueChanged,d)},c.prototype._raiseRangeDataChanged=function(a,c,d,e){var f={sheet:this,sheetName:this._name,row:a,column:c,rowCount:d,columnCount:e};this._trigger(b.Events.RangeChanged,f)},c.prototype._copyFormula=function(a,b,c,d,e,f){r.copyFormula(this,a,b,this,c,d,e,f)},c.prototype._getAutoFitType=function(){if(this.parent!=e){var a=this.parent;return a.autoFitType()}return 0},c.prototype._doCut=function(a){if(!this.isEditing()){var b=this.getSelections();if(b&&1===b.length)return this._clipboardCopy(b[0],!0,a)}return e},c.prototype._doCopy=function(a){if(!this.isEditing()){var b=this.getSelections();if(b&&1===b.length)return this._clipboardCopy(b[0],!1,a)}return e},c.prototype._doFloatingObjectCopy=function(a){var b=this;if(b._hasFloatingObjectsSelected()){var c,d,e=[],f=b._floatingObjectArray;for(c=0,d=f.length;d>c;c++){var g=f[c];g.isSelected()&&e.push(g.name())}b._clipboardFloatingObjectCopy(e,!1,a)}},c.prototype._doFloatingObjectCut=function(a){var c=this;if(c._hasFloatingObjectsSelected()){var d,e,f=[],g=c._floatingObjectArray;for(d=0,e=g.length;e>d;d++){var h=g[d];h.isSelected()&&f.push(h.name())}c._clipboardFloatingObjectCopy(f,!0,a);var i={names:f},j=new b.UndoRedo.DeleteFloatingObjectUndoAction(c,i);c._doCommand(j)}},c.prototype._doFloatingObjectPaste=function(a,c){var d=this;if(!d.isEditing()&&b.features.floatingObject){{var e=d._getFloatingObjectClipboardHelper(),f=e.fromSheet,g=f._eventHandler;e.isCutting}setTimeout(function(){var e=a;if(g&&!a&&(e=g._getClipboardFloatingObjectData()),e&&e.length){var h,i,j=[];for(h=0,i=e.length;i>h;h++)j.push(e[h].name());var k=new b.UndoRedo.ClipboardPasteFloatingObjectUndoAction(d,{names:j},f);d._doCommand(k)}c&&c()},100)}},c.prototype._doPaste=function(a,c){var d=this,f=d._eventHandler;if(!d.isEditing()){var g=b.SR.Exp_InvalidPastedArea,h=d._getClipboardHelper(),i=h.fromSheet,j=h.range;f&&!a&&f._switchFocusForClipboard(""),setTimeout(function(){var k=a;f&&!a&&(k=f._getClipboardData(),f._switchBackFocusAfterClipboard());var l=h.isCutting;l&&(h.fromSheet=e,h.range=e,h.isCutting=!1),l&&i&&j&&i.isProtected&&i._isAnyCellInRangeLocked(j)&&(l=!1);var m,n={pastedRange:e,pastedInternal:!1},o=[],p=d.getSelections();if(p.length>1)for(var q=0;q<p.length;q++){if(m=p[q],!d._checkPastedRange(i,j,m,l,k,n))return;if(m.containsRange(n.pastedRange)&&!m.equals(n.pastedRange))return void d._raiseInvalidOperation(1,g);o.push(n.pastedRange)}else if(p.length>0){if(m=p[0],!d._checkPastedRange(i,j,m,l,k,n))return;o.push(n.pastedRange)}else{if(m=d._getSpanModel().find(d._activeRowIndex,d._activeColIndex),m||(m=new b.Range(d._activeRowIndex,d._activeColIndex,1,1)),!d._checkPastedRange(i,j,m,l,k,n))return;o.push(n.pastedRange)}if(o.length>0){n.pastedInternal||(i=e,j=e);var r=d.clipBoardOptions();l&&(r=0);var s={fromRange:j,pastedRanges:o.slice(0),isCutting:l,clipboardText:k},t=new b.UndoRedo.ClipboardPasteUndoAction(d,i,d,s,r);d._doCommand(t)}c&&c()},100)}},c.prototype._getImageLoader=function(){if(!this.imageLoader){var a=this;this.imageLoader=new b._GcImageLoader(function(){a.repaint()})}return this.imageLoader},c.prototype._getContainerDiv=function(){var a=this;return!a._containerDiv&&a._canvas&&a._canvas.parentNode&&(a._containerDiv=o.createElement("div"),$(a._containerDiv).css({position:"absolute",left:0,top:0,width:0,height:0}),$(a._canvas.parentNode).prepend(a._containerDiv)),a._containerDiv},c.prototype.setComment=function(a,c,d){if(b.features.comment){var e=this,f=this._commentManager,g=e.getComment(a,c);g&&f&&f.containsComment(g)&&f.removeComment(g);var h=e._getModel(3);h.setComment(a,c,d),f.addComment(a,c,d),e._raiseCellChanged("comment",a,c,3)}},c.prototype.getComment=function(a,c){if(!b.features.comment)return e;var d=this._getModel(3);return d.getComment(a,c)},c.prototype.getComments=function(){return b.features.comment?this._commentManager.getCommentList():void 0},c}();b.Sheet=R;var S=function(){function a(){}return a.startCatch=function(b,c,d,e,f){var g=a;g._catched=!0;b.getRowCount();if(b._hasTable(c,d,e-c+1,f-d+1))for(var h=-1,i=g._visibleRowIndexCatch=[],j=0;e>=j;j++)b.getRowVisible(j)?(h++,i[j]=h):i[j]=-1},a.clearCatch=function(){a._visibleRowIndexCatch=null,a._catched=!1},a._catched=!1,a}();b._CatchMgr=S}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){b.feature("core.spread",["core.common","core.theme","core.sheet_event","core.sheet_action","core.sheet","core.spreadpanelex","core.stringResource","core.imageLoader"]);var c=null,d=void 0,e=Math.round,f=Math.max,g=Math.min,h="undefined",i=window.document,j="scroll",k="resize",l="input",m="div",n="px",o="0",p="top",q="none",r=".gcSpread",s="_data",t=".gcScrollbar",u="scroll-handle",v="scroll-bar",w="mousedown",x="mouseup",y=function(){function f(a,b,d){var e=this;e._host=c,e._allowUndo=!0,e._paintSuspended=!1,e._availableSheetIndex=-1,e._useTouchLayout=!1,e.sheets=c,e.name=c,e.useWijmoTheme=!1,e._tabStripRatio=.5,e._tabStripRatioUserSet=.5,e._activeSheetIndex=0,e._allowUserZoom=!0,e._allowUserResize=!0,e._allowSheetReorder=!0,e._tabStripVisible=!0,e._tabEditable=!0,e._newTabVisible=!0,e._firstTabUserSet=0,e._canUserEditFormula=!0,e._highlightInvalidData=!1,e._autoFitType=0,e._allowDragDrop=!0,e._allowDragFill=!0,e._showScrollTip=0,e._showResizeTip=0,e._showDragDropTip=!0,e._showDragFillTip=!0,e._tooltip=c,e._showVerticalScrollbar=!0,e._showHorizontalScrollbar=!0,e._backColor="white",e._backgroundImage=c,e._backgroundImageLayout=0,e._grayAreaBackColor="gray",e._imageLoader=c,e._suspendSetFocus=!1,e._cutCopyIndicatorVisible=!0,e._cutCopyIndicatorBorderColor="#217346",e._defaultSheetCount=1,e._defaultActiveSheetIndex=0,e._windowResizeTimer=c,e._init(a,b,d)}return f.prototype._init=function(a,d,e){var f=this;f.name=a,b.util.hasCalc()&&(f.calcService=new b.Calc.Service(f)),f._userEvents=[],f._userEventsElem=i.createElement(l),f._eventSuspended=0,f._undoManager=new b._UndoManager(f,-1,f.allowUndo()),f._clipboardHelper={fromSheet:c,range:c,isCutting:!1},f._floatingObjectClipboardHelper={fromSheet:c,isCutting:!1},f._containerDiv=c,b.features.touch&&(f._touchEventProvider=new b.TouchEventProvider),f.sheets=[],f._namedStyles={},b.features.sparklineEx&&(f._sparklineExs={},f.addSparklineEx(new b.PieSparkline),f.addSparklineEx(new b.AreaSparkline),f.addSparklineEx(new b.ScatterSparkline),f.addSparklineEx(new b.LineSparkline),f.addSparklineEx(new b.ColumnSparkline),f.addSparklineEx(new b.WinlossSparkline));var g;for(g=0;d>g;g++)f.sheets.push(f._createSheet(f._getDefaultSheetName(g)));if(f.sheets.length>0&&b.util.hasCalc()){var h=c;for(g=0;!h&&g<f.sheets.length;g++)h=f.sheets[g]._getSheetSource();if(h)for(g=0;g<f.sheets.length;g++){var j=f.sheets[g]._getSheetSource();j&&j.shareCalculations(h)}}e&&f._setHost(e),b.features.touch&&!f.touchToolStrip&&(f.touchToolStrip=new b.TouchToolStrip(f))},f.prototype._getContainerDiv=function(){var a=this;return!a._containerDiv&&a._host&&(a._containerDiv=i.createElement("div"),$(a._containerDiv).css({position:"relative",left:0,top:0,width:0,height:0}),$(a._host).prepend(a._containerDiv)),a._containerDiv},f.prototype._getDefaultSheetName=function(a){var b=this;b._availableSheetIndex<b.getSheetCount()?b._availableSheetIndex=b.getSheetCount():b._availableSheetIndex++,(a===d||a===c||a<b._availableSheetIndex)&&(a=b._availableSheetIndex);var e,f=!1;do{e="Sheet"+(a+1);var g=b.sheets.length;if(g>0)for(var h=0;g>h;h++)if(h in b.sheets){var i=b.sheets[h];if(i._name===e){a++,f=!0;break}f&&(f=!1)}}while(f);return e},f.prototype._createSheet=function(a){var c=new b.Sheet(a);return c.calcService=this.calcService,c.parent=this,c},f.prototype._slSetHost=function(a){var c=this;$(a).data("spread",c);var d=i.createElement("canvas");d.setAttribute("width",""+a.clientWidth),d.setAttribute("height",""+a.clientHeight),a.appendChild(d),c.canvas=d,d.setAttribute("renderMethod","auto"),d.setAttribute("gcSpreadsheet","true"),d.setAttribute("onload","$.wijmo.wijspread.util.initPaint('"+a.id+"')"),this._resizeHandler=b.util.createEventHandler(c,c._doResize),$(window).bind("resize.gcSpread",this._resizeHandler)},f.prototype._setHost=function(a){var d=this;if(a){var e=b.util._isStandardCanvas(),f=b.util._isSilverlightCanvas();if(!e&&f)return d._slSetHost(a),void(window.slcanvas&&window.slcanvas.autoLoad&&window.slcanvas.autoLoad());d._host=a,$(a).data("spread",d),a.setAttribute("gcUIElement","gcSpread"),b.Global.prototype._createDummyObjects();var g,h,l=[];for(g=0;g<a.children.length;g++)l.push(a.children[g]);a.innerHTML="<table cellspacing=0 cellpadding=0 border=0><tr><td></td><td></td></tr><tr><td></td><td></td></tr></table>";var p=a.firstChild;for($(a).bind(b.Events.CultureChanged,d,d._onCultureChanged),$(a).addClass("gc-host-none-user-select");l.length>0;)a.insertBefore(l.pop(),p);d._vp=i.createElement(m),d._vp.id=a.id+"vp",p.rows[0].cells[0].insertBefore(d._vp,c);var q="100%";for(p.style.width=q,p.style.height=q,p.style.border=o,p.style.margin=o,g=0;g<p.rows.length;g++)for(h=0;h<p.rows[g].cells.length;h++)p.rows[g].cells[h].style.padding=o,p.rows[g].cells[h].style.border=o;d._scrollbarV=new $.wijmo.wijspread.Scrollbar(!1);var s=d._scrollbarV.getScrollbar();p.rows[0].cells[1].insertBefore(s,c),$(s).bind(j+t,function(a,b){var c=(d.getActiveSheet(),b.scrollEventType),e=b.scrollOrientation;if(a.data=d,1===e)switch(c){case 0:case 1:case 2:case 3:case 5:d._vscrollDelegate(a,b);break;case 4:d._vScrollStop(a)}}),$(s).bind(w+t,function(a){a.data=d,d._vScrollMouseDown(a)}),$(s).bind(x+t,function(a){a.data=d,d._scrollMouseUp(a)}),p.rows[1].cells[0].innerHTML="<table cellspacing=0 cellpadding=0 border=0><tr><td></td><td></td></tr></table>";var u=p.rows[1].cells[0].firstChild;for(u.style.border=o,u.style.margin=o,$(u).css("user-select","none"),g=0;g<u.rows.length;g++)for(h=0;h<u.rows[g].cells.length;h++)u.rows[g].cells[h].style.padding=o,u.rows[g].cells[h].style.border=o;d._tabs=i.createElement(m),d._tabs.style.width=""+d._getActualTabStripRatio()*$(d._host).width()+n,d._tabs.style.height=""+d._getScrollbarSize()+n,d._tabs.style.fontSize="10pt",d._tabs.style.fontFamily="Arial",u.rows[0].cells[0].insertBefore(d._tabs,c),d._tab=new kb(a.getAttribute("id")+"_tabStrip"),d._tab.setOwner(d),d._tab._setHost(d._tabs),d._scrollbarH=new $.wijmo.wijspread.Scrollbar(!0);var v=d._scrollbarH.getScrollbar();u.rows[0].cells[1].insertBefore(v,c),$(v).bind(j+t,function(a,b){var c=(d.getActiveSheet(),b.scrollEventType),e=b.scrollOrientation;if(a.data=d,0===e)switch(c){case 0:case 1:case 2:case 3:case 5:d._hscrollDelegate(a,b);break;case 4:d._hScrollStop(a)}}),$(v).bind(w+t,function(a){a.data=d,d._hScrollMouseDown(a)}),$(v).bind(x+t,function(a){a.data=d,d._scrollMouseUp(a)}),this._resizeHandler=b.util.createEventHandler(d,d._doWindowResize),$(window).bind(k+r,this._resizeHandler),b.features.comment&&(d._commentRender=new b.CommentRender(d._getContainerDiv()));var y=d.getActiveSheet();y&&(y._setHost(d._vp),$(window).unbind("resize.gcSheet")),d._doResize(),Object.defineProperty&&Object.defineProperty(d,"useWijmoTheme",{set:function(a){var b=d._scrollbarH,c=d._scrollbarV;b&&b.useWijmoTheme(a),c&&c.useWijmoTheme(a),this._useWijmoTheme=a},get:function(){return!!this._useWijmoTheme}})}},f.prototype._onCultureChanged=function(a){var b=a.data;b.invalidateLayout(),b.touchToolStrip&&b.touchToolStrip._updateResource();for(var d=0,e=b.sheets.length;e>d;d++)for(var f=b.sheets[d],g=f.getRowCount(),h=f.getColumnCount(),i=0;g>i;i++)for(var j=0;h>j;j++){var k=f.getValue(i,j);if(k!==c){var l=f.getStyle(i,j);l&&l._setActualAutoFormatter(k)}}b.repaint()},f.prototype._hscrollDelegate=function(a,e){var f=a.data,g=f.getActiveSheet();if(g&&e){var h=parseInt(e.newValue,10);if((e.oldValue===d||e.oldValue===c)&&(e.oldValue=0),e.oldValue=parseInt(e.oldValue,10),2===e.scrollEventType||0===e.scrollEventType){2===e.scrollEventType&&(h=g._getPrevPageLeftColumn());var i=g._getScrollableColumn(h,!0);-1!=i&&i!=h&&(h=i)}else if(3===e.scrollEventType||1===e.scrollEventType){3===e.scrollEventType&&(h=g._getPageRightColumn());var i=g._getScrollableColumn(h);-1!=i&&i!=h&&(h=i)}var j=g._getFirstPageLeftColumn();j>h&&(h=j),h>g._getLastVisualColumn()&&(h=g._getLastVisualColumn()),e.newValue!==h&&(e.newValue=h),e.oldValue!==e.newValue&&(g._eventHandler.doHScroll(h),g._trigger(b.Events.LeftColumnChanged,{sheet:g,sheetName:g._name,oldLeftCol:e.oldValue,newLeftCol:e.newValue}))}},f.prototype._hScrollStop=function(a){var b=a.data,c=b.getActiveSheet();if(c){var d=b._scrollbarH,e=d.value();e<c._getFirstPageLeftColumn()?d.value(c._getFirstPageLeftColumn()):e>c._getLastVisualColumn()&&d.value(c._getLastVisualColumn()),c._eventHandler._removeTooltip()}},f.prototype._hScrollMouseDown=function(a){var b=a.data;if(b){var c=b.showScrollTip();if(1===c||3===c){var d=$(a.srcElement?a.srcElement:a.target),e=d.parent();if((d&&d.hasClass(u)||e&&e.hasClass(u)||d&&d.hasClass(v)||e&&e.hasClass(v))&&(d||e)){var f=b.getActiveSheet(),g=f&&f._eventHandler;g&&g._showScrollTooltip(!1,a)}}}},f.prototype._vscrollDelegate=function(a,e){var f=a.data,g=f.getActiveSheet();if(g&&e){var h=parseInt(e.newValue,10);if((e.oldValue===d||e.oldValue===c)&&(e.oldValue=0),e.oldValue=parseInt(e.oldValue,10),2===e.scrollEventType||0===e.scrollEventType){2===e.scrollEventType&&(h=g._getPrevPageTopRow());var i=g._getScrollableRow(h,!0);-1!=i&&i!=h&&(h=i)}else if(3===e.scrollEventType||1===e.scrollEventType){3===e.scrollEventType&&(h=g._getPageBottomRow());var i=g._getScrollableRow(h);-1!=i&&i!=h&&(h=i)}var j=g._getFirstPageTopRow();j>h&&(h=j),h>g._getLastVisualRow()&&(h=g._getLastVisualRow()),e.newValue!==h&&(e.newValue=h),e.oldValue!==h&&(g._eventHandler.doVScroll(h),g._trigger(b.Events.TopRowChanged,{sheet:g,sheetName:g._name,oldTopRow:e.oldValue,newTopRow:h}))}},f.prototype._initPaint=function(){var a=b.util._isStandardCanvas();if(!a){var c=this,d=c.getActiveSheet();if(d){var e=d._getCanvas();e&&e.firstChild&&e.firstChild.loaded?(c.invalidateLayout(),c.repaint()):window.setTimeout(function(){c._initPaint.call(c)},10)}}},f.prototype._vScrollStop=function(a){var b=a.data,c=b.getActiveSheet();if(c){var d=b._scrollbarV,e=d.value();e<c._getFirstPageTopRow()?d.value(c._getFirstPageTopRow()):e>c._getLastVisualRow()&&d.value(c._getLastVisualRow()),c._eventHandler._removeTooltip()}},f.prototype._vScrollMouseDown=function(a){var b=a.data;if(b){var c=b.showScrollTip();if(2===c||3===c){var d=$(a.srcElement?a.srcElement:a.target);
if(d){var e=d.parent();if(d.hasClass(u)||e&&e.hasClass(u)||d.hasClass(v)||e&&e.hasClass(v)){var f=b.getActiveSheet(),g=f&&f._eventHandler;g&&g._showScrollTooltip(!0,a)}}}}},f.prototype._scrollMouseUp=function(a){var b=a.data;if(b){var c=b.getActiveSheet(),d=c&&c._eventHandler;d&&d._removeTooltip()}},f.prototype._dispose=function(){var a=this;$(window).unbind(k+r,this._resizeHandler),a._scrollbarH&&a._scrollbarH.dispose(),a._scrollbarV&&a._scrollbarV.dispose(),a._touchEventProvider&&a._touchEventProvider.dispose(),a._disposeUserEvents();var d=a.getActiveSheet();if(d&&d._dispose(),a._host){a._host.innerHTML="",a._host.removeAttribute("gcUIElement");var e=$(a._host);e.unbind(b.Events.CultureChanged),e.removeClass("gc-host-none-user-select"),e.attr("class")||e.removeAttr("class")}a.touchToolStrip&&(a.touchToolStrip._dispose(),a.touchToolStrip=c),a._commentRender&&(a._commentRender=c)},f.prototype._disposeUserEvents=function(){$(this._userEventsElem).unbind(r);for(var a=0;a<this.sheets.length;a++){var b=this.sheets[a];b._disposeUserEvents()}},f.prototype._getCalcContexts=function(){for(var a=[],b=0;b<this.sheets.length;b++){var c=this.sheets[b],d=c._getCalcContexts();if(d)for(;d.length>0;)a.push(d.pop())}return a},f.prototype._doWindowResize=function(){var a=this;a._windowResizeTimer&&window.clearTimeout(a._windowResizeTimer),a._windowResizeTimer=window.setTimeout(function(){a._doResize(),a._windowResizeTimer=c},100)},f.prototype._doResize=function(){var a=this;if($.browser.msie&&parseInt($.browser.version,10)<9){var b=a.canvas;if(b){var c=b.parentElement,d=c.parentElement,e=b.firstChild;if(e&&d){var f=function(a){return""===a||"auto"===a||/%$/gi.test(a)};f(c.style.width)&&d.offsetWidth>12&&(e.width=d.offsetWidth-12),f(c.style.height&&d.offsetHeight>10)&&(e.height=d.offsetHeight-10)}}}var g=a._getScrollbarSize(),h=a._host;if(h){var i=$(h),j=i.width(),k=$(h).height();a._vp.style.width=a.showVerticalScrollbar()?""+(j-g)+n:""+j+n,a._vp.style.height=a.showHorizontalScrollbar()||a._tabStripVisible?""+(k-g)+n:""+k+n;var l=$(a._vp).width(),m=a._getActualTabStripRatio()*l;a._tabs.style.width=""+(m-1)+n,a._tabs.style.height=""+g+n,a._scrollbarV.width(g),a._scrollbarV.height($(a._vp).height());var o=j-(a._tabStripVisible?m:0)-(a.showVerticalScrollbar()?g:0);a._scrollbarH.width(o>0?o:1),a._scrollbarH.height(g);var p=a.getActiveSheet();p&&(0===p._scrollTopRow&&(p._scrollTopRow=p._getFirstPageTopRow()),0===p._scrollLeftCol&&(p._scrollLeftCol=p._getFirstPageLeftColumn())),p&&p._eventHandler.doResize(),a._resizeScrollBar(),a._tabStripVisible===!0?$(a._tabs).show():$(a._tabs).hide(),a._tab.doResize();var q=i.width();j===q||a._haveLayoutFixing||(a._haveLayoutFixing=!0,setTimeout(function(){delete a._haveLayoutFixing,a._doResize()},1))}},f.prototype._resizeScrollBar=function(){var a=this.getActiveSheet();if(a){for(var b=a.getColumnCount()-a._frozenTrailingColCount-a.frozenColCount,c=a.getRowCount()-a._frozenTrailingRowCount-a.frozenRowCount,d=1,f=1,g=a.frozenColCount,h=a.frozenRowCount,i=a._getSheetLayout(),j=h;h+c>j;j++)d+=a.getRowHeight(j);for(var k=g;g+b>k;k++)f+=a.getColumnWidth(k);var l=i.width-i.rowHeaderWidth-i.frozenWidth-i.frozenTrailingWidth,m=i.height-i.colHeaderHeight-i.frozenHeight-i.frozenTrailingHeight,n=this._scrollbarH,o=this._scrollbarV,p=e(b*l/f),q=e(c*m/d);0>p&&(p=1),0>q&&(q=1),n&&(n.minimum(a.frozenColCount),n.maximum(a.frozenColCount+b-1),n.pageValue(p),n.refreshLayout(),n.value(a._scrollLeftCol)),o&&(o.minimum(a.frozenRowCount),o.maximum(a.frozenRowCount+c-1),o.pageValue(q),o.refreshLayout(),o.value(a._scrollTopRow))}},f.prototype._doTabHSResize=function(){var a=this,b=a._getScrollbarSize(),c=a._host;if(c){var d=$(c),e=d.width(),f=$(a._vp).width(),g=a._getActualTabStripRatio()*f;a._tabs.style.width=""+(g-1)+n,a._tabs.style.height=""+b+n;var h=e-(a._tabStripVisible?g:0)-(a.showVerticalScrollbar()?b:0);a._scrollbarH.width(h>0?h:1),a._scrollbarH.height(b),a._scrollbarH.refreshLayout();var i=a.getActiveSheet();i&&(0===i._scrollLeftCol&&(i._scrollLeftCol=i._getFirstPageLeftColumn()),a._scrollbarH.value(i._scrollLeftCol)),a._tabStripVisible===!0?$(a._tabs).show():$(a._tabs).hide(),a._tab.doResize()}},f.prototype._trigger=function(a,b){0===this._eventSuspended&&$(this._userEventsElem).trigger(a,[b])},f.prototype._copyUserEvents=function(a){a._eventHandler._eventSuspended=this._eventSuspended;for(var b=0;b<this._userEvents.length;b++){var c=this._userEvents[b];a.bind(c.type,c.data,c.fn)}},f.prototype._suspendInvalidate=function(){var a=this.getActiveSheet();a&&a._suspendInvalidate()},f.prototype._resumeInvalidate=function(){var a=this.getActiveSheet();return a?a._resumeInvalidate():!1},f.prototype._paintSpreadBackgroundImage=function(){var a=this,e=a.getActiveSheet();if(e){if(!a._backgroundImage)return;var f=$(e._getCanvas());if(f.css("background-image","url('"+a._backgroundImage+"')").css("background-repeat","no-repeat"),a._backgroundImageLayout===c||a._backgroundImageLayout===d)return;var g=a._backgroundImage;a._imageLoader||(a._imageLoader=new b._GcImageLoader(function(){a._paintSpreadBackgroundImage()}));try{if(a._imageLoader.getState(g)){var h=a._imageLoader.getImage(g),i=f.width(),j=f.height();b.util._applyBackgroundImageLayout(e._getCanvas(),i,j,h.width,h.height,a._backgroundImageLayout)}else a._imageLoader.addImage(g)}catch(k){}}},f.prototype.showVerticalScrollbar=function(a){var b=this;return 0===arguments.length?b._showVerticalScrollbar:(b._showVerticalScrollbar!==a&&(b._showVerticalScrollbar=a,a?$(b._scrollbarV.getScrollbar()).show():$(b._scrollbarV.getScrollbar()).hide(),b._doResize()),b)},f.prototype.showHorizontalScrollbar=function(a){var b=this;return 0===arguments.length?b._showHorizontalScrollbar:(b._showHorizontalScrollbar!==a&&(b._showHorizontalScrollbar=a,a?($(b._scrollbarH.getScrollbar()).show(),b.setTabStripRatio(b.getTabStripRatio())):($(b._scrollbarH.getScrollbar()).hide(),b._setActualTabStripRatio(1)),b._doResize()),b)},f.prototype.allowUserZoom=function(a){return 0===arguments.length?this._allowUserZoom:(this._allowUserZoom=a,this)},f.prototype.allowSheetReorder=function(a){return 0===arguments.length?this._allowSheetReorder:(this._allowSheetReorder=a,this)},f.prototype.allowUserResize=function(a){return 0===arguments.length?this._allowUserResize:(this._allowUserResize=a,this)},f.prototype.tabStripVisible=function(a){var b=this;return 0===arguments.length?b._tabStripVisible:(b._tabStripVisible!==a&&(b._tabStripVisible=a,b._doResize()),b)},f.prototype.tabEditable=function(a){return 0===arguments.length?this._tabEditable:(this._tabEditable=a,this)},f.prototype.newTabVisible=function(a){var b=this;return 0===arguments.length?b._newTabVisible:(b._newTabVisible!==a&&(b._newTabVisible=a,b._doTabHSResize()),b)},f.prototype.cutCopyIndicatorVisible=function(a){var b=this;if(0===arguments.length)return b._cutCopyIndicatorVisible;if(b._cutCopyIndicatorVisible===a)return b;var c=b.getActiveSheet();return c?c._bindToAutoRefresh(function(a){return b._cutCopyIndicatorVisible=a,b})(a):(b._cutCopyIndicatorVisible=a,b)},f.prototype.cutCopyIndicatorBorderColor=function(a){var b=this;if(0===arguments.length)return b._cutCopyIndicatorBorderColor;if(b._cutCopyIndicatorBorderColor===a)return b;var c=b.getActiveSheet();return c?c._bindToAutoRefresh(function(a){return b._cutCopyIndicatorBorderColor=a,b})(a):(b._cutCopyIndicatorBorderColor=a,b)},f.prototype.canUserEditFormula=function(a){return 0===arguments.length?b.util.hasCalc()&&this._canUserEditFormula:(this._canUserEditFormula=a,this)},f.prototype.autoFitType=function(a){return 0===arguments.length?this._autoFitType:(this._autoFitType=a,this)},f.prototype.startSheetIndex=function(a){var b=this;if(0===arguments.length)return b._tab?b._firstTabUserSet:0;if(b._tab&&a>=0&&a<b.getSheetCount())if(b._firstTabUserSet=a,b.sheets[a].visible())b._tab._firstTab=a;else{var c=b._tab._getNextVisibleIndex(a);-1!==c&&(b._tab._firstTab=c)}return b._doTabHSResize(),b},f.prototype.highlightInvalidData=function(a){if(0===arguments.length)return this._highlightInvalidData;var b=this,c=this.getActiveSheet();return c?c._bindToAutoRefresh(function(a){return b._highlightInvalidData=a,b})(a):void(b._highlightInvalidData=a)},f.prototype.isPaintSuspended=function(a){var b=this;if(0===arguments.length)return b._paintSuspended;if(b._paintSuspended!==a){b._paintSuspended=a;for(var c=0;c<b.sheets.length;c++)b.sheets[c].isPaintSuspended(a);b._tab&&b._tab.isPaintSuspended(a)}return b},f.prototype.repaint=function(){var a=this;a._tab&&a._tab.repaint(),a.touchToolStrip&&a.touchToolStrip.repaint();var b=a.getActiveSheet();b&&b.repaint()},f.prototype.invalidateLayout=function(){var a=this.getActiveSheet();a&&a.invalidateLayout()},f.prototype.getActiveSheet=function(){return this.sheets.length>0?this.sheets[this._activeSheetIndex]:c},f.prototype.setActiveSheet=function(a){for(var b=this.sheets,c=0;c<b.length;c++)b[c].getName()===a&&this.setActiveSheetIndex(c)},f.prototype.getActiveSheetIndex=function(){return this._activeSheetIndex},f.prototype.setActiveSheetIndex=function(a){if("number"==typeof a){var b=this;if(a!==b._activeSheetIndex){var c=b.sheets[a];if(c&&c.visible()){var d=b.getActiveSheet();b._activeSheetIndex=a,c!==d&&(d&&d._dispose(),b._setActiveSheetImp(c)),b._doResize()}}}},f.prototype.addNamedStyle=function(a){this._addNamedStyleImp(a,!0)},f.prototype._addNamedStyleImp=function(a,e){var f=this;if(a!==c&&a!==d){if(a.name===c||a.name===d||""===a.name)throw new Error(b.SR.Exp_EmptyNamedStyle);if(e){var g=a.name.toUpperCase(),h=f.getActiveSheet();h?h._bindToAutoRefresh(function(a){f._namedStyles[g]=a})(a):f._namedStyles[g]=a}else{var g=a.name.toUpperCase();f._namedStyles[g]=a}}},f.prototype.getNamedStyle=function(a){var b=this._namedStyles;return b&&a?(a=a.toUpperCase(),b[a]||c):c},f.prototype.removeNamedStyle=function(a){var b=this._namedStyles;if(b&&a&&(a=a.toUpperCase(),b.hasOwnProperty(a))){delete b[a];var c=this.getActiveSheet();c&&c.invalidate()}},f.prototype.getNamedStyles=function(){var a=[],b=this._namedStyles;return b&&$.each(b,function(b,c){a.push(c)}),a},f.prototype._setActiveSheetImp=function(a){a._setHost(this._vp),window.gcGlobal.activeElement=c,this._suspendSetFocus||a.setFocus(),a._syncHScollbarPosition(),a._syncVScrollbarPosition()},f.prototype.addSheet=function(a,d){var e=this;d||(d=e._createSheet(e._getDefaultSheetName(a))),d._name||(d._name=e._getDefaultSheetName(a));var f,g=e.sheets.length;for(f=0;g>f;f++)if(e.sheets[f]._name===d._name)throw b.SR.Exp_NotSupport;e._copyUserEvents(d);var h=c;if(e.sheets.length>0)for(f=0;!h&&f<e.sheets.length;f++)h=e.sheets[f]._getSheetSource();var i=e.getActiveSheet(),j=e._activeSheetIndex,k=e.sheets.length-a,l=[];for(f=0;k>f&&e.sheets.length>0;f++)l.push(e.sheets.pop());var m=e.isPaintSuspended();if(d._paintSuspended!==m&&(d._paintSuspended=m),e.sheets.push(d),d.parent=e,d.calcService=e.calcService,d.updateCalcContexts(),h){var n=d._getSheetSource();n&&n.shareCalculations(h)}for(;l.length>0;)e.sheets.push(l.pop());1===e.sheets.length?(e._vp&&d._setHost(e._vp),e._activeSheetIndex=0):e._activeSheetIndex=j;var o=e.getActiveSheet();o!==i&&(i&&i._dispose(),o&&e._setActiveSheetImp(o),e._doResize()),e._tab&&e._tab.repaint()},f.prototype.removeSheet=function(a){var c=this;if(isNaN(a)||0>a||a>=c.sheets.length)throw new Error(b.SR.Exp_IndexOutOfRange);var d=a<=c._activeSheetIndex||a===c.sheets.length-1,e=c.getActiveSheet();a<c._activeSheetIndex&&c._activeSheetIndex--;var f=c.sheets[a];f._disposeUserEvents(),c.sheets.splice(a,1);var g=c.sheets,h=g.length;if(0===h)c._activeSheetIndex=-1;else if(c._activeSheetIndex>=h)c._activeSheetIndex=c._tab._getPreVisibleIndex(h);else{for(var i=c._activeSheetIndex;h>i;i++)if(g[i]._visible){c._activeSheetIndex=i;break}i>=h&&(c._activeSheetIndex=-1)}if(d){var j=c.sheets[c._activeSheetIndex];e!==j&&(e&&e._dispose(),j&&c._setActiveSheetImp(j))}if(c.calcService&&c.calcService.contextChanged(),c._tab){var k=c.sheets.length;c._tab._firstTab>=k?c.startSheetIndex(c._tab._getPreVisibleIndex(k)):c._tab._firstTab<0?c.startSheetIndex(0):c._doResize()}},f.prototype.clearSheets=function(){for(var a=this,b=a.sheets,c=(a.getActiveSheet(),0);c<b.length;c++)b[c]._disposeUserEvents(),b[c]._dispose();b.splice(0,b.length),a.calcService&&a.calcService.contextChanged(),a._activeSheetIndex=-1,a._tab&&(a._tab._firstTab=0,a._tab.repaint())},f.prototype.getSheet=function(a){return a>=0&&a<this.sheets.length?this.sheets[a]:c},f.prototype.getSheetFromName=function(a){for(var b=this.sheets,d=0;d<b.length;d++)if(b[d].getName()===a)return b[d];return c},f.prototype.getSheetIndex=function(a){for(var b=this.sheets,d=0;d<b.length;d++)if(b[d].getName()===a)return d;return c},f.prototype.getSheetCount=function(){return this.sheets.length},f.prototype.setSheetCount=function(a){var c=this;if(0>a)throw b.SR.Exp_ArgumentOutOfRange;0===a&&c.clearSheets();var d,e=c.sheets.length;if(e>a)for(d=e-1;d>=a;d--)c.removeSheet(d);else if(a>e)for(d=e;a>d;d++)c.addSheet(d)},f.prototype.search=function(a){if(!a||!b.features.search)return c;var d=this,e=0;if(!a.searchString||a.searchTarget===e||d.getSheetCount()<=0)return new b.SearchResult;if(-1===a.startSheetIndex&&(a.startSheetIndex=0),-1===a.endSheetIndex&&(a.endSheetIndex=d.getSheetCount()-1),a.endSheetIndex>=a.startSheetIndex&&0<=a.startSheetIndex&&a.startSheetIndex<d.getSheetCount()&&0<=a.endSheetIndex&&a.endSheetIndex<d.getSheetCount())for(var f=a.startSheetIndex;f<=a.endSheetIndex;f++){var g=d.getSheet(f),h=g.search(a);if(h&&h.searchFoundFlag!==e)return h.foundSheetIndex=f,h}return new b.SearchResult},f.prototype.showCell=function(a,b,c,d){var e=this.getActiveSheet();e&&e.showCell(a,b,c,d)},f.prototype.showColumn=function(a,b){var c=this.getActiveSheet();c&&c.showColumn(a,b)},f.prototype.showRow=function(a,b){var c=this.getActiveSheet();c&&c.showRow(a,b)},f.prototype.showActiveCell=function(a,b){var c=this.getActiveSheet();c&&c.showCell(c._activeRowIndex,c._activeColIndex,a,b)},f.prototype.getCustomName=function(a){return this._names?this._names[a]:c},f.prototype.getCustomNames=function(){var a=[];return this._names&&$.each(this._names,function(b,c){a.push(c)}),a},f.prototype.addCustomName=function(a,e,f,g){if(a===d||a===c||""===a||e===d||e===c||""===e)throw new Error(b.SR.Exp_InvalidCustomName);var h=this;if(h._names||(h._names={}),h.calcService){var i=h.calcService.parse(e,f,g);h._names[a]=new b.NameInfo(a,i,f,g),h._recalcAll()}},f.prototype.removeCustomName=function(a){var b=this;b._names&&a!==d&&a!==c&&""!==a&&b._names.hasOwnProperty(a)&&(delete b._names[a],b._recalcAll())},f.prototype.clearCustomNames=function(){this._names&&(delete this._names,this._recalcAll())},f.prototype._findCustomName=function(a){if(a===d||a===c||""===a)return c;var b=this.getCustomName(a);return b},f.prototype.addCustomFunction=function(a){if(b.util.hasCalc()){if(a===d||a===c||!(a instanceof b.Calc.Functions.Function))throw new Error(b.SR.Exp_InvalidCustomFunction);var e=this,f=a.name.toUpperCase();e._functions||(e._functions=[]),e._functions[f]=a,e._recalcAll()}},f.prototype.getCustomFunction=function(a){return this._functions&&a!==d&&a!==c&&""!==a?this._functions[a.toUpperCase()]:c},f.prototype.removeCustomFunction=function(a){var b=this;b._functions&&a!==d&&a!==c&&""!==a&&(a=a.toUpperCase(),b._functions.hasOwnProperty(a)&&(delete b._functions[a],b._recalcAll()))},f.prototype.clearCustomFunctions=function(){this._functions&&(this._functions=c,this._recalcAll())},f.prototype._recalcAll=function(){this.calcService&&!this.calcService.IsSuspended()&&this.calcService.recalculateAll()},f.prototype.addCustomFunctionDescription=function(a){if(a&&a.name&&!this.getCustomFunctionDescription(a.name)){var b=this._functionDescriptions;b||(b=this._functionDescriptions=[]),b.push(a)}},f.prototype.getCustomFunctionDescription=function(a){var b=this._functionDescriptions;if(b&&a){a=a.toUpperCase();for(var d,e=b.length,f=0;e>f;f++)if(d=b[f],d.name&&d.name.toUpperCase()===a)return d}return c},f.prototype.removeCustomFunctionDescription=function(a){var b=this._functionDescriptions;if(b&&a){a=a.toUpperCase();for(var c,d=b.length,e=0;d>e;e++)if(c=b[e],c.name&&c.name.toUpperCase()===a){b.splice(e,1);break}}},f.prototype.clearCustomFunctionDescriptions=function(){this._functionDescriptions&&(this._functionDescriptions=c)},f.prototype.referenceStyle=function(a){var b=this,c=1,d=0;return 0===arguments.length?b.calcService&&b.calcService.useR1C1?c:d:(b.calcService&&(b.calcService.useR1C1=a===c),b)},f.prototype.bind=function(a,b,c){var d=this;d._userEvents.push({type:a,data:b,fn:c}),$(d._userEventsElem).bind(a+r,b,c);for(var e=0;e<d.sheets.length;e++){var f=d.sheets[e];f.bind(a,b,c)}},f.prototype.unbind=function(a,b){for(var c=this,d=0;d<c._userEvents.length;d++){var e=c._userEvents[d];e.type===a&&c._userEvents.splice(d,1)}$(c._userEventsElem).unbind(a+r,b);for(var f=0;f<c.sheets.length;f++){var g=c.sheets[f];g.unbind(a,b)}},f.prototype.unbindAll=function(){var a=this;a._userEvents.length=0,$(a._userEventsElem).unbind(r);for(var b=0;b<a.sheets.length;b++){var c=a.sheets[b];c.unbindAll()}},f.prototype.suspendEvent=function(){this._eventSuspended++;for(var a=0;a<this.sheets.length;a++){var b=this.sheets[a];b.suspendEvent()}},f.prototype.resumeEvent=function(){var a=this;a._eventSuspended--,a._eventSuspended<0&&(a._eventSuspended=0);for(var b=0;b<a.sheets.length;b++){var c=a.sheets[b];c.resumeEvent()}},f.prototype.saveData=function(){var a=this;if(a._host){var b=a._host.id,e=i.getElementById(b+s);if(e!==d&&e!==c){var f=a.getSheetCount(),g=[],h={activeSheetIndex:a.getActiveSheetIndex(),sheetCount:f,tabStripRatio:a.getTabStripRatio(),tabStripVisible:a._tabStripVisible,tabEditable:a._tabEditable,newTabVisible:a._newTabVisible,allowCellOverflow:a.getActiveSheet()?a.getActiveSheet()._allowCellOverflow:!1,theme:a.getActiveSheet().currentTheme().name()};g.push(JSON.stringify(h));for(var j=0;f>j;j++){var k=a.getSheet(j),l="";k.deletedRows&&(l=JSON.stringify(k.deletedRows));var m={};for(var n in k._rowInfos)if("function"!=typeof n){var o=k._rowInfos[n];o&&o.dirty&&(m[n]=o)}var p={};for(n in k._colInfos)if("function"!=typeof n){var q=k._colInfos[n];q&&q.dirty&&(p[n]=q)}var r={name:k._name,ar:k._activeRowIndex,ac:k._activeColIndex,columns:p,rows:m,rowCount:k.getRowCount(),columnCount:k.getColumnCount(),data:k._dataModel.dirtyNodes,deletedRows:l,spans:k._getSpanModel(),rowHeaderAutoText:k.rowHeaderAutoText,colHeaderAutoText:k.colHeaderAutoText,referenceStyle:k.referenceStyle(),gridline:k.gridline,frozenRowCount:k.frozenRowCount,frozenColCount:k.frozenColCount,frozenTrailingRowCount:k._frozenTrailingRowCount,frozenTrailingColCount:k._frozenTrailingColCount};g.push(JSON.stringify(r))}e.value=JSON.stringify(g)}}},f.prototype.doCommand=function(a){this._undoManager.doAction(a)},f.prototype.allowUndo=function(a){var b=this;return 0===arguments.length?b._allowUndo:(b._allowUndo=a,b._undoManager&&(b._undoManager._allowUndo=a),b)},f.prototype.undoManager=function(){var a=this;return a._undoManager||(a._undoManager=new b._UndoManager(a,-1,a.allowUndo())),a._undoManager},f.prototype.canUserDragDrop=function(a){return 0===arguments.length?this._allowDragDrop:(this._allowDragDrop=a,this)},f.prototype.canUserDragFill=function(a){var c=this;if(0===arguments.length)return b.features.fill?c._allowDragFill:!1;if(c._allowDragFill!==a){c._allowDragFill=a;var d=c.getActiveSheet();d&&1===d.getSelections().length&&d._render.repaintSelection(d.getSelections().toArray()[0])}return c},f.prototype.toJSON=function(){var a=this,b=a.getSheetCount(),c={activeSheetIndex:a.getActiveSheetIndex(),sheetCount:b,tabStripRatio:a.getTabStripRatio(),tabStripVisible:a._tabStripVisible,tabEditable:a._tabEditable,newTabVisible:a._newTabVisible,referenceStyle:a.referenceStyle(),useWijmoTheme:a.useWijmoTheme,canUserEditFormula:a._canUserEditFormula,startSheetIndex:a.startSheetIndex(),allowUndo:a._allowUndo,allowUserZoom:a._allowUserZoom,allowUserResize:a._allowUserResize,allowDragDrop:a._allowDragDrop,allowDragFill:a._allowDragFill,allowSheetReorder:a._allowSheetReorder,highlightInvalidData:a._highlightInvalidData,autoFitType:a._autoFitType,showScrollTip:a._showScrollTip,showResizeTip:a._showResizeTip,showDragDropTip:a._showDragDropTip,showDragFillTip:a._showDragFillTip,showHorizontalScrollbar:a._showHorizontalScrollbar,showVerticalScrollbar:a._showVerticalScrollbar,backColor:a._backColor,backgroundImage:a._backgroundImage,backgroundImageLayout:a._backgroundImageLayout,grayAreaBackColor:a._grayAreaBackColor,cutCopyIndicatorVisible:a._cutCopyIndicatorVisible,cutCopyIndicatorBorderColor:a._cutCopyIndicatorBorderColor,useTouchLayout:a._useTouchLayout},d={version:"2.0"};for(var e in c){var f=c[e];a._isDefaultValue(e,f)||(d[e]=f)}for(var g={},h=0;b>h;h++){var i=a.getSheet(h);g[i._name]=i.toJSON()}$.isEmptyObject(g)||(d.sheets=g);var j=[];if(a._namedStyles)for(var e in a._namedStyles)j.push(a._namedStyles[e]);j.length>0&&(d.namedStyles=j);var k=[];if(a._names&&a.calcService)for(var l in a._names)if(a._names.hasOwnProperty(l)){var m=a._names[l],n=m.getName(),o=m.getRow(),p=m.getColumn(),q=m.getExpression(),r=a.calcService.unparse(q,o,p);k.push({name:n,formula:r,row:o,col:p})}return k.length>0&&(d.names=k),d},f.prototype._isDefaultValue=function(a,b){switch(a){case"activeSheetIndex":return b===this._defaultActiveSheetIndex;case"sheetCount":return b===this._defaultSheetCount;case"tabStripRatio":return.5===b;case"tabStripVisible":return b===!0;case"tabEditable":return b===!0;case"newTabVisible":return b===!0;case"referenceStyle":return 0===b;case"useWijmoTheme":return b===!1;case"canUserEditFormula":return b===!0;case"startSheetIndex":return 0===b;case"allowUndo":return b===!0;case"allowUserZoom":return b===!0;case"allowUserResize":return b===!0;case"allowDragDrop":return b===!0;case"allowDragFill":return b===!0;case"allowSheetReorder":return b===!0;case"highlightInvalidData":return b===!1;case"autoFitType":return 0===b;case"showScrollTip":return 0===b;case"showResizeTip":return 0===b;case"showDragDropTip":return b===!0;case"showDragFillTip":return b===!0;case"showHorizontalScrollbar":return b===!0;case"showVerticalScrollbar":return b===!0;case"backColor":return"white"===b;case"backgroundImage":return b===c;case"backgroundImageLayout":return 0===b;case"grayAreaBackColor":return"gray"===b;case"cutCopyIndicatorVisible":return b===!0;case"cutCopyIndicatorBorderColor":return"#217346"===b;case"useTouchLayout":return b===!1;default:return}},f.prototype.fromJSON=function(e){if(e){var f=this;f._suspendSetFocus=!0;var g=f.isPaintSuspended();f.isPaintSuspended(!0),f.suspendEvent();try{b.util.hasCalc()&&(f.calcService=new b.Calc.Service(f)),f._availableSheetIndex=-1,f.clearSheets();var i=e.sheetCount;if(typeof i===h&&(i=f._defaultSheetCount),f.setSheetCount(i),e.referenceStyle!==c&&e.referenceStyle!==d&&f.referenceStyle(e.referenceStyle),f._namedStyles={},e.namedStyles)for(var j=0;j<e.namedStyles.length;j++){var k=e.namedStyles[j],l=new b.Style;if(l.copyFrom(k),typeof k.validator!==h){var m;b.features.dataValidator&&(m=new a.spread.DefaultDataValidator,m.fromJSON(k.validator)),l.validator=m}f._addNamedStyleImp(l,!1)}var n,j=0,o=e.sheets;if(o)for(var p in o)if("string"==typeof p){var q=o[p],r=q.index!==d?q.index:q._index;n=r!=d?f.sheets[r]:f.sheets[j],n.fromJSON(q,!1),j++}var s=e.activeSheetIndex;if(typeof s===h&&(s=f._defaultActiveSheetIndex),f.setActiveSheetIndex(s),typeof e.tabStripRatio!==h&&f.setTabStripRatio(e.tabStripRatio),typeof e.tabStripVisible!==h&&(f._tabStripVisible=e.tabStripVisible),typeof e.tabEditable!==h&&(f._tabEditable=e.tabEditable),typeof e.newTabVisible!==h&&(f._newTabVisible=e.newTabVisible),f.gcSpreadsheet=e.gcSpreadsheet,typeof e.useWijmoTheme!==h&&(f.useWijmoTheme=e.useWijmoTheme),typeof e.canUserEditFormula!==h&&(f._canUserEditFormula=e.canUserEditFormula),typeof e.startSheetIndex!==h&&f.startSheetIndex(e.startSheetIndex),typeof e.allowUndo!==h&&f.allowUndo(e.allowUndo),typeof e.allowUserZoom!==h&&(f._allowUserZoom=e.allowUserZoom),typeof e.allowUserResize!==h&&(f._allowUserResize=e.allowUserResize),typeof e.allowDragDrop!==h&&(f._allowDragDrop=e.allowDragDrop),typeof e.allowDragFill!==h&&(f._allowDragFill=e.allowDragFill),typeof e.allowSheetReorder!==h&&(f._allowSheetReorder=e.allowSheetReorder),typeof e.highlightInvalidData!==h&&(f._highlightInvalidData=e.highlightInvalidData),typeof e.autoFitType!==h&&f.autoFitType(e.autoFitType),typeof e.showResizeTip!==h&&(f._showResizeTip=e.showResizeTip),typeof e.showScrollTip!==h&&(f._showScrollTip=e.showScrollTip),typeof e.showDragDropTip!==h&&(f._showDragDropTip=e.showDragDropTip),typeof e.showDragFillTip!==h&&(f._showDragFillTip=e.showDragFillTip),typeof e.showHorizontalScrollbar!==h&&f.showHorizontalScrollbar(e.showHorizontalScrollbar),typeof e.showVerticalScrollbar!==h&&f.showVerticalScrollbar(e.showVerticalScrollbar),typeof e.backColor!==h&&f.backColor(e.backColor),typeof e.backgroundImage!==h&&f.backgroundImage(e.backgroundImage),typeof e.backgroundImageLayout!==h&&f.backgroundImageLayout(e.backgroundImageLayout),typeof e.grayAreaBackColor!==h&&f.grayAreaBackColor(e.grayAreaBackColor),typeof e.cutCopyIndicatorVisible!==h&&f.cutCopyIndicatorVisible(e.cutCopyIndicatorVisible),typeof e.cutCopyIndicatorBorderColor!==h&&f.cutCopyIndicatorBorderColor(e.cutCopyIndicatorBorderColor),f.useTouchLayout(e.useTouchLayout),f.calcService&&f.calcService.suspend(),f.clearCustomNames(),e.names)for(var t=0;t<e.names.length;t++){var u=e.names[t];f.addCustomName(u.name,u.formula,u.row,u.col)}if(o){j=0;for(var p in o)if("string"==typeof p){var q=o[p],r=q.index!==d?q.index:q._index;n=r!=d?f.sheets[r]:f.sheets[j],n.formulaFromJSON(q),j++}}f.calcService&&(e.noRecalc?f.calcService.resumeWithoutCalc():f.calcService.resume(!0))}finally{f._suspendSetFocus=!1,f.getActiveSheet().setFocus(),f.resumeEvent(),f.isPaintSuspended(g)}}},f.prototype.setTabStripRatio=function(a,c){"undefined"==typeof c&&(c=!1);var d;if(isNaN(d=a))throw b.SR.Exp_InvalidArgument;var e=this,f=$(e._vp).width(),g=e._tab._resizeBarWidth/f;e._tabStripRatio=g>d?g:d>1?1:d,e._tabStripRatioUserSet=0>d?0:d>1?1:d,e._doTabHSResize()},f.prototype.getTabStripRatio=function(){return this._tabStripRatioUserSet},f.prototype._getActualTabStripRatio=function(){return this.showHorizontalScrollbar()?this._tabStripRatio:1},f.prototype._setActualTabStripRatio=function(a){this._tabStripRatio=a},f.prototype.showScrollTip=function(a){return 0===arguments.length?this._showScrollTip:(this._showScrollTip=a,this)},f.prototype.showResizeTip=function(a){return 0===arguments.length?this._showResizeTip:(this._showResizeTip=a,this)},f.prototype.showDragDropTip=function(a){return 0===arguments.length?b.util.hasCalc()?this._showDragDropTip:!1:(this._showDragDropTip=a,this)},f.prototype.showDragFillTip=function(a){return 0===arguments.length?b.features.fill?this._showDragFillTip:!1:(this._showDragFillTip=a,this)},f.prototype.grayAreaBackColor=function(a){if(0===arguments.length)return this._grayAreaBackColor;var b=this,c=this.getActiveSheet();return c?c._bindToAutoRefresh(function(a){return b._grayAreaBackColor=a,b})(a):void(b._grayAreaBackColor=a)},f.prototype.backColor=function(a){if(0===arguments.length)return this._backColor;var b=this,c=this.getActiveSheet();return c?c._bindToAutoRefresh(function(a){return b._backColor=a,b})(a):void(b._backColor=a)},f.prototype.backgroundImage=function(a){var b=this;if(0===arguments.length)return b._backgroundImage;var c=b.getActiveSheet();return c?c._bindToAutoRefresh(function(a){return b._backgroundImage=a,b._paintSpreadBackgroundImage(),b})(a):(b._backgroundImage=a,b)},f.prototype.backgroundImageLayout=function(a){var b=this;return 0===arguments.length?b._backgroundImageLayout:(b._backgroundImageLayout=a,b._paintSpreadBackgroundImage(),b)},f.prototype._findTable=function(a){if(!this.sheets||0===this.sheets.length)return c;for(var b=this.sheets,d=b.length,e=0;d>e;e++){var f=b[e],g=f.findTableByName(a);if(g)return g}return c},f.prototype.addSparklineEx=function(a){var b=this._sparklineExs;a&&b&&(b[a.name()]=a)},f.prototype.getSparklineEx=function(a){var b=this._sparklineExs;return b&&b[a]},f.prototype.removeSparklineEx=function(a){var b=this._sparklineExs;b&&(b[a]=d)},f.prototype.useTouchLayout=function(a){var b=this;return 0===arguments.length?b._useTouchLayout:(b._useTouchLayout=a,b._doResize(),b)},f.prototype._getScrollbarSize=function(){return 18},f.prototype.suspendCalcService=function(a){this.calcService&&this.calcService.suspend(a)},f.prototype.resumeCalcService=function(a){this.calcService&&this.calcService.resume(a)},f}();b.Spread=y;var z=".gcTab",A=".tabNameEditor",B=".spliter",C="mouse",D="down",E="move",F="up",G="out",H="focusin",I="focusout",J="keydown",K=C+E+B,L=C+F+B,M=J+A,N=H+A,O=I+A,P=C+D+z,Q=C+E+z,R=C+F+z,S=C+G+z,T="dblclick"+z,U="canvas",V="2d",W="resizeBar",X="navButton",Y="tab",Z="newTab",_="#FFFFFF",ab="#D8E7FA",bb="#D5E5F9",cb="#B6D2F5",db="#D9E7F9",eb="#688CAF",fb="#92A5C7",gb="black",hb="white",ib=4,jb="tab-tip-span",kb=function(){function a(a){var b=this;b._spread=c,b._activeIndex=0,b._firstTab=0,b._tabLeftPadding=12,b._tabRightPadding=8,b._tabSpace=3,b._activePos=70,b._hoverNavButton=-1,b._hoverTab=-1,b._newTabSize=48,b._firstTabSpace=5,b._font="10pt Arial",b._resizeBarWidth=8,b._tabSizes=[],b._targetTabIndex=-1,b._sourceTabIndex=-1,b._reorderSpeedTimeout=c,b._paintSuspended=!1,b._init(a)}return a.prototype._init=function(a){this._bounds=new b.Rect(0,0,200,20),this.name=a},a.prototype._setHost=function(a){var c=this,d=i.createElement(U);d.setAttribute("id",c.name),c._tabIndicator=c._getTabIndicator(),a.appendChild(c._tabIndicator[0]),a.appendChild(d),d.gcObject=!0,c.canvas&&($(c.canvas).unbind(P).unbind(Q).unbind(R).unbind(S).unbind(T),c._unbindTouchEvents(),c.canvas.parentNode.removeChild(c.canvas)),c.canvas=d,!b.util._isStandardCanvas()&&b.util._isSilverlightCanvas()&&(d.setAttribute("renderMethod","auto"),d.setAttribute("onload",c._test(c))),$(d).bind(P,b.util.createEventHandler(c,c.doMouseDown)).bind(Q,b.util.createEventHandler(c,c.doMouseMove)).bind(R,b.util.createEventHandler(c,c.doMouseUp)).bind(S,b.util.createEventHandler(c,c.doMouseOut)).bind(T,b.util.createEventHandler(c,c.doMouseDbClick)),c._bindTouchEvents(),c.doResize()},a.prototype._unbindTouchEvents=function(){this._touchManager&&this._touchManager.unbindTouchEvents()},a.prototype._bindTouchEvents=function(){if(b.features.touch){var a=this,c=new b.TabStripTouchManager(a.canvas,a,a._spread._touchEventProvider);c.bindTouchEvents(),a._touchManager=c,a._resizeBarWidth=12}},a.prototype._getTabIndicator=function(){return $("<div>").css({position:"absolute","border-style":"solid","border-color":gb,"border-width":ib,display:"none",width:"0","border-bottom":"0","border-left-color":"transparent","border-right-color":"transparent"})},a.prototype._getNavigationButtonWidth=function(){var a=0,b=this._spread;return b&&(a=b.useTouchLayout()?2*b._getScrollbarSize():b._getScrollbarSize()),a},a.prototype._getNavigationButtonHeight=function(){return this._spread?this._spread._getScrollbarSize():0},a.prototype._getTabStartPosition=function(){return 4*this._getNavigationButtonWidth()+2},a.prototype._test=function(a){return a._spread.initPaint(a._spread)},a.prototype.setOwner=function(a){this._spread=a,a&&a._font&&a._font.length>0&&(this._font=a._font)},a.prototype._dispose=function(){var a=this.canvas;a&&($(a).unbind(P).unbind(Q).unbind(R).unbind(T).unbind(S),a.parentNode.removeChild(a))},a.prototype.getBounds=function(){return this._bounds},a.prototype.setBounds=function(a){var b=this._bounds;b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height},a.prototype._clearRepeatDown=function(){this._repeatDown&&(window.clearTimeout(this._repeatDown),this._repeatDown=c)},a.prototype.doNavButtonClick=function(a,b){var c=this;c._clearRepeatDown();var d=c._getVisibleTabs();if(!(d.length<=0)){var e=200;switch(a){case 0:c._navigateToFirst(d);break;case 1:b||(c._repeatDown=window.setTimeout(function(){c.doNavButtonClick(1)},e)),c._navigateToPrevious(d);
break;case 2:b||(c._repeatDown=window.setTimeout(function(){c.doNavButtonClick(2)},e)),c._navigateToNext(d);break;case 3:c._navigateToLast(d);break;default:return}}},a.prototype._getVisibleTabs=function(){var a,b=[];for(a=0;a<this._spread.sheets.length;a++)this._tabVisible(a)&&b.push(a);return b},a.prototype._navigateToFirst=function(a){a.length<=0||this._firstTab!=a[0]&&this._spread.startSheetIndex(a[0])},a.prototype._navigateToPrevious=function(a){if(!(a.length<=0)){var b=this;if(b._firstTab>a[0]){var c=b._getPreVisibleIndex(b._firstTab);-1!==c&&b._spread.startSheetIndex(c)}}},a.prototype._navigateToNext=function(a){if(!(a.length<=0)){var b=this;if(b._firstTab<a[a.length-1]){var c=b._reCalculateFirstTabIndex(a);-1!==c&&b._spread.startSheetIndex(b._getNextVisibleIndex(b._firstTab))}}},a.prototype._navigateToLast=function(a){if(!(a.length<=0)&&this._firstTab<a[a.length-1]){var b=this._reCalculateFirstTabIndex(a);-1!==b&&this._spread.startSheetIndex(b)}},a.prototype._reCalculateFirstTabIndex=function(a){if(a.length<=0)return-1;var b,c,d=this,e=d._bounds.width-d._resizeBarWidth,f=0,g=d._tabSizes,h=d._bounds.height,i=d._getTabStartPosition()+h;d._spread._newTabVisible&&(i+=d._newTabSize,i+=d._tabSpace);var j=d._getVisibleTabIndex(d._firstTab,a);for(-1===j&&(j=0),b=a.length-1;b>=j;b--){c=a[b];var k=g[c];f+=k,b!==a.length-1&&(f+=d._tabSpace);var l=i+f;if(0!==b&&(l+=d._firstTabSpace),l>e){var m;return m=b+1<a.length?a[b+1]:a[a.length-1],d._firstTab<m?m:-1}}return-1},a.prototype._getPreVisibleIndex=function(a){{var b;this._spread.sheets.length}for(b=a-1;b>=0;b--)if(this._tabVisible(b))return b;return-1},a.prototype._getNextVisibleIndex=function(a){var b,c=this._spread.sheets.length;for(b=a+1;c>b;b++)if(this._tabVisible(b))return b;return-1},a.prototype._getVisibleTabIndex=function(a,b){var c;for(c=0;c<=b.length-1;c++)if(a===b[c])return c;return-1},a.prototype._tabVisible=function(a){return this._spread.sheets[a].visible()},a.prototype._hitTest=function(a){var b=this,c=b.getBounds();if(c.x+c.width-b._resizeBarWidth<a&&a<c.x+c.width&&b._spread.showHorizontalScrollbar())return{element:W};var d,e=-1,f=0,g=b._getNavigationButtonWidth();for(d=0;4>d;d++){if(a>=f&&f+g>a){e=d;break}f+=g}if(-1!==e)return{element:X,index:d};f=b._getTabStartPosition();var h=b._getPreVisibleIndex(b._firstTab);if(-1!==h){if(a>f&&a<f+b._firstTabSpace+b._tabSpace)return{element:Y,index:h,position:f};f+=b._firstTabSpace}var i=0;if(b._firstTab>-1)for(d=b._firstTab;d<b._spread.sheets.length&&d<b._tabSizes.length;d++)if(b._spread.sheets[d].visible()){if(i=b._tabSizes[d],a>f&&a<f+i+b._tabSpace)return{element:Y,index:d,position:f};f+=i+b._tabSpace}return b._spread._newTabVisible&&a>f&&a<f+b._newTabSize?{element:Z,position:f}:{element:""}},a.prototype.doSheetTabClick=function(a,c){var d=this,e=b.Events;d._activeIndex=a,d._activePos=c;var f=d._spread.isPaintSuspended();d._spread.isPaintSuspended(!0);var g=d._spread.getActiveSheet(),h=d._spread.getSheet(a);if(h&&h.isEditing()&&h.endEdit(),d._spread._trigger(e.SheetTabClick,{sheet:h,sheetName:h._name,sheetTabIndex:a}),a!==d._spread._activeSheetIndex){var i={oldSheet:g,newSheet:h,cancel:!1};if(d._spread._trigger(e.ActiveSheetChanging,i),i&&i.cancel===!1){d._spread.setActiveSheetIndex(a),this._spread._trigger(e.ActiveSheetChanged,{oldSheet:g,newSheet:h});var j=d._getNextVisibleIndex(d._firstTab);d._activeIndex>d._firstTab&&d._activePos+d._tabSizes[d._activeIndex]>d.getBounds().width-d._resizeBarWidth&&-1!=j&&(d._firstTab=j)}}d._activeIndex<d._firstTab&&(d._firstTab=d._getPreVisibleIndex(d._firstTab)),d._spread.isPaintSuspended(f),d.repaint()},a.prototype.doNewTabClick=function(a){var d=this,e=b.Events,f=d._spread,g=f.getActiveSheet();f._trigger(e.SheetTabClick,{sheet:c,sheetName:c,sheetTabIndex:-1});var h=f.sheets.length,i=f._createSheet(f._getDefaultSheetName(h));f.addSheet(h,i),d._activeIndex=h,d._activePos=a;var j={oldSheet:g,newSheet:i,cancel:!1};if(f._trigger(e.ActiveSheetChanging,j),j&&j.cancel===!1){for(f.setActiveSheetIndex(h),f._trigger(e.ActiveSheetChanged,{oldSheet:g,newSheet:i});d._activeIndex>d._firstTab&&d._activePos+d._tabSizes[d._activeIndex]+d._newTabSize>d.getBounds().width-d._resizeBarWidth;)f.sheets[d._firstTab].visible()&&(d._activePos-=d._tabSizes[d._firstTab]),d._firstTab++;d.repaint()}},a.prototype.doMouseDown=function(a){var d=b.util.device(),e=d.ipad||d.iphone;if(!e){var f=this;if(f._touchManager&&f._touchManager.preProcessMouseDown(a))return b.util.cancelDefault(a),!1;var g=$(f._getCanvas()).offset(),h=a.pageX-g.left,i=a.pageY-g.top,j=f._spread.getActiveSheet();f._tabNameEditor&&f.endSheetTabEditing(j,!1);{var k=f._hitTest(h,i);b.Events}if(0===a.button){k.element===W?(f.resizeTab=!0,f.activeX=a.pageX,f.handleDocumentMouseMove()):k.element===X?f.doNavButtonClick(k.index):k.element===Y?(f.doSheetTabClick(k.index,k.position),f._initTabReorder(k)):k.element===Z&&f.doNewTabClick(k.position),j=f._spread.getActiveSheet();var l=j&&j._eventHandler;if(l&&!j.isEditing())try{l._tabStripHitTestResult={left:a.pageX,top:a.pageY},j.setFocus()}finally{l._tabStripHitTestResult=c}}return f._isMouseDownInTab=!0,!1}},a.prototype._initTabReorder=function(a){var b=this;this._spread._allowSheetReorder?(b._sourceTabIndex=a.index,b._reorderSheet=!0,b._tabTip=b._getTabTip(b._sourceTabIndex),b.handleDocumentMouseMove()):b._reorderSheet=!1},a.prototype._getTabTip=function(a){var b=this._spread.sheets,c=b.length;if(!(a>=c||0>a)){var d=b[a]._name;d||(d="sheet");var e=$("<span>").text(d).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"});return e.addClass(this._spread.useWijmoTheme?"ui-widget-header":"tab-tip-span"),e}},a.prototype.doMouseMove=function(a){var c=b.util.device(),d=c.ipad||c.iphone;if(!d){var e=this;if(e._touchManager&&e._touchManager.preProcessMouseMove(a))return b.util.cancelDefault(a),!1;var f="default",g="w-resize";if(e.resizeTab){e.canvas.style.cursor=g;var h=a.pageX-e.activeX,i=e._spread._vp.clientWidth,j=e._spread;j.setTabStripRatio(j._getActualTabStripRatio()+h/i,!0);var k=e._resizeBarWidth/i,l=1;j._getActualTabStripRatio()<k?(j.setTabStripRatio(k,!0),e.activeX=e._resizeBarWidth):j._getActualTabStripRatio()>=l?(j.setTabStripRatio(l,!0),e.activeX=i):e.activeX=a.pageX}else if(e._reorderSheet)e._showTabTip(a.pageX,a.pageY),e._setTabIndicator(a);else{e._hoverNavButton=-1,e._hoverTab=-1;var m=$(e._getCanvas()).offset(),n=a.pageX-m.left,o=a.pageY-m.top,p=e._hitTest(n,o);if(""===p.element)return e.canvas.style.cursor=f,e.repaint(),!1;p.element===W?e.canvas.style.cursor=g:(e.canvas.style.cursor=f,p.element===X?e._hoverNavButton=p.index:p.element===Y?e._hoverTab=p.index:p.element===Z&&(e._hoverTab=-2)),e.repaint()}return!1}},a.prototype._showTabTip=function(a,b){var c=this;c._tabTip&&0===$("."+jb).length&&(c._tabTip.appendTo(i.body),c._tabTip.hide());var d=c._tabTip.width(),e=c._tabTip.height();c._tabTip.css({left:a-d/2,top:b-e/2}),c._tabTip.show()},a.prototype._setTabIndicator=function(a){var b=this,d=$(b._getCanvas()),e=d.position(),f=d.offset(),g=a.pageX-f.left,i=a.pageY-f.top,j=b._hitTest(g,i),k=b.getBounds(),l=b._getTabStartPosition(),m=b._spread.sheets.length,n=100;g>k.x+k.width-b._resizeBarWidth?b._reorderSpeedTimeout===c&&b._targetTabIndex<m&&(b._reorderSpeedTimeout=setInterval(function(){b._navigateToNext(b._getVisibleTabs()),b._targetTabIndex===m?(b._clearSpeedTimeout(),b._tabIndicator.css({left:e.left+b._getLastTabPos()-ib,top:e.top-ib}),b._tabIndicator.show()):(b._targetTabIndex++,b._tabIndicator.hide())},n)):l>g?b._reorderSpeedTimeout===c&&b._targetTabIndex>0&&(b._reorderSpeedTimeout=setInterval(function(){b._navigateToPrevious(b._getVisibleTabs()),0===b._targetTabIndex?(b._clearSpeedTimeout(),b._tabIndicator.css({left:e.left+l-ib,top:e.top-ib}),b._tabIndicator.show()):(b._targetTabIndex--,b._tabIndicator.hide())},n)):(b._clearSpeedTimeout(),(j.element===Y||j.element===Z)&&(b._targetTabIndex=typeof j.index!==h?j.index:b._spread.sheets.length,b._tabIndicator.css({left:e.left+j.position-ib,top:e.top-ib}),b._tabIndicator.show()))},a.prototype._getLastTabPos=function(){for(var a=this,b=a._tabSizes,c=a._getVisibleTabs(),d=a._getVisibleTabIndex(a._firstTab,c),e=0,f=(a._bounds.height,a._getTabStartPosition()+a._firstTabSpace),g=d;g<c.length;g++){e=c[g];var h=b[e];f+=h,f+=a._tabSpace}return f},a.prototype.doMouseUp=function(a){var c=b.util.device(),d=c.ipad||c.iphone;if(!d){var e=this;return e._touchManager&&e._touchManager.preProcessMouseUp(a)?(b.util.cancelDefault(a),!1):(e.resizeTab&&(e.resizeTab=!1,e._spread._doTabHSResize()),e._clearSpeedTimeout(),e._reorderSheet&&(e._reorderSheet=!1,e._tabTip.remove(),e._reorderTab(),e._tabIndicator.hide()),e._clearRepeatDown(),e.unhandleDocumentMouseMove(),e._isMouseDownInTab?(e._isMouseDownInTab=!1,!1):!0)}},a.prototype._reorderTab=function(){var a=this,b=a._targetTabIndex,c=a._sourceTabIndex,d=-1;if(-1!==b&&-1!==c&&c!==b&&c!==b-1&&a._tabIndicator.is(":visible")){var e=a._spread.sheets,f=e[c];if(c>b){for(var g=c;g>b;g--)e[g]=e[g-1];e[b]=f,d=b}else if(b-1>c){for(var g=c;b-1>g;g++)e[g]=e[g+1];e[b-1]=f,d=b-1}a._spread._activeSheetIndex=d,a.doResize()}},a.prototype._clearSpeedTimeout=function(){this._reorderSpeedTimeout!==c&&(window.clearInterval(this._reorderSpeedTimeout),this._reorderSpeedTimeout=c)},a.prototype.doMouseOut=function(){var a=b.util.device(),c=a.ipad||a.iphone;if(!c){var d=this;d._clearRepeatDown();var e=d._hoverNavButton;d._hoverNavButton=-1;var f=d._hoverTab;return d._hoverTab=-1,(d._hoverNavButton!==e||d._hoverTab!==f)&&d.repaint(),!1}},a.prototype._doMouseDbClickImp=function(a,d){var e=this;if(!e._spread._tabEditable)return!1;var f=e._hitTest(a,d);if(f.element===Y){var g=window.gcGlobal.activeElement;g&&g.endEdit&&g.endEdit(),window.gcGlobal.activeElement=c;var h=e._activeIndex,j=e._spread.sheets[h],k=e._tabSizes[h],m=$(e._getCanvas()).offset();e._spread._trigger(b.Events.SheetTabDoubleClick,{sheet:j,sheetName:j._name,sheetTabIndex:h});var p=i.createElement(l),r=p.style;p.type="text",p.value=j._name,p.setAttribute("contentEditable","true"),p.setAttribute("autocomplete","off"),r.position="absolute",r.margin=o,r.padding=o,r.margin=o,r.left=m.left+e._activePos+e._tabLeftPadding+n,r.top=m.top+1+n,r.width=k-e._tabLeftPadding-e._tabRightPadding+2+n,r.backgroundColor=hb,r.borderWidth="0px",r.outline=q,i.body.insertBefore(p,c),e._tabNameEditor=p,$(p).addClass("sheetTabEditor").bind(M,function(a){return 13===a.keyCode?(e.endSheetTabEditing(j,!1),!1):27===a.keyCode?(e.endSheetTabEditing(j,!0),!1):void 0}).bind(N,function(){p.selectionStart=0,p.selectionEnd=p.value.length}).bind(O,function(){e.endSheetTabEditing(j,!1)}),p.focus()}return!1},a.prototype.doMouseDbClick=function(a){var c=b.util.device(),d=c.ipad||c.iphone;if(!d){var e=$(this._getCanvas()).offset(),f=a.pageX-e.left,g=a.pageY-e.top;return this._doMouseDbClickImp(f,g)}},a.prototype._isValidSheetName=function(a){if(a===d||a===c||""===a)return!1;for(var b=this._spread.sheets.length,e=0;b>e;e++){var f=this._spread.sheets[e];if(a===f._name)return!1}return!0},a.prototype.endSheetTabEditing=function(a,e){var f=this;if(f._tabNameEditor){var g=f._tabNameEditor.value;if(e===!1&&g!==d&&g!==c&&""!==g&&f._isValidSheetName(g)){var h={sheet:a,oldValue:a.getName(),newValue:g,cancel:!1};if(a._trigger(b.Events.SheetNameChanging,h),h&&h.cancel===!1){var i=new b.UndoRedo.SheetRenameUndoAction(a,g);a._doCommand(i);var j={sheet:a,oldValue:a.getName(),newValue:g};a._trigger(b.Events.SheetNameChanged,j)}}$(f._tabNameEditor).unbind(M).unbind(N).unbind(O),f._tabNameEditor.parentNode.removeChild(f._tabNameEditor),delete f._tabNameEditor}},a.prototype.handleDocumentMouseMove=function(){var a=this;if(!a._isCapture){$(i).bind(K,function(b){a.doMouseMove(b)}).bind(L,function(b){a.doMouseUp(b)});var b=a._spread.getActiveSheet();b&&(b._continueMouseUpBubble=!0),a._isCapture=!0}},a.prototype.unhandleDocumentMouseMove=function(){if(this._isCapture){this._isCapture=!1,$(i).unbind(K).unbind(L);var a=this._spread.getActiveSheet();a&&delete a._continueMouseUpBubble}},a.prototype.isPaintSuspended=function(a){var b=this;return 0===arguments.length?b._paintSuspended:(b._paintSuspended!==a&&(b._paintSuspended=a,a||b.repaint()),b)},a.prototype.repaint=function(a){var c=this._getCanvas();if(c){if(!c.getContext&&b.util._isSilverlightCanvas()&&!c.getContext)return;c.getContext||typeof window.FlashCanvas===h||window.FlashCanvas.initElement(c),c.getContext&&this.paint(c.getContext(V),a)}},a.prototype.doResize=function(){var a=this,b=a._getCanvas();if(b&&b.parentNode){var c=$(b.parentNode);0!==c.width()&&0!==c.height()&&(b.style.display=q,b.width=f(c.width(),0),b.height=f(c.height(),0),b.style.display="",a._bounds.width=b.clientWidth||b.width,a._bounds.height=b.clientHeight||b.height,a.repaint())}},a.prototype.paint=function(a,d){var e=this;if(!e._paintSuspended){var j=e.getBounds();if(d){if(d.x>=j.x+j.width)return;if(d.y>=j.y+j.height)return;if(d.x+d.width>j.width&&(d.width=j.width-d.x,d.width<=0))return;if(d.y+d.height>j.height&&(d.height=j.height-d.y,d.height<=0))return;if(d.width<=0||d.height<=0)return}var k,l=b.util._useDoubleBuffer();if(l){var m=e.buffer;if(m&&m.width===j.width&&m.height===j.height||(e.buffer=m=i.createElement(U),m.width=j.width,m.height=j.height),!m.getContext)if(b.util._isSilverlightCanvas()){if(!m.getContext)return}else if(typeof window.FlashCanvas!==h){var n=e._getCanvas();if(window.FlashCanvas.initElement(n),!m.getContext)return}}if(k=l?e.buffer.getContext(V):a,k.clearRect(0,0,j.width,j.height),k.translate(-j.x,-j.y),e.paintTabs(k,d),k.translate(j.x,j.y),l){var o=j.x>=0?0:-j.x,p=j.y>=0?0:-j.y;d&&(o=j.x+d.x,p=j.y+d.y,j=new b.Rect(j.x+d.x,j.y+d.y,d.width,d.height)),k=e.buffer.getContext(V);var q=c;try{if(d)q=k.getImageData(d.x,d.y,d.width,d.height);else{var r=e._getCanvas();q=r?k.getImageData(o,p,g(j.width-o,f(r.width-j.x,3)),g(j.height-p,f(r.height-j.y,3))):k.getImageData(o,p,f(j.width-o,0),f(j.height-p,0))}}catch(s){return}o=j.x>=0?j.x:0,p=j.y>=0?j.y:0,q&&j.width>0&&j.height>0&&a.putImageData(q,o,p)}}},a.prototype._getCanvas=function(){var a=this.canvas;return a&&!a.getContext&&a.firstChild&&(a.getContext=a.firstChild.getContext),a},a.prototype._getTabStripBackColor=function(a,b){var d,e=c;return this._spread.useWijmoTheme?(e=a.createLinearGradient(b.x,b.y,b.width,b.height),d=window.gcGlobal.getWijmoThemeStyle(0),e.addColorStop(0,"#DDDDDD"),e.addColorStop(1,d.backgroundColor)):(e=a.createLinearGradient(b.x+.7*b.height,b.y+0,.7*b.height,b.height),e.addColorStop(0,"#7FA1D1"),e.addColorStop(.3,"#A1BADD"),e.addColorStop(1,"#9AB5DB")),e},a.prototype.paintTabs=function(a,d){var e=this,f=e._spread;if(a&&f){var g=e.getBounds();a.save(),a.font=e._font,d?a.rect(d.x,d.y,d.width,d.height):a.rect(g.x,g.y,g.width,g.height),a.clip(),a.beginPath(),a.fillStyle=e._getTabStripBackColor(a,g),a.fillRect(g.x,g.y,g.width,g.height);var h=60,i=e._getTabStartPosition(),j=i;e._tabSizes=[];var k,l=f.sheets;for(k=0;k<l.length;k++)h=a.measureText(l[k]._name).width+e._tabRightPadding+e._tabLeftPadding,e._tabSizes.push(h);var m=[],n=e._firstTab;if(n>0&&e._getPreVisibleIndex(n)>=0&&(j+=e._firstTabSpace),n>=0)for(k=n;k<l.length;k++){var o=l[k].visible();if(h=e._tabSizes[k],j>g.x+g.width)break;m.push({i:k,x:j,w:h,t:l[k]._name,visible:o}),o&&(j+=h+e._tabSpace)}var p=e._hoverTab;f._newTabVisible&&(e._newTabSize=a.measureText(b.SR.NewTab).width+e._tabLeftPadding,e.drawTab(a,j,0,e._newTabSize,g.height,5,!1,-2===p,b.SR.NewTab)),e._activeIndex=f.getActiveSheetIndex();var q=e._activeIndex;if(l.length>0){for(k=m.length-1;k>=0;k--){var r=m[k];r.i!==q&&r.visible&&e.drawTab(a,r.x,0,r.w,g.height,5,!1,r.i===p,r.t)}if(n>0&&e._getPreVisibleIndex(n)>=0){var s=n-1;h=e._tabSizes[s],e.drawTab(a,i+e._firstTabSpace-h-e._tabSpace,0,h,g.height,5,q===s,p===s,"")}var t=m[q-n];q>=n&&q<l.length&&t&&t.visible&&e.drawTab(a,t.x,0,t.w,g.height,5,!0,!1,t.t)}a.fillStyle=fb,a.fillRect(g.x,g.y,i-1,g.height);var u=5,v=e._getNavigationButtonWidth(),w=e._getNavigationButtonHeight(),x=v/2,y=w/2,z=e._hoverNavButton;e.drawNavButton(a,x,y,x+u,y+u,x+u,y-u,!0,x-u,0===z),x+=v,e.drawNavButton(a,x,y,x+u,y+u,x+u,y-u,!0,c,1===z),x+=v,e.drawNavButton(a,x,y,x-u,y+u,x-u,y-u,!1,c,2===z),x+=v,e.drawNavButton(a,x,y,x-u,y+u,x-u,y-u,!1,x+4,3===z);var A=e._resizeBarWidth;if(f.useWijmoTheme){var B=window.gcGlobal.getWijmoThemeStyle,C=B(4),D=B(0);f.showHorizontalScrollbar()&&(x=g.x+g.width-A,a.fillStyle=D.backgroundColor,a.fillRect(x,g.y,A,g.height),a.fillStyle=C.backgroundColor,a.fillRect(x+1,g.y+1,A-2,g.height-2),a.fillStyle=C.color,a.fillRect(x+A/2-1,g.y+4,2,g.height-8))}else f.showHorizontalScrollbar()&&(x=g.x+g.width-A,a.fillStyle=eb,a.fillRect(x,g.y,A,g.height),a.fillStyle="#D7E6F7",a.fillRect(x+1,g.y+1,A-2,g.height-2),a.fillStyle=hb,a.fillRect(x+A/2-1,g.y+4,4,g.height-8),a.fillStyle=eb,a.fillRect(x+A/2-1,g.y+4,1,g.height-8));a.beginPath(),a.restore()}},a.prototype.drawNavButton=function(a,b,e,h,i,j,k,l,m,n){a.save();var o=c,p=c,q=this,r=q.getBounds(),s=q._getNavigationButtonWidth();if(q._spread.useWijmoTheme){var t=window.gcGlobal.getWijmoThemeStyle;o=t(4),p=t(0),n?(a.fillStyle=o.backgroundColor,a.fillRect(b-s/2+2,r.y+2,s-4,r.height-4)):(a.fillStyle=p.backgroundColor,a.fillRect(b-s/2,r.y+1,s,r.height-2))}else if(n)a.fillStyle="orange",a.fillRect(b-s/2+1,r.y+1,s-2,r.height-2),a.fillStyle="lightyellow",a.fillRect(b-s/2+2,r.y+2,s-4,r.height-4);else{var u=a.createLinearGradient(r.x+.7*r.height,r.y+0,.7*r.height,r.height);u.addColorStop(0,_),u.addColorStop(.1,ab),u.addColorStop(.45,bb),u.addColorStop(.45,cb),u.addColorStop(.9,db),u.addColorStop(1,_),a.fillStyle=u,a.fillRect(b-s/2,r.y+1,s,r.height-2)}a.fillStyle=q._spread.useWijmoTheme?n?o.color:p.color:gb,m!==d&&m!==c&&a.fillRect(m,g(i,k),1,f(i,k)-g(i,k)),l?(b-=2,h-=2,j-=2):(b+=2,h+=2,j+=2),a.beginPath(),a.moveTo(b,e),a.lineTo(h,i),a.lineTo(j,k),a.lineTo(b,e),a.fill(),a.restore()},a.prototype._getTabBackColor=function(a,c,d,e,f){var g=this,h=g.getBounds(),i=a.createLinearGradient(h.x+.7*h.height,h.y+0,.7*h.height,h.height),j=g._spread.getSheetFromName(e);""===e&&g._firstTab>0&&(j=g._spread.getSheet(g._firstTab-1));var k=!1;if(f)i.addColorStop(0,f.backgroundColor),k=!0;else if(j&&j._sheetTabColor){var l="rgba(0, 0, 0, 0)";a.fillStyle=l,a.fillStyle=b._ThemeContext.getColor(j,j._sheetTabColor);var m=a.fillStyle;m===l?k=!1:(d||c?(i.addColorStop(0,_),i.addColorStop(.45,"#F1F6FD"),i.addColorStop(.9,m),i.addColorStop(1,_)):i=m,k=!0)}return k||(d||c?(i.addColorStop(0,_),i.addColorStop(.6,"#F1F6FD"),i.addColorStop(.9,"#BCD5F6"),i.addColorStop(1,_)):(i.addColorStop(0,ab),i.addColorStop(.45,bb),i.addColorStop(.6,cb),i.addColorStop(1,db))),i},a.prototype._getTabForeColor=function(a,c){var d=gb;if(a)d=a.color;else if(c){var e=b._Color.parse(c);e&&e.getBrightness()<127.5&&(d=hb)}return d},a.prototype.drawTab=function(a,b,d,e,f,g,h,i,j){a.save(),a.beginPath(),a.moveTo(b,d),a.lineTo(b,d+f-g),a.arcTo(b,d+f,b+e,d+f,g),a.lineTo(b+e,d+f),a.lineTo(b+e+f,d),h||a.lineTo(b,d);var k=this,l=c;if(k._spread.useWijmoTheme){var m=0;(h||i)&&(m=4),l=window.gcGlobal.getWijmoThemeStyle(m)}var n=k._getTabBackColor(a,h,i,j,l);a.fillStyle=n,a.fill(),a.strokeStyle=fb,a.stroke(),a.textBaseline=p;var o;"string"==typeof n&&(o=n),a.fillStyle=k._getTabForeColor(l,o);var q=k._tabLeftPadding;a.textBaseline="middle",a.fillText(j,b+q,d+f/2),a.restore()},a}()}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){function c(a,c){if(a){var g=new b.Spread(a.id,c.sheetCount);typeof c.name===d&&c.name.length>0&&(g.name=c.name),typeof c.font===d&&c.font.length>0&&(g._font=c.font),typeof c.allowUserZoom===e&&(g._allowUserZoom=c.allowUserZoom),typeof c.allowUserResize===e&&(g._allowUserResize=c.allowUserResize),typeof c.tabStripVisible===e&&(g._tabStripVisible=c.tabStripVisible),typeof c.tabEditable===e&&(g._tabEditable=c.tabEditable),typeof c.newTabVisible===e&&(g._newTabVisible=c.newTabVisible),typeof c.useWijmoTheme===e&&(g.useWijmoTheme=c.useWijmoTheme),typeof c.tabStripRatio===f&&(g._tabStripRatio=c.tabStripRatio),typeof c.activeSheetIndex===f&&(g._activeSheetIndex=c.activeSheetIndex);var h=b.util._isStandardCanvas(),i=b.util._isSilverlightCanvas();if(h&&g._suspendInvalidate(),!h&&i?g._slSetHost(a):g._setHost(a),c.sheets&&c.sheets.length>0){var j;if(g.getSheetCount()<c.sheets.length)for(var k=g.getSheetCount();k<c.sheets.length;)j=g._createSheet(g._getDefaultSheetName(k)),g.addSheet(k,j),k=g.getSheetCount();for(var l=0;l<c.sheets.length;l++)j=g.getSheet(l),j.applyOptions(c.sheets[l])}if(h){var m=g._resumeInvalidate();m||(g.invalidateLayout(),g.repaint())}else i&&window.slcanvas&&window.slcanvas.autoLoad&&window.slcanvas.autoLoad()}}b.feature("core.spread_ui",["core.migrate","core.common","core.spread"]);var d="string",e="boolean",f="number",g=jQuery,h=function(){function a(){var a=this;a.sheetCount=1,a.name="",a.font="10pt Arial",a.allowUserZoom=!0,a.allowUserResize=!0,a.tabStripVisible=!0,a.tabEditable=!0,a.newTabVisible=!0,a.useWijmoTheme=!1,a.tabStripRatio=.5,a.activeSheetIndex=0,a.sheets=[]}return a}();b.WijspreadOptions=h;var i=new h;if(g.ui&&g.widget)g.widget("wijmo.wijspread",{_init:function(){var a=this.element.context;c(a,this.options)},spread:function(){return this.element.data("spread")},destroy:function(){var a=this.spread();a&&(g(window).unbind("resize.gcSpread",a._resizeHandler),a._dispose())},refresh:function(){var a=this.spread();a&&(a._doResize(),a.repaint())},repaint:function(){var a=this.spread();a&&a.repaint()},options:i});else{var j={init:function(a){a=g.extend(!0,i,a);var b=this.get(0);c(b,a)},spread:function(){return this.data("spread")},destroy:function(){var a=this.data("spread");a&&(g(window).unbind("resize.gcSpread",a._resizeHandler),a._dispose())},refresh:function(){var a=this.data("spread");a&&(a._doResize(),a.repaint())},repaint:function(){var a=this.data("spread");a&&a.repaint()}};g.fn.wijspread=function(a){return j[a]?j[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void 0:j.init.apply(this,arguments)}}g.wijmo.wijspread=a.spread;var k=window.ko;k&&(k.wijmo=k.wijmo||{},k.wijmo.wijspreadBinding={init:function(a,b){g("#"+a.id).wijspread(b())},update:function(){}},k.bindingHandlers.wijspread=k.wijmo.wijspreadBinding)}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(c){!function(d){function e(a,b,c,d,e){return(c===bb||c===ab)&&(c=0),!e&&b instanceof pb?a.call(b):b instanceof vb?a.call(b,c):d}function f(a,b){return a!==bb&&a!==ab||b!==bb&&b!==ab?(a===bb||a===ab)&&b!==bb&&b!==ab||a!==bb&&a!==ab&&(b===bb||b===ab)?!1:a.toLowerCase()===b.toLowerCase():!0}function g(a,b){var c=this,d={row:c.row,column:c.column,rowCount:1,columnCount:1};return c.rowRelative&&(d.row+=a,d.row=d.row>=Tb.maxRowCount?d.row%Tb.maxRowCount:d.row),c.columnRelative&&(d.column+=b,d.column=d.column>=Tb.maxColumnCount?d.column%Tb.maxColumnCount:d.column),d}function h(a,b){var c,d,e,f,g={row:-1,column:-1,rowCount:-1,columnCount:-1},h=this;return h.isFullRow?(g.column=-1,g.columnCount=-1):(h.startColumnRelative?(e=h.startColumn+b,e=e>=Tb.maxColumnCount?e%Tb.maxColumnCount:e):e=h.startColumn,h.endColumnRelative?(f=h.endColumn+b,f=f>=Tb.maxColumnCount?f%Tb.maxColumnCount:f):f=h.endColumn,g.column=f>=e?e:f,g.columnCount=eb(f-e)+1),h.isFullColumn?(g.row=-1,g.rowCount=-1):(h.startRowRelative?(c=h.startRow+a,c=c>=Tb.maxRowCount?c%Tb.maxRowCount:c):c=h.startRow,h.endRowRelative?(d=h.endRow+a,d=d>=Tb.maxRowCount?d%Tb.maxRowCount:d):d=h.endRow,g.row=d>=c?c:d,g.rowCount=eb(d-c)+1),g}function i(a){return 255>=a}function j(a){var b=a.charCodeAt(0);return b>=48&&57>=b}function k(a){var b=a.charCodeAt(0);return b|=32,b>=96&&122>=b}function l(a){var b=a.charCodeAt(0);return 57>=b?b>=48:(b|=32,b>=96&&122>=b)}function m(a){var b=a.charCodeAt(0);return i(b)?Ob[b]===Nb.MathSymbol||Ob[b]===Nb.CurrencySymbol||Ob[b]===Nb.ModifierSymbol||Ob[b]===Nb.OtherSymbol:!1}function n(a){var b=a.charCodeAt(0);return b>=48&&57>=b}function o(a,b,c){for(var d=a.length,e=Mb.None,f=b;d>f;f++){var g=a.charAt(f);if(j(g))e===Mb.None?e=Mb.Int:e===Mb.Dot?e=Mb.Decimal:e===Mb.Sign?e=Mb.Int:(e===Mb.Exponent||e===Mb.SignExponent)&&(e=Mb.ScientificNotation);else if(g===c)if(e===Mb.Int)e=Mb.Decimal;else{if(e!==Mb.None&&e!==Mb.Sign)return{result:!1};e=Mb.Dot}else if("+"===g||"-"===g)if(e===Mb.None)e=Mb.Sign;else{if(e!==Mb.Exponent)return{result:!0,endIndex:f-1};e=Mb.SignExponent}else if("E"===g||"e"===g){if(e!==Mb.Int&&e!==Mb.Decimal)return{result:!1};e=Mb.Exponent}else if(e===Mb.Int||e===Mb.Decimal||e===Mb.ScientificNotation)return{result:!0,endIndex:f-1}}return e===Mb.Int||e===Mb.Decimal||e===Mb.ScientificNotation?{result:!0,endIndex:d-1}:{result:!1}}function p(a,b,d,e){for(var f=a.length,g=d===e?0:1,h="",i=b+1;f>i;i++){var j=a.charAt(i);if(j===d&&g++,j===e)if(g--,d===e&&f>i+2&&a.charAt(i+1)===d)h+=d,i++;else{if(0===g)return{result:h,endIndex:i};h+=j}else h+=j}throw c.SR.Exp_NoSyntax+e+c.SR.Exp_MatchSyntax+d+c.SR.SingleQuotesFullStop}function q(a,b,d,e,f){for(var g=a.length,h=0,i="",j=b;g>j;j++){var k=a.charAt(j);if(k===f&&(i+=k,j++,k=a.charAt(j)),k===d)i+=k,h++;else if(k===e){if(h--,0==h)return{result:i,endIndex:j};i+=k}else i+=k}throw c.SR.Exp_NoSyntax+e+c.SR.Exp_MatchSyntax+d+c.SR.SingleQuotesFullStop}function r(a,b){for(var d=a.length,e=d-b,f=0;f<Y.length;f++){var g=Y[f],h=g.length;if(!(b+h>d)){var i=a.slice(b,b+h);if(e>=h&&(g===i||g===i.toUpperCase()))return{result:g,endIndex:b+h-1}}}throw c.SR.SingleQuote+a.slice(b)+c.SR.Exp_IsValid}function s(a){return"^"===a||":"===a?1:"*"===a||"/"===a||" "===a?2:"+"===a||"-"===a||","===a?3:"&"===a?4:5}function t(a){if(11===a.subType)return Fb.range;if(10===a.subType)return Fb.union;if(9===a.subType)return Fb.intersection;var b=a.value;return"^"===b?Fb.exponent:"*"===b?Fb.multiply:"/"===b?Fb.divide:"+"===b?Fb.add:"-"===b?Fb.subtract:"&"===b?Fb.concatenate:"<"===b?Fb.lessThan:"="===b?Fb.equal:">"===b?Fb.greaterThan:">="===b?Fb.greaterThanOrEqual:"<="===b?Fb.lessThanOrEqual:"<>"===b?Fb.notEqual:":"===b||"!"===b?Fb.range:" "===b||","===b?Fb.intersection:Fb.add}function u(a,b,c){return a&&a.hasOwnProperty(b)?a[b]:c}function v(a,b){var c=b+1;return 0>a?a%c+c:a>b?a%c:a}function w(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function x(a,b,c){var d=a[b];if(d)for(var e=0;e<d.length;e++)if(d[e]===c)return void d.splice(e,1)}function y(a,b,c,d,e){return(-1===a.row||-1===b||a.row<b+d&&b<a.row+a.rowCount)&&(-1===a.column||-1===c||a.column<c+e&&c<a.column+a.columnCount)}function z(a,b,c){return(-1===a.row||a.row<=b&&b<a.row+a.rowCount)&&(-1===a.column||a.column<=c&&c<a.column+a.columnCount)}function A(a,b){for(var c=0;c<b.length;c++)if(a.hasOwnProperty(b[c])&&a[b[c]].length>0)return!0;return!1}function B(a,b){var c=db(a.row,b.row),d=db(a.column,b.column),e=cb(a.row+a.rowCount,b.row+b.rowCount),f=cb(a.column+a.columnCount,b.column+b.columnCount);return c>=e||d>=f?ab:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:B}}function C(a,b,c,d){return-1===a&&d>127||-1===b&&c>127||c*d>127}function D(a,b,c,e,f){var g=new d.Parser,h=new Sb(!!f,c,e),i=g.parse(b,h);return d.evaluateExpression(a,i,c,e)}function E(a,b,c,d){var e=a.getCalcService();c===bb&&(c=a.getActiveRowIndex()),d===bb&&(d=a.getActiveColumnIndex());var f=a._getSheetSource(),g=e.evaluateParsedFormula(f,b,c,d,!1,!0);return g}function F(a,b,c,d){var e=a.row,f=a.col,g=a.row+a.rowCount-1,h=a.col+a.colCount-1,i=!1,j=!1,k=!1,l=!1;arguments.length>=4&&(i=0!==(1&d),j=0!==(4&d),k=0!==(2&d),l=0!==(8&d),e-=i?b:0,g-=j?b:0,f-=k?c:0,h-=l?c:0);var m;return a.row<0&&a.col<0?m=new Jb.RangeExpression:a.row<0?(m=new Jb.RangeExpression,m.initBand(f,h,k,l,!1)):a.col<0?(m=new Jb.RangeExpression,m.initBand(e,g,i,j,!0)):m=1===a.rowCount&&1===a.colCount?new Jb.CellExpression(e,f,i,k):new Jb.RangeExpression(e,f,g,h,i,k,j,l),m}function G(a,b,c,e,f){var g=d.rangeToExpression(a,b,c,e),h=new d.ParserContext(!!f,b,c),i=new d.Parser;return i.unparse(g,h)}function H(a,b,e,f){if(!a)return null;b=b?b:0,e=e?e:0;var g=new d.ParserContext(!!f,b,e),h=new d.Parser,i=h.parse(a,g);if(i&&i.getRange){var j=i.getRange(b,e);return new c.Range(j.row,j.column,j.rowCount,j.columnCount)}return null}function I(a,b,c,e,f){var g="",h=new d.Parser,i=new d.ParserContext(!!f,b,c);a.length>1&&(g="(");for(var j=0;j<a.length;j++){var k=d.rangeToExpression(a[j],b,c,e),l=h.unparse(k,i);j>0?g+=", "+l:g=l}return a.length>1&&(g+=")"),g}c.feature("calc.common",["core.migrate","core.stringResource","core.common","core.globalize"]);var J="undefined",K="number",L="string",M="boolean",N="TRUE",O="FALSE",P="ARRAY",Q="ARRAYROW",R="#NULL!",S="#DIV/0!",T="#VALUE!",U="#REF!",V="#NAME?",W="#N/A",X="#NUM!",Y=[R,S,T,U,V,W,X],Z=[0,7,15,23,29,42,36],_=[1,26,676],ab=null,bb=void 0,cb=Math.min,db=Math.max,eb=Math.abs,fb=Math.pow;d.missingArgument={};var gb=function(){function a(a,b){this._error=a,this._code=b}return a.prototype.toString=function(){return this._error},a.parse=function(b){var c=a._parseCore(b);if(c===bb)throw"Incorrect error!";return c},a._parseCore=function(b){if(typeof b!==J&&b!==ab&&""!==b)for(var c=0;c<Y.length;c++){var d=Y[c];if(d===b||d===b.toUpperCase())return new a(d,Z[c])}return bb},a}();d.CalcError=gb,d.Error=gb;var hb=new gb(R,0),ib=new gb(S,7),jb=new gb(T,15),kb=new gb(U,23),lb=new gb(V,29),mb=new gb(W,42),nb=new gb(X,36),ob=function(){function a(){}return a.Null=hb,a.DivideByZero=ib,a.Value=jb,a.Reference=kb,a.Name=lb,a.NotAvailable=mb,a.Number=nb,a}();d.Errors=ob;var pb=function(){function a(){}return a.prototype.getRowCount=function(){return 1},a.prototype.getColumnCount=function(){return 1},a.prototype.length=function(){return this.getRowCount()*this.getColumnCount()},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=parseInt(a/b,10),d=a%b;return this.getValue(c,d)},a.prototype.getValue=function(){return ab},a.prototype.getAllValue=function(a,b,c,d){for(var e=[],f=a;a+c>f;f++){e[f]=[];for(var g=b;b+d>g;g++)e[f][g]=this.getValue(f,g)}return e},a}();d.CalcArray=pb,d.Array=pb;var qb=function(a){function b(b,c){a.call(this);var d=this,e=b.length;if(d._array=b,d._rowCount=e,arguments.length<2){c=0;for(var f=0;e>f;f++)c=db(b[f].length,c)}d._columnCount=c}return __extends(b,a),b.prototype.getRowCount=function(){return this._rowCount},b.prototype.getColumnCount=function(){return this._columnCount},b.prototype.getValue=function(a,b){return this._array[a][b]},b.prototype.getAllValue=function(a,b,c,d){if(void 0===a)return this._array;for(var e=[],f=a;a+c>f;f++){e[f]=[];for(var g=b;b+d>g;g++)e[f][g]=this._array[f][g]}return e},b}(pb);d._ConcreteArray=qb;var rb=function(a){function b(b,c,d,e,f){a.call(this);var g=this;g._array=b,g._row=c,g._column=d,g._rowCount=e,g._columnCount=f}return __extends(b,a),b.prototype.getRowCount=function(){return this._rowCount},b.prototype.getColumnCount=function(){return this._columnCount},b.prototype.getValue=function(a,b){var c=this;return Eb.getValue(c._array,c._row+a,c._column+b)},b}(pb);d._SliceArray=rb;var sb=function(a){function b(b){a.call(this),this._value=b}return __extends(b,a),b.prototype.getRowCount=function(){return this._value.getRowCount(0)},b.prototype.getColumnCount=function(){return this._value.getColumnCount(0)},b.prototype.getValue=function(a,b){return this._value.getValue(0,a,b)},b}(pb);d._ArrayWrappingRange=sb;var tb=function(a){function b(b){a.call(this),this._value=b}return __extends(b,a),b.prototype.getRowCount=function(){return 1},b.prototype.getColumnCount=function(){return 1},b.prototype.getValue=function(){return this._value},b}(pb);d._ArrayWrappingScalar=tb;var ub=function(a){function b(b){a.call(this),this._value=b}return __extends(b,a),b.prototype.getRowCount=function(){return this._value.length},b.prototype.getColumnCount=function(){return 1},b.prototype.getValue=function(a){return this._value[a]},b}(pb);d._OneDimensionalArray=ub;var vb=function(){function a(){}return a.prototype.getRangeCount=function(){return 1},a.prototype.getRow=function(){return 0
},a.prototype.getColumn=function(){return 0},a.prototype.getRowCount=function(){return 0},a.prototype.getColumnCount=function(){return 0},a.prototype.getValue=function(){return ab},a.prototype.isSubtotal=function(){return!1},a.prototype.getSource=function(){return ab},a.prototype.getAllValue=function(a,b,c,d,e){for(var f=[],g=void 0===a?0:a,h=void 0===a?this.getRangeCount():a,i=g;h>=i;i++){f[i]=[];for(var j=b;b+d>j;j++){f[i][j]=[];for(var k=c;c+e>k;k++)f[i][j][k]=this.getValue(i,j,k)}}return f},a}();d.Reference=vb;var wb=function(a){function b(b){if(a.call(this),!b||0===b.length)throw c.SR.Exp_InvalidArgument;for(var d=ab,e=0;e<b.length;e++){var f=b[e];if(d){if(f.getRangeCount()!==d.getRangeCount())throw c.SR.Exp_InvalidArgument;for(var g=0;g<f.getRangeCount();g++)if(f.getColumn(g)!==d.getColumn(g)||f.getColumnCount(g)!==d.getColumnCount(g)||f.getRow(g)!==d.getRow(g)||f.getRowCount(g)!==d.getRowCount(g))throw c.SR.Exp_InvalidArgument}else d=f}this._references=b.slice(0)}return __extends(b,a),b.prototype.getSheetCount=function(){return this._references.length},b.prototype.getRangeCount=function(){return this._references[0].getRangeCount()},b.prototype.getRow=function(a){return this._references[0].getRow(a)},b.prototype.getColumn=function(a){return this._references[0].getColumn(a)},b.prototype.getRowCount=function(a){return this._references[0].getRowCount(a)},b.prototype.getColumnCount=function(a){return this._references[0].getColumnCount(a)},b.prototype.getValue=function(){return ab},b.prototype.isSubtotal=function(){return!1},b.prototype.getSource=function(){return ab},b}(vb);d._SheetRangeReference=wb,function(a){a.getSource=function(a){return this._references[a].getSource()},a.getValue=function(a,b,c,d){return(typeof a===J||a===ab)&&(a=0),this._references[a].getValue(b,c,d)},a.isSubtotal=function(a,b,c,d){return(typeof a===J||a===ab)&&(a=0),this._references[a].isSubtotal(b,c,d)}}(wb.prototype);var xb=function(a){function b(b,c,d){a.call(this);var e=this;e._source=b,e._ranges=c,e._range=arguments.length>2?d:-1}return __extends(b,a),b.prototype.getRangeCount=function(){return this._ranges.length},b.prototype.getRow=function(a){return this._ranges[a].row},b.prototype.getColumn=function(a){return this._ranges[a].col},b.prototype.getRowCount=function(a){return this._ranges[a].rowCount},b.prototype.getColumnCount=function(a){return this._ranges[a].colCount},b.prototype.getValue=function(a,b,c){var d=this,e=d._range<0?a:d._range,f=d._source;return f.getValue(e,d.getRow(a)-f.getRow(e)+b,d.getColumn(a)-f.getColumn(e)+c)},b.prototype.getActualValue=function(a,b,c){var d=this,e=d._range<0?a:d._range,f=d._source;return f.getValue(e,d.getRow(a)-f.getRow(e)+b,d.getColumn(a)-f.getColumn(e)+c)},b.prototype.isSubtotal=function(a,b,c){var d=this,e=d._range<0?a:d._range,f=d._source;return f.isSubtotal(e,d.getRow(a)-f.getRow(e)+b,d.getColumn(a)-f.getColumn(e)+c)},b.prototype.getSource=function(){return this._source.getSource()},b.prototype.getAllValue=function(a,b,c,d,e){var f=this,g=f._source;if(d=void 0===d?f.getRowCount(0):d,e=void 0===e?f.getColumnCount(0):e,void 0===a)for(var h=[],i=0;i<f._ranges.length;i++){var j=f.getRow(i)-g.getRow(i),k=f.getColumn(i)-g.getColumn(i);h[i]=g.getAllValue(a,j,k,d,e)[0]}else{var l=f._range<0?a:f._range,j=f.getRow(l)-g.getRow(l),k=f.getColumn(l)-g.getColumn(l);h=g.getAllValue(l,j,k,d,e)}return h},b}(vb);d._ConcreteReference=xb;var yb=function(a){function b(b){a.call(this),this._sheet=b}return __extends(b,a),b.prototype.getRangeCount=function(){return 1},b.prototype.getRow=function(){return 0},b.prototype.getColumn=function(){return 0},b.prototype.getRowCount=function(){return this._sheet.getRowCount()},b.prototype.getColumnCount=function(){return this._sheet.getColumnCount()},b.prototype.getValue=function(a,b,c){return b>=0||c>=0?this._sheet.getValue(b,c):kb},b.prototype.isSubtotal=function(a,b,c){var d=this._sheet;if(0===a&&b<d.getRowCount()&&c<d.getColumnCount()){var e=d.getExpression(b,c);return e&&e instanceof Jb.FunctionExpression&&"SUBTOTAL"===e.getFunctionName().toUpperCase()}return!1},b.prototype.getSource=function(){return this},b.prototype.getAllValue=function(a,b,c,d,e){return this._sheet.getAllValue(a,b,c,d,e)},b}(vb);d._SheetReference=yb;var zb=function(a){function b(b,d,e,f,g,h,i,j){a.call(this,b,[new c.Range(d,e,f,g)]);var k=this;k.Action=h,k.Operand1=i,k.Operand2=j}return __extends(b,a),b.prototype.getValue=function(a,b,c){var d=this;return d.Action(d.getActualValue(a,b,c),d.Operand1,d.Operand2)},b}(xb);d._TernaryCompositeConcreteReference=zb;var Ab=function(a){function b(b,d,e,f,g,h){a.call(this,b,[new c.Range(d,e,f,g)]),this.Action=h}return __extends(b,a),b.prototype.getValue=function(a,b,c){return this.Action(this.getActualValue(a,b,c))},b}(xb);d._UnaryCompositeConcreteReference=Ab;var Bb=function(a){function b(b,d,e,f,g,h,i,j){a.call(this,b,[new c.Range(d,e,f,g)]);var k=this;k.Action=h,k.Operand1=i,k.SwitchOrder=j}return __extends(b,a),b.prototype.getValue=function(a,b,c){var d=this,e=d.getActualValue(a,b,c);return d.SwitchOrder?d.Action(d.Operand1,e):d.Action(e,d.Operand1)},b}(xb);d._BinaryCompositeConcreteReference=Bb;var Cb=function(){function a(){}return a.isNumber=function(b){return a._inArray?typeof b===K||b instanceof Date:typeof b===K||!isNaN(b)&&!isNaN(parseFloat(b))||b instanceof Date},a.isError=function(a){return a instanceof gb},a._isCalcArray=function(a){return a instanceof pb},a._isCalcReference=function(a){return a instanceof vb},a.toResult=function(a){return isNaN(a)||!isFinite(a)?nb:a},a._toArray=function(a){return a instanceof pb?a:a instanceof vb?1===a.getRangeCount()?new sb(a):void 0:new tb(a)},a._isNaNOrInfinite=function(a){return isNaN(a)||!isFinite(a)},a.toInt=function(b){var d=a.toDouble(b);if(eb(d)<1e21)return parseInt(d,10);throw c.SR.Exp_InvalidCast},a.toDouble=function(b){var d={value:0};if(a.tryToDouble(b,d))return d.value;throw c.SR.Exp_InvalidCast},a.tryToDouble=function(c,d){var e=ab;if(typeof c===J||c===ab)return d.value=0,!0;var f=typeof c;try{if(f===K){if(e=new Number(c).valueOf(),a._isNaNOrInfinite(e))return!1}else if(f===L){if(e=new Number(c).valueOf(),a._isNaNOrInfinite(e))return!1}else if(f===M)e=c?1:0;else{if(!(c instanceof Date))return!1;e=new b._DateTimeHelper(c).toOADate()}}catch(g){return!1}return d.value=e,!0},a.tryToBool=function(b){try{if(typeof b===J||b===ab)return!1;if(typeof b===M)return b;if(b instanceof Date)return 0!==new c._DateTimeHelper(b).toOADate();if(a.isNumber(b))return 0!==b;throw c.SR.Exp_InvalidCast}catch(d){}return!0},a.toBool=function(b){if(typeof b===J||b===ab)return!1;if(typeof b===M)return b;if(b instanceof Date)return 0!==new c._DateTimeHelper(b).toOADate();if(a.isNumber(b))return 0!==b;if(b instanceof d.Error)return!1;throw c.SR.Exp_InvalidCast},a.toString=function(a){try{if(typeof a===J||a===ab)return"";if(typeof a===M)return a?N:O;if(typeof a===L)return a;if(a instanceof Date)return new c._DateTimeHelper(a).localeFormat("M/d/yyyy h:mm:ss");if(a instanceof pb)throw c.SR.Exp_InvalidCast;return a.toString()}catch(b){throw c.SR.Exp_InvalidCast}},a.toDateTime=function(a){if(typeof a===J||a===ab)return c._DateTimeHelper.fromOADate(0);if(a instanceof Date)return new Date(a);if(typeof a===L){var b=c._DateTimeHelper.parseLocale(a);if(typeof b!==J&&b!==ab||isNaN(a)||(b=c._DateTimeHelper.fromOADate(parseFloat(a))),b===bb||b===ab)throw c.SR.Exp_InvalidArgument;return b}if(typeof a===K)return c._DateTimeHelper.fromOADate(a);throw c.SR.Exp_InvalidCast},a._inArray=!1,a}();d.Convert=Cb;var Db=function(){function a(){}return a._argumentExists=function(a,b){return a&&b<a.length&&a[b]!==d.missingArgument},a.getArrayValue=function(a,b,c){return typeof a===J||a===ab?jb:b<a.getRowCount()&&c<a.getColumnCount()?a.getValue(b,c):c>=a.getColumnCount()&&1===a.getColumnCount()&&b<a.getRowCount()?a.getValue(b,0):b>=a.getRowCount()&&1===a.getColumnCount()&&c<a.getColumnCount()?a.getValue(0,c):jb},a.tryExtractToSingleValue=function(a){if(a instanceof vb){var b=Cb._toArray(a);a=1===b.getRowCount()&&1===b.getColumnCount()?b.getValue(0,0):b}return a instanceof pb&&1===a.getRowCount()&&1===a.getColumnCount()&&(a=a.getValue(0,0)),{value:a,success:!(a instanceof pb)}},a}();d._Helper=Db;var Eb=function(){function a(){}return a.isArrayOrReference=function(a){return a instanceof pb?(Cb._inArray=!0,!0):a instanceof vb},a.getRangeCount=function(a){return a instanceof vb?a.getRangeCount():1},a.getLength=function(a,b){return e(function(){return 0===arguments.length?a.getRowCount()*a.getColumnCount():a.getRowCount(arguments[0])*a.getColumnCount(arguments[0])},a,b,1)},a.getRowCount=function(a,b){return e(a.getRowCount,a,b,1)},a.getColumnCount=function(a,b){return e(a.getColumnCount,a,b,1)},a.getValueByIndex=function(a,b,c){return e(function(){if(0===arguments.length)return a.getValueByIndex(b);var c=a.getColumnCount(arguments[0]);return a.getValue(arguments[0],parseInt(b/c,10),b%c)},a,c,a)},a.getValue=function(a,b,c,d){return e(function(){return 0===arguments.length?a.getValue(b,c):a.getValue(arguments[0],b,c)},a,d,a)},a.isSubtotalByIndex=function(a,b,c){return e(function(){var c=a.getColumnCount(arguments[0]);return a.isSubtotal(arguments[0],b/c,b%c)},a,c,!1,!0)},a.isSubtotal=function(a,b,c,d){return e(function(){return a.isSubtotal(arguments[0],b,c)},a,d,!1,!0)},a}();d._ArrayHelper=Eb,function(a){function b(a,b){return a===b?!0:eb(a-b)<eb(a)/281474976710656}var c=function(){function a(a){this.name=a}return a.prototype.getName=function(){return this.name},a.prototype.compareTo=function(a){return f(this.name,a.name)},a.prototype.toString=function(){return this.getName()},a}();a.Operator=c;var d=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype._evaluateSingle=function(){},b.prototype._evaluateImp=function(a,b){var c=ab;if(a instanceof pb&&(c=a),a instanceof vb&&(c=Cb._toArray(a)),c===bb||c===ab)return this._evaluateSingle(a,b);if(c.length()<1)return nb;for(var d=[],e=0;e<c.getRowCount();e++){d[e]=[];for(var f=0;f<c.getColumnCount();f++)d[e][f]=this._evaluateSingle(c.getValue(e,f),b)}return new qb(d,c.getColumnCount())},b.prototype.evaluate=function(a,b){return this._evaluateImp(a,b)},b}(c);a.UnaryOperator=d,a.plus=new d("+"),a.plus._evaluateSingle=function(a){if(a===bb||a===ab)return 0;var b={value:0};return Cb.tryToDouble(a,b)?Cb.toDouble(b.value):"string"==typeof a?a:jb},a.negate=new d("-"),a.negate._evaluateSingle=function(a){if(a===bb||a===ab)return 0;var b={value:0};return Cb.tryToDouble(a,b)?-b.value:jb},a.percent=new d("%"),a.percent._evaluateSingle=function(a){if(a===bb||a===ab)return 0;var b={value:0};return Cb.tryToDouble(a,b)?b.value/100:jb};var e=function(a){function b(b,c){a.call(this,b),this.acceptsReference=c}return __extends(b,a),b.prototype._evaluateSingle=function(){},b.prototype.evaluate=function(a,b){var c=Db.tryExtractToSingleValue(a),d=Db.tryExtractToSingleValue(b);if(c.success&&d.success)return this._evaluateSingle(c.value,d.value);a=c.value,b=d.value;var e=c.success?-1:a.getRowCount(),f=c.success?-1:a.getColumnCount(),g=d.success?-1:b.getRowCount(),h=d.success?-1:b.getColumnCount(),i=-1,j=-1;if(c.success||d.success)c.success?(i=g,j=h):(i=e,j=f);else{if(1!=e&&1!=g&&e!=g||1!=f&&1!=h&&f!=h)return mb;i=1==e?g:e,j=1==f?h:f}for(var k=[],l=0;i>l;l++){k[l]=[];for(var m=0;j>m;m++)k[l][m]=!c.success&&(1!==e&&i>e||1!==f&&j>f)||!d.success&&(1!==g&&i>g||1!==h&&j>h)?mb:this._evaluateSingle(c.success?a:Db.getArrayValue(a,1===e?0:l,1===f?0:m),d.success?b:Db.getArrayValue(b,1==g?0:l,1===h?0:m))}return new qb(k,j)},b}(c);a.BinaryOperator=e,a.add=new e("+",!1),a.add._evaluateSingle=function(a,b){if(Cb.isError(a))return a;if(Cb.isError(b))return b;(a===bb||a===ab)&&(a=0),(b===bb||b===ab)&&(b=0);var c={value:0};if(!Cb.tryToDouble(a,c))return jb;var d={value:0};return Cb.tryToDouble(b,d)?c.value+d.value:jb},a.subtract=new e("-",!1),a.subtract._evaluateSingle=function(a,b){if(Cb.isError(a))return a;if(Cb.isError(b))return b;(a===bb||a===ab)&&(a=0),(b===bb||b===ab)&&(b=0);var c={value:0};if(!Cb.tryToDouble(a,c))return jb;var d={value:0};return Cb.tryToDouble(b,d)?c.value-d.value:jb},a.multiply=new e("*",!1),a.multiply._evaluateSingle=function(a,b){if(Cb.isError(a))return a;if(Cb.isError(b))return b;(a===bb||a===ab)&&(a=0),(b===bb||b===ab)&&(b=0);var c={value:0};if(!Cb.tryToDouble(a,c))return jb;var d={value:0};return Cb.tryToDouble(b,d)?c.value*d.value:jb},a.divide=new e("/",!1),a.divide._evaluateSingle=function(a,b){if(b===bb||b===ab||""===b||0===b)return ib;if(Cb.isError(a))return a;if(Cb.isError(b))return b;(a===bb||a===ab)&&(a=0);var c={value:0};if(!Cb.tryToDouble(a,c))return jb;var d={value:0};return Cb.tryToDouble(b,d)?0===d.value?ib:c.value/d.value:jb},a.exponent=new e("^",!1),a.exponent._evaluateSingle=function(a,b){if(Cb.isError(a))return a;if(Cb.isError(b))return b;(a===bb||a===ab)&&(a=0),(b===bb||b===ab)&&(b=0);var c={value:0};if(!Cb.tryToDouble(a,c))return jb;a=c.value;var d={value:0};return Cb.tryToDouble(b,d)?(b=d.value,0===a&&0>b?ib:fb(a,b)):jb},a.concatenate=new e("&",!1),a.concatenate._evaluateSingle=function(a,b){return Cb.isError(a)?a:Cb.isError(b)?b:((a===bb||a===ab)&&(a=""),(b===bb||b===ab)&&(b=""),a.toString()+b.toString())},a.equal=new e("=",!1),a.equal._evaluateSingle=function(a,c){if(Cb.isError(a))return a;if(Cb.isError(c))return c;if((a===bb||a===ab)&&(a=typeof c===L?"":0),(c===bb||c===ab)&&(c=typeof a===L?"":0),typeof a===L||typeof c===L)return a.toString().toUpperCase()===c.toString().toUpperCase();var d={value:0};if(!Cb.tryToDouble(a,d))return jb;a=d.value;var e={value:0};if(!Cb.tryToDouble(c,e))return jb;c=e.value;var f=a,g=c;return b(f,g)},a.notEqual=new e("<>",!1),a.notEqual._evaluateSingle=function(b,c,d){var e=a.equal._evaluateSingle.call(this,b,c,d);return typeof e===M?!e:e},a.lessThan=new e("<",!1),a.lessThan._evaluateSingle=function(a,c){if(Cb.isError(a))return a;if(Cb.isError(c))return c;if((a===bb||a===ab)&&(a=0),(c===bb||c===ab)&&(c=0),typeof a===L||typeof c===L)return a.toString().toUpperCase()<c.toString().toUpperCase();var d={value:0};if(!Cb.tryToDouble(a,d))return jb;a=d.value;var e={value:0};if(!Cb.tryToDouble(c,e))return jb;c=e.value;var f=a,g=c;return g>f&&!b(f,g)},a.greaterThan=new e(">",!1),a.greaterThan._evaluateSingle=function(a,c){if(Cb.isError(a))return a;if(Cb.isError(c))return c;if((a===bb||a===ab)&&(a=0),(c===bb||c===ab)&&(c=0),typeof a===L||typeof c===L)return a.toString().toUpperCase()>c.toString().toUpperCase();var d={value:0};if(!Cb.tryToDouble(a,d))return jb;a=d.value;var e={value:0};if(!Cb.tryToDouble(c,e))return jb;c=e.value;var f=a,g=c;return f>g&&!b(f,g)},a.lessThanOrEqual=new e("<=",!1),a.lessThanOrEqual._evaluateSingle=function(a,c){if(Cb.isError(a))return a;if(Cb.isError(c))return c;if((a===bb||a===ab)&&(a=0),(c===bb||c===ab)&&(c=0),typeof a===L||typeof c===L)return a.toString().toUpperCase()<=c.toString().toUpperCase();var d={value:0};if(!Cb.tryToDouble(a,d))return jb;a=d.value;var e={value:0};if(!Cb.tryToDouble(c,e))return jb;c=e.value;var f=a,g=c;return g>f||b(f,g)},a.greaterThanOrEqual=new e(">=",!1),a.greaterThanOrEqual._evaluateSingle=function(a,c){if(Cb.isError(a))return a;if(Cb.isError(c))return c;if((a===bb||a===ab)&&(a=0),(c===bb||c===ab)&&(c=0),typeof a===L||typeof c===L)return a.toString().toUpperCase()>=c.toString().toUpperCase();var d={value:0};if(!Cb.tryToDouble(a,d))return jb;a=d.value;var e={value:0};if(!Cb.tryToDouble(c,e))return jb;c=e.value;var f=a,g=c;return f>g||b(f,g)},a.range=new e(":",!0),a.range.evaluate=function(a,b){if(a===bb||a===ab||b===bb||b===ab||1!==a.getRangeCount()||1!==b.getRangeCount())return jb;var c=a.getSource();if(!c||c!==b.getSource())return jb;var d=a.getRow(0),e=a.getColumn(0),f=b.getRow(0),g=b.getColumn(0),h=cb(d,f),i=cb(e,g),j=db(d+a.getRowCount(0),f+b.getRowCount(0))-h,k=db(e+a.getColumnCount(0),g+b.getColumnCount(0))-i;return new xb(c,[{row:h,col:i,rowCount:j,colCount:k}])},a.union=new e(",",!0),a.union.evaluate=function(a,b){if(a===bb||a===ab||b===bb||b===ab)return jb;var c=[],d=0;for(d=0;d<a.getRangeCount();d++)c.push({row:a.getRow(d),col:a.getColumn(d),rowCount:a.getRowCount(d),colCount:a.getColumnCount(d)});for(d=0;d<b.getRangeCount();d++)c.push({row:b.getRow(d),col:b.getColumn(d),rowCount:b.getRowCount(d),colCount:b.getColumnCount(d)});return new xb(a.getSource(),c)},a.intersection=new e(" ",!0),a.intersection.evaluate=function(a,b){if(a===bb||a===ab||b===bb||b===ab||1!==a.getRangeCount()||1!==b.getRangeCount())return jb;var c=a.getSource();if(!c||c!==b.getSource())return jb;var d=a.getRow(0),e=a.getColumn(0),f=b.getRow(0),g=b.getColumn(0),h=db(d,f),i=db(e,g),j=cb(d+a.getRowCount(0),f+b.getRowCount(0))-h,k=cb(e+a.getColumnCount(0),g+b.getColumnCount(0))-i;return new xb(c,[{row:h,col:i,rowCount:j,colCount:k}])}}(d.Operators||(d.Operators={}));var Fb=d.Operators;!function(a){function b(b,d,e){if(b===bb||b===ab)throw c.SR.Exp_InvalidFunctionName;var f;if(b=b.toUpperCase(),a.Functions._builtInFunctions.hasOwnProperty(b))throw c.SR.Exp_InvalidOverrideFunction;if(a.Functions._customFunctions.hasOwnProperty(b))if(f=a.Functions._customFunctions[b]){if(!e||!e.override)throw c.SR.Exp_OverrideNotAllowed}else a.Functions._customFunctions[b]=new a.Functions.Function(b,0,255),f=a.Functions[b.toUpperCase()];else f=new a.Functions.Function(b,0,255),a.Functions._customFunctions[b]=f;if(d&&"function"==typeof d&&(f.evaluate=d),e)for(var g in e)e.hasOwnProperty(g)&&"override"!==g&&(f[g]=e[g]);return f}function d(b){return b===bb||b===ab?ab:(b=b.toUpperCase(),a.Functions._builtInFunctions&&a.Functions._builtInFunctions.hasOwnProperty(b)?a.Functions._builtInFunctions[b]:a.Functions._customFunctions.hasOwnProperty(b)?a.Functions._customFunctions[b]:ab)}!function(a){a[a.normal=0]="normal",a[a.allwaysExpand=1]="allwaysExpand",a[a.neverExpand=2]="neverExpand"}(a.ArrayArgumentEvaluateMode||(a.ArrayArgumentEvaluateMode={}));var e=(a.ArrayArgumentEvaluateMode,function(){function b(a,b,c){var d=arguments.length;this._init(a,2>d?0:b,3>d?0:c)}return b.prototype._init=function(a,b,c){var d=this;d.name=a,d.minArgs=b,d.maxArgs=c},b.prototype.acceptsArray=function(){return!1},b.prototype.acceptsReference=function(){return!1},b.prototype.acceptsError=function(){return!1},b.prototype.acceptsMissingArgument=function(){return!1},b.prototype.isVolatile=function(){return!1},b.prototype.isContextSensitive=function(){return!1},b.prototype.isBranch=function(){return!1},b.prototype.findTestArgument=function(){return-1},b.prototype.findBranchArgument=function(){return-1},b.prototype.expandRows=function(){return!0},b.prototype.expandColumns=function(){return!0},b.prototype.precedentReference=function(){return!0},b.prototype.evaluate=function(){},b.prototype.evaluateWithContext=function(a,b){var c=this;return c.isContextSensitive()?c.evaluate(a,b):c.evaluate(a)},b.prototype.toString=function(){return this.name},b._create=function(b,c,d){var e=new a.Functions.Function(b,0,255);if(c&&"function"==typeof c&&(e.evaluate=c),d)for(var f in d)d.hasOwnProperty(f)&&"override"!==f&&(e[f]=d[f]);return e},b}());a.Function=e,a._customFunctions={},a._builtInFunctions={},a.defineGlobalCustomFunction=b,a.findGlobalFunction=d,$.extend({ce:{createFunction:function(b,c,d){return a.Functions.Function._create(b,c,d)},defineGlobalCustomFunction:function(b,c,d){return a.Functions.defineGlobalCustomFunction(b,c,d)},findGlobalFunction:function(b){return a.Functions.findGlobalFunction(b)}}})}(d.Functions||(d.Functions={}));var Gb=d.Functions,Hb={cell:0,row:1,column:2,sheet:3};!function(a){function b(b,c,g,h,j){var l=b.row,m=b.column,q=[];q.push({expr:c,acceptsArray:!1,acceptsRef:!1,index:-1});for(var r,s,u,v,y,z=0,B=0,E=!1,H=h,K=j,M=!1,N=!1;0!=q.length;){if(r=q.pop(),s=r.acceptsArray,u=r.acceptsRef,c=r.expr,v=ab,c instanceof e){var O=c;-1===r.index?(r.index=0,q.push(r),q.push({expr:O.argument,acceptsArray:s,acceptsRef:tb,index:-1})):O.argument!==y&&(v=new e(y))}else if(c instanceof i||c instanceof k){var P=c;if(1==r.index)B--,v=y;else{B++,q.push({expr:c,acceptsArray:!0,acceptsRef:!0,index:1});var Q;Q=c instanceof k?c.source.getName(P.name,b.row,b.column):b.getName(P.name),Q||(Q=new a.ErrorExpression(lb)),q.push({expr:Q,acceptsArray:!0,acceptsRef:!0,index:-1})}}else if(c instanceof t){var R=c;if(!s&&(z>0||g))E=!0;else if(!s&&0==z)if(H>=R.value.RowCount&&R.value.RowCount>1||K>=R.value.ColumnCount&&R.value.ColumnCount>1)v=new p(mb);else try{1==R.value.RowCount&&(H=0),1==R.value.ColumnCount&&(K=0);var S=R.value.getValue(H,K);"string"==typeof S?v=new o(S):"number"==typeof S&&(v=new n(S)),J||(J=new d.Parser),v=J.parse(R.value.getValue(H,K).toString(),ab)}catch(T){v=new p(mb)}}else if(c instanceof A||c instanceof C){var U=c;if(B&&(U.rowRelative||U.columnRelative)){var V=c instanceof C?c.source:b.source,W=V.getRowCount(),X=V.getColumnCount(),Y=U.rowRelative?(U.row+b.activeRow)%W:U.row,Z=U.columnRelative?(U.column+b.activeColumn)%X:U.column;Y=0>Y?Y+W:Y,Z=0>Z?Z+X:Z,c=c instanceof C?new C(V,Y,Z,!1,!1):new A(Y,Z,!1,!1)}}else if(c instanceof d.Expressions.RangeExpression||c instanceof F||c instanceof G){var $=c;if(B&&($.startRowRelative||$.startColumnRelative||$.endRowRelative||$.endColumnRelative)){var V=c instanceof F?c.source:c instanceof G?c.startSource:b.source,W=V.getRowCount(),X=V.getColumnCount(),_=$.startRowRelative?($.startRow+b.activeRow)%W:$.startRow,bb=$.startColumnRelative?($.startColumn+b.activeColumn)%X:$.startColumn,cb=$.endRowRelative?($.endRow+b.activeRow)%W:$.endRow,db=$.endColumnRelative?($.endColumn+b.activeColumn)%X:$.endColumn;if(_=0>_?_+W:_,bb=0>bb?bb+X:bb,cb=0>cb?cb+W:cb,db=0>db?db+X:db,_>cb){var eb=_;_=cb,cb=eb}if(bb>db){var eb=bb;bb=db,db=eb}c=c instanceof D?new D(_,bb,cb,db,!1,!1,!1,!1):c instanceof F?new F(V,_,bb,cb,db,!1,!1,!1,!1):new G(V,c.endSource,_,bb,cb,db,!1,!1,!1,!1)}if(!u||!s&&g)if(z>0&&!g||0===z||M){var fb=$.getRange(l,m);if(g)if(!$.isFullColumn&&1!=fb.rowCount&&H>=fb.rowCount||!$.isFullRow&&1!=fb.columnCount&&K>=fb.columnCount)v=new p(mb);else{var Y=($.isFullColumn?0:fb.row)+(1==fb.rowCount?0:H),Z=($.isFullRow?0:fb.column)+(1==fb.columnCount?0:K);v=c instanceof G?new G(c.startSource,c.endSource,Y,Z,Y,Z,!1,!1,!1,!1):c instanceof F?new C(c.source,Y,Z,!1,!1):new A(Y,Z,!1,!1)}else if(fb.rowCount>1&&fb.columnCount>1||fb.rowCount>1&&!$.isFullColumn&&(l<fb.row||l>=fb.row+fb.rowCount)||fb.columnCount>1&&!$.isFullRow&&(m<fb.column||m>=fb.column+fb.columnCount))v=new p(jb);else{var Y=$.isFullColumn||fb.rowCount>1?l:fb.row,Z=$.isFullRow||fb.columnCount>1?m:fb.column;v=c instanceof G?new G(c.startSource,c.endSource,Y,Z,Y,Z,!1,!1,!1,!1):c instanceof F?new C(c.source,Y,Z,!1,!1):new A(Y,Z,!1,!1)}}else E=!0;else;}else if(c instanceof f){var gb,hb=c,ib=hb.argCount();if(typeof hb.fn===L)if(b){if(gb=b.getFunction(hb.fn),!gb){v=new p(lb);continue}if(ib<gb.minArgs||ib>gb.maxArgs){v=new p(jb);continue}hb.fn=gb}else v=new p(lb);gb=hb.fn;var kb=r.index,nb=r.neeedExpendindexs;if(0>kb?(r.noExpendCatchValue=M,r.arrayFormulaCatchValue=g,2===gb.arrayArgumentEvaluateMode&&(M=!0),1===gb.arrayArgumentEvaluateMode&&(g=!0),r.args=[]):(gb.acceptsArray(kb)?z--:E&&(nb||(nb=[],r.neeedExpendindexs=nb),hb.getArg(kb)!=y,nb.push(kb)),r.args.push(y)),kb==ib-1){M=r.noExpendCatchValue,g=r.arrayFormulaCatchValue;var ob=r.args,pb=!1;if(ob&&ob.length>0)for(var qb=0;qb<ob.length;qb++)if(ob[qb]!==hb.getArg(qb)){pb=!0;break}v=pb?new f(hb.fn,ob):c,nb&&nb.length>0&&(v=new I(v,nb),E=!0)}else E=!1,kb++,r.index=kb,gb.acceptsArray(kb)&&z++,q.push(r),q.push({expr:hb.getArg(kb),acceptsArray:gb.acceptsArray(kb),acceptsRef:gb.acceptsReference(kb),index:-1})}else if(c instanceof w){var rb=c;if(-1===r.index)r.index=0,q.push(r),q.push({expr:rb.operand,acceptsArray:!1,acceptsRef:!1,index:-1});else if(v=y!=rb.operand?new w(rb.operator,y):c,E){var nb=[];nb.push(0),v=new I(v,nb)}}else if(c instanceof x){var sb=c,tb=sb.operator.acceptsReference;if(-1===r.index)r.index=0,q.push(r),q.push({expr:sb.left,acceptsArray:!1,acceptsRef:tb,index:-1});else if(0==r.index){if(y!=sb.left&&(v=new x(sb.operator,y,sb.right),r.expr=v),E){var nb=[];nb.push(0),r.neeedExpendindexs=nb,E=!1}r.index=1,q.push(r),q.push({expr:sb.right,acceptsArray:!1,acceptsRef:tb,index:-1})}else{v=y!=sb.right?new x(sb.operator,sb.left,y):sb;var nb=r.neeedExpendindexs;E&&(nb||(nb=[]),nb.push(1)),nb&&(v=new I(v,nb),E=!0)}}v===ab?v=c:v!=c&&(N=!0),y=v}return v}var c=function(){function a(){}return a}();a.Expression=c;var e=function(a){function b(b){a.call(this),this.argument=b}return __extends(b,a),b}(c);a.ParenthesesExpression=e;var f=function(a){function b(b,c){a.call(this),this.fn=b,this.args=c}return __extends(b,a),b.prototype.argCount=function(){return this.args?this.args.length:0},b.prototype.getArg=function(a){return this.args?this.args[a]:ab},b.prototype.getFunctionName=function(){var a=this;return typeof a.fn===L?a.fn:a.fn.name},b}(c);a.FunctionExpression=f;var i=function(a){function b(b){a.call(this),this.name=b}return __extends(b,a),b}(c);a.NameExpression=i;var j=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(i);a.BangNameExpression=j;var k=function(a){function b(b,c){a.call(this,c),this.source=b}return __extends(b,a),b}(i);a.ExternalNameExpression=k;var l=function(a){function b(b){a.call(this),this.value=b}return __extends(b,a),b}(c);a.ConstantExpression=l;var m=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(l);a.BooleanExpression=m;var n=function(a){function b(b,c){a.call(this,b),this.originalValue=c}return __extends(b,a),b}(l);a.DoubleExpression=n;var o=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(l);a.StringExpression=o;var p=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(l);a.ErrorExpression=p;var q=function(a){function b(b,c){a.call(this,c),this.source=b}return __extends(b,a),b}(p);a.ExternalErrorExpression=q;var r=function(a){function b(b,c,d){a.call(this,d),this.startSource=b,this.endSource=c}return __extends(b,a),b}(p);a.SheetRangeErrorExpression=r;var s=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(p);a.BangErrorExpression=s;var t=function(a){function b(b){a.call(this,new qb(b))}return __extends(b,a),b}(l);a.ArrayExpression=t;var u=function(a){function b(){a.call(this,d.missingArgument)}return __extends(b,a),b}(l);a.MissingArgumentExpression=u;var v=function(a){function b(b){a.call(this),this.operator=b}return __extends(b,a),b}(c);a.OperatorExpression=v;var w=function(a){function b(b,c){a.call(this,b),this.operand=c}return __extends(b,a),b}(v);a.UnaryOperatorExpression=w;var x=function(a){function b(b,c,d){a.call(this,b),this.left=c,this.right=d}return __extends(b,a),b}(v);a.BinaryOperatorExpression=x;var y=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.getRange=function(){return ab},b}(c);a.ReferenceExpression=y;var z=function(a){function b(b){a.call(this),this.source=b}return __extends(b,a),b}(y);a.ExternalReferenceExpression=z;var A=function(a){function b(b,c,d,e){a.call(this);var f=this;f.row=b,f.column=c,f.rowRelative=d,f.columnRelative=e}return __extends(b,a),b.prototype.getRange=function(a,b){return g.call(this,a,b)},b}(y);a.CellExpression=A;var B=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b}(A);a.BangCellExpression=B;var C=function(a){function b(b,c,d,e,f){a.call(this,b);var g=this;g.row=c,g.column=d,g.rowRelative=e,g.columnRelative=f}return __extends(b,a),b.prototype.getRange=function(a,b){return g.call(this,a,b)},b}(z);a.ExternalCellExpression=C;var D=function(a){function b(b,c,d,e,f,g,h,i){a.call(this),0===arguments.length?this._initDefault():this.init(b,c,d,e,f,g,h,i)}return __extends(b,a),b.prototype._initDefault=function(){var a=Tb.BAND_INDEX_CONST,b=this;b.init(a,a,a,a,!1,!1,!1,!1),b.isFullRow=!0,b.isFullColumn=!0},b.prototype.init=function(a,b,c,d,e,f,g,h){var i=this;e===g&&a>c?(i.startRow=c,i.endRow=a,i.startRowRelative=g,i.endRowRelative=e):(i.startRow=a,i.endRow=c,i.startRowRelative=e,i.endRowRelative=g),f===h&&b>d?(i.startColumn=d,i.endColumn=b,i.startColumnRelative=h,i.endColumnRelative=f):(i.startColumn=b,i.endColumn=d,i.startColumnRelative=f,i.endColumnRelative=h),i.isFullRow=!1,i.isFullColumn=!1},b.prototype.initBand=function(a,b,c,d,e){if(a>b){var f=a;a=b,b=f;var g=c;c=d,d=g}var h=this;e?(h.startRow=a,h.startColumn=Tb.BAND_INDEX_CONST,h.endRow=b,h.endColumn=Tb.BAND_INDEX_CONST,h.startRowRelative=c,h.startColumnRelative=!1,h.endRowRelative=d,h.endColumnRelative=!1,h.isFullRow=!0,h.isFullColumn=!1):(h.startRow=Tb.BAND_INDEX_CONST,h.startColumn=a,h.endRow=Tb.BAND_INDEX_CONST,h.endColumn=b,h.startRowRelative=!1,h.startColumnRelative=c,h.endRowRelative=!1,h.endColumnRelative=d,h.isFullRow=!1,h.isFullColumn=!0)},b.prototype._getRangeType=function(){var a=this;return a.isFullRow&&a.isFullColumn?Hb.sheet:a.isFullRow?Hb.row:a.isFullColumn?Hb.column:Hb.cell},b.prototype.getRange=function(a,b){return h.call(this,a,b)},b}(y);a.RangeExpression=D;var E=function(a){function b(b,c,d,e,f,g,h,i){a.call(this,b,c,d,e,f,g,h,i)}return __extends(b,a),b}(D);a.BangRangeExpression=E;var F=function(a){function b(b,c,d,e,f,g,h,i,j){a.call(this,ab),1===arguments.length?this._initDefault(b):this.init(b,c,d,e,f,g,h,i,j)}return __extends(b,a),b.prototype._initDefault=function(a){var b=Tb.BAND_INDEX_CONST,c=this;c.init(a,b,b,b,b,!1,!1,!1,!1),c.isFullRow=!0,c.isFullColumn=!0},b.prototype.init=function(a,b,c,d,e,f,g,h,i){var j=this;j.source=a,f===h&&b>d?(j.startRow=d,j.endRow=b,j.startRowRelative=h,j.endRowRelative=f):(j.startRow=b,j.endRow=d,j.startRowRelative=f,j.endRowRelative=h),g===i&&c>e?(j.startColumn=e,j.endColumn=c,j.startColumnRelative=i,j.endColumnRelative=g):(j.startColumn=c,j.endColumn=e,j.startColumnRelative=g,j.endColumnRelative=i)},b.prototype.initBand=function(a,b,c,d,e,f){var g=this;if(g.source=a,b>c){var h=b;b=c,c=h;var i=d;d=e,e=i}f?(g.startRow=b,g.startColumn=Tb.BAND_INDEX_CONST,g.endRow=c,g.endColumn=Tb.BAND_INDEX_CONST,g.startRowRelative=d,g.startColumnRelative=!1,g.endRowRelative=e,g.endColumnRelative=!1,g.isFullRow=!0):(g.startRow=Tb.BAND_INDEX_CONST,g.startColumn=b,g.endRow=Tb.BAND_INDEX_CONST,g.endColumn=c,g.startRowRelative=!1,g.startColumnRelative=d,g.endRowRelative=!1,g.endColumnRelative=e,g.isFullColumn=!0)},b.prototype._getRangeType=function(){var a=this;return a.isFullRow&&a.isFullColumn?Hb.sheet:a.isFullRow?Hb.row:a.isFullColumn?Hb.column:Hb.cell},b.prototype.getRange=function(a,b){return h.call(this,a,b)},b}(z);a.ExternalRangeExpression=F;var G=function(a){function b(b,c,d,e,f,g,h,i,j,k){a.call(this),this.init(b,c,d,e,f,g,h,i,j,k)}return __extends(b,a),b.prototype.init=function(a,b,c,d,e,f,g,h,i,j){var k=this;k.startSource=a,k.endSource=b,g===i&&c>e?(k.startRow=e,k.endRow=c,k.startRowRelative=i,k.endRowRelative=g):(k.startRow=c,k.endRow=e,k.startRowRelative=g,k.endRowRelative=i),h===j&&d>f?(k.startColumn=f,k.endColumn=d,k.startColumnRelative=j,k.endColumnRelative=h):(k.startColumn=d,k.endColumn=f,k.startColumnRelative=h,k.endColumnRelative=j)},b.prototype.initBand=function(a,b,c,d,e,f,g){var h=this;if(h.startSource=a,h.endSource=b,c>d){var i=c;c=d,d=i;var j=e;e=f,f=j}g?(h.startRow=c,h.startColumn=Tb.BAND_INDEX_CONST,h.endRow=d,h.endColumn=Tb.BAND_INDEX_CONST,h.startRowRelative=e,h.startColumnRelative=!1,h.endRowRelative=f,h.endColumnRelative=!1,h.isFullRow=!0):(h.startRow=Tb.BAND_INDEX_CONST,h.startColumn=c,h.endRow=Tb.BAND_INDEX_CONST,h.endColumn=d,h.startRowRelative=!1,h.startColumnRelative=e,h.endRowRelative=!1,h.endColumnRelative=f,h.isFullColumn=!0)},b.prototype.getRange=function(a,b){return h.call(this,a,b)},b.prototype._getRangeType=function(){var a=this;return a.isFullRow&&a.isFullColumn?Hb.sheet:a.isFullRow?Hb.row:a.isFullColumn?Hb.column:Hb.cell},b}(y);a.SheetRangeExpression=G;var H=function(a){function b(b,c){a.call(this),c!==ab&&b&&this._parseStructReferenceString(c,b)}return __extends(b,a),b.create=function(a){var c=new b(ab,ab);return c._baseTable=a,c._referencePortions=Kb.NotSpecific,c._columnReferenceStartInTable=0,c._columnReferenceEndInTable=a.endColumn()-a.startColumn(),c._referenceColumnSpecifier=Lb.NotSpecific,c},b.prototype.tableName=function(){return this._baseTable.tableName()
},b.prototype._updateCatch=function(){this._catchedTableStartColumn=this._baseTable.startColumn()},b.prototype.columnReferenceStart=function(){return this._columnReferenceStartInTable+this._baseTable.startColumn()},b.prototype.columnReferenceEnd=function(){return this._columnReferenceEndInTable+this._baseTable.startColumn()},b.prototype.referencePortions=function(){return this._referencePortions},b.prototype.referenceColumnSpecifier=function(){return this._referenceColumnSpecifier},b.prototype.source=function(){return this._baseTable.source()},b.prototype.getRange=function(a){var b=this;b._updateCatch();var c,d,e,f,g,h,i=b._baseTable.startRow(),j=b._baseTable.endRow(),k=b._baseTable.hasTotalsRow(),l=b._baseTable.hasHeadersRow();switch(b._referencePortions){case Kb.Data:case Kb.NotSpecific:c=i+1,e=k?j-1:j;break;case Kb.Headers:if(!l)return ab;c=i,e=i;break;case Kb.Totals:if(!k)return ab;c=j,e=j;break;case Kb.ThisRow:c=a,e=a;break;case Kb.HeadersAndData:c=l?i:i+1,e=k?j-1:j;break;case Kb.DataAndTotals:c=i+1,e=j;break;case Kb.All:default:c=l?i:i+1,e=j}if(d=b.columnReferenceStart(),f=b.columnReferenceEnd(),c>e||i>c||e>j)return ab;g=e-c+1,h=f-d+1;var m={row:c,column:d,rowCount:g,columnCount:h};return m},b.prototype._parseStructReferenceString=function(a,c){var d=b,e=this;c=c.trim();var f=0,g=c.charAt(f),h=d._parseTableObject(a,c,f,g);h.table===ab&&d._throwError();var i=h.table;for(e._baseTable=i,f=h.charIndex,g=h.currentChar,f++,g=c.charAt(f);" "===g;)f++,g=c.charAt(f);for(var j=1,k=!1,l=!1;0!==j;)if("["===g&&(j++,f++,g=c.charAt(f)),"#"===g){k&&1>=j&&d._throwError(),h=d._parsePortion(c,f,g,j);var m=h.portion;f=h.charIndex,g=h.currentChar,j=h.lbracketLever,k?e._referencePortions===Kb.Headers&&m===Kb.Data||m===Kb.Headers&&e._referencePortions===Kb.Data?e._referencePortions=Kb.HeadersAndData:e._referencePortions===Kb.Data&&m===Kb.Totals||m===Kb.Data&&e._referencePortions===Kb.Totals?e._referencePortions=Kb.DataAndTotals:d._throwError():e._referencePortions=m,k=!0}else if("@"===g){for((j>1||k)&&d._throwError(),k=!0,e._referencePortions=Kb.ThisRow,f++,g=c.charAt(f);" "===g;)f++,g=c.charAt(f);","===g&&d._throwError()}else{for(var n=f;"]"!==g&&(","!==g||j>1)&&"["!==g;)"'"===g&&f++,f++,g=c.charAt(f);if(f>n&&((l||"["===g&&j>1)&&d._throwError(),h=e._parseColumnRange(c,f,g,j,n),f=h.charIndex,g=h.currentChar,j=h.lbracketLever,l=!0),"]"===g){if(j--,0===j)break;f>=c.length&&d._throwError(),f++,g=c.charAt(f)}","===g&&(f++,g=c.charAt(f))}k||(e._referencePortions=Kb.NotSpecific),l||(e._columnReferenceStartInTable=0,e._columnReferenceEndInTable=e._baseTable.endColumn()-e._baseTable.startColumn(),e._referenceColumnSpecifier=Lb.NotSpecific)},b.prototype._parseColumnRange=function(a,c,d,e,f){var g=b,h="",i="",j=!1,k=!1;if(e>1){if(j=!0,e--,h=a.substring(f,c),c++,d=a.charAt(c),":"===d){c++,d=a.charAt(c),k="["===d;var l=g._getColumnEndString(a,c,d,e);i=l.columnEndString,c=l.charIndex,d=l.currentChar,e=l.lbracketLever}}else if("["===d){k=!0;var m=c-1;for(d=a[m];" "===d;)m--,d=a[m];":"!==d&&g._throwError(),h=a.substring(f,m),j||(h=g._trimStart(h)),d=a.charAt(c);var l=g._getColumnEndString(a,c,d,e);i=l.columnEndString,c=l.charIndex,d=l.currentChar,e=l.lbracketLever}else{(this._referencePortions===bb||this._referencePortions===Kb.NotSpecific)&&(j=!0);var n=a.substring(f,c),m=n.indexOf(":");m>0?(h=n.substring(0,m),h=h,i=n.substring(m+1),"["!==i.charAt(0)&&g._throwError()):h=n}var o,p=this,q=p._getColumnIndex(h,j);if(i?(o=p._getColumnIndex(i,k),p._referenceColumnSpecifier=Lb.ColumnRange):(o=q,p._referenceColumnSpecifier=Lb.SingleColumn),q>o){var r=q;q=o,o=r}if(p._columnReferenceStartInTable=q,p._columnReferenceEndInTable=o,c++,c<a.length)for(d=a.charAt(c);" "===d;)c++,d=a.charAt(c);return{charIndex:c,currentChar:d,lbracketLever:e}},b._trimStart=function(a){for(var b=a.length-1;b>=0&&" "===a[b];)b--;for(;b>=0&&" "!==a[b];)b--;return b>=0?a.substr(b+1,a.length-b-1):a},b._trimEnd=function(a){for(var b=0,c=a.length;c>b&&" "===a[b];)b++;for(;c>b&&" "!==a[b];)b++;return c>b?a.substr(0,b):a},b.prototype._getColumnIndex=function(a,c){if(a&&b._validateColumnString(a,c)){for(var d="",e=0,f=a.length;f>e;e++)"'"===a[e]&&f-1>e&&"'"!==a.charAt(e+1)||(d+=a.charAt(e));a=d;var g=this._baseTable.getColumnIndexInTable(a);return 0>g&&b._throwError(),g}return-1},b._validateColumnString=function(a,b,c){if(b)return!0;2===arguments.length&&(c=!0);var d="";d=a[0];var e=d;if("#"===d||" "===d||"@"===d||" "===d||","===d||":"===d||"["===d||"]"===d)return!1;for(var f=1;f<a.length;f++){if(d=a[f]," "===d||","===d||":"===d||"["===d&&"'"!==e||"]"===d&&"'"!==e||"@"===d&&"'"!==e||"#"===d&&"'"!==e)return!1;e=d}return!0},b._getValidaColumnString=function(a){var b="",c="";b=a.charAt(0);for(var d=0;d<a.length;d++)b=a.charAt(d),("["===b||"]"===b||"@"===b||"#"===b)&&(c+="'"),c+=b;return c},b._containsInvalidateColumnString=function(a){var b="";if(b=a.charAt(0),"#"===b||" "===b||"@"===b||" "===b||","===b||":"===b||"["===b||"]"===b)return!0;for(var c=1;c<a.length;c++)if(b=a.charAt(c)," "===b||","===b||":"===b||"["===b||"]"===b||"@"===b||"#"===b)return!0;return!1},b._getColumnEndString=function(a,c,d,e){if("["===d)for(e++,c++,d=a.charAt(c);" "===d;)c++,d=a.charAt(c);for(var f=c;"]"!==d&&(","!==d||e>1);)"'"===d&&c++,c++,d=a.charAt(c);f>=c&&b._throwError(),e>1&&e--;var g=a.substring(f,c);return g=b._trimEnd(g),{columnEndString:g,charIndex:c,currentChar:d,lbracketLever:e}},b._parsePortion=function(a,c,d,e){for(var f=b,g=Kb.All,h=c;"]"!==d;)"'"===d&&c++,c++,d=a.charAt(c);for(var i=a.substring(h,c).toLowerCase().trim(),j=!1,k=0;k<f._structReferenceKeywordsLlowercase.length;k++){var l=f._structReferenceKeywordsLlowercase[k];if(i===l){g=f._getPortion(i),j=!0;break}}if(j||f._throwError(),c++,c>=a.length)e--;else{for(d=a.charAt(c);" "===d;)c++,d=a.charAt(c);if(","===d){for(1>=e&&f._throwError(),c++,d=a.charAt(c);" "===d;)c++,d=a.charAt(c);for("["===d&&(e++,c++,d=a.charAt(c));" "===d;)c++,d=a.charAt(c)}e>1&&e--}return{portion:g,charIndex:c,currentChar:d,lbracketLever:e}},b._getPortion=function(a){switch(a){case"#all":return Kb.All;case"#data":return Kb.Data;case"#headers":return Kb.Headers;case"#totals":return Kb.Totals;case"#this row":return Kb.ThisRow}return Kb.All},b._parseTableObject=function(a,b,c,d){for(var e=ab,f=0;"["!==d;)c++,d=b.charAt(c);if(f=c,f>0){var g=b.substring(0,f);e=a.getTableByName(g)}else e=a.getTableByIndex(a.row,a.column);return{table:e,charIndex:c,currentChar:d}},b._throwError=function(){throw""},b.prototype.unParse=function(a,c){var d=this;if(d._referencePortions===Kb.NotSpecific&&d._referenceColumnSpecifier===Lb.NotSpecific)return void(c.content+=d._baseTable.tableName());var e=b,f=a.row>=d._baseTable.startRow()&&a.column>=d._baseTable.startColumn()&&a.row<=d._baseTable.endRow()&&a.column<=d._baseTable.endColumn();if(f||(c.content+=d._baseTable.tableName()),c.content+="[",d._referencePortions!==Kb.NotSpecific){var g=e._getPortionsString(d._referencePortions);c.content+=d._referencePortions===Kb.DataAndTotals||d._referencePortions===Kb.HeadersAndData||d._referencePortions===Kb.ThisRow?g:d._referenceColumnSpecifier!==Lb.All?"["+g+"]":g}if(d._referenceColumnSpecifier!==Lb.NotSpecific){d._referencePortions===Kb.ThisRow||d._referencePortions===Kb.NotSpecific||(c.content+=", ");var h=d._baseTable.getColumnName(d._columnReferenceStartInTable);if(h=e._getValidaColumnString(h),d._referenceColumnSpecifier===Lb.ColumnRange){var i=d._baseTable.getColumnName(d._columnReferenceEndInTable);i=e._getValidaColumnString(i),c.content+="["+h+"]:["+i+"]"}else c.content+=d._referencePortions===Kb.ThisRow&&!e._containsInvalidateColumnString(h)||d._referencePortions===Kb.NotSpecific?h:"["+h+"]"}c.content+="]"},b._getPortionsString=function(a){switch(a){case Kb.ThisRow:return"@";case Kb.Headers:return"#Headers";case Kb.Data:return"#Data";case Kb.Totals:return"[#Totals]";case Kb.HeadersAndData:return"[#Headers], [#Data]";case Kb.DataAndTotals:return"[#Data], [#Totals]";case Kb.All:return"#All";case Kb.NotSpecific:}return"#All"},b.prototype.offsetWhenInsertRemoveColumn=function(a,c,d){var e=this,f=e._catchedTableStartColumn;if(f>a||a===f&&d||a>e._columnReferenceEndInTable+f)return e;c=d?c:-c;var g=a-f,h=new b(ab,ab);return h._baseTable=e._baseTable,h._columnReferenceEndInTable=e._columnReferenceEndInTable+c,h._columnReferenceStartInTable=e._columnReferenceStartInTable,a<=f+e._columnReferenceStartInTable&&(h._columnReferenceStartInTable+=c,h._columnReferenceStartInTable<g&&(h._columnReferenceStartInTable=g)),h._referenceColumnSpecifier=e._referenceColumnSpecifier,h._referencePortions=e._referencePortions,h._columnReferenceEndInTable<h._columnReferenceStartInTable?new p(kb):h},b.prototype.offsetWhenCopy=function(a,c){var d=this,e=new b(ab,ab);if(e._baseTable=d._baseTable,e._columnReferenceEndInTable=d._columnReferenceEndInTable,e._columnReferenceStartInTable=d._columnReferenceStartInTable,d._referenceColumnSpecifier===Lb.SingleColumn&&c&&c>0){var f=d._baseTable.endColumn()-d._baseTable.startColumn()+1;c%=f,e._columnReferenceStartInTable+=c,e._columnReferenceStartInTable<0&&(e._columnReferenceStartInTable+=f),e._columnReferenceEndInTable=e._columnReferenceStartInTable}return e._referenceColumnSpecifier=d._referenceColumnSpecifier,e._referencePortions=d._referencePortions,e},b._structReferenceKeywordsLlowercase=["#all","#data","#headers","#totals","#this row"],b}(y);a.StructReferenceExpression=H;var I=function(a){function b(b,c){a.call(this),this.expr=b,this.needExpendIndexs=c}return __extends(b,a),b}(c);a.ExpandExpression=I;var J;a._mappingArray=b}(d.Expressions||(d.Expressions={}));var Ib,Jb=d.Expressions,Kb={ThisRow:1,Headers:2,Data:3,Totals:8,HeadersAndData:6,DataAndTotals:12,All:14,NotSpecific:16},Lb={All:1,NotSpecific:1,SingleColumn:2,ColumnRange:4},Mb={None:0,Sign:1,Int:2,Dot:3,Decimal:4,Exponent:5,SignExponent:6,ScientificNotation:7,Number:8},Nb={UppercaseLetter:0,LowercaseLetter:1,DecimalDigitNumber:8,OtherNumber:10,SpaceSeparator:11,Control:14,ConnectorPunctuation:18,DashPunctuation:19,OpenPunctuation:20,ClosePunctuation:21,InitialQuotePunctuation:22,FinalQuotePunctuation:23,OtherPunctuation:24,MathSymbol:25,CurrencySymbol:26,ModifierSymbol:27,OtherSymbol:28},Ob=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];!function(a){a[a.Operand=0]="Operand",a[a.Function=1]="Function",a[a.Subexpression=2]="Subexpression",a[a.Argument=3]="Argument",a[a.OperatorPrefix=4]="OperatorPrefix",a[a.OperatorInfix=5]="OperatorInfix",a[a.OperatorPostfix=6]="OperatorPostfix",a[a.Whitespace=7]="Whitespace",a[a.Unknown=8]="Unknown"}(Ib||(Ib={}));var Pb;!function(a){a[a.Nothing=0]="Nothing",a[a.Start=1]="Start",a[a.Stop=2]="Stop",a[a.Text=3]="Text",a[a.Number=4]="Number",a[a.Logical=5]="Logical",a[a.Error=6]="Error",a[a.RangeOrName=7]="RangeOrName",a[a.Concatenation=8]="Concatenation",a[a.Intersection=9]="Intersection",a[a.Union=10]="Union",a[a.RangeOp=11]="RangeOp"}(Pb||(Pb={}));var Qb=function(){function a(a,b,c,d){(d===bb||d===ab)&&(d=0);var e=this;e.value=a,e.type=b,e.index=c,e.subType=d,e.children=[]}return a}(),Rb=function(){function a(){this._stack=[]}return a.prototype.push=function(a){this._stack.push(a)},a.prototype.pop=function(){if(0===this._stack.length)return ab;var a=this._stack.pop();return new Qb("",a.type,a.index,2)},a.prototype.current=function(){var a=this._stack,b=a.length;return b>0?a[b-1]:ab},a}(),Sb=function(){function a(a,b,c,d){var e=this;e.useR1C1=a,e.row=b,e.column=c,e.option=d}return a.prototype.getExternalSource=function(){return ab},a.prototype.getExternalSourceToken=function(){return""},a.prototype.getTableByName=function(){return ab},a.prototype.getTableByIndex=function(){return ab},a}();d.ParserContext=Sb;var Tb=function(){function a(a){this._init(a)}return a.prototype._init=function(a){var b=this;b.listSeparator=u(a,"listSeparator",","),b.numberDecimalSeparator=u(a,"numberDecimalSeparator","."),b.arrayGroupSeparator=u(a,"arrayGroupSeparator",";"),b._arrayArgumentSepatator=b.listSeparator===b.arrayGroupSeparator?"\\":b.listSeparator,b._operatorInfix="\\+-*/^&=><: "+this.listSeparator},a.prototype.parse=function(a,b){var c=this;b||(b=new Sb(!1,0,0)),b.option&&c._init(b.option);var d=c._parseToToken(a);return c._buildExpressionTree(b,d)},a.prototype.unparse=function(a,b){if(!a)return"";b||(b=new Sb(!1,0,0)),b.option&&this._init(b.option);var c={content:""};return this._unparseExpression(a,b,c),c.content},a.prototype._unparseExpression=function(a,b,d){var e=this;if(a instanceof Jb.ConstantExpression)e._unparseConstantExpression(a,b,d);else if(a instanceof Jb.OperatorExpression)e._unParseOperatorExpressions(a,b,d);else if(a instanceof Jb.ReferenceExpression)e._unParseRefenceExpressions(a,b,d);else if(a instanceof Jb.BangNameExpression)d.content+="!",d.content+=a.name;else if(a instanceof Jb.NameExpression)d.content+=a.name;else if(a instanceof Jb.ExternalNameExpression)e._unparseSource(a.source,b,d),d.content+="!",d.content+=a.name;else if(a instanceof Jb.ParenthesesExpression)d.content+="(",e._unparseExpression(a.argument,b,d),d.content+=")";else{if(!(a instanceof Jb.FunctionExpression))throw c.SR.Exp_NotSupport;d.content+=a.getFunctionName(),d.content+="(";for(var f=0;f<a.argCount();f++)0!==f&&(d.content+=e.listSeparator),e._unparseExpression(a.getArg(f),b,d);d.content+=")"}},a.prototype._unparseSource=function(a,b,c){b.getExternalSourceToken&&(c.content+=this._getValidSource(b.getExternalSourceToken(a),b.useR1C1))},a.prototype._unparseSource2=function(a,b,c,d){var e=this,f={content:""};e._unparseSource(a,c,f);var g=e._removeApostrophe(f),h=e._removeWorkbook(f),i=h.success,j=h.workBookName,k={content:""};e._unparseSource(b,c,k),g|=e._removeApostrophe(k),j=e._removeWorkbook(k).workBookName,g?(d.content+="'",i&&(d.content+=j),d.content+=f.content,d.content+=":",d.content+=k.content,d.content+="'"):(i&&(d.content+=j),d.content+=f.content,d.content+=":",d.content+=k.content)},a.prototype._getValidSource=function(a,b){if(a===bb||a===ab||""===a)return"";var c=this._readSheetReference(a,b,!0),d=a.length;return c.success?("'"===a.charAt(0)&&"'"===a.charAt(d-1)&&(a=a.substr(1,d-2),a=a.replace("'","''"),a="'"+a+"'"),a):(c=this._readSheetReference("'"+a+"'",b,!0),c.success?(a=a.replace("'","''"),a="'"+a+"'"):"")},a.prototype._unParseRefenceExpressions=function(a,b,d){var e=this,f=b.row,g=b.column;if(a instanceof Jb.BangCellExpression){d.content+="!";var h=a;e._unParseCell(b.useR1C1,f,g,h.row,h.column,h.rowRelative,h.columnRelative,d)}else if(a instanceof Jb.CellExpression){var i=a;e._unParseCell(b.useR1C1,f,g,i.row,i.column,i.rowRelative,i.columnRelative,d)}else if(a instanceof Jb.ExternalCellExpression){var j=a;e._unparseSource(j.source,b,d),d.content+="!",e._unParseCell(b.useR1C1,f,g,j.row,j.column,j.rowRelative,j.columnRelative,d)}else if(a instanceof Jb.BangRangeExpression){d.content+="!";var k=a;e._unParseRange(b.useR1C1,f,g,k.startRow,k.startColumn,k.endRow,k.endColumn,k.startRowRelative,k.startColumnRelative,k.endRowRelative,k.endColumnRelative,d,k._getRangeType())}else if(a instanceof Jb.RangeExpression){var l=a;e._unParseRange(b.useR1C1,f,g,l.startRow,l.startColumn,l.endRow,l.endColumn,l.startRowRelative,l.startColumnRelative,l.endRowRelative,l.endColumnRelative,d,l._getRangeType())}else if(a instanceof Jb.ExternalRangeExpression){var m=a;e._unparseSource(m.source,b,d),d.content+="!",e._unParseRange(b.useR1C1,f,g,m.startRow,m.startColumn,m.endRow,m.endColumn,m.startRowRelative,m.startColumnRelative,m.endRowRelative,m.endColumnRelative,d,m._getRangeType())}else if(a instanceof Jb.SheetRangeExpression){var n=a;e._unparseSource2(n.startSource,n.endSource,b,d),d.content+="!",e._unParseRange(b.useR1C1,f,g,n.startRow,n.startColumn,n.endRow,n.endColumn,n.startRowRelative,n.startColumnRelative,n.endRowRelative,n.endColumnRelative,d,n._getRangeType())}else{if(!(a instanceof Jb.StructReferenceExpression))throw c.SR.Exp_NotSupport;a.unParse(b,d)}},a.prototype._removeApostrophe=function(a){var b=a.content,c=b.length;return"'"===b.charAt(c-1)?(a.content=b.substr(1,c-2),!0):!1},a.prototype._removeWorkbook=function(a){if("["!==a.content.charAt(0))return{success:!1,workBookName:""};var b=a.content.indexOf("]"),c=a.content.substr(0,b+1);return a.content=a.content.substr(b),{success:!0,workBookName:c}},a.prototype._unParseCell=function(b,c,d,e,f,g,h,i,j){(j===bb||j===ab)&&(j=Hb.cell);var k=a.BAND_INDEX_CONST,l=a.maxRowCount-1;(j===Hb.cell||j===Hb.row)&&e!==k&&e>-l&&2*l>=e&&(e+=g?c:0,e=v(e,l));var m=a.maxColumnCount-1;if((j===Hb.cell||j===Hb.column)&&f!==k&&f>-m&&2*m>=f&&(f+=h?d:0,f=v(f,m)),this._isCellIndexsError(c,d,e,f,g,h,j))return void(i.content+=kb.toString());var n="",o="";if(b){if(n="R",e>=0&&(c!==e||!g)&&(g?n=n+"["+(e-c)+"]":(e++,n+=e)),0>f)return void(i.content+=n);if(o="C",d===f&&h||(h?o=o+"["+(f-d)+"]":(f++,o+=f)),g&&0>e||!g&&0>=e)return void(i.content+=o);i.content+=n,i.content+=o}else{if(e++,n=""+e,g||(n="$"+e),0>f)return void(i.content+=n);for(var p=f,q=1,r=_.length;r>q;q++){var s=_[r-q];f=parseInt(p/s,10),p%=s,0!==f&&(o+=String.fromCharCode(f+65-1))}if(o+=String.fromCharCode(p+65),h||(o="$"+o),0>=e)return void(i.content+=o);i.content+=o,i.content+=n}},a.prototype._isCellIndexsError=function(a,b,c,d,e,f,g){var h=!1;switch(g){case Hb.sheet:break;case Hb.cell:h|=0>c,h|=0>d;break;case Hb.row:h|=0>c;break;case Hb.column:h|=0>d}return h},a.prototype._unParseRange=function(b,c,d,e,f,g,h,i,j,k,l,m,n){(n===bb||n===ab)&&(n=Hb.cell),this._unParseCell(b,c,d,e,f,i,j,m,n);var o=a.BAND_INDEX_CONST;(!b||e!==g||f!==h||g!==o&&h!==o)&&(g!==o||h!==o)&&(m.content+=":",this._unParseCell(b,c,d,g,h,k,l,m,n))},a.prototype._unParseOperatorExpressions=function(a,b,d){var e=this;if(a instanceof Jb.UnaryOperatorExpression){var f=a.operator;f===Fb.percent?(e._unparseExpression(a.operand,b,d),d.content+=f.name):(d.content+=f.name,e._unparseExpression(a.operand,b,d))}else{if(!(a instanceof Jb.BinaryOperatorExpression))throw c.SR.Exp_NotSupport;var g={content:""},h={content:""};e._unparseExpression(a.right,b,h);var i=a.left instanceof Jb.BinaryOperatorExpression,j=a.right instanceof Jb.BinaryOperatorExpression,k=s(a.operator.name);i&&s(a.left.operator.name)>k?(g.content+="(",e._unparseExpression(a.left,b,g),g.content+=")"):e._unparseExpression(a.left,b,g),j&&s(a.right.operator.name)>k&&(h.content+="(",e._unparseExpression(a.right,b,h),h.content+="("),d.content+=g.content,d.content+=a.operator instanceof Fb.UnaryOperator?e.listSeparator:a.operator.name,d.content+=h.content}},a.prototype._unparseConstantExpression=function(b,d,e){var f=this,g=c.SR.Exp_InvalidArray;if(b instanceof Jb.StringExpression)e.content+='"',e.content+=b.value,e.content+='"';else if(b instanceof Jb.DoubleExpression)e.content+=b.originalValue;else if(b instanceof Jb.BooleanExpression)e.content+=b.value?N:O;else if(b instanceof Jb.ArrayExpression){e.content+="{";var h=b.value;if(h.getRowCount()<=0)throw g;for(var i=a.BAND_INDEX_CONST,j=i,k=0;k<h.getRowCount();k++){k>=1&&(e.content+=f.arrayGroupSeparator);for(var l=0;l<h.getColumnCount();l++){if(j!==i&&(j!==h.getColumnCount()||0===h.getColumnCount()))throw g;0!==l&&(e.content+=f._arrayArgumentSepatator);var m=h.getValue(k,l);if(m===bb||m===ab)throw g;m instanceof Jb.Expression?f._unparseExpression(m,d,e):typeof m===L?(e.content+='"',e.content+=m,e.content+='"'):e.content+=typeof m===M?m?N:O:m.toString()}}e.content+="}"}else if(b instanceof Jb.ExternalErrorExpression)f._unparseSource(b.source,d,e),e.content+="!",e.content+=b.value.toString();else if(b instanceof Jb.SheetRangeErrorExpression)f._unparseSource2(b.startSource,b.endSource,d,e),e.content+="!",e.content+=b.value.toString();else if(b instanceof Jb.BangErrorExpression)e.content+="!",e.content+=b.value.toString();else if(b instanceof Jb.ErrorExpression)e.content+=b.value.toString();else if(!(b instanceof Jb.MissingArgumentExpression))throw c.SR.Exp_NotSupport},a.prototype._parseToToken=function(a){for(var b,d=this,e=a.length,f=[],g=new Rb,h="",i=c.SR.AtIndexOn,k=0,m=0;e>m&&" "===a.charAt(m);)m++;"="===a.charAt(m)&&m++;for(var n=m;e>n;n++){var s,t=a.charAt(n);if('"'===t)s=p(a,n,'"','"'),f.push(new Qb(s.result,0,n,3)),n=s.endIndex,k=n+1;else if("'"===t)s=p(a,n,"'","'"),h+="'",h+=s.result,h+="'",n=s.endIndex;else if("["===t)s=q(a,n,"[","]","'"),h+=s.result,h+="]",n=s.endIndex;else{if("\r"===t||"\n"===t)continue;if("#"===t){var u=r(a,n),v=e>n?a.charAt(n+1):"\x00";n>0&&"!"===a.charAt(n-1)?h+=u.result:U===u.result.toUpperCase()&&e>n&&(l(v)||"$"===v)?h+=u.result:(f.push(new Qb(u.result,0,n,6)),k=n+1),n=u.endIndex}else if("+"===t||"-"===t){var w=0===f.length?null:f[f.length-1];if(0!==h.length)f.push(new Qb(h,0,k)),f.push(new Qb(t,5,n)),h="",k=n+1;else{if(w&&7===w.type){f.pop();var w=f[f.length-1]}w&&(1===w.type&&2===w.subType||2===w.type&&2===w.subType||6===w.type||0===w.type)?(f.push(new Qb(t,5,n)),k=n+1):(f.push(new Qb(t,4,n)),k=n+1)}}else if(t===d.numberDecimalSeparator||j(t)){var x;if(h.length>0)h+=t;else if((x=o(a,n,d.numberDecimalSeparator)).result){for(var y=x.endIndex,z=a.slice(n,y+1);e-2>=y&&" "===a.charAt(y+1);)y++;e-2>=y&&":"===a.charAt(y+1)?(h+=z,h+=":",y++):f.push(new Qb(z,0,n,4)),k=n+1,n=y}else h+=t}else if("{"===t){if(h.length>0)throw c.SR.Exp_FormulaInvalid+c.SR.SingleQuote+"{"+i+n+c.SR.FullStop;b=new Qb(P,1,n,1),f.push(b),g.push(b),b=new Qb(Q,1,n,1),f.push(b),g.push(b),k=n+1}else if(t!==d.arrayGroupSeparator||!g.current()||g.current().value!==P&&g.current().value!==Q)if("}"===t){if(h.length>0&&(f.push(new Qb(h,0,k)),h=""),!g.current())throw c.SR.Exp_FormulaInvalid+c.SR.SingleQuote+t+i+n+c.SR.FullStop;f.push(g.pop()),f.push(g.pop()),k=n+1}else if(" "===t){var A=n;for(n++;e>n&&" "===h.charAt(h.length-1);)n++;h.length>0&&":"!==h.charAt(h.length-1)&&e>n&&":"!==a.charAt(n)&&(f.push(new Qb(h,0,k)),h="",f.push(new Qb("",7,A)),k=n),n--}else if(e>=n+2&&"<"===t&&"="===a.charAt(n+1)||">"===t&&"="===a.charAt(n+1)||"<"===t&&">"===a.charAt(n+1))h.length>0&&(f.push(new Qb(h,0,k)),h=""),f.push(new Qb(a.slice(n,n+2),5,n,5)),n++,k=n+1;else if("%"===t)h.length>0&&(f.push(new Qb(h,0,k)),h=""),f.push(new Qb(a.charAt(n),6,n)),k=n+1;else if("+"===t||"-"===t||"*"===t||"/"===t||"="===t||">"===t||"<"===t||"&"===t||"^"===t)h.length>0&&(f.push(new Qb(h,0,k)),h=""),f.push(new Qb(t,5,n)),k=n+1;else if("("===t){if(h.length>0){var B=h.charAt(h.length-1);if(":"===B||B===d.listSeparator||" "===B)h=h.slice(0,h.length-1),f.push(new Qb(h,0,k,7)),f.push(new Qb(B,5,n-1,0)),b=new Qb("",2,n,1),f.push(b),g.push(b);else{var C=h.indexOf(":"),D=":";-1===C&&(C=h.indexOf(d.listSeparator),D=d.listSeparator),-1===C&&(C=h.indexOf(" "),D=" "),-1!==C&&C>0?(f.push(new Qb(h.substr(0,C),0,k,7)),f.push(new Qb(D,5,C,0)),h=h.slice(C+1),b=new Qb(h.toUpperCase(),1,n,1),f.push(b),g.push(b)):(b=new Qb(h.toUpperCase(),1,n,1),f.push(b),g.push(b))}h=""}else b=new Qb("",2,n,1),f.push(b),g.push(b);k=n+1}else if(t===d.listSeparator||t===d.arrayGroupSeparator)h.length>0&&(f.push(new Qb(h,0,k)),h=""),f.push(g.current()&&1===g.current().type?new Qb(d._arrayArgumentSepatator,3,n):new Qb(d.listSeparator,5,n,10)),k=n+1;else if(")"===t){if(h.length>0&&(f.push(new Qb(h,0,k)),h=""),!g.current())throw c.SR.Exp_FormulaInvalid+c.SR.SingleQuote+t+i+n+c.SR.FullStop;f.push(g.pop()),k=n+1}else":"===t?0===h.length&&2===f[f.length-1].subType?(f.push(new Qb(":",5,n,11)),k=n+1):h+=":":h+=t;else{if(h.length>0&&(f.push(new Qb(h,0,k)),h=""),!g.current())throw c.SR.Exp_FormulaInvalid+c.SR.SingleQuote+t+i+n+c.SR.FullStop;f.push(g.pop()),f.push(new Qb(d.listSeparator,3,n)),b=new Qb(Q,1,n+1,1),f.push(b),g.push(b),k=n+1}}}return h.length>0&&f.push(new Qb(h,0,k)),d._processTokens(f)},a.prototype._processTokens=function(a){var b=this._removeWhiteSpace(a),d=[],e=new Qb("",8,0,1);d.push(e);for(var f,g=b.length,h=0;g>h;h++){var i=b[h];if(i){var j=0===h?ab:b[h-1],k=h===g-1?ab:b[h+1];if(0===i.type&&0===i.subType){var l=i.value.toUpperCase();l===N||l===O?(i.subType=5,i.value=l):i.subType=7}else 1===i.type&&i.value.length>0&&"@"===i.value.charAt(0)&&(i.value=i.value.substr(1));if(0===d.length)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;if(f=d[d.length-1],f.value===Q&&3!==i.type&&6!==i.subType&&2!==i.subType&&5!==i.subType&&4!==i.subType&&3!==i.subType&&4!==i.type)throw c.SR.Exp_InvalidArrayAt+i.index+c.SR.FullStop;switch(i.type){case 0:if(j&&(0===j.type||6===j.type||1===j.type&&2===j.subType||2===j.type&&2===j.subType))throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;break;case 1:case 2:if(i.value===P&&1===i.type&&1===i.subType&&!j)break;if(2===i.subType&&(!j||4===j.type||5===j.type)||1===i.subType&&j&&(!k||6===j.type||2===j.subType))throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;if(2===i.subType&&2===i.type&&1===j.subType)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;if(2===i.subType&&1===i.type&&2===j.type&&1===j.subType)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;break;case 3:if(!k||!j||5===j.type||4===j.type)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;break;case 4:if(!k||j&&6===j.type)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;break;case 5:if(!k||!j||5===j.type||4===j.type||3===j.type||1===j.type&&1===j.subType||2===j.type&&1===j.subType)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;break;case 6:if(!j||4===j.type||5===j.type||1===j.type&&1===j.subType||2===j.type&&1===j.subType)throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop;break;default:throw c.SR.Exp_InvalidTokenAt+i.index+c.SR.FullStop}if(1===i.subType)d.push(i),f.children.push(i);else if(2===i.subType){if(0===d.length){var m;throw m=i.value===P||i.value===Q?"}":")",c.SR.Exp_FormulaInvalid+c.SR.SingleQuote+m+c.SR.SingleQuoteAt+i.index+c.SR.FullStop}d.pop()}else f.children.push(i)}}return e.children},a.prototype._removeWhiteSpace=function(a){for(var b=[],c=a.length,d=0;c>d;d++){var e=a[d];if(e)if(7===e.type){var f=0==d?ab:a[d-1],g=d==c-1?ab:a[d+1];f&&g&&(1===f.type&&2===f.subType||2===f.type&&2===f.subType||0===f.type)&&(1===g.type&&1===g.subType||2===g.type&&1===g.subType||0===g.type)&&b.push(new Qb(" ",5,e.index,9))}else b.push(e)}return b},a.prototype._buildExpressionNode=function(a,b){var c,d=this;return 1===b.type?c=b.value===P?d._buildArraryExpression(a,b):d._buildFunctionExpression(a,b):2===b.type?c=d._buildSubExpression(a,b):0===b.type&&(4===b.subType?c=new Jb.DoubleExpression(parseFloat(b.value),b.value):6===b.subType?c=new Jb.ErrorExpression(gb.parse(b.value)):5===b.subType?f(b.value,N)?c=new Jb.BooleanExpression(!0):f(b.value,O)&&(c=new Jb.BooleanExpression(!1)):c=7===b.subType?d._buildCellReferenceOrNameExpressions(a,b.value,b.index):new Jb.StringExpression(b.value)),c},a.prototype._buildExpressionTree=function(a,b){var c,d,e,f,g=this._parseToBinaryOperatorList(a,b);for(f=3;f<g.length;){var h=g[f],i=g[f-2];if(h&&5===h.type){for(;f>=3&&s(h.value)>=s(i.value);)d=g[f-3],e=g[f-1],c=new Jb.BinaryOperatorExpression(t(i),d,e),g.splice(f-3,1),g.splice(f-3,1),g.splice(f-3,1),g.splice(f-3,0,c),f-=2,f>=3&&(i=g[f-2]);f+=2}else f++}if(1===g.length)return g[0];for(f=g.length-2;f>0;f-=2)d=g[f-1],e=g[f+1],c=new Jb.BinaryOperatorExpression(t(g[f]),d,e),g.splice(f-1,1),g.splice(f-1,1),g.splice(f-1,1),g.push(c);return c},a.prototype._parseToBinaryOperatorList=function(a,b){for(var c,d=[],e=0;e<b.length;e++){var f=b[e];if(4===f.type){for(var g=[];4===f.type;)g.push("+"===f.value?Fb.plus:Fb.negate),e++,f=b[e];var h=b[e];for(c=new Jb.UnaryOperatorExpression(g.pop(),this._buildExpressionNode(a,h));g.length>0;)c=new Jb.UnaryOperatorExpression(g.pop(),c);d.push(c)}else if(6===f.type){var i=d[d.length-1];c=new Jb.UnaryOperatorExpression(Fb.percent,i),d.pop(),d.push(c)}else 5===f.type?d.push(f):(c=this._buildExpressionNode(a,f),d.push(c))}return d},a.prototype._buildFunctionExpression=function(a,b){for(var d=[],e=[],f=0;f<b.children.length;f++){var g=b.children[f];3!==g.type?e.push(g):0===e.length?d.push(new Jb.MissingArgumentExpression):(d.push(this._buildExpressionTree(a,e)),e=[])}0!==e.length?d.push(this._buildExpressionTree(a,e)):0!==b.children.length&&d.push(new Jb.MissingArgumentExpression);var h=Gb.findGlobalFunction(b.value);if(h){var i=d.length;if(i<h.minArgs||i>h.maxArgs)throw c.SR.Exp_InvalidParameters+b.index+c.SR.FullStop;return new Jb.FunctionExpression(h,d)}return new Jb.FunctionExpression(b.value,d)},a.prototype._buildSubExpression=function(a,b){return new Jb.ParenthesesExpression(this._buildExpressionTree(a,b.children))},a.prototype._buildArraryExpression=function(a,b){for(var e,f=[],g=-1,h=b.children,i=h.length,j=0;i>j;j++){e=h[j];var k=0===j?ab:h[j-1];if(3!==e.type){if(k&&3!==k.type)throw c.SR.Exp_InvalidArrayAt+e.index+c.SR.FullStop;if(1!==e.type||e.value!==Q)throw c.SR.Exp_InvalidArrayAt+e.index+c.SR.FullStop;if(-1!==g&&e.children.length!==g)throw c.SR.Exp_InvalidArrayColumns+e.index+c.SR.FullStop;g=e.children.length;var l=[];f.push(l);for(var m=e.children,n=m.length,o=ab,p=0;n>p;p++){var q=m[p];if(3===q.type)o&&3!==o.type&&p!==n-1||l.push(d.missingArgument);else{if(o&&3!==o.type)throw c.SR.Exp_InvalidArrayAt+e.index;var r;if(4===q.type){if(p+1>=n)throw c.SR.Exp_InvalidArrayAt+e.index;r=m[p+1],r.value=""+q.value+r.value,q=r,p++}else n>p+1&&6===m[p+1].type&&(r=m[p+1],q.value=""+q.value+r.value,p++);var s=this._buildExpressionNode(a,q);s&&l.push(s.value)}o=q}}else if(!k||3===k.type||j===i-1)throw c.SR.Exp_InvalidArrayAt+e.index+c.SR.FullStop}if(0===f.length||f[0]===bb||f[0]===ab||0===f[0].length)throw c.SR.Exp_InvalidArrayAt+e.index;return new Jb.ArrayExpression(f)},a.prototype._buildCellReferenceOrNameExpressions=function(a,b,d){var e=this._buildCellReferenceOrNameExpressions2(a,b,d),f=e.endIndex,g=e.expression,h=b.length;if(!g)throw c.SR.Exp_InvalidCellReference+d+c.SR.FullStop;if(0>=f||f>=h)return g;if(":"!==b.charAt(f))throw c.SR.Exp_InvalidCellReference+d+c.SR.FullStop;f++;var i=[];for(i.push(g);f>0&&h>f;){var j=f;if(e=this._buildCellReferenceOrNameExpressions2(a,b.substr(f),d),f=e.endIndex,g=e.expression,!g)throw c.SR.Exp_InvalidCellReference+d+c.SR.FullStop;if(i.push(g),f+=j,h>f&&":"!==b.charAt(f))throw c.SR.Exp_InvalidCellReference+d+c.SR.FullStop;f++}g=i[0];for(var k=1;k<i.length;k++)g=new Jb.BinaryOperatorExpression(Fb.range,g,i[k]);return g},a.prototype._buildCellReferenceOrNameExpressions2=function(a,b,c){var e=this;if(b===bb||b===ab||""===b)return{endIndex:0,expression:ab};var f=b.length;if(b.length>=5&&"#REF!"===b.substr(0,5))return{endIndex:f,expression:new Jb.ErrorExpression(kb)};var g="!"===b.charAt(0),h=g?1:0;if(1>f)return{endIndex:0,expression:ab};var i=-1,j="",k=0;if(g)i=h;else if("'"===b.charAt(0))i=b.indexOf("!")+1,j=b.substr(0,i-1);else{var l=b.indexOf("!"),m=b.indexOf(":");if(-1!==l){var n=b.substr(h,l-h);if(0>m||m>l)f-1>l&&(j=n,i=l+1);else{var o=e._parseToCellReference(a,n,g);if(o.expression)return o;f-1>l&&(j=n,i=l+1),k=o.endIndex}}}var p="",r="",s="";if(-1!==i&&j&&""!==j){var t=e._readSheetReference(j,a.useR1C1,!1);if(!t.success)return{endIndex:k,expression:ab};p=t.workBookName,r=t.startSheetName,s=t.endSheetName}else i=h;var u,v,w,x=!1;if((p&&""!==p||r&&""!==r)&&(x=!0,a.getExternalSource&&(v=a.getExternalSource(p,r),!v)))return{endIndex:k,expression:new Jb.ErrorExpression(kb)};if(s&&""!==s&&(x=!0,a.getExternalSource&&(w=a.getExternalSource(p,s),!w)))return{endIndex:k,expression:new Jb.ErrorExpression(kb)};var y=b.substr(i),z=e._parseToCellReference(a,y,g,v,w),A=z.expression;if(k=z.endIndex,A){if(!(!x||A instanceof Jb.SheetRangeExpression||A instanceof Jb.ExternalReferenceExpression||A instanceof Jb.ExternalErrorExpression||A instanceof Jb.SheetRangeErrorExpression||A instanceof Jb.ExternalNameExpression))return{endIndex:f,expression:new Jb.ErrorExpression(kb)};
if(k<y.length-1){if(k=f-(y.length-k),":"!==b.charAt(k)){if(r&&""!==r){if(s&&""!==s)return{endIndex:k,expression:ab};if(!a.getExternalSource)return{endIndex:k,expression:new Jb.ErrorExpression(kb)};if(u=a.getExternalSource(p,r),!u)return{endIndex:k,expression:new Jb.ErrorExpression(kb)};A=new Jb.ExternalNameExpression(u,y)}else A=new Jb.NameExpression(y);k=f}}else k=f}else{for(var B,m=-1,C=0;C<b.length;C++)if(B=b[C],"["===B){var D=q(b,C,"[","]","'");C=D.endIndex}else if(":"===B){m=C;break}if(g)A=new Jb.BangNameExpression(y);else if(r&&""!==r){if(s&&""!==s)return{endIndex:k,expression:ab};if(!a.getExternalSource)return{endIndex:k,expression:new Jb.ErrorExpression(kb)};if(u=a.getExternalSource(p,r),!u)return{endIndex:k,expression:new Jb.ErrorExpression(kb)};A=new Jb.ExternalNameExpression(u,y)}else if(m>0){var E=b.substr(0,m);A=e._validateName(E)?new d.Expressions.BinaryOperatorExpression(d.Operators.range,new d.Expressions.NameExpression(E),e._buildCellReferenceOrNameExpressions(a,b.substr(m+1),c+m+1)):ab}else A=new Jb.NameExpression(y);k=f}if(A instanceof Jb.NameExpression||A instanceof Jb.ExternalNameExpression){var F=e._createStructExpression(a,y,c);if(F)A=F;else if(!e._validateName(y))return{endIndex:k,expression:ab}}return{endIndex:k,expression:A}},a.prototype._parseToCellReference=function(b,c,d,e,f){var g=this,h=0;if("#"===c.charAt(0)){var i=r(c,0);h=i.endIndex+1;var j=gb.parse(i.result);if(j)return{endIndex:h,expression:g._createExternalErrorExpression(j,d,e,f)}}var k=b.useR1C1?g._isR1C1CellReferance(c,b.row,b.column):g._isA1CellReferance(c),l=a.BAND_INDEX_CONST;if(k.success&&b.useR1C1&&k.startRow!==l&&k.startColumn===l&&k.endRow===l&&k.endColumn===l)k.endRow=k.startRow,k.endRowRelative=k.startRowRelative;else if(k.success&&b.useR1C1&&k.startColumn!==l&&k.startRow===l&&k.endRow===l&&k.endColumn===l)k.endColumn=k.startColumn,k.endColumnRelative=k.startColumnRelative;else if(!k.success||k.startRow===l&&(k.startColumn===l||k.endColumn===l)||k.startColumn===l&&k.endRow===l)return{endIndex:k.endIndex,expression:ab};var m=g._createCellReferenceExpression(b,b.row,b.column,k.startRow,k.startColumn,k.endRow,k.endColumn,k.startRowRelative,k.startColumnRelative,k.endRowRelative,k.endColumnRelative,d,e,f);return{endIndex:k.endIndex,expression:m}},a.prototype._createExternalErrorExpression=function(a,b,c,d){return b?new Jb.BangErrorExpression(a):c&&d?new Jb.SheetRangeErrorExpression(c,d,a):c?new Jb.ExternalErrorExpression(c,a):new Jb.ErrorExpression(a)},a.prototype._createCellReferenceExpression=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q=a.BAND_INDEX_CONST;if(e!==q&&g!=q&&e>g){var r=e;e=g,g=r;var s=i;i=k,k=s}if(f!==q&&h!=q&&f>h){var r=f;f=h,h=r;var s=j;j=l,l=s}return e-=e!==q&&i?c:0,f-=f!=q&&j?d:0,g-=g!==q&&k?c:0,h-=h!==q&&l?d:0,n&&o?(p=new Jb.SheetRangeExpression(n,o),e===q?p.initBand(n,o,f,h,j,l,!1):f===q?p.initBand(n,o,e,g,i,k,!0):p.init(n,o,e,f,g,h,i,j,k,l),p):g===q&&h===q?m?n||o?ab:new Jb.BangCellExpression(e,f,i,j):n?new Jb.ExternalCellExpression(n,e,f,i,j):new Jb.CellExpression(e,f,i,j):m?n&&o?ab:(p=new Jb.BangRangeExpression,e===q?p.initBand(f,h,j,l,!1):f===q?p.initBand(e,g,i,k,!0):p.init(e,f,g,h,i,j,k,l),p):n?(p=new Jb.ExternalRangeExpression,e===q?p.initBand(n,f,h,j,l,!1):f===q?p.initBand(n,e,g,i,k,!0):p.init(n,e,f,g,h,i,j,k,l),p):(p=new Jb.RangeExpression,e===q?p.initBand(f,h,j,l,!1):f===q?p.initBand(e,g,i,k,!0):p.init(e,f,g,h,i,j,k,l),p)},a.prototype._readSheetReference=function(a,b,c){var d={success:!1,startSheetName:"",endSheetName:"",workBookName:""},e=!1,f=a.length;"'"===a.charAt(0)&&"'"===a.charAt(f-1)&&(e=!0,a=a.substr(1,f-2));var g=a.indexOf("[");if(-1!==g){0!==g&&(d.workBookName=a.substr(0,g),"\\"!==d.workBookName.charAt(g-1)&&(d.workBookName=d.workBookName+"\\"));var h=p(a,g,"[","]");d.workBookName=d.workBookName+h.result,a=a.substr(h.endIndex+1)}var i=a.indexOf(":");if(-1===i?d.startSheetName=a:(d.startSheetName=a.substr(0,i),d.endSheetName=a.substr(i+1)),!d.startSheetName||""===d.startSheetName)return d.success=!1,d;var j=this,k=j._validateWorkbook(d.workBookName,e);return k=j._validateSheetName(d.startSheetName,b,e),k&=j._validateSheetName(d.endSheetName,b,e),c&&(d.startSheetName&&(d.startSheetName=d.startSheetName.replace("'","''")),d.endSheetName&&(d.endSheetName=d.endSheetName.replace("'","''"))),d.success=k,d},a.prototype._isStartWithCellReference=function(a,b){return b?this._isR1C1CellReferance(a):this._isA1CellReferance(a)},a.prototype._isA1CellReferance=function(b){var c=this,d=a.BAND_INDEX_CONST,e={startRow:d,startColumn:d,endRow:d,endColumn:d,startRowRelative:!0,startColumnRelative:!0,endRowRelative:!0,endColumnRelative:!0,success:!1,endIndex:0};b=b.replace(" ","");var f=b.length,g=c._readOneA1Element(b,0);if(e.endIndex=g.endIndex,!g.success||e.endIndex>f)return e;var h;if(g.isRow)return e.startRow=g.elementIndex,e.startRowRelative=g.isRelative,":"===b.charAt(e.endIndex)?(e.endIndex++,h=c._readOneA1Element(b,e.endIndex),e.endIndex=h.endIndex,h.success&&h.isRow?(e.endRow=h.elementIndex,e.endRowRelative=h.isRelative,e.success=!0,e):e):e;if(e.startColumn=g.elementIndex,e.startColumnRelative=g.isRelative,":"===b.charAt(e.endIndex))return e.endIndex++,h=c._readOneA1Element(b,e.endIndex),e.endIndex=h.endIndex,!h.success||h.isRow?e:(e.endColumn=h.elementIndex,e.endColumnRelative=h.isRelative,e.success=!0,e);if(n(b.charAt(e.endIndex))||"$"===b.charAt(e.endIndex)){if(h=c._readOneA1Element(b,e.endIndex),e.endIndex=h.endIndex,!h.success||!h.isRow)return e;e.startRow=h.elementIndex,e.startRowRelative=h.isRelative;var i=e.endIndex;if(e.endIndex<f-1&&":"===b.charAt(e.endIndex)){if("'"===b.charAt(e.endIndex+1))return e.success=!0,e;var j=b.indexOf("!",e.endIndex+1),k=b.indexOf(":",e.endIndex+1);if(-1!==j&&(-1===k||k>j))return e.success=!0,e;e.endIndex++;var l=c._readOneA1Element(b,e.endIndex);if(!l.success||l.isRow)return e.endIndex=i,e.success=!0,e;e.endIndex=l.endIndex,e.endColumn=l.elementIndex,e.endColumnRelative=l.isRelative;var m=c._readOneA1Element(b,e.endIndex);return m.success&&m.isRow?(e.endIndex=m.endIndex,e.endRow=m.elementIndex,e.endRowRelative=m.isRelative,e.success=!0,e):(e.endIndex=i,e.endColumn=d,e.success=!0,e)}return e.success=!0,e}return e},a.prototype._isR1C1CellReferance=function(b,c,d){var e=this,f=a.BAND_INDEX_CONST,g={startRow:f,startColumn:f,endRow:f,endColumn:f,startRowRelative:!0,startColumnRelative:!0,endRowRelative:!0,endColumnRelative:!0,success:!1,endIndex:0};b=b.replace(" ","");var h=b.length,i=e._readOneR1C1Element(b,c,d,0);if(g.endIndex=i.endIndex,!i.success)return g;var j;if(!i.isRow)return g.startColumn=i.elementIndex,g.startColumnRelative=i.isRelative,g.endIndex>=h?(g.success=!0,g):":"===b.charAt(g.endIndex)?(g.endIndex++,j=e._readOneR1C1Element(b,c,d,g.endIndex),g.endIndex=j.endIndex,!j.success||j.isRow?g:(g.endColumn=j.elementIndex,g.endColumnRelative=j.isRelative,g.success=!0,g)):g;if(g.startRow=i.elementIndex,g.startRowRelative=i.isRelative,g.endIndex>=h)return g.success=!0,g;if(":"===b.charAt(g.endIndex))return g.endIndex++,j=e._readOneR1C1Element(b,c,d,g.endIndex),g.endIndex=j.endIndex,j.success&&j.isRow?(g.endRow=j.elementIndex,g.endRowRelative=j.isRelative,g.success=!0,g):g;if("C"===b.charAt(g.endIndex)||"c"===b.charAt(g.endIndex)){if(j=e._readOneR1C1Element(b,c,d,g.endIndex),g.endIndex=j.endIndex,!j.success||j.isRow)return g;g.startColumn=j.elementIndex,g.startColumnRelative=j.isRelative;var k=g.endIndex;if(g.endIndex<h-1&&":"===b.charAt(g.endIndex)){if("'"===b.charAt(g.endIndex+1))return g.success=!0,g;var l=b.indexOf("!",g.endIndex+1),m=b.indexOf(":",g.endIndex+1);if(-1!==l&&(-1===m||m>l))return g.success=!0,g;g.endIndex++;var n=e._readOneR1C1Element(b,c,d,g.endIndex);if(!n.success||!n.isRow)return g.endIndex=k,g.success=!0,g;g.endIndex=n.endIndex,g.endRow=n.elementIndex,g.endRowRelative=n.isRelative;var o=e._readOneR1C1Element(b,c,d,g.endIndex);return!o.success||o.isRow?(g.endIndex=k,g.success=!0,g):(g.endIndex=o.endIndex,g.endColumn=o.elementIndex,g.endColumnRelative=o.isRelative,g.success=!0,g)}return g.success=!0,g}return g},a.prototype._readOneA1Element=function(b,c){var d=a.BAND_INDEX_CONST,e={endIndex:c,elementIndex:d,isRow:!0,isRelative:!0,success:!1},f=b.length;if(c>=f)return e;if("$"===b.charAt(c)&&(e.isRelative=!1,c++),c>=f)return e;var g,h=c,i=b.charAt(h);if(n(i)&&"0"!==i){for(e.isRow=!0;f>h&&n(i);)h++,f>h&&(i=b.charAt(h));if(g=parseInt(b.substr(c,h-c),10),g>=1&&g<=a.maxRowCount)return e.elementIndex=g-1,e.endIndex=h,e.success=!0,e}else if(k(i)){for(e.isRow=!1;f>h&&k(i);)h++,f>h&&(i=b.charAt(h));var j=b.substr(c,h-c);if(j.length>3)return e;j=j.toUpperCase(),g=0;for(var l=j.length-1;l>=0;l--)g+=(j.charCodeAt(l)-65+1)*_[j.length-l-1];if(g<=a.maxColumnCount)return e.elementIndex=g-1,e.endIndex=h,e.success=!0,e}return e},a.prototype._readOneR1C1Element=function(b,c,d,e){var f=a.BAND_INDEX_CONST,g={endIndex:e,elementIndex:f,isRow:!0,isRelative:!1,success:!1},h=b.length;if(e>=h)return g;var i,j=e,k=b.charAt(j);if("R"===k||"r"===k)g.isRow=!0,i=c;else{if("C"!==k&&"c"!==k)return g;g.isRow=!1,i=d}if(e++,j++,e>=h)return g.endIndex=e,g.elementIndex=i,g.isRelative=!0,g.success=!0,g;if(k=b.charAt(j),"["===k&&(e++,j++,g.isRelative=!0),e>=h)return g;var l=!1;if(k=b.charAt(j),g.isRelative&&"-"===k&&(e++,j++,l=!0),e>=h)return g;if(k=b.charAt(j),!n(k))return g.isRelative?g:(g.endIndex=e,g.elementIndex=i,g.isRelative=!0,g.success=!0,g);for(;h>j&&n(k);)j++,h>j&&(k=b.charAt(j));var m=parseInt(b.substr(e,j-e),10);if(g.isRelative){if(j>=h||"]"!==b.charAt(j))return g;j++}return m<(g.isRow?a.maxRowCount:a.maxColumnCount)?(g.isRelative?(m=l?-m:m,g.elementIndex=m+i):g.elementIndex=m-1,g.endIndex=j,g.success=!0,g):void 0},a.prototype._validateWorkbook=function(a,b){if(a===bb||a===ab||""===a)return!0;for(var c,d=0;d<a.length;d++)if(c=a[d],b){if("*"===c||":"===c||"["===c||"]"===c||"?"===c)return!1;if("'"===c&&(0===d||d>=a.length-1||"'"!==a.charAt(d+1)))return!1}else if("'"===c||"["===c||"]"===c||"?"===c||"%"===c||-1!==this._operatorInfix.indexOf(c))return!1;return!0},a.prototype._validateSheetName=function(a,b,c){if(a===bb||a===ab||""===a)return!0;if(!c&&j(a.charAt(0)))return!1;var d=this._isStartWithCellReference(a,b);if(!c&&d.success&&d.endIndex===a.length)return!1;for(var e,f=0;f<a.length;f++)if(e=a.charAt(f),c){if("*"===e||":"===e||"["===e||"]"===e||"?"===e||"\\"===e||"/"===e)return!1}else if("'"===e||"["===e||"]"===e||"?"===e||"\\"===e||"%"===e||'"'===e||-1!==this._operatorInfix.indexOf(e))return!1;return!0},a.prototype._createStructExpression=function(a,b,d){if("]"===b.charAt(b.length-1))try{return new Jb.StructReferenceExpression(b,a)}catch(e){throw c.SR.Exp_FormulaInvalid+c.SR.SingleQuote+"{"+c.SR.AtIndexOn+d+c.SR.FullStop}else{var f=a.getTableByName(b);if(f)return Jb.StructReferenceExpression.create(f)}return ab},a.prototype._validateName=function(a){if(a===bb||a===ab||""===a)return!1;var b=a.length;if(1===b&&("R"===a||"r"===a||"C"===a||"c"===a))return!1;var c=a.charAt(0);if("_"!==c&&"\\"!==c&&!k(c)&&!m(c))return!1;for(var d=1;b>d;d++)if(c=a.charAt(d),"_"!==c&&"\\"!==c&&"?"!==c&&"."!==c&&!l(c)&&!m(c))return!1;return!0},a.BAND_INDEX_CONST=-2147483648,a.maxRowCount=1048576,a.maxColumnCount=16384,a._isLetter=k,a._isLetterOrDigit=l,a}();d.Parser=Tb;var Ub=function(){function a(a,b,c,d,e,f,g,h){this._expandArrayToMultiCallCount=0;var i=this,j=arguments.length;i.source=a,i.arrayFormulaMode=j>=2?b:!1,i.row=j>=3?c:0,i.column=j>=4?d:0,i.rowCount=j>=5?e:1,i.columnCount=j>=6?f:1,i.activeRow=j>=7?g:i.row,i.activeColumn=j>=8?h:i.column,i.rowOffset=7>j?i.row:i.activeRow-i.row,i.columnOffset=8>j?i.column:i.activeColumn-i.column}return a.prototype.getValue=function(a,b,c){return a?a.getValue(b,c):kb},a.prototype.getReference=function(a,b,c,d,e){return a?a.getReference(b,c,d,e):kb},a.prototype.getFunction=function(a){var b=this;return b.source&&b.source.getFunction?b.source.getFunction(a):ab},a.prototype.getName=function(a){var b=this;return b.source&&b.source.getName?b.source.getName(a,b.row,b.column):ab},a.prototype._isExpandArrayToMultiCall=function(){return this._expandArrayToMultiCallCount>0},a.prototype._beginExpandArrayToMultiCall=function(){this._expandArrayToMultiCallCount++},a.prototype._endExpandArrayToMultiCall=function(){this._expandArrayToMultiCallCount--},a.prototype._offset=function(b,c){var d=this;return new a(d.source,d.arrayFormulaMode,d.row+b,d.column+c,d.rowCount,d.columnCount,d.rowOffset,d.columnOffset)},a}();d.EvaluateContext=Ub;var Vb=new Tb,Wb=function(){function a(){}return a.prototype.evaluateFormula=function(a,b,c){return this.evaluateExpression(Vb.parse(a,b),c)},a.prototype.evaluateExpression=function(a,b,c){var d=this._evaluate(a,b,!1,!1);return c&&(d===bb||d===ab)?0:d},a.prototype._evaluate=function(a,b,d,e){if(!a)throw c.SR.Exp_ExprIsNull;for(;a instanceof Jb.ParenthesesExpression;)a=a.argument;var f,g=this,h=ab;if(a instanceof Jb.ExpandExpression){var i=a;a=i.expr,h=i.needExpendIndexs}if(a instanceof Jb.ConstantExpression)f=g._evaluateConst(a,b,d);else if(a instanceof Jb.ReferenceExpression)f=g._evaluateReference(a,b,e);else if(a instanceof Jb.ExternalNameExpression){var j,k=ab;(j=a.source.getCalcService())&&(k=j._getEvaluatorContext4Cell(a.source._sheet,b.row,b.column,b.arrayFormulaMode)),k||(f=lb),f=g._evaluateName(a.name,k,b,d,e)}else a instanceof Jb.NameExpression?f=g._evaluateName(a.name,b,b,d,e):a instanceof Jb.UnaryOperatorExpression?f=g._evaluateUnaryOperation(a,b,d,e,h):a instanceof Jb.BinaryOperatorExpression?f=g._evaluateBinaryOperation(a,b,d,e,h):a instanceof Jb.FunctionExpression&&(f=g._evaluateFunction(a,b,d,e,h));return f},a.prototype._evaluateConst=function(a,b,c){var d=a.value;return d instanceof pb?c||b&&(b.arrayFormulaMode||b._isExpandArrayToMultiCall())?d:Db.getArrayValue(d,0,0):d},a.prototype._evaluateReference=function(a,b,c){if(!b)return jb;var d=b.source;a instanceof Jb.ExternalReferenceExpression?d=a.source:a instanceof Jb.StructReferenceExpression&&(d=a.source());var e=b.row,f=b.column,g=a.getRange(e,f);if(!g)return kb;if(c||b.arrayFormulaMode)return b.getReference(d,g.row,g.column,g.rowCount,g.columnCount);var h=g.row,i=g.column;if(g.rowCount>1||g.columnCount>1){var j=b.row>=g.row&&b.row<g.row+g.rowCount,k=b.column>=g.column&&b.column<g.column+g.columnCount;if(!j&&!k)return jb;if(j&&!k&&1===g.columnCount)h=b.row;else if(!j&&k&&1===g.rowCount)i=b.column;else{if(1!==g.rowCount&&1!==g.columnCount)return jb;h=b.row,i=b.column}}else if(-1===g.row&&-1===g.rowCount){if(1!==g.columnCount)return jb;h=b.row}else if(-1===g.column&&-1===g.columnCount){if(1!==g.rowCount)return jb;i=b.column}return b.getValue(d,h,i)},a.prototype._evaluateName=function(a,b,c,d,e){if(!b||!c)return lb;var f=b.getName(a);return f?this._evaluate(f,c,d,e):lb},a.prototype._evaluateOperationArg=function(a,b,c,e){var f=this._evaluate(a,b,c,e);return f instanceof gb?f:f===d.missingArgument?mb:f},a.prototype._evaluateUnaryOperation=function(a,b,c,e,f){var g=!1;f!=ab&&f.length>0&&(c=!0,g=!0);var h=this._evaluate(a.operand,b,c,g);return h instanceof d.Error?h:h===d.missingArgument?mb:this._evaluateWithArgs(a,function(c){return a.operator.evaluate(c[0],b)},b,f,[h],c,e)},a.prototype._evaluateBinaryOperation=function(a,b,c,e,f){var g=[c,c],h=[a.operator.acceptsReference,a.operator.acceptsReference];if(f!=ab&&f.length>0)for(var i=0;i<f.length;i++)g[f[i]]=!0,h[f[i]]=!0;for(var j=[a.left,a.right],k=[],i=0;2>i;i++){var l=this._evaluate(j[i],b,g[i],h[i]);if(l instanceof d.Error)return l;if(l===d.missingArgument)return mb;k[i]=l}return this._evaluateWithArgs(a,function(c){return a.operator.evaluate(c[0],c[1],b)},b,f,k,c,e)},a.prototype._evaluateFunction=function(a,b,c,e,f){if(!a||!a.fn||"string"==typeof a.fn)return lb;var g,h=a.argCount(),i=a.fn,j=ab;if(0===h)g=[];else{g=[];for(var k=[],l=[],m=0;h>m;m++)k[m]=i.acceptsArray(m),l[m]=i.acceptsReference(m);if(f&&f.length>0){j=[];for(var m=0;h>m;m++)j[m]=!0;for(var m=0;m<f.length;m++){var n=f[m];k[n]=!0,l[n]=!0,j[n]=!(i.acceptsReference(n)&&!i.acceptsArray(n))}}i.isBranch()&&(b.arrayFormulaMode||b._isExpandArrayToMultiCall())&&(k[i.findTestArgument()]=!0,l[i.findTestArgument()]=!0);var o,p=-1,q=-1;if(i.isBranch()){var p=i.findTestArgument();i.acceptsArray(p)&&b._beginExpandArrayToMultiCall(),o=this._evaluate(a.getArg(p),b,k[p],l[p]),i.acceptsArray(p)&&b._endExpandArrayToMultiCall(),o instanceof d.Reference||o instanceof d.CalcArray||(q=i.findBranchArgument(o))}for(var m=0;h>m;m++)if(p!==m)if(q>=0&&m!==q)g[m]=null;else{i.acceptsArray(m)&&b._beginExpandArrayToMultiCall();var r=this._evaluate(a.getArg(m),b,k[m],l[m]);if(i.acceptsArray(m))b._endExpandArrayToMultiCall();else if(!i.acceptsArray(m)&&r instanceof pb||!i.acceptsReference(m)&&r instanceof vb){var s=r instanceof pb?r:ab,t=r instanceof vb?r:ab;if(s!=ab&&1==s.getRowCount()&&1==s.getColumnCount())r=s.getValue(0,0);else if(t!=ab&&1==t.getRowCount(0)&&1==t.getColumnCount(0))r=t.getValue(0,0,0);else{var u=[],v=!1;if(f!=ab)for(var w=0;w<f.length;w++)u.push(f[w]),f[w]==m&&(v=!0);v||(u.push(m),f=u)}}if(r instanceof d.Error&&!i.acceptsError(m))return r;r===d.missingArgument&&(i.acceptsMissingArgument(m)||(r=ab)),g[m]=r}else g[m]=o}return this._evaluateWithArgs(a,function(a){return i.isContextSensitive()?(b.acceptsReference=e||b._isExpandArrayToMultiCall(),i.evaluateWithContext(a,b)):i.evaluate(a)},b,f,g,c,e,j)},a.prototype._evaluateWithArgs=function(a,b,c,d,e,f,g,h){if(d&&d.length>0){var i=this._expandArgs(c,a,e,d,h);if(i==ab)return mb;for(var j=[],k=i[0].length,l=i[0][0].length,m=0;k>m;m++){j[m]=[];for(var n=0;l>n;n++)try{for(var o=[],p=0;p<e.length;p++)o[p]=i[p][m][n];var q=b(o);q instanceof vb&&(q=this.getOneValue(c,q)),j[m][n]=q}catch(r){j[m][n]=jb}}return new qb(j)}try{var q=b(e);return c.arrayFormulaMode&&c._isExpandArrayToMultiCall()?q:q instanceof pb&&!f?this.getOneValue(c,q):q instanceof vb&&!g?this.getOneValue(c,q):q}catch(r){return jb}},a.prototype.getOneValue=function(a,b){if(b instanceof vb){var c=b;if(c.getRangeCount()>1)b=jb;else{var e,f;-1!=a.rowOffset||-1!=a.columnOffset?(e=1==c.getRowCount(0)?0:a.rowOffset,f=1==c.getColumnCount(0)?0:a.columnOffset):(e=1==c.getRowCount(0)?0:a.row-c.getRow(0),f=1==c.getColumnCount(0)?0:a.column-c.getColumn(0)),b=e>=c.getRowCount(0)||f>=c.getColumnCount(0)?mb:c.getValue(0,e,f)}}else if(b instanceof d.Array){var g=b;if(!a.arrayFormulaMode||-1==a.rowOffset&&-1==a.columnOffset)b=g.getValue(0,0);else{var e=1==g.getRowCount()?0:a.rowOffset,f=1==g.getColumnCount()?0:a.columnOffset;b=e>=g.getRowCount()||f>=g.getColumnCount()?mb:g.getValue(e,f)}}return b},a.prototype._expandArgs=function(a,c,d,e,f){var g=1,h=1,i=-1,j=!0,k=!0,l=c instanceof Jb.FunctionExpression?c:ab;if(l==ab||l.fn.expandRows()||(j=!1),l==ab||l.fn.expandColumns()||(k=!1),l!=ab&&l.fn.isBranch&&(a.arrayFormulaMode||a._isExpandArrayToMultiCall())){i=l.fn.findTestArgument();var m=[],n=!1;if(e)for(var o=0;o<e.length;o++)m.push(e[o]),e[o]===i&&(n=!0);if(n||d[i]instanceof pb||d[i]instanceof vb){for(var p=0;p<l.argCount();p++)p!=i&&m.indexOf(p)<0&&(d[p]instanceof pb||d[p]instanceof vb)&&m.push(p);e=m}}for(var q=0;q<e.length;q++){var r=d[e[q]],s=r instanceof pb?r:null,t=r instanceof vb?r:null,u=0,v=0;if(s!=ab)u=s.getRowCount(),v=s.getColumnCount();else if(t!=ab){if(t.getRangeCount()>1)return ab;u=j?t.getRowCount(0):1,v=k?t.getColumnCount(0):1}g=u>g?u:g,h=v>h?v:h}for(var w=[],x=0,y=e[x],z=0;z<d.length;z++){w[z]=[];var A=d[z],s=null,t=null,u=1,v=1;if(z==y){if(s=A instanceof pb?A:ab,t=A instanceof vb?A:ab,(s!=ab||t!=ab)&&(u=s!=ab?s.getRowCount():j?t.getRowCount(0):1,v=s!=ab?s.getColumnCount():k?t.getColumnCount(0):1,(1!=u&&u!=g||1!=v&&v!=h)&&(-1==i||z==i)))return ab;x++,y=x<e.length?e[x]:-1}for(var B=0;g>B;B++){w[z][B]=[];for(var C=0;h>C;C++)w[z][B][C]=1!=u&&B>=u||1!=v&&C>=v?mb:s!=ab?s.getValue(1==u?0:B,1==v?0:C):t!=ab?f==ab||f[z]?t.getValue(0,1==u?0:B,1==v?0:C):new xb(t,[new b.Range(t.getRow(0)+(1==u?0:B),t.getColumn(0)+(1==v?0:C),1,1)],0):A}}return w},a}();d.Evaluator=Wb;var Xb="cellListeners",Yb="rowListeners",Zb="columnListeners",$b="rowSliceListeners",_b="columnSliceListeners",ac="addToAdjust",bc="addToDirty",cc="incrementDelay",dc="decrementDelay",ec=function(){function a(){}return a.prototype.hasListeners=function(){return A(this,this._listeners)},a.prototype.processCellListener=function(a,b){b?w(this,Xb,a):x(this,Xb,a)},a.prototype.processRowListener=function(a,b){b?w(this,Yb,a):x(this,Yb,a)},a.prototype.processColumnListener=function(a,b){b?w(this,Zb,a):x(this,Zb,a)},a.prototype.addListenersToAdjust=function(){for(var a=this._listeners,b=0;b<a.length;b++){var c=this[a[b]];if(c)for(var d=c.length,e=0;d>e;e++)c[e][ac]()}},a.prototype.addListenersToDirty=function(){for(var a=this._listeners,b=0;b<a.length;b++){var c=this[a[b]];if(c)for(var d=c.length,e=0;d>e;e++)c[e][bc]()}},a.prototype.incrementDelayOfListeners=function(){for(var a=this._listeners,b=0;b<a.length;b++){var c=this[a[b]];if(c)for(var d=c.length,e=0;d>e;e++)c[e][cc]()}},a.prototype.decrementDelayOfListeners=function(){for(var a=this._listeners,b=0;b<a.length;b++){var c=this[a[b]];if(c)for(var d=c.length,e=0;d>e;e++)c[e][dc]()}},a.prototype.addToAdjust=function(){},a.prototype.addToDirty=function(){},a.prototype.incrementDelay=function(){},a.prototype.decrementDelay=function(){},a}();d.BaseCalc=ec;var fc=function(a){function b(b,c,d){a.call(this);var e=this;e.sheetSource=b,e.row=c,e.column=d,e.delay=0,e._listeners=[Xb,Yb,Zb]}return __extends(b,a),b.prototype.incrementDelay=function(){this.delay+=1},b.prototype.decrementDelay=function(){this.delay-=1},b.prototype.startListening=function(){var a=this;a.sheetSource.linkCellExpression(a.row,a.column,1,1)},b.prototype.stopListening=function(){var a=this;a.sheetSource.unlinkCellExpression(a.row,a.column,1,1)},b.prototype.addToAdjust=function(){this.sheetSource._controller.addAdjustCell(this)},b.prototype.addToDirty=function(){this.sheetSource._controller.addDirtyCell(this)},b}(ec);d.CellCalc=fc;var gc=function(a){function b(b,c){a.call(this);var d=this;d.sheetSource=b,d.row=c,d._listeners=[Xb,Yb,$b,Zb]}return __extends(b,a),b.prototype.incrementDelay=function(){this.sheetSource.incrementDelay(this.row,-1,1,-1)},b.prototype.incrementDelay2=function(a,b){this.sheetSource.incrementDelay(this.row,a,1,b)},b.prototype.decrementDelay=function(){this.sheetSource.decrementDelay(this.row,-1,1,-1)},b.prototype.decrementDelay2=function(a,b){this.sheetSource.decrementDelay(this.row,a,1,b)},b.prototype.startListening=function(){this.sheetSource.linkRowExpression(this.row,1)},b.prototype.stopListening=function(){this.sheetSource.unlinkRowExpression(this.row,1)},b.prototype.processRowListener2=function(a,b,c){c?w(this,$b,{row:a,columnOffset:b,columnCount:1}):x(this,$b,{row:a,columnOffset:b,columnCount:1})},b.prototype.addToAdjust=function(){this.sheetSource._controller.addAdjustRow(this)},b.prototype.addToDirty=function(){this.sheetSource._controller.addDirtyRow(this)},b}(ec);d.RowCalc=gc;var hc=function(a){function b(b,c){a.call(this);var d=this;d.sheetSource=b,d.column=c,d._listeners=[Xb,Yb,Zb,_b]}return __extends(b,a),b.prototype.incrementDelay=function(){this.sheetSource.incrementDelay(-1,this.column,-1,1)},b.prototype.incrementDelay2=function(a,b){this.sheetSource.incrementDelay(a,this.column,b,1)},b.prototype.decrementDelay=function(){this.sheetSource.decrementDelay(-1,this.column,-1,1)},b.prototype.decrementDelay2=function(a,b){this.sheetSource.decrementDelay(a,this.column,b,1)},b.prototype.startListening=function(){this.sheetSource.linkColumnExpression(this.column,1)},b.prototype.stopListening=function(){this.sheetSource.unlinkColumnExpression(this.column,1)},b.prototype.processColumnListener2=function(a,b,c){c?w(this,_b,{column:a,rowOffset:b,rowCount:1}):x(this,_b,{column:a,rowOffset:b,rowCount:1})},b.prototype.addToAdjust=function(){this.sheetSource._controller.addAdjustColumn(this)},b.prototype.addToDirty=function(){this.sheetSource._controller.addDirtyColumn(this)},b}(ec);d.ColumnCalc=hc;var ic=function(a){function b(b){a.call(this),this.name=b,this._listeners=[Xb,Yb,Zb]}return __extends(b,a),b.prototype.incrementDelay=function(){this.delay+=1},b.prototype.decrementDelay=function(){this.delay-=1},b.prototype.updateListening=function(a,b){var c=this;$(this._listeners).each(function(d,e){c[e]&&$(c[e]).each(function(c,d){a&&d.stopListening(),b&&d.startListening()})})},b.prototype.addToDirty=function(){for(var a=this._listeners,b=0;b<a.length;b++){var c=this[a[b]];if(c)for(var d=c.length,e=0;d>e;e++)c[e][bc]()}},b}(ec);d.NameCalc=ic;var jc="cell",kc="row",lc="column",mc=function(){function a(a){this.sheetSource=a,this._listeners=[Xb,Yb,Zb]}return a.prototype.processCellListener=function(a,b,c,d,e,f){f?w(this,Xb,{type:jc,row:a,column:b,rowCount:c,columnCount:d,listener:e}):x(this,Xb,{type:jc,row:a,column:b,rowCount:c,columnCount:d,listener:e})},a.prototype.processRowListener=function(a,b,c,d,e,f,g,h,i){i?w(this,Yb,{type:kc,row:a,column:b,rowCount:c,columnCount:d,listener:e}):x(this,Yb,{type:kc,row:a,column:b,rowCount:c,columnCount:d,listener:e})},a.prototype.processColumnListener=function(a,b,c,d,e,f,g,h,i){i?w(this,Zb,{type:lc,row:a,column:b,rowCount:c,columnCount:d,listener:e}):x(this,Zb,{type:lc,row:a,column:b,rowCount:c,columnCount:d,listener:e})},a.prototype.addListenersToAdjust=function(a,b,c,d){for(var e=this._listeners,f=0;f<e.length;f++){var g=this[e[f]];if(g)for(var h=g.length,i=0;h>i;i++)y(g[i],a,b,c,d)&&g[i].listener[ac]()}},a.prototype.addListenersToDirty=function(a,b,c,d){for(var e=this._listeners,f=0;f<e.length;f++){var g=this[e[f]];if(g)for(var h=g.length,i=0;h>i;i++)y(g[i],a,b,c,d)&&g[i].listener[bc]()}},a.prototype.incrementDelayOfListeners=function(a,b){for(var c=this._listeners,d=0;d<c.length;d++){var e=this[c[d]];if(e)for(var f=e.length,g=0;f>g;g++)z(e[g],a,b)&&e[g].listener[cc]()}},a.prototype.decrementDelayOfListeners=function(a,b){for(var c=this._listeners,d=0;d<c.length;d++){var e=this[c[d]];if(e)for(var f=e.length,g=0;f>g;g++)z(e[g],a,b)&&e[g].listener[dc]()}},a}(),nc=function(){function a(a,b,c,d,e,f,g,h){var i=this;i._fromModel=a,i._fromRow=b,i._fromColumn=c,i._toModel=d,i._toRow=e,i._toColumn=f,i._rowCount=g,i._columnCount=h}return a.prototype.getRowOffset=function(){return this._toRow-this._fromRow},a.prototype.getColumnOffset=function(){return this._toColumn-this._fromColumn},a.prototype.sourceContains=function(a,b,c,d,e){var f=this;return f._fromModel===a&&(-1===f._fromRow||f._fromRow<=b&&b+d<=f._fromRow+f._rowCount)&&(-1===f._fromColumn||f._fromColumn<=c&&c+e<=f._fromColumn+f._columnCount)},a.prototype.destinationContains=function(a,b,c,d,e){var f=this;return f._toModel===a&&(-1===f._toRow||f._toRow<=b&&b+d<=f._toRow+f._rowCount)&&(-1===f._toColumn||f._toColumn<=c&&c+e<=f._toColumn+f._columnCount)},a.prototype.sourceIntersectWith=function(a,b,c,d,e){var f=this;if(f._toModel!==a)return ab;var g=f._createValidCellRange(a,b,c,d,e),h=f._createValidCellRange(a,f._fromRow,f._fromColumn,d,e);return h.intersectWith(g)},a.prototype._createValidCellRange=function(a,b,c,d,e){var f=-1===b?0:b,g=-1===b||-1===d?a.rowCount:d,h=-1===c?0:c,i=-1===c||-1===e?a.columnCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:B}},a}(),oc=function(){function a(){this.autoCalculation=!0,this.iteration=!1,this.maximumIterations=1,this.maximumChange=.01;var a=this;a._dataModels=[],a.clearDirties()}return a.prototype.attachDataModel=function(a){this._dataModels.contains(a)||this._dataModels.push(a)},a.prototype.detachDataModel=function(a){for(var b=this,c=ab,d=b._headDirtyCells;d;d=c)c=d.nextDirty,d.sheetSource===a&&b.removeDirtyCell(d);for(var e=ab,f=b._headDirtyRows;f;f=e)e=f.nextDirty,f.sheetSource===a&&b.removeDirtyRow(f);for(var g=ab,h=b._headDirtyColumns;h;h=g)g=h.nextDirty,h.sheetSource===a&&b.removeDirtyColumn(h);for(var i=0;i<b._dataModels.length;i++)if(b._dataModels[i]===a){b._dataModels.splice(i,1);break}},a.prototype.getAllCustomNames=function(){for(var a,b=[],c=0;c<this._dataModels.length;c++){var d=this._dataModels[c];if(d._sheet){a||(a=d._sheet.parent);var e=d._sheet.getCustomNames();e&&e.length>0&&(b=b.concat(e))}}if(a&&a.getCustomNames){var f=a.getCustomNames();f&&f.length>0&&(b=b.concat(f))}return b},a.prototype.isDirtyCell=function(a){return typeof a.previousDirty!==J||a===this._headDirtyCells},a.prototype.addDirtyCell=function(a){var b=this;a&&typeof a.previousDirty===J&&a!==this._headDirtyCells&&(b._headDirtyCells?b._tailDirtyCells.nextDirty=a:b._headDirtyCells=a,a.previousDirty=b._tailDirtyCells,a.nextDirty=ab,b._tailDirtyCells=a)},a.prototype.removeDirtyCell=function(a){var b=this;if(b.isDirtyCell(a)){var c=a.previousDirty,d=a.nextDirty;c?c.nextDirty=d:b._headDirtyCells=d,d?d.previousDirty=c:b._tailDirtyCells=c,a.previousDirty=bb,a.nextDirty=bb}},a.prototype.isDirtyRow=function(a){return a.previousDirty||a===this._headDirtyRows},a.prototype.addDirtyRow=function(a){var b=this;a&&!b.isDirtyRow(a)&&a.row<a.sheetSource.getRowCount()&&(b._headDirtyRows?b._tailDirtyRows.nextDirty=a:b._headDirtyRows=a,a.previousDirty=b._tailDirtyRows,a.nextDirty=ab,b._tailDirtyRows=a)},a.prototype.removeDirtyRow=function(a){var b=this;if(b.isDirtyRow(a)){var c=a.previousDirty,d=a.nextDirty;c?c.nextDirty=d:b._headDirtyRows=d,d?d.previousDirty=c:b._tailDirtyRows=c,a.previousDirty=ab,a.nextDirty=ab}},a.prototype.isDirtyColumn=function(a){return a.previousDirty||a===this._headDirtyColumns},a.prototype.addDirtyColumn=function(a){var b=this;a&&!b.isDirtyColumn(a)&&a.column<a.sheetSource.getColumnCount()&&(b._headDirtyColumns?b._tailDirtyColumns.nextDirty=a:b._headDirtyColumns=a,a.previousDirty=b._tailDirtyColumns,a.nextDirty=ab,b._tailDirtyColumns=a)},a.prototype.removeDirtyColumn=function(a){var b=this;if(b.isDirtyColumn(a)){var c=a.previousDirty,d=a.nextDirty;c?c.nextDirty=d:b._headDirtyColumns=d,d?d.previousDirty=c:b._tailDirtyColumns=c,a.previousDirty=ab,a.nextDirty=ab}},a.prototype.isVolatileCell=function(a){return a.previousVolatile||a===this._headVolatileCells},a.prototype.addVolatileCell=function(a){var b=this;a&&!b.isVolatileCell(a)&&a.row<a.sheetSource.getRowCount()&&a.column<a.sheetSource.getColumnCount()&&(b._headVolatileCells?b._tailVolatileCells.nextDirty=a:b._headVolatileCells=a,a.previousDirty=b._tailVolatileCells,a.nextDirty=ab,b._tailVolatileCells=a)},a.prototype.removeVolatileCell=function(a){var b=this;if(b.isVolatileCell(a)){var c=a.previousDirty,d=a.nextDirty;c?c.nextDirty=d:b._headVolatileCells=d,d?d.previousDirty=c:b._tailVolatileCells=c,a.previousDirty=bb,a.nextDirty=bb}},a.prototype.isAdjustCell=function(a){return a.previousAdjust||a===this._headAdjustCells},a.prototype.addAdjustCell=function(a){var b=this;a&&!b.isAdjustCell(a)&&a.row<a.sheetSource.getRowCount()&&a.column<a.sheetSource.getColumnCount()&&(b._headAdjustCells?b._tailAdjustCells.nextAdjust=a:b._headAdjustCells=a,a.previousAdjust=b._tailAdjustCells,a.nextAdjust=ab,b._tailAdjustCells=a)},a.prototype.removeAdjustCell=function(a){var b=this;if(b.isAdjustCell(a)){var c=a.previousAdjust,d=a.nextAdjust;c?c.nextAdjust=d:b._headAdjustCells=d,d?d.previousAdjust=c:b._tailAdjustCells=c,a.previousAdjust=ab,a.nextAdjust=ab}},a.prototype.isAdjustRow=function(a){return a.previousAdjust||a===this._headAdjustRows},a.prototype.addAdjustRow=function(a){var b=this;a&&!b.isAdjustRow(a)&&a.row<a.sheetSource.getRowCount()&&(b._headAdjustRows?b._tailAdjustRows.nextAdjust=a:b._headAdjustRows=a,a.previousAdjust=b._tailAdjustRows,a.nextAdjust=ab,b._tailAdjustRows=a)},a.prototype.removeAdjustRow=function(a){var b=this;if(b.isAdjustRow(a)){var c=a.previousAdjust,d=a.nextAdjust;c?c.nextAdjust=d:b._headAdjustRows=d,d?d.previousAdjust=c:b._tailAdjustRows=c,a.previousAdjust=ab,a.nextAdjust=ab}},a.prototype.isAdjustColumn=function(a){return a.previousAdjust||a===this._headAdjustColumns},a.prototype.addAdjustColumn=function(a){var b=this;a&&!b.isAdjustColumn(a)&&a.column<a.sheetSource.getColumnCount()&&(b._headAdjustColumns?b._tailAdjustColumns.nextAdjust=a:b._headAdjustColumns=a,a.previousAdjust=b._tailAdjustColumns,a.nextAdjust=ab,b._tailAdjustColumns=a)},a.prototype.removeAdjustColumn=function(a){var b=this;
if(b.isAdjustColumn(a)){var c=a.previousAdjust,d=a.nextAdjust;c?c.nextAdjust=d:b._headAdjustColumns=d,d?d.previousAdjust=c:b._tailAdjustColumns=c,a.previousAdjust=ab,a.nextAdjust=ab}},a.prototype.recalculate=function(a){void 0===a&&(a=!0);var b,c,d,e,f,g,h,i,j,k,l,m=this,n=ab,o=!1;if(a){for(;m._headVolatileCells;)m.addDirtyCell(m._headVolatileCells),m.removeVolatileCell(m._headVolatileCells);for(;m._headDirtyRows;){for(b=m._headDirtyRows.sheetSource,h=b.getColumnCount(),d=0;h>d;d++)m.addDirtyCell(b._getCellCalc(m._headDirtyRows.row,d,!0));m.removeDirtyRow(m._headDirtyRows)}for(;m._headDirtyColumns;){for(b=m._headDirtyColumns.sheetSource,g=b.getRowCount(),c=0;g>c;c++)m.addDirtyCell(b._getCellCalc(c,m._headDirtyColumns.column,!0));m.removeDirtyColumn(m._headDirtyColumns)}for(i=m._headDirtyCells;i;i=i.nextDirty){for(b=i.sheetSource,e=i.row,f=i.column,j=b._getRowCalc(e,!1),k=b._getColumnCalc(f,!1),l=b._getRangeCalc(!1),i.addListenersToDirty(),j&&j.addListenersToDirty(f),k&&k.addListenersToDirty(e),l&&l.addListenersToDirty(e,f,1,1);m._headDirtyRows;){for(b=m._headDirtyRows.sheetSource,h=b.getColumnCount(),d=0;h>d;d++)m.addDirtyCell(b._getCellCalc(m._headDirtyRows.row,d,!0));m.removeDirtyRow(m._headDirtyRows)}for(;m._headDirtyColumns;){for(b=m._headDirtyColumns.sheetSource,g=b.getRowCount(),c=0;g>c;c++)m.addDirtyCell(b._getCellCalc(c,m._headDirtyColumns.column,!0));m.removeDirtyColumn(m._headDirtyColumns)}}}for(i=m._headDirtyCells;i;i=n){b=i.sheetSource;var p=b.getRowCount(),q=b.getColumnCount();n=i.nextDirty,i.row<p&&i.column<q?i.delay=0:m.removeDirtyCell(i)}for(i=m._headDirtyCells;i;i=i.nextDirty)b=i.sheetSource,c=i.row,d=i.column,j=b._getRowCalc(c,!1),k=b._getColumnCalc(d,!1),l=b._getRangeCalc(!1),i.incrementDelayOfListeners(),j&&j.incrementDelayOfListeners(d),k&&k.incrementDelayOfListeners(c),l&&l.incrementDelayOfListeners(c,d);do for(o=!1,i=m._headDirtyCells;i;i=n)n=i.nextDirty,0===i.delay&&(b=i.sheetSource,c=i.row,d=i.column,j=b._getRowCalc(c,!1),k=b._getColumnCalc(d,!1),l=b._getRangeCalc(!1),b.recalculateCell(c,d),m.removeDirtyCell(i),i.decrementDelayOfListeners(),j&&j.decrementDelayOfListeners(d),k&&k.decrementDelayOfListeners(c),l&&l.decrementDelayOfListeners(c,d),o=!0);while(o);if(m._headDirtyCells)for(var r=!0,s=0;r&&s<m.maximumIterations;s++)for(r=!1,i=m._headDirtyCells;i;i=i.nextDirty){var t=i.sheetSource;c=i.row,d=i.column;var u=t.getValue(c,d);t.recalculateCell(c,d);var v=t.getValue(c,d);m._iterationChange(u,v)>=m.maximumChange&&(r=!0)}},a.prototype._iterationChange=function(a,b){var c=parseFloat(a),d=parseFloat(b);return eb(d-c)},a.prototype.clearDirties=function(){var a=this;a._headAdjustCells=ab,a._tailAdjustCells=ab,a._headAdjustRows=ab,a._tailAdjustRows=ab,a._headAdjustColumns=ab,a._tailAdjustColumns=ab,a._headDirtyCells=ab,a._tailDirtyCells=ab,a._headDirtyRows=ab,a._tailDirtyRows=ab,a._headDirtyColumns=ab,a._tailDirtyColumns=ab,a._headVolatileCells=ab,a._tailVolatileCells=ab},a.prototype._adjustIndexOnAdd=function(a,b,c,d,e,f,g,h){if(c>=0||!e){var i=d+(e?c:0);return f===a&&c>=g+h&&(i-=e?h:0),f===b&&i>=g&&(i+=h),i-=e?c:0}return d},a.prototype._adjustRangeOnAdd=function(a,b,c,d,e,f,g,h,i,j){if(c>=0||!e){var k=d+(e?c:0),l=f+(g?c:0);return h===a&&c>=i+j&&(k-=e?j:0,l-=g?j:0),h===b&&(k>=i?(k+=j,l+=j):l>=i&&(l+=j)),k-=e?c:0,l-=g?c:0,{index:k,endIndex:l}}return{index:d,endIndex:f}},a.prototype._adjustCellExpressionOnAddRow=function(a,b,c,d,e,f,g,h){if(b){var i=e.rowRelative;if(c>=0||!i){var j=this._adjustIndexOnAdd(a,b,c,e.row,e.rowRelative,f,g,h);if(j!==e.row)return a===b?new Jb.CellExpression(j,e.column,i,e.columnRelative):new Jb.ExternalCellExpression(b,j,e.column,i,e.columnRelative)}}return e},a.prototype._adjustRangeExpressionOnAddRow=function(a,b,c,d,e,f,g,h){if(b){var i=e._getRangeType();if(i===Hb.sheet||i===Hb.column)return e;var j=e.startRowRelative,k=e.endRowRelative;if(c>=0||!j||!k){var l=this._adjustRangeOnAdd(a,b,c,e.startRow,j,e.endRow,k,f,g,h),m=l.index,n=l.endIndex;if(i===Hb.row){var o;return a===b?(o=new Jb.RangeExpression,o.initBand(m,n,j,k,!0)):(o=new Jb.ExternalRangeExpression,o.initBand(b,m,n,j,k,!0)),o}return a===b?new Jb.RangeExpression(m,e.startColumn,n,e.endColumn,j,e.startColumnRelative,k,e.endColumnRelative):new Jb.ExternalRangeExpression(b,m,e.startColumn,n,e.endColumn,j,e.startColumnRelative,k,e.endColumnRelative)}}return e},a.prototype._adjustCellExpressionOnAddColumn=function(a,b,c,d,e,f,g,h){if(b){var i=e.columnRelative;if(d>=0||!i){var j=this._adjustIndexOnAdd(a,b,d,e.column,e.columnRelative,f,g,h);if(j!==e.column)return a===b?new Jb.CellExpression(e.row,j,e.rowRelative,i):new Jb.ExternalCellExpression(b,e.row,j,e.rowRelative,i)}}return e},a.prototype._adjustStructReferenceExpressionOnAddColumn=function(a,b,c,d,e,f,g,h){if(b){var i=e;if(i&&b===i.source())return i.offsetWhenInsertRemoveColumn(g,h,!0)}return e},a.prototype._adjustStructReferenceExpressionOnRemoveColumn=function(a,b,c,d,e,f,g,h){if(b){var i=e;if(i&&b===i.source())return i.offsetWhenInsertRemoveColumn(g,h,!1)}return e},a.prototype._adjustRangeExpressionOnAddColumn=function(a,b,c,d,e,f,g,h){if(b){var i=e._getRangeType();if(i===Hb.sheet||i===Hb.row)return e;var j=e.startColumnRelative,k=e.endColumnRelative;if(d>=0||!j||!k){var l=this._adjustRangeOnAdd(a,b,d,e.startColumn,j,e.endColumn,k,f,g,h),m=l.index,n=l.endIndex;if(i===Hb.column){var o;return a===b?(o=new Jb.RangeExpression,o.initBand(m,n,j,k,!1)):(o=new Jb.ExternalRangeExpression,o.initBand(b,m,n,j,k,!1)),o}return a===b?new Jb.RangeExpression(e.startRow,m,e.endRow,n,e.startRowRelative,j,e.endRowRelative,k):new Jb.ExternalRangeExpression(b,e.startRow,m,e.endRow,n,e.startRowRelative,j,e.endRowRelative,k)}}return e},a.prototype.adjustFormulaOnAddRows=function(a,b,c,d,e,f,g){var h,i=this,j=d;if(d instanceof Jb.CellExpression)j=i._adjustCellExpressionOnAddRow(a,a,b,c,d,e,f,g);else if(d instanceof Jb.RangeExpression)j=i._adjustRangeExpressionOnAddRow(a,a,b,c,d,e,f,g);else if(d instanceof Jb.ExternalCellExpression)j=i._adjustCellExpressionOnAddRow(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ExternalRangeExpression)j=i._adjustRangeExpressionOnAddRow(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ParenthesesExpression)h=i.adjustFormulaOnAddRows(a,b,c,d.argument,e,f,g),h!==d.argument&&(j=new Jb.ParenthesesExpression(h));else if(d instanceof Jb.UnaryOperatorExpression)h=i.adjustFormulaOnAddRows(a,b,c,d.operand,e,f,g),h!==d.operand&&(j=new Jb.UnaryOperatorExpression(d.operator,h));else if(d instanceof Jb.BinaryOperatorExpression){var k=i.adjustFormulaOnAddRows(a,b,c,d.left,e,f,g),l=i.adjustFormulaOnAddRows(a,b,c,d.right,e,f,g);(k!==d.left||l!==d.right)&&(j=new Jb.BinaryOperatorExpression(d.operator,k,l))}else if(d instanceof Jb.FunctionExpression){var m,n,o=ab,p=d.argCount();for(n=0;p>n;n++)if(m=d.getArg(n),h=i.adjustFormulaOnAddRows(a,b,c,m,e,f,g),h!==m){o=[],o[n]=h;break}if(o){for(n=0;p>n;n++)m=d.getArg(n),(o[n]===bb||o[n]===ab)&&(o[n]=i.adjustFormulaOnAddRows(a,b,c,m,e,f,g));j=new Jb.FunctionExpression(d.fn,o)}}return j},a.prototype.adjustFormulasOnAddRows=function(a,b,c){this.adjustFormulasOnOperator(a,this.adjustFormulaOnAddRows,b,c)},a.prototype.adjustFormulaOnAddColumns=function(a,b,c,d,e,f,g){var h,i=this,j=d;if(d instanceof Jb.CellExpression)j=i._adjustCellExpressionOnAddColumn(a,a,b,c,d,e,f,g);else if(d instanceof Jb.RangeExpression)j=i._adjustRangeExpressionOnAddColumn(a,a,b,c,d,e,f,g);else if(d instanceof Jb.ExternalCellExpression)j=i._adjustCellExpressionOnAddColumn(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ExternalRangeExpression)j=i._adjustRangeExpressionOnAddColumn(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ParenthesesExpression)h=i.adjustFormulaOnAddColumns(a,b,c,d.argument,e,f,g),h!==d.argument&&(j=new Jb.ParenthesesExpression(h));else if(d instanceof Jb.UnaryOperatorExpression)h=i.adjustFormulaOnAddColumns(a,b,c,d.operand,e,f,g),h!==d.operand&&(j=new Jb.UnaryOperatorExpression(d.operator,h));else if(d instanceof Jb.BinaryOperatorExpression){var k=i.adjustFormulaOnAddColumns(a,b,c,d.left,e,f,g),l=i.adjustFormulaOnAddColumns(a,b,c,d.right,e,f,g);(k!==d.left||l!==d.right)&&(j=new Jb.BinaryOperatorExpression(d.operator,k,l))}else if(d instanceof Jb.FunctionExpression){var m,n,o=ab,p=d.argCount();for(n=0;p>n;n++)if(m=d.getArg(n),h=i.adjustFormulaOnAddColumns(a,b,c,m,e,f,g),h!==m){o=[],o[n]=h;break}if(o){for(n=0;p>n;n++)m=d.getArg(n),(o[n]===bb||o[n]===ab)&&(o[n]=i.adjustFormulaOnAddColumns(a,b,c,m,e,f,g));j=new Jb.FunctionExpression(d.fn,o)}}else d instanceof Jb.StructReferenceExpression&&(j=i._adjustStructReferenceExpressionOnAddColumn(a,a,b,c,d,e,f,g));return j},a.prototype.adjustFormulasOnAddColumns=function(a,b,c){this.adjustFormulasOnOperator(a,this.adjustFormulaOnAddColumns,b,c)},a.prototype._adjustIndexOnRemove=function(a,b,c,d,e,f,g,h){if(c>=0||!e){var i=d+(e?c:0);if(f===a&&c>=g&&(i+=e?h:0),f===b)if(i>=g+h)i-=h;else if(i>=g)return kb;return i-=e?c:0}return d},a.prototype._adjustRangeOnRemove=function(a,b,c,d,e,f,g,h,i,j){if(c>=0||!e){var k=d+(e?c:0),l=f+(g?c:0),m=i+j-1;if(h===a&&c>=i&&(k+=e?j:0,l+=g?j:0),h===b)if(k>m)k-=j,l-=j;else{if(k>=i&&m>=l)return kb;i>l||(l>=m?(k=i>=k?k:i,l-=g?j:0):l=i)}return k-=e?c:0,l-=g?c:0,{index:k,endIndex:l}}return{index:d,endIndex:f}},a.prototype._adjustCellExpressionOnRemoveRow=function(a,b,c,d,e,f,g,h){if(b){var i=e.rowRelative;if(c>=0||!i){var j=this._adjustIndexOnRemove(a,b,c,e.row,e.rowRelative,f,g,h);if(j instanceof gb)return new Jb.ErrorExpression(j);if(j!==e.row)return a===b?new Jb.CellExpression(j,e.column,i,e.columnRelative):new Jb.ExternalCellExpression(b,j,e.column,i,e.columnRelative)}}return e},a.prototype._adjustRangeExpressionOnRemoveRow=function(a,b,c,d,e,f,g,h){if(b){var i=e._getRangeType();if(i===Hb.sheet||i===Hb.column)return e;var j=e.startRowRelative,k=e.endRowRelative;if(c>=0||!j||!k){var l=this._adjustRangeOnRemove(a,b,c,e.startRow,j,e.endRow,k,f,g,h);if(l instanceof gb)return new Jb.ErrorExpression(l);var m=l.index,n=l.endIndex;if(i===Hb.column){var o;return a===b?(o=new Jb.RangeExpression,o.initBand(m,n,j,k,!1)):(o=new Jb.ExternalRangeExpression,o.initBand(b,m,n,j,k,!1)),o}return a===b?new Jb.RangeExpression(m,e.startColumn,n,e.endColumn,j,e.startColumnRelative,k,e.endColumnRelative):new Jb.ExternalRangeExpression(b,m,e.startColumn,n,e.endColumn,j,e.startColumnRelative,k,e.endColumnRelative)}}return e},a.prototype._adjustCellExpressionOnRemoveColumn=function(a,b,c,d,e,f,g,h){if(b){var i=e.columnRelative;if(d>=0||!i){var j=this._adjustIndexOnRemove(a,b,d,e.column,e.columnRelative,f,g,h);if(j instanceof gb)return new Jb.ErrorExpression(j);if(j!==e.column)return a===b?new Jb.CellExpression(e.row,j,e.rowRelative,i):new Jb.ExternalCellExpression(b,e.row,j,e.rowRelative,i)}}return e},a.prototype._adjustRangeExpressionOnRemoveColumn=function(a,b,c,d,e,f,g,h){if(b){var i=e._getRangeType();if(i===Hb.sheet||i===Hb.row)return e;var j=e.startColumnRelative,k=e.endColumnRelative;if(d>=0||!j||!k){var l=this._adjustRangeOnRemove(a,b,d,e.startColumn,j,e.endColumn,k,f,g,h);if(l instanceof gb)return new Jb.ErrorExpression(l);var m=l.index,n=l.endIndex;if(i===Hb.column){var o;return a===b?(o=new Jb.RangeExpression,o.initBand(m,n,j,k,!1)):(o=new Jb.ExternalRangeExpression,o.initBand(b,m,n,j,k,!1)),o}return a===b?new Jb.RangeExpression(e.startRow,m,e.endRow,n,e.startRowRelative,j,e.endRowRelative,k):new Jb.ExternalRangeExpression(b,e.startRow,m,e.endRow,n,e.startRowRelative,j,e.endRowRelative,k)}}return e},a.prototype.adjustFormulaOnRemoveRows=function(a,b,c,d,e,f,g){var h,i,j,k=this,l=d;if(d instanceof Jb.CellExpression)l=k._adjustCellExpressionOnRemoveRow(a,a,b,c,d,e,f,g);else if(d instanceof Jb.RangeExpression)l=k._adjustRangeExpressionOnRemoveRow(a,a,b,c,d,e,f,g);else if(d instanceof Jb.ExternalCellExpression)l=k._adjustCellExpressionOnRemoveRow(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ExternalRangeExpression)l=k._adjustRangeExpressionOnRemoveRow(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ParenthesesExpression)h=k.adjustFormulaOnRemoveRows(a,b,c,d.argument,e,f,g),h!==d.argument&&(l=new Jb.ParenthesesExpression(h));else if(d instanceof Jb.UnaryOperatorExpression)h=k.adjustFormulaOnRemoveRows(a,b,c,d.operand,e,f,g),h!==d.operand&&(l=new Jb.UnaryOperatorExpression(d.operator,h));else if(d instanceof Jb.BinaryOperatorExpression){var m=k.adjustFormulaOnRemoveRows(a,b,c,d.left,e,f,g),n=k.adjustFormulaOnRemoveRows(a,b,c,d.right,e,f,g);(m!==d.left||n!==d.right)&&(l=new Jb.BinaryOperatorExpression(d.operator,m,n))}else if(d instanceof Jb.FunctionExpression){var o=ab,p=d.argCount();for(j=0;p>j;j++)if(i=d.getArg(j),h=k.adjustFormulaOnRemoveRows(a,b,c,i,e,f,g),h!==i){o=[],o[j]=h;break}if(o){for(j=0;p>j;j++)i=d.getArg(j),(o[j]===bb||o[j]===ab)&&(o[j]=k.adjustFormulaOnRemoveRows(a,b,c,i,e,f,g));l=new Jb.FunctionExpression(d.fn,o)}}return l},a.prototype.adjustFormulasOnRemoveRows=function(a,b,c){this.adjustFormulasOnOperator(a,this.adjustFormulaOnRemoveRows,b,c)},a.prototype.adjustFormulaOnRemoveColumns=function(a,b,c,d,e,f,g){var h,i,j,k=this,l=d;if(d instanceof Jb.CellExpression)l=k._adjustCellExpressionOnRemoveColumn(a,a,b,c,d,e,f,g);else if(d instanceof Jb.RangeExpression)l=k._adjustRangeExpressionOnRemoveColumn(a,a,b,c,d,e,f,g);else if(d instanceof Jb.ExternalCellExpression)l=k._adjustCellExpressionOnRemoveColumn(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ExternalRangeExpression)l=k._adjustRangeExpressionOnRemoveColumn(a,d.source,b,c,d,e,f,g);else if(d instanceof Jb.ParenthesesExpression)h=k.adjustFormulaOnRemoveColumns(a,b,c,d.argument,e,f,g),h!==d.argument&&(l=new Jb.ParenthesesExpression(h));else if(d instanceof Jb.UnaryOperatorExpression)h=k.adjustFormulaOnRemoveColumns(a,b,c,d.operand,e,f,g),h!==d.operand&&(l=new Jb.UnaryOperatorExpression(d.operator,h));else if(d instanceof Jb.BinaryOperatorExpression){var m=k.adjustFormulaOnRemoveColumns(a,b,c,d.left,e,f,g),n=k.adjustFormulaOnRemoveColumns(a,b,c,d.right,e,f,g);(m!==d.left||n!==d.right)&&(l=new Jb.BinaryOperatorExpression(d.operator,m,n))}else if(d instanceof Jb.FunctionExpression){var o=ab,p=d.argCount();for(j=0;p>j;j++)if(i=d.getArg(j),h=k.adjustFormulaOnRemoveColumns(a,b,c,i,e,f,g),h!==i){o=[],o[j]=h;break}if(o){for(j=0;p>j;j++)i=d.getArg(j),(o[j]===bb||o[j]===ab)&&(o[j]=k.adjustFormulaOnRemoveColumns(a,b,c,i,e,f,g));l=new Jb.FunctionExpression(d.fn,o)}}else d instanceof Jb.StructReferenceExpression&&(l=k._adjustStructReferenceExpressionOnRemoveColumn(a,a,b,c,d,e,f,g));return l},a.prototype.adjustFormulasOnRemoveColumns=function(a,b,c){this.adjustFormulasOnOperator(a,this.adjustFormulaOnRemoveColumns,b,c)},a.prototype.adjustFormulasOnOperator=function(a,b,d,e){for(var f=this,g=f.getAllCustomNames(),h=0;h<g.length;h++){var i=g[h];i.setExpression(b.call(f,ab,-1,-1,i.getExpression(),a,d,e))}for(var j,k,l,m,n,o={};f._headAdjustCells;){j=f._headAdjustCells.sheetSource;var p=j._sheet._getCalcModel();if(k=f._headAdjustCells.row,l=f._headAdjustCells.column,o[k]&&o[k][l])f.removeAdjustCell(f._headAdjustCells);else{if(n=p.getNode(k,l),n&&n.expr){m=n.expr,m=b.call(f,j,k,l,m,a,d,e);var q=p.getNode(k,l,!1).arrayInfo;if(q){q=new c.Range(k,l,q.rowCount,q.colCount);for(var r=k;r<k+q.rowCount;r++){o[r]||(o[r]={});for(var s=l;s<l+q.colCount;s++)j.setExpression(r,s,m,q,r===k&&s===l),o[r][s]=!0}}else j.setExpression(k,l,m,q,!0)}else(j.getRowExpression&&j.getRowExpression(k)||j.getColumnExpression&&j.getColumnExpression(l))&&j._addCellsToDirty(k,l,1,1);f.removeAdjustCell(f._headAdjustCells)}}for(;f._headAdjustRows;)j=f._headAdjustRows.sheetSource,k=f._headAdjustRows.row,j.getRowExpression&&(m=j.getRowExpression(k),m&&j.setExpression&&j.setExpression(k,-1,b.call(f,j,k,-1,m,a,d,e),bb,!0)),f.removeAdjustRow(f._headAdjustRows);for(;f._headAdjustColumns;)j=f._headAdjustColumns.sheetSource,l=f._headAdjustColumns.column,j.getColumnExpression&&(m=j.getColumnExpression(l),m&&j.setExpression&&j.setExpression(-1,l,b.call(f,j,-1,l,m,a,d,e),bb,!0)),f.removeAdjustColumn(f._headAdjustColumns)},a.prototype.adjustFormulaOnRemoveSheet2=function(a,b,c,d,e){return this.adjustFormulaOnRemoveSheet(a,d,e)},a.prototype.adjustFormulaOnRemoveSheet=function(a,b,c){var d,e,f,g=this,h=b;if(b instanceof Jb.ExternalReferenceExpression){var i=b.source;(a!==c&&i===c||a===c&&i!==c)&&(h=new Jb.ErrorExpression(kb))}else if(b instanceof Jb.ParenthesesExpression)d=g.adjustFormulaOnRemoveSheet(a,b.argument,c),d!==b.argument&&(h=new Jb.ParenthesesExpression(d));else if(b instanceof Jb.UnaryOperatorExpression)d=g.adjustFormulaOnRemoveSheet(a,b.operand,c),d!==b.operand&&(h=new Jb.UnaryOperatorExpression(b.operator,d));else if(b instanceof Jb.BinaryOperatorExpression){var j=g.adjustFormulaOnRemoveSheet(a,b.left,c),k=g.adjustFormulaOnRemoveSheet(a,b.right,c);(j!==b.left||k!==b.right)&&(h=new Jb.BinaryOperatorExpression(b.operator,j,k))}else if(b instanceof Jb.FunctionExpression){var l=ab,m=b.argCount();for(f=0;m>f;f++)if(e=b.getArg(f),d=g.adjustFormulaOnRemoveSheet(a,e,c),d!==e){l=[],l[f]=d;break}if(l){for(f=0;m>f;f++)e=b.getArg(f),(l[f]===bb||l[f]===ab)&&(l[f]=g.adjustFormulaOnRemoveSheet(a,e,c));h=new Jb.FunctionExpression(b.fn,l)}}return h},a.prototype.adjustFormulasOnRemoveSheet=function(a){this.adjustFormulasOnOperator(a,this.adjustFormulaOnRemoveSheet2)},a.prototype._adjustCellExpressionOnMove=function(a,b,c,d,e){var f,g,h,i,j=d instanceof Jb.ExternalReferenceExpression,k=j?d.source:a,l=d.rowRelative,m=d.columnRelative;if((b>=0||!l)&&(c>=0||!m)){if(f=d.row+(l?b:0),g=d.column+(m?c:0),i=e.destinationContains(a,b,c,1,1),k===e._toModel&&e.destinationContains(k,f,g,1,1)&&(!l&&!m||!i))return new Jb.ErrorExpression(kb);if(h=(!j||k===e._fromModel)&&(!i&&e.sourceContains(e._fromModel,f,g,1,1)||i&&e.destinationContains(e._toModel,f,g,1,1)),i&&(f-=l?e.getRowOffset():0,g-=m?e.getColumnOffset():0),h&&(f+=e.getRowOffset(),g+=e.getColumnOffset()),f-=l?b:0,g-=m?c:0,e._fromModel===e._toModel?k=j?d.source:bb:(k=bb,h&&i&&j?k=e._toModel:h&&i||(h?k=e._toModel:i&&!j&&(k=e._fromModel))),f!==d.row||g!==d.column||k!=d.source)return k?new Jb.ExternalCellExpression(k,f,g,l,m):new Jb.CellExpression(f,g,l,m)}else if((b>=0||!l)&&-1===c){if(f=d.row+(l?b:0),e.destinationContains(a,b,c,1,1)&&(f-=l?e.getRowOffset():0),e.sourceContains(k,f,-1,l,-1))f+=e.getRowOffset();else if(e.destinationContains(k,f,-1,1,-1))return new Jb.ErrorExpression(kb);if(f-=l?b:0,f!==d.row){if(d instanceof Jb.CellExpression)return new Jb.CellExpression(f,d.column,l,d.columnRelative);if(d instanceof Jb.ExternalCellExpression)return new Jb.ExternalCellExpression(d.source,f,d.column,l,d.columnRelative)}}else if(-1===b&&c>=0&&!m){if(g=d.column+(m?c:0),e.destinationContains(a,b,c,1,1)&&(g-=m?e.getColumnOffset():0),e.sourceContains(k,f,g,1,1))g+=e.getColumnOffset();else if(e.destinationContains(k,f,g,1,1))return new Jb.ErrorExpression(kb);if(g-=m?c:0,f!==d.row||g!==d.column){if(d instanceof Jb.CellExpression)return new Jb.CellExpression(d.row,g,d.rowRelative,m);if(d instanceof Jb.ExternalCellExpression)return new Jb.ExternalCellExpression(d.source,d.row,g,d.rowRelative,m)}}return d},a.prototype._adjustRangeExpressionOnMove=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=d instanceof Jb.ExternalReferenceExpression,y=x?d.source:a,z=d._getRangeType();if(z===Hb.cell)if(f=d.startRowRelative,g=d.startColumnRelative,h=d.endRowRelative,i=d.endColumnRelative,b>=0||!f||!h||c>=0||!g||!i){if(j=d.startRow+(f?b:0),k=d.endRow+(h?b:0),l=d.startColumn+(g?c:0),m=d.endColumn+(i?c:0),n=k-j+1,o=m-l+1,w=e.destinationContains(a,b,c,1,1)){var A=e._toRow-e._toColumn,B=e._toColumn-e._toRow;n+=(f?-A:0)+(h?A:0),o+=(g?-B:0)+(i?B:0)}if(!(y!==e._toModel||!e.destinationContains(y,j,l,n,o)||(f||g||h||i)&&w))return new Jb.ErrorExpression(kb);v=(!x||y===e._fromModel)&&(!w&&e.sourceContains(e._fromModel,j,l,n,o)||w&&e.destinationContains(e._toModel,j,l,n,o)),w&&(r=f?e.getRowOffset():0,s=h?e.getRowOffset():0,t=g?e.getColumnOffset():0,u=i?e.getColumnOffset():0,j-=r,k-=s,l-=t,m-=u);var C=!1;if(v)p=e.getRowOffset(),q=e.getColumnOffset(),j+=p,k+=p,l+=q,m+=q;else if(e.destinationContains(y,j,l,n,o)){var D=e.sourceIntersectWith(y,j,l,n,o);if(!D||D.rowCount!==n&&D.columnCount!==o)return new Jb.ErrorExpression(kb);j=D.row+e.getRowOffset(),l=D.column+e.getColumnOffset(),k=j+D.rowCount,m=l+D.columnCount,C=!0}if(j-=f?b:0,k-=h?b:0,l-=g?c:0,m-=i?c:0,e._fromModel===e._toModel?y=x?d.source:bb:(y=bb,v&&w&&x?y=e._toModel:v&&w||(v?y=e._toModel:w&&!x&&(y=e._fromModel))),j!==d.startRow||l!==d.startColumn||k!==d.endRow||m!==d.endColumn||C||y!=d.source)return y?new Jb.ExternalRangeExpression(y,j,l,k,m,f,g,h,i):new Jb.RangeExpression(j,l,k,m,f,g,h,i)}else if(!(b>=0)&&f&&h||-1!==c){if(-1===b&&(c>=0||!g||!i)){if(l=d.startColumn+(g?c:0),m=d.endColumn+(i?c:0),l>m)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,b,c,1,1)&&(t=g?e.getColumnOffset():0,u=i?e.getColumnOffset():0,l-=t,m-=u),o=m-l,e.sourceContains(y,-1,l,-1,o))q=e.getColumnOffset(),l+=q,m+=q;else if(e.destinationContains(y,-1,l,-1,o))return new Jb.ErrorExpression(kb);if(l-=g?c:0,m-=i?c:0,l!==d.startColumn||m!==d.endColumn){if(d instanceof Jb.RangeExpression)return new Jb.RangeExpression(d.startRow,l,d.endRow,m,d.startRowRelative,g,d.endRowRelative,i);if(d instanceof Jb.ExternalRangeExpression)return new Jb.ExternalRangeExpression(d.source,d.startRow,l,d.endRow,m,d.startRowRelative,g,d.endRowRelative,i)}}}else{if(j=d.startRow+(f?b:0),k=d.endRow+(h?b:0),j>k)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,b,c,1,1)&&(r=f?e.getRowOffset():0,s=h?e.getRowOffset():0,j-=r,k-=s),n=k-j,e.sourceContains(y,j,-1,n,-1))p=e.getRowOffset(),j+=p,k+=p;else if(e.destinationContains(y,j,-1,n,-1))return new Jb.ErrorExpression(kb);if(j-=f?b:0,k-=h?b:0,j!==d.startRow||k!==d.endRow){if(d instanceof Jb.RangeExpression)return new Jb.RangeExpression(j,d.startColumn,k,d.endColumn,f,d.startColumnRelative,h,d.endColumnRelative);if(d instanceof Jb.ExternalRangeExpression)return new Jb.ExternalRangeExpression(d.source,j,d.startColumn,k,d.endColumn,f,d.startColumnRelative,h,d.endColumnRelative)}}else if(z===Hb.row){if(f=d.startRowRelative,h=d.endRowRelative,b>=0||!f||!h){if(j=d.startRow+(f?b:0),k=d.endRow+(h?b:0),j>k)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,b,c,1,1)&&(r=f?e.getRowOffset():0,s=h?e.getRowOffset():0,j-=r,k-=s),n=k-j,e.sourceContains(y,j,-1,n,-1))p=e.getRowOffset(),j+=p,k+=p;else if(e.destinationContains(y,j,-1,n,-1))return new Jb.ErrorExpression(kb);if(j-=f?b:0,k-=h?b:0,j!==d.startRow||k!==d.endRow){if(d instanceof Jb.RangeExpression){var E=new Jb.RangeExpression;return E.initBand(j,k,f,h,!0),E}if(d instanceof Jb.ExternalRangeExpression){var F=new Jb.ExternalRangeExpression;return F.initBand(d.source,j,k,f,h,!0),F}}}}else if(z===Hb.column){if(g=d.startColumnRelative,i=d.endColumnRelative,l=d.startColumn+(g?c:0),m=d.endColumn+(i?c:0),m>l)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,b,c,1,1)&&(t=g?e.getColumnOffset():0,u=i?e.getColumnOffset():0,l-=t,m-=u),o=m-l,e.sourceContains(y,-1,l,-1,o))q=e.getColumnOffset(),l+=q,m+=q;else if(e.destinationContains(y,-1,l,-1,o))return new Jb.ErrorExpression(kb);if(l-=g?c:0,m-=i?c:0,l!==d.startColumn||m!==d.endColumn){if(d instanceof Jb.RangeExpression){var G=new Jb.RangeExpression;return G.initBand(l,m,g,i,!1),G}if(d instanceof Jb.ExternalRangeExpression){var H=new Jb.ExternalRangeExpression;return H.initBand(d.source,l,m,g,i,!1),H}}}return d},a.prototype.adjustFormulaOnMove=function(a,b,c,d,e){var f,g=this,h=d;if(d instanceof Jb.CellExpression||d instanceof Jb.ExternalCellExpression)h=g._adjustCellExpressionOnMove(a,b,c,d,e);else if(d instanceof Jb.RangeExpression||d instanceof Jb.ExternalRangeExpression)h=g._adjustRangeExpressionOnMove(a,b,c,d,e);else if(d instanceof Jb.ParenthesesExpression){var i=d;f=g.adjustFormulaOnMove(a,b,c,i.argument,e),f!==i.argument&&(h=new Jb.ParenthesesExpression(f))}else if(d instanceof Jb.UnaryOperatorExpression){var j=d;f=g.adjustFormulaOnMove(a,b,c,j.operand,e),f!==j.operand&&(h=new Jb.UnaryOperatorExpression(j.operator,f))}else if(d instanceof Jb.BinaryOperatorExpression){var k=d,l=g.adjustFormulaOnMove(a,b,c,k.left,e),m=g.adjustFormulaOnMove(a,b,c,k.right,e);(l!==k.left||m!==k.right)&&(h=new Jb.BinaryOperatorExpression(k.operator,l,m))}else if(d instanceof Jb.FunctionExpression){var n,o,p=ab,q=d,r=q.argCount();for(o=0;r>o;o++)if(n=q.getArg(o),f=g.adjustFormulaOnMove(a,b,c,n,e),f!==n){p=[],p[o]=f;break}if(p){for(o=0;r>o;o++)n=q.getArg(o),(p[o]===bb||p[o]===ab)&&(p[o]=g.adjustFormulaOnMove(a,b,c,n,e));h=new Jb.FunctionExpression(q.fn,p)}}return h},a.prototype.adjustFormulasOnMove=function(a,b,d,e,f,g,h,i){for(var j=this,k=new nc(a,b,d,e,f,g,h,i),l=j.getAllCustomNames(),m=0;m<l.length;m++){var n=l[m];n.setExpression(j.adjustFormulaOnMove(ab,-1,-1,n.getExpression(),k))}for(var o,p,q,r,s={};j._headAdjustCells;){o=j._headAdjustCells.sheetSource;var t=o._sheet._getCalcModel();if(p=j._headAdjustCells.row,q=j._headAdjustCells.column,s[p]&&s[p][q])j.removeAdjustCell(j._headAdjustCells);else{if(r=o.getExpression(p,q)){r=j.adjustFormulaOnMove(o,p,q,r,k);var u=t.getNode(p,q,!1).arrayInfo;if(u){u=new c.Range(p,q,u.rowCount,u.colCount);for(var v=p;v<p+u.rowCount;v++){s[v]||(s[v]={});for(var w=q;w<q+u.colCount;w++)o.setExpression(v,w,r,u,v===p&&w===q),s[v][w]=!0}}else o.setExpression(p,q,r,u,!0)}else(o.getRowExpression&&o.getRowExpression(p)||o.getColumnExpression&&o.getColumnExpression(q))&&o._addCellsToDirty(p,q,1,1);j.removeAdjustCell(j._headAdjustCells)}}for(;j._headAdjustRows;)o=j._headAdjustRows.sheetSource,p=j._headAdjustRows.row,o.getRowExpression&&(r=o.getRowExpression(p),r&&o._setRowExpression&&o._setRowExpression(p,j.adjustFormulaOnMove(o,p,-1,r,k),bb)),j.removeAdjustRow(j._headAdjustRows);for(;j._headAdjustColumns;)o=j._headAdjustColumns.sheetSource,q=j._headAdjustColumns.column,o.getColumnExpression&&(r=o.getColumnExpression(q),r&&o._setColumnExpression&&o._setColumnExpression(q,j.adjustFormulaOnMove(o,-1,q,r,k),bb)),j.removeAdjustColumn(j._headAdjustColumns)},a.prototype._adjustCellExpressionOnSwap=function(a,b,c,d,e){var f,g,h=d instanceof Jb.ExternalReferenceExpression?d.source:a,i=d.rowRelative,j=d.columnRelative;if((b>=0||!i)&&(c>=0||!j)){if(f=d.row+(i?b:0),g=d.column+(j?c:0),e.destinationContains(a,b,c,1,1)?(f-=i?e.getRowOffset():0,g-=j?e.getColumnOffset():0):e.sourceContains(a,f,g,1,1)&&(f+=i?e.getRowOffset():0,g+=j?e.getColumnOffset():0),e.sourceContains(h,f,g,1,1)?(f+=e.getRowOffset(),g+=e.getColumnOffset()):e.destinationContains(h,f,g,1,1)&&(f-=e.getRowOffset(),g-=e.getColumnOffset()),f-=i?b:0,g-=j?c:0,f!==d.row||g!==d.column){if(d instanceof Jb.CellExpression)return new Jb.CellExpression(f,g,i,j);if(d instanceof Jb.ExternalCellExpression)return new Jb.ExternalCellExpression(d.source,f,g,i,j)}}else if((b>=0||!i)&&-1===c){if(f=d.row+(i?b:0),e.destinationContains(a,b,-1,1,-1)?f-=i?e.getRowOffset():0:e.sourceContains(a,f,-1,1,-1)&&(f+=i?e.getRowOffset():0),e.sourceContains(h,f,-1,1,-1)?f+=e.getRowOffset():e.destinationContains(h,f,-1,1,-1)&&(f-=e.getRowOffset()),f-=i?b:0,f!==d.row||g!==d.column){if(d instanceof Jb.CellExpression)return new Jb.CellExpression(f,d.column,i,d.columnRelative);if(d instanceof Jb.ExternalCellExpression)return new Jb.ExternalCellExpression(d.source,f,d.column,i,d.columnRelative)}}else if(-1===b&&c>=0&&!j&&(g=d.column+(j?c:0),e.destinationContains(a,-1,c,-1,1)?g-=j?e.getColumnOffset():0:e.sourceContains(a,-1,g,-1,1)&&(g+=j?e.getColumnOffset():0),e.sourceContains(h,-1,g,-1,1)?g+=e.getColumnOffset():e.destinationContains(h,-1,g,-1,1)&&(g-=e.getColumnOffset()),g-=j?c:0,f!==d.row||g!==d.column)){if(d instanceof Jb.CellExpression)return new Jb.CellExpression(d.row,g,d.rowRelative,j);if(d instanceof Jb.ExternalCellExpression)return new Jb.ExternalCellExpression(d.source,d.row,g,d.rowRelative,j)}return d},a.prototype._adjustRangeExpressionOnSwap=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=d instanceof Jb.ExternalReferenceExpression?d.source:a,w=d._getRangeType();if(w===Hb.cell){if(l=d.startRowRelative,m=d.startColumnRelative,n=d.endRowRelative,o=d.endColumnRelative,!(b>=0)&&l&&n||!(c>=0)&&m&&o)if(!(b>=0)&&l&&n||-1!==c){if(-1===b&&(c>=0||!m||!o)){if(h=d.startColumn+(m?c:0),i=d.endColumn+(o?c:0),i>h)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,-1,c,-1,1)?(s=m?e.getColumnOffset():0,u=o?e.getColumnOffset():0,h-=s,i-=u):e.sourceContains(a,-1,c,-1,1)&&(s=m?e.getColumnOffset():0,u=o?e.getColumnOffset():0,h+=s,i+=u),k=i-h,e.sourceContains(v,-1,h,-1,k)?(q=e.getColumnOffset(),h+=q,i+=q):e.destinationContains(v,-1,h,-1,k)&&(q=e.getColumnOffset(),h-=q,i-=q),h-=m?c:0,i-=o?c:0,h!==d.startColumn||i!==d.endColumn){if(d instanceof Jb.RangeExpression)return new Jb.RangeExpression(d.startRow,h,d.endRow,i,d.startRowRelative,m,d.endRowRelative,o);if(d instanceof Jb.ExternalRangeExpression)return new Jb.ExternalRangeExpression(d.source,d.startRow,h,d.endRow,i,d.startRowRelative,m,d.endRowRelative,o)}}}else{if(f=d.startRow+(l?b:0),g=d.endRow+(n?b:0),g>f)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,b,-1,1,-1)?(r=l?e.getRowOffset():0,t=l?e.getRowOffset():0,f-=r,g-=t):e.sourceContains(a,b,-1,1,-1)&&(r=l?e.getRowOffset():0,t=l?e.getRowOffset():0,f+=r,g+=t),j=g-f,e.sourceContains(v,f,-1,j,-1)?(p=e.getRowOffset(),f+=p,g+=p):e.destinationContains(v,f,-1,j,-1)&&(p=e.getRowOffset(),f-=p,g-=p),f-=l?b:0,g-=n?b:0,f!==d.startRow||g!==d.endRow){if(d instanceof Jb.RangeExpression)return new Jb.RangeExpression(f,d.startColumn,g,d.endColumn,l,d.startColumnRelative,n,d.endColumnRelative);if(d instanceof Jb.ExternalRangeExpression)return new Jb.ExternalRangeExpression(d.source,f,d.startColumn,g,d.endColumn,l,d.startColumnRelative,n,d.endColumnRelative)}}else if(f=d.startRow+(l?b:0),g=d.endRow+(n?b:0),h=d.startColumn+(m?c:0),i=d.endColumn+(o?c:0),j=g-f,k=i-h,e.destinationContains(a,b,c,1,1)?(r=l?e.getRowOffset():0,s=m?e.getColumnOffset():0,t=n?e.getRowOffset():0,u=o?e.getColumnOffset():0,f-=r,g-=t,h-=s,i-=u):e.sourceContains(a,f,h,j,k)&&(r=l?e.getRowOffset():0,s=m?e.getColumnOffset():0,t=n?e.getRowOffset():0,u=o?e.getColumnOffset():0,f+=r,g+=t,h+=s,i+=u),e.sourceContains(v,f,h,j,k)?(p=e.getRowOffset(),q=e.getColumnOffset(),f+=p,g+=p,h+=q,i+=q):e.destinationContains(v,f,h,j,k)&&(p=e.getRowOffset(),q=e.getColumnOffset(),f-=p,g-=p,h-=q,i-=q),f-=l?b:0,g-=n?b:0,h-=m?c:0,i-=o?c:0,f!==d.startRow||h!==d.startColumn||g!==d.endRow||i!==d.endColumn){if(d instanceof Jb.RangeExpression)return new Jb.RangeExpression(f,h,g,i,l,m,n,o);if(d instanceof Jb.ExternalRangeExpression)return new Jb.ExternalRangeExpression(d.source,f,h,g,i,l,m,n,o)}}else if(w===Hb.row){if(l=d.startRowRelative,n=d.endRowRelative,b>=0||!l||!n){if(f=d.startRow+(l?b:0),g=d.endRow+(n?b:0),g>f)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,b,-1,1,-1)?(r=l?e.getRowOffset():0,t=n?e.getRowOffset():0,f-=r,g-=t):e.sourceContains(a,b,-1,1,-1)&&(r=l?e.getRowOffset():0,t=n?e.getRowOffset():0,f+=r,g+=t),j=g-f,e.sourceContains(v,f,-1,j,-1)?(p=e.getRowOffset(),f+=p,g+=p):e.destinationContains(v,f,-1,j,-1)&&(p=e.getRowOffset(),f-=p,g-=p),f-=l?b:0,g-=n?b:0,f!==d.startRow||g!==d.endRow){if(d instanceof Jb.RangeExpression){var x=new Jb.RangeExpression;return x.initBand(f,g,l,n,!0),x}if(d instanceof Jb.ExternalRangeExpression){var y=new Jb.ExternalRangeExpression;return y.initBand(d.source,f,g,l,n,!0),y}}}}else if(w===Hb.column){if(m=d.startColumnRelative,o=d.endColumnRelative,h=d.startColumn+(m?c:0),i=d.endColumn+(o?c:0),h>i)return new Jb.ErrorExpression(kb);if(e.destinationContains(a,-1,c,-1,1)?(s=m?e.getColumnOffset():0,u=o?e.getColumnOffset():0,h-=s,i-=u):e.sourceContains(a,-1,c,-1,1)&&(s=m?e.getColumnOffset():0,u=o?e.getColumnOffset():0,h+=s,i+=u),k=i-h,e.sourceContains(v,-1,h,-1,k)?(q=e.getColumnOffset(),h+=q,i+=q):e.destinationContains(v,-1,h,-1,k)&&(q=e.getColumnOffset(),h-=q,i-=q),h-=m?c:0,i-=o?c:0,h!==d.startColumn||i!==d.endColumn){if(d instanceof Jb.RangeExpression){var z=new Jb.RangeExpression;return z.initBand(h,i,m,o,!1),z}if(d instanceof Jb.ExternalRangeExpression){var A=new Jb.ExternalRangeExpression;return A.initBand(d.source,h,i,m,o,!1),A
}}}return d},a.prototype.adjustFormulaOnSwap=function(a,b,c,d,e){var f,g=this,h=d;if(d instanceof Jb.CellExpression||d instanceof Jb.ExternalCellExpression)h=g._adjustCellExpressionOnSwap(a,b,c,d,e);else if(d instanceof Jb.RangeExpression||d instanceof Jb.ExternalRangeExpression)h=g._adjustRangeExpressionOnSwap(a,b,c,d,e);else if(d instanceof Jb.ParenthesesExpression)f=g.adjustFormulaOnSwap(a,b,c,d.argument,e),f!==d.argument&&(h=new Jb.ParenthesesExpression(f));else if(d instanceof Jb.UnaryOperatorExpression)f=g.adjustFormulaOnSwap(a,b,c,d.operand,e),f!==d.operand&&(h=new Jb.UnaryOperatorExpression(d.operator,f));else if(d instanceof Jb.BinaryOperatorExpression){var i=g.adjustFormulaOnSwap(a,b,c,d.left,e),j=g.adjustFormulaOnSwap(a,b,c,d.right,e);(i!==d.left||j!==d.right)&&(h=new Jb.BinaryOperatorExpression(d.operator,i,j))}else if(d instanceof Jb.FunctionExpression){var k,l,m=ab,n=d.argCount();for(l=0;n>l;l++)if(k=d.getArg(l),f=g.adjustFormulaOnSwap(a,b,c,k,e),f!==k){m=[],m[l]=f;break}if(m){for(l=0;n>l;l++)k=d.getArg(l),(m[l]===bb||m[l]===ab)&&(m[l]=g.adjustFormulaOnSwap(a,b,c,k,e));h=new Jb.FunctionExpression(d.fn,m)}}return h},a.prototype.adjustFormulasOnSwap=function(a,b,d,e,f,g,h,i){for(var j=this,k=new nc(a,b,d,e,f,g,h,i),l=j.getAllCustomNames(),m=0;m<l.length;m++){var n=l[m];n.setExpression(j.adjustFormulaOnSwap(ab,-1,-1,n.getExpression(),k))}for(var o,p,q,r,s={};j._headAdjustCells;){o=j._headAdjustCells.sheetSource;var t=o._sheet._getCalcModel();if(p=j._headAdjustCells.row,q=j._headAdjustCells.column,s[p]&&s[p][q])j.removeAdjustCell(j._headAdjustCells);else{if(r=o.getExpression(p,q)){r=j.adjustFormulaOnSwap(o,p,q,r,k);var u=t.getNode(p,q,!1).arrayInfo;if(u){u=new c.Range(p,q,u.rowCount,u.colCount);for(var v=p;v<p+u.rowCount;v++){s[v]||(s[v]={});for(var w=q;w<q+u.colCount;w++)o.setExpression(v,w,r,u,v===p&&w===q),s[v][w]=!0}}else o.setExpression(p,q,r,u,!0)}else(o.getRowExpression&&o.getRowExpression(p)||o.getColumnExpression&&o.getColumnExpression(q))&&o._addCellsToDirty(p,q,1,1);j.removeAdjustCell(j._headAdjustCells)}}for(;j._headAdjustRows;)o=j._headAdjustRows.sheetSource,p=j._headAdjustRows.row,o.getRowExpression&&(r=o.getRowExpression(p),r&&o._setRowExpression&&o._setRowExpression(p,j.adjustFormulaOnSwap(o,p,-1,r,k),bb)),j.removeAdjustRow(j._headAdjustRows);for(;j._headAdjustColumns;)o=j._headAdjustColumns.sheetSource,q=j._headAdjustColumns.column,o.getColumnExpression&&(r=o.getColumnExpression(q),r&&o._setColumnExpression&&o._setColumnExpression(q,j.adjustFormulaOnSwap(o,-1,q,r,k),bb)),j.removeAdjustColumn(j._headAdjustColumns)},a}();d._Controller=oc;var pc=function(){function a(a,b){var c=this;c._sheet=a,c._sheetArea=b,c._controller=new oc,c._controller.attachDataModel(c)}return a.prototype._getSheetReference=function(){var a=this;return a._reference=a._reference||new yb(a),a._reference},a.prototype.getAllValue=function(a,b,c,d,e){var f=[[]],g=this.getRowCount(),h=this.getColumnCount();if(b>g||c>h)return[[[kb]]];b=void 0===b?0:b,c=void 0===c?0:c,d=void 0===d?g-b:d,e=void 0===e?h-c:e;for(var i=0,j=0,k=0;d>k;k++)f[0][k]=[];if(0>b){i=-b;for(var k=0;i>k;k++)for(var l=0;e>l;k++)f[0][k][l]=jb;b=0,d+=b}if(0>c){j=-c;for(var k=0;d>k;k++)for(var l=0;j>l;k++)f[0][k][l]=jb;c=0,e+=c}if(b+d>g){for(var k=g-b;d>k;k++)for(var l=0;e>l;k++)f[0][k][l]=kb;d-=d-g+b}if(c+e>h){for(k=0;d>k;k++)for(var l=h-c;e>l;l++)f[0][k][l]=kb;e-=e-h+c}return this._sheet._getValuesForCalc(f,b,c,d,e,i,j),f},a.prototype.getValue=function(a,b){var c=this;return 0>a||0>b?jb:a>=c.getRowCount()?kb:b>=c.getColumnCount()?kb:c._sheet._getCurrentValue(a,b)},a.prototype.getReference=function(a,b,c,d){var e=this;return-1===a&&-1===b?e._getSheetReference():-1===a?new xb(e._getSheetReference(),[{row:0,rowCount:e.getRowCount(),col:b,colCount:d}]):-1===b?new xb(e._getSheetReference(),[{row:a,rowCount:c,col:0,colCount:e.getColumnCount()}]):new xb(e._getSheetReference(),[{row:a,rowCount:c,col:b,colCount:d}])},a.prototype.getFunction=function(a){return this._sheet?this._sheet._findCustomFunction(a):ab},a.prototype.getName=function(a){var b=this._sheet?this._sheet._findCustomName(a):ab;return b?b.getExpression():ab},a.prototype.getColumnCount=function(){return this._sheet.getColumnCount()},a.prototype.getRowCount=function(){return this._sheet.getRowCount()},a.prototype.getCalcService=function(){return this._sheet?this._sheet.getCalcService():ab},a.prototype.hasFormula=function(a,b){return a=a!==bb?a:-1,b=b!==bb?b:-1,!!this.getExpression(a,b)},a.prototype.setFormula=function(a,b,c,d){var e=this;c&&0===c.length&&(c=ab),!d&&e._intersectWithArrayFormula(a,b,1,1)&&e._throwArrayPartException();var f=e.getFormula(a,b);if(f!==c&&(""!==f||c)&&(f||""!==c)){var g=e.getCalcService();if(g)try{var h=c?g.parse(c,a>=0?a:0,b>=0?b:0):ab;e.setExpression(a,b,h,bb,!1)}catch(i){if(!d)throw i}a>=0&&b>=0&&e._sheet._getModel(e._sheetArea).setFormula(a,b,c)}},a.prototype.getFormula=function(a,b){var c=this.getCalcService();if(c){var d=this.getEvaluateNode(a,b);if(d&&d.expr)return a=d.arrayInfo?d.arrayInfo.row:a,b=d.arrayInfo?d.arrayInfo.col:b,c.unparse(d.expr,a,b)}return ab},a.prototype.getRowFormula=function(a){return this.getFormula(a,-1)},a.prototype.setRowFormula=function(a,b){this.setFormula(a,-1,b)},a.prototype.getColumnFormula=function(a){this.getFormula(-1,a)},a.prototype.setColumnFormula=function(a,b){this.setFormula(-1,a,b)},a.prototype._throwArrayPartException=function(){throw c.SR.Exp_ArrayFromulaPart},a.prototype.setArrayFormula=function(a,d,e,f,g,h){var i=this;g&&0===g.length&&(g=ab);var j=i._sheet;if(j._hasSpans(a,d,e,f))throw c.SR.Exp_ArrayFromulaSpan;i._intersectWithArrayFormula(a,d,e,f)&&i._throwArrayPartException(),a=0>a?0:a,d=0>d?0:d;var k=i.getCalcService();if(k&&(i._clear(a,d,e,f),g)){try{var l=g?k.parse(g,a,d):ab}catch(m){if(!h)throw m;return}for(var n=a;a+e>n;n++)for(var o=d;d+f>o;o++)i.setExpression(n,o,l,new b.Range(a,d,e,f),!1);a>=0&&d>=0&&j._getModel(i._sheetArea).setFormula(a,d,g,new c.Range(a,d,e,f))}},a.prototype._clear=function(a,c,d,e){var f=this,g=f._sheet._getCalcModel(f._sheetArea);if(!g)return ab;for(var h=0>a?0:a,i=0>c?0:c,j=0>a?g.getRowCount():d,k=0>c?g.getColumnCount():e,l=h+j-1,m=i+k-1,n=(f.getCalcService(),h);l>=n&&n>=0;n=g.nextNonNullRow(n))for(var o=i;m>=o&&o>=0;o=g.nextNonNullColumn(n,o)){var p=g.getNode(n,o);if(p&&(p.workingExpr||p.expr)){var q=p.arrayInfo?new b.Range(p.arrayInfo.row,p.arrayInfo.col,p.arrayInfo.rowCount,p.arrayInfo.colCount):bb;f.setExpression(n,o,ab,q,!0)}}},a.prototype._intersectWithArrayFormula=function(a,b,c,d){return this._getFormulaExps(a,b,c,d,!0,!0)},a.prototype._getFormulaExps=function(a,c,d,e,f,g){var h=this,i=h._sheet._getCalcModel(h._sheetArea);if(!i)return ab;for(var j=0>a?0:a,k=0>c?0:c,l=0>a?i.getRowCount():d,m=0>c?i.getColumnCount():e,n=j+(0===l?1:l)-1,o=k+(0===m?1:m)-1,p=(h.getCalcService(),!1),q=[],r=[],s=j;n>=s&&s>=0;s=i.nextNonNullRow(s))for(var t=k;o>=t&&t>=0;t=i.nextNonNullColumn(s,t)){var u=i.getNode(s,t);if(u)if(u.arrayInfo){var v=u.arrayInfo;if(v.row<j||l>0&&v.row+v.rowCount-1>n||v.col<k||m>0&&v.col+v.colCount-1>o){if(f)return!0;p=!0}if(s!==v.row&&s!==j)continue;q.push(new b.Range(v.row,v.col,v.rowCount,v.colCount));var w=u.expr;r.push(w),t=v.col+v.colCount-1}else!g&&u.expr&&(q.push({row:s,col:t}),r.push(u.expr))}return f?!1:{hasPart:p,ranges:q,formulas:r}},a.prototype.getExpression=function(a,b){var c,d,e,f=this,g=ab,h=f._sheet._getCalcModel(f._sheetArea);return f._sheet?(c=h.getNode(a,b),c&&(g=c.expr),!g&&a<h.getRowCount()&&(d=h.getNode(a,-1),d&&(g=d.expr)),!g&&b<h.getColumnCount()&&(e=h.getNode(-1,b),e&&(g=e.expr))):a>=0&&-1===b?!g&&a<h.getRowCount()&&(d=h.getNode(a,-1),d&&(g=d.expr)):-1===a&&b>=0?g&&b<h.getColumnCount()&&(e=h.getNode(-1,b),e&&(g=e.expr)):-1===a&&-1===b&&(c=h.getNode(-1,-1),c&&(g=c.expr)),g},a.prototype.getEvaluateNode=function(a,b){var c,d=this,e=ab,f=d._sheet._getCalcModel(d._sheetArea);return a>=0&&b>=0?(c=f.getNode(a,b),c&&(e=c.workingExpr||c.expr)):a>=0&&-1===b?!e&&a<f.getRowCount()&&(c=f.getNode(a,-1),c&&(e=c.workingExpr||c.expr)):-1===a&&b>=0?e&&b<f.getColumnCount()&&(c=f.getNode(-1,b),c&&(e=c.workingExpr||c.expr)):-1===a&&-1===b&&(c=f.getNode(-1,-1),c&&(e=c.workingExpr||c.expr)),c},a.prototype.setExpression=function(a,b,c,d,e){var f=this,g=f.getCalcService(),h=d!==bb&&null!==d,i=new Ub(f,h,h?d.row:a,h?d.col:b),j=Jb._mappingArray(i,c,h,h?a-d.row:0,h?b-d.col:0);j=j===c?bb:j;var k;if(d!==bb&&(k=d),a>=0&&b>=0){if(e===bb||e){var l=c?g.unparse(c,a>=0?a:0,b>=0?b:0):bb;f._sheet._getModel(f._sheetArea).setFormula(a,b,l)}f._setCellExpression(a,b,c,j,k)}else a>=0&&-1===b?f._setRowExpression(a,c,j):-1===a&&b>=0&&f._setColumnExpression(b,c,j);f._controller.autoCalculation&&!g.IsSuspended()&&f._controller.recalculate()},a.prototype.getRowExpression=function(a){return this.getExpression(a,-1)},a.prototype.getColumnExpression=function(a){return this.getExpression(-1,a)},a.prototype._setCellExpression=function(a,b,c,d,e){var f,g=this;if(f=e?g._getCellCalc(a,b,!0):g._getCellCalc(a,b,!0)){f.stopListening();var h=g._sheet._getCalcModel(g._sheetArea).getNode(a,b,!0);h.expr=c,c?((d||h.workingExpr)&&(h.workingExpr=d),(e||h.arrayInfo)&&(h.arrayInfo=e)):(h.workingExpr=bb,h.arrayInfo=bb),f.startListening(),g._controller.addDirtyCell(f)}},a.prototype._setRowExpression=function(a,b,c){var d=this,e=d._getRowCalc(a,!0);if(e){e.stopListening();var f=(d._sheet._getCalcModel(d._sheetArea),d._sheet._getCalcModel(d._sheetArea).getNode(a,-1,!0));f.expr=b,(c||f.workingExpr)&&(f.workingExpr=c),e.startListening(),d._controller.addDirtyRow(e)}},a.prototype._setColumnExpression=function(a,b,c){var d=this,e=d._getColumnCalc(a,!0);if(e){e.stopListening();var f=(d._sheet._getCalcModel(d._sheetArea),d._sheet._getCalcModel(d._sheetArea).getNode(-1,a,!0));f.expr=b,(c||f.workingExpr)&&(f.workingExpr=c),e.startListening(),d._controller.addDirtyRow(e)}},a.prototype.onBeforeAddRemoveRows=function(a){var b=this,c=b.getRowCount(),d=b.getColumnCount();b.unlinkCellExpression(a,0,c-a,d),b.unlinkRowExpression(a,c-a),b._addDependentsToAdjust(a,-1,c-a,-1)},a.prototype.onAfterAddRows=function(a,b){var c=this,d=c.getRowCount(),e=c.getColumnCount();c._addCellsToDirty(a,0,b,e),c._addCellsToAdjust(a,0,d-a,e),c._addRowsToAdjust(a,d-a),c._controller.adjustFormulasOnAddRows(c,a,b),c._controller.autoCalculation&&c._controller.recalculate()},a.prototype.onAfterRemoveRows=function(a,b){var c=this,d=c.getRowCount(),e=c.getColumnCount();c._addCellsToAdjust(a,0,d-a,e),c._addRowsToAdjust(a,d-a),c._controller.adjustFormulasOnRemoveRows(c,a,b),c._controller.autoCalculation&&c._controller.recalculate()},a.prototype.onBeforeAddRemoveColumns=function(a){var b=this,c=b.getRowCount(),d=b.getColumnCount();b.unlinkCellExpression(0,a,c,d-a),b.unlinkColumnExpression(a,d-a),b._addDependentsToAdjust(-1,a,-1,d-a)},a.prototype.onAfterAddColumns=function(a,b){var c=this,d=c.getRowCount(),e=c.getColumnCount();c._addCellsToDirty(0,a,d,b),c._addCellsToAdjust(0,a,d,e-a),c._addColumnsToAdjust(a,e-a),c._controller.adjustFormulasOnAddColumns(c,a,b)},a.prototype.onAfterRemoveColumns=function(a,b){var c=this,d=c.getRowCount(),e=c.getColumnCount();c._addCellsToAdjust(0,a,d,e-a),c._addColumnsToAdjust(a,e-a),c._controller.adjustFormulasOnRemoveColumns(c,a,b),c._controller.autoCalculation&&c._controller.recalculate()},a.prototype._dealWithExpression=function(a,b,c,e,f){for(var g=this;e instanceof Jb.ParenthesesExpression;)e=e.argument;for(;e instanceof Jb.ExpandExpression;)e=e.expr;if(e instanceof Jb.StructReferenceExpression){var h=e.getRange(b,c);if(h===ab)return;e=1===h.rowCount&&1===h.columnCount?new Jb.CellExpression(h.row,h.column,!1,!1):new Jb.RangeExpression(h.row,h.column,h.row+h.rowCount-1,h.column+h.columnCount-1,!1,!1,!1,!1)}var i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(e instanceof Jb.CellExpression||e instanceof Jb.ExternalCellExpression){var w=e;if(v=e instanceof Jb.CellExpression?g:e.source,b>=0&&c>=0){if(i=w.row+(w.rowRelative?b:0),j=w.column+(w.columnRelative?c:0),q=v._getCellCalc(i,j,!0),!q)return;q.processCellListener(a,f)}else if(b>=0&&-1===c)if(i=w.row+(w.rowRelative?b:0),j=w.column,w.columnRelative){if(r=v._getRowCalc(i,!0),!r)return;r.processRowListener2(a,-j,f)}else{if(q=v._getCellCalc(i,j,!0),!q)return;q.processRowListener(a,f)}else if(-1===b&&c>=0)if(i=w.row,j=w.column+(w.columnRelative?c:0),w.rowRelative){if(s=v._getColumnCalc(j,!0),!s)return;s.processColumnListener2(a,-i,f)}else{if(q=v._getCellCalc(i,j,!0),!q)return;q.processColumnListener(a,f)}}else if(e instanceof Jb.RangeExpression||e instanceof Jb.ExternalRangeExpression){v=e instanceof Jb.RangeExpression?g:e.source;var x=e,y=x._getRangeType();if(y===Hb.cell){if(b>=0&&c>=0)if(k=x.startRow+(x.startRowRelative?b:0),m=x.startColumn+(x.startColumnRelative?c:0),l=x.endRow+(x.endRowRelative?b:0),n=x.endColumn+(x.endColumnRelative?c:0),o=eb(l-k)+1,p=eb(n-m)+1,C(i,j,o,p)){var z=v._getRangeCalc(!0);if(!z)return;z.processCellListener(k,m,o,p,a,f)}else for(t=k;l>=t;t++)for(u=m;n>=u;u++)q=v._getCellCalc(t,u,!0),q&&q.processCellListener(a,f);else if(b>=0&&-1===c)for(k=x.startRow+(x.startRowRelative?b:0),m=x.startColumn+(x.startColumnRelative?c:0),l=x.endRow+(x.endRowRelative?b:0),n=x.endColumn+(x.endColumnRelative?c:0),t=k;l>=t;t++)for(u=m;n>=u;u++)x.startColumnRelative||x.endColumnRelative?(r=v._getRowCalc(t,!0),r&&r.processRowListener2(a,-u,f)):(q=v._getCellCalc(t,u,!0),q&&q.processRowListener(a,f));else if(-1===b&&c>=0)for(k=x.startRow+(x.startRowRelative?b:0),m=x.startColumn+(x.startColumnRelative?c:0),l=x.endRow+(x.endRowRelative?b:0),n=x.endColumn+(x.endColumnRelative?c:0),t=k;l>=t;t++)for(u=m;n>=u;u++)x.startRowRelative||x.endRowRelative?(s=v._getColumnCalc(u,!0),s&&s.processColumnListener2(a,-t,f)):(q=v._getCellCalc(t,u,!0),q&&q.processColumnListener(a,f))}else if(y===Hb.row){if(b>=0&&c>=0)for(k=x.startRow+(x.startRowRelative?b:0),l=x.endRow+(x.endRowRelative?b:0),t=k;l>=t;t++)r=v._getRowCalc(t,!0),r&&r.processCellListener(a,f)}else if(y===Hb.column){if(b>=0&&c>=0)for(m=x.startColumn+(x.startColumnRelative?c:0),n=x.endColumn+(x.endColumnRelative?c:0),u=m;n>=u;u++)s=v._getColumnCalc(u,!0),s&&s.processCellListener(a,f)}else y===Hb.sheet}else if(e instanceof Jb.UnaryOperatorExpression)g._dealWithExpression(a,b,c,e.operand,f);else if(e instanceof Jb.BinaryOperatorExpression)g._dealWithExpression(a,b,c,e.left,f),g._dealWithExpression(a,b,c,e.right,f);else if(e instanceof Jb.NameExpression||e instanceof Jb.ExternalNameExpression){v=e instanceof Jb.NameExpression?g:e.source;var A=v._getNameCalc(e.name,!0);if(!A)return;A.processCellListener(a,f),g._dealWithExpression(a,b,c,v.getName(e.name,b,c),f)}else if(e instanceof Jb.FunctionExpression){var B=e;if(B.fn&&B.fn instanceof d.Functions.Function&&!B.fn.precedentReference())return;for(var D=B.argCount(),E=0;D>E;E++)g._dealWithExpression(a,b,c,B.getArg(E),f)}},a.prototype._dealWithCellExpression=function(a,b,c,d,e){for(var f=this,g=f._sheet._getCalcModel(f._sheetArea),h=a+c,i=b+d,j=a;h>j;j++)for(var k=b;i>k;k++){var l=g.getNode(j,k);l&&(l.workingExpr||l.expr)&&(l.arrayInfo?f._dealWithExpression(f._getCellCalc(j,k),l.arrayInfo.row,l.arrayInfo.col,l.workingExpr||l.expr,e):f._dealWithExpression(f._getCellCalc(j,k),j,k,l.workingExpr||l.expr,e))}},a.prototype.linkCellExpression=function(a,b,c,d){this._dealWithCellExpression(a,b,c,d,!0)},a.prototype.unlinkCellExpression=function(a,b,c,d){this._dealWithCellExpression(a,b,c,d,!1)},a.prototype.linkRowExpression=function(){},a.prototype.unlinkRowExpression=function(){},a.prototype.linkColumnExpression=function(){},a.prototype.unlinkColumnExpression=function(){},a.prototype._addColumnsToDirty=function(a,b){for(var c=this,d=c._sheet._getCalcModel(c._sheetArea),e=a;-1!==e&&a+b>e;e++){var f=d.getNode(-1,e,!1);if(f&&(f.columnCalc||f.expr)){var g=c._getColumnCalc(e,!0);c._controller.addDirtyColumn(g)}}},a.prototype._addRowsToDirty=function(a,b){for(var c=this,d=c._sheet._getCalcModel(c._sheetArea),e=a;-1!==e&&a+b>e;e++){var f=d.getNode(e,-1,!1);if(f&&(f.rowCalc||f.expr)){var g=c._getRowCalc(e,!0);c._controller.addDirtyRow(g)}}},a.prototype._addCellsToDirty=function(a,b,c,d){for(var e=this,f=e._sheet._getCalcModel(e._sheetArea),g=a+c,h=b+d,i=a;g>i;i++)for(var j=b;h>j;j++)if(f.containsNoe(i,j)){var k=e._getCellCalc(i,j,!0);e._controller.addDirtyCell(k)}e._addRowsToDirty(a,c),e._addColumnsToDirty(b,d)},a.prototype._addDependentsToAdjust=function(a,b,c,d){this._addDependents(a,b,c,d,!0,!1)},a.prototype._iterateEachCell=function(a,b,c,d,e,f,g){for(var h=b+d,i=c+e,j=b;h>j;j++)for(var k=c;i>k;k++){var l=this._getCellCalc(j,k,!1);l&&(f&&l.addListenersToAdjust(),g&&l.addListenersToDirty())}},a.prototype._iterateEachRow=function(a,b,c,d,e){if(a._rowDataArray)for(var f=b;-1!==f&&b+c>f&&f<a._rowDataArray.length;f++){var g=a._rowDataArray[f];if(g&&g.rowCalc){var h=g.rowCalc;d&&h.addListenersToAdjust(),e&&h.addListenersToDirty()}}},a.prototype._iterateEachColumn=function(a,b,c,d,e){if(a._columnDataArray)for(var f=b;-1!==f&&b+c>f&&f<a._columnDataArray.length;f++){var g=a._columnDataArray[f];if(g&&g.columnCalc){var h=g.columnCalc;d&&h.addListenersToAdjust(),e&&h.addListenersToDirty()}}},a.prototype._addDependents=function(a,b,c,d,e,f){if(e||f){var g=this,h=g._sheet._getCalcModel(g._sheetArea);if(a>=0&&b>=0)g._iterateEachCell(h,a,b,c,d,e,f),g._iterateEachRow(h,a,c,e,f),g._iterateEachColumn(h,b,d,e,f),g._rangeCalc&&(e&&g._rangeCalc.addListenersToAdjust(a,b,c,d),f&&g._rangeCalc.addListenersToDirty(a,b,c,d));else if(a>=0&&-1===b)g._iterateEachCell(h,a,0,c,g.getColumnCount(),e,f),g._iterateEachRow(h,a,c,e,f),g._rangeCalc&&(e&&g._rangeCalc.addListenersToAdjust(a,b,c,d),f&&g._rangeCalc.addListenersToDirty(a,b,c,d));else if(-1===a&&b>=0)g._iterateEachCell(h,0,b,g.getRowCount(),d,e,f),g._iterateEachColumn(h,b,d,e,f),g._rangeCalc&&(e&&g._rangeCalc.addListenersToAdjust(a,b,c,d),f&&g._rangeCalc.addListenersToDirty(a,b,c,d));else if(-1===a&&-1===b){var i=g.getRowCount(),j=g.getColumnCount();g._iterateEachCell(h,0,0,i,j,e,f),g._iterateEachRow(h,0,i,e,f),g._iterateEachColumn(h,0,j,e,f),g._rangeCalc&&(e&&g._rangeCalc.addListenersToAdjust(a,b,c,d),f&&g._rangeCalc.addListenersToDirty(a,b,c,d))}}},a.prototype._addCellsToAdjust=function(a,b,c,d){for(var e=this,f=e._sheet._getCalcModel(e._sheetArea),g=a+c,h=b+d,i=a;g>i;i++)for(var j=b;h>j;j++){var k=f.getNode(i,j,!1);if(k&&(k.cellCalc||k.expr)){k.cellCalc&&(k.cellCalc=ab);var l=e._getCellCalc(i,j,!0);e._controller.addAdjustCell(l)}}},a.prototype._addColumnsToAdjust=function(a,b){for(var c=this,d=c._sheet._getCalcModel(c._sheetArea),e=a;-1!==e&&a+b>e;e++){var f=d.getNode(-1,a);if(f&&(f.columnCalc||f.expr)){var g=c._getColumnCalc(e,!0);c._controller.addAdjustColumn(g)}}},a.prototype._addRowsToAdjust=function(a,b){for(var c=this,d=c._sheet._getCalcModel(c._sheetArea),e=a;-1!==e&&a+b>e;e++){var f=d.getNode(a,-1);if(f&&(f.rowCalc||f.expr)){var g=c._getRowCalc(e,!0);c._controller.addAdjustRow(g)}}},a.prototype._getCellCalc=function(a,b,c){var d=this,e=ab;if(a>=0&&b>=0){var f=d._sheet._getCalcModel(d._sheetArea),g=f.getNode(a,b,c);g&&(e=g.cellCalc,!e&&c&&(g.cellCalc=e=new fc(d,a,b)))}return e},a.prototype._getRowCalc=function(a,b){var c=this,d=ab;if(a>=0){var e=c._sheet._getCalcModel(c._sheetArea),f=e.getNode(a,-1,b);f&&(d=f.rowCalc,!d&&b&&(f.rowCalc=d=new gc(c,a)))}return d},a.prototype._getColumnCalc=function(a,b){var c=this,d=ab;if(a>=0){var e=c._sheet._getCalcModel(c._sheetArea),f=e.getNode(-1,a,b);f&&(d=f.columnCalc,!d&&b&&(f.columnCalc=d=new hc(c,a)))}return d},a.prototype._getRangeCalc=function(a){var b=this,c=b._sheet._getCalcModel(b._sheetArea);return!c._rangeCalc&&a&&(c._rangeCalc=new mc(b)),c._rangeCalc},a.prototype._getNameCalc=function(a,b){var c,d=this,e=ab;if(d._sheet.getCustomName(a))c=d._sheet._getCalcModel(d._sheetArea),c._names||(c._names={}),e=c._names[a],!e&&b&&(e=c._names[a]=new ic(a));else{var f=d._sheet.getCalcService();f&&f._getNameCalc&&(e=f._getNameCalc(a,b)),e||(c=d._sheet._getCalcModel(d._sheetArea),c._names||(c._names={}),e=c._names[a],!e&&b&&(e=c._names[a]=new ic(a)))}return e},a.prototype.recalculateCell=function(a,b){var c=this,d=c.getEvaluateNode(a,b),e=d?d.workingExpr||d.expr:ab;if(e){var f,g,h,i,j=c._sheet.getValue(a,b),k=!1;d.arrayInfo&&(k=!0,f=d.arrayInfo.row,g=d.arrayInfo.col,h=d.arrayInfo.rowCount,i=d.arrayInfo.colCount);var l=c._sheet.getCalcService().evaluateParsedFormula(c,e,a,b,k,!0,f,g,h,i);if(j===l)return;if(j instanceof Date&&l instanceof Date&&j.valueOf()===l.valueOf())return;var m=c._sheet._getModel();if(!m)return;var n=!1,o=c._sheet._bindingManager;o&&o._dataSource&&(n=o.setValue(a,b,l)),(!n||c._sheet.checkingChanges)&&m.setValue(a,b,l)}},a.prototype.shareCalculations=function(a){var b=this;if(b._controller!==a._controller){if(b._controller.detachDataModel(b),b._controller._dataModels.length>0){var c=b._controller._dataModels[0];c&&c.shareCalculations(a)}b._controller=a._controller,b._controller.attachDataModel(b)}},a.prototype.unshareCalculations=function(){var a=this;a._addCellsToAdjust(0,0,a.getRowCount(),a.getColumnCount()),a._addRowsToAdjust(0,a.getRowCount()),a._addColumnsToAdjust(0,a.getColumnCount()),a._addDependentsToAdjust(-1,-1,-1,-1),a._controller.adjustFormulasOnRemoveSheet(a),a._controller.autoCalculation&&a._controller.recalculate(),a._controller.detachDataModel(a),a._controller=new oc,a._controller.attachDataModel(a)},a}();d._SheetSource=pc;var qc=function(){function b(a){var b=this;b.context=a,b.parser=new Tb,b.evaluator=new Wb,b.useR1C1=!1,b._suspended=0}return b.prototype.contextChanged=function(){this.cachedContexts=ab},b.prototype._getExternalSource=function(b,c){var d=this;if(!d.context)return ab;if(!(!b||d.context instanceof a.spread.Spread&&d.context.name===b))return ab;var e=d.getSheetContexts();if(e&&e.length>0)for(var g=0;g<e.length;g++){var h=e[g];if(f(h.name,c))return h.target._getSheetSource()}return ab},b.prototype._getExternalSourceToken=function(a){return a._sheet._name},b.prototype._getTableByName=function(a){var b=this;return b.context.getActiveSheet&&b.context._findTable?b.context._findTable(a):b.context.parent&&b.context._findTable?b.context._findTable(a):b.context.findTableByName?b.context.findTableByName(a):ab},b.prototype._getTableByIndex=function(a,b){var c=this.context;return c.getActiveSheet&&(c=c.getActiveSheet()),c.findTable?c.findTable(a,b):void 0},b.prototype._getParserContext=function(a,b){var c=new Sb(this.useR1C1,a,b,ab),d=this;return c.getExternalSource=function(a,b){return d._getExternalSource(a,b)},c.getExternalSourceToken=function(a){return d._getExternalSourceToken(a)},c.getTableByName=function(a){return d._getTableByName(a)},c.getTableByIndex=function(a,b){return d._getTableByIndex(a,b)},c},b.prototype._getEvaluatorContext4Cell=function(a,b,c,d,e,f,g,h){return d?(e=typeof e===J?b:e,f=typeof f===J?c:f,new Ub(a._getSheetSource(),d,e,f,g,h,b,c)):new Ub(a._getSheetSource(),d,b,c)},b.prototype.getSheetContexts=function(){var a=this;return a.cachedContexts||a.createSheetContexts(),a.cachedContexts},b.prototype.createSheetContexts=function(){var a=this;a.context&&(a.cachedContexts=a.context._getCalcContexts())},b.prototype.parse=function(a,b,c){var d=this._getParserContext(b,c);return d.row=b,d.column=c,this.parser.parse(a,d)},b.prototype.unparse=function(a,b,c){var d=this._getParserContext(b,c);return d.row=b,d.column=c,this.parser.unparse(a,d)},b.prototype.evaluateParsedFormula=function(a,b,c,d,e,f,g,h,i,j){var k=this._getEvaluatorContext4Cell(a._sheet,c,d,e,g,h,i,j),l=this.evaluator.evaluateExpression(b,k,f);if(e&&arguments.length<=5)return l===bb||l===ab?0:l;if(l instanceof vb){var m=l.getRowCount(0),n=l.getColumnCount(0);if(l.getRangeCount()<=0)return kb;if(1!==l.getRangeCount())return jb;try{var o=e?c-g:c-l.getRow(0),p=e?d-h:d-l.getColumn(0);if(1===m&&1===n)l=l.getValue(0,0,0);else if(1===m&&n>1&&p>=0&&n>p)l=l.getValue(0,0,p);else if(m>1&&1===n&&o>=0&&m>o)l=l.getValue(0,o,0);else{if(!(e&&m>o&&n>p))return e?mb:jb;l=l.getValue(0,o,p)}}catch(q){return jb}}else if(l instanceof pb)if(e){var r=l,s=r.getRowCount(),t=r.getColumnCount();if(1!=s&&c-g>=s||1!=t&&d-h>=t)return mb;l=l.getValue(1==s?0:c-g,1==t?0:d-h)}else l=l.getValueByIndex(0);return l===bb||l===ab?0:l},b.prototype.evaluate=function(a,b,c,d){var e=this;return e.evaluator.evaluateFormula(b,e._getParserContext(c,d),e._getEvaluatorContext4Cell(a._sheet,c,d,!1))},b.prototype.recalculate=function(a,b,c){var d=a.target;if(d){var e=d._getSheetSource();e&&(e._addCellsToDirty(b,c,1,1),this.IsSuspended()||e._controller.recalculate())}},b.prototype.recalculateAll=function(a){var b=this.getSheetContexts();if(b){for(var c=0;c<b.length;c++){var d=b[c].target;if(d){var e=d._getSheetSource();if(e&&a!==!1){var f=d.getColumnCount(),g=d.getRowCount();e._addColumnsToDirty(0,f),e._addRowsToDirty(0,g),e._addCellsToDirty(0,0,g,f)}}}if(!this.IsSuspended())for(var c=0;c<b.length;c++){var d=b[c].target;if(d){var e=d._getSheetSource();e&&e._controller.recalculate(a===!1)}}}},b.prototype.ignoreDirty=function(){return this._ignoreDirty},b.prototype.suspend=function(a){this._suspended++,this._ignoreDirty=a?!0:a},b.prototype.resume=function(a){var b=this;b._suspended--,b._suspended<0&&(b._suspended=0),b.IsSuspended()||(b._ignoreDirty=!1,b.recalculateAll(a))},b.prototype.resumeWithoutCalc=function(){this._suspended=0;var a=this.getSheetContexts();if(a)for(var b=0;b<a.length;b++){var c=a[b].target;if(c){var d=c._getSheetSource();d&&d._controller.clearDirties()}}},b.prototype.IsSuspended=function(){return this._suspended>0},b}();d.Service=qc,d.evaluateFormula=D,d.evaluateExpression=E,d.rangeToExpression=F,d.rangeToFormula=G,d.formulaToRange=H,d.rangesToFormula=I,function(a){a[a.allAbsolute=0]="allAbsolute",a[a.startRowRelative=1]="startRowRelative",a[a.startColRelative=2]="startColRelative",a[a.endRowRelative=4]="endRowRelative",a[a.endColRelative=8]="endColRelative",a[a.rowRelative=5]="rowRelative",a[a.colRelative=10]="colRelative",a[a.allRelative=15]="allRelative"}(d.RangeReferenceRelative||(d.RangeReferenceRelative={}));d.RangeReferenceRelative}(c.Calc||(c.Calc={}));c.Calc}(a.spread||(a.spread={}));var b=a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){!function(c){!function(d){function e(a,c,e){if(a===$d||a===Zd)throw b.SR.Exp_InvalidFunctionName;var f;if(a=a.toUpperCase(),d.Functions._builtInFunctions.hasOwnProperty(a))if(f=d.Functions._builtInFunctions[a]){if(!e||!e.override)throw b.SR.Exp_OverrideNotAllowed}else d.Functions._builtInFunctions[a]=new d.Functions.Function(a,0,255),f=d.Functions[a.toUpperCase()];else f=new d.Functions.Function(a,0,255),d.Functions._builtInFunctions[a]=f;if(c&&"function"==typeof c&&(f.evaluate=c),e)for(var g in e)e.hasOwnProperty(g)&&"override"!==g&&(f[g]=e[g]);return f}function f(){return!0}function g(){return!1}function h(a){return 0!==a}function i(a){return 1===a}function j(a){return 2===a}function k(a){return 0===a||2===a}function l(a){return 0===a||a%2===1}function m(a){return 3===a}function n(){return!0}function o(a){return 1===a||2===a}function p(){return!0}function q(a){return 0===a}function r(a,b,d){var e=c.Convert;if(e.isError(a))return d.value=a,!1;if(e._isCalcReference(a)){for(var f=0;f<a.getRangeCount();f++)for(var g=0;g<a.getRowCount(f);g++)for(var h=0;h<a.getColumnCount(f);h++)if(a instanceof c._SheetRangeReference){for(var i=0;i<a.getSheetCount();i++)if((d.includeSubtotal||!a.isSubtotal(i,f,g,h))&&b(a.getValue(i,f,g,h),d)===!1)return!1}else if((d.includeSubtotal||!a.isSubtotal(f,g,h))&&b(a.getValue(f,g,h),d)===!1)return!1}else if(e._isCalcArray(a)){e._inArray=!0;for(var j=0;j<a.length();j++)if(b(a.getValueByIndex(j),d)===!1)return!1;e._inArray=!1}else if(Yd.isArray(a))Yd.each(a,function(a,c){return b(c,d)});else if(b(a,d)===!1)return!1;return!0}function s(){return 0}function t(a){var b=c.Convert;if(b.isError(a))return-1;var d=!1;try{d=b.toBool(a)}catch(e){}return d?1:2}function u(a){return a>0}function v(a){return 1===a}function w(a){return 1===a||2===a||3===a}function x(a){return 2===a}function y(a){return 0===a||2===a}function z(a){return 0===a||1===a}function A(a){return 0===a||a%2===1}function B(a){return 0===a}function C(a){return 0===a||1===a||2===a}function D(a){return a%2===0}function E(a){return 3===a}function F(a){return 3!==a}function G(a){return 3===a||4===a}function H(a){return 1!==a}function I(a){return 3===a||4===a}function J(a){return a>0}function K(a){return 4===a}function L(a){return 4===a||5===a}function M(a){return 5===a}function N(a){return 6===a}function O(a){return 8===a}function P(a){return 7===a}function Q(a){return 2!==a}function R(a){return 5===a||6===a}function S(a){return 4===a||6===a||7===a}function T(a){return 3===a||4===a||5===a}function U(a){return a>=1}function V(a){return 2===a||3===a||4===a}function W(a){return 1===a||2===a||3===a}function X(a){if(""===a||a===$d||a===Zd)return a;for(var b in De)De.hasOwnProperty(b)&&(a=a.replace(De[b],De[b].source));return a=a.replace("~?","{113E2532-EAF5-444c-A5CB-3D7446971C4D}"),a=a.replace("~*","{E21523B3-0F1F-458f-B547-23D25713D0EC}"),a=a.replace("?","."),a=a.replace("*","((.|\\n)*)"),a=a.replace("{113E2532-EAF5-444c-A5CB-3D7446971C4D}","\\?"),a=a.replace("{E21523B3-0F1F-458f-B547-23D25713D0EC}","\\*"),a.toString()}function Y(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(_d(b))}function Z(a){var b=parseFloat(a[0]);return b===$d||b===Zd?we:d.Functions._MathHelper.approxFloor(b)}function $(a){var b=c.Convert,e=b.toDouble(a[0]),f=b.toDouble(a[1]);return isNaN(e)||isNaN(f)?we:0===e||0===f?0:e>0&&0>f?Ae:0>e&&f>0?(f=-f,d.Functions._MathHelper.approxFloor(e/f)*f):d.Functions._MathHelper.approxCeiling(e/f)*f}function _(a){var b=parseFloat(a[0]),d=parseFloat(a[1]);if(isNaN(b)||isNaN(d))return we;if(0>b||0>d||d>b)return Ae;var e=1;d=ce(b-d,d);for(var f=1;d>=f;f++)e*=b-f+1,e/=f;return c.Convert.toResult(e)}function ab(a){var b;return isNaN(b=parseFloat(a[0]))?we:180*b/oe}function bb(a){var b=parseFloat(a[0]);return 0>b?(b=de(b),b%2!==0&&(b-=1)):(b=ee(b),b%2!==0&&(b+=1)),b}function cb(a){var b=parseInt(a[0],10),c=1;if(isNaN(b))return we;if(0>b||b>170)return Ae;for(var d=1;b>=d;d++)c*=d;return c}function db(a){var b=parseInt(a[0],10),c=1;if(isNaN(b))return we;if(0>b||b>300)return Ae;for(var d=b;d>1;d-=2)c*=d;return c}function eb(a){var b=parseFloat(a[0]);return b===$d||b===Zd?we:0>=b?Ae:c.Convert.toResult(ne(b))}function fb(a){var b=parseFloat(a[0]),c=parseFloat(a[1]);return 0===c?"#DIV/0!":b-c*de(b/c)}function gb(a){var b=parseFloat(a[0]);return 0>b?(b=de(b),b%2===0&&(b-=1)):(b=ee(b),b%2===0&&(b+=1)),b}function hb(){return oe}function ib(a){var b=parseFloat(a[0]),c=parseFloat(a[1]);return qe(b,c)}function jb(a,b){var d=c.Convert;if(d.isError(a))return b.value=a,!1;if(d._isCalcReference(a)||d._isCalcArray(a)||Yd.isArray(a))return r(a,jb,b);var e={value:0};if(d.tryToDouble(a,e)){var f=e.value;!isNaN(f)&&isFinite(f)&&(b.value+=f)}return!0}function kb(a){if(!a||a.length<1)throw b.SR.Exp_InvalidArgument;for(var d,e,f,g=0,h=0;h<a.length;h++){var i,j=a[h],k=c.Convert;if(k.isError(j))return j;if(k._isCalcReference(j)){var l=j;i=l.getAllValue()}else if(k._isCalcArray(j)){k._inArray=!0;var m=j;i=[m.getAllValue()]}else i=Yd.isArray(j)?j:[[[j]]];d=i.length;for(var n=0;d>n;n++)for(var o=i[n],e=o.length,p=0;e>p;p++)for(var q=o[p],f=q.length,r=0;f>r;r++){var s=q[r];if(k.isError(s))return s;var t={value:0};if(k.tryToDouble(s,t)){var u=t.value;!isNaN(u)&&isFinite(u)&&(g+=u)}}k._inArray=!1}return g}function lb(a){var b=parseFloat(a[0]);return b>0?1:0===b?0:-1}function mb(a,b){for(;0!==b;){var c=a%b;a=b,b=c}return a}function nb(a){for(var b=0,d=a.length,e=c.Convert,f=c._ArrayHelper,g=0;d>g;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=f.getLength(a[g]),i=0;h>i;i++){var j=f.getValueByIndex(a[g],i);if(e.isError(j))return e._inArray=!1,j;var k=e.toInt(j);if(0>k)return e._inArray=!1,Ae;b=mb(b,k)}e._inArray=!1}else{var l=e.toInt(a[g]);if(0>l)return Ae;b=mb(b,l)}}return b}function ob(a){for(var b=1,d=[],e=c.Convert,f=c._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++){var i=f.getValueByIndex(a[g],h);
if(e.isError(i))return e._inArray=!1,i;d.push(e.toInt(i))}e._inArray=!1}else d.push(e.toInt(a[g]));for(var j=0;j<d.length;j++){var k=d[j];if(0>k)return Ae;if(0===k)return 0;b/=mb(b,k),b*=k}}return b}function pb(a,b){for(var d,e,f,g,h,i=1,j=0,k=c.Convert,l=0;l<a.length;l++){if(k.isError(a[l]))return a[l];if(k._isCalcArray(a[l])){for(k._inArray=!0,e=a[l].getColumnCount(),d=a[l].getRowCount(),g=0;e>g;g++)for(f=0;d>f;f++)if(h=a[l].getValue(f,g),k.isNumber(h))i*=k.toDouble(h),j++;else if(k.isError(h))return h;k._inArray=!1}else if(k._isCalcReference(a[l])){var m=a[l].getRangeCount();e=0,d=0;for(var n=0;m>n;n++)for(e=a[l].getColumnCount(n),g=0;e>g;g++)for(d=a[l].getRowCount(n),f=0;d>f;f++){if(a[l]instanceof c._SheetRangeReference)for(var o=0;o<a[l].getSheetCount();o++)(b||!a[l].isSubtotal(o,n,f,g))&&(h=a[l].getValue(o,n,f,g));else(b||!a[l].isSubtotal(n,f,g))&&(h=a[l].getValue(n,f,g));if(k.isNumber(h))i*=k.toDouble(h),j++;else if(k.isError(h))return h}}else{if(isNaN(k.toDouble(a[l])))return we;i*=a[l],j++}}return k.toResult(j>0?i:0)}function qb(a){return pb(a,!0)}function rb(a){var b=parseFloat(a[0]);return b>=0?ae(b):Ae}function sb(a){var b=c.Convert;if(b.isError(a[0]))return a[0];if(b.isError(a[1]))return a[1];var d=b.toDouble(a[0]),e=b.toDouble(a[1]);return isNaN(d)||isNaN(e)?we:0===e?ve:parseInt((d/e).toString(),10)}function tb(a){for(var d=c.Convert.toInt(a[0]),e=[],f=1;f<a.length;f++)e[f-1]=a[f];var g=c.Functions,h=g._StatHelper;if(1===d||101===d)return h.__averageIncludeSubtotals(e,!1);if(2===d||102===d)return h.__countIncludeSubtotals(e,!1);if(3===d||103===d)return h.__countaIncludeSubtotals(e,!1);if(4===d||104===d)return h.__maxIncludeSubtotals(e,!1);if(5===d||105===d)return h.__minIncludeSubtotals(e,!1);if(6===d||106===d)return pb(e,!1);if(7===d||107===d)return h.__stdevIncludeSubtotals(e,!1);if(8===d||108===d)return h.__stdevpIncludeSubtotals(e,!1);if(9===d||109===d){if(!e||e.length<1)throw b.SR.Exp_InvalidArgument;for(var i={value:0,includeSubtotal:!1},j=0;j<e.length&&r(e[j],jb,i)!==!1;j++);return i.value}return 10===d||110===d?h.__varrIncludeSubtotals(e,!1):11===d||111===d?h.__varpIncludeSubtotals(e,!1):we}function ub(a){var b=c.Convert,e=b.toDouble(a[0]),f=b.toDouble(a[1]);if(isNaN(e)||isNaN(f))return we;if(0===e||0===f)return 0;if(e>0&&0>f)return Ae;var g=d.Functions._MathHelper;return 0>e&&f>0?(f=-f,g.approxCeiling(e/f)*f):g.approxFloor(e/f)*f}function vb(a){var b=c.Convert,e=b.toDouble(a[0]),f=b.toDouble(a[1]);return isNaN(e)||isNaN(f)?we:0===e||0===f?0:0>e&&f>0||0>f&&e>0?Ae:d.Functions._MathHelper.approxFloor(e/f+.5)*f}function wb(a){var b=c.Convert,e=b.toDouble(a[0]);if(isNaN(e))return we;var f=b.toInt(a[1]),g=d.Functions._MathHelper,h=g.pow10(_d(f));return 0>f?e/=h:e*=h,e=0>e?g.approxCeiling(e-.5):g.approxFloor(e+.5),0>f?e*=h:e/=h,b.toResult(e)}function xb(a){var b=c.Convert,e=b.toDouble(a[0]);if(isNaN(e))return we;var f=b.toInt(a[1]),g=d.Functions._MathHelper,h=g.pow10(_d(f));return 0>f?e/=h:e*=h,e=0>e?g.approxCeiling(e):g.approxFloor(e),0>f?e*=h:e/=h,b.toResult(e)}function yb(a){var b=c.Convert,e=b.toDouble(a[0]);if(isNaN(e))return we;var f=b.toInt(a[1]),g=d.Functions._MathHelper,h=g.pow10(_d(f));return 0>f?e/=h:e*=h,e=0>e?g.approxFloor(e):g.approxCeiling(e),0>f?e*=h:e/=h,b.toResult(e)}function zb(a){var b=c.Convert,e=b.toDouble(a[0]);if(isNaN(e))return we;var f=c._Helper._argumentExists(a,1)?b.toInt(a[1]):0,g=d.Functions._MathHelper,h=g.pow10(_d(f));return 0>f?e/=h:e*=h,e=0>e?g.approxCeiling(e):g.approxFloor(e),0>f?e*=h:e/=h,b.toResult(e)}function Ab(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(me(b))}function Bb(a){var b=c.Convert,d=b.toDouble(a[0]);if(isNaN(d))return we;var e;if(c._Helper._argumentExists(a,1)){if(e=b.toDouble(a[1]),isNaN(e))return we}else e=10;return 0>=d||0>=e?Ae:1===e?ve:b.toResult(Ge.log(d,e))}function Cb(a){var b=c.Convert,d=b.toDouble(a[0]);return isNaN(d)?we:0>=d?Ae:b.toResult(Ge.log10(d))}function Db(a,b,e){var f=0;if(a===$d||a===Zd)return f;var g=c.Convert,h=d.Functions._MathHelper.parseCriteria(a),i=b instanceof c.CalcArray,j=e instanceof c.CalcArray,k=b,l=b,m=e,n=e,o=i?1:l.getRangeCount();if(o!=(j?1:n.getRangeCount()))return we;var p=i?k.getRowCount():l.getRowCount(0);if(p!=(j?m.getRowCount():n.getRowCount(0)))return we;var q=i?k.getColumnCount():l.getColumnCount(0);if(q!=(j?m.getColumnCount():n.getColumnCount(0)))return we;for(var r=i?[k.getAllValue()]:l.getAllValue(),s=j?[m.getAllValue()]:n.getAllValue(),t=0;o>t;t++)for(var u=0;p>u;u++)for(var v=0;q>v;v++){var w=r[t][u][v];if(w instanceof c.CalcError)return w;if(h&&h(w)){var x=s[t][u][v];if(g.isNumber(x))f+=g.toDouble(x);else if(x instanceof c.CalcError)return x}}return g.toResult(f)}function Eb(a){var d=a[0],e=a[1];if(e===$d||e===Zd)throw b.SR.Exp_CriteriaIsNull;var f,g,h=c._Helper._argumentExists(a,2)?a[2]:a[0],i=c.Convert,j=a[1];if(i._isCalcReference(j))return f=j.getRowCount(0),g=j.getColumnCount(0),1===f&&1===g?Db(j.getValue(0,0,0),d,h):new c._TernaryCompositeConcreteReference(j.getSource(),j.getRow(0),j.getColumn(0),f,g,Db,d,h);var k=a[1];if(i._isCalcArray(k)){i._inArray=!0,f=k.getRowCount(),g=k.getColumnCount();for(var l=new c._ConcreteArray(k,g),m=0;f>m;m++)for(var n=0;g>n;n++)l._array[m][n]=Db(k.getValue(m,n),d,h);return i._inArray=!1,l}return Db(e,d,h)}function Fb(a){if(a.length<3||a.length%2!==1)return!1;for(var b=c._ArrayHelper.getRowCount(a[0]),d=c._ArrayHelper.getColumnCount(a[0]),e=1;e<a.length;e+=2){if(b!==c._ArrayHelper.getRowCount(a[e]))return!1;if(d!==c._ArrayHelper.getColumnCount(a[e]))return!1}return!0}function Gb(a){if(!Fb(a))return we;for(var b=0,e=a[0],f=c.Convert,g=c._ArrayHelper,h=g.getLength(a[0]),i=[],j=[],k=1;k<a.length;k+=2){var l=a[k],m=a[k+1],n=d.Functions._MathHelper.parseCriteria(m);i.push(l),j.push(n)}for(var o=i.length,p=0;h>p;p++){for(var q=!0,k=0;o>k;k++){var l=i[k],n=j[k],r=g.getValueByIndex(l,p);if(q=n&&n(r),!q)break}if(q){var s=g.getValueByIndex(e,p);if(f.isNumber(s))b+=f.toDouble(s);else if(f.isError(s))return s}}return f.toResult(b)}function Hb(a){for(var b=0,d=c.Convert,e=c._ArrayHelper,f=e.getRowCount(a[0]),g=e.getColumnCount(a[0]),h=1;h<a.length;h++){if(f!==e.getRowCount(a[h]))return we;if(g!==e.getColumnCount(a[h]))return we}for(var i=0;f>i;i++)for(var j=0;g>j;j++){for(var k=1,l=0;l<a.length;l++){var m=e.getValue(a[l],i,j);if(d.isError(m))return m;d.isNumber(m)?k*=d.toDouble(m):k=0}b+=k}return d.toResult(b)}function Ib(a){for(var b,d=0,e=c.Convert,f=c._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++){var i=f.getValueByIndex(a[g],h);if(e.isNumber(i))b=e.toDouble(i),d+=b*b;else if(e.isError(i))return e._inArray=!1,i}e._inArray=!1}else{if(isNaN(b=e.toDouble(a[g])))return we;d+=b*b}}return e.toResult(d)}function Jb(a){var b,d,e=0,f=c.Convert,g=c._ArrayHelper;if(g.getLength(a[0])!==g.getLength(a[1]))return ze;if(f.isError(a[0]))return a[0];if(f.isError(a[1]))return a[1];if(g.isArrayOrReference(a[0])){for(var h=0;h<g.getLength(a[0]);h++){var i=g.getValueByIndex(a[0],h),j=g.getValueByIndex(a[1],h);if(f.isNumber(i)&&f.isNumber(j))b=f.toDouble(i),d=f.toDouble(j),e+=b*b-d*d;else{if(f.isError(i))return f._inArray=!1,i;if(f.isError(j))return f._inArray=!1,j}}f._inArray=!1}else{if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1])))return we;e+=b*b-d*d}return e}function Kb(a){var b,d,e=0,f=c.Convert,g=c._ArrayHelper;if(g.getLength(a[0])!==g.getLength(a[1]))return ze;if(f.isError(a[0]))return a[0];if(f.isError(a[1]))return a[1];if(g.isArrayOrReference(a[0])){for(var h=0;h<g.getLength(a[0]);h++){var i=g.getValueByIndex(a[0],h),j=g.getValueByIndex(a[1],h);if(f.isNumber(i)&&f.isNumber(j))b=f.toDouble(i),d=f.toDouble(j),e+=b*b+d*d;else{if(f.isError(i))return f._inArray=!1,i;if(f.isError(j))return f._inArray=!1,j}}f._inArray=!1}else{if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1])))return we;e+=b*b+d*d}return f.toResult(e)}function Lb(a){var b,d,e=0,f=c.Convert,g=c._ArrayHelper;if(g.getLength(a[0])!==g.getLength(a[1]))return ze;if(f.isError(a[0]))return a[0];if(f.isError(a[1]))return a[1];if(g.isArrayOrReference(a[0])){for(var h=0;h<g.getLength(a[0]);h++){var i=g.getValueByIndex(a[0],h),j=g.getValueByIndex(a[1],h);if(f.isNumber(i)&&f.isNumber(j))b=f.toDouble(i),d=f.toDouble(j),e+=(b-d)*(b-d);else{if(f.isError(i))return f._inArray=!1,i;if(f.isError(j))return f._inArray=!1,j}}f._inArray=!1}else{if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1])))return we;e+=(b-d)*(b-d)}return f.toResult(e)}function Mb(a){var b,d,e,f=c.Convert,g=c._ArrayHelper;if(isNaN(b=f.toDouble(a[0]))||isNaN(e=f.toInt(a[1]))||isNaN(d=f.toInt(a[2])))return we;for(var h=a[3],i=0,j=0;j<g.getLength(h);j++){var k;if(isNaN(k=f.toDouble(g.getValueByIndex(h,j))))return we;i+=k*qe(b,e+j*d)}return f.toResult(i)}function Nb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:0>b?Ae:d.toResult(ae(b*oe))}function Ob(a){var b;return isNaN(b=c.Convert.toDouble(a[0]))?we:oe*b/180}function Pb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(he(b))}function Qb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:-1>b||b>1?Ae:d.toResult(ie(b))}function Rb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult((me(b)+me(-b))/2)}function Sb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:1>b?Ae:d.toResult(ne(b+ae(b*b-1)))}function Tb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(fe(b))}function Ub(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:-1>b||b>1?Ae:d.toResult(ge(b))}function Vb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult((me(b)-me(-b))/2)}function Wb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(ne(b+ae(b*b+1)))}function Xb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(je(b))}function Yb(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:d.toResult(ke(b))}function Zb(a){var b,d,e=c.Convert;return isNaN(b=e.toDouble(a[0]))||isNaN(d=e.toDouble(a[1]))?we:0===b&&0===d?ve:e.toResult(le(d,b))}function $b(a){var b,d=c.Convert;if(isNaN(b=d.toDouble(a[0])))return we;var e=me(b),f=me(-b);return d.toResult(e-f)/(e+f)}function _b(a){var b,d=c.Convert;return isNaN(b=d.toDouble(a[0]))?we:-1>=b||b>=1?Ae:d.toResult(ne((1+b)/(1-b))/2)}function ac(a){var b=c.Convert,d=b._toArray(a[0]);if(d.getRowCount()!==d.getColumnCount())return we;for(var e=d.getRowCount(),f=[],g=0;e>g;g++){f[g]=[e];for(var h=0;e>h;h++){var i=d.getValue(g,h);if(b.isError(i))return i;if(!b.isNumber(i))return we;f[g][h]=b.toDouble(i)}}for(var j=1,k=0;e-1>k;k++){if(0===f[k][k]){for(var l=!1,m=k+1;!l&&e>m;m++)if(0!==f[m][k]){for(var n=k;e>n;n++){var o=f[k][n];f[k][n]=f[m][n],f[m][n]=o}j*=-1,l=!0}if(!l)return 0}for(var p=k+1;e>p;p++)if(0!==f[p][k])for(var q=f[p][k]/f[k][k],r=k;e>r;r++)f[p][r]-=q*f[k][r]}for(var s=0;e>s;s++)j*=f[s][s];return j}function bc(a){var b=c.Convert,d=b._toArray(a[0]);if(d.getRowCount()!==d.getColumnCount())return we;for(var e=d.getRowCount(),f=[],g=[],h=0;e>h;h++){f[h]=[e];for(var i=0;e>i;i++){var j=d.getValue(h,i);if(b.isError(j))return j;if(!b.isNumber(j))return we;f[h][i]=b.toDouble(j)}}for(var k=0;e>k;k++){g[k]=[e];for(var l=0;e>l;l++)g[k][l]=k===l?1:0}for(var m=0;e>m;m++){if(0===f[m][m]){for(var n=!1,o=m+1;!n&&e>o;o++)if(0!==f[o][m]){for(var p=m;e>p;p++){var q=f[m][p];f[m][p]=f[o][p],f[o][p]=q}for(var r=1;e>r;r++){var s=g[m][r];g[m][r]=g[o][r],g[o][r]=s}n=!0}if(!n)return Ae}for(var t=0;e>t;t++)if(t!==m&&0!==f[t][m]){for(var u=f[t][m]/f[m][m],v=m;e>v;v++)f[t][v]-=u*f[m][v];for(var w=0;e>w;w++)g[t][w]-=u*g[m][w]}}for(var x=0;e>x;x++)for(var y=f[x][x],z=0;e>z;z++)g[x][z]/=y;return new c._ConcreteArray(g)}function cc(a){var b=c.Convert,d=b._toArray(a[0]),e=b._toArray(a[1]),f=d.getRowCount(),g=d.getColumnCount(),h=e.getRowCount(),i=e.getColumnCount();if(g!==h)return we;for(var j=[],k=[],l=[],m=0;f>m;m++){j[m]=[g];for(var n=0;g>n;n++){var o=d.getValue(m,n);if(b.isError(o))return o;if(!b.isNumber(o))return we;j[m][n]=b.toDouble(o)}}for(var p=0;h>p;p++){k[p]=[i];for(var q=0;i>q;q++){var r=e.getValue(p,q);if(b.isError(r))return r;if(!b.isNumber(r))return we;k[p][q]=b.toDouble(r)}}for(var s=0;f>s;s++){l[s]=[i];for(var t=0;i>t;t++){for(var u=0,v=0;h>v;v++)u+=j[s][v]*k[v][t];l[s][t]=u}}return new c._ConcreteArray(l)}function dc(a){for(var b=1,c=a;c>1;c--)b*=c;return b}function ec(a){for(var b=0,d=1,e=c.Convert,f=c._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++){var i=f.getValueByIndex(a[g],h);if(e.isError(i))return e._inArray=!1,i;var j=e.toInt(i);if(0>j||j>170)return e._inArray=!1,Ae;b+=j,d*=dc(j)}e._inArray=!1}else{var k=e.toInt(a[g]);if(0>k||k>170)return Ae;b+=k,d*=dc(k)}}return 0>b||b>170?Ae:dc(b)/d}function fc(){var a=pe(),b=-1+2*a;return _d(b)}function gc(a){var b=c.Convert;if(b.isError(a[1]))return a[1];if(b.isError(a[0]))return a[0];var d,e;if(isNaN(d=b.toInt(a[0]))||isNaN(e=b.toInt(a[1])))return we;if(d>e)return Ae;var f=pe();return b.toInt(d+f*(e-d+1))}function hc(){var a=[];return a.push(new Ce("M",1e3)),a.push(new Ce("D",500)),a.push(new Ce("C",100)),a.push(new Ce("L",50)),a.push(new Ce("X",10)),a.push(new Ce("V",5)),a.push(new Ce("I",1)),a}function ic(a){var b=c.Convert,d=c._Helper;if(b.isError(a[0]))return a[0];var e=b.toInt(a[0]),f=0;if(d._argumentExists(a,1)){if(b.isError(a[1]))return a[1];f="boolean"==typeof a[1]?a[1]?0:4:b.toInt(a[1])}var g=[];if(0>e||e>3999||0>f||f>4)return we;for(var h=hc(),i=0;i<h.length;i+=2){if(i>=2&&h[i-2].Value-h[i].Value<=e){for(var j=i,k=i-2,l=0;f>l&&j+1<h.length&&h[k].Value-h[j+1].Value<=e;l++)j++;g.push(h[j].Key),g.push(h[k].Key),e+=h[j].Value,e-=h[k].Value}if(i>=1&&h[i-1].Value<=e&&(g.push(h[i-1].Key),e-=h[i-1].Value),i>=1&&h[i-1].Value-h[i].Value<=e){for(var m=i,n=i-1,o=0;f>o&&m+1<h.length&&h[n].Value-h[m+1].Value<=e;o++)m++;g.push(h[m].Key),g.push(h[n].Key),e+=h[m].Value,e-=h[n].Value}for(;h[i].Value<=e;)g.push(h[i].Key),e-=h[i].Value}return g.join("")}function jc(a){for(var b=!0,d=c.Convert,e=c._ArrayHelper,f=0;f<a.length;f++)for(var g=a[f],h=0;h<e.getLength(g);h++){var i=e.getValueByIndex(g,h);if(i===$d||i===Zd)return!1;var j;try{j=d.toBool(i)}catch(k){return we}b&=j}return!!b}function kc(a){for(var b=!1,d=c.Convert,e=c._ArrayHelper,f=0;f<a.length;f++)for(var g=a[f],h=0;h<e.getLength(g);h++){var i=e.getValueByIndex(g,h);if(i!==$d&&i!==Zd){var j;try{j=d.toBool(i)}catch(k){return we}b|=j}}return!!b}function lc(a){try{var b=c.Convert.toBool(a);return!b}catch(d){return we}}function mc(a){var b=c.Convert;if(b._isCalcReference(a[0]))return a[0].getRangeCount()>1?we:new c._UnaryCompositeConcreteReference(a[0].getSource(),a[0].getRow(0),a[0].getColumn(0),a[0].getRowCount(0),a[0].getColumnCount(0),lc);if(b._isCalcArray(a[0])){b._inArray=!0;for(var d=[],e=a[0].getRowCount(),f=a[0].getColumnCount(),g=0;e>g;g++){d[g]=[f];for(var h=0;f>h;h++)d[g][h]=lc(a[0].getValue(g,h))}return b._inArray=!1,new c._ConcreteArray(d)}return lc(a[0])}function nc(a,b,d){try{var e=c.Convert.toBool(a);return e?b:d}catch(f){return we}}function oc(a){var b=a[0],d=a[1],e=c._Helper,f=e._argumentExists(a,2)?a[2]:2===a.length?!1:0,g=e.tryExtractToSingleValue(b);if(g.success)return b=g.value,nc(b,d,f);g=e.tryExtractToSingleValue(d),d=g.value;var h=g.success;g=e.tryExtractToSingleValue(f),f=g.value;for(var i=g.success,j=b.getRowCount(),k=b.getColumnCount(),l=[],m=0;j>m;m++){l[m]=[k];for(var n=0;k>n;n++)l[m][n]=nc(b.getValue(m,n),h?d:e.getArrayValue(d,m,n),i?f:e.getArrayValue(f,m,n))}return new c._ConcreteArray(l)}function pc(a,b){return c.Convert.isError(a)?b!==$d&&b!==Zd?b:0:a!==$d&&a!==Zd?a:0}function qc(a){var b=c.Convert,d=b.isError(a[0]);if(!d&&b._isCalcReference(a[0])){var e=a[0];return e.getRangeCount()>1?we:new c._BinaryCompositeConcreteReference(e.getSource(),e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0),pc,a[1])}return d?a[1]!==$d&&a[1]!==Zd?a[1]:0:a[0]!==$d&&a[0]!==Zd?a[0]:0}function rc(){return!0}function sc(){return!1}function tc(a){try{var b,d,e,f=c.Convert;if(isNaN(b=f.toInt(a[0]))||isNaN(d=f.toInt(a[1]))||isNaN(e=f.toInt(a[2])))return we;if(0>b||b>9999)return Ae;1899>=b&&(b+=1900);var g=new Date(b,d-1,e);return g<new Date(1899,11,30)?Ae:g}catch(h){return Ae}}function uc(b){var d,e,f;try{var g=c.Convert;if(isNaN(d=g.toInt(b[0]))||isNaN(e=g.toInt(b[1]))||isNaN(f=g.toInt(b[2])))return we;var h=a.spread._DateTimeHelper.fromOADate(0);return h.setHours(d),h.setMinutes(e),h.setSeconds(f),h.setMilliseconds(0),h.getHours()<0&&h.getMinutes()<0&&h.getSeconds()<0?Ae:h}catch(i){return Ae}}function vc(a){return a%400===0||a%4===0&&a%100!==0||1900===a}function wc(b){var d=c.Convert.toString(b[0]);if(d===$d||d===Zd||""===d)return we;try{var e=a.spread._DateTimeHelper.parseLocale(d),f=e.getFullYear();if(1900>f)return we;for(var g=e.getMonth(),h=e.getDate(),i=0,j=1900;f>j;j++)i+=vc(j)?366:365;for(var k=0;g>k;k++)switch(k){case 0:case 2:case 4:case 6:case 7:case 9:case 11:i+=31;break;case 1:i+=vc(f)?29:28;break;case 3:case 5:case 8:case 10:i+=30}return i+=h}catch(l){return we}}function xc(b){try{return a.spread._DateTimeHelper.parseLocale(b)}catch(c){return we}}function yc(a){var b=c.Convert.toString(a[0]);if(b===$d||b===Zd||""===b)return we;try{var d=xc(b),e=60*(60*d.getHours()+d.getMinutes())+d.getSeconds(),f=86400;return e/f}catch(g){return we}}function zc(){return new Date}function Ac(){var a=new Date;return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a}function Bc(a){try{var b=c.Convert.toDateTime(a[0]);return b.getHours()}catch(d){return we}}function Cc(a){try{var b=c.Convert.toDateTime(a[0]);return b.getMinutes()}catch(d){return we}}function Dc(a){try{var b=c.Convert.toDateTime(a[0]);return b.getSeconds()}catch(d){return we}}function Ec(a){try{var b=c.Convert.toDateTime(a[0]);return b.getDate()}catch(d){return we}}function Fc(a){try{var b=c.Convert.toDateTime(a[0]);return b.getMonth()+1}catch(d){return we}}function Gc(a){try{var b=c.Convert.toDateTime(a[0]);return b.getFullYear()}catch(d){return we}}function Hc(a){for(var b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),e=0,f=0;c>f;f++)switch(f){case 0:case 2:case 4:case 6:case 7:case 9:case 11:e+=31;break;case 1:e+=vc(b)?29:28;break;case 3:case 5:case 8:case 10:e+=30}return e+=d}function Ic(a,b){var d=Hc(a),e=new Date(a.getFullYear(),0,1).getDay();2===b&&(e-=1,0>e&&(e=6));var f=d-1-(6-e);return 0>f&&(f=0),1+c.Convert.toInt(f/7)+(f%7!==0?1:0)}function Jc(a){var b,d=c.Convert;try{b=d.toDateTime(a[0])}catch(e){return we}var f;if(isNaN(f=d.toInt(c._Helper._argumentExists(a,1)?a[1]:1)))return we;switch(f){case 1:case 2:return Ic(b,f);default:return Ae}}function Kc(a){var b;try{b=c.Convert.toDateTime(a[0])}catch(d){return we}var e;if(isNaN(e=c.Convert.toInt(c._Helper._argumentExists(a,1)?a[1]:1)))return we;var f;switch(e){case 1:f=b.getDay()+1;break;case 2:f=0===b.getDay()?7:b.getDay();break;case 3:f=0===b.getDay()?6:b.getDay()-1;break;default:return Ae}return f}function Lc(a){var b,d,e=c.Convert;try{b=e.toDateTime(a[0])}catch(f){return we}return isNaN(d=e.toInt(a[1]))?we:(b.setMonth(b.getMonth()+d),b)}function Mc(a,b){switch(b){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return vc(a)?29:28;case 3:case 5:case 8:case 10:return 30}}function Nc(a){var b,d,e=c.Convert;try{b=e.toDateTime(a[0])}catch(f){return we}if(isNaN(d=e.toInt(a[1])))return we;b.setMonth(b.getMonth()+d);var g=Mc(b.getFullYear(),b.getMonth());return b.setDate(g),b}function Oc(a,b){return a-b}function Pc(a,b){for(var c=a.length,d=0;c>d;d++){var e=a[d];if(0===Oc(e,b))return!0}return!1}function Qc(b){for(var d=c.Convert,e=c._Helper,f=c._ArrayHelper,g=d.toDateTime(b[0]),h=d.toInt(b[1]),i=e._argumentExists(b,2)?f.getLength(b[2]):0,j=[],k=0;i>k;k++)j.push(d.toDateTime(f.getValueByIndex(b[2],k)));var l=[];l[0]=g,l[1]=3;var m=Kc(l);if(d.isError(m))return m;for(var n=d.toInt(m);0>h;++h){try{g.setDate(g.getDate()-1)}catch(o){return Ae}0===n?n=6:n--,5===n||6===n?h--:Pc(j,g)&&h--}for(;h>0;--h){try{g.setDate(g.getDate()+1)}catch(p){return Ae}6===n?n=0:n++,5===n||6===n?h++:Pc(j,g)&&h++}return new a.spread._DateTimeHelper(g).toOADate()}function Rc(a){var b=c.Convert,d=c._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=d._argumentExists(a,2)?b.toBool(a[2]):!1,h=e.getDate(),i=f.getDate(),j=e.getMonth(),k=f.getMonth(),l=e.getFullYear(),m=f.getFullYear();return g?(i=31===i?30:i,h=31===h?30:h):(h=31===h?30:h,31===i&&(30>h?(i=1,k++,k>12&&(k=1,m++)):i=30)),30*(12*(m-l)+(k-j))+(i-h)}function Sc(a){return 6===a.getDay()||0===a.getDay()}function Tc(b,d,e,f){for(var g=c.Convert,h=c._Helper,i=c._ArrayHelper,j=h._argumentExists(b,2)?i.getLength(b[2]):0,k=[],l=0;j>l;l++){var m=g.toDateTime(i.getValueByIndex(b[2],l)),n=new a.spread._DateTimeHelper(m).toOADate();!Pc(k,m)&&!Sc(m)&&n>=d&&e>=n&&k.push(m)}return f-=k.length}function Uc(b,d,e){var f=c.Convert,g=a.spread._DateTimeHelper,h=f.toInt(new g(d).toOADate()-new g(b).toOADate())%7,i=f.toInt(Kc([b,2])+h);h=i>5?i-5:0;var j=0===b.getDay()?1:2;h=h>j?j:h,e-=h;var k=f.toInt(e/7*2);return e-=k}function Vc(b){var d=c.Convert,e=a.spread._DateTimeHelper,f=d.toDateTime(b[0]),g=d.toDateTime(b[1]),h=d.toInt(new e(f).toOADate()),i=d.toInt(new e(g).toOADate()),j=!1;if(h>i){var k=f,l=h;h=i,i=l,f=g,g=k,j=!0}var m=i-h+1;return m=Uc(f,g,m),0>=m?0:(m=Tc(b,h,i,m),m=j?-m:m)}function Wc(b,d,e){var f,g=c.Functions,h=g._FinancialHelper,i=c.Convert,j=h.__days_between_basis(b,d,e);if(0>j){var k;j=-j,k=b,b=d,d=k}if(1===e){var l,m,n,o,p=b.getFullYear(),q=d.getFullYear();if(l=b,l.setFullYear(l.getFullYear()+1),Oc(d,l)>0){o=q+1-p,l=new Date(p,0,1),m=new Date(q+1,0,1);var r=a.spread._DateTimeHelper;n=i.toInt(new r(m).toOADate()-new r(l).toOADate())-365*(q+1-p)}else o=1,n=vc(p)&&b.getMonth()<3||vc(q)&&256*d.getMonth()+d.getDate()>=541?1:0;var s=i.toDouble(n)/i.toDouble(o);f=365+s}else f=h.__annual_year_basis(new Date,e);return j/f}function Xc(a){var b=c.Convert,d=c._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=d._argumentExists(a,2)?b.toInt(a[2]):0;return 0>g||g>4?Ae:Wc(e,f,g)}function Yc(){var a=[];return a[0]=function(a,b){return b.getFullYear()-a.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0)},a[1]=function(a,b){return 12*(b.getFullYear()-a.getFullYear())+(b.getMonth()-a.getMonth())+(b.getDate()<a.getDate()?-1:0)},a[2]=function(a,b){return(b.getTime()-a.getTime())/864e5},a[3]=function(a,b){var c=new Date(b.getFullYear(),b.getMonth()+b.getDate()<a.getDate()?-1:0,a.getDate());return(b.getTime()-c.getTime())/864e5},a[4]=function(a,b){return b.getMonth()-a.getMonth()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?12:0)+(b.getDate()<a.getDate()?-1:0)},a[5]=function(a,b){var c=new Date(b.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0),a.getMonth(),a.getDate());return(b-c)/864e5},a}function Zc(a,c){var d;switch(c){case"Y":d=0;break;case"M":d=1;break;case"D":d=2;break;case"MD":d=3;break;case"YM":d=4;break;case"YD":d=5;break;default:throw b.SR.Exp_NotSupport}return a[d]}function $c(a){var b=c.Convert,d=b.toDateTime(a[0]),e=b.toDateTime(a[1]),f=b.toString(a[2]).toLocaleUpperCase();if(d>e)return Ae;var g=Yc(),h=Zc(g,f);if(h)try{return h(d,e)}catch(i){return we}return Ae}function _c(a){return a>=0&&31>=a||127===a||a>=128&&159>=a}function ad(a){for(var b=c.Convert.toString(a[0]),d=[],e=0;e<b.length;e++)_c(b.charCodeAt(e))||d.push(b[e]);return d.join("")}function bd(a){return" "===a||"	"===a||"\n"===a}function cd(a){for(var b=c.Convert.toString(a[0]).trim(),d=[],e=!0,f=0;f<b.length;f++){var g=b.charAt(f);(!bd(g)||e)&&d.push(g),e=!bd(g)}return d.join("")}function dd(a){var b=a.toString(),c="";0>a&&(b=b.substr(1),c="-");var d=b.split(".");if(d.length<1||d.length>2)return we;var e=[];2===d.length&&(e.push(d[1]),e.push(".")),b=d[0];for(var f=b.length-1-2;f>=0;f-=3)e.push(b.substr(f,3)),f>0&&e.push(",");return e.push(b.substring(0,f+3)),e.reverse(),c+e.join("")}function ed(a){var b=dd(a);0>a&&(b=b.substr(1));var c=[];return c.push("$"),c.push(b),0>a&&(c.push(")"),c.unshift("(")),c.join("")}function fd(a){var b,d=c.Convert,e=c._Helper;if(isNaN(b=d.toDouble(a[0])))return we;var f=e._argumentExists(a,1)?d.toInt(a[1]):2;return f>99?we:(b=d.toDouble(wb([b,f])),ed(b))}function gd(a){var b,d=c.Convert,e=c._Helper;if(isNaN(b=d.toDouble(a[0])))return we;var f=e._argumentExists(a,1)?d.toInt(a[1]):2,g=e._argumentExists(a,2)?d.toBool(a[2]):!1,h=[],i=0;return 0>f?(i=d.toInt(qe(10,_d(f))),b/=i,h[0]=b,h[1]=0):(h[0]=b,h[1]=f),b=d.toDouble(wb(h)),0>f&&(b*=i),g?b.toString():dd(b)}function hd(a){if(-1!==a.indexOf("[")&&-1!==a.indexOf("]"))for(var b=a.indexOf("["),c=a.indexOf("]",b);-1!==b&&-1!==c;){var d=a.substring(0,b-1),e=a.substring(c+1);a=d.concat(e),b=a.indexOf("["),c=-1===b?-1:a.indexOf("]",b)}return a}function id(a){var d=a[0],e=c.Convert,f=(b._StandardDateTimeFormatter,b._StandardNumberFormatter,c.Convert.toString(a[1]));if(""===f||f===Zd||f===$d)return e.toString(d);(d===Zd||d===$d)&&(d=0),f=hd(f);try{var g=new b.GeneralFormatter(f);return g.Format(d)}catch(h){return we}}function jd(b){var d=c.Convert,e=a.spread._DateTimeHelper,f=d.toString(b[0]),g=e.parseLocale(f);if(g!==$d&&g!==Zd){var h=new e(g).toOADate();return d.isError(h)?yc([g]):h}var i;return isNaN(i=parseFloat(f))?we:i}function kd(a){var b=c.Convert.toString(a[0]);return b.toLowerCase()}function ld(a){var b=c.Convert.toString(a[0]);return b.toUpperCase()}function md(a){var b=c.Convert.toInt(a[0]);return 1>b||b>255?we:String.fromCharCode(b)}function nd(a){var b=c.Convert.toString(a[0]);if(""===b||b===$d||b===Zd)return we;try{return b[0].charCodeAt(0)}catch(d){return we}}function od(a){var b=c.Convert,d=b.toString(a[0]),e=b.toInt(a[1]),f=b.toInt(a[2]),g=b.toString(a[3]);if(1>e||0>f)return we;e=ce(e,d.length+1),f=ce(f,d.length-e+1);var h=d.substring(0,e-1),i=d.substr(e-1+f);return h.concat(g).concat(i)}function pd(a){var b,d=c.Convert,e=d.toString(a[0]),f=d.toString(a[1]),g=d.toString(a[2]);if(""===f||f===$d||f===Zd)return e;if(a.length>3){var h=d.toInt(a[3]),i=0;if(1>h)return we;for(var j=0;h>j;j++){if(i=e.indexOf(f,i),-1===i)return e;i+=f.length}i-=f.length;var k=e.substring(0,i),l=e.substr(i+f.length);b=k.concat(g).concat(l)}else b=e.replace(f,g);return b}function qd(a){for(var b=[],d=a.length,e=c.Convert,f=c._ArrayHelper,g=0;d>g;g++)for(var h=f.getLength(a[g]),i=0;h>i;i++){var j=f.getValueByIndex(a[g],i);j!==$d&&j!==Zd&&b.push(e.toString(j))}return b.join("")}function rd(a){var b=c.Convert,d=c._Helper,e=b.toString(a[0]),f=d._argumentExists(a,1)?b.toInt(a[1]):1;return 0>f?we:f>=e.length?e:e.substr(0,f)}function sd(a){var b=c.Convert,d=b.toString(a[0]),e=b.toInt(a[1])-1,f=b.toInt(a[2]);return 0>e||0>f?we:e>=d.length?"":d.length<e+f?d.substr(e):d.substr(e,f)}function td(a){var b=c.Convert,d=c._Helper,e=b.toString(a[0]),f=d._argumentExists(a,1)?b.toInt(a[1]):1;return 0>f?we:e.length<f?e:e.substr(e.length-f,f)}function ud(a){var b=c.Convert,d=b.toString(a[0]),e=b.toInt(a[1]);if(0>e||32767<e*d.length)return we;for(var f=[],g=0;e>g;g++)f.push(d);return f.join("")}function vd(a){return c.Convert.toString(a[0]).length}function wd(a){var b,d=c.Convert,e=c._Helper,f=d.toString(a[0]),g=d.toString(a[1]),h=e._argumentExists(a,2)?d.toInt(a[2]):1;return 1>h||g.length<h?we:(b=g.indexOf(f,h-1),-1===b?we:b+1)}function xd(a){var b=c.Convert,d=c._Helper,e=b.toString(a[0]),f=b.toString(a[1]),g=d._argumentExists(a,2)?b.toInt(a[2]):1;if(g--,0>g)return we;var h=-1;try{if(-1===e.indexOf("*")&&-1===e.indexOf("?"))h=f.toLowerCase().indexOf(e.toLowerCase(),g);else{var i=X(e).toLowerCase(),j=new RegExp(i,"i"),k=j.exec(f);h=k!==$d&&k!==Zd?k.index:-1}}catch(l){}return-1===h?we:h+1}function yd(a){var b=c.Convert,d=b.toString(a[0]),e=b.toString(a[1]);return d===e}function zd(a){var b=a[0];return"string"==typeof b?b:""}function Ad(a,b){if(c.Convert.isError(a))b.value=!0;else if(typeof a===re){var d=c.Error._parseCore(a);b.value=d!==$d&&d!==Zd}b.value=!1}function Bd(a,b){if(c.Convert.isError(a)&&a._code!==ze._code)b.value=!0;else if(typeof a===re){var d=c.Error._parseCore(a);b.value=d!==$d&&d!==Zd&&d!==ze}b.value=!1}function Cd(a){if(a===$d||a===Zd)throw b.SR.Exp_InvalidArgument;if(a.length<1||a.length>1)throw b.SR.Exp_InvalidArgument}function Dd(a){Cd(a);var b={value:!1};return c.Convert.isError(a[0])?b.value=!0:r(a[0],Ad,b),b.value}function Ed(a){Cd(a);var b=c.Convert,d={value:!1};return b.isError(a[0])&&a[0]._code!==ze._code?d.value=!0:b.isError(a[0])&&a[0]._code===ze._code?d.value=!1:r(a[0],Bd,d),d.value}function Fd(a){return Cd(a),c.Convert.isError(a[0])?a[0]._code===ze._code:!1}function Gd(a){Cd(a);var b=a[0];if(b!==$d&&b!==Zd&&c.Convert.isError(b))switch(b._code){case ue._code:return 1;case ve._code:return 2;case we._code:return 3;case xe._code:return 4;case ye._code:return 5;case Ae._code:return 6;case ze._code:return 7}return ze}function Hd(a){return Cd(a),c.Convert.isNumber(a[0])}function Id(a){Cd(a);var b;return isNaN(b=c.Convert.toDouble(a[0]))?we:d.Functions._MathHelper.approxFloor(_d(b))%2===0}function Jd(a){Cd(a);var b;return isNaN(b=c.Convert.toDouble(a[0]))?we:d.Functions._MathHelper.approxFloor(_d(b))%2!==0}function Kd(a){Cd(a);var b=a[0],d=c.Convert;return d.isNumber(b)?d.toDouble(b):typeof b===se?b?1:0:d.isError(b)?b:0}function Ld(a){return Cd(a),a[0]===$d||a[0]===Zd}function Md(a){return Cd(a),typeof a[0]===se}function Nd(a){return Cd(a),typeof a[0]===re}function Od(a){return Cd(a),typeof a[0]!==re}function Pd(a){return Cd(a),c.Convert._isCalcReference(a[0])}function Qd(a){Cd(a);var b=a[0],d=c.Convert;return d.isNumber(b)?1:typeof b===re?2:typeof b===se?4:d.isError(b)?16:d._isCalcArray(b)?64:we}function Rd(){return ze}function Sd(a){var b=c.Convert,d=c._Helper,e=b._toArray(a[0]),f=new c.CalcArray;f=d._argumentExists(a,1)?b._toArray(a[1]):e;var g,h,i=d._argumentExists(a,2)?b._toArray(a[2]):f,j=d._argumentExists(a,3)?b.toBool(a[3]):!0;for(g=0;g<e.getRowCount();g++)for(h=0;h<e.getColumnCount();h++)if(!b.isNumber(e.getValue(g,h)))return we;for(g=0;g<f.getRowCount();g++)for(h=0;h<f.getColumnCount();h++)if(!b.isNumber(f.getValue(g,h)))return we;for(g=0;g<i.getRowCount();g++)for(h=0;h<i.getColumnCount();h++)if(!b.isNumber(i.getValue(g,h)))return we;var k,l,m,n,o,p,q,r,s,t;if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()){n=f.getRowCount()*f.getColumnCount();var u,v=0,w=0,x=0,y=0;for(g=0;g<f.getRowCount();g++)for(h=0;h<f.getColumnCount();h++){if(isNaN(o=b.toDouble(f.getValue(g,h)))||isNaN(p=b.toDouble(e.getValue(g,h))))return we;v+=o,w+=o*o,x+=p,y+=o*p}for(j?(m=(n*y-v*x)/(n*w-v*v),u=(x*w-v*y)/(n*w-v*v)):(m=y/w,u=0),q=[],g=0;g<i.getRowCount();g++)for(q[g]=[],h=0;h<i.getColumnCount();h++){if(isNaN(o=b.toDouble(i.getValue(g,h))))return we;q[g][h]=m*o+u}return q}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){if(p=[],o=[],1===e.getColumnCount()){for(n=f.getRowCount(),m=f.getColumnCount(),g=0;n>g;g++){if(isNaN(k=b.toDouble(e.getValue(g,0))))return we;p[g]=k}for(g=0;n>g;g++)for(o[g]=[],h=0;m>h;h++){if(isNaN(k=b.toDouble(f.getValue(g,h))))return we;o[g][h]=k}}else{for(n=f.getColumnCount(),m=f.getRowCount(),o=[],p=[],g=0;n>g;g++){if(isNaN(k=b.toDouble(e.getValue(0,g))))return we;p[g]=k}for(g=0;n>g;g++)for(o[g]=[],h=0;m>h;h++){if(isNaN(k=b.toDouble(f.getValue(h,g))))return we;o[g][h]=k}}var z=[];for(l=0;m+1>l;l++)z[l]=[];for(var A=0;m+1>A;A++)for(var B=0;m+2>B;B++)z[A][B]=0;for(l=0;n>l;l++)for(z[0][m+1]=z[0][m+1]+p[l],g=0;m>g;g++)for(z[0][g+1]=z[0][g+1]+o[l][g],z[g+1][0]=z[0][g+1],z[g+1][m+1]=z[g+1][m+1]+o[l][g]*p[l],h=g;m>h;h++)z[h+1][g+1]=z[h+1][g+1]+o[l][g]*o[l][h],z[g+1][h+1]=z[h+1][g+1];if(z[0][0]=n,j)for(g=0;m+1>g;g++){if(0===z[g][g]){for(r=!1,h=g+1;!r&&m+1>h;h++)if(0!==z[h][g]){for(l=0;m+2>l;l++)t=z[g][l],z[g][l]=z[h][l],z[h][l]=t;r=!0}if(!r)return ze}for(s=1/z[g][g],l=0;m+2>l;l++)z[g][l]=z[g][l]*s;for(h=0;m+1>h;h++)if(h!==g)for(s=-z[h][g],l=0;m+2>l;l++)z[h][l]=z[h][l]+s*z[g][l]}else for(g=1;m+1>g;g++){if(0===z[g][g]){for(r=!1,h=g+1;!r&&m+1>h;h++)if(0!==z[h][g]){for(l=0;m+2>l;l++)t=z[g][l],z[g][l]=z[h][l],z[h][l]=t;
r=!0}if(!r)return ze}for(s=1/z[g][g],l=1;m+2>l;l++)z[g][l]=z[g][l]*s;for(h=1;m+1>h;h++)if(h!==g)for(s=-z[h][g],l=1;m+2>l;l++)z[h][l]=z[h][l]+s*z[g][l];z[0][m+1]=0}if(1===e.getColumnCount()){for(q=[],g=0;g<i.getRowCount();g++){for(q[g]=[],s=z[0][m+1],h=0;m>h;h++){if(isNaN(k=b.toDouble(i.getValue(g,h))))return we;s+=z[h+1][m+1]*k}q[g][0]=s}return q}for(q=[],q[0]=[],g=0;g<i.getColumnCount;g++){for(s=z[0][m+1],h=0;m>h;h++){if(isNaN(k=b.toDouble(i.getValue(h,g))))return we;s+=z[h+1][m+1]*k}q[0][g]=s}return q}return ze}function Td(a){var b=c.Convert,d=c._Helper,e=b._toArray(a[0]),f=[];f=d._argumentExists(a,1)?b._toArray(a[1]):e;var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=d._argumentExists(a,2)?b._toArray(a[2]):f,v=d._argumentExists(a,3)?b.toBool(a[3]):!0;for(i=0;i<e.getRowCount();i++)for(j=0;j<e.getColumnCount();j++){if(s=e.getValue(i,j),b.isError(s))return s;if(!b.isNumber(s))return we;if(b.toDouble(s)<=0)return Ae}for(i=0;i<f.getRowCount();i++)for(j=0;j<f.getColumnCount();j++){if(s=f.getValue(i,j),b.isError(s))return s;if(!b.isNumber(s))return we}for(i=0;i<u.getRowCount();i++)for(j=0;j<u.getColumnCount();j++){if(s=u.getValue(i,j),b.isError(s))return s;if(!b.isNumber(s))return we}if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()){l=f.getRowCount()*f.getColumnCount();var w,x=0,y=0,z=0,A=0;for(i=0;i<f.getRowCount();i++)for(j=0;j<f.getColumnCount();j++){if(isNaN(m=b.toDouble(f.getValue(i,j)))||isNaN(n=b.toDouble(e.getValue(i,j))))return we;n=ne(n),x+=m,y+=m*m,z+=n,A+=m*n}for(v?(k=(l*A-x*z)/(l*y-x*x),w=(z*y-x*A)/(l*y-x*x)):(k=A/y,w=0),q=[],i=0;i<u.getRowCount();i++)for(q[i]=[],j=0;j<u.getColumnCount();j++){if(isNaN(m=b.toDouble(u.getValue(i,j))))return we;q[i][j]=me(k*m+w)}return q}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){if(n=[],m=[],1===e.getColumnCount()){for(l=f.getRowCount(),k=f.getColumnCount(),i=0;l>i;i++){if(isNaN(g=b.toDouble(e.getValue(i,0))))return we;n[i]=ne(g)}for(i=0;l>i;i++)for(m[i]=[],j=0;k>j;j++){if(isNaN(g=b.toDouble(f.getValue(i,j))))return we;m[i][j]=g}}else{for(l=f.getColumnCount(),k=f.getRowCount(),m=[],n=[],i=0;l>i;i++){if(isNaN(g=b.toDouble(e.getValue(0,i))))return we;n[i]=g}for(i=0;l>i;i++)for(m[i]=[],j=0;k>j;j++){if(isNaN(g=b.toDouble(f.getValue(j,i))))return we;m[i][j]=g}}var B=[];for(o=0;k+1>o;o++)for(B[o]=[],p=0;k+2>p;p++)B[o][p]=0;var C=[];for(o=0;k+2>o;o++)C[o]=0;for(h=0;l>h;h++)for(C[k+1]=C[k+1]+n[h]*n[h],B[0][k+1]=B[0][k+1]+n[h],C[0]=B[0][k+1],i=0;k>i;i++)for(B[0][i+1]=B[0][i+1]+m[h][i],B[i+1][0]=B[0][i+1],B[i+1][k+1]=B[i+1][k+1]+m[h][i]*n[h],C[i+1]=B[i+1][k+1],j=i;k>j;j++)B[j+1][i+1]=B[j+1][i+1]+m[h][i]*m[h][j],B[i+1][j+1]=B[j+1][i+1];if(B[0][0]=l,v)for(r=0;k+1>r;r++){for(i=r;k+1>i&&0===B[i][r];)i++;if(i>=k+1)return ze;for(t=0;k+2>t;t++)s=B[r][t],B[r][t]=B[i][t],B[i][t]=s;for(s=1/B[r][r],t=0;k+2>t;t++)B[r][t]=B[r][t]*s;for(i=0;k+1>i;i++)if(i!==r)for(s=-B[i][r],t=0;k+2>t;t++)B[i][t]=B[i][t]+s*B[r][t]}else for(r=1;k+1>r;r++){for(i=r;k+1>i&&0===B[i][r];)i++;if(i>=k+1)return ze;for(t=1;k+2>t;t++)s=B[r][t],B[r][t]=B[i][t],B[i][t]=s;for(s=1/B[r][r],B[r][t]=B[r][t]*s,i=1;k+1>i;i++)i!==r&&(s=-B[i][r],B[i][t]=B[i][t]+s*B[r][t]);B[0][k+1]=0}if(1===e.getColumnCount()){for(q=[],i=0;i<u.getRowCount();i++){for(q[i]=[],s=B[0][k+1],j=0;k>j;j++){if(isNaN(g=b.toDouble(u.getValue(i,j))))return we;s+=B[j+1][k+1]*g}q[i][0]=me(s)}return q}for(q=[],q[0]=[],i=0;i<u.getColumnCount();i++){for(s=B[0][k+1],j=0;k>j;j++){if(isNaN(g=b.toDouble(u.getValue(j,i))))return we;s+=B[j+1][k+1]*g}q[0][i]=me(s)}return q}return ze}function Ud(a){var b,d=c.Convert,e=c._ArrayHelper;if(isNaN(b=d.toDouble(a[0])))return we;var f,g,h,i,j=0,k=0,l=0,m=0,n=e.getLength(a[1]);if(n!==e.getLength(a[2]))return ze;for(var o=0,p=0;n>p;p++){var q=e.getValueByIndex(a[1],p),r=e.getValueByIndex(a[2],p);if(d.isNumber(q)&&d.isNumber(r))f=d.toDouble(q),g=d.toDouble(r),j+=f,k+=g,l+=g*g,m+=g*f,o++;else{if(d.isError(q))return q;if(d.isError(r))return r}}return 0===o?ve:o*l-k*k===0?ve:(i=(o*m-k*j)/(o*l-k*k),h=j/o-i*(k/o),d.toResult(h+i*b))}function Vd(a){return Fe.__averageIncludeSubtotals(a,!0)}function Wd(a){return Fe.__stdevIncludeSubtotals(a,!0)}function Xd(a){var b,d=c.Convert,e=c._ArrayHelper;if(isNaN(b=d.toDouble(a[1])))return we;var f,g=[];if(d.isError(a[0]))return a[0];if(e.isArrayOrReference(a[0])){for(var h=0;h<e.getLength(a[0]);h++){var i=e.getValueByIndex(a[0],h);if(d.isNumber(i))f=d.toDouble(i),g.push(f);else if(d.isError(i))return c.Convert._inArray=!1,i}c.Convert._inArray=!1}else{if(isNaN(f=d.toDouble(a[0])))return we;g.push(f)}if(g.sort(function(a,b){return a-b}),0===g.length)return Ae;if(0>b||b>1)return Ae;var j=b*(g.length-1),k=j%1;return j=parseInt(j.toString(),10),0===k?g[j]:d.toDouble(g[j])+k*(d.toDouble(g[j+1])-d.toDouble(g[j]))}b.feature("calc.functions",["calc.common"]);var Yd=jQuery,Zd=null,$d=void 0,_d=Math.abs,ae=Math.sqrt,be=Math.max,ce=Math.min,de=Math.floor,ee=Math.ceil,fe=Math.sin,ge=Math.asin,he=Math.cos,ie=Math.acos,je=Math.tan,ke=Math.atan,le=Math.atan2,me=Math.exp,ne=Math.log,oe=Math.PI,pe=Math.random,qe=Math.pow,re="string",se="boolean",te=c.Errors,ue=te.Null,ve=te.DivideByZero,we=te.Value,xe=te.Reference,ye=te.Name,ze=te.NotAvailable,Ae=te.Number;d.Functions=c.Functions,d.Functions._builtInFunctions=d.Functions._builtInFunctions||{},d._defineBuildInFunction=e,d.def=e;var Be=function(){function a(){}return a.days360=Rc,a.yearfrac=Xc,a}();d._DateHelper=Be,d.acceptsAny=f,d.acceptsNone=g,d.acceptsNotZero=h,d.acceptsOne=i,d.acceptsTwo=j,d.acceptsZeroTwo=k,d.acceptsZeroOdd=l,d.acceptsThree=m,d.isVolatile=n,d.acceptsOneTwo=o,d.isBranch=p,d.acceptsZero=q,d.findTestArgument=s,d.acceptAboveZero=u,d.acceptsSecond=v,d.acceptsSecondOrThirdOrFourth=w,d.acceptsThird=x,d.acceptsFirstOrThird=y,d.acceptsFirstOrOne=z,d.acceptsFirstOrOdd=A,d.acceptsFirst=B,d.acceptsFirstOrSecondOrThird=C,d.acceptsEven=D,d.acceptsFourth=E,d.acceptsNotFourth=F,d.acceptsFourthOrFifth=G,d.acceptsNotSecond=H,d.acceptsThreeFour=I,d.acceptsPositive=J,d.acceptsFour=K,d.acceptsFourFive=L,d.acceptsFive=M,d.acceptsSix=N,d.acceptsEight=O,d.acceptsSeven=P,d.acceptsNotTwo=Q,d.acceptsFiveSix=R,d.acceptsFourSixSeven=S,d.acceptsThreeFourFive=T,d.acceptsMoreThanOne=U,d.acceptsTwoThreeFour=V,d.acceptsOneTwoThree=W;var Ce=function(){function a(a,b){this.Key=a,this.Value=b}return a}(),De=[/\\/g,/\(/g,/\[/g,/\{/g,/\^/g,/\$/g,/\|/g,/\)/g,/\+/g,/\./g],Ee=function(){function b(){}return b.__isLeapYear=function(a){return a%400===0||a%4===0&&a%100!==0||1900===a},b.__compareDateTime=function(a,b){return a-b},b.__toOADate=function(b){return new a.spread._DateTimeHelper(b).toOADate()},b.__annual_year_basis=function(a,c){var d;switch(c){case 0:return 360;case 1:return d=b.__isLeapYear(a.getFullYear()),d?366:365;case 2:return 360;case 3:return 365;case 4:return 360;default:return-1}},b.__getDaysInMonth=function(a,c){switch(c){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return b.__isLeapYear(a)?29:28;case 3:case 5:case 8:case 10:return 30}},b.__Days_Between_BASIS_30E_360=function(a,b){var c,d,e,f,g,h;return c=a.getFullYear(),d=a.getMonth(),e=a.getDate(),f=b.getFullYear(),g=b.getMonth(),h=b.getDate(),31===e&&(e=30),31===h&&(h=30),360*(f-c)+30*(g-d)+(h-e)},b.__Days_Between_BASIS_30Ep_360=function(a,b){var c,d,e,f,g,h;return c=a.getFullYear(),d=a.getMonth(),e=a.getDate(),f=b.getFullYear(),g=b.getMonth(),h=b.getDate(),31===e&&(e=30),31===h&&(h=1,g++),360*(f-c)+30*(g-d)+(h-e)},b.__Days_Between_BASIS_MSRB_30_360_SYM=function(a,c){var d,e,f,g,h,i;return d=a.getFullYear(),e=a.getMonth(),f=a.getDate(),g=c.getFullYear(),h=c.getMonth(),i=c.getDate(),2===e&&b.__getDaysInMonth(d,e)===f&&(f=30),2===h&&b.__getDaysInMonth(g,h)===i&&(i=30),31===i&&f>=30&&(i=30),31===f&&(f=30),360*(g-d)+30*(h-e)+(i-f)},b.__Days_Between_BASIS_MSRB_30_360=function(a,c){var d,e,f,g,h,i;return d=a.getFullYear(),e=a.getMonth(),f=a.getDate(),g=c.getFullYear(),h=c.getMonth(),i=c.getDate(),2===e&&b.__getDaysInMonth(d,e)===f&&2===h&&b.__getDaysInMonth(g,h)===i&&(f=30,i=30),31===i&&f>=30&&(i=30),31===f&&(f=30),360*(g-d)+30*(h-e)+(i-f)},b.__days_between_basis=function(a,d,e){var f=1;if(b.__compareDateTime(a,d)>0){var g=a;a=d,d=g,f=-1}switch(e){case 1:case 2:case 3:return f*c.Convert.toInt(b.__toOADate(d)-b.__toOADate(a));case 4:return f*b.__Days_Between_BASIS_30E_360(a,d);case 5:return f*b.__Days_Between_BASIS_30Ep_360(a,d);case 6:return f*b.__Days_Between_BASIS_MSRB_30_360_SYM(a,d);default:return f*b.__Days_Between_BASIS_MSRB_30_360(a,d)}},b}();d._FinancialHelper=Ee;var Fe=function(){function a(){}return a.__dev1=function(a,b,d){for(var e=c.Convert,f=c._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++)if(d||!f.isSubtotalByIndex(a[g],h)){var i=f.getValueByIndex(a[g],h);if(e.isNumber(i)){var j=e.toDouble(i);b.sumx+=j,b.sumx2+=j*j,b.n++}else if(e.isError(i))return c.Convert._inArray=!1,i}c.Convert._inArray=!1}else{var k;if(isNaN(k=e.toDouble(a[g])))return we;b.sumx+=k,b.sumx2+=k*k,b.n++}}},a.st_normsdist=function(a){var b,d=c.Convert;if(isNaN(b=d.toDouble(a[0])))return we;var e,f,g,h=6;return 0===b?f=0:(e=.5*_d(b),e>=.5*h?f=1:1>e?(g=e*e,f=((((((((.000124818987*g-.001075204047)*g+.005198775019)*g-.019198292004)*g+.059054035642)*g-.151968751364)*g+.319152932694)*g-.5319230073)*g+.797884560593)*e*2):(e-=2,f=(((((((((((((-45255659e-12*e+.00015252929)*e-19538132e-12)*e-.000676904986)*e+.001390604284)*e-.00079462082)*e-.002034254874)*e+.006549791214)*e-.010557625006)*e+.011630447319)*e-.009279453341)*e+.005353579108)*e-.002141268741)*e+.000535310849)*e+.999936657524)),b>0?.5*(f+1):.5*(1-f)},a.__averageIncludeSubtotals=function(a,b){for(var d=0,e=0,f=c.Convert,g=c._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h])){for(var i=0;i<g.getRangeCount(a[h]);i++)for(var j=0;j<g.getLength(a[h],i);j++)if(b||!g.isSubtotalByIndex(a[h],j,i)){var k=g.getValueByIndex(a[h],j,i);if(f.isNumber(k))d+=f.toDouble(k),e++;else if(f.isError(k))return c.Convert._inArray=!1,k}c.Convert._inArray=!1}else{var l;if(isNaN(l=f.toDouble(a[h])))return we;d+=l,e++}}return 0===e?ve:f.toResult(d/e)},a.__countIncludeSubtotals=function(a,b){for(var d,e,f,g,h=0,i=c.Convert,j=0;j<a.length;j++)if(i._isCalcArray(a[j])){for(i._inArray=!0,e=a[j].getColumnCount(),d=a[j].getRowCount(),g=0;e>g;g++)for(f=0;d>f;f++)i.isNumber(a[j].getValue(f,g))&&h++;i._inArray=!1}else if(i._isCalcReference(a[j])){var k=a[j].getRangeCount();e=0,d=0;for(var l=0;k>l;l++)for(e=a[j].getColumnCount(l),g=0;e>g;g++)for(d=a[j].getRowCount(l),f=0;d>f;f++){var m;if(a[j]instanceof c._SheetRangeReference)for(var n=0;n<a[j].getSheetCount();n++)(b||!a[j].isSubtotal(n,l,f,g))&&(m=a[j].getValue(n,l,f,g));else(b||!a[j].isSubtotal(l,f,g))&&(m=a[j].getValue(l,f,g));i.isNumber(m)&&h++}}else i.isNumber(a[j])&&h++;return i.toResult(h)},a.__countaIncludeSubtotals=function(a,b){for(var d=0,e=c.Convert,f=c._ArrayHelper,g=0;g<a.length;g++)if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getRangeCount(a[g]);h++)for(var i=0;i<f.getLength(a[g],h);i++)if(b||!f.isSubtotalByIndex(a[g],i,h)){var j=f.getValueByIndex(a[g],i,h);j!==$d&&j!==Zd&&d++}c.Convert._inArray=!1}else a[g]!==$d&&a[g]!==Zd&&d++;return e.toResult(d)},a.__maxIncludeSubtotals=function(a,b){for(var d=!1,e=0,f=c.Convert,g=c._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h])){for(var i=0;i<g.getLength(a[h]);i++)if(b||!g.isSubtotalByIndex(a[h],i)){var j=g.getValueByIndex(a[h],i);if(f.isNumber(j)){var k=f.toDouble(j);(!d||k>e)&&(e=k),d=!0}else if(f.isError(j))return c.Convert._inArray=!1,j}c.Convert._inArray=!1}else{var l=f.toDouble(a[h]);if(isNaN(l))return we;(!d||l>e)&&(e=l),d=!0}}return e},a.__minIncludeSubtotals=function(a,b){for(var d,e=!1,f=0,g=c.Convert,h=c._ArrayHelper,i=0;i<a.length;i++){if(g.isError(a[i]))return a[i];if(h.isArrayOrReference(a[i])){for(var j=0;j<h.getLength(a[i]);j++)if(b||!h.isSubtotalByIndex(a[i],j)){var k=h.getValueByIndex(a[i],j);if(g.isNumber(k))d=g.toDouble(k),(!e||f>d)&&(f=d),e=!0;else if(g.isError(k))return c.Convert._inArray=!1,k}c.Convert._inArray=!1}else{if(isNaN(d=g.toDouble(a[i])))return we;(!e||f>d)&&(f=d),e=!0}}return f},a.__stdevIncludeSubtotals=function(b,d){var e={sumx:0,sumx2:0,n:0},f=a.__dev1(b,e,d),g=c.Convert;return g.isError(f)?f:e.n<=1?ve:g.toResult(ae(be(0,(e.n*e.sumx2-e.sumx*e.sumx)/(e.n*(e.n-1)))))},a.__stdevpIncludeSubtotals=function(b,d){var e={sumx:0,sumx2:0,n:0},f=a.__dev1(b,e,d),g=c.Convert;return g.isError(f)?f:e.n<=0?ve:g.toResult(ae(be(0,(e.n*e.sumx2-e.sumx*e.sumx)/(e.n*e.n))))},a.__varrIncludeSubtotals=function(b,d){var e={sumx:0,sumx2:0,n:0},f=a.__dev1(b,e,d),g=c.Convert;return g.isError(f)?f:e.n<=1?ve:g.toResult(be(0,(e.n*e.sumx2-e.sumx*e.sumx)/(e.n*(e.n-1))))},a.__varpIncludeSubtotals=function(b,d){var e={sumx:0,sumx2:0,n:0},f=a.__dev1(b,e,d),g=c.Convert;return g.isError(f)?f:e.n<=0?ve:g.toResult(be(0,(e.n*e.sumx2-e.sumx*e.sumx)/(e.n*e.n)))},a.st_percentile=Xd,a}();d._StatHelper=Fe;var Ge=function(){function a(){}return a.log=function(a,b){return isNaN(a)?a:isNaN(b)?b:1!==b&&1===a||0!==b&&b!==Number.POSITIVE_INFINITY?ne(a)/ne(b):0/0},a.log10=function(b){return a.log(b,10)},a}();d._MathHelper=function(){function b(a){var b=de(a);return d.Functions._MathHelper.approxEqual(a,b+1)?b+1:b}function e(a){var b=ee(a);return d.Functions._MathHelper.approxEqual(a,b-1)?b-1:b}function f(a,b){return a===b?!0:_d(a-b)<_d(a)/281474976710656}function g(){var a=[];return a[0]=1,a[1]=10,a[2]=100,a[3]=1e3,a[4]=1e4,a[5]=1e5,a[6]=1e6,a[7]=1e7,a[8]=1e8,a[9]=1e9,a[10]=1e10,a[11]=1e11,a[12]=1e12,a[13]=1e13,a[14]=1e14,a[15]=1e15,a[16]=1e16,a}function h(a){var b=g(),c=b[a];return c!==$d&&c!==Zd?c:qe(10,parseFloat(a))}function i(b,d){var e,f;switch(b){case 0:e=function(a,b){return b>=a},f=function(a,b){return b>=a};break;case 1:e=function(a,b){return a>=b},f=function(a,b){return a>=b};break;case 2:e=function(a,b){return a!==b},f=function(a,b){return a!==b};break;case 3:e=function(a,b){return b>a},f=function(a,b){return b>a};break;case 4:e=function(a,b){return a===b},f=function(a,b){return a===b};break;case 5:e=function(a,b){return a>b},f=function(a,b){return a>b};break;default:return function(){return!1}}var g=-1,h=!0;try{var i={value:0};d===$d||d===Zd?g=0:a.spread.Calc.Convert.tryToDouble(d.toString(),i)?g=i.value:h=!1}catch(j){h=!1}return function(a){if((a===$d||a===Zd)&&(a=""),h){var b=-1;try{if(!isNaN(b=c.Convert.toDouble(a)))return f(b,g)}catch(i){}}return e(a.toString().toUpperCase(),d!==$d&&d!==Zd?d.toString().toUpperCase():"")}}function j(a){if(c.Convert.isNumber(a))return i(4,a);for(var b="=><",d=a!==$d&&a!==Zd?a.toString().toUpperCase():"",e="\x00",f=0;2>f&&f<d.length;f++){var g=d[f];if(-1!==b.indexOf(g))if("="===g)switch(e){case"<":return i(0,d.substring(2));case">":return i(1,d.substring(2));default:return i(4,"\x00"===e?d.substring(1):a)}else{if("\x00"===e){e=g;continue}if("<"===e)return">"===g?i(2,d.substring(2)):i(3,d.substring(1));if(">"===e)return i(5,d.substring(1))}else switch(e){case"<":return i(3,d.substring(1));case">":return i(5,d.substring(1))}}return i(4,a)}function k(a,d){if(isNaN(a))return we;var f=h(_d(d));return 0>d?a/=f:a*=f,a=0>a?e(a-.5):b(a+.5),0>d?a*=f:a/=f,c.Convert.toResult(a)}function l(a,b){if(isNaN(a)||isNaN(b))return we;if(0>a||0>b||b>a)return Ae;var d=1;b=ce(a-b,b);for(var e=1;b>=e;e++)d*=a-e+1,d/=e;return c.Convert.toResult(d)}function m(a){return ne(1+a)-(1+a-1-a)/(1+a)}function n(a,b){var c;return c=_d(a)>.5?qe(1+a,b):me(b*m(a)),isFinite(c)?isNaN(c)&&(c=5e-324):c===Number.POSITIVE_INFINITY?c=1.79769e308:c===Number.NEGATIVE_INFINITY&&(c=-1.79769e308),c}function o(a){return(me(a)+me(-a))/2}function p(a){return(me(a)-me(-a))/2}return{approxFloor:b,approxCeiling:e,approxEqual:f,pow10:h,parseCriteria:j,round:k,combin:l,log10:Ge.log10,log:Ge.log,pow1p:n,log1p:m,cosh:o,sinh:p}}(),d.def("ABS",Y,{minArgs:1,maxArgs:1}),d.def("ACOS",Qb,{minArgs:1,maxArgs:1}),d.def("ASIN",Ub,{minArgs:1,maxArgs:1}),d.def("ATAN",Yb,{minArgs:1,maxArgs:1}),d.def("ATAN2",Zb,{minArgs:2,maxArgs:2}),d.def("COS",Pb,{minArgs:1,maxArgs:1}),d.def("CEILING",$,{minArgs:2,maxArgs:2}),d.def("ODD",gb,{minArgs:1,maxArgs:1}),d.def("EVEN",bb,{minArgs:1,maxArgs:1}),d.def("FLOOR",ub,{minArgs:2,maxArgs:2}),d.def("LN",eb,{minArgs:1,maxArgs:1}),d.def("SQRT",rb,{minArgs:1,maxArgs:1}),d.def("SIN",Tb,{minArgs:1,maxArgs:1}),d.def("TAN",Xb,{minArgs:1,maxArgs:1}),d.def("SIGN",lb,{minArgs:1,maxArgs:1}),d.def("GCD",nb,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("LCM",ob,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("PRODUCT",qb,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("POWER",ib,{minArgs:2,maxArgs:2}),d.def("MOD",fb,{minArgs:2,maxArgs:2}),d.def("QUOTIENT",sb,{minArgs:2,maxArgs:2}),d.def("SUBTOTAL",tb,{minArgs:2,acceptsReference:h,acceptsArray:h}),d.def("INT",Z,{minArgs:1,maxArgs:1}),d.def("MROUND",vb,{minArgs:2,maxArgs:2}),d.def("ROUND",wb,{minArgs:2,maxArgs:2}),d.def("ROUNDDOWN",xb,{minArgs:2,maxArgs:2}),d.def("ROUNDUP",yb,{minArgs:2,maxArgs:2}),d.def("TRUNC",zb,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("EXP",Ab,{minArgs:1,maxArgs:1}),d.def("LOG",Bb,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("LOG10",Cb,{minArgs:1,maxArgs:1}),d.def("SUM",kb,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("SUMIF",Eb,{minArgs:2,maxArgs:3,acceptsMissingArgument:j,acceptsReference:k,acceptsArray:k}),d.def("SUMIFS",Gb,{minArgs:3,acceptsReference:l,acceptsArray:l}),d.def("SUMPRODUCT",Hb,{minArgs:1,acceptsReference:f,acceptsArray:f,arrayArgumentEvaluateMode:1}),d.def("SUMSQ",Ib,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("SUMX2MY2",Jb,{minArgs:2,maxArgs:2,acceptsReference:f,acceptsArray:f}),d.def("SUMX2PY2",Kb,{minArgs:2,maxArgs:2,acceptsReference:f,acceptsArray:f}),d.def("SUMXMY2",Lb,{minArgs:2,maxArgs:2,acceptsReference:f,acceptsArray:f}),d.def("SERIESSUM",Mb,{minArgs:4,maxArgs:4,acceptsReference:m,acceptsArray:m}),d.def("PI",hb,{minArgs:0,maxArgs:0}),d.def("SQRTPI",Nb,{minArgs:1,maxArgs:1}),d.def("DEGREES",ab,{minArgs:1,maxArgs:1}),d.def("RADIANS",Ob,{minArgs:1,maxArgs:1}),d.def("COSH",Rb,{minArgs:1,maxArgs:1}),d.def("ACOSH",Sb,{minArgs:1,maxArgs:1}),d.def("SINH",Vb,{minArgs:1,maxArgs:1}),d.def("ASINH",Wb,{minArgs:1,maxArgs:1}),d.def("TANH",$b,{minArgs:1,maxArgs:1}),d.def("ATANH",_b,{minArgs:1,maxArgs:1}),d.def("MDETERM",ac,{minArgs:1,maxArgs:1,acceptsArray:f,acceptsReference:f}),d.def("MINVERSE",bc,{minArgs:1,maxArgs:1,acceptsArray:f,acceptsReference:f}),d.def("MMULT",cc,{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f}),d.def("FACT",cb,{minArgs:1,maxArgs:1}),d.def("FACTDOUBLE",db,{minArgs:1,maxArgs:1}),d.def("MULTINOMIAL",ec,{minArgs:1,acceptsArray:f,acceptsReference:f}),d.def("RAND",fc,{minArgs:0,maxArgs:0,isVolatile:n}),d.def("RANDBETWEEN",gc,{minArgs:2,maxArgs:2,isVolatile:n}),d.def("COMBIN",_,{minArgs:2,maxArgs:2}),d.def("ROMAN",ic,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("AND",jc,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("OR",kc,{minArgs:1,acceptsReference:f,acceptsArray:f}),d.def("NOT",mc,{minArgs:1,maxArgs:1}),d.def("IF",oc,{minArgs:2,maxArgs:3,acceptsReference:o,acceptsArray:o,acceptsError:o,acceptsMissingArgument:j,isBranch:p,findTestArgument:s,findBranchArgument:t}),d.def("IFERROR",qc,{minArgs:2,maxArgs:2,acceptsReference:q,acceptsError:q}),d.def("TRUE",rc,{minArgs:0,maxArgs:0}),d.def("FALSE",sc,{minArgs:0,maxArgs:0}),d.def("DATE",tc,{minArgs:3,maxArgs:3}),d.def("TIME",uc,{minArgs:3,maxArgs:3}),d.def("DATEVALUE",wc,{minArgs:1,maxArgs:1}),d.def("TIMEVALUE",yc,{minArgs:1,maxArgs:1}),d.def("NOW",zc,{minArgs:0,maxArgs:0,isVolatile:n}),d.def("TODAY",Ac,{minArgs:0,maxArgs:0,isVolatile:n}),d.def("HOUR",Bc,{minArgs:1,maxArgs:1}),d.def("MINUTE",Cc,{minArgs:1,maxArgs:1}),d.def("SECOND",Dc,{minArgs:1,maxArgs:1}),d.def("DAY",Ec,{minArgs:1,maxArgs:1}),d.def("MONTH",Fc,{minArgs:1,maxArgs:1}),d.def("YEAR",Gc,{minArgs:1,maxArgs:1}),d.def("WEEKNUM",Jc,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("WEEKDAY",Kc,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("EDATE",Lc,{minArgs:2,maxArgs:2}),d.def("EOMONTH",Nc,{minArgs:2,maxArgs:2}),d.def("WORKDAY",Qc,{minArgs:2,maxArgs:3,acceptsMissingArgument:j,acceptsArray:j,acceptsReference:j}),d.def("DAYS360",Rc,{minArgs:2,maxArgs:3,acceptsMissingArgument:j}),d.def("NETWORKDAYS",Vc,{minArgs:2,maxArgs:3,acceptsMissingArgument:j,acceptsArray:j,acceptsReference:j}),d.def("YEARFRAC",Xc,{minArgs:2,maxArgs:3,acceptsMissingArgument:j}),d.def("DATEDIF",$c,{minArgs:3,maxArgs:3}),d.def("CLEAN",ad,{minArgs:1,maxArgs:1}),d.def("TRIM",cd,{minArgs:1,maxArgs:1}),d.def("DOLLAR",fd,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("FIXED",gd,{minArgs:1,maxArgs:3,acceptsMissingArgument:o}),d.def("TEXT",id,{minArgs:2,maxArgs:2}),d.def("VALUE",jd,{minArgs:1,maxArgs:1}),d.def("LOWER",kd,{minArgs:1,maxArgs:1}),d.def("UPPER",ld,{minArgs:1,maxArgs:1}),d.def("CHAR",md,{minArgs:1,maxArgs:1}),d.def("CODE",nd,{minArgs:1,maxArgs:1}),d.def("REPLACE",od,{minArgs:4,maxArgs:4,acceptsMissingArgument:j}),d.def("SUBSTITUTE",pd,{minArgs:3,maxArgs:4,acceptsMissingArgument:m}),d.def("CONCATENATE",qd,{minArgs:2,acceptsArray:f}),d.def("LEFT",rd,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("MID",sd,{minArgs:3,maxArgs:3}),d.def("RIGHT",td,{minArgs:1,maxArgs:2,acceptsMissingArgument:i}),d.def("REPT",ud,{minArgs:2,maxArgs:2}),d.def("LEN",vd,{minArgs:1,maxArgs:1}),d.def("FIND",wd,{minArgs:2,maxArgs:3,acceptsMissingArgument:j}),d.def("SEARCH",xd,{minArgs:2,maxArgs:3,acceptsMissingArgument:j}),d.def("EXACT",yd,{minArgs:2,maxArgs:2}),d.def("T",zd,{minArgs:1,maxArgs:1}),d.def("ISERROR",Dd,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISERR",Ed,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISNA",Fd,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ERROR.TYPE",Gd,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISNUMBER",Hd,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISEVEN",Id,{minArgs:1,maxArgs:1}),d.def("ISODD",Jd,{minArgs:1,maxArgs:1}),d.def("N",Kd,{minArgs:1,maxArgs:1}),d.def("ISBLANK",Ld,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISLOGICAL",Md,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISTEXT",Nd,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISNONTEXT",Od,{minArgs:1,maxArgs:1,acceptsError:f}),d.def("ISREF",Pd,{minArgs:1,maxArgs:1,acceptsError:f,acceptsReference:f}),d.def("TYPE",Qd,{minArgs:1,maxArgs:1,acceptsArray:f,acceptsError:f}),d.def("NA",Rd,{minArgs:0,maxArgs:0}),d.def("TREND",Sd,{minArgs:1,maxArgs:4,acceptsReference:C,acceptsArray:C,acceptsMissingArgument:w}),d.def("GROWTH",Td,{minArgs:1,maxArgs:4,acceptsReference:F,acceptsArray:F,acceptsMissingArgument:w}),d.def("FORECAST",Ud,{minArgs:3,maxArgs:3,acceptsArray:u,acceptsReference:u}),d.def("AVERAGE",Vd,{minArgs:1,acceptsArray:f,acceptsReference:f}),d.def("STDEV",Wd,{minArgs:1,acceptsArray:f,acceptsReference:f}),d.def("PERCENTILE",Xd,{minArgs:2,maxArgs:2,acceptsArray:B,acceptsReference:B})}(c.Functions||(c.Functions={}));c.Functions}(b.Calc||(b.Calc={}));b.Calc}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("formatter",["core.common","core.globalize","core.migrate"]);var b,c=null,d=void 0,e=Math.abs,f=Math.ceil,g=Math.pow,h=Math.floor,i=Math.max,j=Math.min,k=Math.round,l={Empty:"",Format:function(){for(var a=[],b=0;b<arguments.length-0;b++)a[b]=arguments[b+0];if(0===arguments.length)return c;for(var d=a[0],e=1;e<arguments.length;e++){var f=new RegExp("\\{"+(e-1)+"\\}","gm");d=d.replace(f,arguments[e])}return d},IsNullOrEmpty:function(a){return!a||a===l.Empty}};!function(a){a[a.None=0]="None",a[a.AllowLeadingWhite=1]="AllowLeadingWhite",a[a.AllowTrailingWhite=2]="AllowTrailingWhite",a[a.AllowInnerWhite=4]="AllowInnerWhite",a[a.AllowWhiteSpaces=7]="AllowWhiteSpaces",a[a.NoCurrentDateDefault=8]="NoCurrentDateDefault",a[a.AdjustToUniversal=16]="AdjustToUniversal",a[a.AssumeLocal=32]="AssumeLocal",a[a.AssumeUniversal=64]="AssumeUniversal",a[a.RoundtripKind=128]="RoundtripKind"}(b||(b={}));var m={IsDigit:function(a){var b=a.charCodeAt(0);return b>=48&&57>=b},IsWhiteSpace:function(a){var b=a.charCodeAt(0);return b>=9&&13>=b||32===b||133===b||160===b}};!function(a){a[a.CustomMode=0]="CustomMode",a[a.StandardDateTimeMode=1]="StandardDateTimeMode",a[a.StandardNumericMode=2]="StandardNumericMode"}(a.FormatMode||(a.FormatMode={}));a.FormatMode;!function(a){a[a.General=0]="General",a[a.Number=1]="Number",a[a.DateTime=2]="DateTime",a[a.Text=3]="Text"}(a.NumberFormatType||(a.NumberFormatType={}));{var n;a.NumberFormatType}!function(a){a[a.Hour=0]="Hour",a[a.Minute=1]="Minute",a[a.Second=2]="Second"}(n||(n={}));var o=function(){function b(){}return b.DateTimeFormatInfo=function(){return a._CultureInfo.currentCulture().DateTimeFormat()},b.NumberFormatInfo=function(){return a._CultureInfo.currentCulture().NumberFormat()},b.Filter=function(a,b,e){if(a===d||a===c||""===a)return a;for(var f="",g=0,h=0;h<a.length;h++){var i=a[h];i===b?g++:i===e?(g--,0>g&&(g=0)):0===g&&(f+=i)}return f.toString()},b.TrimSquareBracket=function(c){return c&&c!==l.Empty?(c[0]===b.LeftSquareBracket&&(c=a.StringHelper.TrimStart(c,b.LeftSquareBracket)),c[c.length-1]===b.RightSquareBracket&&(c=a.StringHelper.TrimEnd(c,b.RightSquareBracket)),c):c},b.IsOperator=function(a){return a===b.LessThanSign||a===b.GreaterThanSign||a===b.EqualsThanSign},b.TrimEscape=function(c){for(var d=c.length,e=!1,f=new a.StringBuilder,g=0;d>g;g++){var h=c.charAt(g);h===b.ReverseSolidusSign?(e=!e,e||f.Append(h)):(e=!1,f.Append(h))}return f.toString()},b.AddSquareBracket=function(c){if(!c)throw new Error(a.SR.Exp_TokenIsNull);return(0===c.length||c[0]!==b.LeftSquareBracket)&&(c=a.StringHelper.Insert(c,0,b.LeftSquareBracket.toString())),(0===c.length||c[c.length-1]!==b.RightSquareBracket)&&(c=a.StringHelper.Insert(c,c.length,b.RightSquareBracket.toString())),c},b.IsEquals=function(a,b,c){return a||b?a&&b?c?a.toLowerCase()===b.toLowerCase():a===b:!1:!0},b.ReplaceKeyword=function(b,c,d){if(!b||b===l.Empty||this.IsEquals(c,d,!0))return b;for(var e=b,f=0;;){var g=a.StringHelper.IndexOf(e,c,1);if(!(g>-1))break;e=a.StringHelper.Remove(e,g,c.length),e=a.StringHelper.Insert(e,g,d),f=g+d.length}return e},b.IsDecimal=function(a,c){var d=b.DecimalSeparator;return c&&(d=c.NumberDecimalSeparator),a.indexOf(d)>-1},b.DoubleQuote='"',b.SingleQuote="'",b.Tab="	",b.LeftSquareBracket="[",b.RightSquareBracket="]",b.LessThanSign="<",b.GreaterThanSign=">",b.EqualsThanSign="=",b.PlusSign="+",b.HyphenMinus="-",b.UnderLine="_",b.LeftParenthesis="(",b.RightParenthesis=")",b.Dollar="$",b.Comma=";",b.Space=" ",b.SolidusSign="/",b.ReverseSolidusSign="\\",b.Zero="0",b.QuestionMark="?",b.Colon=":",b.Semicolon=";",b.Sharp="#",b.CommercialAt="@",b.NumberSign="#",b.Asterisk="*",b.Exponential1="E+",b.Exponential2="E-",b.DecimalSeparator=".",b.NumberGroupSeparator=",",b.PercentSymbol="%",b.NaNSymbol="NaN",b.FormatSeparator=";",b.NegativeSign="-",b.ReplacePlaceholder="@",b.ExponentialSymbol="E",b}();a.DefaultTokens=o;var p=function(){function b(b,d,e){this._classNames=["NumberFormatBase","IFormatter","IFormatProviderSupport"],this.numberFormatInfo=c,this.dateTimeFormatInfo=c,this.cultureName="";var f=this;f._initFileds(),f.partLocaleID=b,f.partDbNumberFormat=d,f.cultureName=e?e:a._CultureInfo.currentCulture().Name()}return b.prototype._initFileds=function(){var a=this;a.numberStringConverter=c,a.numberFormatInfo=c,a.dateTimeFormatInfo=c,a.partLocaleID=c,a.partDbNumberFormat=c},b.prototype.NumberStringConverter=function(a){return 0===arguments.length?this.numberStringConverter?this.numberStringConverter:c:(this.numberStringConverter=a,a)},b.prototype.PartLocaleID=function(){return a.util.asType(this.partLocaleID,"LocaleIDFormatPart")},b.prototype.PartDBNumberFormat=function(){return a.util.asType(this.partDbNumberFormat,"DBNumberFormatPart")},b.prototype.DateTimeFormatInfo=function(a){return 0===arguments.length?this.dateTimeFormatInfo:(this.dateTimeFormatInfo=a,a)},b.prototype.NumberFormatInfo=function(a){return 0===arguments.length?this.numberFormatInfo:(this.numberFormatInfo=a,a)},b.prototype.CultureName=function(a){var b=this;return 0===arguments.length?b.partLocaleID?b.partLocaleID.CultureInfo().Name():b.cultureName:(b.cultureName=a,a)},b.prototype.NumberGroupSeparator=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NumberGroupSeparator:o.NumberGroupSeparator},b.prototype.PercentSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().PercentSymbol:o.PercentSymbol},b.prototype.PositiveSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().PositiveSign:o.NumberFormatInfo().PositiveSign},b.prototype.NegativeSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NegativeSign:o.NegativeSign},b.prototype.DecimalSeparator=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NumberDecimalSeparator:o.DecimalSeparator},b.prototype.NaNSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NaNSymbol:o.NaNSymbol},b.TrimNotSupportSymbol=function(c,d){1===arguments.length&&(d=!0);for(var e=!1,f=new a.StringBuilder,g=0;g<c.length;g++){var h=c[g],i=!0;'"'===h?e=!e:e||(d||("?"===h&&(b.IsTransform(c,g)||(i=!1)),"/"===h&&(b.IsTransform(c,g)||(i=!1))),"_"===h?b.IsTransform(c,g)||(i=!1,g++):"*"===h&&(b.IsTransform(c,g)||(i=!1))),i&&f.Append(h)}return f.toString()},b.IsTransform=function(b,c){if("\\"===b[c])throw new Error(a.SR.Exp_InvalidBackslash);if(c-1>0&&c-1<b.length&&"\\"===b[c-1]){if(0>c-2)return!0;if(c-2>0&&c-2<b.length)return"\\"!==b[c-2]}return!1},b.ContainsKeywords=function(b,d){if(!b||b===l.Empty)return!1;for(var e=new a.StringBuilder,f=!1,g=c,h=0;h<b.length;h++){var i=b[h];'"'===i?f=!f:f||i!==o.UnderLine&&g!==o.UnderLine&&e.Append("E"===i?i:i.toLowerCase()),g=i}for(var j=e.toString(),k=0;k<d.length;k++){var m=d[k];if(a.StringHelper.Contains(j,m))return!0}return!1},b.prototype.Format=function(){return""},b.prototype.Parse=function(){return c},b.prototype.FormatString=function(){return""},b.prototype.ExcelCompatibleFormatString=function(){return""},b.General="General",b}(),q=function(){function b(a){var b=this;b.ShortDatePattern="d",b.LongDatePattern="D",b.FullDatePatternShortTime="f",b.FullDatePatternLongTime="F",b.GeneralDatePatternLongTimeShortTime="g",b.GeneralDatePatternLongTimeLongTime="G",b.MonthDayPattern1="m",b.MonthDayPattern2="M",b.RoundTripDatePattern1="o",b.RoundTripDatePattern2="O",b.RFC1123Pattern1="r",b.RFC1123Pattern2="R",b.SortableDatePattern="s",b.ShortTimePattern="t",b.LongTimePattern="T",b.UniversalSortableDatePattern="u",b.UniversalFullDatePattern="U",b.YearMonthPattern1="y",b.YearMonthPattern2="Y",b._classNames=["StandardDateTimeFormatter","IFormatter"],b._formatString=a}return b.prototype.EvaluateFormat=function(a){var b=this;return a===b.ShortDatePattern||a===b.LongDatePattern||a===b.FullDatePatternShortTime||a===b.FullDatePatternLongTime||a===b.GeneralDatePatternLongTimeShortTime||a===b.GeneralDatePatternLongTimeLongTime||a===b.MonthDayPattern1||a===b.MonthDayPattern2||a===b.RoundTripDatePattern1||a===b.RoundTripDatePattern2||a===b.RFC1123Pattern1||a===b.RFC1123Pattern2||a===b.SortableDatePattern||a===b.ShortTimePattern||a===b.LongTimePattern||a===b.UniversalSortableDatePattern||a===b.UniversalFullDatePattern||a===b.YearMonthPattern1||a===b.YearMonthPattern2?!0:!1},b.prototype.Format=function(b){try{return b===d||b===c||""===b?"":new a._DateTimeHelper(b).localeFormat(this._formatString)}catch(e){return b.toString()}},b.prototype.Parse=function(b){try{return b&&""!==b?a._DateTimeHelper.parseLocale(b,this._formatString):c}catch(d){return new Date(b)}},b.prototype.FormatString=function(){return this._formatString},b}();a._StandardDateTimeFormatter=q;var r=function(){function b(a){var b=this;b.CurrencyPattern1="c",b.CurrencyPattern2="C",b.DecimalPattern1="d",b.DecimalPattern2="D",b.ScientificPattern1="e",b.ScientificPattern2="E",b.FixedPointPattern1="f",b.FixedPointPattern2="F",b.GeneralPattern1="g",b.GeneralPattern2="G",b.NumberPattern1="n",b.NumberPattern2="N",b.PercentPattern1="p",b.PercentPattern2="P",b.RoundTripPattern1="r",b.RoundTripPattern2="R",b.HexadecimalPattern1="x",b.HexadecimalPattern2="X",b._classNames=["StandardNumberFormatter","IFormatter"],b._formatString=a
}return b.prototype.EvaluateFormat=function(a){var b=this;if(a&&a!==l.Empty&&a.length>0){var c=a.substr(0,1);if(c===b.CurrencyPattern1||c===b.CurrencyPattern2||c===b.DecimalPattern1||c===b.DecimalPattern2||c===b.ScientificPattern1||c===b.ScientificPattern2||c===b.FixedPointPattern1||c===b.FixedPointPattern2||c===b.GeneralPattern1||c===b.GeneralPattern2||c===b.NumberPattern1||c===b.NumberPattern2||c===b.PercentPattern1||c===b.PercentPattern2||c===b.RoundTripPattern1||c===b.RoundTripPattern2||c===b.HexadecimalPattern1||c===b.HexadecimalPattern2)return!0}return!1},b.prototype.Format=function(b){try{return b&&""!==b?new a._NumberHelper(b).localeFormat(this._formatString):""}catch(c){return b.toString()}},b.prototype.Parse=function(b){try{return b&&""!==b?a._NumberHelper.parseLocale(b):c}catch(d){var e=parseFloat(b);return isNaN(e)||!isFinite(e)?c:e}},b.prototype.FormatString=function(){return this._formatString},b}();a._StandardNumberFormatter=r;var s=function(b){function e(a,c,d,e){var f=this;b.call(this,c,d,e),f._classNames=["NumberFormatText","IFormatter"];var g=p.TrimNotSupportSymbol(a,!1);c&&(g=o.ReplaceKeyword(g,f.PartLocaleID().OriginalToken(),f.PartLocaleID().CurrencySymbol())),g=o.Filter(g,o.LeftSquareBracket,o.RightSquareBracket),g=o.TrimEscape(g),f._formatString=g}return __extends(e,b),e.prototype.Format=function(b){try{var e=a.Calc.Convert.toString(b),f=a.StringHelper.Replace(this._formatString,'"',"");return f!==c&&typeof f!==d&&(e=a.StringHelper.Replace(f,"@",e)),e}catch(g){return""}},e.prototype.Parse=function(a){return a?a:""},e.prototype.FormatString=function(){return this._formatString},e.EvaluateFormat=function(){return!0},e.prototype.DefaultDateTimeNumberStringConverter=function(){},e}(p),t=function(){function a(a){this._innerFormatter=a}return a.prototype.FormatString=function(){return this._innerFormatter?this._innerFormatter.FormatString():""},a.prototype.innerFormatter=function(a){return 0===arguments.length?this._innerFormatter:(this._innerFormatter=a,this)},a.prototype.Parse=function(a){return this._innerFormatter?this._innerFormatter.Parse(a):a},a.prototype.Format=function(a){return this._innerFormatter?this._innerFormatter.Format(a):a===d||a===c?"":a.toString()},a.prototype.toJSON=function(){return d},a}();a.AutoFormatter=t;var u=function(){function b(b,d){var e=this;e.conditionFormatPart=c,e.colorFormatPart=c,e.localeIDFormatPart=c,e.dbNumberFormatPart=c,e.numberFormat=c,e.dateTimeFormatInfo=c,e.numberFormatInfo=c,e.formatCached=c,e._classNames=["CustomNumberFormat","IFormatter","IFormatProviderSupport"],d||(d=a._CultureInfo.currentCulture().Name()),0===arguments.length?(e.formatCached=p.General,e.numberFormat=new J):e.Init(b,d)}return b.prototype.Init=function(b,e){if(b===c||b===d)throw new Error(a.SR.Exp_FormatIllegal);var f=this;f.formatCached=b;for(var g=c,h=c,i=!1,j=[],k=0;k<b.length;k++){var m=b[k];if(m===o.LeftSquareBracket){if(i)throw new Error(a.SR.Exp_FormatIllegal);h&&(g||(g=new a.StringBuilder),g.Append(h.toString()),h=c),h=new a.StringBuilder,h.Append(m),i=!0}else if(m===o.RightSquareBracket){if(!i)throw new Error(a.SR.Exp_FormatIllegal);if(!h)throw new Error(a.SR.Exp_FormatIllegal);h||(h=new a.StringBuilder),h.Append(m);var n=h.toString(),p=a.util.asType(w.Create(n),"FormatPartBase");if(p&&!a.util.isType(p,"ABSTimeFormatPart"))f.AddPart(p);else{if(!a.util.isType(p,"ABSTimeFormatPart"))throw new Error(a.SR.Exp_FormatIllegal);j.push(a.util.asType(p,"ABSTimeFormatPart")),g||(g=new a.StringBuilder),g.Append(h.toString())}h=c,i=!1}else h||(h=new a.StringBuilder),h.Append(m)}if(h){if(i)throw new Error(a.SR.Exp_FormatIllegal);g||(g=new a.StringBuilder),g.Append(h.toString())}f.localeIDFormatPart!==c&&(e=f.localeIDFormatPart.CultureInfo().Name());var q=g?g.toString():l.Empty;if(J.EvaluateFormat(q))f.numberFormat=new J(q,f.LocaleIDFormatPart(),f.dbNumberFormatPart,e);else if(G.EvaluateFormat(q)){var r=j.length>0?j:c;f.numberFormat=new G(q,r,f.LocaleIDFormatPart(),f.dbNumberFormatPart,e)}else if(I.EvaluateFormat(q))f.numberFormat=new I(b,f.LocaleIDFormatPart(),f.dbNumberFormatPart,e);else{if(!s.EvaluateFormat(q))throw new Error(a.SR.Exp_FormatIllegal);f.numberFormat=new s(b,f.LocaleIDFormatPart(),f.dbNumberFormatPart,e)}},b.prototype.FormatString=function(){var b=this,c=new a.StringBuilder;return b.numberFormat&&b.numberFormat.FormatString()&&(b.ColorFormatPart()&&c.Append(b.ColorFormatPart().toString()),b.ConditionFormatPart()&&c.Append(b.ConditionFormatPart().toString()),b.DBNumberFormatPart()&&c.Append(b.DBNumberFormatPart().toString()),b.LocaleIDFormatPart()&&c.Append(b.LocaleIDFormatPart().toString()),c.Append(b.numberFormat.FormatString())),c.toString()},b.prototype.ConditionFormatPart=function(){return this.conditionFormatPart},b.prototype.ColorFormatPart=function(){return this.colorFormatPart},b.prototype.LocaleIDFormatPart=function(){return this.localeIDFormatPart},b.prototype.DBNumberFormatPart=function(){return this.dbNumberFormatPart},b.prototype.NumberStringConverter=function(a){var b=this;return 0===arguments.length?b.numberFormat?b.numberFormat.NumberStringConverter():c:void(b.numberFormat&&b.numberFormat.NumberStringConverter(a))},b.prototype.ExcelCompatibleFormatString=function(){var b=this,c=new a.StringBuilder;return b.numberFormat&&b.numberFormat.ExcelCompatibleFormatString()&&(a.util.isType(b.numberFormat,"NumberFormatDigital")||(b.DBNumberFormatPart()&&c.Append(b.DBNumberFormatPart().toString()),b.LocaleIDFormatPart()&&c.Append(b.LocaleIDFormatPart().toString()),b.ConditionFormatPart()&&c.Append(b.ConditionFormatPart().toString()),b.ColorFormatPart()&&c.Append(b.ColorFormatPart().toString())),c.Append(b.numberFormat.ExcelCompatibleFormatString())),c.toString()},b.prototype.Formatter=function(){return this.numberFormat},b.prototype.DateTimeFormatInfo=function(a){return 0===arguments.length?this.Formatter().DateTimeFormatInfo():(this.Formatter().DateTimeFormatInfo(a),this.dateTimeFormatInfo=a,a)},b.prototype.NumberFormatInfo=function(a){return 0===arguments.length?this.Formatter().NumberFormatInfo():(this.Formatter().NumberFormatInfo(a),this.numberFormatInfo=a,a)},b.prototype.AddPart=function(b){if(!b)throw new Error(a.SR.Exp_PartIsNull);var c=this;if(a.util.isType(b,"ConditionFormatPart")){if(c.conditionFormatPart)throw new Error(a.SR.Exp_DuplicatedDescriptor);c.conditionFormatPart=a.util.asType(b,"ConditionFormatPart")}else if(a.util.isType(b,"ColorFormatPart")){if(c.colorFormatPart)throw new Error(a.SR.Exp_DuplicatedDescriptor);c.colorFormatPart=a.util.asType(b,"ColorFormatPart")}else if(a.util.isType(b,"LocaleIDFormatPart")){if(c.localeIDFormatPart)throw new Error(a.SR.Exp_DuplicatedDescriptor);c.localeIDFormatPart=a.util.asType(b,"LocaleIDFormatPart")}else if(a.util.isType(b,"DBNumberFormatPart")){if(c.dbNumberFormatPart)throw new Error(a.SR.Exp_DuplicatedDescriptor);c.dbNumberFormatPart=a.util.asType(b,"DBNumberFormatPart")}},b.prototype.Format=function(a){return""===this.formatCached?"":"."===this.formatCached?".":this.numberFormat.Format(a)},b.prototype.Parse=function(a){return this.numberFormat.Parse(a)},b}(),v=function(){function b(b,d,e){var f=this;f.formatters=c,f.formatModeType=0,f.dateTimeFormatInfo=c,f.numberFormatInfo=c,f.isSingleFormatterInfo=!0,f.isDefault=!0,f.isConstructed=!1,f.customerCultureName=c,f.PropertyChanged=[],f._classNames=["GeneralFormatter","IFormatter","INotifyPropertyChanged","IColorFormatter"],l.IsNullOrEmpty(b)&&(b=p.General),d||(d=0),f.formatCached=b,f.formatModeType=d,f.isDefault=f.formatCached.toLowerCase()===p.General.toLowerCase(),f.isConstructed=!1,f.customerCultureName=e?a._CultureInfo.getCulture(e).Name():a._CultureInfo.currentCulture().Name()}return b._needChangeDefaultFormat=function(b){if(b){var c=a._CultureInfo.currentCulture().Name().toLowerCase(),d=b.customerCultureName.toLowerCase();return d===c?!1:!0}return!0},b.DefaultNumberFormatter=function(){return b._needChangeDefaultFormat(this.defaultNumberFormatter)&&(this.defaultNumberFormatter=new b("###################0.################",0,a._CultureInfo.currentCulture().Name())),this.defaultNumberFormatter},b.DefaultGeneralFormatter=function(){return b._needChangeDefaultFormat(this.defaultGeneralFormatter)&&(this.defaultGeneralFormatter=new b),this.defaultGeneralFormatter},b.DefaultShortDatePatternFormatter=function(){return b._needChangeDefaultFormat(this.defaultShortDatePatternFormatter)&&(this.defaultShortDatePatternFormatter=new b(o.DateTimeFormatInfo().ShortDatePattern)),this.defaultShortDatePatternFormatter},b.DefaultSXDatetimePatternFormatter=function(){var a=o.DateTimeFormatInfo().ShortDatePattern+" h:mm:ss";return b._needChangeDefaultFormat(this.defaultSXDatetimePatternFormatter)&&(this.defaultSXDatetimePatternFormatter=new b(a)),this.defaultSXDatetimePatternFormatter},b.DefaultLongTimePatternFormatter=function(){var a=o.DateTimeFormatInfo().LongTimePattern;return b._needChangeDefaultFormat(this.defaultLongTimePatternFormatter)&&(this.defaultLongTimePatternFormatter=new b(a)),this.defaultLongTimePatternFormatter},b.DefaultDMMMFormatter=function(){return b._needChangeDefaultFormat(this.defaultDMMMFormatter)&&(this.defaultDMMMFormatter=new b("d-mmm",0,a._CultureInfo.currentCulture().Name())),this.defaultDMMMFormatter},b.DefaultMMMYYFormatter=function(){return b._needChangeDefaultFormat(this.defaultMMMYYFormatter)&&(this.defaultMMMYYFormatter=new b("mmm-yy",0,a._CultureInfo.currentCulture().Name())),this.defaultMMMYYFormatter},b.DefaultHMMFormatter=function(){return b._needChangeDefaultFormat(this.defaultHMMFormatter)&&(this.defaultHMMFormatter=new b("h:mm",0,a._CultureInfo.currentCulture().Name())),this.defaultHMMFormatter},b.DefaultHMMSSFormatter=function(){return b._needChangeDefaultFormat(this.defaultHMMSSFormatter)&&(this.defaultHMMSSFormatter=new b("h:mm:ss",0,a._CultureInfo.currentCulture().Name())),this.defaultHMMSSFormatter},b.DefaultHMMSS0Formatter=function(){return b._needChangeDefaultFormat(this.defaultHMMSS0Formatter)&&(this.defaultHMMSS0Formatter=new b("h:mm:ss.0",0,a._CultureInfo.currentCulture().Name())),this.defaultHMMSS0Formatter},b.DefaultComboNumberFormatter1=function(){return b._needChangeDefaultFormat(this.defaultComboNumberFormatter1)&&(this.defaultComboNumberFormatter1=new b(l.Format("{0}#,##0.00;[Red]({0}#,##0.00)",o.NumberFormatInfo().CurrencySymbol))),this.defaultComboNumberFormatter1},b.DefaultComboNumberFormatter2=function(){return b._needChangeDefaultFormat(this.defaultComboNumberFormatter2)&&(this.defaultComboNumberFormatter2=new b(l.Format("{0}#,##0;[Red]({0}#,##0)",o.NumberFormatInfo().CurrencySymbol))),this.defaultComboNumberFormatter2},b.DefaultStandardNumberFormatter=function(){return b._needChangeDefaultFormat(this.defaultStandardNumberFormatter)&&(this.defaultStandardNumberFormatter=new b("0.00E+00",0,a._CultureInfo.currentCulture().Name())),this.defaultStandardNumberFormatter},b.DefaultStandardPercentFormatter1=function(){return b._needChangeDefaultFormat(this.defaultStandardPercentFormatter1)&&(this.defaultStandardPercentFormatter1=new b("0.00%",0,a._CultureInfo.currentCulture().Name())),this.defaultStandardPercentFormatter1},b.DefaultStandardPercentFormatter2=function(){return b._needChangeDefaultFormat(this.defaultStandardPercentFormatter2)&&(this.defaultStandardPercentFormatter2=new b("0%",0,a._CultureInfo.currentCulture().Name())),this.defaultStandardPercentFormatter2},b.DefaultStandardGroupNumberFormatter1=function(){return b._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter1)&&(this.defaultStandardGroupNumberFormatter1=new b("#,##0.00",0,a._CultureInfo.currentCulture().Name())),this.defaultStandardGroupNumberFormatter1},b.DefaultStandardGroupNumberFormatter2=function(){return b._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter2)&&(this.defaultStandardGroupNumberFormatter2=new b("#,##0",0,a._CultureInfo.currentCulture().Name())),this.defaultStandardGroupNumberFormatter2},b.prototype.findDateTimeGeneralFormatter=function(b,d,e,f){if(e&&e.length>0)for(var g in e)if(e.hasOwnProperty(g)){var h=e[g],i=a._DateTimeHelper.parseLocale(b,h);if(i&&i-d===0)return f()}return c},b.prototype._formatDefaultValue=function(a){if(a!==c&&"undefined"!=typeof a){var b=JSON.parse(JSON.stringify(a));if("object"==typeof b)for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];e===c&&delete a[d],"object"==typeof e&&this._formatDefaultValue(a[d])}}},b.prototype.toJSON=function(){if(this.formatters===c)return d;var a=$.extend(!0,{},JSON.parse(JSON.stringify(this.formatters)));return this._formatDefaultValue(a),{formatters:a}},b.prototype.HasFormatedColor=function(){var a=this;return a.isDefault?!1:a.PositiveExpression()&&a.PositiveExpression().ColorFormatPart()?!0:a.NegativeExpression()&&a.NegativeExpression().ColorFormatPart()?!0:a.ZeroExpression()&&a.ZeroExpression().ColorFormatPart()?!0:a.TextExpression()&&a.TextExpression().ColorFormatPart()?!0:!1},b.prototype.IsDefaultFormat=function(){return this.isDefault},b.prototype.FormatString=function(b){var d=this;if(0===arguments.length){d.Init();var e=c;switch(d.FormatMode()){case 0:if(d.formatters)for(var f=0;f<d.formatters.length;f++){var g=d.formatters[f];if(a.util.isType(g,"CustomNumberFormat")){e?e.Append(o.FormatSeparator):e=new a.StringBuilder;var h=g.FormatString();e.Append(h)}}break;case 1:if(a.util.isType(d.formatters[0],"StandardDateTimeFormatter"))return d.formatters[0].FormatString();break;case 2:if(a.util.isType(d.formatters[0],"StandardNumberFormatter"))return d.formatters[0].FormatString()}return e?e.toString():l.Empty}if(!b)throw new Error(a.SR.Exp_ValueIsNull);d.formatters=c,d.formatCached=b,d.isDefault=d.formatCached.toLowerCase()===p.General.toLowerCase(),d.isConstructed=!1,d.Init(),d.RaisePropertyChanged("FormatString")},b.prototype.DateTimeFormatInfo=function(b){var c=this;if(0===arguments.length)return c.Init(),c.dateTimeFormatInfo?c.dateTimeFormatInfo:o.DateTimeFormatInfo();if(c.Init(),c.dateTimeFormatInfo=b,c.formatters)for(var d=0;d<c.formatters.length;d++){var e=c.formatters[d];if(a.util.isType(e,"IFormatProviderSupport")){var f=e;f.DateTimeFormatInfo(b)}}return c.RaisePropertyChanged("DateTimeFormatInfo"),b},b.prototype.NumberFormatInfo=function(b){var c=this;if(0===arguments.length)return c.Init(),c.numberFormatInfo?c.numberFormatInfo:o.NumberFormatInfo();if(c.Init(),c.numberFormatInfo=b,c.formatters)for(var d=0;d<c.formatters.length;d++){var e=c.formatters[d];if(a.util.isType(e,"IFormatProviderSupport")){var f=e;f.NumberFormatInfo(b)}}return c.RaisePropertyChanged("NumberFormatInfo"),b},b.prototype.FormatMode=function(a){return 0===arguments.length?this.formatModeType:(this.formatModeType=a,this.RaisePropertyChanged("FormatMode"),a)},b.prototype.ExcelCompatibleFormatString=function(){var b=this;b.Init();var d=c;switch(b.FormatMode()){case 0:if(b.formatters)for(var e=0;e<b.formatters.length;e++){var f=b.formatters[e];if(a.util.isType(f,"CustomNumberFormat")){d?d.Append(o.FormatSeparator):d=new a.StringBuilder;var g=f.ExcelCompatibleFormatString();d.Append(g)}}break;case 1:if(a.util.isType(b.formatters[0],"StandardDateTimeFormatter"))return b.formatters[0].ExcelCompatibleFormatString();break;case 2:if(a.util.isType(b.formatters[0],"StandardNumberFormatter"))return b.formatters[0].ExcelCompatibleFormatString()}return d?d.toString():l.Empty},b.prototype.PositiveExpression=function(){var b=this;return b.Init(),b.formatters&&b.formatters.length>0?a.util.asType(b.formatters[0],"CustomNumberFormat"):c},b.prototype.NegativeExpression=function(){var b=this;return b.Init(),b.formatters&&b.formatters.length>1?a.util.asType(b.formatters[1],"CustomNumberFormat"):c},b.prototype.ZeroExpression=function(){var b=this;return b.Init(),b.formatters&&b.formatters.length>2?a.util.asType(b.formatters[2],"CustomNumberFormat"):c},b.prototype.TextExpression=function(){var b=this;return b.Init(),b.formatters&&b.formatters.length>3?a.util.asType(b.formatters[3],"CustomNumberFormat"):c},b.prototype.GetFormatType=function(b){this.Init();var c=this.GetFormatInfo(b);if(a.util.isType(c,"CustomNumberFormat")){var d=c.Formatter();if(a.util.isType(d,"NumberFormatDigital"))return 1;if(a.util.isType(d,"NumberFormatDateTime"))return 2;if(a.util.isType(d,"NumberFormatText"))return 3}else{if(a.util.isType(c,"NumberFormatDigital")||a.util.isType(c,"StandardNumberFormatter"))return 1;if(a.util.isType(c,"NumberFormatDateTime")||a.util.isType(c,"StandardDateTimeFormatter"))return 2;if(a.util.isType(c,"NumberFormatText"))return 3}return 0},b.prototype.GetPreferredEditingFormatter=function(c){if(this.Init(),a.util.isType(c,"DateTime")){var d=new a._DateTimeHelper(c);return 0===d.Hour()&&0===d.Minute()&&0===d.Second()&&0===d.Millisecond()?b.DefaultShortDatePatternFormatter():b.DefaultSXDatetimePatternFormatter()}if(a.util.isType(c,"TimeSpan"))return b.DefaultLongTimePatternFormatter();if(a.FormatConverter.IsNumber(c)){var e=a.FormatConverter.ToDouble(c);return e>1e20?new b("0.##E+00"):b.DefaultNumberFormatter()}return a.util.isType(c,"string"),b.DefaultGeneralFormatter()},b.prototype.GetPreferredDisplayFormatter=function(d,e){var f=this;if(e||(e={value:c}),e.value=c,f.Init(),l.IsNullOrEmpty(d))return new b;var g=d,h=e.value=f.Parse(g);if(a.util.isType(h,"DateTime")||a.util.isType(h,"TimeSpan")){var i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralMonthDay(),function(){return b.DefaultDMMMFormatter()}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralYearMonth(),function(){return b.DefaultMMMYYFormatter()}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralYearMonthDay(),function(){return b.DefaultShortDatePatternFormatter()}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralHourMinute(),function(){return b.DefaultHMMFormatter()}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralHourMinuteSecond(),function(){return b.DefaultHMMSSFormatter()}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralHourMinuteSecondSubSecond(),function(){return b.DefaultHMMSS0Formatter()}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralHourMinuteWithDate(),function(){return b._needChangeDefaultFormat(b.defaultShortDatePatternHMMFormatter)&&(b.defaultShortDatePatternHMMFormatter=new b(f.DateTimeFormatInfo().ShortDatePattern+" h:mm")),b.defaultShortDatePatternHMMFormatter}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralHourMinuteSecondWithDate(),function(){return b._needChangeDefaultFormat(b.defaultShortDatePatternHMMSSFormatter)&&(b.defaultShortDatePatternHMMSSFormatter=new b(f.DateTimeFormatInfo().ShortDatePattern+" h:mm:ss")),b.defaultShortDatePatternHMMSSFormatter}))return i;if(i=f.findDateTimeGeneralFormatter(d,h,J.GeneralHourMinuteSecondSubSecondWithDate(),function(){return b._needChangeDefaultFormat(b.defaultShortDatePatternHMMSS0Formatter)&&(b.defaultShortDatePatternHMMSS0Formatter=new b(f.DateTimeFormatInfo().ShortDatePattern+" h:mm:ss.0")),b.defaultShortDatePatternHMMSS0Formatter}))return i}else if(a.FormatConverter.IsNumber(h)){if(g[0]===o.NumberFormatInfo().CurrencySymbol[0])return a.StringHelper.Contains(g,o.DecimalSeparator)?b.DefaultComboNumberFormatter1():b.DefaultComboNumberFormatter2();if(a.StringHelper.IndexOf(g,"e",1)>-1)return b.DefaultStandardNumberFormatter();if(g[0].toString()===o.PercentSymbol||g[g.length-1].toString()===o.PercentSymbol)return a.StringHelper.Contains(g,o.DecimalSeparator)?b.DefaultStandardPercentFormatter1():b.DefaultStandardPercentFormatter2();if(a.StringHelper.Contains(g,o.NumberGroupSeparator))return a.StringHelper.Contains(g,o.DecimalSeparator)?b.DefaultStandardGroupNumberFormatter1():b.DefaultStandardGroupNumberFormatter2()}return b.DefaultGeneralFormatter()},b.prototype.Format=function(b,f){if(a.util.isType(b,"boolean"))return b.toString().toUpperCase();f&&(f.value=c),this.Init();var g=this.GetFormatInfo(b);if(a.util.isType(g,"CustomNumberFormat")){var h=g.ColorFormatPart();f&&h&&(f.value=h.ForeColor())}var i=0,j=a.FormatConverter.IsNumber(b);if(j&&(i=a.FormatConverter.ToDouble(b)),g){var k=c;if(j&&g===this.NegativeExpression()){if(k=g.Format(e(i)),a.util.isType(g,"CustomNumberFormat")){var m=a.util.asType(g,"CustomNumberFormat");m&&m.ConditionFormatPart()&&m.ConditionFormatPart().Value()>0&&0>i&&(k=o.NegativeSign+k)}}else try{k=g.Format(b)}catch(n){a.util.isType(b,"string")&&(k=b.toString())}return k?k:l.Empty}return j&&0>i?o.HyphenMinus.toString():a.util.isType(b,"string")?b.toString():b===d||b===c?l.Empty:b.toString()},b.prototype.Parse=function(a){var b=this;return b.Init(),b.formatters&&b.formatters.length>0?b.formatters[0].Parse(a):c},b.prototype.Init=function(){var a=this;if(!a.isConstructed)switch(a.isConstructed=!0,a.formatModeType){case 0:a.InitExcelCompatibleMode(a.formatCached);break;case 1:a.InitStandardDateTimeMode(a.formatCached);break;case 2:a.InitStandardNumericMode(a.formatCached)}},b.prototype.InitStandardDateTimeMode=function(b){var c=new q(b);if(!c.EvaluateFormat(b))throw new Error(a.SR.Exp_FormatIllegal);this.formatters=[],this.formatters.push(c)},b.prototype.InitStandardNumericMode=function(b){var c=new r(b);if(!c.EvaluateFormat(b))throw new Error(a.SR.Exp_FormatIllegal);this.formatters=[],this.formatters.push(c)},b.prototype.InitExcelCompatibleMode=function(b){if(l.IsNullOrEmpty(b))throw new Error(a.SR.Exp_FormatIllegal);var c=this;if(c.formatters=[],c.isDefault)c.formatters.push(new u);else{c.isSingleFormatterInfo=!a.StringHelper.Contains(b,o.FormatSeparator.toString());var d=b.split(o.FormatSeparator);if(!d)throw new Error(a.SR.Exp_FormatIllegal);if(d.length<1||d.length>5)throw new Error(a.SR.Exp_FormatIllegal);for(var e=0,f=0;f<d.length&&(e++,!(e>4));f++){var g=new u(d[f],c.customerCultureName);g&&c.formatters.push(g)}if(!c.PositiveExpression())throw new Error(a.SR.Exp_FormatIllegal)}},b.prototype.GetFormatInfo=function(b){var d=this;if(0===d.FormatMode()){if("string"==typeof b&&isNaN(b))return d.TextExpression()?d.TextExpression():d.PositiveExpression();if(a.FormatConverter.IsNumber(b)||a.util.isType(b,"boolean")){var e=d.PositiveExpression(),f=d.NegativeExpression(),g=a.FormatConverter.ToDouble(b),h=e&&e.ConditionFormatPart(),i=f&&f.ConditionFormatPart(),j=d.isSingleFormatterInfo?d.PositiveExpression():c;return d.PositiveExpression()&&(h?e.ConditionFormatPart().IsMeetCondition(g)&&(j=e):(g>0||0===g&&!d.ZeroExpression())&&(j=e)),!j&&d.NegativeExpression()&&(i?f.ConditionFormatPart().IsMeetCondition(g)&&(j=f):0>g&&(j=f)),!j&&d.ZeroExpression()&&0===g&&(j=d.ZeroExpression()),!j&&d.ZeroExpression()&&(j=d.ZeroExpression()),!j&&d.NegativeExpression()&&(j=d.NegativeExpression()),j}}else if((1===d.FormatMode()||2===d.FormatMode())&&d.formatters&&1===d.formatters.length)return d.formatters[0];return c},b.prototype.RaisePropertyChanged=function(a){var b=this;if(b.PropertyChanged)for(var c=0;c<b.PropertyChanged.length;c++){var d=b.PropertyChanged[c];"function"==typeof d&&d(b,a)}},b.defaultNumberFormatter=c,b.defaultGeneralFormatter=c,b.defaultShortDatePatternFormatter=c,b.defaultLongTimePatternFormatter=c,b.defaultSXDatetimePatternFormatter=c,b.defaultDMMMFormatter=c,b.defaultMMMYYFormatter=c,b.defaultHMMFormatter=c,b.defaultHMMSSFormatter=c,b.defaultHMMSS0Formatter=c,b.defaultShortDatePatternHMMFormatter=c,b.defaultShortDatePatternHMMSSFormatter=c,b.defaultShortDatePatternHMMSS0Formatter=c,b.defaultComboNumberFormatter1=c,b.defaultComboNumberFormatter2=c,b.defaultStandardNumberFormatter=c,b.defaultStandardPercentFormatter1=c,b.defaultStandardPercentFormatter2=c,b.defaultStandardGroupNumberFormatter1=c,b.defaultStandardGroupNumberFormatter2=c,b}();a.GeneralFormatter=v;var w=function(){function a(a){this._classNames=["FormatPartBase"],this.originalToken=a}return a.prototype.OriginalToken=function(){return this.originalToken},a.prototype.SupportedPartFormat=function(){return a._supportedPartFormat||(a._supportedPartFormat=["ConditionFormatPart","ColorFormatPart","LocaleIDFormatPart"]),a._supportedPartFormat},a.Create=function(a){return x.EvaluateFormat(a)?new x(a):B.EvaluateFormat(a)?new B(a):E.EvaluateFormat(a)?new E(a):z.EvaluateFormat(a)?new z(a):y.EvaluateFormat(a)?new y(a):c},a}(),x=function(b){function d(d){b.call(this,d);var e=this;w.call(e,d),e._classNames.push("ConditionFormatPart"),e._initFileds();var f=o.TrimSquareBracket(d);if(l.IsNullOrEmpty(f))throw new Error(a.SR.Exp_TokenIllegal);for(var g=c,h=0,i=c;h<f.length&&(i=f[h],o.IsOperator(i));h++)g||(g=new a.StringBuilder),g.Append(i);if(!g)throw new Error(a.SR.Exp_TokenIllegal);var j=g.toString();switch(g=c,j){case"<":e.compareOperator=4;break;case"<=":e.compareOperator=5;break;case"=":e.compareOperator=0;break;case">=":e.compareOperator=3;break;case">":e.compareOperator=2;break;case"<>":e.compareOperator=1;break;default:throw new Error(a.SR.Exp_TokenIllegal)}for(;h<f.length;h++){if(i=f[h],o.IsOperator(i))throw new Error(a.SR.Exp_TokenIllegal);g||(g=new a.StringBuilder),g.Append(i)}if(!g)throw new Error(a.SR.Exp_TokenIllegal);var k=g.toString(),m=parseFloat(k);if(isNaN(m))throw new Error(a.SR.Exp_TokenIllegal);e.value=m}return __extends(d,b),d.prototype._initFileds=function(){this.value=0,this.compareOperator=c},d.prototype.CompareOperator=function(){return this.compareOperator},d.prototype.Value=function(){return this.value},d.prototype.toString=function(){var b=new a.StringBuilder;switch(this.compareOperator){case 0:b.Append("=");break;case 2:b.Append(">");break;case 3:b.Append(">=");break;case 4:b.Append("<");break;case 5:b.Append("<=");break;case 1:b.Append("<>");break;default:throw new Error}b.Append(this.value.toString());var c=o.AddSquareBracket(b.toString());return c},d.prototype.IsMeetCondition=function(a){var b=this;switch(b.compareOperator){case 0:return a===b.value;case 2:return a>b.value;case 3:return a>=b.value;case 4:return a<b.value;case 5:return a<=b.value;case 1:return a!==b.value}return!1},d.EvaluateFormat=function(a){if(!a||a===l.Empty)return!1;var b=o.TrimSquareBracket(a);return b&&b!==l.Empty?o.IsOperator(b[0]):!1},d}(w),y=function(b){function d(d){b.call(this,d),this.foreColor="black",this.index=-1,this.colorName=c;var e=this;w.call(e,d),e._classNames.push("ColorFormatPart");var f=o.TrimSquareBracket(d);if(!f||f===l.Empty)throw new Error(a.SR.Exp_TokenIllegal);try{return e.foreColor=f,void(e.colorName=f)}catch(g){}if(f.length>"Color".length){f=a.StringHelper.Remove(f,0,"Color".length);var h=-1,i=parseInt(f,10);if(!isNaN(i)&&(h=i,h>=1&&56>=h))return}throw new Error(a.SR.Exp_TokenIllegal)}return __extends(d,b),d.prototype.ForeColor=function(){return this.foreColor},d.prototype.toString=function(){var a=this;if(a.index>-1)return o.AddSquareBracket("Color"+a.index);if(a.colorName)return o.AddSquareBracket(a.colorName);throw new Error},d.EvaluateFormat=function(b){if(!b||b===l.Empty)return!1;var c=o.TrimSquareBracket(b);return c&&c!==l.Empty?c.length<3?!1:isNaN(b[b.length-1])?b[0]!==b[1]:a.StringHelper.StartsWith(b,"Color",1):!1},d}(w),z=function(b){function d(c){b.call(this,c);var e=this;if(w.call(e,c),e._classNames.push("ABSTimeFormatPart"),e._initFileds(),!d.EvaluateFormat(c))throw new Error(a.SR.Exp_TokenIllegal);if(e.token=c.toLowerCase(),e.token[1]===d.HoursABSContent)e.type=0;else if(e.token[1]===d.MinuteABSContent)e.type=1;else{if(e.token[1]!==d.SecondABSContent)throw new Error(a.SR.Exp_TokenIllegal);e.type=2}for(var f=new a.StringBuilder,g=0;g<e.token.length-2;g++)f.Append("0");e.formatString=f.toString()}return __extends(d,b),d.prototype._initFileds=function(){this.token=c,this.type=c,this.formatString=c},d.prototype.FormatString=function(){return this.formatString},d.prototype.TimePartType=function(){return this.type},d.prototype.Token=function(){return this.token},d.EvaluateFormat=function(a){if(!a||a===l.Empty)return!1;var b=o.TrimSquareBracket(a);if(!b||b===l.Empty)return!1;b=b.toLowerCase();for(var e=c,f=0;f<b.length;f++){e||(e=b[f]);var g=d;if(e!==g.HoursABSContent&&e!==g.MinuteABSContent&&e!==g.SecondABSContent)return!1;if(e!==b[f])return!1}return!0},d.HoursABSContent="h",d.MinuteABSContent="m",d.SecondABSContent="s",d}(w),A=function(){function a(a,b){var d=this;d._classNames=["DBNumber"];var e=c;if(a){d.units=[];for(var f=0;f<a.length;f++)e=a[f],d.units.push(0===e?l.Empty:String.fromCharCode(e))}if(b){d.numbers=[];for(var f=0;f<b.length;f++)e=b[f],d.numbers.push(0===e?l.Empty:String.fromCharCode(e))}}return a.JapaneseDBNum1=function(){return a.japaneseDBNum1||(a.japaneseDBNum1=new a(a.JapaneseNumberUnitLetter1,a.JapaneseNumberLetterValues1)),a.japaneseDBNum1},a.JapaneseDBNum2=function(){return a.japaneseDBNum2||(a.japaneseDBNum2=new a(a.JapaneseNumberUnitLetter2,a.JapaneseNumberLetterValues2)),a.japaneseDBNum2},a.JapaneseDBNum3=function(){return a.japaneseDBNum3||(a.japaneseDBNum3=new a(c,a.JapaneseNumberLetterValues3)),a.japaneseDBNum3},a.prototype.Units=function(){return this.units},a.prototype.Numbers=function(){return this.numbers},a.japaneseDBNum1=c,a.japaneseDBNum2=c,a.japaneseDBNum3=c,a.JapaneseNumberUnitLetter1=[21315,30334,21313,20806,21315,30334,21313,20740,21315,30334,21313,19975,21315,30334,21313,0],a.JapaneseNumberUnitLetter2=[38433,30334,25342,20806,38433,30334,25342,20740,38433,30334,25342,33836,38433,30334,25342,0],a.JapaneseNumberLetterValues1=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],a.JapaneseNumberLetterValues2=[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],a.JapaneseNumberLetterValues3=[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],a}(),B=function(b){function d(e){b.call(this,e),this.token=c,this.type=0;var f=this;if(f._classNames.push("DBNumberFormatPart"),!d.EvaluateFormat(e))throw new Error(a.SR.Exp_TokenIllegal);f.token=e;var g=o.TrimSquareBracket(e),h=a.StringHelper.Remove(g,0,"dbnum".length);if(f.type=parseInt(h,10),f.type<0||f.type>3)throw new Error(a.SR.Exp_TokenIllegal)}return __extends(d,b),d.prototype.Token=function(){return this.token?this.token:l.Empty},d.prototype.Type=function(){return this.type},d.prototype.ReplaceNumberString=function(b,d,e){if(!b||b===l.Empty)return b;for(var f=b,g=b,h=-1,i=-1,j=!1,k=c,m=c,n=c,p=b.length-1;p>=0;p--){var q=g[p];!isNaN(q)||o.IsEquals(q,o.DecimalSeparator,!1)&&!j?(o.IsEquals(q,o.DecimalSeparator,!1)&&(j=!0),-1===h&&(h=p),i=p):i>-1&&h>-1&&(k=g.substr(i,h-i+1),m=parseFloat(k),isNaN(m)||(n=this.NumberString(k,d,e),f=a.StringHelper.Remove(f,i,h-i+1),f=a.StringHelper.Insert(f,i,n)),h=-1,i=-1,j=!1)}return i>-1&&h>-1&&(k=g.substr(i,h-i+1),m=parseFloat(k),isNaN(m)||(n=this.NumberString(k,d,e),f=a.StringHelper.Remove(f,i,h-i+1),f=a.StringHelper.Insert(f,i,n)),h=-1,i=-1,j=!1),f},d.prototype.NumberString=function(b,e,f){var g=b.split(".");if(g){if(1===g.length)return d.FormatNumberString(g[0],e.Numbers(),f?e.Units():c);if(2===g.length){var h=d.FormatNumberString(g[0],e.Numbers(),f?e.Units():c),i=d.FormatNumberString(g[1],e.Numbers());return h+"."+i}}throw new Error(a.SR.Exp_ValueIllegal)},d.prototype.toString=function(){if(this.type>-1)return o.AddSquareBracket("DBNum"+this.type);throw new Error},d.EvaluateFormat=function(b){if(!b||b===l.Empty)return!1;var c=o.TrimSquareBracket(b);return c&&c!==l.Empty&&a.StringHelper.StartsWith(c,"DBNum",1)?!0:!1},d.FormatNumberString=function(b,e,f){var g=b,h=0,i=c,j=0;if(2===arguments.length){var k=new a.StringBuilder;for(h=0;h<g.length;h++)i=g.substr(h,1),j=parseInt(i,10),k.Append(e[j]);return k.toString()}if(3===arguments.length){if(!f)return d.FormatNumberString(b,e);var m=0,n="",o=g.length,p=!1,q=[];for(h=0;o>h;h++){var r=f.length-1-h;q.push(r>-1?f[r].toString():l.Empty)}for(var s=[],t=q.length-1;t>=0;t--)s[q.length-t-1]=q[t];q=s;for(var u=!1,t=0;o>t;t++){i=g.substr(t,1),j=parseInt(i,10);var v=l.Empty,w=l.Empty;o-t-16>0?(v=e[j],w="",u=!0):t!==o-1&&t!==o-5&&t!==o-9&&t!==o-13?"0"===i?(v="",w="",m+=1):"0"!==i&&0!==m?(v=e[0]+e[j],w=q[t],m=0):(v=e[j],w=q[t],m=0):"0"!==i&&0!==m?(v=e[0]+e[j],w=q[t],m=0):"0"!==i&&0===m||u?(v=e[j],w=q[t],m=0,u=!1):"0"===i&&m>=3?(v="",w="",m+=1):o>=11?(v="",m+=1):(v="",w=q[t],m+=1);var x=v+w===l.Empty;x||(p=!1),t!==o-13||p||(w=q[t],p=!0),t!==o-9||p||(w=q[t],p=!0),t===o-1&&(w=q[t],p=!0),n=n+v+w
}var y=parseInt(b,10);return isNaN(y)||0!==y?n:e[0]}},d}(w),C=function(){function b(){}return b.ParseHexString=function(b){if(!b||b===l.Empty)throw new Error(a.SR.Exp_StringIllegal);return parseInt(b,16)},b.FixJapaneseChars=function(a){return a},b.GetFraction=function(a,b,c,d,h){var i=0,j=0,l=0,m=0;a>0?(m=a-f(a)+1,1==m?(m=0,i=a):i=f(a)-1):0>a&&(i=f(a),m=f(a)-a);var n=2,o=9;n=g(10,b-1),o=g(10,b)-1,2>n&&(n=2),2>o&&(o=2);for(var p=!1,q=0,r=n;o>=r;r++){var s=r*m,t=k(s),u=t/r,v=e(u-m);if((p?v<e(q-m):!0)&&(p=!0,q=u,j=t,l=r,5e-4>v))break}return c.value=i,d.value=j,h.value=l,p},b}(),D=function(){function b(){}return b.AllowScience=function(a){return a?!(0===a.indexOf("ja")||0===a.indexOf("zh")):!0},b.CreateCultureInfo=function(c){switch(c){case 1033:return a._CultureInfo.getCulture(b.EnglishUnitedStates);case 1041:return a._CultureInfo.getCulture(b.JapanneseJapan);default:return a._CultureInfo.currentCulture()}},b.JapanneseJapan="ja-JP",b.EnglishUnitedStates="en-US",b}(),E=function(b){function d(d){b.call(this,d),this.currencySymbol=c,this.locateID=-1,this.cultureInfo=c,this.content=c;var e=this;if(w.call(e,d),e._classNames.push("LocaleIDFormatPart"),!d)throw new Error(a.SR.Exp_TokenIsNull);if(d===l.Empty)throw new Error(a.SR.Exp_TokenIllegal);e.content=o.TrimSquareBracket(d);var f=e.content;if(!f||f===l.Empty)throw new Error(a.SR.Exp_TokenIllegal);if(!o.IsEquals(f[0],o.Dollar,!1))throw new Error(a.SR.Exp_TokenIllegal);f=a.StringHelper.Remove(f,0,1);var g=f.indexOf(o.HyphenMinus);if(!(g>-1))return void(e.currencySymbol=f);if(e.currencySymbol=f.substr(0,g),f=a.StringHelper.Remove(f,0,g),!o.IsEquals(f[0],o.HyphenMinus,!1))throw new Error(a.SR.Exp_TokenIllegal);if(f=a.StringHelper.Remove(f,0,1),!(f.length>0))throw new Error(a.SR.Exp_TokenIllegal);e.locateID=C.ParseHexString(f)}return __extends(d,b),d.prototype.CultureInfo=function(){var a=this;return a.cultureInfo||(a.cultureInfo=D.CreateCultureInfo(a.locateID),a.currencySymbol&&a.currencySymbol!==l.Empty&&a.cultureInfo&&!a.cultureInfo.NumberFormat().IsReadOnly&&(a.cultureInfo.NumberFormat().CurrencySymbol=a.currencySymbol)),a.cultureInfo},d.prototype.CurrencySymbol=function(){return this.currencySymbol?this.EncodeSymbol(this.currencySymbol):l.Empty},d.prototype.AllowScience=function(){return this.cultureInfo?D.AllowScience(this.cultureInfo.Name()):void 0},d.prototype.GetDBNumber=function(a){var b=255&this.locateID;switch(b){case 17:switch(a){case 1:return A.JapaneseDBNum1();case 2:return A.JapaneseDBNum2();case 3:return A.JapaneseDBNum3()}}return c},d.prototype.toString=function(){return this.content?o.AddSquareBracket(this.content):l.Empty},d.prototype.EncodeSymbol=function(b){return a.StringHelper.Replace(b,"\\.","'.'")},d.EvaluateFormat=function(a){if(!a||a===l.Empty)return!1;var b=o.TrimSquareBracket(a);return b&&b!==l.Empty?o.IsEquals(b[0],o.Dollar,!1):!1},d}(w),F=function(){function b(){}return b.prototype.ConvertTo=function(b,d,e,f,g){var h=b;if(f!=c&&g!=c&&d instanceof Date){var i=f.GetDBNumber(g.Type());h=g.ReplaceNumberString(h,i,!0),h=h.replace(o.ReplacePlaceholder+G.YearFourDigit,new a._DateTimeHelper(d).localeFormat(G.YearFourDigit)),h=h.replace(o.ReplacePlaceholder+G.YearTwoDigit,new a._DateTimeHelper(d).localeFormat(G.YearTwoDigit)),h=g.ReplaceNumberString(h,i,!1)}return h},b}(),G=function(b){function e(a,d,e,f,g){b.call(this,e,f,g),this.baseNumberStringConverter=p.prototype.NumberStringConverter,this.baseDateTimeFormatInfo=p.prototype.DateTimeFormatInfo,this.baseCultureName=p.prototype.CultureName;var h=this;h.validDateTimeFormatString=c,h.formatString=c,h.hasJD=!1,h.absoluteTime=c,h.absTimeParts=c,h.hasYearDelay=!1,h.exactlyMatch=!1,h._classNames.push("NumberFormatDateTime"),h.exactlyMatch=!1,h.formatString=h.FixFormat(p.TrimNotSupportSymbol(a)),h.absTimeParts=d,h._init(a,d,e,f)}return __extends(e,b),e.EvaluateFormat=function(a){return p.ContainsKeywords(a,e.keyWords)},e.prototype._init=function(){var b=this,c={value:b.formatString},d=e;if(!d.EvaluateFormat(c.value))throw new Error(a.SR.Exp_FormatIllegal);var f=b.ProcessAMPM(c);if(b.hasJD=b.Replace(c.value,d.MonthJD,'"'+d.PlaceholderMonthJD+'"',!0,!1,c,!1,!1),b.Replace(c.value,d.MonthUnabbreviated,d.StandardMonthUnabbreviated,!0,!1,c,!1,!1),b.Replace(c.value,d.MonthAbbreviation,d.StandardMonthAbbreviation,!0,!1,c,!1,!1),b.Replace(c.value,d.MonthTwoDigit,d.StandardMonthTwoDigit,!0,!1,c,!1,!1),b.Replace(c.value,d.MonthSingleDigit,d.StandardMonthSingleDigit,!0,!1,c,!1,!1),b.Replace(c.value,d.DayWeekDayAbbreviation,d.StandardDayWeekDayAbbreviation,!0,!0,c,!1,!0),b.Replace(c.value,d.DayWeekDayUnabbreviated,d.StandardDayWeekDayUnabbreviated,!0,!0,c,!1,!0),b.Replace(c.value,d.MinuteSingleDigit,d.StandardMinuteSingleDigit,!1,!0,c,!1,!1),f||(b.Replace(c.value,d.HoursSingleDigit,d.StandardHourSingleDigit,!0,!0,c,!1,!1),b.Replace(c.value,d.HoursTwoDigit,d.StandardHourTwoDigit,!0,!0,c,!1,!1)),b.Replace(c.value,d.SecondSingleDigit,d.StandardSecondSingleDigit,!0,!0,c,!1,!0),b.PartDBNumberFormat()&&b.PartLocaleID()&&(b.hasYearDelay=b.hasYearDelay||b.Replace(c.value,d.YearFourDigit,'"'+o.ReplacePlaceholder+d.YearFourDigit+'"',!0,!1,c,!1,!0),b.hasYearDelay=b.hasYearDelay||b.Replace(c.value,d.YearTwoDigit,'"'+o.ReplacePlaceholder+d.YearTwoDigit+'"',!0,!1,c,!1,!0)),b.absTimeParts)for(var g=0;g<b.absTimeParts.length;g++){var h=b.absTimeParts[g];b.Replace(c.value,h.token,o.ReplacePlaceholder+h.token,!0,!0,c,!1,!0)}b.validDateTimeFormatString=c.value},e.prototype._isJanpaneseCulture=function(){var b=this.PartLocaleID();if(b!==c&&b.CultureInfo()!==c){if(b.CultureInfo()===a._CultureInfo.japanCulture())return!0}else if(this.CultureName()===a._CultureInfo.japanCulture().Name())return!0;return!1},e.prototype.NumberStringConverter=function(a){return 0===arguments.length?this.baseNumberStringConverter()?this.baseNumberStringConverter():e.defaultDateTimeNumberStringConverter:(this.baseNumberStringConverter(a),a)},e.prototype.AbsoluteTime=function(){return this.absoluteTime?this.absoluteTime:e.defaultAbsoluteTime},e.prototype.FormatString=function(){return this.formatString},e.prototype.DateTimeFormatInfo=function(b){var c=this;return 0===arguments.length?c.baseDateTimeFormatInfo()?c.baseDateTimeFormatInfo():c.PartLocaleID()&&c.PartLocaleID().CultureInfo()?c.PartLocaleID().CultureInfo().DateTimeFormat():c.baseCultureName()?a._CultureInfo.getCulture(c.baseCultureName()).DateTimeFormat():o.DateTimeFormatInfo():(c.baseDateTimeFormatInfo(b),b)},e.prototype.ExcelCompatibleFormatString=function(){var a=this,b=a.formatString,c=e,d={value:b};return a.Replace(b,c.StandardAMPMSingleDigit,a.CurrentAMPM(),!0,!0,d,!1,!0),a.Replace(b,c.StandardMonthUnabbreviated,c.MonthUnabbreviated,!0,!1,d,!1,!0),a.Replace(b,c.StandardMonthAbbreviation,c.MonthAbbreviation,!0,!1,d,!1,!0),a.Replace(b,c.StandardMonthTwoDigit,c.MonthTwoDigit,!0,!1,d,!1,!0),a.Replace(b,c.StandardMonthSingleDigit,c.MonthSingleDigit,!0,!1,d,!1,!0),a.Replace(b,c.StandardDayWeekDayAbbreviation,c.DayWeekDayAbbreviation,!0,!0,d,!1,!0),a.Replace(b,c.StandardDayWeekDayUnabbreviated,c.DayWeekDayUnabbreviated,!0,!0,d,!1,!0),a.Replace(b,c.StandardMinuteSingleDigit,c.MinuteSingleDigit,!1,!0,d,!1,!0),a.Replace(b,c.StandardHourSingleDigit,c.HoursSingleDigit,!0,!0,d,!1,!1),a.Replace(b,c.StandardHourTwoDigit,c.HoursTwoDigit,!0,!0,d,!1,!1),a.Replace(b,c.StandardSecondSingleDigit,c.SecondSingleDigit,!0,!0,d,!1,!0),a.Replace(b,c.StandardSubSecondThreeDigit,c.SubSecondThreeDigit,!0,!0,d,!1,!0),a.Replace(b,c.StandardSubSecondTwoDigit,c.SubSecondTwoDigit,!0,!0,d,!1,!0),a.Replace(b,c.StandardSubSecondSingleDigit,c.SubSecondSingleDigit,!0,!0,d,!1,!0),d.value},e.prototype.CurrentAMPM=function(){var a=c;if(a=this.DateTimeFormatInfo()?this.DateTimeFormatInfo():o.DateTimeFormatInfo(),a&&a.AMDesignator&&a.AMDesignator!==l.Empty&&a.PMDesignator&&a.PMDesignator!==l.Empty){var b=l.Format("{0}/{1}",a.AMDesignator,a.PMDesignator);return b}return e.AMPMTwoDigit},e.prototype.Format=function(b){if(a.util.isType(b,"boolean"))return b.toString().toUpperCase();var f=this,g=l.Empty,i=c;try{try{i=a.Calc.Convert.toDateTime(b),i||(g=b.toString())}catch(j){g=b.toString()}if(i){var k=f.validDateTimeFormatString,m=f.validDateTimeFormatString.replace(/%/g,"");if("H"===m||"h"===m||"m"===m||"M"===m||"d"===m||"s"===m||"y"===m?(k="%"+m,f.validDateTimeFormatString=k):k=m,g=f.PartLocaleID()&&f.PartLocaleID().CultureInfo()?new a._DateTimeHelper(i).customCultureFormat(k,f.PartLocaleID().CultureInfo()):f.CultureName()?new a._DateTimeHelper(i).customCultureFormat(k,a._CultureInfo.getCulture(f.CultureName())):new a._DateTimeHelper(i).localeFormat(k),f.hasJD){var n=f._getMonthName(i.getMonth());g=a.StringHelper.Replace(g,e.PlaceholderMonthJD,n.substr(0,1))}if(f.absTimeParts)for(var p=i-f.AbsoluteTime(),q=0;q<f.absTimeParts.length;q++){var r=f.absTimeParts[q],s=c;switch(r.TimePartType()){case 0:s=h(p/1e3/3600);break;case 1:s=h(p/1e3/60);break;case 2:s=h(p/1e3)}if(s!==c&&typeof s!==d){var t=r.token.replace("[","\\[").replace("]","\\]");g=a.StringHelper.Replace(g,o.ReplacePlaceholder+t,s)}}}}catch(u){g=a.FormatConverter.toString(b)}return f.NumberStringConverter()&&(f.NumberStringConverter()instanceof F?g=f.NumberStringConverter().ConvertTo(g,b,!1,f.PartLocaleID(),f.PartDBNumberFormat()):(f.hasYearDelay&&(g=a.StringHelper.Replace(g,o.ReplacePlaceholder+e.YearFourDigit,new a._DateTimeHelper(i).localeFormat(e.YearFourDigit)),g=a.StringHelper.Replace(g,o.ReplacePlaceholder+e.YearTwoDigit,new a._DateTimeHelper(i).localeFormat(e.YearTwoDigit))),g=f.NumberStringConverter().ConvertTo(g,b,!0,f.PartLocaleID(),f.PartDBNumberFormat()))),g},e.prototype._getMonthName=function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a]},e.prototype.Parse=function(b){if(!b||b===l.Empty)return c;var d=this,e=C.FixJapaneseChars(b),f=e.toLowerCase();if("true"===f)return!0;if("false"===f)return!1;if(d.validDateTimeFormatString){var g=a._DateTimeHelper.parseExact(e,d.validDateTimeFormatString,a._CultureInfo.getCulture(d.CultureName()));if(g)return g}if(!d.exactlyMatch)try{var h=a.Calc.Convert.toDateTime(e);return h&&!isNaN(h)?h:e}catch(i){return e}return c},e.prototype.FixFormat=function(b){for(var c=b,d=new a.StringBuilder,f=!1,g=(a.StringHelper.IndexOf(c,e.HoursSingleDigit[0],1)>-1||a.StringHelper.IndexOf(c,e.SecondSingleDigit[0],1)>-1,a.StringHelper.IndexOf(c,e.YearTwoDigit[0],1)>-1||a.StringHelper.IndexOf(c,e.DaySingleDigit[0],1)>-1,0);g<c.length;g++){var h=c[g];'"'===h?f=!f:f||("Y"===h||"D"===h||"S"===h||"E"===h||"G"===h?h=h.toLowerCase():"M"===h&&(g>1?o.IsEquals("A",c[g-1],!0)||o.IsEquals("P",c[g-1],!0)||(h=h.toLowerCase()):h=h.toLowerCase())),d.Append(h)}return d.toString()},e.prototype.ProcessAMPM=function(b){var c=!1;a.StringHelper.Contains(b.value,e.AMPMTwoDigit)&&(b.value=a.StringHelper.Replace(b.value,e.AMPMTwoDigit,e.StandardAMPMSingleDigit),c=!0);var d=this.DateTimeFormatInfo();a.StringHelper.Contains(b.value,e.AMPMSingleDigit)&&(b.value=a.StringHelper.Replace(b.value,e.AMPMSingleDigit,e.StandardAMPMSingleDigit),d&&(d.AMDesignator=e.AMPMSingleDigit.substr(0,1),d.PMDesignator=e.AMPMSingleDigit.substr(2,1)),c=!0);var f=this.CurrentAMPM();if(a.StringHelper.Contains(b.value,f)){b.value=a.StringHelper.Replace(b.value,f,e.StandardAMPMSingleDigit);var g=f.split("/");g&&2===g.length&&(d.AMDesignator=g[0],d.PMDesignator=g[1]),c=!0}return c},e.prototype.Replace=function(b,c,d,f,g,h,i,j){if(h.value=b,f||g){var k=[],l=!0,m=a.StringHelper.IndexOf(h.value,e.HoursSingleDigit[0],1)>-1||a.StringHelper.IndexOf(h.value,e.SecondSingleDigit[0],1)>-1,n=a.StringHelper.IndexOf(h.value,e.YearTwoDigit[0],1)>-1||a.StringHelper.IndexOf(h.value,e.DaySingleDigit[0],1)>-1;!n&&m&&(l=!1);for(var p=!1,q=0,r=0;r<h.value.length;r++){var s=h.value[r];if(o.IsEquals(s,e.HoursSingleDigit[0],!0)||o.IsEquals(s,e.SecondSingleDigit[0],!0)?l=!1:(o.IsEquals(s,e.YearTwoDigit[0],!0)||o.IsEquals(s,e.DaySingleDigit[0],!0))&&(l=!0),f&&o.IsEquals(s,c[q],j)&&l||g&&o.IsEquals(s,c[q],j)&&!l){for(var t=!0,u=0;u<c.length;u++)if(u+r>=b.length||!o.IsEquals(c[u],h.value[u+r],j)){t=!1;break}var v=r+c.length-1;if(t&&v+1<h.value.length){var w=h.value[v],x=-1;for(x=v+1;x<h.value.length&&o.IsEquals(w,h.value[x],j);x++);x>v+1&&(r=x,t=!1)}t&&!p&&new a._ArrayHelper(k).insert(0,r)}'"'===s&&(p=!p)}if(k.length>0){if(!i)for(r=0;r<k.length;r++){var y=k[r];h.value=a.StringHelper.Remove(h.value,y,c.length),h.value=a.StringHelper.Insert(h.value,y,d)}return!0}return!1}return!1},e.defaultDateTimeNumberStringConverter=new F,e.YearTwoDigit="yy",e.YearSingleDigit="y",e.YearFourDigit="yyyy",e.MonthSingleDigit="m",e.MonthTwoDigit="mm",e.MonthAbbreviation="mmm",e.MonthUnabbreviated="mmmm",e.MonthJD="mmmmm",e.DaySingleDigit="d",e.DayTwoDigit="dd",e.DayWeekDayAbbreviation="aaa",e.DayWeekDayUnabbreviated="aaaa",e.HoursSingleDigit="h",e.HoursTwoDigit="hh",e.MinuteSingleDigit="m",e.MinuteTwoDigit="mm",e.SecondSingleDigit="s",e.SecondTwoDigit="ss",e.SubSecondSingleDigit=".0",e.SubSecondTwoDigit=".00",e.SubSecondThreeDigit=".000",e.EraYear="e",e.AMPMTwoDigit="AM/PM",e.AMPMSingleDigit="A/P",e.StandardYearSingleDigit="%y",e.StandardMonthSingleDigit="%M",e.StandardMonthTwoDigit="MM",e.StandardMonthAbbreviation="MMM",e.StandardMonthUnabbreviated="MMMM",e.StandardAMPMSingleDigit="tt",e.StandardMinuteSingleDigit="%m",e.StandardHourSingleDigit="H",e.StandardHourTwoDigit="HH",e.StandardSecondSingleDigit="%s",e.StandardSubSecondSingleDigit=".f",e.StandardSubSecondTwoDigit=".ff",e.StandardSubSecondThreeDigit=".fff",e.StandardDayWeekDayAbbreviation="ddd",e.StandardDayWeekDayUnabbreviated="dddd",e.PlaceholderMonthJD=o.ReplacePlaceholder+"mmmmm",e.defaultAbsoluteTime=new Date(1899,11,30,0,0,0,0),e.keyWords=[e.YearTwoDigit,e.YearFourDigit,e.MonthSingleDigit,e.MonthTwoDigit,e.MonthAbbreviation,e.MonthUnabbreviated,e.MonthJD,e.DaySingleDigit,e.DayTwoDigit,e.DayWeekDayAbbreviation,e.DayWeekDayUnabbreviated,e.HoursSingleDigit,e.HoursTwoDigit,e.MinuteSingleDigit,e.MinuteTwoDigit,e.SecondSingleDigit,e.SecondTwoDigit,"ggg","gg","g","ee","e"],e}(p),H=function(){function a(){}return a.prototype.ConvertTo=function(a,b,d,e,f){if(e!=c&&f!=c){var g=e.GetDBNumber(f.Type());if(g!=c)return f.ReplaceNumberString(a,g,d)}return a},a}(),I=function(b){function d(d,e,f,g){b.call(this,e,f,g),this.baseNumberStringConverter=p.prototype.NumberStringConverter,this.baseNumberFormatInfo=p.prototype.NumberFormatInfo,this.baseCultureName=p.prototype.CultureName;var h=this;h.numberFormatString=c,h.fullFormatString=c,h.isGeneralNumber=!1,h.fractionIntegerFormat=c,h.fractionNumeratorFormat=c,h.fractionDenominatorFormat=c,h.excelFormatString=l.Empty,h._classNames.push("NumberFormatDigital");var i=p.TrimNotSupportSymbol(d);if(h.fullFormatString=o.Filter(d,o.LeftSquareBracket,o.RightSquareBracket),h.excelFormatString=i,e){var j=i;i=o.ReplaceKeyword(j,h.PartLocaleID().OriginalToken(),h.PartLocaleID().CurrencySymbol())}h.PartDBNumberFormat()&&(h.excelFormatString=o.ReplaceKeyword(h.excelFormatString,h.PartDBNumberFormat().OriginalToken(),h.PartDBNumberFormat().toString())),i=o.Filter(i,o.LeftSquareBracket,o.RightSquareBracket);var k=i.indexOf(o.SolidusSign);if(k>-1){i=a.StringHelper.Replace(i,"\\"+o.QuestionMark,o.Zero);var m=i.split(o.SolidusSign);if(m&&2===m.length){h.fractionDenominatorFormat=m[1];var n=m[0];if(n){var q=n.lastIndexOf(o.Space);q>-1?(h.fractionIntegerFormat=n.substr(0,q),h.fractionNumeratorFormat=n.substr(q+1,n.length-q-1)):h.fractionNumeratorFormat=n}}}h.numberFormatString=i}return __extends(d,b),d.prototype.NumberStringConverter=function(a){var b=this;return 0===arguments.length?b.baseNumberStringConverter()?b.baseNumberStringConverter():d.defaultNumberStringConverter:(b.baseNumberStringConverter(a),a)},d.prototype.FormatString=function(){return this.fullFormatString},d.prototype.NumberFormatInfo=function(b){var c=this;return 0===arguments.length?c.baseNumberFormatInfo()?c.baseNumberFormatInfo():c.PartLocaleID()&&c.PartLocaleID().CultureInfo()?c.PartLocaleID().CultureInfo().NumberFormat():c.baseCultureName()?a._CultureInfo.getCulture(c.baseCultureName()).NumberFormat():o.NumberFormatInfo():(c.baseNumberFormatInfo(b),b)},d.prototype.IsGeneralNumber=function(a){return 0===arguments.length?this.isGeneralNumber:(this.isGeneralNumber=a,a)},d.prototype.ExcelCompatibleFormatString=function(){return this.excelFormatString},d.prototype.Format=function(b){if(a.util.isType(b,"boolean"))return b.toString().toUpperCase();var e=this,g=a.FormatConverter.ToDouble(b);if(isNaN(g)||!isFinite(g)||isNaN(b))return"string"==typeof b?b:c;var h,i=e.NaNSymbol(),j=c;if(h=e.CultureName()?a._CultureInfo.getCulture(e.CultureName()):a._CultureInfo.currentCulture(),e.fractionNumeratorFormat&&e.fractionDenominatorFormat){var k={value:0},m={value:0},n={value:0},p=e.fractionDenominatorFormat.length;if(d.GetFraction(g,p,k,m,n)){var q=e.GetGCD(m.value,n.value);if(q>1&&(m.value/=q,n.value/=q),e.fractionIntegerFormat){j=new a.StringBuilder,0!==k.value&&(j.Append(new a._NumberHelper(k.value).customCultureFormat(e.fractionIntegerFormat,h)),j.Append(o.Space)),0===k.value&&0>g&&j.Append(o.NegativeSign),0===g&&j.Append("0");var r=e.fractionDenominatorFormat,s=parseFloat(r);if(!isNaN(s)&&s>0){m.value*=s/n.value,r=l.Empty,n.value=s;var t=f(m.value),u=t-m.value;m.value=parseFloat(.5>=u&&u>=0?t.toString():(t-1).toString())}var v=e.fractionNumeratorFormat,w=parseFloat(v);if(!isNaN(w)&&0===w){var x=v.length,y=m.value.toString(),z=y.length;x>z?v=v.substr(0,x-(x-z)):z>x&&(y=y.substr(0,z-(z-x)),m.value=parseInt(y,10))}return 0!==m.value&&(j.Append(new a._NumberHelper(m.value).customCultureFormat(v,h).replace(/^0*/,"")),j.Append(o.SolidusSign),j.Append(new a._NumberHelper(n.value).customCultureFormat(r,h).replace(/^0*/,""))),j.toString()}j=new a.StringBuilder;var A=k.value*n.value+m.value,r=e.fractionDenominatorFormat,s=parseFloat(r);if(s>0){A*=s/n.value,r=l.Empty,n.value=s;var t=f(A),u=t-A;A=parseFloat(.5>=u&&u>=0?t.toString():(t-1).toString()),j.Append(A+o.SolidusSign+n.value)}else j.Append(new a._NumberHelper(A).customCultureFormat(e.fractionNumeratorFormat,h).replace(/^0*/,"")),j.Append(o.SolidusSign),j.Append(new a._NumberHelper(n.value).customCultureFormat(e.fractionDenominatorFormat,h).replace(/^0*/,""));return j.toString()}return g.toString()}return i=new a._NumberHelper(g).customCultureFormat(e.EncodeNumberFormat(e.numberFormatString),h),e.NumberStringConverter()&&(i=e.NumberStringConverter().ConvertTo(i,b,e.isGeneralNumber,e.PartLocaleID(),e.PartDBNumberFormat())),i},d.prototype.Parse=function(b){var d=this;if(b=d.TrimSpecialSymbol(b),b=d.TrimCurrencySymbol(b),!b||b===l.Empty)return c;if(a.StringHelper.EndsWith(b,o.NumberGroupSeparator))return b;var f=C.FixJapaneseChars(b);if("true"===b.toLowerCase())return!0;if("false"===b.toLowerCase())return!1;var g=o.IsDecimal(f,d.NumberFormatInfo()),i=a.StringHelper.IndexOf(f,o.ExponentialSymbol,1),j=i>-1;if(d.numberFormatString){var k={value:0};b=d.TrimPercentSign(b,k);var m=b;j&&(m=b.substr(0,i)),m[0]===o.NumberFormatInfo().PositiveSign&&(m=m.substr(1),b=b.substr(1));var n=a.StringHelper.Replace(m,o.NumberGroupSeparator,""),p=n.indexOf(o.DecimalSeparator);if(p===n.lastIndexOf(o.DecimalSeparator)){var q=new a.StringBuilder("#,##0");if(-1!==p){q.Append(".");for(var r=n.length-p-1,s=0;r>s;s++)q.Append("0")}var t=new v(q.toString()).Format(n);t===m&&(b=j?n+b.substr(i):n)}var u=parseFloat(b),w=c;if(u.toString()!==b){var x=d.NumberFormatInfo(),y=o.DecimalSeparator;x&&(y=x.NumberDecimalSeparator),g||j?g&&!j?w=new RegExp("^((\\+|-)?\\d*)"+y+"(\\d*)$","ig"):!g&&j?w=new RegExp("^((\\+|-)?\\d+)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig"):g&&j&&(w=new RegExp("^((\\+|-)?\\d*)"+y+"(\\d*)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig")):w=new RegExp("^((\\+|-)?\\d+)$","ig")}if(!isNaN(u)&&isFinite(u)&&(!w||w.test(b)))return k.value>0&&(u/=parseFloat((100*k.value).toString())),0!==u&&0!==e(u-h(u))&&(g=!0),j&&(g=!0),d.ToObject(u,g)}return c},d.prototype.EncodeNumberFormat=function(b){if(b){for(var c=b.split(""),d=new a.StringBuilder,e=0;e<c.length-1;)"\\"===c[e]?(d.Append(c[e+1]),e+=2):(d.Append(c[e]),e++);e===c.length-1&&"\\"!==c[e]&&d.Append(c[e]),b=d.toString()}return b},d.prototype.ToObject=function(a,b){return b?a:1e22>=a?a:a},d.prototype.TrimPercentSign=function(b,c){if(c.value=0,!b||b===l.Empty)return b;var d=b,e=o.PercentSymbol,f=b.indexOf(e);return f===b.length-1&&f===b.lastIndexOf(e)&&(d=a.StringHelper.Replace(d,e,""),c.value+=(b.length-d.length)/e.length),d},d.prototype.TrimSpecialSymbol=function(b){if(!b||b===l.Empty)return b;for(var c=b,d=-1,e=0;e<c.length;e++)if(m.IsDigit(c[e])){d=e;break}for(var f=-1,g=c.length-1;g>-1;g--)if(m.IsDigit(c[g])){f=g;break}for(var h=c.length-1;h>-1;h--){var i=c[h];if(this.IsSpecialSymbol(i))m.IsWhiteSpace(i)?(d>h||h>f)&&(c=a.StringHelper.Remove(c,h,1)):c=a.StringHelper.Remove(c,h,1);else if(("-"===i||"+"===i)&&h>0&&"e"!==c[h-1]&&"E"!==c[h-1]&&"("!==c[h-1]&&c[h-1].toString()!==o.NumberFormatInfo().CurrencySymbol)break}return c},d.prototype.IsStandardNumberSymbol=function(a){var b=this.NumberFormatInfo()?this.NumberFormatInfo():o.NumberFormatInfo();if(b){var c=a.toString();if(c===b.CurrencyDecimalSeparator||c===b.CurrencyGroupSeparator||c===b.CurrencySymbol||c===b.NaNSymbol||c===b.NegativeInfinitySymbol||c===b.NegativeSign||c===b.NumberDecimalSeparator||c===b.NumberGroupSeparator||c===b.PercentDecimalSeparator||c===b.PercentGroupSeparator||c===b.PercentSymbol||c===b.PerMilleSymbol||c===b.PositiveInfinitySymbol||c===b.PositiveSign)return!0}return!1},d.prototype.IsSpecialSymbol=function(a){return this.IsStandardNumberSymbol(a)?!1:m.IsWhiteSpace(a)?!0:!1},d.prototype.TrimCurrencySymbol=function(a){if(!a)return a;var b=this.NumberFormatInfo()?this.NumberFormatInfo():o.NumberFormatInfo();if(b){var c=b.CurrencySymbol,d=a.toString().indexOf(c);0===d&&d===a.lastIndexOf(c)&&(a=a.substr(1))}return a},d.EvaluateFormat=function(a){return p.ContainsKeywords(a,d.keywords)},d.GetFraction=function(a,b,c,d,e){return C.GetFraction(a,b,c,d,e)},d.prototype.GetGCD=function(a,b){if(0==a)return e(b);if(0==b)return e(a);for(var c=i(a,b),d=j(a,b),f=c%d;0!=f;)c=d,d=f,f=c%d;return e(d)},d.defaultNumberStringConverter=new H,d.keywords=[o.Exponential1,o.Exponential2,o.NumberSign,o.DecimalSeparator,o.NumberGroupSeparator,o.PercentSymbol,o.Zero,o.SolidusSign],d}(p),J=function(b){function f(d,e,g,h){if(b.call(this,e,g,h),this.digitalFormat=c,this.exponentialDigitalFormat=c,this.fullFormatString=c,this._classNames.push("NumberFormatGeneral"),arguments.length>0){if(!f.EvaluateFormat(d))throw a.SR.Exp_FormatIllegal;if(d.indexOf(o.Zero)>=0||d.indexOf(o.NumberSign)>=0||d.indexOf(o.DecimalSeparator)>=0||d.indexOf(o.CommercialAt)>=0)throw a.SR.Exp_FormatIllegal;this.fullFormatString=d}else this.fullFormatString=p.General}return __extends(f,b),f.prototype.DigitalFormat=function(){var a=this;if(!a.digitalFormat){var b=a.fullFormatString;b=o.ReplaceKeyword(b,p.General,f.GeneralNumber),a.digitalFormat=new I(b,a.PartLocaleID(),a.PartDBNumberFormat(),a.CultureName()),a.digitalFormat.IsGeneralNumber(!0)}return a.digitalFormat},f.prototype.ExponentialDigitalFormat=function(){var a=this;return a.exponentialDigitalFormat||(a.exponentialDigitalFormat=new I("0.#####E+00",a.PartLocaleID(),a.PartDBNumberFormat(),a.CultureName()),a.exponentialDigitalFormat.IsGeneralNumber(!0)),a.exponentialDigitalFormat},f.prototype.FormatString=function(){return a.StringHelper.Replace(this.fullFormatString,f.GeneralPlaceholder,p.General)},f.prototype.Format=function(b){var f=this;if(a.FormatConverter.IsNumber(b)){var g=f.PartLocaleID()?f.PartLocaleID().AllowScience():!0,h=a.FormatConverter.ToDouble(b);if(h!==d&&h!==c)return e(h)>99999999999&&g||e(h)<1e-11&&0!==h?f.ExponentialDigitalFormat().Format(b):f.DigitalFormat().Format(b)}else{if(a.util.isType(b,"string")){var i=a.StringHelper.Replace(f.FormatString(),'"',"");return i=o.TrimEscape(i),i?a.StringHelper.Replace(i,"General",b):b}if(a.util.isType(b,"boolean"))return b.toString().toUpperCase()}return""},f.prototype.Parse=function(b){if(l.IsNullOrEmpty(b))return c;var f=!1,g=a.StringHelper.IndexOf(b,"-");if(g>0&&(o.IsEquals(b.charAt(g-1),o.ExponentialSymbol,!0)||(f=!0)),a.StringHelper.Contains(b,"/")||f||a.StringHelper.Contains(b,":")||a.StringHelper.Contains(b,"-")){var h=a._DateTimeHelper.parseLocale(b);if(h)return h}var i=b,j=c,k=c;i.charAt(0)===o.NegativeSign?k=!0:i.charAt(0)===o.NumberFormatInfo().PositiveSign&&(k=!1);var m=!1;if(k&&i.length>3&&i.charAt(1)===o.LeftParenthesis&&i.charAt(i.length-1)===o.RightParenthesis&&(m=!0),k&&m){if(j=this.DigitalFormat().Parse(a.StringHelper.Remove(b,0,1)))return a.util.isType(j,"number")?e(j)*(k?-1:1):j}else if(j=this.DigitalFormat().Parse(b),j!==d&&j!==c)return j;return b},f.GeneralMonthDay=function(){return["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"]},f.GeneralYearMonth=function(){return["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"]},f.GeneralYearMonthDay=function(){return["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"]},f.GeneralHourMinute=function(){return["H:m","h:m tt"]},f.GeneralHourMinuteWithDate=function(){return["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"]},f.GeneralHourMinuteSecond=function(){return["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"]},f.GeneralHourMinuteSecondSubSecond=function(){return["H:m:s.FFF","h:m:s.FFF tt"]},f.GeneralHourMinuteSecondWithDate=function(){return["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"]},f.GeneralHourMinuteSecondSubSecondWithDate=function(){return["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]},f.EvaluateFormat=function(a){return a&&a!==l.Empty?p.ContainsKeywords(a,[p.General.toLowerCase()]):!1},f.GeneralPlaceholder="@NumberFormat",f.GeneralNumber="##################0.################",f}(p)}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("conditionalFormat",["core.common","core.globalize","core.stringResource","core.theme","core.imageLoader"]);var b=null,c=void 0,d="undefined",e=Math.min,f=Math.max,g=Math.abs,h=Math.floor;!function(a){a[a.RelationCondition=0]="RelationCondition",a[a.NumberCondition=1]="NumberCondition",a[a.TextCondition=2]="TextCondition",a[a.ColorCondition=3]="ColorCondition",a[a.FormulaCondition=4]="FormulaCondition",a[a.DateCondition=5]="DateCondition",a[a.DateExCondition=6]="DateExCondition",a[a.TextLengthCondition=7]="TextLengthCondition",a[a.Top10Condition=8]="Top10Condition",a[a.UniqueCondition=9]="UniqueCondition",a[a.AverageCondition=10]="AverageCondition",a[a.CellValueCondition=11]="CellValueCondition",a[a.AreaCondition=12]="AreaCondition"}(a.ConditionType||(a.ConditionType={}));a.ConditionType;!function(a){a[a.ConditionRuleBase=0]="ConditionRuleBase",a[a.CellValueRule=1]="CellValueRule",a[a.SpecificTextRule=2]="SpecificTextRule",a[a.FormulaRule=3]="FormulaRule",a[a.DateOccurringRule=4]="DateOccurringRule",a[a.Top10Rule=5]="Top10Rule",a[a.UniqueRule=6]="UniqueRule",a[a.DuplicateRule=7]="DuplicateRule",a[a.AverageRule=8]="AverageRule",a[a.ScaleRule=9]="ScaleRule",a[a.TwoScaleRule=10]="TwoScaleRule",a[a.ThreeScaleRule=11]="ThreeScaleRule",a[a.DataBarRule=12]="DataBarRule",a[a.IconSetRule=13]="IconSetRule"
}(a.RuleType||(a.RuleType={}));var i=(a.RuleType,function(){function c(a){var c=this;c.condition=b,c.ranges=b,c.style=b,c._priority=1,c._stopIfTrue=!1,c.style=a}return c.prototype.hasNoReference=function(){return!(this.ranges&&this.ranges.length>0)},c.prototype.evaluate=function(a,c,d,e){var f=this;if(f.contains(c,d)){f.initCondition();var g={baseRow:0,baseCol:0};f.getBaseCoordinate(g),f.condition.adjustOffset(c-g.baseRow,d-g.baseCol);var h=b;return f.condition.evaluate(a,c,d,e)&&(h=f.getExpected()),f.condition.adjustOffset(0,0),h}return b},c.prototype.contains=function(a,b){var c=this.ranges;if(c)for(var d,e=c.length,f=0;e>f;f++)if(d=this.ranges[f],d.contains(a,b))return!0;return!1},c.prototype.createCondition=function(){},c.prototype.initCondition=function(){this.condition||(this.condition=this.createCondition())},c.prototype.priority=function(){return this._priority},c.prototype.stopIfTrue=function(a){return 0===arguments.length?this._stopIfTrue:(this._stopIfTrue=a,this)},c.prototype.getExpected=function(){return this.style},c.prototype.reset=function(){var a=this;a.ranges=b,a.condition=b,a.style=b,a._stopIfTrue=!1,a._priority=1},c.prototype.intersects=function(a,b,c,d){var e=this.ranges;if(e)for(var f,g=e.length,h=0;g>h;h++)if(f=e[h],f.intersect(a,b,c,d))return!0;return!1},c.prototype.isScaleRule=function(){return!1},c.prototype.getBaseCoordinate=function(a){a.baseRow=Number.MAX_VALUE,a.baseCol=Number.MAX_VALUE;var b=this;if(b.ranges&&b.ranges.length>0)for(var c=0;c<b.ranges.length;c++){var d=b.ranges[c];a.baseRow=e(d.row,a.baseRow),a.baseCol=e(d.col,a.baseCol)}else a.baseRow=0,a.baseCol=0},c.prototype._addRows=function(b,c){var d=this;if(d.ranges)for(var e=d.ranges.length,f=0;e>f;f++){var g=d.ranges[f];g.row>=b?d.ranges[f]=new a.Range(g.row+c,g.col,g.rowCount,g.colCount):g.row<b&&b<g.row+g.rowCount&&(d.ranges[f]=new a.Range(g.row,g.col,g.rowCount+c,g.colCount))}},c.prototype._addColumns=function(b,c){var d=this;if(d.ranges)for(var e=d.ranges.length,f=0;e>f;f++){var g=d.ranges[f];g.col>=b?d.ranges[f]=new a.Range(g.row,g.col+c,g.rowCount,g.colCount):g.col<b&&b<g.col+g.colCount&&(d.ranges[f]=new a.Range(g.row,g.col,g.rowCount,g.colCount+c))}},c.prototype._removeRows=function(b,c){var d=this;if(d.ranges){for(var f=[],g=d.ranges.length,h=0;g>h;h++){var i=d.ranges[h];if(i.row>b)i.row+i.rowCount<=b+c?f.push(i):d.ranges[h]=new a.Range(i.row-c,i.col,i.rowCount,i.colCount);else if(i.row<=b&&b<i.row+i.rowCount){var j=new a.Range(i.row,i.col,i.rowCount-e(i.row+i.rowCount-b,c),i.colCount);0===j.colCount||0===j.rowCount?f.push(i):d.ranges[h]=j}}for(var k=f.length,l=0;k>l;l++){var m=f[l];d.ranges.remove(m)}}},c.prototype._removeColumns=function(b,c){var d=this;if(d.ranges){for(var f=[],g=d.ranges.length,h=0;g>h;h++){var i=d.ranges[h];if(i.col>b)i.col+i.colCount<=b+c?f.push(i):d.ranges[h]=new a.Range(i.row,i.col-c,i.rowCount,i.colCount);else if(i.col<=b&&b<i.col+i.colCount){var j=new a.Range(i.row,i.col,i.rowCount,i.colCount-e(i.col+i.colCount-b,c));0===j.colCount||0===j.rowCount?f.push(i):d.ranges[h]=j}}for(var k=f.length,l=0;k>l;l++){var m=f[l];d.ranges.remove(m)}}},c.prototype._isDefaultValue=function(a,c){switch(a){case"ranges":return c===b;case"style":return c===b;case"priority":return 1===c;case"stopIfTrue":return c===!1;default:return!1}},c.prototype.toJSON=function(){},c.prototype.fromJSON=function(){},c}());a.ConditionRuleBase=i;var j=function(){function a(a,c,d){var e=this;e.conditionType="RelationCondition",e.compareType=1,e.item1=b,e.item2=b,e.ignoreBlank=!1,e._dict=b,e.compareType=a,e.item1=c,e.item2=d}return a.prototype.adjustOffset=function(){},a.prototype.create=function(b,c,d){return new a(b,c,d)},a.prototype._getActualValue=function(a,b,c,d,e){if(a&&b&&"ColorCondition"===b.conditionType){var f=a.getActualStyle(c,d);f&&(0===b.compareType?e=f.backColor:1===b.compareType&&(e=f.foreColor))}return e},a.prototype.evaluate=function(a,d,e,f,g){var h,i,j=this;j.item1&&(j.item1.ignoreBlank=j.ignoreBlank,h=arguments.length<5?j._getActualValue(a,j.item1,d,e,f):f),j.item2&&(j.item2.ignoreBlank=j.ignoreBlank,i=arguments.length<5?j._getActualValue(a,j.item2,d,e,f):g);var k,l;return 1===j.compareType?(k=j.item1===c||j.item1===b?!1:j.item1.evaluate(a,d,e,h))?l=j.item2===c||j.item2===b?!1:j.item2.evaluate(a,d,e,i):!1:0===j.compareType?(k=j.item1===c||j.item1===b?!1:j.item1.evaluate(a,d,e,h))?!0:l=j.item2===c||j.item2===b?!1:j.item2.evaluate(a,d,e,i):!1},a.prototype.reset=function(){var a=this;a.ignoreBlank=!1,a.compareType=1,a.item1=b,a.item2=b},a.prototype._getConditionTypeDictionary=function(){if(!this._dict){var b={};b[0]=a,b[1]=m,b[2]=o,b[3]=p,b[4]=r,b[5]=s,b[6]=u,b[7]=v,b[8]=x,b[9]=A,b[10]=C,b[11]=l,b[12]=K,this._dict=b}return this._dict},a.prototype.toJSON=function(){var a=this,d={compareType:a.compareType,item1:a.item1?a.item1.toJSON():b,item2:a.item2?a.item2.toJSON():b,conType:0,ignoreBlank:a.ignoreBlank},e={};for(var f in d){var g=d[f];a._isDefaultValue(f,g)||(e[f]=g)}return $.isEmptyObject(e)?c:e},a.prototype._isDefaultValue=function(a,c){switch(a){case"ignoreBlank":return c===!1;case"item1":return c===b;case"item2":return c===b;default:return!1}},a.prototype.fromJSON=function(a){if(a){var e=this;if(a.compareType!==b&&a.compareType!==c&&(e.compareType=a.compareType),a.item1!==b&&a.item1!==c){var f=b,g=e._getConditionTypeDictionary(),h=a.item1.conType;typeof h===d&&(h=0);var i=g[h];i&&(f=new i,f.fromJSON(a.item1)),e.item1=f}if(a.item2!==b&&a.item2!==c){var f=b,g=e._getConditionTypeDictionary(),j=a.item2.conType;typeof j===d&&(j=0);var i=g[j];i&&(f=new i,f.fromJSON(a.item2)),e.item2=f}a.ignoreBlank!==b&&a.ignoreBlank!==c&&(e.ignoreBlank=a.ignoreBlank)}},a}();a.RelationCondition=j;var k=function(d){function e(a,b,c,e){d.call(this,e),this.operator=a,this.value1="string"==typeof b?$.trim(b):b,this.value2="string"==typeof c?$.trim(c):c}return __extends(e,d),e.prototype.createCondition=function(){var a,c,d=this,e=d.isFormula(d.value1)?d.value1.replace("=",""):b,f=(d.isFormula(d.value1)?b:d.value1,d.isFormula(d.value2)?d.value2.replace("=",""):b),g=(d.isFormula(d.value2)?b:d.value2,d.operator),h=b;if(6===g)return a=new l(3,d.value1,e),a.treatNullValueAsZero=!0,c=new l(5,d.value2,f),c.treatNullValueAsZero=!0,new j(1,a,c);if(7===g)return a=new l(4,d.value1,e),a.treatNullValueAsZero=!0,c=new l(2,d.value2,f),c.treatNullValueAsZero=!0,new j(0,a,c);if(0===g?h=0:2===g?h=2:3===g?h=3:4===g?h=4:5===g?h=5:1===g&&(h=1),h!==b){var i=new l(h,d.value1,e);return i.treatNullValueAsZero=!0,i}return b},e.prototype.reset=function(){var a=this;a.operator=6,a.value1=b,a.value2=b,a.style=b,a._stopIfTrue=!1,a._priority=1},e.prototype.isFormula=function(a){return a!==c&&a!==b&&"="===a[0]},e.prototype.toJSON=function(){var a=this,b={ruleType:1,ranges:a.ranges,style:a.style,operator:a.operator,value1:a.value1,value2:a.value2,priority:a._priority,stopIfTrue:a._stopIfTrue},d={};for(var e in b){var f=b[e];a._isDefaultValue(e,f)||(d[e]=f)}return $.isEmptyObject(d)?c:d},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.operator!==b&&d.operator!==c&&(e.operator=d.operator),d.value1!==b&&d.value1!==c&&(e.value1=d.value1),d.value2!==b&&d.value2!==c&&(e.value2=d.value2),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.CellValueRule=k;var l=function(){function d(a,c,d){var e=this;e.compareType=b,e.treatNullValueAsZero=!1,e.compareType=a,e.expected=c,e.formula=d}return d.prototype.adjustOffset=function(){},d.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},d.prototype.evaluate=function(a,b,c,d){var e=this.getExpected(a,b,c);return this.checkCondition(e,d)},d.prototype.isSatisfyingCondition=function(a){var c=this.getExpected(b,0,0);return this.checkCondition(c,a)},d.prototype.checkCondition=function(d,e){var f=this,g=0,h=!1;if("boolean"==typeof d){var i=d;switch(f.compareType){case 0:return e===d;case 1:return e!==d;case 2:return f._compareBool(i,e)<0;case 3:return f._compareBool(i,e)<=0;case 4:return f._compareBool(i,e)>0;case 5:return!!f._compareBool(i,e)}}try{if(e===c||e===b)f.treatNullValueAsZero?(h=!0,g=0):(h=!1,g=e);else{var j={value:void 0};a.Calc.Convert.tryToDouble(e,j)?(g=j.value,h=!isNaN(g)):h=!1}}catch(k){h=!1}if(!(e!==c&&e!==b||d!==c&&d!==b))switch(f.compareType){case 0:case 3:case 5:return!0;case 1:case 2:case 4:return!1;default:return!1}if(h){var l=0,m=!1;try{var j={value:void 0};a.Calc.Convert.tryToDouble(d,j)&&(l=j.value,m=!0)}catch(n){}if(!m){switch(f.compareType){case 0:return!1;case 1:return!0}return!1}switch(f.compareType){case 0:return g===l;case 1:return g!==l;case 2:return g>l;case 3:return g>=l;case 4:return l>g;case 5:return l>=g}}else if("string"==typeof e){var o=b;if("string"!=typeof d){switch(f.compareType){case 0:return!1;case 1:return!0}return!1}o=d;var p=e;switch(f.compareType){case 0:return p===o;case 1:return p!==o;case 2:return p>o;case 3:return p>=o;case 4:return o>p;case 5:return o>=p}}return!1},d.prototype._compareBool=function(a,b){return a===b?0:a===!1&&b===!0?-1:1},d.prototype._isDefaultValue=function(a,b){switch(a){case"treatNullValueAsZero":return b===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={compareType:a.compareType,expected:a.expected,formula:a.formula,conType:11,treatNullValueAsZero:a.treatNullValueAsZero},d={};for(var e in b){var f=b[e];a._isDefaultValue(e,f)||(d[e]=f)}return $.isEmptyObject(d)?c:d},d.prototype.fromJSON=function(a){if(a){var d=this;a.compareType!==b&&a.compareType!==c&&(d.compareType=a.compareType),a.expected!==b&&a.expected!==c&&(d.expected=a.expected),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.treatNullValueAsZero!==b&&a.treatNullValueAsZero!==c&&(d.treatNullValueAsZero=a.treatNullValueAsZero)}},d}();a.CellValueCondition=l;var m=function(){function a(a,b,c){var d=this;d.compareType=0,d.conditionType="NumberCondition",d.ignoreBlank=!1,d.integerValue=!1,d.compareType=a,d.expected=b,d.formula="string"==typeof c?$.trim(c).replace("=",""):c}return a.prototype.evaluate=function(a,c,d,e){var f=this.getExpected(a,c,d);return this.integerValue&&(f=isNaN(f)?b:parseInt(f,10)),this.checkCondition(f,e)},a.prototype.checkCondition=function(a,d){var e=this;if((d===c||d===b||""===d)&&e.ignoreBlank)return!0;if(isNaN(d))return!1;if(a===c||a===b){if(e.ignoreBlank)return!0;a=0}var f=0;try{f=parseFloat(d)}catch(g){return!1}if(e.integerValue===!0){var i=f-h(f)===0;if(i===!1)return!1}switch(e.compareType){case 0:return f===a;case 1:return f!==a;case 2:return f>a;case 3:return f>=a;case 4:return a>f;case 5:return a>=f}return!1},a.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();return e?e.evaluate(a._getSheetSource(),d.formula,b,c):d.expected}return d.expected},a.prototype.reset=function(){var a=this;a.expected=b,a.ignoreBlank=!1,a.compareType=0,a.integerValue=!1},a.prototype._isDefaultValue=function(a,b){switch(a){case"ignoreBlank":return b===!1;case"integerValue":return b===!1;default:return!1}},a.prototype.toJSON=function(){var a=this,b={compareType:a.compareType,expected:a.expected,formula:a.formula,conType:1,ignoreBlank:a.ignoreBlank,integerValue:a.integerValue},d={};for(var e in b){var f=b[e];a._isDefaultValue(e,f)||(d[e]=f)}return $.isEmptyObject(d)?c:d},a.prototype.fromJSON=function(a){if(a){var d=this;a.compareType!==b&&a.compareType!==c&&(d.compareType=a.compareType),a.expected!==b&&a.expected!==c&&(d.expected=a.expected),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(d.ignoreBlank=a.ignoreBlank),a.integerValue!==b&&a.integerValue!==c&&(d.integerValue=a.integerValue)}},a}();a.NumberCondition=m;var n=function(d){function e(a,b,c){d.call(this,c),this.text=b,this.operator=a}return __extends(e,d),e.prototype.createCondition=function(){var a;switch(this.operator){case 2:a=2;break;case 3:a=4;break;case 0:a=6;break;case 1:a=7;break;default:a=0}var c=new o(a,this.text,b);return c.ignoreCase=!0,c},e.prototype.reset=function(){var a=this;a.operator=0,a.text="",a.style=b,a._stopIfTrue=!1,a._priority=1},e.prototype.toJSON=function(){var a=this,b={ruleType:2,ranges:a.ranges,style:a.style,operator:a.operator,text:a.text,priority:a._priority,stopIfTrue:a._stopIfTrue},d={};for(var e in b){var f=b[e];a._isDefaultValue(e,f)||(d[e]=f)}return $.isEmptyObject(d)?c:d},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.operator!==b&&d.operator!==c&&(e.operator=d.operator),d.text!==b&&d.text!==c&&(e.text=d.text),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.SpecificTextRule=n;var o=function(){function a(a,c,d){var e=this;e.forceValue2Text=!1,e.useWildCards=!0,e.regex=b,e.ignoreCase=!1,e.conditionType="TextCondition",e.questionMarkWildcard="?",e.questionMarkWildcardRegularExpression=".",e.asteriskWildcard="*",e.asteriskWildcardRegularExpression="[.\n]*",e.ignoreBlank=!1,e.compareType=a,e.expected=c,e.formula="string"==typeof d?$.trim(d).replace("=",""):d}return a.prototype.adjustOffset=function(){},a.prototype.evaluate=function(a,d,e,f){var g=this,h=b;if(g.forceValue2Text===!0||"string"==typeof f||"number"==typeof f)h=f!==c&&f!==b?f.toString():"";else{if(f instanceof Date)return 2===g.compareType||4===g.compareType||6===g.compareType?!1:3===g.compareType||5===g.compareType||7===g.compareType;h=f!==c&&f!==b?f.toString():""}if(g.ignoreBlank&&(h===c||h===b||""===h))return!0;var i=g.getExpectedString(a,d,e);if(g.hasWildcard(i)&&"number"==typeof f)return 3===g.compareType||7===g.compareType||5===g.compareType||1===g.compareType;switch(g.compareType){case 0:return g.isEquals(i,h);case 1:return!g.isEquals(i,h);case 2:return g.isStartWith(i,h);case 3:return!g.isStartWith(i,h);case 4:return g.isEndWith(i,h);case 5:return!g.isEndWith(i,h);case 6:return g.isContains(i,h);case 7:return!g.isContains(i,h)}return!1},a.prototype.getExpectedString=function(a,d,e){var f=this.getExpected(a,d,e);return f===c||f===b?b:f.toString()},a.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},a.prototype.hasWildcard=function(a){return a===c||a===b||""===a?!1:a.indexOf(this.asteriskWildcard)>-1||a.indexOf(this.questionMarkWildcard)>-1},a.prototype.isEquals=function(a,d){var e=this;if(e.useWildCards&&e.hasWildcard(a)){var f=e.createEqualsRegex(a);if(f){var g=d===c&&d===b?"":d;if(f.lastIndex=-1,g!==c&&g!==b)return g.search(f)>-1}return!1}if(d!==c&&d!==b&&""!==d){var h=a!==c&&a!==b?a:"";return e.ignoreCase?h.toLowerCase()===d.toLowerCase():h===d}return a===c||a===b||""===a},a.prototype.createEqualsRegex=function(a){var c=this;if(c.regex)return c.regex;a=c.encodeExpression(a);var d=a,e=new RegExp("\\"+c.questionMarkWildcard,"g");d=d.replace(e,c.questionMarkWildcardRegularExpression),e=new RegExp("\\"+c.asteriskWildcard,"g"),d=d.replace(e,c.asteriskWildcardRegularExpression);var f=b;try{var g=c.ignoreCase?"ig":"g";f=new RegExp("^"+d+"$",g)}catch(h){return b}return f},a.prototype.encodeExpression=function(a){if(!a)return b;var c=a;return c=c.replace(/\^/g,"\\^"),c=c.replace(/\$/g,"\\$"),c=c.replace(/\(/g,"\\("),c=c.replace(/\)/g,"\\)"),c=c.replace(/\[/g,"\\["),c=c.replace(/\]/g,"\\]"),c=c.replace(/\{/g,"\\{"),c=c.replace(/\}/g,"\\}"),c=c.replace(/\./g,"\\."),c=c.replace(/\+/g,"\\+"),c=c.replace(/\|/g,"\\|")},a.prototype.isStartWith=function(a,d){var e,f=this;if(f.useWildCards&&f.hasWildcard(a)){var g=f.createStartWithRegex(a);return g&&(e=d===c||d===b?"":d,g.lastIndex=-1,e!==c&&e!==b)?e.search(g)>-1:!1}if(d!==c&&d!==b&&""!==d){if(a===c||a===b)return!1;var h=a;e=d,f.ignoreCase&&(h=h.toLowerCase(),e=e.toLowerCase());var i=e.match("^"+h);return i!==c&&i!==b&&i.length>0?i[0]===h:!1}return a===c||a===b||""===a},a.prototype.createStartWithRegex=function(a){var c=this;if(c.regex)return c.regex;a=c.encodeExpression(a);var d=a,e=new RegExp("\\"+c.questionMarkWildcard,"g");d=d.replace(e,c.questionMarkWildcardRegularExpression),e=new RegExp("\\"+c.asteriskWildcard,"g"),d=d.replace(e,c.asteriskWildcardRegularExpression);var f=b;try{var g=c.ignoreCase?"ig":"g";f=a[0]===c.asteriskWildcard?new RegExp(d,g):new RegExp("^"+d,g)}catch(h){return b}return f},a.prototype.isEndWith=function(a,d){var e,f=this;if(f.useWildCards&&f.hasWildcard(a)){var g=f.createEndWithRegex(a);return g&&(e=d===c||d===b?"":d,g.lastIndex=-1,e!==c&&e!==b)?e.search(g)>-1:!1}if(d!==c&&d!==b&&""!==d){if(a===c||a===b)return!1;var h=a;e=d,f.ignoreCase&&(h=h.toLowerCase(),e=e.toLowerCase());var i=e.match(h+"$");return i!==c&&i!==b&&i.length>0?i[0]===h:!1}return a===c||a===b||""===a},a.prototype.createEndWithRegex=function(a){var c=this;if(c.regex)return c.regex;a=c.encodeExpression(a);var d=a,e=new RegExp("\\"+c.questionMarkWildcard,"g");d=d.replace(e,c.questionMarkWildcardRegularExpression),e=new RegExp("\\"+c.asteriskWildcard,"g"),d=d.replace(e,c.asteriskWildcardRegularExpression);var f=b;try{var g=c.ignoreCase?"ig":"g";f=a[a.length-1]===c.asteriskWildcard?new RegExp(d,g):new RegExp(d+"$",g)}catch(h){return b}return f},a.prototype.isContains=function(a,d){var e,f=this;if(f.useWildCards&&f.hasWildcard(a)){var g=f.createContainsRegex(a);return g&&(e=d===c||d===b?"":d,g.lastIndex=-1,e!==c&&e!==b)?e.search(g)>-1:!1}if(d!==c&&d!==b&&""!==d){if(a===c||a===b)return!1;var h=a;return e=d,f.ignoreCase&&(h=h.toLowerCase(),e=e.toLowerCase()),e.indexOf(h)>-1}return a===c||a===b||""===a},a.prototype.createContainsRegex=function(a){var c=this;if(c.regex)return c.regex;a=c.encodeExpression(a);var d=a,e=new RegExp("\\"+c.questionMarkWildcard,"g");d=d.replace(e,c.questionMarkWildcardRegularExpression),e=new RegExp("\\"+c.asteriskWildcard,"g"),d=d.replace(e,c.asteriskWildcardRegularExpression);var f=b;try{var g=c.ignoreCase?"ig":"g";f=new RegExp(d,g)}catch(h){return b}return f},a.prototype.reset=function(){var a=this;a.expected=b,a.ignoreBlank=!1,a.compareType=0,a.useWildCards=!0,a.ignoreCase=!1,a.forceValue2Text=!1},a.prototype._isDefaultValue=function(a,c){switch(a){case"forceValue2Text":return c===!1;case"useWildCards":return c===!0;case"ignoreCase":return c===!1;case"regex":return c===b;case"ignoreBlank":return c===!1;default:return!1}},a.prototype.toJSON=function(){var a=this,b={compareType:a.compareType,expected:a.expected,formula:a.formula,forceValue2Text:a.forceValue2Text,useWildCards:a.useWildCards,ignoreCase:a.ignoreCase,regex:a.regex,conType:2,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},a.prototype.fromJSON=function(a){if(a){var d=this;a.compareType!==b&&a.compareType!==c&&(d.compareType=a.compareType),a.expected!==b&&a.expected!==c&&(d.expected=a.expected),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.forceValue2Text!==b&&a.forceValue2Text!==c&&(d.forceValue2Text=a.forceValue2Text),a.useWildCards!==b&&a.useWildCards!==c&&(d.useWildCards=a.useWildCards),a.ignoreCase!==b&&a.ignoreCase!==c&&(d.ignoreCase=a.ignoreCase),a.regex!==b&&a.regex!==c&&(d.regex=a.regex),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(d.ignoreBlank=a.ignoreBlank)}},a}();a.TextCondition=o;var p=function(){function d(a,b){this.conditionType="ColorCondition",this.ignoreBlank=!1,this.compareType=a,this.expected=b}return d.prototype.evaluate=function(a,b,c,d){return this.isEqualsColor(a,d)},d.prototype.isEqualsColor=function(a,d){var e=this,f=e.getColorFromString(e.expected);if(f!==c&&f!==b&&""!==f){var g=e.getColorFromString(d);if(g!==c&&g!==b&&""!==g)return g.a===f.a&&g.r===f.r&&g.g===f.g&&g.b===f.b;var h;if(0===e.compareType?a&&a.getDefaultStyle&&(h=a.getDefaultStyle().backColor):1===e.compareType&&a&&a.getDefaultStyle&&(h=a.getDefaultStyle().foreColor),h)return f.a===h.a&&f.r===h.r&&f.g===h.g&&f.b===h.b}else if(e.ignoreBlank)return!0;return!1},d.prototype.getColorFromString=function(d){return d===c||d===b||""===d?b:a._Color.parse(d)},d.prototype.reset=function(){this.expected=b,this.ignoreBlank=!1,this.compareType=0},d.prototype._isDefaultValue=function(a,b){switch(a){case"ignoreBlank":return b===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={compareType:a.compareType,expected:a.expected,conType:3,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(a){a&&(a.compareType!==b&&a.compareType!==c&&(this.compareType=a.compareType),a.expected!==b&&a.expected!==c&&(this.expected=a.expected),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(this.ignoreBlank=a.ignoreBlank))},d}();a.ColorCondition=p;var q=function(d){function e(b,c){if(d.call(this,c),b&&"string"!=typeof b)throw new Error(a.SR.Exp_InvalidArgument);this.formula=b}return __extends(e,d),e.prototype.createCondition=function(){var a=this,c=new r(4,a.formula&&""!==a.formula?a.formula:b);return a.ranges&&a.ranges.length>0&&(c._baseRow=a.ranges[0].row,c._baseCol=a.ranges[0].col),c},e.prototype.reset=function(){var a=this;a.formula=b,a.style=b,a._stopIfTrue=!1,a._priority=1},e.prototype.isFormula=function(a){return a&&"="===a[0]},e.prototype.toJSON=function(){var a=this,b={ruleType:3,ranges:a.ranges,style:a.style,formula:a.formula,priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.formula!==b&&d.formula!==c&&(e.formula=d.formula),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.FormulaRule=q;var r=function(){function d(a,c){var d=this;d.expected=b,d.ignoreBlank=!1,d.conditionType="FormulaCondition",d._baseRow=b,d._baseCol=b,d._expr=b,d.customValueType=a;var e=c;if("string"==typeof e){var f=$.trim(e);e="="===f[0]?f.substr(1):f}d.formula=e}return d.prototype.adjustOffset=function(){},d.prototype.evaluate=function(d,e,f,g){if(!a.util.hasCalc())return!1;var h=this;if(4===h.customValueType){var i=h.getExpected(d,e,f);if(h.ignoreBlank&&(i===c||i===b||""===i))return!0;try{return a.Calc.Convert.toBool(i)}catch(j){return!1}}else{var k=a.Calc.Convert.isError;switch(h.customValueType){case 0:return g===c||g===b||""===g;case 1:return g!==c&&g!==b&&""!==g;case 2:return k(g);case 3:return!k(g)}}return!1},d.prototype.getExpected=function(d,e,f){var g=this;if(g.formula&&g.formula.length>0){var h=d.getCalcService();if(!h)return g.expected;g._expr||(g._baseRow!==c&&g._baseRow!==b||g._baseCol!==c&&g._baseCol!==b||(g._baseRow=e,g._baseCol=f),g._expr=h.parse(g.formula,g._baseRow,g._baseCol));var i,j,k,l,m,n=h.evaluateParsedFormula(d._getSheetSource(),g._expr,e,f,!0);if(n instanceof a.Calc.Reference){for(i=n.getRowCount(0),j=n.getColumnCount(0),k=[],l=0;i>l;l++)for(k[l]=[],m=0;j>m;m++)k[l][m]=n.getValue(0,l,m);n=k}else if(n instanceof a.Calc.Array){for(i=n.getRowCount(),j=n.getColumnCount(),k=[],l=0;i>l;l++)for(k[l]=[],m=0;j>m;m++)k[l][m]=n.getValue(l,m);n=k}if(n instanceof Array){if(i=n.length,j=n[0].length,1===i&&1===j)return n[0][0];var o=e-g._baseRow,p=f-g._baseCol;return i>o&&j>p?n[o][p]:a.Calc.Errors.NotAvailable}return n}return g.expected},d.prototype.reset=function(){var a=this;a.expected=b,a.ignoreBlank=!1,a.customValueType=0,a._expr=b,a._baseRow=b,a._baseCol=b},d.prototype._isDefaultValue=function(a,c){switch(a){case"expected":return c===b;case"ignoreBlank":return c===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={customValueType:a.customValueType,expected:a.expected,formula:a.formula,conType:4,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(a){if(a){var d=this;a.customValueType!==b&&a.customValueType!==c&&(d.customValueType=a.customValueType),a.expected!==b&&a.expected!==c&&(d.expected=a.expected),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(d.ignoreBlank=a.ignoreBlank)}},d}();a.FormulaCondition=r;var s=function(){function d(a,b,c){var d=this;d.conditionType="DateCondition",d.ignoreBlank=!1,d.compareType=a,d.expected=b,d.formula="string"==typeof c?$.trim(c).replace("=",""):c}return d.prototype.evaluate=function(a,d,e,f){var g=this;if((f===c||f===b||""===f)&&g.ignoreBlank)return!0;if(!(f instanceof Date))return!1;var h=g.getExpectedDateTime(a,d,e);if(h===c||h===b)return!!g.ignoreBlank;switch(g.compareType){case 0:return g.isEquals(h,f);case 1:return!g.isEquals(h,f);case 4:return g.isAfter(h,f);case 5:return g.isAfter(h,f)||g.isEquals(h,f);case 2:return g.isBefore(h,f);case 3:return g.isBefore(h,f)||g.isEquals(h,f)}return!1},d.prototype.getExpectedDateTime=function(c,d,e){var f=this.getExpected(c,d,e);return f instanceof Date?f:"string"==typeof f?a._DateTimeHelper.parseLocale(f):b},d.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},d.prototype.isEquals=function(a,b){return a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},d.prototype.isAfter=function(a,b){var c=this.createDayEnding(a);return b>c},d.prototype.createDayEnding=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999)},d.prototype.isBefore=function(a,b){var c=this.createDayBeginning(a);return c>b},d.prototype.createDayBeginning=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)},d.prototype.reset=function(){this.expected=b,this.ignoreBlank=!1,this.compareType=0},d.prototype._isDefaultValue=function(a,b){switch(a){case"ignoreBlank":return b===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={compareType:a.compareType,expected:a.expected,formula:a.formula,conType:5,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(a){if(a){var d=this;a.compareType!==b&&a.compareType!==c&&(d.compareType=a.compareType),a.expected!==b&&a.expected!==c&&(d.expected="string"===$.type(a.expected)?new Date(a.expected):a.expected),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(d.ignoreBlank=a.ignoreBlank)}},d}();a.DateCondition=s;var t=function(d){function e(a,b){d.call(this,b),this.type=a}return __extends(e,d),e.prototype.createCondition=function(){return new u(this.type)},e.prototype.reset=function(){var a=this;a.type=0,a.style=b,a._stopIfTrue=!1,a._priority=1},e.prototype.toJSON=function(){var a=this,b={ruleType:4,ranges:a.ranges,style:a.style,type:a.type,priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.type!==b&&d.type!==c&&(e.type=d.type),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.DateOccurringRule=t;var u=function(){function d(a){var c=this;c.ignoreBlank=!1,c.formula=b,c.expectTypeId=0,c.conditionType="DateExCondition",c.expected=a}return d.prototype.adjustOffset=function(){},d.prototype.evaluate=function(a,d,e,f){var g=this.getExpectedInt(a,d,e);return g!==c&&g!==b?this.checkCondition(g,f):!1},d.prototype.getExpectedInt=function(a,c,d){var e=this.getExpected(a,c,d);return e=parseInt(e,10),isNaN(e)?b:e},d.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},d.prototype.checkCondition=function(d,e){var f=this,g=e;if(f.ignoreBlank&&(g===c||g===b||""===g))return!0;try{g=a.Calc.Convert.toDateTime(g)}catch(h){return!1}var i;if(0===f.expectTypeId){var k=b,l=b,m=new Date,n=new Date(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds(),m.getMilliseconds());switch(d){case 3:n.setDate(n.getDate()-6),k=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0),l=new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59,59,999);break;case 1:n.setDate(n.getDate()-1),k=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0),l=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999);break;case 0:k=new Date(m.getFullYear(),m.getMonth(),m.getDate(),0,0,0,0),l=new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59,59,999);break;case 2:n.setDate(n.getDate()+1),k=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0),l=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999);break;case 8:var o=m;o.setDate(m.getDate()-m.getDay()-7);var p=n;p.setDate(n.getDate()-n.getDay()-1),k=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0),l=new Date(p.getFullYear(),p.getMonth(),p.getDate(),23,59,59,999);break;case 7:var q=m;q.setDate(m.getDate()-m.getDay());var r=n;r.setDate(n.getDate()-n.getDay()+6),k=new Date(q.getFullYear(),q.getMonth(),q.getDate(),0,0,0,0),l=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999);break;case 9:var t=m;t.setDate(m.getDate()-m.getDay()+7);var u=n;u.setDate(n.getDate()-n.getDay()+13),k=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),l=new Date(u.getFullYear(),u.getMonth(),u.getDate(),23,59,59,999);break;case 5:var v=m;v.setDate(1),v.setMonth(m.getMonth()-1);var w=n;w.setDate(0),k=new Date(v.getFullYear(),v.getMonth(),v.getDate(),0,0,0,0),l=new Date(w.getFullYear(),w.getMonth(),w.getDate(),23,59,59,999);break;case 4:var x=m;x.setDate(1);var y=n;y.setDate(1),y.setMonth(n.getMonth()+1),y.setDate(0),k=new Date(x.getFullYear(),x.getMonth(),x.getDate(),0,0,0,0),l=new Date(y.getFullYear(),y.getMonth(),y.getDate(),23,59,59,999);break;case 6:var z=m;z.setDate(1),z.setMonth(m.getMonth()+1);var A=n;A.setDate(1),A.setMonth(n.getMonth()+2),A.setDate(0),k=new Date(z.getFullYear(),z.getMonth(),z.getDate(),0,0,0,0),l=new Date(A.getFullYear(),A.getMonth(),A.getDate(),23,59,59,999)}if(k!==c&&k!==b&&l!==c&&l!==b){var B=new s(5,k,b),C=new s(3,l,b),D=new j(1,B,C);return D.evaluate(b,0,0,g)}}else if(1===f.expectTypeId){if(i=f.getExpectedInt(b,0,0),i!==c&&i!==b)return f.isEqualsYear(i,g)}else if(2===f.expectTypeId){if(i=f.getExpectedInt(b,0,0),i!==c&&i!==b)return f.isEqualsQuarter(i,g)}else if(3===f.expectTypeId){if(i=f.getExpectedInt(b,0,0),i!==c&&i!==b)return f.isEqualsMonth(i,g)}else if(4===f.expectTypeId){if(i=f.getExpectedInt(b,0,0),i!==c&&i!==b)return f.isEqualsWeek(i,g)}else if(5===f.expectTypeId&&(i=f.getExpectedInt(b,0,0),i!==c&&i!==b))return f.isEqualsDay(i,g);return!1},d.prototype.isEqualsYear=function(a,b){return a===b.getFullYear()},d.prototype.isEqualsQuarter=function(a,b){switch(a){case 0:return b.getMonth()>=1&&b.getMonth()<=3;case 1:return b.getMonth()>=4&&b.getMonth()<=6;case 2:return b.getMonth()>=7&&b.getMonth()<=9;case 3:return b.getMonth()>=10&&b.getMonth()<=12}return!1},d.prototype.isEqualsMonth=function(a,b){return a===b.getMonth()},d.prototype.isEqualsWeek=function(a,b){return a===b.getDay()},d.prototype.isEqualsDay=function(a,b){return a===b.getDate()
},d.prototype.reset=function(){this.expected=b,this.ignoreBlank=!1,this.expectTypeId=0},d.prototype._isDefaultValue=function(a,c){switch(a){case"ignoreBlank":return c===!1;case"formula":return c===b;case"expectTypeId":return 0===c;default:return!1}},d.prototype.toJSON=function(){var a=this,b={ignoreBlank:a.ignoreBlank,formula:a.formula,expected:a.expected,expectTypeId:a.expectTypeId,conType:6},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(a){if(a){var d=this;a.ignoreBlank!==b&&a.ignoreBlank!==c&&(d.ignoreBlank=a.ignoreBlank),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.expected!==b&&a.expected!==c&&(d.expected=a.expected),a.expectTypeId!==b&&a.expectTypeId!==c&&(d.expectTypeId=a.expectTypeId)}},d.fromDay=function(a){var b=new d(a);return b.expectTypeId=5,b},d.fromMonth=function(a){var b=new d(a);return b.expectTypeId=3,b},d.fromQuarter=function(a){var b=new d(a);return b.expectTypeId=2,b},d.fromWeek=function(a){var b=new d(a);return b.expectTypeId=4,b},d.fromYear=function(a){var b=new d(a);return b.expectTypeId=1,b},d}();a.DateExCondition=u;var v=function(){function a(a,b,c){var d=this;d.ignoreBlank=!1,d.conditionType="TextLengthCondition",d.compareType=a,d.expected=b,d.formula="string"==typeof c?$.trim(c).replace("=",""):c}return a.prototype.evaluate=function(a,d,e,f){if(f===c||f===b||""===f)return this.ignoreBlank;var g=f===c||f===b?0:f.length,h=this.getExpectedInt(a,d,e);if("number"==typeof h)switch(this.compareType){case 0:return g===h;case 2:return g>h;case 3:return g>=h;case 4:return h>g;case 5:return h>=g;case 1:return g!==h}return!1},a.prototype.getExpectedInt=function(a,c,d){var e=this.getExpected(a,c,d);return e=parseInt(e,10),isNaN(e)?b:e},a.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},a.prototype.reset=function(){this.expected=b,this.ignoreBlank=!1,this.compareType=0},a.prototype._isDefaultValue=function(a,b){switch(a){case"ignoreBlank":return b===!1;default:return!1}},a.prototype.toJSON=function(){var a=this,b={compareType:a.compareType,expected:a.expected,formula:a.formula,conType:7,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},a.prototype.fromJSON=function(a){if(a){var d=this;a.compareType!==b&&a.compareType!==c&&(d.compareType=a.compareType),a.expected!==b&&a.expected!==c&&(d.expected=a.expected),a.formula!==b&&a.formula!==c&&(d.formula=a.formula),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(d.ignoreBlank=a.ignoreBlank)}},a}();a.TextLengthCondition=v;var w=function(d){function e(a,b,c){d.call(this,c),this.type=a,this.rank=b}return __extends(e,d),e.prototype.createCondition=function(){return new x(this.type,this.rank,this.ranges)},e.prototype.reset=function(){var a=this;a.type=0,a.rank=10,a.style=b,a._stopIfTrue=!1,a._priority=1},e.prototype.toJSON=function(){var a=this,b={ruleType:5,ranges:a.ranges,style:a.style,type:a.type,rank:a.rank,priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.type!==b&&d.type!==c&&(e.type=d.type),d.rank!==b&&d.rank!==c&&(e.rank=d.rank),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.Top10Rule=w;var x=function(){function e(a,c,d){var e=this;e.isPercent=!1,e.ignoreBlank=!1,e.conditionType="Top10Condition",e.formula=b,e.expected=c,e.type=a,e.ranges=d}return e.prototype.adjustOffset=function(){},e.prototype.evaluate=function(a,d,e,f){var g=this;if(f===c||f===b||""===f)return g.ignoreBlank;var h=g.getExpectedInt(a,d,e);if(h!==c&&h!==b){var i=b;if(0===g.type?i=g.getMaxValues(a,h,g.ranges):1===g.type&&(i=g.getMinValues(a,h,g.ranges)),i){var j=0;try{j=g._toDouble(f)}catch(k){return!1}if(i.contains(j))return!0}}return!1},e.prototype.getExpectedInt=function(a,c,d){var e=this.getExpected(a,c,d);return e=parseInt(e,10),isNaN(e)||!isFinite(e)?b:e},e.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},e.prototype.adjustRange=function(b,c){return new a.Range(b.row,b.col,Math.min(b.rowCount,c.getRowCount()),Math.min(b.colCount,c.getColumnCount()))},e.prototype.getMaxValues=function(a,c,e){var f=[];if(!e)return f;for(var g,h,i,j,k,l,m,n=Number.MAX_VALUE,o=0,p=e.length,q=0;p>q;q++){g=e[q],g=this.adjustRange(g,a),h=g.rowCount,i=g.colCount;for(var r=0;h>r;r++){j=r+g.row;for(var s=0;i>s;s++)if(k=s+g.col,l=a.getValue(j,k),m=this._toDouble(l),typeof l!==d&&l!==b&&typeof m!==d&&m!==b)try{if(c>o)f.push(m),n>m&&(n=m),o++;else if(m>n&&(f.remove(n),f.push(m),f.indexOf(n)<0)){n=m;for(var t=0,u=f.length;u>t;t++)f[t]<n&&(n=f[t])}}catch(v){}}}return f},e.prototype.getMinValues=function(a,c,e){var f=[];if(!e)return f;for(var g,h,i,j,k,l,m,n=-Number.MAX_VALUE,o=0,p=e.length,q=0;p>q;q++){g=e[q],g=this.adjustRange(g,a),h=g.rowCount,i=g.colCount;for(var r=0;h>r;r++){j=r+g.row;for(var s=0;i>s;s++)if(k=s+g.col,l=a.getValue(j,k),m=this._toDouble(l),typeof l!==d&&l!==b&&typeof m!==d&&m!==b)try{if(c>o)f.push(m),m>n&&(n=m),o++;else if(n>m&&(f.remove(n),f.push(m),f.indexOf(n)<0)){n=m;for(var t=0,u=f.length;u>t;t++)f[t]>n&&(n=f[t])}}catch(v){}}}return f},e.prototype.reset=function(){var a=this;a.expected=b,a.ignoreBlank=!1,a.type=0,a.isPercent=!1,a.ranges=b},e.prototype._toDouble=function(c){return("number"==typeof c||c instanceof Date)&&a.util.hasCalc()?a.Calc.Convert.toDouble(c):b},e.prototype._isDefaultValue=function(a,c){switch(a){case"formula":return c===b;case"isPercent":return c===!1;case"ignoreBlank":return c===!1;default:return!1}},e.prototype.toJSON=function(){var a=this,b={expected:a.expected,formula:a.formula,type:a.type,isPercent:a.isPercent,ignoreBlank:a.ignoreBlank,ranges:a.ranges,conType:8},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.expected!==b&&d.expected!==c&&(e.expected=d.expected),d.formula!==b&&d.formula!==c&&(e.formula=d.formula),d.type!==b&&d.type!==c&&(e.type=d.type),d.isPercent!==b&&d.isPercent!==c&&(e.isPercent=d.isPercent),d.ignoreBlank!==b&&d.ignoreBlank!==c&&(e.ignoreBlank=d.ignoreBlank),d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}}},e}();a.Top10Condition=x;var y=function(d){function e(a){d.call(this,a)}return __extends(e,d),e.prototype.createCondition=function(){return new A(!1,this.ranges)},e.prototype.toJSON=function(){var a=this,b={ruleType:6,ranges:a.ranges,style:a.style,priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.UniqueRule=y;var z=function(d){function e(a){d.call(this,a)}return __extends(e,d),e.prototype.createCondition=function(){return new A(!0,this.ranges)},e.prototype.toJSON=function(){var a=this,b={ruleType:7,ranges:a.ranges,style:a.style,priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.DuplicateRule=z;var A=function(){function d(a,c){var d=this;d.conditionType="UniqueCondition",d.ignoreBlank=!1,d.formula=b,d.expected=a,d.ranges=c}return d.prototype.adjustOffset=function(){},d.prototype.evaluate=function(d,e,f,g){var h=this,i=g;if(i===c||i===b||""===i)return h.ignoreBlank;if(a.util.hasCalc()){var j=a.Calc.Convert;j.isNumber(i)&&(i=j.toDouble(i))}var k=h.getExpectedBoolean(d,e,f);if(k!==c&&k!==b){var l=h.getDuplicated(d,h.ranges);return l!==c&&l!==b&&l.contains(i)?k===!0:k!==!0}return!1},d.prototype.getExpectedBoolean=function(c,d,e){var f=this.getExpected(c,d,e);try{return a.Calc.Convert.toBool(f)}catch(g){return b}},d.prototype.getExpected=function(a,b,c){var d=this;if(d.formula&&d.formula.length>0){var e=a.getCalcService();if(!e)return d.expected;var f=e.parse(d.formula,b,c);return e.evaluateParsedFormula(a._getSheetSource(),f,b,c)}return d.expected},d.prototype.adjustRange=function(b,c){return new a.Range(b.row,b.col,Math.min(b.rowCount,c.getRowCount()),Math.min(b.colCount,c.getColumnCount()))},d.prototype.getDuplicated=function(d,e){var f=[],g=[];if(e)for(var h=e.length,i=0;h>i;i++){var j=e[i];j=this.adjustRange(j,d);for(var k=0;k<j.rowCount;k++)for(var l=k+j.row,m=0;m<j.colCount;m++){var n=m+j.col,o=d.getValue(l,n,3);if(o!==c&&o!==b){if(a.util.hasCalc()){var p=a.Calc.Convert;p.isNumber(o)&&(o=p.toDouble(o))}this._containsKey(f,o)?g.contains(o)||g.push(o):f.push({key:o,value:!1})}}}return g},d.prototype._containsKey=function(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d].key===b)return!0;return!1},d.prototype.reset=function(){this.expected=b,this.ignoreBlank=!1,this.ranges=b},d.prototype._isDefaultValue=function(a,c){switch(a){case"formula":return c===b;case"ignoreBlank":return c===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={expected:a.expected,formula:a.formula,ranges:a.ranges,conType:9,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(d){if(d){var e=this;if(d.expected!==b&&d.expected!==c&&(e.expected=d.expected),d.formula!==b&&d.formula!==c&&(e.formula=d.formula),d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.ignoreBlank!==b&&d.ignoreBlank!==c&&(e.ignoreBlank=d.ignoreBlank)}},d}();a.UniqueCondition=A;var B=function(d){function e(a,b){d.call(this,b),this.type=a}return __extends(e,d),e.prototype.createCondition=function(){return new C(this.type,this.ranges)},e.prototype.reset=function(){var a=this;a.type=0,a.style=b,a._stopIfTrue=!1,a._priority=1},e.prototype.toJSON=function(){var a=this,b={ruleType:8,ranges:a.ranges,style:a.style,type:a.type,priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.style&&(e.style=new a.Style,e.style.copyFrom(d.style)),d.type!==b&&d.type!==c&&(e.type=d.type),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.stopIfTrue!==c&&(e._stopIfTrue=d.stopIfTrue)}},e}(i);a.AverageRule=B;var C=function(){function d(a,c){var d=this;d.conditionType="AverageCondition",d.ignoreBlank=!1,d._expr=b,d._stdevExpr=b,d.type=a,d.ranges=c}return d.prototype.adjustOffset=function(){},d.prototype.evaluate=function(d,e,f,g){if(!a.util.hasCalc())return!1;var h=this;if(h.ignoreBlank&&(g===c||g===b||""===g))return!0;var i=a.Calc.Convert,j=i.toDouble;h._rebuildFormula();var k=h.getExpectedDouble(d,e,f),l=b,m=h._stdevExpr?h._getExpectedByExpression(d,h._stdevExpr,e,f):b;if(m!==c&&m!==b)try{l=j(m)}catch(n){l=0/0}if(i.isNumber(g)){var o=j(g);if(!isNaN(k))switch(h.type){case 0:return o>k;case 1:return k>o;case 2:return o>=k;case 3:return k>=o;case 4:return isNaN(l)?!1:o>k+l;case 5:return isNaN(l)?!1:k-l>o;case 6:return isNaN(l)?!1:o>k+2*l;case 7:return isNaN(l)?!1:k-2*l>o;case 8:return isNaN(l)?!1:o>k+3*l;case 9:return isNaN(l)?!1:k-3*l>o}}return!1},d.prototype._rebuildFormula=function(){var a=this;a.ranges&&(a._expr=a._createExpression("AVERAGE",a.ranges),(4===a.type||5===a.type||6===a.type||7===a.type||8===a.type||9===a.type)&&(a._stdevExpr=a._createExpression("STDEV",a.ranges)))},d.prototype._createExpression=function(c,d){if(!a.util.hasCalc())return b;var e=a.Calc.Expressions,f=a.Calc.Functions,g=a.Calc.Convert,h=f.findGlobalFunction(c);if(h){for(var i=[],j=d.length,k=0;j>k;k++){var l=d[k];if(l instanceof e.Expression)i[k]=l;else if(l instanceof a.Range)i[k]=new e.RangeExpression(l.row,l.col,l.row+l.rowCount-1,l.col+l.colCount-1);else{if(!g.isNumber(l)||isNaN(l=g.toDouble(l)))throw a.SR.Exp_NotSupport;i[k]=new e.DoubleExpression(l,l.toString())}}return new e.FunctionExpression(h,i)}return b},d.prototype.getExpectedDouble=function(b,c,d){var e=this.getExpected(b,c,d);try{return a.Calc.Convert.toDouble(e)}catch(f){return 0/0}},d.prototype.getExpected=function(a,c,d){var e=a.getCalcService();if(!e)return b;var f=e.unparse(this._expr,c,d);return this._expr=e.parse(f,c,d),e.evaluateParsedFormula(a._getSheetSource(),this._expr,c,d)},d.prototype._getExpectedByExpression=function(a,c,d,e){var f=a.getCalcService();if(!f)return b;var g=f.unparse(c,d,e);return c=f.parse(g,d,e),f.evaluateParsedFormula(a._getSheetSource(),c,d,e)},d.prototype.reset=function(){var a=this;a.ignoreBlank=!1,a.type=0,a.ranges=b,a._expr=b,a._stdevExpr=b},d.prototype._isDefaultValue=function(a,b){switch(a){case"ignoreBlank":return b===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={type:a.type,ranges:a.ranges,conType:10,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(d){if(d){var e=this;if(d.type!==b&&d.type!==c&&(e.type=d.type),d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.ignoreBlank!==b&&d.ignoreBlank!==c&&(e.ignoreBlank=d.ignoreBlank)}},d}();a.AverageCondition=C;var D=function(){function a(a,b){this.type=a,this.value=b}return a}();a.ScaleValue=D;var E=function(e){function f(a,c,d){e.call(this,b);var f=this;f.expected=[],f.lowestValueCached=b,f.highestValueCached=b,f.cached=!1,f._oldRanges=b,f.scales=[a,c,d]}return __extends(f,e),f.prototype.stopIfTrue=function(){return this._stopIfTrue},f.prototype.isScaleRule=function(){return!0},f.prototype.createCondition=function(){return b},f.prototype._calculateLowestValueEx=function(a){var c=(new x).getMinValues(a,1,this.ranges);return c.length>0?c[0]:b},f.prototype._calculateHighestValueEx=function(a){var c=(new x).getMaxValues(a,1,this.ranges);return c.length>0?c[0]:b},f.prototype._cloneRanges=function(b){for(var c,d=[],e=b.length,f=0;e>f;f++)c=b[f],d.push(new a.Range(c.row,c.col,c.rowCount,c.colCount));return d},f.prototype._rangesChanged=function(){var a=this._oldRanges,b=this.ranges;if(!a)return!1;var c=a.length,d=b.length;if(c!==d)return!0;for(var e=0;d>e;e++)if(!a[e].equals(b[e]))return!0;return!1},f.prototype._tryCache=function(a){var b=this;b._rangesChanged()&&(b._clearCache(),b._oldRanges=b._cloneRanges(b.ranges)),b.cached===!1&&(b.lowestValueCached=b._calculateLowestValueEx(a),b.highestValueCached=b._calculateHighestValueEx(a),b.cached=!0)},f.prototype._clearCache=function(){this.lowestValueCached=b,this.highestValueCached=b,this.cached=!1},f.prototype._calculateFormula=function(a,c,d,e){if(e&&e.length>0){var f=a.getCalcService();if(!f)return b;var g=f.parse(e,c,d);return f.evaluateParsedFormula(a._getSheetSource(),g,c,d)}return b},f.prototype._isFormula=function(a){return a&&"="===a[0]},f.prototype._trimFormula=function(a){return a===c||a===b||""===a?b:"="===a[0]?a.substr(1):a},f.prototype._calculateValue=function(c,d,e,f){var g=b;if(this._isFormula(f))g=this._calculateFormula(c,d,e,this._trimFormula(f.toString()));else try{g=a.Calc.Convert.toDouble(f)}catch(h){g=0/0}return g},f.prototype._getHighestValue=function(a){return this._tryCache(a),this.highestValueCached},f.prototype._getLowestValue=function(a){return this._tryCache(a),this.lowestValueCached},f.prototype._calculatePercent=function(a,c,e,f){var g=this._calculateValue(a,c,e,f);if(!isNaN(g)&&g>=0&&100>=g){var h=this._getLowestValue(a),i=this._getHighestValue(a);if(typeof h!==d&&h!==b&&typeof i!==d&&i!==b)return h+(i-h)*g/100}return b},f.prototype._calculatePercentile=function(c,d,e,f){var g=this._calculateValue(c,d,e,f);if(!isNaN(g)&&g>=0&&100>=g){for(var h=0,i=this.ranges,j=i.length,k=0;j>k;k++){var l=this._createExpression("PERCENTILE",[i[k],g/100]),m=c.getCalcService(),n=m.unparse(l,d,e),l=m.parse(n,d,e),o=m.evaluateParsedFormula(c._getSheetSource(),l,d,e);try{h+=a.Calc.Convert.toDouble(o)}catch(p){}}return h/j}return b},f.prototype._getActualValue=function(a,c,d,e){var f=this,g=f.scales[e];if(g)switch(g.type){case 6:return f._calculateValue(a,c,d,g.value);case 2:return f._getHighestValue(a);case 1:return f._getLowestValue(a);case 0:return f._calculateValue(a,c,d,g.value);case 3:return f._calculatePercent(a,c,d,g.value);case 4:return f._calculatePercentile(a,c,d,g.value);case 7:var h=f._getHighestValue(a);return 0>h?0:h;case 5:var i=f._getLowestValue(a);return i>0?0:i}return b},f.prototype._evaluate2Scale=function(a,b,c){return b>=a?0:a>=c?1:(a-b)/(c-b)},f.prototype.evaluate=function(d,e,f,g){var h=this;if(h._tryCache(d),h.contains(e,f)){if(g===c||g===b)return b;try{var i=a.Calc.Convert.toDouble(g),j=h._getActualValue(d,e,f,0),k=h._getActualValue(d,e,f,1),l=h._getActualValue(d,e,f,2);if(isNaN(k)){if(!isNaN(j)&&!isNaN(l))return j>l?b:h._evaluate2Scale(i,j,l)}else if(!isNaN(j)&&!isNaN(l)&&!isNaN(k)){if(j>l)return b;if(j>i)return 0;if(i>=l)return 2;{h._evaluate2Scale(k,j,l)}return i>=j&&k>=i?h._evaluate2Scale(i,j,k):1+h._evaluate2Scale(i,j,l)}}catch(m){return b}}return b},f.prototype._evaluateColor=function(c,d,e){if(c>=0&&1>=c){var f=a._Color.parse(d),g=a._Color.parse(e),h=f.a*(1-c)+g.a*c,i=f.r*(1-c)+g.r*c,j=f.g*(1-c)+g.g*c,k=f.b*(1-c)+g.b*c;return new a._Color(parseFloat(h/255),parseInt(i,10),parseInt(j,10),parseInt(k,10)).toString()}return b},f.prototype._createExpression=function(c,d){if(!a.util.hasCalc())return b;var e=a.Calc.Expressions,f=a.Calc.Functions,g=a.Calc.Convert,h=f.findGlobalFunction(c);if(h){for(var i=[],j=d.length,k=0;j>k;k++){var l=d[k];if(l instanceof e.Expression)i[k]=l;else if(l instanceof a.Range)i[k]=new e.RangeExpression(l.row,l.col,l.row+l.rowCount-1,l.col+l.colCount-1);else{if(!g.isNumber(l)||isNaN(l=g.toDouble(l)))throw a.SR.Exp_NotSupport;i[k]=new e.DoubleExpression(l,l.toString())}}return new e.FunctionExpression(h,i)}return b},f.prototype._addRows=function(a,b){e.prototype._addRows.call(this,a,b),this._clearCache()},f.prototype._addColumns=function(a,b){e.prototype._addColumns.call(this,a,b),this._clearCache()},f.prototype._removeRows=function(a,b){e.prototype._removeRows.call(this,a,b),this._clearCache()},f.prototype._removeColumns=function(a,b){e.prototype._removeColumns.call(this,a,b),this._clearCache()},f}(i);a.ScaleRule=E;var F=function(d){function e(c,e,f,g,h,i){var j=c,k=e,l=f,m=g,n=h,o=i;0===arguments.length&&(j=1,k=b,l=new a._Color(0,255,255,255).toString(),m=2,n=b,o=new a._Color(255,99,190,123).toString());var p=new D(j,k),q=new D(m,n);d.call(this,p,b,q),this.expected[0]=l,this.expected[2]=o}return __extends(e,d),e.prototype.evaluate=function(d,e,f,g){if(g!==c&&g!==b){var h=0/0;try{a.Calc.Convert.isNumber(g)&&(h=a.Calc.Convert.toDouble(g))}catch(i){return b}if(isNaN(h))return b;var j=this,k=j._getActualValue(d,e,f,0),l=j._getActualValue(d,e,f,2);if(k!==c&&k!==b&&l!==c&&l!==b){var m=j._evaluate2Scale(h,k,l);return j._evaluateColor(m,j.expected[0],j.expected[2])}}return b},e.prototype._init=function(){var c=this;c.scales=new Array(3),c.scales[0]=new D(1,b),c.scales[2]=new D(2,b),c.expected=new Array(3),c.expected[0]=new a._Color(0,255,255,255).toString(),c.expected[2]=new a._Color(255,99,190,123).toString()},e.prototype.reset=function(){var a=this;a.ranges=b,a.condition=b,a.style=b,a._stopIfTrue=!1,a._priority=1,a._init()},e.prototype.getMinimumType=function(){var a=this.scales;return a&&3===a.length?a[0].type:b},e.prototype.setMinimumType=function(a){var b=this.scales;b&&3===b.length&&(b[0].type=a)},e.prototype.getMinimumValue=function(){var a=this.scales;return a&&3===a.length?a[0].value:b},e.prototype.setMinimumValue=function(a){var b=this.scales;b&&3===b.length&&(b[0].value=a)},e.prototype.getMinimumColor=function(){return this.expected&&3===this.expected.length?this.expected[0]:b},e.prototype.setMinimumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[0]=a)},e.prototype.getMaximumType=function(){var a=this.scales;return a&&3===a.length?a[2].type:b},e.prototype.setMaximumType=function(a){var b=this.scales;b&&3===b.length&&(b[2].type=a)},e.prototype.getMaximumValue=function(){var a=this.scales;return a&&3===a.length?a[2].value:b},e.prototype.setMaximumValue=function(a){var b=this.scales;b&&3===b.length&&(b[2].value=a)},e.prototype.getMaximumColor=function(){return this.expected&&3===this.expected.length?this.expected[2]:b},e.prototype.setMaximumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[2]=a)},e.prototype._isDefaultValue=function(a,c){switch(a){case"ranges":return c===b;case"priority":return 1===c;case"stopIfTrue":return c===!1;default:return!1}},e.prototype.toJSON=function(){var a=this,b={ruleType:10,ranges:a.ranges,minType:a.getMinimumType(),minValue:a.getMinimumValue(),minColor:a.getMinimumColor(),maxType:a.getMaximumType(),maxValue:a.getMaximumValue(),maxColor:a.getMaximumColor(),priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.minType!==b&&d.minType!==c&&e.setMinimumType(d.minType),d.minValue!==b&&d.minValue!==c&&e.setMinimumValue(d.minValue),d.minColor!==b&&d.minColor!==c&&e.setMinimumColor(d.minColor),d.maxType!==b&&d.maxType!==c&&e.setMaximumType(d.maxType),d.maxValue!==b&&d.maxValue!==c&&e.setMaximumValue(d.maxValue),d.maxColor!==b&&d.maxColor!==c&&e.setMaximumColor(d.maxColor),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.priority!==c&&(e._stopIfTrue=!1)}},e}(E);a.TwoScaleRule=F;var G=function(d){function e(c,e,f,g,h,i,j,k,l){var m=c,n=e,o=f,p=g,q=h,r=i,s=j,t=k,u=l;0===arguments.length&&(m=1,n=b,o=new a._Color(255,248,105,107).toString(),p=4,q=50,r=new a._Color(255,255,235,132).toString(),s=2,t=b,u=new a._Color(255,99,190,123).toString()),d.call(this,new D(m,n),new D(p,q),new D(s,t)),this.expected[0]=o,this.expected[1]=r,this.expected[2]=u}return __extends(e,d),e.prototype.evaluate=function(d,e,f,g){var h=this;if(h._evaluator=d,g!==c&&g!==b){var i=0/0;try{a.Calc.Convert.isNumber(g)&&(i=a.Calc.Convert.toDouble(g))}catch(j){return b}if(isNaN(i))return b;var k=h._getActualValue(d,e,f,0),l=h._getActualValue(d,e,f,1),m=h._getActualValue(d,e,f,2);if(k!==c&&k!==b&&m!==c||m!==b&&l!==c&&l!==b){if(k>m)return b;if(k>i)return h.expected[0];if(i>=m)return h.expected[2];var n;return i>=k&&l>=i?(n=h._evaluate2Scale(i,k,l),h._evaluateColor(n,h.expected[0],h.expected[1])):(n=h._evaluate2Scale(i,l,m),h._evaluateColor(n,h.expected[1],h.expected[2]))}}return b},e.prototype._init=function(){var c=this;c.scales=new Array(3),c.scales[0]=new D(1,b),c.scales[1]=new D(4,50),c.scales[2]=new D(2,b),c.expected=new Array(3),c.expected[0]=new a._Color(255,248,105,107).toString(),c.expected[1]=new a._Color(255,255,235,132).toString(),c.expected[2]=new a._Color(255,99,190,123).toString()},e.prototype.reset=function(){var a=this;a.ranges=b,a.condition=b,a.style=b,a._init(),a._evaluator=b,a._stopIfTrue=!1,a._priority=1},e.prototype.getMinimumType=function(){var a=this.scales;return a&&3===a.length?a[0].type:b},e.prototype.setMinimumType=function(a){var b=this.scales;b&&3===b.length&&(b[0].type=a)},e.prototype.getMinimumValue=function(){var a=this.scales;return a&&3===a.length?a[0].value:b},e.prototype.setMinimumValue=function(a){var b=this.scales;b&&3===b.length&&(b[0].value=a)},e.prototype.getMinimumColor=function(){return this.expected&&3===this.expected.length?this.expected[0]:b},e.prototype.setMinimumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[0]=a)},e.prototype.getMidpointType=function(){var a=this.scales;return a&&3===a.length?a[1].type:b},e.prototype.setMidpointType=function(a){var b=this.scales;b&&3===b.length&&(b[1].type=a)},e.prototype.getMidpointValue=function(){var a=this,c=a.scales;if(c&&3===c.length){if(a._evaluator){if(2===c[1].type)return a._getHighestValue(a._evaluator);if(1===c[1].type)return a._getLowestValue(a._evaluator)}return c[1].value}return b},e.prototype.setMidpointValue=function(a){var b=this.scales;b&&3===b.length&&(b[1].value=a)},e.prototype.getMidpointColor=function(){return this.expected&&3===this.expected.length?this.expected[1]:b},e.prototype.setMidpointColor=function(a){this.expected&&3===this.expected.length&&(this.expected[1]=a)},e.prototype.getMaximumType=function(){var a=this.scales;return a&&3===a.length?a[2].type:b},e.prototype.setMaximumType=function(a){var b=this.scales;b&&3===b.length&&(b[2].type=a)},e.prototype.getMaximumValue=function(){var a=this.scales;return a&&3===a.length?a[2].value:b},e.prototype.setMaximumValue=function(a){var b=this.scales;b&&3===b.length&&(b[2].value=a)},e.prototype.getMaximumColor=function(){return this.expected&&3===this.expected.length?this.expected[2]:b},e.prototype.setMaximumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[2]=a)},e.prototype._isDefaultValue=function(a,c){switch(a){case"ranges":return c===b;case"priority":return 1===c;case"stopIfTrue":return c===!1;default:return!1}},e.prototype.toJSON=function(){var a=this,b={ruleType:11,ranges:a.ranges,minType:a.getMinimumType(),minValue:a.getMinimumValue(),minColor:a.getMinimumColor(),midType:a.getMidpointType(),midValue:a.getMidpointValue(),midColor:a.getMidpointColor(),maxType:a.getMaximumType(),maxValue:a.getMaximumValue(),maxColor:a.getMaximumColor(),priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.minType!==b&&d.minType!==c&&e.setMinimumType(d.minType),d.minValue!==b&&d.minValue!==c&&e.setMinimumValue(d.minValue),d.minColor!==b&&d.minColor!==c&&e.setMinimumColor(d.minColor),d.midType!==b&&d.midType!==c&&e.setMidpointType(d.midType),d.midValue!==b&&d.midValue!==c&&e.setMidpointValue(d.midValue),d.midColor!==b&&d.midColor!==c&&e.setMidpointColor(d.midColor),d.maxType!==b&&d.maxType!==c&&e.setMaximumType(d.maxType),d.maxValue!==b&&d.maxValue!==c&&e.setMaximumValue(d.maxValue),d.maxColor!==b&&d.maxColor!==c&&e.setMaximumColor(d.maxColor),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.priority!==c&&(e._stopIfTrue=!1)}},e}(E);a.ThreeScaleRule=G;var H=function(d){function e(c,e,f,g,h){var i=c,j=e,k=f,l=g,m=h;0===arguments.length&&(i=5,j=b,k=7,l=b,m=new a._Color(255,99,142,198).toString());var n=new D(i,j),o=new D(k,l);d.call(this,n,b,o),this._init(m)}return __extends(e,d),e.prototype._init=function(a){var b=this;b._gradient=!0,b._color=a,b._showBorder=!1,b._borderColor="black",b._dataBarDirection=0,b._negativeFillColor="red",b._useNegativeFillColor=!0,b._negativeBorderColor="black",b._useNegativeBorderColor=!1,b._axisPosition=0,b._axisColor="black",b._showBarOnly=!1},e.prototype.reset=function(){var c=this;c.ranges=b,c.condition=b,c.style=b,c._init(new a._Color(255,99,142,198).toString()),c._stopIfTrue=!1,c._priority=1,c.scales=[],c.scales[0]=new D(5,b),c.scales[2]=new D(7,b),c.expected=[]},e.prototype._calcuteMinValue=function(a,c,d,e,f){var g=this,h=g.scales[e],i=b;if(h){if(6!==h.type&&4!==h.type)return g._getActualValue(a,c,d,0,f);for(var j=0;j<g.ranges.length;j++)if(g.ranges[j].intersect(c,-1,1,-1)){i=g.ranges[j];break}if(i)return g._getActualValue(a,i.row,i.col,0,f)}return b},e.prototype._calcuteMaxValue=function(a,c,d,e,f){var g=this,h=g.scales[e],i=b;if(h){if(6!==h.type&&4!==h.type)return g._getActualValue(a,c,d,2,f);for(var j=0;j<g.ranges.length;j++)if(g.ranges[j].intersect(c,-1,1,-1)){i=g.ranges[j];break}if(i)return g._getActualValue(a,i.row,i.col,2,f)}return b},e.prototype._evaluateNoneScale=function(a,b,c,d){return d=0,c===b?b>a?[0,d]:a>c?[1,d]:[.5,d]:a>=c?[1,d]:b>=a?[0,d]:[(a-b)/(c-b),d]},e.prototype._evaluateMidScale=function(a,b,c,d){d=.5;var e=g(c-b);if(c>0&&b>=0)return c===b?[.5,d]:a>=c?[.5,d]:b>=a?[b/c*.5,d]:[.5*g(a/c),d];if(c>0&&0>b){var f=c>g(b)?.5:c/e,h=c>g(b)?b/e:-.5;return a>0?a>=c?[f,d]:[a/c*f,d]:0>a?b>=a?[h,d]:[a/b*h,d]:[0,d]}return 0>=c&&0>b?c===b?[-.5,d]:a>=c?[-c/b*.5,d]:b>=a?[-.5,d]:[-a/b*.5,d]:0===c&&0===b?[0,d]:(d=-1,[-1,d])},e.prototype._evaluateAutoScale=function(a,b,c,d){var e=g(c-b);return c>0&&b>=0?(d=0,b===c?b>a?[0,d]:a>c?[1,d]:[.5,d]:b>=a?[0,d]:a>=c?[1,d]:[(a-b)/e,d]):c>0&&0>b?(d=g(b)/e,a>=c?[1-d,d]:b>=a?[-d,d]:0===a?[0,d]:[(a-0)/e,d]):0>=c&&0>b?(d=1,c===b?b>a?[-1,d]:a>c?[0,d]:[-.5,d]:a>=c?[-0,d]:b>=a?[-1,d]:[(a-c)/e,d]):0===c&&0===b?(d=.5,a>0?[.5,d]:0>a?[-.5,d]:[0,d]):(d=-1,[-1,d])},e.prototype._evaluateScale=function(a,b,c,d){var e=this;return 0===e._axisPosition?e._evaluateAutoScale(a,b,c,d):1===e._axisPosition?e._evaluateMidScale(a,b,c,d):e._evaluateNoneScale(a,b,c,d)},e.prototype._paintDataBar=function(b,c,d,e,f,i){var j=new a.Rect(d+2,e+2,f-4,i-4),k=j.x,l=j.y,m=h(g(j.width*c.scale)),n=j.height;if(0===c.axisLocation)c.scale<=0&&(m=0);else if(1===c.axisLocation)c.scale<0?k=k+j.width-m:m=0;else{var o=h(j.width*c.axisLocation+k)+.5,p=j.y,q=1,r=i-1;b.lineWidth=q,b.strokeStyle=c.axisColor,b.beginPath();for(var s=0;r>=s;s+=2)1===c.direction?(b.moveTo(2*d+f-o,p+s),b.lineTo(2*d+f-o,p+s+1)):(b.moveTo(o,p+s),b.lineTo(o,p+s+1));b.stroke(),c.scale>0?k=o+q:c.scale<0?k=o-m:m=0}if(c.showBorder&&(k=h(k)+.5,m-=1,l+=.5,n-=1),m>=0&&n>=0){var t=c.fillColor;if(c.isGradient){var u=.9;t=1===c.direction?b.createLinearGradient(2*d+f-k-m,l,2*d+f-k,l+n):b.createLinearGradient(k,l,k+m,l+n);var v=a._Color.parse(c.fillColor),w=new a._Color(v.a,h(255*u+v.r*(1-u)),h(255*u+v.g*(1-u)),h(255*u+v.b*(1-u))).toString(),x=c.scale<0?1-u:u,y=c.fillColor,z=c.scale<0?1:0;1===c.direction?(t.addColorStop(x,y),t.addColorStop(z,w)):(t.addColorStop(x,w),t.addColorStop(z,y))}b.fillStyle!==t&&(b.fillStyle=t),1===c.direction?b.fillRect(2*d+f-k-m,l,m,n):b.fillRect(k,l,m,n),c.showBorder&&m>0&&n>0&&(b.strokeStyle=c.borderColor,1===c.direction?b.strokeRect(2*d+f-k-m,l,m,n):b.strokeRect(k,l,m,n))}},e.prototype.evaluate=function(d,e,f,g){var h=g;if(h!==b&&h!==c){var i=0/0;try{a.Calc.Convert.isNumber(h)&&(i=a.Calc.Convert.toDouble(h))}catch(j){return b}if(isNaN(i))return b;var k=this,l=k._calcuteMinValue(d,e,f,0,g),m=k._calcuteMaxValue(d,e,f,2,g);if(l instanceof Date&&(l=new a._DateTimeHelper(l).toOADate()),m instanceof Date&&(m=new a._DateTimeHelper(m).toOADate()),l!==b&&l!==c&&m!==b&&m!==c){if(l>m){var n=m;m=l,l=n}var o,p=k._evaluateScale(i,l,m,o);if(!p||p.length<2)return b;var q=p[0];o=p[1];var r=0>i&&k._useNegativeFillColor?k._negativeFillColor:k._color,s=0>i&&k._useNegativeBorderColor?k._negativeBorderColor:k._borderColor;return{fillColor:r,borderColor:s,showBorder:k._showBorder,axisColor:k._axisColor,isGradient:k._gradient,direction:k._dataBarDirection,axisLocation:o,scale:q,showBarOnly:k._showBarOnly}
}}return b},e.prototype.minimumType=function(a){var c=this,d=c.scales;return 0===arguments.length?d&&3===d.length?d[0].type:b:(d&&3===d.length&&(d[0].type=a),c)},e.prototype.minimumValue=function(a){var c=this,d=c.scales;return 0===arguments.length?d&&3===d.length?d[0].value:b:(d&&3===d.length&&(d[0].value=a),c)},e.prototype.maximumType=function(a){var c=this,d=c.scales;return 0===arguments.length?d&&3===d.length?d[2].type:b:(d&&3===d.length&&(d[2].type=a),c)},e.prototype.maximumValue=function(a){var c=this,d=c.scales;return 0===arguments.length?d&&3===d.length?d[2].value:b:(d&&3===d.length&&(d[2].value=a),c)},e.prototype.gradient=function(a){return 0===arguments.length?this._gradient:(this._gradient=a,this)},e.prototype.color=function(a){return 0===arguments.length?this._color:(this._color=a,this)},e.prototype.showBorder=function(a){return 0===arguments.length?this._showBorder:(this._showBorder=a,this)},e.prototype.borderColor=function(a){return 0===arguments.length?this._borderColor:(this._borderColor=a,this)},e.prototype.dataBarDirection=function(a){return 0===arguments.length?this._dataBarDirection:(this._dataBarDirection=a,this)},e.prototype.negativeFillColor=function(a){return 0===arguments.length?this._negativeFillColor:(this._negativeFillColor=a,this)},e.prototype.useNegativeFillColor=function(a){return 0===arguments.length?this._useNegativeFillColor:(this._useNegativeFillColor=a,this)},e.prototype.negativeBorderColor=function(a){return 0===arguments.length?this._negativeBorderColor:(this._negativeBorderColor=a,this)},e.prototype.useNegativeBorderColor=function(a){return 0===arguments.length?this._useNegativeBorderColor:(this._useNegativeBorderColor=a,this)},e.prototype.axisPosition=function(a){return 0===arguments.length?this._axisPosition:(this._axisPosition=a,this)},e.prototype.axisColor=function(a){return 0===arguments.length?this._axisColor:(this._axisColor=a,this)},e.prototype.showBarOnly=function(a){return 0===arguments.length?this._showBarOnly:(this._showBarOnly=a,this)},e.prototype._isDefaultValue=function(a,c){switch(a){case"ranges":return c===b;case"gradient":return c===!0;case"showBorder":return c===!1;case"borderColor":return"black"===c;case"dataBarDirection":return 0===c;case"negativeFillColor":return"red"===c;case"useNegativeFillColor":return c===!0;case"negativeBorderColor":return"black"===c;case"useNegativeBorderColor":return c===!1;case"axisPosition":return 0===c;case"axisColor":return"black"===c;case"showBarOnly":return c===!1;case"priority":return 1===c;case"stopIfTrue":return c===!1}},e.prototype.toJSON=function(){var a=this,b={ruleType:12,ranges:a.ranges,minType:a.minimumType(),minValue:a.minimumValue(),maxType:a.maximumType(),maxValue:a.maximumValue(),gradient:a.gradient(),color:a.color(),showBorder:a.showBorder(),borderColor:a.borderColor(),dataBarDirection:a.dataBarDirection(),negativeFillColor:a.negativeFillColor(),useNegativeFillColor:a.useNegativeFillColor(),negativeBorderColor:a.negativeBorderColor(),useNegativeBorderColor:a.useNegativeBorderColor(),axisPosition:a.axisPosition(),axisColor:a.axisColor(),showBarOnly:a.showBarOnly(),priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}d.minType!==b&&d.minType!==c&&e.minimumType(d.minType),d.minValue!==b&&d.minValue!==c&&e.minimumValue(d.minValue),d.maxType!==b&&d.maxType!==c&&e.maximumType(d.maxType),d.maxValue!==b&&d.maxValue!==c&&e.maximumValue(d.maxValue),d.gradient!==b&&d.gradient!==c&&e.gradient(d.gradient),d.color!==b&&d.color!==c&&e.color(d.color),d.showBorder!==b&&d.showBorder!==c&&e.showBorder(d.showBorder),d.borderColor!==b&&d.borderColor!==c&&e.borderColor(d.borderColor),d.dataBarDirection!==b&&d.dataBarDirection!==c&&e.dataBarDirection(d.dataBarDirection),d.negativeFillColor!==b&&d.negativeFillColor!==c&&e.negativeFillColor(d.negativeFillColor),d.useNegativeFillColor!==b&&d.useNegativeFillColor!==c&&e.useNegativeFillColor(d.useNegativeFillColor),d.negativeBorderColor!==b&&d.negativeBorderColor!==c&&e.negativeBorderColor(d.negativeBorderColor),d.useNegativeBorderColor!==b&&d.useNegativeBorderColor!==c&&e.useNegativeBorderColor(d.useNegativeBorderColor),d.axisPosition!==b&&d.axisPosition!==c&&e.axisPosition(d.axisPosition),d.axisColor!==b&&d.axisColor!==c&&e.axisColor(d.axisColor),d.showBarOnly!==b&&d.showBarOnly!==c&&e.showBarOnly(d.showBarOnly),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.priority!==c&&(e._stopIfTrue=!1)}},e}(E);a.DataBarRule=H;var I=function(){function a(a,b,c){this.isGreaterThanOrEqualTo=a,this.iconValueType=b,this.iconValue=c}return a}();a.IconCriterion=I;var J=function(e){function f(a){var c=a;0===arguments.length&&(c=0),e.call(this,b,b,b),this._init(c)}return __extends(f,e),f.prototype._initIconSetType=function(a){var b=this;b._iconSetType=a,b._iconSetType>=0&&b._iconSetType<=9?(b._iconCriteria=new Array(2),b._iconCriteria[0]=new I(!0,4,33),b._iconCriteria[1]=new I(!0,4,67)):b._iconSetType>=10&&b._iconSetType<=14?(b._iconCriteria=new Array(3),b._iconCriteria[0]=new I(!0,4,25),b._iconCriteria[1]=new I(!0,4,50),b._iconCriteria[2]=new I(!0,4,75)):b._iconSetType>=15&&b._iconSetType<=19?(b._iconCriteria=new Array(4),b._iconCriteria[0]=new I(!0,4,20),b._iconCriteria[1]=new I(!0,4,40),b._iconCriteria[2]=new I(!0,4,60),b._iconCriteria[3]=new I(!0,4,80)):b._iconSetType>19&&(b._iconCriteria=new Array)},f.prototype._init=function(a){this._showIconOnly=!1,this._reverseIconOrder=!1,this._initIconSetType(a)},f.prototype._modifyIconIndex=function(a){var b=this._iconCriteria.length+1;return this._reverseIconOrder&&b>2?b-1-a:a},f.prototype._getActualValue=function(a,c,d,e){var f=this,g=f._iconCriteria[e];if(g)switch(g.iconValueType){case 7:return f._calculateValue(a,c,d,g.iconValue);case 1:return f._calculateValue(a,c,d,g.iconValue);case 4:return f._calculatePercent(a,c,d,g.iconValue);case 5:return f._calculatePercentile(a,c,d,g.iconValue)}return b},f.prototype._paintIconSet=function(a,b,c,d,e,g,h,i){var j=c+1,k=d+2,l=16,m=16;b.showIconOnly&&(1==h.hAlign?j=c+e/2-l/2:2==h.hAlign&&(j=c+e-l-2)),1==h.vAlign?k=d+g/2-m/2:2==h.vAlign&&(k=d+g-m-2);var n=f.getIcon(b.iconSetType,b.iconIndex);try{n&&i&&("string"===$.type(n)?i.getState(n)?a.drawImage(i.getImage(n),j,k,l,m):i.addImage(n):i.getState(n.image)?a.drawImage(i.getImage(n.image),n.x,n.y,n.w,n.h,j,k,l,m):i.addImage(n.image))}catch(o){}},f.prototype.evaluate=function(e,f,g,h){var i=this,j=h;if(j===b||j===c)return b;var k=0/0;try{a.Calc.Convert.isNumber(j)&&(k=a.Calc.Convert.toDouble(j))}catch(l){return b}if(isNaN(k))return b;var m=0,n=i._iconSetType,o=i._iconCriteria;if(n>=0&&9>=n?m=3:n>=10&&14>=n?m=4:n>=15&&19>=n&&(m=5),!o)return 0;for(var p,q,r=Number.MAX_VALUE,s=i._showIconOnly,t=m-1;t>0;t--){if(!(t<o.length+1))return{iconSetType:n,iconIndex:i._modifyIconIndex(0),showIconOnly:s};if(p=o[t-1],q=p&&p.iconValue,q===b||typeof q===d)return{iconSetType:n,iconIndex:i._modifyIconIndex(0),showIconOnly:s};var u=i._getActualValue(e,f,g,t-1);if(u===b||typeof u===d)return{iconSetType:n,iconIndex:i._modifyIconIndex(0),showIconOnly:s};if(p.isGreaterThanOrEqualTo){if(r>k&&k>=u)return{iconSetType:n,iconIndex:i._modifyIconIndex(t),showIconOnly:s}}else if(r>k&&k>u)return{iconSetType:n,iconIndex:i._modifyIconIndex(t),showIconOnly:s}}return{iconSetType:n,iconIndex:i._modifyIconIndex(0),showIconOnly:s}},f.prototype.reset=function(){var a=this;a.ranges=b,a.condition=b,a.style=b,a._showIconOnly=!1,a._reverseIconOrder=!1,a._iconSetType=0,a._iconCriteria=b,a._stopIfTrue=!1,a._priority=1,a.scales=[],a.expected=[]},f.prototype.iconSetType=function(a){return 0===arguments.length?this._iconSetType:(this._initIconSetType(a),this)},f.prototype.reverseIconOrder=function(a){return 0===arguments.length?this._reverseIconOrder:(this._reverseIconOrder=a,this)},f.prototype.showIconOnly=function(a){return 0===arguments.length?this._showIconOnly:(this._showIconOnly=a,this)},f.prototype.iconCriteria=function(){return this._iconCriteria},f.prototype._isDefaultValue=function(a,b){switch(a){case"showIconOnly":return b===!1;case"reverseIconOrder":return b===!1;case"priority":return 1===b;case"stopIfTrue":return b===!1;default:return!1}},f.prototype.toJSON=function(){var a=this,b={ruleType:13,ranges:a.ranges,iconSetType:a.iconSetType(),iconCriteria:a.iconCriteria(),showIconOnly:a.showIconOnly(),reverseIconOrder:a.reverseIconOrder(),priority:a._priority,stopIfTrue:a._stopIfTrue},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},f.prototype.fromJSON=function(d){if(d){var e=this;if(d.ranges){e.ranges=[];for(var f=0;f<d.ranges.length;f++){var g=d.ranges[f];e.ranges.push(new a.Range(g.row,g.col,g.rowCount,g.colCount))}}if(d.iconSetType!==b&&d.iconSetType!==c&&e._initIconSetType(d.iconSetType),d.iconCriteria!==b&&d.iconCriteria!==c)for(var h=d.iconCriteria.length,f=0;h>f;f++){var i=d.iconCriteria[f];e._iconCriteria[f]=new I(i.isGreaterThanOrEqualTo,i.iconValueType,i.iconValue)}d.showIconOnly!==b&&d.showIconOnly!==c&&e.showIconOnly(d.showIconOnly),d.reverseIconOrder!==b&&d.reverseIconOrder!==c&&e.reverseIconOrder(d.reverseIconOrder),d.priority!==b&&d.priority!==c&&(e._priority=d.priority),d.stopIfTrue!==b&&d.priority!==c&&(e._stopIfTrue=!1)}},f._getImageSrc=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAQgCAYAAADvxtzfAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAANyVJREFUeF7tfQl8TFf7/6CvVsXaIkqrtVZqKxq0SCyxxxpr0ailtUYoYilCrLWEqC0h9i2xJyKSEJSiUcQWW4tGFRFEJJlkMs//+Z577yzJzGQm+v5/fd93ns/n+7nnnvN8v2e59z5z7ty5Z1R/u7m4uDR1dXWlFi1aDJOzrDeFfPv2bbJZxJCswGqRnOSYmJg8RZjjgTKxk5MMREVHmRVRyDoBzmhnKBIVFU2RR45QRMThXCIKWckTArCcIhERERQeFk4HDhwwEgFu3bqVnksAllPkwP4DtHfvXgoNDdHlGSKXACynSEhIKO3YsYO2bt1KGzdtovXB6ykwMNC8ACynCMibNm2k4PUSefXq1ZYFYIYiIK8PDtaRf/zxR6sEdOeG0myFvDxguWUBQzKgI69cSQHLA8jff5l5Ac50MSRbQi6Bnj17FkKmLZCpdjM0UwNlCTJNb3wO6C7XvGBSAKaIKJctAswRjg+HDh2i/fv3U4h8dZoVgBm2JDIyksLDw2nf3n20a9cu2rJlS94CiD6KQNjBg7R3zx7auWMnbd68mdavW2dZwJAM7N4dStu3b6dNGzdSUFAQreRrwqxATnJoaCht27aNNmzYQGsD1/LVuJKWLfM3LZCTrPQ3eH2wLs8QRgI5yTu4v5u4v+vk/ioEQx+dQE6y0t9A7q+hMx+ZdoaxQidgSNb1d60UOA3JwplNEdEJGKoCa9asMUtWjPNF4JF3c4tYIiuGACQnJTMUyYts1hSRfJHt9k+xlLUuHi8DmxPj5KMVLg5ytnUmyEEuROnXKWXN57aJGJIVvFjlbJ1ITrL2N2+9yIp6JkVeBroEpaxuLF1MLwObGZEF7ozR5T33/8RIhNPBzxZUpBcrG0oCogVrmuhFmKy9PZLxjV5kcVUhAnLy/Aoi78WKuvrLGSIpqz7Ti4B8czDRjYG6vGcLP6Dk+e+R9uWldOw/X1ZTLwCDyIuAunqRmwOIEvqQ9noPXZ4hnnGrZKreIPLcv6bOSXutO9E1d6LLbYniWxBdakp00VkS+KFSbgEYRJ4trqIXudKWtPEtZXIjogv1RX7yvPKmBWBChEdaCMhkrSB/StrztUX+U793zQukrnWplzy/vNQKmaxFzb8y+bzUxaezipsWkMjvSWQANf/KZNQcx+Rfqon8pJlvmxjEda4uuprzwJPphXMLvPixPr0IqMNnX01xmDDSyQsqUPLcMpQ8uxQ99S1GSTOKUNL3henJ1ILmx+B/2XCN4zLFlYaLRTeQfNbhxMGxx+HDETA5iAgUyhmYF3AkZJqxKde8ctlKAWYUaW8N5cubr9BrHpIAH06ZktskEelsVMhaJmuv9SDt1Q4iH+eE7G5sCF2IPgggQkCuWcs1a68wGZc15+PEkil6U8gIYXASAmg2ggpqBvliY0mAz06ZJpmOzEFUT+5vVLOWydrz9SQBPsVlqp6MMK4jJ3Czr/OAgSznGUIXkXRk/iBRCkWzMdoGZBxewytVFxNBxkeZUpBztCXnKoQoZRgrcMUqAsZkbrbos5wHR5CFM5sSrXDZiwwUGn20GZAR5g3JiiHwIHbIu7lFAHzQmCKbNUMRfNTZRFZMiPCHbb7Idvs3WIl1Dh4l1xWNKx74tu0zd5BLrCt675vY4VR8zduJxVfYIGJIXnEhiLAttvytxLcXWyGSk9zuWCedSNEfCie+PfdN8yKG5ICLgdQ6pr2AGwP7yH9r1r8S35xhQsSIfGkNuUS65cLyS2uFSOFpbyS+6VNIL2JIXh6/mh1X0zJGk3BXhovYIh95KIPfG98VSizkLYvwoaISgYw1Ran4yrep2yl38o9fSZ/u/5zqy/C/vFLkF570Bv1rfCF6w7sgFRptZn7gsPQtWnplBTmFNqRPQj8jp92f8X4AFfZ5wzQhpxX94S1acnUZVdlRl6pur8Ooy/vL0WzrBN6e9yYtvuZP72+uSe9vceKtEy25tpQKjbVySlNkdmFalLCEym2oRuWCq1FZBvYLjbJS4K0ZhemHG4uoVNBHVHrdR2K7iPcLDi9gnUDhqW+wwA9UfO0HOmC/wDfWCkwqRAtvLsyFAkNV1gn8i0cbA4bjjGYX+JYB8mArBexm+TtF2cWywdHwyxgFNgsoDyuAfAlERUXRkagjdOSI9LTDZoGIQ4cE8E1mvgQOHDwgnnAoTzlsFti9e7cO+RLAk40d2yWYFTD3hTwImzdtok2MzZs26wRyQogoX3+dOXNGOCrAl5HrghgGX0oC8IM/eEIAllNk9epVtGr1avFgQoFZsmI5RQJWBFBAwAqxzZOsWE6Rpf7SN7hWkRXLKWITWTFDEZvJiiki+SLbTW/KIPI1U1jOss0g8FoiIBueCzaLgJjzbDQSQWZegIBZEUMHSwiUHxfkElEETp0+TcdPnKDomGg6FBEhPU8KCRHPWzdsCGaBtbRq5apcIiYEYsQz5/0HJIFtEBDPWyGwklYEGMcGvcApFjgutUAIyC2AQHDwBrkF0uMhky3IC6bGQDeIeUERyUW2xhSBfJFhIOWbDAMx32TYa5FhfLYZPwqym3WGyxQjn68jYEi2+QTKSbbpFDZFxjzRKhFTZMwNxRyRY4NFEVNkZW6o4CDPF82K5CQryDlHVJBLBDs5AUdpfrjdaI6YE9z63NcJCkDYvFmaH27irSIgu1g2RSAIc8R1QQL5Eli9ynh+aLOANEeUkC8B/6VLeY64lPzleaLNAosXL9YhXwI5YZOAOcgudrPGHgz7ksxBdrFsfwzuQ3TnTi5YLXB3YHdByAoJ1QH797/ubZ3A7T7ukgDHgqxtOyhz23ax/3v/btYJ3OjRRhAyN26izA0SsH+zZ3vrBK65uwqCek0QqXlupF4TKPavd25pncDldl8IQsayFZSxPIC3AWL/cvum1glccmssCOkLf6CMBYsYP4h95Msuervi4uRw+YtamguNaz6EA4DDBUKa72xK9/VjzBb7yD/a+BOBsHJvvTzw7hsJQuSScw0PEFOjDgtHBWlTpgm8mjzNKD9x5TIKr+5Ie0v+q7YQgJ2p/ZHHL80+pZeRh4TTq/ETGBNlID1B5P+hI6v0ZMVO1HD0+Mm5JqVEhEsio8cKpDIE+Ud/82TFoj8o7QGnF4cOClLq8FHG5KIWyIodciwiRJ6HH7C+5py2r3Qhj32lCj2+7jPW+ppz2u4SKtESm2q2W25LXd+SHk1W5f+p18v1LpQS+HlWvkVeBjWjjMshlBL0Rf5EXq7l4JJ+XRIJNCHy1NeBnvqVpuR5ZSl5QUV6trgyPfevQS8CalPKygaCqDx/NCmSNLOIzsESxMNr3uYSefJ9YcnpXCXpxxnna5MWP1S55CI98cUDazyHxaPzO3xl5hRJmvaGTkAbV50F6pD2gjNp4zkyX20vfkYjHiFD4PYo3U+NhMjqxq9USVMLGrfgV24BC9AlV+nhrWELWEDfgqaaRz6qdqonU1SSQB4wGoPVzhJZjAELPJlSgJ5wV5Kmv0U4KniqnzwXR6WCICgiSD//sZ6ebI09W/i+jvzMv6ZtZBiecAvyDx/aTobhNwZP5znmjwxL9itF+SbbLf9WhOHJCGHEyUAaeSizaM6MhOrVq1OvXr1o2rRpAkgjD2Wyj0nzKlKkiGb8+PEUGxsrgFtfQNlHGXzgK1H05la0aFENfk4NR/zIecWKFTRr1iyazViwYIH4pTTK4ANfcCSqZPFo6rFjx2jVqlXk5+dHM2fOpKnTptKECRPIy8uLxo4dS/Pnzxc+8AVHoqpUTcuXLy/U8TPjuXPnSuSpEnnMmDE0bNgw6t9/APXt00c8a4AvOOBCwAeDBOUlS5aQr69vDvJQGsDkHh49qEP79uTNLYEvOOBCwB9NxA/b0cRpCnm0XPOA/tSjh0Ru4eJCLfjeCb7ggAsBPzhitOfNm0cTDZo9QCF3aM83XS7UyNmZGtSvL3xRzlxfCAxu3bq1aNaiRYtYmclDQeZmi5o76Mh1atchV24FfMFhLk4uVRk+LGp80YABQtNRs4eoGWRXHbkGn0w4nPAFB1wIwPxdZGUMZN++fUWfDcnVq1UjrzFewge+4EhUyUow4keMGCEOEe7cO7u7i2a6NGsmtkv5Xhpl8IGvzDGyCoyzzlwjfrcOZ4z2zp07RBp5KIMP4wMQTBmutnGMRFw87twKQL6QEhkTZB+rzInRUQbSdrPWFi9eXISvd89Jk3xCvL2940aOHBk3ePDQkP79+3t6eHhYPgIcSJynT5+e4OMzmcaNG0cjR42kIUOGiOuiZ8+e1KlTp4Q2bdqYjokcvryYrPGZ7CPIo0aOoiFDh/DlPIB6MblzZ3dya+NGzZo11TRs1Mg4JnIQcZv+/XTNZF3NTBY19+eae4mTqY2bGzVv3ozPxs/42qit+bjqx/qYyDXHKzWP5JqHDuEoJDe7c+fO1IZrbt68uUSuw1dljepUqVIlKSbOmDGjqb7Zxn1GzW5t2lAzQearEuTqNejDDz8kR46JpUqVaqqaxMNtasBwNbq5tdHXXLeuiAcgI6C+88475ODg4KPiQ+U/Stdng5q5z81En6Waq9eoQZU+rCTIpd8pTcWKFaO33nrLX8XXtx9GW0/uLJqtG7A6XLMgKzXryFSoUCFfFdc8WN9sJivN/oxrrss1iz5LNb9T+h09+Q3xuxxP1aBBg8p49PJQS2RltA0GrJJM5j4r5DcKCbI+Jrp3cvfHoVJGu658qKQBc6TSBjXLZEAfEznmleAzLP4zpWbus+Fo68hSs4HcMbFx48YV6tSpfdbwUJWWyW++9aZhzeZjYsWKFYvwGTbO0dEx0XjAxC+hbIuJfJI4FS5cuCMfKntMtMYmz91J5mBNuXA4dvpWLigOeZXbBWQHc7Cm/PXNlLICa8rz7GNe5XYB2cEcrCm3299hpkZXgTXleR7nvMrtArKDOVhT/jdYrRAyCzZTNSsQfDj2mH4tFwwFLI6BXYANjubABkdzEHy7/Q1manQVWFOe53HOq9wuIDuYgzXlf4OZugoVWFOOhKV4kGe5XUByMAtryu32d5ip0VXAZuoqVCD4cLR0nOFoMR7YBdjgaA5scDQHwX99M1WzAmvKkbA0BnmW2wUkB7Owptxuf4eZGl0F1pQjYfE451VuF5AczMKa8tc3U8oKrClHwmIf8yq3C0gOZmFNud3+Zjt9+nSRY8eOecbExIQciYqKi4w8EhcRERESFhHhuXPnTstPuaKPH3eOPno0AW+W4YcaypKoeCHk4MGDtP/AgYQ9e/aYfu58NDbWK+boUY1EjiaumSIOH6bwcJDDQKa9e/fhnQ4Nt8T4uXNsbKwbyGKhxegoOnwkUiIfCqeDYUyWl0XFCyF4VW3Hjh2abdu26Z87Mzle1CzIR+iwIHPNOrKoWZCxhiJ+TrF161bpuTMPWFOFHKnUjGYb1byHdoWE6slbtopfBW3cuLGpKioqxicqWu4zD1juPu+hkF1M3rmLtm8zIlNwcLCPKjIqyl+MtqiZ+wzy/v26mrGi684du2ib1GzxasrGDZtow/pg/PDFXxUZGemnb/ZB8SuXfQYDJmqWm70JZFHzBrGOZNDaIF8VH+PBumYb9Fki6waMm72FyZvEao7r162ndYFBtHbtWk8IlOGa1YK8T+rzLh15h9xnJotmo2YmBzF5zVo1d0F67sxkf5M1K2RpwGTyOvGm4drVa/XPnXft2lUiNDQ0XiyBC/I2ueZNClmqOShQR45fs2aN8XNnrrXC9h07zhoN2IaN4u1Kw5qZeJZh+rkzixTZunnrOD5UiQp5nb7mRK55An4lIrtbNh4gp6CgoI7AulXr7M+d/27rues1Xpr0vPyNl2f8tydHXBlh29qKMJAHXf6WAJtFvrw01Kv/xcHU/+IQgQEXB6cNuDhM/4Zdz7hhuX5nppjHuYFeveIGUK+4gRJ+Gaj2OP+V/tezXX7qWa/z6d6P3X/uLX5rZ2idT/X24jJS4H6qt9r9dB89uc3Jrg3cjnV+6hbbhdyOd9a4He+iE2kd29mrzfEupID31a2OuRv/brdptJvHF0faaJpFtSWgKdKRbT2bH2nrpc9jRLVRM0z/6LfBIRePBuHNNQ3DXahhmCuDt5xuoKTDXNT1w1zxYw7z5rTP2eOTvY00tfY2ptr7GhO2tXjLaXWtfc6WyYpV3VnPo3rop5rqIQ2oemh9qhZaX11tZ33ryIp9tK22x0fba2s+3F5H/eG22p3lbNvso511nSvvcjL7E0K7/Q+Yt6pIMa9insXGFAtx8CoWByCNPJTJXqatuHdxZ4cxxRNqza9N3bd7kPfx8QJIIw9l8JHdjY1r8Xp3QhnN8KhRtP0pz0oYwY830XqGso8y+MBXpklWfExxt7ITy2mW3lwuHBf+sUQEzl7nB1C3c33I41x/Gn9lMv2YuJZmXp5DZSeV04Aj01F78Xg0dWvSDvru1mT68tIg6vkrk8/2oU6ne5BzREuqtK0WtQh3p+o7G1Dbg10IHEF2GOPQ9KMZlUXN3170ovanulObE12o5bFOIo2Y8P7WT2jiuen0KiuNttzZSZ2P9iFwwGWB4j4YpLm3fxCO3572piGnRtOH22tTlZ31RI377oeTYuF/HCH3o73FwIKrcvAq7j/s8Lc08+Yc6n98mHBKzXpFLbm5bSO6093U+yIvMzuTZp6fLyppF92DwAEXo+/31YFBLDBXFEb/FSsIf6U/ogxNhkgnvnpAnSJ7i/JK3LK1f64ncJjrizEY3CrQjbY93Un1DjQVTb6ZclsQYUf/PEGf7GpMH/AgglxrdxMx2OCIk8thtEOZMhPKqoMSg2nitWlUZden9Pn+tvQo/QnNvbhEV+tH2+uK9NBzowm+4IArHQnui+uaFkK5+09fCkKNnQ1FrR/tqMsDWofJtajlYXfa8mQ7wVf0X7FSk0qVwHH9OnyIOJxjLk2gzw66UtWQ+ixQh2qGNqaRv44XZfCBLzgyXbIi3kUqOIwpdrZxwOcUcGelcF71IIgRKNLIQxl8So0pZSbgSlfiOK4hERdPx42dBJBGHpdNyPOKVIwHyKnY2GIdAaTlbLtZZf+9MXHmrTmiDD7wtSkmunGIc4lpT/3ODKYt7ANfcATZMCbOubeQ+jG5F5O7MrkjyMc7k8vRDvR5ZGsx8cKFBt9cMREBZciVEdRTNLuvnhzTgZqAfMiF6h74nBqHu3FLd+aOiesfb5T6jJpP9RCR2RU1H0HNrlSHyTX3NKJqfInjCs0VEzHaSs0go89odgNB/oLJzlR1V336kOOD2ZjYk0fb7YTc7CNu3Gwm72fybj3ZYkycnDBDrpnJXHNdJjtxzdWYbHVM7HtmkFSz3Gz02eaY6H3Zh5zDWthj4v+YubpPoGETlmORyeGMh2KxSQl7VF+rashu5g0C7JzIzhHFllegxodb0ldXh1KdjQ2J8+5xmTPDjRHLOCnT9CYLnCwZ+CEBjQ+3EgIuh9sgX80icSh3+rGW8JNpesst0JI8IRDBAtwCXAvdfulL7aM6WyvQShI43FYS2JYfgWtDpC4Igdq2CshdkAUqWdsChyXlQYjg9HDeXqi+8hMjAbdD7S0IsCMXXuWtp6qnqpBqkMqF02c572GFoBrUYEsjkB9yHt6iMDYICJGcNlhVlQlxjBjGbyxq+qo0K2BoPVXm14qzSsCS/ZcIfDthZf4F7KZS4d01oE+fPjR0kCd9NbCfeMer35cDqFcfvkPr0ZO6dOlGHTq0o1ZuralzJ3fhD+gE/P2XC3zJpJ4e3cm9Uwdq2bIlOTdqQnXq1KLKH1Wn9xzLU/GSJfDKMhVQFdQL9O3dh5Yt9ceODu+3rET1vBqS88zPqYanE5Wq9Y5ROdDFvSu2KtWQrwfTgC/7i8wi775NLX5sS/1+5aneuYHU9ee+1OEkT3tiu1DV4TWpwBtijWUB+X1Xleqrr74Sr+Uis9Wa9jTg1yH0zeUxNCLem/qeG0Rtj3cjV572fMEzl/cHVJYFClJz12aSAAasU6dOVLlzNep3fhCNuvIdBf21kXYl76ZZt+dTh+M9xLSnMd+Ef3HIjRxqFKeCqgLk6iIL9OvXj1q1akVNFrhQ73Nf0XfXp9Ke5wfoYEoEreRb/k7He9JnPGdyPtSCWh11pxoTa4tW6LrQu3dvaty4MTVf05q6nO5Nnue/pSX3Aijo4UYad3kKNYtsLyZcEMFY1JrbgFQFVOTq2lwSQP9r165N9b535v52FU4dTvSkTid6UdPIdnxL/AV9sreR6EL7E93ooxHVjbvQpUsXqlKlCpVtXp5aHO0ovsFsFNGKGhxsTvW45tr7moh5cqujnVigO735/tviPGjuKncB7zU7OjqKfjVc+QU1j24nRrwJi+BDphkLolXuP/WkGt+L/xsQwHuA4OPVPCpeXPw1ChUuWZg+W9mM2vGhAzqc7E6dfvKgtrFdqco4Jx0Z0B1GnJI4PZUCoIyrI33i14BqL/mMPvL6mN6qaFwOuHcxuBYKFCjA/VKJbSHZAfsYbeSJrZyvwOhiUoBjC7g2x7aFvG0mRhyvcKPM0F8I2O1vNu3p00U0EZGe2WHhIZr9++M0obvjMnfsDFFv2eKpzeu5szY62jn78JGE7PBDpNl/gDS795Bm5y7K2rKNsjZsoMy1gQmZq1aZvnfWHIn20hyO1GSHHaJshbxDIW9kchBlrlxNGcuWazIWLTG+d86KjnYTZK5ZIu+lLJmcCXJgEKmZrF4WQBmLl1D6vAWadN85+ntnJsdLzT5ImtAcNTM5c+UqHTlj/kJK95tLaTNmSvfOdCiqqQY17zNutlIzmq1etlxHzvCbQ+kzZlLa1O8pbdKkpipN2CEfZcCy5AHLDEaf13GzpZrVi5YyeQFlzAbZl9IFeTKljZvko+I++wuyqHkrZYGsq5nJSrMFmWue9j2lT5pCad9NpFRvb39VVsheP+OaMWByzYJsULMgc81MfuU9nl6NGeurUm/fOdi4ZkOyUrOv1GcfmTyWyV5jKXXUKE8Vn11l1MEb1FLN8qFCn+fxgBn0OV0hSzVT6sjR6pTRo6V7Z/Xadf6i2csxYPJoz56rr1lp9thxgvxq1BiufbT+3pnWrCmR4b88XjpUC/g465stDdgErhlkb0FmxCcPy/Fs7tXixRXS5y08q/RZd6i45jRudppS88gxZ9PGjDF976xdvLhI2gzfcelTpyXqmi1qxoCNTuRBm6D19rbu3jll/Hin1LHjO6aOGtuRB8t+75xPQ+jC3xEDpsOYGRtWvXr1F127dqXvvvtOAGnkoUxyMW2Ob7/99hEsZRAWFiaWLYmPjxdAGnkogw98JYqBFStW7CgWHo2OjqbHjx/L3+3rDXkogw98ZZrOhqGpR48epczMTJmS21AGEfgyZ7hEVamK8PTmGZqYlJQku5q3J0+eiO6Aw1zxEL8pBun06dOyS952/PhxMbDMbQIBz2+//ZYuX74sF+dtFy9eJHDAFQKYK1+9elUuztsuXbpE4CgCTTF1wXK31hq6K69uKrpQhI9tMv4qITU1VXYxbykpKeJvFcBhru6XEMO/+OILoZydnS275jaNRkM//fQTwRcciaq3GCym8fPPP5tsCfJAhg98JYqxYV2c2AYNGtD69euFM44McPLkSbHsD8rgI/uaNVwwT6tWrUrt2rUTQBp5cpnVlu/L2W56+4fEROwjjOU7JnKRAM5C/MTM5pjIZTpgdRKI2BQTudwIn376qW0xUSEaAkuhWR0TFZIhsPSZPSbaY6LdrDd7TJSNy3T4X42JCskQWF/R6piokAyxcOFC62OiQlKARbjwI3CrYyKX6VC4cGGxvqJNMZHzBbD0F8g2x0QsuIg/MLDHxP9Us8dE2bhMh//2mCivEWsVTMbE2bNn53I0B5MxEXEOUUdxMgeLMRHKb0gLDZqEVTERi/OaaolNMTEwMFA4Ix7aY+J/uv0fx0SELqRtjokIWfIZZwSrYiJOV8Q93jeJPGNi3bp1c5FywmxMxKWsOOUFkzFRXvrZKthjoj0m2u1vsNdejQVE4/VgbDSbBeCoQNm3WcCQ8B8ggAIFyr7NApYIOfdzWV6EnPsiQ4Eph7z2bSbk3P9vEVCQn3275cNeexBBNDqMtprNAnBUoOzbLGDxTMzL/v8LoECBsm+zgCVCzv1clhch577xei9seRFy7guBMTsfvp7A4FV3X0/AcI2bvAg594VAu5EXXk9ABzYUKLBm3275sNceRBCND6ONZrMAHBUo+zYLWD4T87D/AwET14bNAl67rA8wuY2JIzcn2iAARwXy/rC192wTMIyJ2H619I5tAoYxEds+c27YJmC07hdvu025apuAYUzEtpP3JdsEdDCxD0cFpvbtlg977UEE0fgw2mi2C5g4L2wWsBQf8jYmjtr65+sJjNhoPsDkNjgqkPeHBd63TcCwz9h+veJ32wQMYyK2A5bctiCAAgXyvmFMxLbvvJuWBSzFRGx7zrxuWcBSTMS26+QrlgUsxURsO38Xb1nAUkzEtqOX+RgpHHSwYh9EBaLcbvmwHINquzFxjOHFZrMxcfR2fYDJ2+CoQN4fufmBbQI548O3wX/YJmAYE7EdGmhwuedp7GgYE7H9eqXB1ZvLUKBA3jeMidgO9DeIF7mMCyzFRGy/XHjLsoClmIitUcARCQXyvqWYiK3HDH2IExm2xERsjSIWErbERGy7TLhsLGBLTMS20ziDfSRsiYnYth9z0VhAh/zs2y23na6oKnKshMozpqQq5GhJVRyANPJQJruZtujiKmcmJPzyeW26NWYo/bUmQABp5KEMPrK7sXGh1/H3imoeLJ1P9McfEn77TYK8jzL4wFemScaqbicqFtO8OhkrHLWXL1P2kSjSHJBfmGNknz0ryuADX3BkukoVU0IVj6bS/fukPfUzZR+SX08MZfL2HZS1cTNlBq2jLN6ne/dEt8AR5GOlVE1Pf/K+1MwLF0m8JLhvP2WFhJJm23Ymb5LeLvxxJWX4+5Mm8ojwBQdcVUwplQ8Gie7/wc0+IsiakBAmyy8Irg2kzB9/pIwl/pSxYCGpeYuWggMumu//x8LZRHd+o+y9+0izK0R6NTF4A6nXBJJ6BZMX4+XAhZQxy4/Sv59B2uvXCRxwIeB3d6YPC9yRyVspcz3IaykzYIUgp+P9Ppmc5jOFtDduEDjM9VUdLaEafLVfV9GsrF2hlLUumDJXryH18hXSW3bzFlC672xKmzZdvJ6Hd97gCw5OLtUJB1WZ4xWKqTOv8KE7cZLUq1YzeTllLFpMGXPnCXL6VCZPmkyvxk+gTD4S8AUHXHEk0JfLvTqKQ5S1Yyepf1gkkWfOkt7tm8jkcd/xUVhGdPcuwVf0X7GoUqoSnBF/f850cYiy+FCpecTTpk5jsg/3fTpl7T8oyuADX3BkumTRpVUV+BQ9e7GTK6WfOS2ctdeuCSCNPJTBh8mm3+3D1caDOo6RiIsnYciXAuJC4jyueUKeV6Ri3CInrq0jgLScbbd/q/3ernXju1066c8uE/ZbB7fm97p2WCTv6g3k5G++yUr1Hk/3unUKkrONDORnI0ZohE/XjivkbMn+GtD/Ac51wJSIQlZ8UsaM1d5s16KKXKxSYefpkMFppkRykl96jaXf3duMF0RDyykC3O/RJcwqsmKmRKwmKyZEhg7NMCSnjh1nHRkm+jx8RLahAGDu6BjZ7U6tWxn2WbyabK1ITjL6fLdLh7k5x8SkiCmy0mdTA5tLxPBEMjXaEEka/PUrxSfXiXSrTZv32SHV0qFSRED+vVO7EXK23iDyW8f2Q+VdkwaR253aDJJ37fZvs3/WPFGbkCCg7Fs9T8w6HEnpPKXBdAZAOisqSpRZnifevSf9yjkzkzJ4aqcIZPJEk7RaqYx9zM4Ts3hymXVMWpAVBIgIsmyZmD+yD3xNzBPvU/qcuaLGrJM/SQylVjaQRXfYx+Q8UXvtuq7JQPZvv8tUoqwzZ43K4JtrnojRVhwMmy1M7o5OwNw8EWsf5OqzQXcgAh+z88SssHBdv5U+AzqR7GwxiObniXyIsniyaUg2FEEZfPKeJx4My30iHYoQZTbOE68LIG2fJ/7HWlh1x3bh1R0pvEZZ4whkjSnkRzu2kM0iCvnZsWjS3rxF6Rd+tV5EISfHHn2Qfeq0uIPNPn/eOhHDmjUnTgiyAiHy63nzIjry0SjKijlKmbgB3cq3v1hsBneyjOxz51gkLreIjhxzRIR0NW62Bdbxjfc6g/0g0vBlnR73i15kl0pVCDs3p06g7MtXxL2hBL75NIKSt4y0t27RX6sChIhowaGqjk7YeRC0WoT1ND++6dRhrgwpreGBTYo+cgr+aLkQgCki2VeuUtaRKEqbPJVeTeYbT94qQPOf7dktajYiK6aI3AsOvJEVESktYwN4jSNN7Al6tnuXebJiiojmwgXKCj9EqcNHUVZ0DD3btSNvsmK6MeGByk64YbrPeZkicmPUMOtrzmmKSL7IdnsNwwpFtHy5Z/aixSGaOfPjNLNmx2mmfB+i/m6SZ54rE2mXr3LW+i9P0P6wmLLnzScmU9bU7ylr4iTK5NNZ/c3IhMzBg03PE7UBP3plL12myTYkT2PyBB8me5P62xGU8fUQSu83QJPRvbdxRNIGBLgJ8iImz51P2b6zSWNEHklqiUxpHr3pVacumpdt2uvnidn+y+KVmkHOmjadMtHsMTJ5EJO/HEDpTE5z70av2nSgV64t5bXC/P2b6sjcbMOaM9FsJmd8OZDSe3DN7l1lcit6+XkzSmnQqKlKs3CRj+gzasaACTIPGNeskNMMyKlMTv28Ob1s0JhS6jTwUXGf/QVZ1IzR1jdb1CyarZBbM7kZvWzI5LoN6PnHdfxVWb6z/dBnHXn4CKnP/bhmXZ/bU6pLa3rZBM0GuT6l1KxDL6rV9FVppk4fbDTag4ZKA8bNTuskDZhCFs3mml9IZHpRuZqnSjt5chn1aG915nCpzzhU6R69mMzNbis3uwn3Gc2uo5Cd6NmH1dQpjlXltcK+HeEvnSRKs+U+o2b9gFGKE5OrOtHzytXp+QdVDNYKGzasRFrfAfEYMP1oy2S5ZqnPTP5IkOOTK1fOsVaYh0eFNPcuZ41qVsioWfS5Oj37oMpZJptZK6yxR5GXrq3G8YAlpih9lslcc+KzDypPuF+xonXzxJR69ZxefFy344tqH3dM+aCqfZ6Yl2Fh3hHjA+hQdcfh4dUcH+LTSEK5PRE13rNunW12TgyvVi7i6eQpRHvDKDtkH931HID8ewerlXMOr1rWLax6udiwauVMr/CMAnyUqxcsIS0LaFngGV+hLKpmxKH86uCBwk+m6c1IYCEEwvUC3IKMOQtIG7qfkpcvz1sgQwgYtMBWAakFLBDKAhxYbW8Bj4EYRBZ4PmFiDoEAywJ/9uuLQYsQh7N6uQtXunUUAmpZ4PEPP5gXgCMfpqvs4InJJ89OXPhcOIvzInmiD/0xBUfE8SGXW7/O9uEqZapKh9Axhsm/YcojFxmbOQFD2+XkZF9n25KBbF9n+zVNWaX3n7XOdtcmTWj+V560YfQYmty1GzWW3vM0gsl1th1LlaLDfn6kwaPjA/spa9cuysST36B1tLCHBxUuVEgnYHKd7WhM92KiKPvCz5R98QxpIsNJjWew0oq2NLNdB1nAxDrbX7VuTVlhHM5+OUXaZ78TpdwnzaWfKXPDBkHGA9xXywKo/vvvm15neycH0ax9+yn7zAnSJv9O2hf3SPPrKb5/DqR0noxmLFoi7qUDBwwUrci1znYs912sLbt/L2lOHyPNmVjKDN1JGTzA6XPnUQaLZK4Ppv0jRppeZzuYZ2p4VC76vI7v2teulcnzKW32HHHjnblxMy3p3sP0OtvdGjTk0V4vDRju1LlG1JzGN91ovhplLFDt3XfFeWByne1Ib54nL1/BNfPtPh6ZM7CPp+H4EmLLQPGmtYDJdbZLvv02hQz9htSr1kgLEgdLRHXwRgrgpsNHgcV1tjt+Uou2ff01RfGZuLpnL6pRpoxROWBfZ/t/w0aMGOEAyLu225gxY/wAedc28/b2rjBx4sRUAGk523obPXp00L59+whAWs62zry8vOpNnTpV8+DBAwKQRp5cbNrYoQb3tx9jIeMq/uP62rVrAkgjTy7rB1+ZJpo6nTNfzpkzRywuhb9oPn/+PD18+FCs1AMgjTyUwQe+4ICLwSrCiZNYFAFrAiUkJNCZM2fFGkEghB8Kp5ijMSIPZfCBLzjgilYM4/tGzriA/3S+e/cuhXNoxz8t79u7T2zxT9Ph4WGiDD5cexw4gqwYC5RhJGCNixs3boh/WDYE8lAGH/jKNGPjgnZYOOH27du0afNm8QfJmzdvElvkYSEF+MjuuW3UqFGeG/hTCAsrhYaG0sWLF8QaukjHx18ilMFHds9t3DdfnDh//vkn/fbbb2KwAKSRhzL4yO65jQs3YZBQE4/wS95fDCCNPHkAN8nuuY37d5LxlDGdSaXlbBzq0siTy3JP9xVj9X6WLl+UwUfetZs19mhGmdeLiU9nl8p/TEzyK10heWHF/MfEp34lg9JjvPIXE5/5laiXvKSqRpsUZX1MfDLrnRpP55TslzS75MKns0tezfh5BtFfG/OOiUyYzs19+Xx1fUrd04vST/Bc8fpqouRo0v7uk3dMvL+4YpEkv5InX4V5Ej0/wbVuIO29WaS9PYq0NwZaFxOT55cqkTS71IW0qJFET0JJe60Laa+4CVgdE1PmOJThriSkH59A9DCQtL/WJPrVybaYyCdOu5QNLtyNYKIzJUl7tpRtMTHJr4Rn6t4+RPf9iM7XILo307aY+NSvlC9OHkqOpOw/9xMG1qaYyAKbMJBoxdN5777ko2NbTMThTPIr9RTnxvMZxW2PiTgTcQnLu7nMHhPzYRhQS4OapyEmAvKubabERABpOdt6U2IigLScbZ0ZxkQAaeTJxabNXEwEkEaeKGMf+Mq0vGMigDTyUAYf+IIDrumYeF8fEwXujBZxEmXwgS844IpW5IqJV5WY2EZsCVuOkyiDD1/2ceAIsmI5YyLiofZ8TYYTpzk+ch7K4ANfmWZs+pi4nojjIZ0xAMfJlI0teDBL2RYTBX7lNOehDD6ye24zFRMBpJEnnVSlbIuJANLIkwfQ9piINPJEGfvI2bktr5iIMvjIu3b7/2IVvSsWKfM6QbXspHKxZSeWixP/qmmrlZ1Ytt8XK5oSUGaiY6418iwamv3BtEoPVt8LpDX3g+j97yslc3d0Z2aeVnai47zB4UMp8NF6CnoUTEiXm1hupVxs2cpPKv/BJ/NqZW5+tI3GJ/jQuIRJtPnxNnKaV0tT5rv3LEdmWLmJjlu/PzeDZt+ZT1/+8jX1Y/jdWUDIKzfJEQtQmrcyk8o3bbG2Fa3jUO5+oje1j+1O7WJ7UNeTfWjD4y3UdGVzdKWj7J7D+FA5Ti5/cdmtFfTV2W+oUXhLRisdhsaNpkXXl5LjpPK3nGaYeFyCQ9V9hwctuLOEPg51phohn8ngdOhnVDO0ES29t4LgU25SOR+ZJhkOUeUZVZLXPdhALQ93Fv/lbApto3oQfCrPqJxaekpF/QcuDlHv0L7ib5jx/9U//L7MJIIebhA+Hjt78Vg4bpXpOO7lrr43pQI1XPqZVYAvH5GHMl26aMr7lG9gC17rIrPbv8OOOZVxCPu4fANbsNPwZwR4khnh9D791NHFKsAXT0dluvhx39Yr3/H05s4d4tsz8W6fKfCNo/C55jMWz171EepgtYoVohpWT828eIHwF3xZm7dSpsAWgSwFBw8SfNg3+bBTjhjJTfK57D2ctHyXhpfi1KvXUMaqNeJbfgVavv2FD54KyzS94ZlqeI3yt15EHaas0N2UsXARpctAOnP7Tko9fozCP37vIp4KyzRj4351PNOzI0/prlH67LmUNm0GpeF1vFmzxRj80r87116+qexu2nhAjzzavpkyQ3ZLr6F4f0eZu0IJeRhs2c28hVV7r94xlwaa7GtXKU38PnEaIX2sxWeZByqXN/M/7zkMh+j2vJmUffIn8WtRpPlcmScX5204RJF1KydnxJ2j9HNn6HCdyg9wtsrF1hkO1c892hMQXrWs7RMr8etRPHevXg5ryObP0Gyji8ZudvtnW9IcB6cns0o0sAWPZhSvKpFnlViZNLsE5QuzSszju/biJ8Wd6sMfbYI2cS0EwvjuvXhs1vnBRNf7MwbI25xQ8rEdQFpG5s8DuRXF9/PtbvHeT2aXOM1NirMFaPljv2JmJp12s9v/ud33VhV5NKWg55MpBUKeTCkYJ6FACPJQJruZtqQpKufHUwomPFtRh1IPDKaMX5YKII08lMFHdje2x9MKej2Z6aBJPzWHKP22hFdXGDy9k/dRBh/4yjTJkiYXcnviW0KjSYySnF8ck677xHlE92cyfIme7hNl8IEvODJdpeJ+xqOplH6T6MkOogeLmYw36KYT3Z3Ak8vRRLeGSGJpN0S3wBHkR1NVTZN/+ECq+VkkkxcR/YF3174n+h1knsHe4oCT0JcIX8j9yS1jX3DAVT2ZWtAHg0Tpt6Rm/+FHdG8ak79j8giim4OY3Ifoameiy2687SpaCg643PwC/uknuGmv4pk8m5s8lei38US3hzPZk0NYLya5M7kV0cUviH5tQJTyM4EDLreggF9aDDcVAnenMHksk7/hSfdXTO7J5I5E8S2Z/DmT6xOd/4To5S8EDgv4qh5PLTg4ZTv3DV24x7XfGsZkBE8PoisdmNyCyY2Z/ClRnBOnG/FA3iRwcHKp/pysKsMfFGpt8nkivkOnGxx9r3VncnsmuxJdALke0S81ic5V4Up42su+4IArjgT6krKFa+NDRPgS9kpbokvNmcy1/VqHawa5Mgtzq9ISCL6i/4olT1KVwHFNi+Uu4HDiUF1uw/0FuQaLNOTzgg8vl8EHvuDIdMn4HK/A43H2xXpX0jyMlYR4tCnltEgjD2XwYbLpOTOuNnYYx0jExfNyd18BcSFxHtc8Ic8rUrGkySqnx1MKdQSQlrPtZoul7Clc8+Xmt/oDSMvZ1ltaWMG9GdEqyohREdJytvWWduhfezOO/osApOVs6y09oujejNiipGYgLWdbb+mRpfeqT7xD6hOlCWk523pLi3IMzDxVgQCk5WzrLf3oR7Mzf67Ks7GqhLScbb1lnq71TdYvdSjrXB1CWs623rLON+qcdb4xZcUxOC1nW2+Z8a4umostKfNc82yk5ez/JEuPVg3JiFKdAZCWs603Jt0U1wIDaTnbenvtFtjtNewfNk/kmYiAvG/9PPGv9ZQa60ipx0oLpJ/iicXDtaLM8jyRJw90x0tMa1KOvEmkzSSt+k96dexdniN8xpMuniuyj/l54p8rpDlRvIskIJYsSGOBd1iAZ2fnearzx0Lha2KeyLPUaz14auMipjeSgJYo6wULlJbmSedrcxnPm3iSlXue+PKcTG4m5oMpUUWYryFtxp88reEugIwnwHEfm5knYrQxsbrYlNGEXkY7cPPVpH2VwM5lmczzQ8zUfqlubp7IXbjCM1ImY3b26mhJrvkd3hanjJOO0kwtjsmY9pmdJz7wl6d2DSn9eBk+CEmU/fw0qU++xzXzbO1cNZ6Ez7E0T+TDiEPFU9r04+9S9st40vy1gwW4BSBf50m3VfPEB0tJfbqKIKpPlqOsM1x74hJRlo95IoPT9nniP97wMtDICQH0dKbD8Ke+Dg8ZJDCz6J4ns4pZ924fkxOTfB0iNBEF+UaLrw2OSuqYjsR595JmFHdO8i3qljSzaCxvTb9VhgI6oSIBIRBM2Ze+hoCaxeNQ/mqPu/CTaXozKxAvBO7RWY5Y92ZS1qXp1grw3Sl34fUEHrGA1IV7dC6/LVAEzlayTiDrYCEQInA4eXshLfQLWUBqQWbcJEsCDvee+ha9mjSrmCftUhVK9nVw4f2zOC80RyvwtN8D58bDpzOLWf9uH743xSFkYgyfA78lzXDI/7t9NENlf7fPkoFsf7fvNU15M+if9W5ftzZVaOGkJrRpoStNHV6HmtR716gcMP1uX5miFLmRJ1t3xktTvhs8XxDf5PWgxRM+ocL/KqgTMPlu39GtHiJ40KNgxmZOT+eJRW9p+nO5Hc0ZrbxlaOLdPs8ePA+6PZZnpat5JnKV5wW3iB5v5Rb047ljGwHN5W7UwKm46Xf7QgLciG6NkCacaVdYgCdejzdx83tKU0BuASUMpLUzpT9NzfVu38ltPE/C14B3vCWRh2u4RWO45tY8e+PZGb6gu/E17VnW0PS7fZsWfC7Vhhkrvg7Et3rx+CKSyRd4rnylk5iELfSuavrdvh5tKrITvvrEV4FMxKxVnvbRRe7C9b6kTRhE1T+QzgOT7/Zd2MPNvcIfbVc6Sn1G8zGAmOLdHEqhS+oJP8Dku31lS79JcaFMuDGI4SmNCW+1CV/Txjm1dWTA4rt9vdqWp7CVjejnbU1p24K6VLtaUaNywP5un92sskczVI4WP9bzssdTC2wV94b5MdyVPp1fnp4tc3qFuxk523rju5O4jLhllHkrhO9WCuT9+xNDezK5YL/nq52JMn4XSNneVbpPtsZ44Bxwf5R1ew9pf/MWyH5yhu8Ti1+SXSzb4ykF5qFG1Ky9PYIxXKRfRXoRWia7mTbczj3h2Tlq1HIgMULKVXq6oMJDtFB2z20YrLSYSVLtHFC117rJWw6unIdBRQtld2MTX0Qs/ojo1U3SXm4tQPJWSvNnBos8W90o85GPSnpwrxj1VBXiE+ZCxnn+LGAnPMnRcijXIiIbprks6244Pfn+X+EyVTI+5sN0hy2uFtF5BfjSgSHy5DT7vNzdj7tSSHpsLg7btDcSoSwErAAGmSfld8R1In1rpXxjlQemFozlgV6jwOyXUtabSvX/AOf1iiJEERHsAAAAAElFTkSuQmCC"},f.getIcon=function(a,c){var d=[["0,160,16,16","0,180,16,16","0,80,16,16",b,b],["0,100,16,16","0,120,16,16","0,140,16,16",b,b],["0,900,16,16","0,920,16,16","0,880,16,16",b,b],["0,820,16,16","0,840,16,16","0,860,16,16",b,b],["0,780,16,16","0,1000,16,16","0,420,16,16",b,b],["0,680,16,16","0,940,16,16","0,400,16,16",b,b],["0,800,16,16","0,1020,16,16","0,440,16,16",b,b],["0,740,16,16","0,1040,16,16","0,400,16,16",b,b],["0,720,16,16","0,980,16,16","0,380,16,16",b,b],["0,700,16,16","0,960,16,16","0,360,16,16",b,b],["0,160,16,16","0,40,16,16","0,60,16,16","0,80,16,16",b],["0,100,16,16","0,0,16,16","0,20,16,16","0,140,16,16",b],["0,220,16,16","0,340,16,16","0,460,16,16","0,760,16,16",b],["0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16",b],["0,200,16,16","0,680,16,16","0,940,16,16","0,400,16,16",b],["0,160,16,16","0,40,16,16","0,180,16,16","0,60,16,16","0,80,16,16"],["0,100,16,16","0,0,16,16","0,120,16,16","0,20,16,16","0,140,16,16"],["0,580,16,16","0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16"],["0,480,16,16","0,500,16,16","0,520,16,16","0,540,16,16","0,560,16,16"],["0,240,16,16","0,260,16,16","0,280,16,16","0,300,16,16","0,320,16,16"]],e=f._getImageSrc(),g=d[a][c];if(g){var h=g.split(",");return{image:e,x:h[0],y:h[1],w:h[2],h:h[3]}}return b},f}(E);a.IconSetRule=J;var K=function(){function d(a,b){this.ignoreBlank=!1,this.expected=a,this.formula="string"==typeof b?$.trim(b).replace("=",""):b}return d.prototype._concatArray=function(a,b){var c,d;if(1===b.length)if(c=b[0],c instanceof Array)for(d=0;d<c.length;d++)a.push(c[d]);else a.push(c);else for(d=0;d<b.length;d++)c=b[d],c instanceof Array?c.length>0&&a.push(c[0]):a.push(c)},d.prototype.getValidList=function(d,e,f){var g=this,h=[];if(g.formula&&g.formula.length>0){var i=g.getExpected(d,e,f);i instanceof Array?g._concatArray(h,i):h.push(i)}else if(g.expected&&g.expected.length>0){var j=g.expected,k=j.split(",");if(k)for(var l=a.features.formatter?new a.GeneralFormatter:b,m=0;m<k.length;m++){var n=k[m];if(n!==c&&n!==b&&""!==n){var o=$.trim(n);if(o!==c&&o!==b&&""!==o)try{h.push(l?l.Parse(o):o)}catch(p){h.push(o)}}}}return h},d.prototype._equals=function(a,b){return a instanceof Date&&b instanceof Date?a.valueOf()===b.valueOf():a===b},d.prototype.evaluate=function(a,d,e,f){if(f===c||f===b||""===f)return this.ignoreBlank===!0;var g=this.getValidList(a,d,e);if(g)for(var h=0;h<g.length;h++){var i=g[h];if(!(i!==c&&i!==b||f!==c&&f!==b))return!0;if(i!==c&&i!==b&&this._equals(i,f))return!0}return!1},d.prototype.getExpected=function(b,c,d){var e=this;if(e.formula){var f,g,h,i,j=[],k=b.getCalcService();if(!k)return e.expected;var l=k.parse(e.formula,c,d),m=k.evaluateParsedFormula(b._getSheetSource(),l,c,d,!0);if(m instanceof a.Calc.Reference)for(f=m.getRowCount(0),g=m.getColumnCount(0),h=0;f>h;h++)for(j[h]=[],i=0;g>i;i++)j[h][i]=m.getValue(0,h,i);else if(m instanceof a.Calc.Array)for(f=m.getRowCount(),g=m.getColumnCount(),h=0;f>h;h++)for(j[h]=[],i=0;g>i;i++)j[h][i]=m.getValue(h,i);return j}return e.expected},d.prototype._isDefaultValue=function(a,b){switch(a){case"ignoreBlank":return b===!1;default:return!1}},d.prototype.toJSON=function(){var a=this,b={expected:a.expected,formula:a.formula,conType:12,ignoreBlank:a.ignoreBlank},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype.fromJSON=function(a){a&&(a.expected!==b&&a.expected!==c&&(this.expected=a.expected),a.formula!==b&&a.formula!==c&&(this.formula=a.formula),a.ignoreBlank!==b&&a.ignoreBlank!==c&&(this.ignoreBlank=a.ignoreBlank))},d.fromSource=function(a){return new d(a,b)
},d.fromFormula=function(a){return new d("",a)},d}();a.AreaCondition=K;var L=function(){function d(a){this.rules=[],this._ruleTypes=b,this.worksheet=a}return d.prototype.getRule=function(a){return this.rules[a]},d.prototype.count=function(){return this.rules.length},d.prototype._cloneRanges=function(a){for(var b=[],c=a.length,d=0;c>d;d++)b.push(this.worksheet._getActualRange(a[d]));return b},d.prototype.addSpecificTextRule=function(a,b,c,d){var e=new n(a,b,c);return e.ranges=d,this.addRule(e)},d.prototype.addCellValueRule=function(a,b,c,d,e){var f=new k(a,b,c,d);return f.ranges=e,this.addRule(f)},d.prototype.addDateOccurringRule=function(a,b,c){var d=new t(a,b);return d.ranges=c,this.addRule(d)},d.prototype.addFormulaRule=function(a,b,c){var d=new q(a,b);return d.ranges=c,this.addRule(d)},d.prototype.addTop10Rule=function(a,b,c,d){var e=new w(a,b,c);return e.ranges=d,this.addRule(e)},d.prototype.addUniqueRule=function(a,b){var c=new y(a);return c.ranges=b,this.addRule(c)},d.prototype.addDuplicateRule=function(a,b){var c=new z(a);return c.ranges=b,this.addRule(c)},d.prototype.addAverageRule=function(a,b,c){var d=new B(a,b);return d.ranges=c,this.addRule(d)},d.prototype.add3ScaleRule=function(a,b,c,d,e,f,g,h,i,j){var k=new G(a,b,c,d,e,f,g,h,i);return k.ranges=j,this.addRule(k)},d.prototype.add2ScaleRule=function(a,b,c,d,e,f,g){var h=new F(a,b,c,d,e,f);return h.ranges=g,this.addRule(h)},d.prototype.addDataBarRule=function(a,b,c,d,e,f){var g=new H(a,b,c,d,e);return g.ranges=f,this.addRule(g)},d.prototype.addIconSetRule=function(a,b){var c=new J(a);return c.ranges=b,this.addRule(c)},d.prototype.addRule=function(b){if(this.worksheet){var c=this;return this.worksheet._bindToAutoRefresh(function(b){if(!b)throw new Error(a.SR.Exp_RuleIsNull);for(var d=0;d<c.rules.length;d++)c.rules[d]._priority++;return b._priority=1,b.ranges=c._cloneRanges(b.ranges),c.rules.push(b),b})(b)}},d.prototype.removeRule=function(a){if(this.worksheet){var b=this;this.worksheet._bindToAutoRefresh(function(a){a&&b.rules.remove(a)})(a)}},d.prototype._removeRange=function(c,d,g,h,i){if(!c.intersect(d,g,h,i))return[c];var j=c.row,k=c.row+c.rowCount-1,l=c.col,m=c.col+c.colCount-1,n=d,o=d+h-1,p=g,q=g+i-1,r=[];if(-1!==j&&-1!==l&&-1!==n&&-1!==p){if(p-l>0&&n-j>0){var s=new a.Range(j,l,n-j,p-l);r.push(s)}if(e(q,m)-f(p,l)>=0&&n-j>0){var t=new a.Range(j,f(p,l),n-j,e(q,m)-f(p,l)+1);r.push(t)}if(m-q>0&&n-j>0){var u=new a.Range(j,q+1,n-j,m-q);r.push(u)}if(p-l>0&&e(o,k)-f(n,j)>=0){var v=new a.Range(f(n,j),l,e(o,k)-f(n,j)+1,p-l);r.push(v)}if(m-q>0&&e(o,k)-f(n,j)>=0){var w=new a.Range(f(n,j),q+1,e(o,k)-f(n,j)+1,m-q);r.push(w)}if(p-l>0&&k-o>0){var x=new a.Range(o+1,l,k-o,p-l);r.push(x)}if(e(q,m)-f(p,l)>=0&&k-o>0){var y=new a.Range(o+1,f(p,l),k-o,e(q,m)-f(p,l)+1);r.push(y)}if(m-q>0&&k-o>0){var z=new a.Range(o+1,q+1,k-o,m-q);r.push(z)}}return r.length>0?r:b},d.prototype.removeRuleByRange=function(a,b,c,d){if(this.worksheet){var e=this;this.worksheet._bindToAutoRefresh(function(a,b,c,d){var f=[];if(e.rules)for(var g=0,h=e.rules.length;h>g;g++){var i=e.rules[g];if(i&&i.ranges&&i.intersects(a,b,c,d)){for(var j=[],k=0,l=i.ranges.length;l>k;k++){var m=i.ranges[k],n=e._removeRange(m,a,b,c,d);n&&(j=j.concat(n))}j.length>0?i.ranges=j:f.push(i)}}for(var o=0,p=f.length;p>o;o++)e.rules.remove(f[o])})(a,b,c,d)}},d.prototype.clearRule=function(){if(this.worksheet){var a=this;this.worksheet._bindToAutoRefresh(function(){a.rules.length=0})()}},d.prototype.getRules=function(a,b){var c=this.rules;if(0===arguments.length)return c;for(var d,e,f,g,h,i,j,k,l=c.length,m=[],n=0;l>n;n++){d=c[n],e=d.ranges,f=e.length;for(var o=0;f>o;o++)g=e[o],h=g.row,i=g.col,j=g.rowCount,k=g.colCount,(-1===h||a>=h&&h+j>a)&&(-1===i||b>=i&&i+k>b)&&m.push(d)}return m},d.prototype.containsRule=function(a,b,c){return a&&this.rules.contains(a)?a.contains(b,c):!1},d.prototype._clearNullRefRules=function(){var a=this;if(a.rules)for(var b=a.count()-1;b>-1;b--){var c=a.rules[b];c.hasNoReference()&&a.removeRule(c)}},d.prototype._addRows=function(a,b){var c=this;if(c.rules&&c.worksheet)for(var d=c.rules.length,e=0;d>e;e++){var f=c.rules[e];f&&f._addRows(a,b)}},d.prototype._addColumns=function(a,b){var c=this;if(c.rules&&c.worksheet)for(var d=c.rules.length,e=0;d>e;e++){var f=c.rules[e];f&&f._addColumns(a,b)}},d.prototype._removeRows=function(a,b){var c=this;if(c.rules&&c.worksheet)for(var d=c.rules.length,e=0;d>e;e++){var f=c.rules[e];f&&f._removeRows(a,b)}},d.prototype._removeColumns=function(a,b){var c=this;if(c.rules&&c.worksheet)for(var d=c.rules.length,e=0;d>e;e++){var f=c.rules[e];f&&f._removeColumns(a,b)}},d.prototype._clearCache=function(){var a,c=this.rules;if(c!=b&&c.length>0)for(var d=0,e=c.length;e>d;d++)a=c[d],a instanceof E&&a._clearCache()},d.prototype.toJSON=function(){for(var a=[],d=0;d<this.rules.length;d++){var e=this.rules[d];a.push(e?e.toJSON():b)}return 0===a.length?c:{rules:a}},d.prototype.fromJSON=function(a){if(a&&a.rules){this.rules=[];for(var c=0;c<a.rules.length;c++){var d=a.rules[c],e=b;if(d){var f=this._getRuleTypes(),g=f[d.ruleType];g&&(e=new g,e.fromJSON(d))}e&&this.rules.push(e)}}},d.prototype._getRuleTypes=function(){if(!this._ruleTypes){var a={};a[0]=i,a[1]=k,a[2]=n,a[3]=q,a[4]=t,a[5]=w,a[6]=y,a[7]=z,a[8]=B,a[9]=E,a[10]=F,a[11]=G,a[12]=H,a[13]=J,this._ruleTypes=a}return this._ruleTypes},d}();a.ConditionalFormats=L}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){function b(a){if(a===e||a===d)return 0;if("number"==typeof a)return a;if("string"==typeof a){var b=parseFloat(a);if(!isNaN(b)&&b.toString()===a.toString())return b}return d}function c(a){return a instanceof Date?a:"string"==typeof a?new Date(a):d}a.feature("dataValidator",["core.common"]);var d=null,e=void 0,f=function(){function f(a){var b=this;b.condition=d,b.type=0,b.errorStyle=0,b.ignoreBlank=!0,b.inCellDropdown=!0,b.showInputMessage=!0,b.showErrorMessage=!0,b.inputTitle="",b.errorTitle="",b.inputMessage="",b.errorMessage="",b.comparisonOperator=d,b._init(),b.condition=a,b.condition&&(b.condition.ignoreBlank=b.ignoreBlank),b.type=7}return f.prototype.IgnoreBlank=function(a){var b=this;return arguments.length<=0?b.ignoreBlank:(b.ignoreBlank=a,b.condition&&(b.condition.ignoreBlank=a),b)},f.prototype._init=function(){var a=this;a.errorStyle=0,a.ignoreBlank=!0,a.inCellDropdown=!0,a.showInputMessage=!0,a.showErrorMessage=!0,a.inputTitle="",a.errorTitle="",a.inputMessage="",a.errorMessage="",a.comparisonOperator=6},f.prototype.value1=function(){var a=this,b=a.condition&&a.condition.item1?a.condition.item1:a.condition;return b?b.formula&&b.formula.length>0?"="+$.trim(b.formula.toString().toUpperCase()).replace("=",""):b.expected:d},f.prototype.value2=function(){var a=this,b=a.condition&&a.condition.item2?a.condition.item2:a.condition;return b?b.formula&&b.formula.length>0?"="+$.trim(b.formula.toString().toUpperCase()).replace("=",""):b.expected:d},f.prototype.isValid=function(a,f,g,h){var i=this;if(i.condition){if(i.IgnoreBlank(i.ignoreBlank),i.condition.ignoreBlank&&(h===e||h===d||""===h))return!0;var j,k=h;if(h!==e&&h!==d)switch(i.type){case 0:return!0;case 2:case 1:j=b(h),j!==e&&j!==d&&(k=j);break;case 4:case 5:j=c(h),j!==e&&j!==d&&(k=j);break;case 7:case 3:case 6:}return i.condition.evaluate(a,f,g,k,k)}return!0},f.prototype.reset=function(){this._init(),this.type=7,this.condition=d},f.prototype.getValidList=function(b,c,e){if(!a.features.conditionalFormat)return d;var f=this;return f.condition!=d&&3===f.type&&f.condition instanceof a.AreaCondition?f.condition.getValidList(b,c,e):d},f.prototype._isDefaultValue=function(a,b){switch(a){case"errorStyle":return 0===b;case"ignoreBlank":return b===!0;case"inCellDropdown":return b===!0;case"showInputMessage":return b===!0;case"showErrorMessage":return b===!0;case"inputTitle":return""===b;case"errorTitle":return""===b;case"inputMessage":return""===b;case"errorMessage":return""===b;case"comparisonOperator":return 6===b;case"type":return 0===b;case"condition":return b===d;default:return!1}},f.prototype.toJSON=function(){var a=this,b={errorStyle:a.errorStyle,ignoreBlank:a.ignoreBlank,inCellDropdown:a.inCellDropdown,showInputMessage:a.showInputMessage,showErrorMessage:a.showErrorMessage,inputTitle:a.inputTitle,errorTitle:a.errorTitle,inputMessage:a.inputMessage,errorMessage:a.errorMessage,comparisonOperator:a.comparisonOperator,type:a.type,condition:a.condition},c={};for(var d in b){var f=b[d];a._isDefaultValue(d,f)||(c[d]=f)}return $.isEmptyObject(c)?e:c},f.prototype.fromJSON=function(b){if(b){var c=this;if(a.features.conditionalFormat&&b.condition!==d&&b.condition!==e){var f=d,g=c._getConditionTypes(),h=g[b.condition.conType];h&&(f=new h,f.fromJSON(b.condition)),c.condition=f}b.type!==d&&b.type!==e&&(c.type=b.type),b.comparisonOperator!==d&&b.comparisonOperator!==e&&(c.comparisonOperator=b.comparisonOperator),b.errorStyle!==d&&b.errorStyle!==e&&(c.errorStyle=b.errorStyle),b.ignoreBlank!==d&&b.ignoreBlank!==e&&(c.ignoreBlank=b.ignoreBlank),b.inCellDropdown!==d&&b.inCellDropdown!==e&&(c.inCellDropdown=b.inCellDropdown),b.showInputMessage!==d&&b.showInputMessage!==e&&(c.showInputMessage=b.showInputMessage),b.showErrorMessage!==d&&b.showErrorMessage!==e&&(c.showErrorMessage=b.showErrorMessage),b.inputTitle!==d&&b.inputTitle!==e&&(c.inputTitle=b.inputTitle),b.errorTitle!==d&&b.errorTitle!==e&&(c.errorTitle=b.errorTitle),b.inputMessage!==d&&b.inputMessage!==e&&(c.inputMessage=b.inputMessage),b.errorMessage!==d&&b.errorMessage!==e&&(c.errorMessage=b.errorMessage)}},f.prototype._getConditionTypes=function(){if(!this._dict){var b={};b[0]=a.RelationCondition,b[1]=a.NumberCondition,b[2]=a.TextCondition,b[3]=a.ColorCondition,b[4]=a.FormulaCondition,b[5]=a.DateCondition,b[6]=a.DateExCondition,b[7]=a.TextLengthCondition,b[8]=a.Top10Condition,b[9]=a.UniqueCondition,b[10]=a.AverageCondition,b[11]=a.CellValueCondition,b[12]=a.AreaCondition,this._dict=b}return this._dict},f.getImageSrc=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},f.isFormula=function(a){return a&&"="===a[0]},f.createNumberValidator=function(b,c,e,g){if(!a.features.conditionalFormat)return d;{var h,i,j=f.isFormula(c)?c.replace("=",""):d,k=f.isFormula(c)?d:c,l=f.isFormula(e)?e.replace("=",""):d,m=f.isFormula(e)?d:e,n=d;a.ComparisonOperator,a.GeneralCompareType,a.RelationCompareType}switch(b){case 6:h=new a.NumberCondition(3,k,j),h.integerValue=g,i=new a.NumberCondition(5,m,l),i.integerValue=g,n=new a.RelationCondition(1,h,i);break;case 7:h=new a.NumberCondition(4,k,j),h.integerValue=g,i=new a.NumberCondition(2,m,l),i.integerValue=g,n=new a.RelationCondition(0,h,i);break;case 0:n=new a.NumberCondition(0,k,j),n.integerValue=g;break;case 1:n=new a.NumberCondition(1,k,j),n.integerValue=g;break;case 2:n=new a.NumberCondition(2,k,j),n.integerValue=g;break;case 3:n=new a.NumberCondition(3,k,j),n.integerValue=g;break;case 4:n=new a.NumberCondition(4,k,j),n.integerValue=g;break;case 5:n=new a.NumberCondition(5,k,j),n.integerValue=g}var o=new f(n);return o.type=g?1:2,o.comparisonOperator=b,o},f.createDateValidator=function(b,c,e){if(!a.features.conditionalFormat)return d;{var g,h,i=f.isFormula(c)?c.replace("=",""):d,j=f.isFormula(c)?d:c,k=f.isFormula(e)?e.replace("=",""):d,l=f.isFormula(e)?d:e,m=d;a.ComparisonOperator,a.DateCompareType,a.RelationCompareType}switch(b){case 6:g=new a.DateCondition(5,j,i),h=new a.DateCondition(3,l,k),m=new a.RelationCondition(1,g,h);break;case 7:g=new a.DateCondition(2,j,i),h=new a.DateCondition(4,l,k),m=new a.RelationCondition(0,g,h);break;case 0:m=new a.DateCondition(0,j,i);break;case 1:m=new a.DateCondition(1,j,i);break;case 2:m=new a.DateCondition(4,j,i);break;case 3:m=new a.DateCondition(5,j,i);break;case 4:m=new a.DateCondition(2,j,i);break;case 5:m=new a.DateCondition(3,j,i)}var n=new f(m);return n.type=4,n.comparisonOperator=b,n},f.createTextLengthValidator=function(b,c,e){if(!a.features.conditionalFormat)return d;{var g,h,i=f.isFormula(c)?c.replace("=",""):d,j=f.isFormula(c)?d:c,k=f.isFormula(e)?e.replace("=",""):d,l=f.isFormula(e)?d:e,m=d;a.ComparisonOperator,a.GeneralCompareType,a.RelationCompareType}switch(b){case 6:g=new a.TextLengthCondition(3,j,i),h=new a.TextLengthCondition(5,l,k),m=new a.RelationCondition(1,g,h);break;case 7:g=new a.TextLengthCondition(4,j,i),h=new a.TextLengthCondition(2,l,k),m=new a.RelationCondition(0,g,h);break;case 0:m=new a.TextLengthCondition(0,j,i);break;case 1:m=new a.TextLengthCondition(1,j,i);break;case 2:m=new a.TextLengthCondition(2,j,i);break;case 3:m=new a.TextLengthCondition(3,j,i);break;case 4:m=new a.TextLengthCondition(4,j,i);break;case 5:m=new a.TextLengthCondition(5,j,i)}var n=new f(m);return n.type=6,n.comparisonOperator=b,n},f.createFormulaValidator=function(b){if(!a.features.conditionalFormat)return d;var c=b;c&&"="===c.charAt(0)&&(c=c.substr(1));var e=new f(new a.FormulaCondition(4,c));return e.type=7,e},f.createFormulaListValidator=function(b){if(!a.features.conditionalFormat)return d;var c=new f(a.AreaCondition.fromFormula(b));return c.type=3,c},f.createListValidator=function(b){if(!a.features.conditionalFormat)return d;var c=new f(a.AreaCondition.fromSource(b));return c.type=3,c},f}();a.DefaultDataValidator=f}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("celltype",["core.common","core.sheet_action","core.basecelltype"]);var b="undefined",c=null,d=void 0,e=Math.max,f=Math.min,g=Math.floor,h=Math.round,i=window.document,j="position",k="absolute",l="margin",m="font",n="left",o="right",p="top",q="alphabetic",r="center",s="gcUIElement",t="none",u="0",v="#F6FAFB",w="#D2DBEB",x="#34B4E3",y="#A6F4FF",z=".gcEditingInput",A="keydown"+z,B="keyup"+z,C="mousedown"+z,D="mouseup"+z,E="mouseout"+z,F="mousemove"+z,G="click"+z,H="width",I="height",J="padding",K="hidden",L="overflow",M="resize",N="border",O="outline",P="box-shadow",Q="box-sizing",R="color",S="border-width",T="border-style",U="border-color",V="white-space",W="background-color",X="max-width",Y="max-height";!function(a){a[a.Text=0]="Text",a[a.Index=1]="Index",a[a.Value=2]="Value"}(a.EditorValueType||(a.EditorValueType={}));a.EditorValueType;!function(a){a[a.top=0]="top",a[a.bottom=1]="bottom",a[a.left=2]="left",a[a.right=3]="right"}(a.CheckBoxTextAlign||(a.CheckBoxTextAlign={}));a.CheckBoxTextAlign;!function(a){a[a.Blank=0]="Blank",a[a.Self=1]="Self",a[a.Parent=2]="Parent",a[a.Top=3]="Top"}(a.HyperLinkTargetType||(a.HyperLinkTargetType={}));var Z=(a.HyperLinkTargetType,function(b){function f(){b.call(this);var a=this;a.allowOverflow=!1,a._checkboxSize=12,a._caption="",a._textTrue="",a._textIndeterminate="",a._textFalse="",a._textAlign=3,a._isThreeState=!1}return __extends(f,b),f.prototype.paintValue=function(b,e,f,h,i,j,k,l){if(b){b.save(),b.rect(f,h,i,j),b.clip(),b.beginPath();var m=this,p=m._getDisplayText(e),s=0,t=0,u=l.sheet;if(u&&(s=u._getStringWidthByCanvas(p,k.font),t=u._getFontHeight(k.font),p)){var v=p.split(/\r\n|\r|\n/);t*=v.length}var w=m._checkboxSize/2,x=new a.Rect(++f,++h,--i,--j),y=parseInt((f+m._getCheckBoxLeft(k,x,s)).toString()),z=parseInt((h+m._getCheckBoxTop(k,x,t)).toString()),A=n,B=y+1;1===k.hAlign?(A=r,B+=w):2===k.hAlign&&(A=o,B+=2*w);var C=k.font;C&&b.font!==C&&(b.font=C),k.foreColor&&(b.fillStyle=k.foreColor);var D=k.textDecoration,E=l.fontInfo.fontSize,F=E>8?g((E-8)/5+2):1,G=t/2-E/2+F;b.textBaseline!==q&&(b.textBaseline=q),2===m._textAlign?(b.textAlign=o,b.fillText(p,y+1-2,z+w+t/2-G),D&&m._renderTextDecoration(b,D,y+1-2,z+w+t/2-G,s,E,F)):0===m._textAlign&&(b.textAlign=A,b.fillText(p,B,z-2-G),D&&m._renderTextDecoration(b,D,B,z-2-G,s,t)),b.strokeStyle="black",b.strokeRect(y+.5,z+.5,2*w+.05,2*w+.05),b.fillStyle="white",b.fillRect(y+1,z+1,2*w-1,2*w-1),!m._isThreeState||e!==c&&e!==d?!!e==!0&&(b.beginPath(),b.lineWidth=2.5,b.moveTo(y+3,z+w),b.lineTo(y+w,z+2*w-3.5),b.lineTo(y+2*w-1.5,z+3),b.stroke()):(b.beginPath(),b.fillStyle="green",b.rect(y+3,z+3,2*(w-2.5),2*(w-2.5)),b.fill()),k.foreColor&&(b.fillStyle=k.foreColor),3===m._textAlign?(b.textAlign=n,b.fillText(p,y+1+2*w+2,z+w+t/2-G),D&&m._renderTextDecoration(b,D,y+1+2*w+2,z+w+t/2-G,s,E,F)):1===m._textAlign&&(b.textAlign=A,b.fillText(p,B,z+2*w+2+t-G),D&&m._renderTextDecoration(b,D,B,z+2*w+2+t-G,s,E,F)),b.restore()}},f.prototype.focus=function(a){a&&a.focus()},f.prototype._formatEditorValue=function(a,b,c){return c},f.prototype._getCheckBoxLeft=function(a,b,c,d){var e=b.x-1,f=b.width+1,g=0,h=0,i=this;0===i._textAlign||1===i._textAlign?(h=e+5,1===a.hAlign?h=e+f/2-i._checkboxSize/2:2===a.hAlign&&(h=e+f-5-i._checkboxSize)):2===i._textAlign?(g=i._checkboxSize+c,h=e+5+c,1===a.hAlign?h=e+f/2-g/2+c:2===a.hAlign&&(h=e+f-5-g+c)):(g=i._checkboxSize+c,h=e+5,1===a.hAlign?h=e+f/2-g/2:2===a.hAlign&&(h=e+f-5-g));var j=h-e;return d&&$.browser.msie&&(j-=3),j},f.prototype._getCheckBoxTop=function(a,b,c,d){var e=b.y-1,f=b.height+1,g=0,h=0,i=this;0===i._textAlign?(g=i._checkboxSize+c,h=e+5+c,1===a.vAlign?h=e+f/2-g/2+c:2===a.vAlign&&(h=e+f-5-g+c)):1===i._textAlign?(g=i._checkboxSize+c,h=e+5,1===a.vAlign?h=e+f/2-g/2:2===a.vAlign&&(h=e+f-5-g)):(h=e+5,1===a.vAlign?h=e+f/2-i._checkboxSize/2:2===a.vAlign&&(h=e+f-5-i._checkboxSize));var j=h-e;return d&&$.browser.msie&&(j-=3),j},f.prototype.createEditorElement=function(){var a=i.createElement("div"),b=$(a);b.css(j,k).css(l,u).css(J,u).css(L,K).css(M,t).css(N,"2px #5292f7 solid").css(O,t).css(P,"1px 2px 5px rgba(0,0,0,0.4)").css(Q,"content-box").attr("tabindex",1).attr(s,"gcEditingInput");var c=$("<input/>");c.attr("type","checkbox"),b.append(c);var d=$("<span></span>");d.css(j,k).css(m,"normal 10pt Arial").css("cursor","default").css(V,"nowrap"),b.append(d);var e=$("<div></div>");return e.css(j,k).css(W,"green").css(H,2*(this._checkboxSize/2-2.5)).css(I,2*(this._checkboxSize/2-2.5)),b.append(e),a},f.prototype._getNextState=function(a){var b;return b=this._isThreeState?a===c||a===d?!1:!!a==!0?c:!0:!a},f.prototype.setEditorValue=function(a,b,e){if(a&&a.children[0]&&a.children[1]&&a.children[2]){var f=e&&e.sheet&&e.sheet._startEditByKeydown;f||(b=this._getNextState(b)),this._isThreeState?b===c||b===d?(a.children[0].checked=!1,$(a.children[2]).show()):(a.children[0].checked=!!b,$(a.children[2]).hide()):a.children[0].checked=!!b,$(a.children[1]).text(this._getDisplayText(b))}},f.prototype.getEditorValue=function(a){return a&&a.children[0]&&a.children[1]&&a.children[2]?this._isThreeState&&$(a.children[2]).is(":visible")?c:a.children[0].checked:c},f.prototype._triggerButtonClicked=function(b,c,d){var e=b.parent;e&&e._trigger(a.Events.ButtonClicked,{sheet:b,sheetName:b._name,row:c,col:d})},f.prototype.activateEditor=function(b,c,d,e){var f=b&&e&&e.sheet;if(f){var g=$(b),h=f._eventHandler._getCanvasOffset(),i=f._bounds;g.css(p,h.top+i.y+d.y-2).css(n,h.left+i.x+d.x-2).css(W,c.backColor?c.backColor:"white");var j=this;g.bind(C,function(b){a.util.cancelDefault(b)}),g.bind(D,function(){var a=j.getEditorValue(b,e);j.setEditorValue(b,a,e),j.updateEditor(b,c,d,e),j._triggerButtonClicked(f,f._activeRowIndex,f._activeColIndex)}),g.bind(A,function(b){return 32!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey?void(8!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||a.util.cancelDefault(b)):(j._isKeyDown=!0,a.util.cancelDefault(b),!1)}),g.bind(B,function(a){if(j._isKeyDown&&32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey){j._isKeyDown=!1;var g=j.getEditorValue(b,e);j.setEditorValue(b,g,e),j.updateEditor(b,c,d,e),j._triggerButtonClicked(f,f._activeRowIndex,f._activeColIndex)}}),b.children[0]&&$(b.children[0]).bind("click",function(b){a.util.cancelDefault(b)})}},f.prototype.updateEditor=function(a,b,d,e){var f=a&&e&&e.sheet;if(f){$(a).width(d.width).height(d.height);var g=$(a),h=f._render,i=f._eventHandler._getCanvasOffset(),j=f._bounds;g.css(p,i.top+j.y+d.y-2).css(n,i.left+j.x+d.x-2);var k=a.children[0],l=a.children[1],o=a.children[2];if(k&&l&&o){var q=$(l),r=q.text();b.foreColor&&q.css(R,b.foreColor);var s=c;s=b.font?b.font:h._getDefaultFont(),f._zoomFactor>1&&(s=h._getZoomFont(s)),q.css(m,s);var t=f._getStringWidth(r,s),u=f._getFontHeight(s);if(r){var v=r.split(/\r\n|\r|\n/);u*=v.length}var w=this,x=w._getCheckBoxLeft(b,d,t,!0),y=w._getCheckBoxTop(b,d,u,!0);$(k).css("margin-left",x).css("margin-top",y);var z=0,A=0;if(0===w._textAlign?(z=k.offsetLeft,1===b.hAlign?z=k.offsetLeft+w._checkboxSize/2-t/2:2===b.hAlign&&(z=k.offsetLeft+w._checkboxSize-t),A=k.offsetTop-u):1===w._textAlign?(z=k.offsetLeft,1===b.hAlign?z=k.offsetLeft+w._checkboxSize/2-t/2:2===b.hAlign&&(z=k.offsetLeft+w._checkboxSize-t),A=k.offsetTop+k.offsetHeight):2===w._textAlign?(z=k.offsetLeft-t-2,A=k.offsetTop+w._checkboxSize/2-u/2):(z=k.offsetLeft+k.offsetWidth+2,A=k.offsetTop+w._checkboxSize/2-u/2),$.browser.msie&&(z+=3,A+=3),q.css(n,z).css(p,A),w._isThreeState){var B=k.offsetLeft+(k.offsetWidth-o.offsetWidth)/2,C=k.offsetTop+(k.offsetHeight-o.offsetHeight)/2;$(o).css(n,B).css(p,C).toggle().toggle()}else $(o).hide();b.textDecoration&&w._setEditStatusTextDecoration(q,b.textDecoration)}}},f.prototype.caption=function(a){return 0===arguments.length?this._caption:(this._caption=a,this)},f.prototype.textTrue=function(a){return 0===arguments.length?this._textTrue:(this._textTrue=a,this)},f.prototype.textIndeterminate=function(a){return 0===arguments.length?this._textIndeterminate:(this._textIndeterminate=a,this)},f.prototype.textFalse=function(a){return 0===arguments.length?this._textFalse:(this._textFalse=a,this)},f.prototype._getDisplayText=function(a){var b=this;return!b._isThreeState||a!==c&&a!==d?!!a==!0?b._textTrue||b._caption:b._textFalse||b._caption:b._textIndeterminate||b._caption},f.prototype.textAlign=function(a){return 0===arguments.length?this._textAlign:(this._textAlign=a,this)},f.prototype.isThreeState=function(a){return 0===arguments.length?this._isThreeState:(this._isThreeState=a,this)},f.prototype.getHitInfo=function(a,b,e,f,g){if(g){var h=g.sheetArea;if(h===c||h===d||3===h)return{x:a,y:b,row:g.row,col:g.col,cellRect:f,sheetArea:h,isReservedLocation:!0,sheet:g.sheet}}return c},f.prototype.processMouseDown=function(a){return a?void(a.isReservedLocation&&(this._isMouseDownReservedLocation=!0)):!1},f.prototype.processMouseUp=function(b){if(!b)return!1;var c=this,d=b.sheet;if(c._isMouseDownReservedLocation&&d&&b.isReservedLocation){c._isMouseDownReservedLocation=!1;var e=b.row,f=b.col,g=b.sheetArea,h=d._getModel(g).getNode(e,f,!0);if(!h._isFirstMouseUp){var i=d.getValue(e,f,g),j=c._getNextState(i),k={row:e,col:f,newValue:j,autoFormat:!0},l=new a.UndoRedo.CellEditUndoAction(d,k);return d._doCommand(l),c._triggerButtonClicked(d,e,f),h._isFirstMouseUp=!0,h._mouseupToken=window.setTimeout(function(){delete h._isFirstMouseUp,h._mouseupToken&&(window.clearTimeout(h._mouseupToken),delete h._mouseupToken)},250),!0}delete h._isFirstMouseUp,h._mouseupToken&&(window.clearTimeout(h._mouseupToken),delete h._mouseupToken)}return!1},f.prototype.processMouseLeave=function(a){return a?void(this._isMouseDownReservedLocation=!1):!1},f.prototype.isReservedKey=function(a){return 32!==a.keyCode||a.ctrlKey||a.shiftKey||a.altKey?!1:!0},f.prototype.processKeyUp=function(b,c){var d=c.sheet;if(!d)return!1;var e=d.getActiveRowIndex(),f=d.getActiveColumnIndex(),g=d._getSheetArea(d.activeRowViewportIndex,d.activeColViewportIndex),h=d.getValue(e,f,g),i=this._getNextState(h),j={row:e,col:f,newValue:i,autoFormat:!0},k=new a.UndoRedo.CellEditUndoAction(d,j);return d._doCommand(k),this._triggerButtonClicked(d,e,f),!0},f.prototype._getAutoFitWidth=function(b,c,d,f,g,h){var i=this,j=a.CellTypeContext._getAutoFitWidth(b,c,i._getDisplayText(c),f,g,h);return 0===i._textAlign||1===i._textAlign?j=e(j,i._checkboxSize):j+=i._checkboxSize,j+5+2},f.prototype._getAutoFitHeight=function(b,c,d,f,g,h){var i=this,j=a.CellTypeContext._getAutoFitHeight(b,c,i._getDisplayText(c),f,g,h);return 0===i._textAlign||1===i._textAlign?j+=i._checkboxSize:j=e(j,i._checkboxSize),j+5},f.prototype._cancelDefaultKeydown=function(b){32!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||a.util.cancelDefault(b)},f.prototype.isImeAware=function(){return!1},f.prototype._isDefaultValue=function(a,b){switch(a){case"caption":return""===b;case"textTrue":return""===b;case"textIndeterminate":return""===b;case"textFalse":return""===b;case"textAlign":return 3===b;case"isThreeState":return b===!1;default:return!1}},f.prototype.toJSON=function(){var a=this,b={type:5,caption:a.caption(),textTrue:a.textTrue(),textIndeterminate:a.textIndeterminate(),textFalse:a.textFalse(),textAlign:a.textAlign(),isThreeState:a.isThreeState()},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},f.prototype.fromJSON=function(a){if(a){var b=this;a.caption&&b.caption(a.caption),a.textTrue&&b.textTrue(a.textTrue),a.textIndeterminate&&b.textIndeterminate(a.textIndeterminate),a.textFalse&&b.textFalse(a.textFalse),a.textAlign!==c&&a.textAlign!==d&&b.textAlign(a.textAlign),a.isThreeState!==c&&a.isThreeState!==d&&b.isThreeState(a.isThreeState)}},f}(a.TextCellType));a.CheckBoxCellType=Z;var _=function(b){function e(){b.call(this);var a=this;a.allowOverflow=!1,a._marginTop=2,a._marginRight=2,a._marginBottom=2,a._marginLeft=2,a._text="",a._buttonBackColor=c,a._buttonBorderColor="#707070",a._eventNameSpace=".buttonCellType"}return __extends(e,b),e.prototype.paintValue=function(a,c,d,e,f,g,h,i){if(a){var j=this,k=d+j._marginLeft,l=e+j._marginTop,m=f-j._marginLeft-j._marginRight,n=g-j._marginTop-j._marginBottom,o=k+m>d&&d+f>k&&l+n>e&&e+g>l;if(m-2>0&&n-2>0&&o){a.save(),(d>k||k+m>d+f||e>l||l+n>e+g)&&(a.rect(d,e,f,g),a.clip()),a.beginPath();var p=j._buttonBorderColor;p&&a.strokeStyle!==p&&(a.strokeStyle=p),a.strokeRect(k+.5,l+.5,m-1,n-1);var q=j._buttonBackColor;if(!q){var r=a.createLinearGradient(d+f/2,e,d+f/2,e+g);r.addColorStop(.125,v),r.addColorStop(1,w),q=r}a.fillStyle!==q&&(a.fillStyle=q),a.fillRect(k+1,l+1,m-2,n-2),a.restore(),j._text&&b.prototype.paintValue.call(this,a,j._text,k,l,m,n,h,i)}}},e.prototype.focus=function(a){a&&a.focus()},e.prototype._formatEditorValue=function(a,b,c){return c},e.prototype.createEditorElement=function(){var a=i.createElement("div"),b=$(a);b.css(j,k).css(l,u).css(J,u).css(L,K).css(M,t).css(N,"2px #5292f7 solid").css(O,t).css(P,"1px 2px 5px rgba(0,0,0,0.4)").css(Q,"content-box").css("user-select","none").attr("tabindex",1).attr(s,"gcEditingInput");var c=$("<div></div>");c.css(j,k).css(L,K).css(N,"1px "+this._buttonBorderColor+" solid"),b.append(c);var d=$("<span></span>");return d.css(j,k).css(V,"nowrap").css(m,"normal 10pt Arial").css("cursor","default"),c.append(d),a},e.prototype.setEditorValue=function(a){var b=a&&a.children[0]&&a.children[0].children[0];b&&$(b).html(this._text)},e.prototype.getEditorValue=function(a){return a?a._oldValue:c},e.prototype._triggerButtonClicked=function(b,c,d){var e=b.parent;e&&e._trigger(a.Events.ButtonClicked,{sheet:b,sheetName:b._name,row:c,col:d})},e.prototype._setButtonBackgroundColor=function(a,b){a.removeClass("gradientButton"),b?a.css(W,b):a.addClass("gradientButton")},e.prototype.activateEditor=function(b,c,d,e){var f=b&&e&&e.sheet;if(f){var g=$(b),h=f._eventHandler._getCanvasOffset(),i=f._bounds;g.css(p,h.top+i.y+d.y-2).css(n,h.left+i.x+d.x-2).css(W,c.backColor?c.backColor:"white");
var j=this,k=b.children[0];if(k){var l=$(k);g.bind(A,function(b){return 32!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey?void(8!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||a.util.cancelDefault(b)):(j._isKeyDown||j._setButtonBackgroundColor(l,x),j._isKeyDown=!0,a.util.cancelDefault(b),!1)}),g.bind(B,function(a){!j._isKeyDown||32!==a.keyCode||a.ctrlKey||a.shiftKey||a.altKey||(j._isKeyDown=!1,j._setButtonBackgroundColor(l,j._buttonBackColor),j._triggerButtonClicked(f,f._activeRowIndex,f._activeColIndex))}),l.bind(C,function(a){2!==a.button&&(j._isMouseDown=!0,j._setButtonBackgroundColor(l,x))}),l.bind(D,function(a){2!==a.button&&(j._isMouseDown=!1,j._setButtonBackgroundColor(l,y))}),l.bind(G,function(){j._triggerButtonClicked(f,f._activeRowIndex,f._activeColIndex)}),l.bind(F,function(){j._isMouseDown?j._setButtonBackgroundColor(l,x):j._setButtonBackgroundColor(l,y)}),l.bind(E,function(a){var b=a.relatedTarget;b!==k&&b!==k.children[0]&&j._setButtonBackgroundColor(l,j._buttonBackColor)})}}},e.prototype.updateEditor=function(a,b,d,e){var f=a&&e&&e.sheet;if(f){var g=$(a),h=f._render,i=f._eventHandler._getCanvasOffset(),j=f._bounds;g.css(p,i.top+j.y+d.y-2).css(n,i.left+j.x+d.x-2).width(d.width).height(d.height);var k=a.children[0];if(k){var l=this,o=$(k);o.width(d.width-l._marginLeft-l._marginRight).height(d.height-l._marginTop-l._marginBottom).css("margin-top",l._marginTop-1).css("margin-left",l._marginLeft-1),l._setButtonBackgroundColor(o,l._buttonBackColor);var q=k.children[0];if(q){var r=$(q);b.foreColor&&r.css(R,b.foreColor);var s=c;s=b.font?b.font:h._getDefaultFont(),f._zoomFactor>1&&(s=h._getZoomFont(s)),r.css(m,s);var t=f._getStringWidth(l._text,s),u=f._getFontHeight(s);if(l._text){var v=l._text.split(/\r\n|\r|\n/);u*=v.length}var w=0;1===b.vAlign?w=o.height()/2-u/2:2===b.vAlign&&(w=o.height()-u);var x=0;1===b.hAlign?x=o.width()/2-t/2:2===b.hAlign&&(x=o.width()-t),r.css(p,w).css(n,x),b.textDecoration&&l._setEditStatusTextDecoration(r,b.textDecoration)}}}},e.prototype.marginTop=function(a){return 0===arguments.length?this._marginTop:(this._marginTop=a,this)},e.prototype.marginRight=function(a){return 0===arguments.length?this._marginRight:(this._marginRight=a,this)},e.prototype.marginBottom=function(a){return 0===arguments.length?this._marginBottom:(this._marginBottom=a,this)},e.prototype.marginLeft=function(a){return 0===arguments.length?this._marginLeft:(this._marginLeft=a,this)},e.prototype.text=function(a){return 0===arguments.length?this._text:(this._text=a,this)},e.prototype.buttonBackColor=function(a){return 0===arguments.length?this._buttonBackColor:(this._buttonBackColor=a,this)},e.prototype.getHitInfo=function(a,b,e,f,g){var h=this;if(!g)return c;var i=g.sheetArea;if((i===c||i===d||3===i)&&f){var j=f.x+h._marginLeft,k=f.x+f.width-h._marginRight,l=f.y+h._marginTop,m=f.y+f.height-h._marginBottom,n={x:a,y:b,row:g.row,col:g.col,cellRect:f,sheetArea:i,sheet:g.sheet};return a>=j&&k>=a&&b>=l&&m>=b&&(n.isReservedLocation=!0),n}return c},e.prototype.processMouseDown=function(a){if(!a)return!1;var b=this,c=a.sheet;return c&&a.isReservedLocation&&!b._isMouseDownReservedLocation?(b._originButtonBackColor=b._buttonBackColor,b._isMouseDownReservedLocation=!0,b._buttonBackColor=x,c.repaint(a.cellRect),!0):!1},e.prototype.processMouseUp=function(a){if(!a)return!1;var b=this,c=a.sheet;if(b._isMouseDownReservedLocation&&c&&a.isReservedLocation){b._buttonBackColor=b._originButtonBackColor,c.repaint(a.cellRect),b._isMouseDownReservedLocation=!1;var d=a.row,e=a.col,f=a.sheetArea,g=c._getModel(f).getNode(d,e,!0);if(!g._isFirstMouseUp)return b._triggerButtonClicked(c,d,e),g._isFirstMouseUp=!0,g._mouseupToken=window.setTimeout(function(){delete g._isFirstMouseUp,g._mouseupToken&&(window.clearTimeout(g._mouseupToken),delete g._mouseupToken)},250),!0;delete g._isFirstMouseUp,g._mouseupToken&&(window.clearTimeout(g._mouseupToken),delete g._mouseupToken)}return!1},e.prototype.processMouseLeave=function(a){if(!a)return!1;var b=this,c=a.sheet;c&&b._isMouseDownReservedLocation&&(b._buttonBackColor=b._originButtonBackColor,c.repaint(a.cellRect),b._isMouseDownReservedLocation=!1)},e.prototype.processKeyDown=function(b,c){var d=c&&c.sheet;if(!d)return!1;var e=this;if(!e._isKeyPressed){var f=d.getActiveRowIndex(),g=d.getActiveColumnIndex(),h=d.getCellRect(f,g,d.activeRowViewportIndex,d.activeColViewportIndex);return e._originButtonBackColor=e._buttonBackColor,e._buttonBackColor=x,d.repaint(h),d._bind(a.Events.SelectionChanged+e._eventNameSpace,function(){d._unbind(a.Events.SelectionChanged+e._eventNameSpace),e._isKeyPressed=!1,e._buttonBackColor=e._originButtonBackColor,d.repaint(h)}),e._isKeyPressed=!0,!0}return!1},e.prototype.processKeyUp=function(b,c){var d=c.sheet;if(!d)return!1;var e=this;if(e._isKeyPressed){var f=d.getActiveRowIndex(),g=d.getActiveColumnIndex(),h=d.getCellRect(f,g,d.activeRowViewportIndex,d.activeColViewportIndex);return e._buttonBackColor=e._originButtonBackColor,d.repaint(h),d._unbind(a.Events.SelectionChanged+e._eventNameSpace),e._triggerButtonClicked(d,f,g),e._isKeyPressed=!1,!0}return!1},e.prototype.isReservedKey=function(a){return 32!==a.keyCode||a.ctrlKey||a.shiftKey||a.altKey?!1:!0},e.prototype._getAutoFitWidth=function(b,c,d,e,f,g){var h=this,i=a.CellTypeContext._getAutoFitWidth(b,c,h._text,e,f,g);return i+h._marginLeft+h._marginRight},e.prototype._getAutoFitHeight=function(b,c,d,e,f,g){var h=this,i=a.CellTypeContext._getAutoFitHeight(b,c,h._text,e,f,g);return i+h._marginTop+h._marginBottom},e.prototype._cancelDefaultKeydown=function(b){32!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||a.util.cancelDefault(b)},e.prototype.isImeAware=function(){return!1},e.prototype._isDefaultValue=function(a,b){switch(a){case"marginTop":return 2===b;case"marginRight":return 2===b;case"marginBottom":return 2===b;case"marginLeft":return 2===b;case"text":return""===b;case"buttonBackColor":return b===c;default:return!1}},e.prototype.toJSON=function(){var a=this,b={type:6,marginTop:a.marginTop(),marginRight:a.marginRight(),marginBottom:a.marginBottom(),marginLeft:a.marginLeft(),text:a.text(),buttonBackColor:a.buttonBackColor()},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(a){if(a){var b=this;a.marginTop!==c&&a.marginTop!==d&&b.marginTop(a.marginTop),a.marginRight!==c&&a.marginRight!==d&&b.marginRight(a.marginRight),a.marginBottom!==c&&a.marginBottom!==d&&b.marginBottom(a.marginBottom),a.marginLeft!==c&&a.marginLeft!==d&&b.marginLeft(a.marginLeft),a.text&&b.text(a.text),a.buttonBackColor&&b.buttonBackColor(a.buttonBackColor)}},e}(a.TextCellType);a.ButtonCellType=_;var ab=17,bb=20,cb=function(f){function g(){f.call(this);var a=this;a.allowOverflow=!1,a._editorValueType=0,a._items=c,a._autoFormatValue=!1,a._hasInPlaceEditor=!1}return __extends(g,f),g.prototype.getHitInfo=function(a,b,e,f,g){if(!g)return c;var h=g.sheetArea;if((h===c||h===d||3===h)&&f){var i=f.x+f.width,j={x:a,y:b,row:g.row,col:g.col,cellStyle:e,cellRect:f,sheetArea:h,isFocusAware:!0,isEditting:this._hasInPlaceEditor,sheet:g.sheet};return(this._hasInPlaceEditor||a>=i-ab&&i>a)&&(j.isReservedLocation=!0),j}return c},g.prototype.processMouseDown=function(a){a&&a.sheet&&a.isReservedLocation&&(this._dropDown?this._closeDropDown(a):this._openDropDown(a))},g.prototype.isReservedKey=function(a){if(this._hasInPlaceEditor){var b=a.ctrlKey||a.shiftKey||a.altKey;return b||13!==a.which&&27!==a.which&&9!==a.which&&37!==a.which&&39!==a.which?!0:!1}return!1},g.prototype.isEditting=function(){return this._hasInPlaceEditor},g.prototype._openDropDown=function(d,f){var g=d&&d.sheet;if(g){typeof f===b&&(f=bb);var h=g._render,j=d.row,k=d.col,l=d.cellRect,o=d.sheetArea,q=d.cellStyle,r=this,s=r.createEditorElement();r._dropDown=s;var u=$(s);i.body.insertBefore(s,c),u.hide();var v,w,x,y,z=a.util.device(),A=$.browser.safari&&(z.ipad||z.iphone),B=g._eventHandler._getCanvasOffset(),C=g._bounds;A?(v=B.top+C.y+l.y-1.5,w=B.left+C.x+l.x-1.5,x=l.width+3,y=l.height+3):(v=B.top+C.y+l.y+l.height,w=B.left+C.x+l.x,x=l.width,y="auto"),u.css(p,v).css(n,w).css(Q,"border-box").css(I,y).css(O,t),q.backColor&&u.css(W,q.backColor),q.foreColor&&u.css(R,q.foreColor);var D=q&&q.font?q.font:h._getDefaultFont();g._zoomFactor>1&&(D=h._getZoomFont(D)),u.css(m,D),r._renderItems(s,r._items);var E=s.length;E>f?u.prop("size",f):u.prop("size",e(2,E)),r.setEditorValue(s,g.getValue(j,k,o),d);var F=parseInt(u.css("width"));F>x&&(x=F),u.css(H,x),u.bind("keydown",function(b){b.ctrlKey||b.shiftKey||b.altKey||(27===b.which?r._closeDropDown(d,!0):13===b.which?r._closeDropDown(d):37===b.which?(b.preventDefault(),r._closeDropDown(d),a.SpreadActions.navigationLeft.apply(g)):39===b.which&&(b.preventDefault(),r._closeDropDown(d),a.SpreadActions.navigationRight.apply(g)))}),u.bind("click",function(a){("SELECT"===a.target.tagName||"OPTION"===a.target.tagName)&&r._closeDropDown(d)}),u.bind("blur",function(){r._closeDropDown(d)}),u.show(),u.focus(),r._hasInPlaceEditor=!0,g.repaint(l)}},g.prototype._closeDropDown=function(b,d){var e=this,f=b.sheet,g=b.row,h=b.col,j=b.cellRect;if($(e._dropDown).unbind("blur").unbind("click").unbind("keydown"),i.body.removeChild(e._dropDown),e._hasInPlaceEditor=!1,d)f.repaint(j);else{var k=e.getEditorValue(e._dropDown,b),l={row:g,col:h,newValue:k,autoFormat:e._autoFormatValue},m=new a.UndoRedo.CellEditUndoAction(f,l);f._doCommand(m)}e._dropDown=c},g.prototype.paintValue=function(a,b,c,d,g,h,i,j){var k=ab,l=e(0,g-k-1);3===i.hAlign&&(i.hAlign=0),i.wordWrap&&(i.wordWrap=!1),l>0&&h>0&&f.prototype.paintValue.call(this,a,b,c,d,l,h,i,j),a.save(),(k>g||k>h)&&(a.rect(c,d,g,h),a.clip()),a.beginPath(),this._hasInPlaceEditor&&j.sheet.getActiveRowIndex()===j.row&&j.sheet.getActiveColumnIndex()===j.col&&(a.beginPath(),a.rect(c+g-k-.5,d+1.5+.05,k-1,h-3+.05),a.fillStyle="#ddedfc",a.fill(),a.lineWidth=1,a.strokeStyle="#7eb4ea",a.stroke()),a.beginPath(),a.lineWidth=2,a.fillStyle="#000000",a.moveTo(c+g-k+4,d+(h-2)/2-2.5),a.lineTo(c+g-k+7,d+(h-2)/2+3.5),a.lineTo(c+g-k+10,d+(h-2)/2-2.5),a.fill(),a.restore()},g.prototype.createEditorElement=function(){var a=i.createElement("select");return $(a).css(j,k).css(l,u).css(W,"white").attr(s,"gcEditor"),a},g.prototype.setEditorValue=function(a,b){var e=this,f=e._items;if(a&&f){var g=a,h=f.length;if(0===e._editorValueType){for(var i=b!==d&&b!==c?b.toString().toLowerCase():c,j=-1,k=0;h>k;k++){var l=f[k],m=l&&l.hasOwnProperty("text")?l.text:l;if(m=m!==d&&m!==c?m.toString().toLowerCase():c,m===i){j=k;break}}g.selectedIndex=j}else if(1===e._editorValueType){var j=parseInt(b,10);g.selectedIndex=isNaN(j)?-1:j}else if(2===e._editorValueType){for(var j=-1,k=0;h>k;k++){var l=f[k];if(l&&l.hasOwnProperty("value")&&l.value===b){j=k;break}}g.selectedIndex=j}}},g.prototype.getEditorValue=function(a){var b=this,d=b._items;if(!a||!d)return c;var e=a.selectedIndex;if(e>=0){if(0===b._editorValueType){var f=d[e];return f&&f.hasOwnProperty("text")?f.text:f}if(1===b._editorValueType)return e;if(2===b._editorValueType){var f=d[e];if(f&&f.hasOwnProperty("value"))return f.value}}return c},g.prototype.activateEditor=function(b,c,d,e){var f=e&&e.sheet;if(f){var g=b,h=$(g),i=f._eventHandler._getCanvasOffset(),j=f._bounds;h.css(p,i.top+j.y+d.y-1).css(n,i.left+j.x+d.x-1).css(Q,"border-box").css(N,"1px solid black").css(O,t),this._renderItems(g,this._items),h.bind("keydown",function(b){8!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||a.util.cancelDefault(b),b.ctrlKey||b.shiftKey||b.altKey||f.isEditing()&&1===f.editorStatus()&&(37===b.which?(b.preventDefault(),f.endEdit(),a.SpreadActions.navigationLeft.apply(f)):39===b.which&&(b.preventDefault(),f.endEdit(),a.SpreadActions.navigationRight.apply(f)))}),this._hasInPlaceEditor=!0}},g.prototype.deactivateEditor=function(a,b){if(a){var c=a;$(c).unbind("keydown")}this._hasInPlaceEditor=!1,f.prototype.deactivateEditor.call(this,a,b),b&&b.sheet&&b.sheet.repaint()},g.prototype.updateEditor=function(a,b,c,d){var e=a&&d&&d.sheet;if(e){var f=a,g=e._render,h=$(f);if(c){var i=e._eventHandler._getCanvasOffset(),j=e._bounds;h.css(p,i.top+j.y+c.y-1).css(n,i.left+j.x+c.x-1)}if(b){b.backColor&&h.css(W,b.backColor),b.foreColor&&h.css(R,b.foreColor);var k=b.font?b.font:g._getDefaultFont();e._zoomFactor>1&&(k=g._getZoomFont(k)),h.css(m,k),b.textDecoration&&this._setEditStatusTextDecoration(h,b.textDecoration)}c&&h.css(H,c.width+1).css(I,c.height+1)}},g.prototype._formatEditorValue=function(a,b,c){return c},g.prototype.format=function(a,b,e){var g=this,h=g._editorValueType,i=g._items;if(i){var j=i.length;if(0===h);else if(1===h){var k=parseInt(a);if(k>=0&&j>k){var l=i[k];l!==d&&l!==c&&(a=l.hasOwnProperty("text")?l.text:l)}}else if(2===h)for(var m=0;j>m;m++){var l=i[m];if(l&&l.hasOwnProperty("value")&&l.value===a){a=l.hasOwnProperty("text")?l.text:l;break}}}return f.prototype.format.call(this,a,b,e)},g.prototype.parse=function(a,b){var c=this,d=c._editorValueType,e=c._items,g=f.prototype.parse.call(this,a,b);if(e){var h=e.length;if(0===d)return g;if(1===d)for(var i=0;h>i;i++){var j=e[i];if(j&&j.hasOwnProperty("text")&&j.text===g||j===g)return i}else if(2===d)for(var i=0;h>i;i++){var j=e[i];if(j&&j.hasOwnProperty("text")&&j.text===g||j===g)return j.value}}return g},g.prototype.editorValueType=function(a){return 0===arguments.length?this._editorValueType:(this._editorValueType=a,this)},g.prototype.items=function(a){return 0===arguments.length?this._items:(this._items=a,this)},g.prototype._renderItems=function(a,b){if(b&&a)for(var e=b.length,f=0;e>f;f++){var g=new window.Option,h=b[f];h!==d&&h!==c&&(g.text=h.hasOwnProperty("text")?h.text:h),a.add(g)}},g.prototype._getAutoFitWidth=function(b,c,d,e,f,g){var h=a.CellTypeContext._getAutoFitWidth(b,c,d,e,f,g);return h+ab},g.prototype._getAutoFitHeight=function(b,c,d,e,f,g){return a.CellTypeContext._getAutoFitHeight(b,c,d,e,f,g)},g.prototype.isImeAware=function(){return!1},g.prototype._isDefaultValue=function(a,b){switch(a){case"editorValueType":return 0===b;case"items":return b===c;default:return!1}},g.prototype.toJSON=function(){var a={type:7,editorValueType:this.editorValueType(),items:this.items()},b={};for(var c in a){var d=a[c];this._isDefaultValue(c,d)||(b[c]=d)}return b},g.prototype.fromJSON=function(a){a&&(a.editorValueType!==c&&a.editorValueType!==d&&this.editorValueType(a.editorValueType),a.items!==c&&a.items!==d&&this.items(a.items))},g}(a.TextCellType);a.ComboBoxCellType=cb;var db=function(b){function v(){b.call(this);var a=this;a.allowOverflow=!1,a._link="",a._linkColor="#0066cc",a._visitedLinkColor="#3399ff",a._text="",a._linkToolTip="",a._id=v._getUniqueId(),a._target=0}return __extends(v,b),v.prototype.paintValue=function(b,c,d,f,i,j,k,l){var m=this;if(!m._actived&&b){var p=m._text||c;if(p){p=p.replace(/\s+/g," ");var s=!1,t=l.sheet._getModel().getNode(l.row,l.col),u=t&&t.hyperlinkInfo;u&&(m._id===u.id?s=u.visited:delete t.hyperlinkInfo),b.save(),b.beginPath();var v;v=s?m._visitedLinkColor:m._linkColor,v&&b.fillStyle!==v&&(b.fillStyle=v);var w=k.font;w&&b.font!==w&&(b.font=w);var x=k.hAlign,y=k.vAlign,z=b.measureText(p).width,A=l.lineHeight,B=m._calcPosition(new a.Rect(d,f,i,j),z,A,x,y),C={x:d,y:f,width:i,height:j};(B.x+z>C.width||B.y+A>C.height)&&(b.rect(C.x,C.y,C.width,C.height),b.clip(),b.beginPath());var D=2,E=n;1===x?i-3>z&&(D=i/2,E=r):2===x&&i-3>z&&(D=i-2,E=o),b.textAlign!==E&&(b.textAlign=E);var F=$.browser.mozilla?5:2,G=q,H=l.fontInfo.fontSize,I=H>8?g((H-8)/5+2):1,J=A/2-H/2+I;F+=A-J,1===y?j>A&&(F=$.browser.mozilla?j/2+1:$.browser.msie?j/2+.5:j/2,g(F)!==F&&(F+=.5),F+=A/2-J):2===y&&(F=j-2.5-J),b.textBaseline!==G&&(b.textBaseline=G),b.fillText(p,d+D,f+F);var K=k.textDecoration;K&&m._renderTextDecoration(b,K,d+D,f+F,z,H,I);var L=d+B.x,M=L+z;2===x||(L+=1,M+=1);var N=f+B.y+A;2===k.vAlign&&(N-=.5),N-=e(0,h(A/9)-1),g(N)===N&&(N+=.5);var O=N;b.beginPath();var P=m._linkColor;s&&(P=m._visitedLinkColor),P&&b.strokeStyle!==P&&(b.strokeStyle=P),b.lineWidth=1,b.moveTo(L,N),b.lineTo(M,O),b.stroke(),b.restore()}}},v.prototype.createEditorElement=function(){var a=i.createElement("div"),b=$(a);b.css(l,u).css(J,u).css(N,t).css(j,k).css(L,K).css(Q,"content-box").css(V,"nowrap").attr(s,"gcEditor").attr("tabindex",1).css(O,t);var c;switch(this._target){case 0:c="_blank";break;case 1:c="_self";break;case 2:c="_parent";break;case 3:c="_top"}var d=i.createElement("a");return $(d).css(l,u).css(O,t).css("display","block").attr("target",c).appendTo(b),a},v.prototype._triggerButtonClicked=function(b,c,d){var e=b.parent;e&&(b._startEditByKeydown||e._trigger(a.Events.ButtonClicked,{sheet:b,sheetName:b._name,row:c,col:d}))},v.prototype.activateEditor=function(b,d,e,f){if(b&&e){var g=f&&f.sheet,h=$(b);if(h.css(W,d&&d.backColor||"white"),g){var m=g._eventHandler._getCanvasOffset(),o=g._bounds,q=m.top+o.y+e.y,r=m.left+o.x+e.x;h.css(p,q).css(n,r)}h.bind("keydown",function(b){8!==b.keyCode||b.ctrlKey||b.shiftKey||b.altKey||a.util.cancelDefault(b)});var t=this,v=h.children()[0];if(v){var w=$(v);w.bind("click",function(){if(w.css(R,t._visitedLinkColor),g){var a=g._activeRowIndex,b=g._activeColIndex,c=g._getModel().getNode(a,b,!0);c.hyperlinkInfo={id:t._id,visited:!0},t._triggerButtonClicked(g,a,b)}})}var x=i.createElement("div");$(x).css(l,u).css(j,k).css(L,K).css(Q,"content-box").attr(s,"gcEditingInput").css(S,"1px").css(T,"solid").css(W,"transparent"),i.body.insertBefore(x,c),t._clip=x,t._actived=!0}},v.prototype.deactivateEditor=function(a,c){if(this._clip&&i.body.removeChild(this._clip),a){$(a).unbind("keydown");var d=$(a).children()[0];d&&$(d).unbind("click")}b.prototype.deactivateEditor.call(this,a,c),this._actived=!1;var e=c&&c.sheet;e&&e.repaint()},v.prototype.updateEditor=function(a,b,d,e){if(a&&d){var f=this,g=e&&e.sheet,h=g&&g._render,i=a,j=$(i),k=j.children()[0];if(k){var l=$(k);f._link&&l.attr("href",f._link);var o=f._text||f._link;o&&l.text(o),l.attr("title",f._linkToolTip);var q=!1,r=g?g._getModel().getNode(g._activeRowIndex,g._activeColIndex):c;r&&r.hyperlinkInfo&&(f._id===r.hyperlinkInfo.id?q=r.hyperlinkInfo.visited:delete r.hyperlinkInfo),q?l.css(R,f._visitedLinkColor):l.css(R,f._linkColor);var s=b&&b.font?b.font:c;!s&&h&&(s=h._getDefaultFont()),h&&g._zoomFactor>1&&(s=h._getZoomFont(s)),s&&l.css(m,s)}if(b&&g){j.css(X,d.width-2),j.css(Y,d.height-2);var t=g._eventHandler._getCanvasOffset(),u=g._bounds,v=t.top+u.y+d.y,w=t.left+u.x+d.x,x=f._calcPosition(d,j.width(),j.height(),b.hAlign,b.vAlign);j.css(p,v+x.y).css(n,w+x.x),f._clip&&$(f._clip).css(p,v).css(n,w).height(d.height-3).width(d.width-3).css(U,b.backColor||"white"),b.textDecoration&&f._setEditStatusTextDecoration(j,b.textDecoration)}}},v.prototype.getEditorValue=function(){return this._link},v.prototype.setEditorValue=function(a,b){this._link=b},v.prototype._formatEditorValue=function(a,b,c){return c},v.prototype.getHitInfo=function(a,b,e,f,g){if(g){var h=g.sheetArea;if((h===c||h===d||3===h)&&e&&f)return{x:a,y:b,row:g.row,col:g.col,cellStyle:e,cellRect:f,sheetArea:h,isFocusAware:!0,sheet:g.sheet}}return c},v.prototype.processMouseDown=function(a){if(a){var b=a.sheet;b&&!b.isEditing()&&(a.isReservedLocation=this._isHitHyperlink(a,b)?!0:!1,a.isReservedLocation&&(this._isMouseDownLink=!0))}},v.prototype.processMouseUp=function(a){if(a){var b=a.sheet;if(b&&!b.isEditing()){var c=this;if(a.isReservedLocation=c._isHitHyperlink(a,b)?!0:!1,a.isReservedLocation&&c._isMouseDownLink){var d=b.getValue(a.row,a.col,a.sheetArea);if(d)switch(c._target){case 0:window.open(d,"_blank");break;case 1:window.open(d,"_self");break;case 2:window.open(d,"_parent");break;case 3:window.open(d,"_top")}var e=b._getModel(a.sheetArea).getNode(a.row,a.col,!0);e.hyperlinkInfo={id:c._id,visited:!0},b.repaint(a.cellRect),c._triggerButtonClicked(b,a.row,a.col)}c._isMouseDownLink=!1}}},v.prototype.processMouseMove=function(a){if(a){var b=a.sheet;if(b&&(!b.isEditing()||b.getActiveRowIndex()!==a.row||b.getActiveColumnIndex()!==a.col))if(a.isReservedLocation=this._isHitHyperlink(a,b)?!0:!1,a.isReservedLocation){this._showLinkToolTip(b,a);var c=b._getCanvas();if(c){var d=b.getValue(a.row,a.col,a.sheetArea);c.style.cursor=d?"pointer":"text"}}else{this._hideLinkToolTip();var c=b._getCanvas();c&&(c.style.cursor="default")}}},v.prototype.processMouseLeave=function(a){this._isMouseDownLink=!1,this._hideLinkToolTip();var b=a.sheet;if(b){var c=b._getCanvas();c&&(c.style.cursor="default")}},v.prototype._isHitHyperlink=function(a,b){var c=a.cellStyle,d=a.cellRect,e=b._render,g=a.x,h=a.y,i=this._text||this._link;if(i||(i=b.getValue(a.row,a.col,a.sheetArea)),!i)return!1;i=i.replace(/\s+/g," ");var j=c&&c.font?c.font:e._getDefaultFont();b._zoomFactor>1&&(j=e._getZoomFont(j));var k=this._getLinkRect(i,c.hAlign,c.vAlign,j,d),l=d.x+k.x,m=f(d.x+k.x+k.width,d.x+d.width),n=d.y+k.y,o=f(d.y+k.y+k.height,d.y+d.height);return g>=l&&m>g&&h>=n&&o>h?!0:!1},v.prototype._showLinkToolTip=function(a,b){if(this._linkToolTip){var d=this._getLinkToolTipElement(),e=$(d);e.text(this._linkToolTip);var f=a._eventHandler._getCanvasOffset(),g=f.left+b.x,h=f.top+b.y+20;0===e.parent().length&&(i.body.insertBefore(d,c),e.css(p,h).css(n,g))}},v.prototype._hideLinkToolTip=function(){this._linkToolTipElement&&(i.body.removeChild(this._linkToolTipElement),this._linkToolTipElement=c)},v.prototype._getLinkToolTipElement=function(){if(!this._linkToolTipElement){var a=i.createElement("div");a.className="gcHyperLinkCellTypeToolTip",$(a).css(j,k).css(l,u).css(J,2).css(N,"1px #c0c0c0 solid").css(P,"1px 2px 5px rgba(0,0,0,0.4)").css(Q,"content-box").css(W,"#ffffff").css(m,"9pt Arial"),this._linkToolTipElement=a}return this._linkToolTipElement},v.prototype._getLinkRect=function(a,b,c,d,e){var f=v._getEditorElement(),g=$(f),h=g.children()[0];if(h){var i=$(h);i.text(a?a:""),d&&i.css(m,d)}var j=g.width(),k=g.height(),l={x:0,y:0,width:j,height:k};if(e){var n=this._calcPosition(e,j,k,b,c);l.x=n.x,l.y=n.y}return l},v.prototype._calcPosition=function(a,b,c,d,f){var g=1,h=1,i=a.width-3,j=a.height-3;return 1===d?g+=e(0,(i-b)/2):2===d&&(g+=e(0,i-b)),1===f?h+=e(0,(j-c)/2):2===f&&(h+=e(0,j-c)),{x:g,y:h}},v.prototype.isReservedKey=function(a){return 32!==a.keyCode||a.ctrlKey||a.shiftKey||a.altKey?!1:!0},v.prototype.processKeyUp=function(a,b){var c=b.sheet;if(!c)return!1;var d=c.getActiveRowIndex(),e=c.getActiveColumnIndex(),f=c._getSheetArea(c.activeRowViewportIndex,c.activeColViewportIndex),g=c.getValue(d,e,f),h=c.getCellRect(d,e,c.activeRowViewportIndex,c.activeColViewportIndex);if(g)switch(g=g.toString(),this._target){case 0:window.open(g,"_blank");break;case 1:window.open(g,"_self");break;case 2:window.open(g,"_parent");break;case 3:window.open(g,"_top")}var i=c._getModel(f).getNode(d,e,!0);return i.hyperlinkInfo={id:this._id,visited:!0},c.repaint(h),this._triggerButtonClicked(c,d,e),!0},v.prototype.linkColor=function(a){return 0===arguments.length?this._linkColor:(this._linkColor=a,this)},v.prototype.visitedLinkColor=function(a){return 0===arguments.length?this._visitedLinkColor:(this._visitedLinkColor=a,this)},v.prototype.text=function(a){return 0===arguments.length?this._text:(this._text=a,this)},v.prototype.linkToolTip=function(a){return 0===arguments.length?this._linkToolTip:(this._linkToolTip=a,this)},v.prototype.target=function(a){return 0===arguments.length?this._target:(this._target=a,this)},v.prototype._getAutoFitWidth=function(a,b,c,d){var e=this,f=a._render,g=e._text||b,h=d&&d.font?d.font:f._getZoomFont(f._getDefaultFont()),i=e._getLinkRect(g,d.hAlign,d.vAlign,h);return i.width},v.prototype._getAutoFitHeight=function(a,b,c,d){var e=this._text||b,f=a._render,g=d&&d.font?d.font:f._getDefaultFont();a._zoomFactor>1&&(g=f._getZoomFont(g));var h=this._getLinkRect(e,d.hAlign,d.vAlign,g);return h.height},v.prototype.isImeAware=function(){return!1},v.prototype._isDefaultValue=function(a,b){switch(a){case"linkColor":return"#0066cc"===b;case"visitedLinkColor":return"#3399ff"===b;case"text":return""===b;case"linkToolTip":return""===b;case"target":return 0===b;default:return!1}},v.prototype.toJSON=function(){var a=this,b={type:8,linkColor:a._linkColor,visitedLinkColor:a._visitedLinkColor,text:a._text,linkToolTip:a._linkToolTip,target:a._target},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},v.prototype.fromJSON=function(a){if(a){var b=this;a.linkColor!==d&&a.linkColor!==c&&(b._linkColor=a.linkColor),a.visitedLinkColor!==d&&a.visitedLinkColor!==c&&(b._visitedLinkColor=a.visitedLinkColor),a.text!==d&&a.text!==c&&(b._text=a.text),a.linkToolTip!==d&&a.linkToolTip!==c&&(b._linkToolTip=a.linkToolTip),a.target!==d&&a.target!==c&&(b._target=a.target)}},v._getUniqueId=function(){var a=this;return(a._id===d||a._id===c)&&(a._id=0),"id_"+a._id++},v._getEditorElement=function(){var a=this;if(!a._editorElement){var b=v.prototype.createEditorElement(),d=b.style;i.body.insertBefore(b,c),d.visibility=K,d.top="-10000px",d.left="-10000px",b.className="gcHyperLinkCellTypeEditor",a._editorElement=b}return a._editorElement},v}(a.TextCellType);a.HyperLinkCellType=db;var eb=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.paint=function(b,c,d,e,f,g,h,i){if(b){a.CellTypeContext.paintBackground(b,d,e,f,g,h.backColor,h.backgroundImage,h.backgroundImageLayout,i.imageLoader);var j=a.CellTypeContext.paintConditionalFormats(b,c,d,e,f,g,h,i);i.showBarIconOnly=j,a.CellTypeContext.paintSparkline(b,d,e,f,g,i.sparkline);var k=a.CellTypeContext.paintSparklineEx(b,c,d,e,f,g,i.sheet);i.cellOverflowLayout||j||k||this.paintValue(b,c,d,e,f,g,h,i)}},c.prototype.createEditorElement=function(){},c.prototype.getEditorValue=function(){},c.prototype.setEditorValue=function(){},c.prototype.activateEditor=function(a,b,c,d){var e=a&&d&&d.sheet;if(e){var f=e._eventHandler;this.isImeAware(d)&&f._resetFocusHolder();var g=f._getCanvasOffset(),h=e._bounds,i=g.top+h.y+c.y-2,j=g.left+h.x+c.x-2;$(a).css("top",i).css("left",j)}},c.prototype.deactivateEditor=function(a){a&&a._editingLocator&&i.body.removeChild(a._editingLocator)},c.prototype.updateEditor=function(a,b,c){a&&$(a).width(c.width).height(c.height)},c.prototype.updateImeMode=function(a,c,d){b.prototype.updateImeMode.call(this,a,c,d)},c.prototype.getHitInfo=function(){},c.prototype.processMouseDown=function(){},c.prototype.processMouseMove=function(){},c.prototype.processMouseUp=function(){},c.prototype.processMouseEnter=function(){},c.prototype.processMouseLeave=function(){},c.prototype.isReservedKey=function(){return!1},c.prototype.processKeyDown=function(){return!1},c.prototype.processKeyUp=function(){return!1},c.prototype.isEditingValueChanged=function(a,b){return a!==b},c.prototype._getAutoFitWidth=function(a,b,c,d,e,g){var h=this.getAutoFitWidth(b,c,d,a._zoomFactor,g);if(e){var i=f(a._zoomFactor,1),j=parseInt((a.defaults.rowHeight*i).toString(),10);h+=j}return h},c.prototype._getAutoFitHeight=function(a,b,c,d,e,f){return this.getAutoFitHeight(b,c,d,a._zoomFactor,f)},c.prototype.getAutoFitWidth=function(){return 0},c.prototype.getAutoFitHeight=function(){return 0},c.prototype.isImeAware=function(){return!1},c}(a.BaseCellType);a.CustomCellType=eb}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("filter",["core.common","core.stringResource"]);var b=null,c=void 0,d=function(){function d(a){this.range=a,this.reset()}return d.prototype.setShowFilterButton=function(a){this.showFilterButton=a,this.sheet&&(this.sheet.invalidateLayout(),this.sheet.repaint())},d.prototype.getShowFilterButton=function(){return this.showFilterButton},d.prototype.addFilterItem=function(d,e){var f=this;if(e===c||e===b)throw new Error(a.SR.Exp_FilterItemIsNull);if(-1>d||d>=f.sheet.getColumnCount())throw new Error(a.SR.Exp_InvalidColumnIndex);if(f.range){var g=f.sheet._getActualRange(f.range);if(!(d<g.col||d>=g.col+g.colCount)){var h=f.filterItemMap[d];h||(h=[]),h.push(e),f.filterItemMap[d]=h}}},d.prototype.addAverageFilter=function(b,c){if(a.features.conditionalFormat){var d=new a.AverageCondition(c);this.addFilterItem(b,d)}},d.prototype.addBackgroundFilter=function(b,c){if(a.features.conditionalFormat){var d=new a.ColorCondition(0,c);this.addFilterItem(b,d)}},d.prototype.addDateFilter=function(b,c,d){if(a.features.conditionalFormat){var e=new a.DateCondition(c,d);this.addFilterItem(b,e)}},d.prototype.addForegroundFilter=function(b,c){if(a.features.conditionalFormat){var d=new a.ColorCondition(1,c);this.addFilterItem(b,d)}},d.prototype.addNumberFilter=function(b,c,d){if(a.features.conditionalFormat){var e=new a.NumberCondition(c,d);this.addFilterItem(b,e)}},d.prototype.addTextFilter=function(b,c,d){if(a.features.conditionalFormat){var e=new a.TextCondition(c,d);this.addFilterItem(b,e)}},d.prototype.addTop10Filter=function(b,c,d){if(a.features.conditionalFormat){var e=new a.Top10Condition(c,d);this.addFilterItem(b,e)}},d.prototype.removeFilterItems=function(a){this.filterItemMap[a]&&this.filterItemMap.splice(a,1,b),this.unfilter(a)},d.prototype.unfilter=function(a){var d=this;d.sheet&&d.sheet._bindToAutoRefresh(function(a){if(a!==b&&a!==c)d._unfilterColumn(a);else if(d.filteredColMap)for(var e=0;e<d.filteredColMap.length;e++)d._unfilterColumn(d.filteredColMap[e])})(a)},d.prototype._filterColumn=function(a){var b=this;b._unfilterColumn(a);var c,d;if(b.filterItemMap[a]){if(b.range&&-1!==b.range.col&&(a<b.range.col||a>b.range.col+b.range.colCount-1))return;var e=b.sheet.getRowCount();b.range&&(c=b.range.row,d=b.range.rowCount,-1===c&&(c=0,d=e));var f={};f=b._getRowDataCache(a,c,d);for(var g=0;e>g;g++)b.range&&(c>g||g>=c+d)?b._addRowFilteredIn(g):b.isRowFilteredOut(g)||b._filterRowByCell(g,a,f);b._setColumnFilteredState(a,!0)}},d.prototype._getRowDataCache=function(a,b,c){var d={},e=[];e=this._getItemType(a);for(var f,g=e.length,h=b;b+c>h;h++){for(var i={},j=0;g>j;j++){f=e[j];var k;switch(f){case"T":i[f]=this.sheet.getText(h,a);break;case"BC":k=this.sheet.getActualStyle(h,a),k&&(i[f]=k.backColor);break;case"FC":k=this.sheet.getActualStyle(h,a),k&&(i[f]=k.foreColor);break;case"V":i[f]=this.sheet.getValue(h,a)}}d[h]=i}return d},d.prototype._getItemType=function(b){for(var c=[],d=this.filterItemMap[b],e=d.length,f=0;e>f;f++){var g=d[f];"RelationCondition"===g.conditionType||g instanceof a.RelationCondition?(g.item1&&("TextCondition"===g.item1.conditionType||"TextLengthCondition"===g.item1.conditionType?-1===c.indexOf("T")&&c.push("T"):"ColorCondition"===g.item1.conditionType?0===g.item1.compareType?-1===c.indexOf("BC")&&c.push("BC"):1===g.item1.compareType&&-1===c.indexOf("FC")&&c.push("FC"):-1===c.indexOf("V")&&c.push("V")),g.item2&&("TextCondition"===g.item2.conditionType||"TextLengthCondition"===g.item2.conditionType?-1===c.indexOf("T")&&c.push("T"):"ColorCondition"===g.item2.conditionType?0===g.item2.compareType?-1===c.indexOf("BC")&&c.push("BC"):1===g.item2.compareType&&-1===c.indexOf("FC")&&c.push("FC"):-1===c.indexOf("V")&&c.push("V"))):"TextCondition"===g.conditionType||"TextLengthCondition"===g.conditionType?-1===c.indexOf("T")&&c.push("T"):"ColorCondition"===g.conditionType?0===g.compareType?-1===c.indexOf("BC")&&c.push("BC"):1===g.compareType&&-1===c.indexOf("FC")&&c.push("FC"):-1===c.indexOf("V")&&c.push("V")}return c},d.prototype.filter=function(a){var d=this;d.sheet&&d.sheet._bindToAutoRefresh(function(a){if(a!==b&&a!==c)d._filterColumn(a);else if(d.filterItemMap)for(var e=0;e<d.filterItemMap.length;e++)d.filterItemMap[e]&&d.filterItemMap[e].length>0&&d._filterColumn(e)})(a)},d.prototype.isHideRowFilter=function(){return!1},d.prototype.isFiltered=function(){return this.filteredColMap.length>0},d.prototype.isColumnFiltered=function(a){return this.filteredColMap.contains(a)},d.prototype.isRowFilteredOut=function(a){return this.isFiltered()?!this.filterInRows.contains(a):!1},d.prototype.reset=function(){var a=this;a.filterInRows=[],a.filterItemMap=[],a.filteredColMap=[],a.filteredItems=[],a.filteredInRowsWithColIndexs={},a.showFilterButton=!0,a.sortInfo=b},d.prototype.isFilterHeader=function(a,b,c){var d=this,e=!1;
if(d.range){var f=d.sheet._getActualRange(d.range,c);1===c&&a===d.sheet.getRowCount(c)-1&&f.row-1<0?b>=f.col&&b<f.col+f.colCount&&(e=!0):3===c&&a===f.row-1&&b>=f.col&&b<f.col+f.colCount&&(e=!0)}return e},d.prototype.isLastFilteredColumn=function(a){var b=this.filteredColMap.length;return b>0?this.filteredColMap[b-1]===a:!1},d.prototype.getFilterItems=function(a){var b=this.filterItemMap[a];return b||(b=[]),b},d.prototype.getFilteredItems=function(){return this.filteredItems},d.prototype.sortColumn=function(a,b){var c=this,d=c.sheet;d&&d._bindToAutoRefresh(function(a,b){var e=d._getActualRange(c.range),f=d.isPaintSuspended();d.isPaintSuspended(!0);var g=d.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:a,ascending:b}]);d.isPaintSuspended(f),g&&(c.sortInfo={index:a,ascending:b},c.isColumnFiltered(a)&&c.reFilter())})(a,b)},d.prototype.getSortState=function(a){var b=0;return this.sortInfo&&this.sortInfo.index===a&&(b=this.sortInfo.ascending?1:2),b},d.prototype.reFilter=function(){var a=this;if(a.filteredInRowsWithColIndexs={},(a.filteredItems||a.filteredItems.length>0)&&(a.filteredItems.length=0),a.filteredColMap||a.filteredColMap.length>0){var b=[];b=b.concat(a.filteredColMap),a.filteredColMap.length=0;for(var c=0;c<b.length;c++)a.filter(b[c])}},d.prototype._addRowFilteredIn=function(a){this.filterInRows.contains(a)||this.filterInRows.push(a)},d.prototype._addFilteredInRowsWithColumnIndex=function(a,d){var e=this.filteredInRowsWithColIndexs[a];e===c||e===b?e=[d]:(e.contains(d)&&e.remove(d),e.push(d)),this.filteredInRowsWithColIndexs[a]=e},d.prototype._addFilteredItem=function(a){this.filteredItems.contains(a)||this.filteredItems.push(a)},d.prototype._unfilterColumn=function(a){var b=this;if(b.range){var c,d=b.sheet._getActualRange(b.range);if(b.isColumnFiltered(a)){if(!(b.filteredColMap.length>1&&a===b.filteredColMap[0]))for(c=d.row;c<d.row+d.rowCount;c++){var e=b._isRowfilteredOutByColumn(c,a);e&&b._addRowFilteredIn(c)}b._setColumnFilteredState(a,!1),b._removeFilteredInRowsWithColumnIndex(a),b._removeFilteredItems(a)}else for(c=d.row;c<d.row+d.rowCount;c++){var f=b.isRowFilteredOut(c);f||b._addRowFilteredIn(c)}}},d.prototype._setColumnFilteredState=function(a,b){var c=this;if(b){if(c.filteredColMap.length>0){if(c.filteredColMap[c.filteredColMap.length-1]===a)return;c.filteredColMap.remove(a)}c.filteredColMap.push(a)}else c.filteredColMap.remove(a)},d.prototype._removeFilteredItems=function(a){var b=this;if(b.filterItemMap[a]){for(var c=[],d=[],e=0;e<b.filterItemMap.length;e++)e===a?c=c.concat(b.filterItemMap[e]):d=d.concat(b.filterItemMap[e]);for(var e=0;e<c.length;e++){var f=c[e];d.contains(f)||b.filteredItems.remove(f)}}},d.prototype._removeFilteredInRowsWithColumnIndex=function(a){for(var b in this.filteredInRowsWithColIndexs)if(b){var c=this.filteredInRowsWithColIndexs[b];c&&c.contains(a)&&c.remove(a)}},d.prototype._filterRowByCell=function(b,c,d){for(var e=this,f={},g=e.filterItemMap[c],h=0;h<g.length;h++){var i,j,k=g[h];if("RelationCondition"===k.conditionType||k instanceof a.RelationCondition?(k.item1&&(i=e._getActualValueFromCache(k.item1,b,c,d),"Top10Condition"===k.item1.conditionType||k.item1 instanceof a.Top10Condition?k.item1.ranges=e._getReviseRanges(c,e.range):("AverageCondition"===k.item1.conditionType||k.item1 instanceof a.AverageCondition)&&(k.item1.ranges=e._getReviseRanges(c,e.range))),k.item2&&(j=e._getActualValueFromCache(k.item2,b,c,d),"Top10Condition"===k.item2.conditionType||k.item2 instanceof a.Top10Condition?k.item2.ranges=e._getReviseRanges(c,e.range):("AverageCondition"===k.item2.conditionType||k.item2 instanceof a.AverageCondition)&&(k.item2.ranges=e._getReviseRanges(c,e.range)))):(i=e._getActualValueFromCache(k,b,c,d),"Top10Condition"===k.conditionType||k instanceof a.Top10Condition?k.ranges=e._getReviseRanges(c,e.range):("AverageCondition"===k.conditionType||k instanceof a.AverageCondition)&&(k.ranges=e._getReviseRanges(c,e.range))),k.evaluate(e.sheet,b,c,i,j)){e._addRowFilteredIn(b),e._addFilteredInRowsWithColumnIndex(b,c),e._addFilteredItem(k);break}f[b]||(e.filterInRows.remove(b),f[b]=!0)}},d.prototype._getActualValueFromCache=function(a,c,d,e){var f=b;return"TextCondition"===a.conditionType||"TextLengthCondition"===a.conditionType?f=e[c].T:"ColorCondition"===a.conditionType?0===a.compareType?f=e[c].BC:1===a.compareType&&(f=e[c].FC):f=e[c].V,f},d.prototype._getReviseRanges=function(b,c){var d=[];if(c){var e=this.sheet._getActualRange(c);e.col<=b&&b<e.col+e.colCount&&d.push(new a.Range(e.row,b,e.rowCount,1))}return d},d.prototype._getCandindateDataItems=function(a,b){var c=this,d=c.sheet,e=[],f={},g=d._getActualRange(c.range);if(a<g.col||a>g.col+g.colCount-1)return e;for(var h=!1,i=g.row;i<g.row+g.rowCount;i++){var j=d.getText(i,a);""!==j?f[j]||(c.isRowFilteredOut(i)&&(!c.isFiltered()||c.isLastFilteredColumn(a)&&c._isRowfilteredOutByColumn(i,a))?(e.push(j),f[j]=!0):d.getRowHeight(i,3)>0&&(e.push(j),f[j]=!0)):h=!0}return h&&b&&(b.hasBlank=!0),e},d.prototype._isRowfilteredOutByColumn=function(a,b){var c=this;if(0===c.filteredColMap.length)return!1;if(c.filteredInRowsWithColIndexs){var d=-1,e=c.filteredColMap.indexOf(b);e>0&&(d=c.filteredColMap[e-1]);var f=c.filteredInRowsWithColIndexs[a];return d>-1?f&&0!==f.length?d===f[f.length-1]:!1:1===c.filteredColMap.length?!f||0===f.length:!1}return!1},d.prototype._addRows=function(b,c){var d=this;if(d.range){var e=d.sheet.getRowCount()-c-1;if(d.range.row>-1){var f=d.range;e=f.row+f.rowCount-1,f.row>=b?d._setRangeInternal(new a.Range(f.row+c,f.col,f.rowCount,f.colCount)):f.row<b&&b<f.row+f.rowCount&&d._setRangeInternal(new a.Range(f.row,f.col,f.rowCount+c,f.colCount))}if(d.isFiltered()&&d.filterInRows)for(var g=d.filterInRows.length-1;g>=0;g--){var h=d.filterInRows[g];if(h>=b&&e>=h){var i=d.filterInRows[h],j=h+c;d.filterInRows[j]=i,d.filterInRows.remove(h)}}d.reFilter()}},d.prototype._addColumns=function(b,c){var d=this;if(d.range){var e;if(b>=0&&d._isSortted()){for(var f=0,g=0;c>g;g++)e=g+b,e<=d._sorttedColumn()&&f++;d._sorttedColumn(d._sorttedColumn()+f)}var h=-1,i=0,j=d.range;for(j.col>-1&&(j.col>=b?(h=d.range.col,d._setRangeInternal(new a.Range(j.row,j.col+c,j.rowCount,j.colCount)),i=d.range.colCount):j.col<b&&b<j.col+j.colCount&&(h=b,i=j.colCount-(b-j.col),d._setRangeInternal(new a.Range(j.row,j.col,j.rowCount,j.colCount+c)))),0>h&&(h=0,i=d.sheet.getColumnCount()-c),e=h+i-1;e>=h;e--)if(e>=b){var k=e+c,l=d.filteredColMap.indexOf(e);l>=0&&(d.filteredColMap[l]=k);var m=d.filterItemMap[e];m&&m.length>0&&(d.filterItemMap.remove(e),d.filterItemMap[k]=m)}d.reFilter()}},d.prototype._removeRows=function(d,e){var f=this;if(f.range){var g=0,h=f.sheet.getRowCount()+e-1;if(f.range.row>-1){var i=f.range;g=i.row,h=i.row+i.rowCount-1,i.row>=d?f._setRangeInternal(i.row===d+1?b:i.row+i.rowCount<=d+e?b:i.row<d+e?new a.Range(d,i.col,i.row+i.rowCount-(d+e),i.colCount):new a.Range(i.row-e,i.col,i.rowCount,i.colCount)):i.row<d&&d<i.row+i.rowCount&&f._setRangeInternal(new a.Range(i.row,i.col,i.rowCount-Math.min(i.row+i.rowCount-d,e),i.colCount))}if(f.isFiltered()&&f.filterInRows)for(var j=g;h>=j;j++)if(j>=d)if(d+e>j)f.filterInRows.remove(j);else{var k=j,l=f.filterInRows[k];if(l!==c&&l!==b){var m=k-e;f.filterInRows[m]=l,f.filterInRows.remove(k)}}f.reFilter()}},d.prototype._setRangeInternal=function(a){this.range=a},d.prototype._updateRange=function(a){var d=this,e=d.sheet,f=d.range;if(f)if(a)if(a.equals(f));else{var g=f.col,h=f.colCount,i=a.col,j=a.colCount;if(0>g&&0>i);else if(d.isFiltered()){0>g&&(g=0,h=e.getColumnCount()),0>i&&(i=0,j=e.getColumnCount());for(var k=0;h>k;k++){var l=g+k;l>=i&&i+j>l||d.removeFilterItems(l)}}var m=f.row,n=f.rowCount,o=a.row,p=a.rowCount;if(0>m&&0>o);else if(d.isFiltered()&&d.filteredInRowsWithColIndexs){0>m&&(m=0,n=e.getRowCount()),0>o&&(o=0,p=e.getRowCount());for(var k=0;n>k;k++){var q=m+k;q>=o&&o+p>q||(d.filteredInRowsWithColIndexs[q]=c)}}}else d.reset();else;d._isSortted()&&(a&&a.contains(-1,d._sorttedColumn())||(d.sortInfo=b)),d._setRangeInternal(a)},d.prototype._removeColumns=function(c,d){var e=this;if(e.range){c>=0&&e._isSortted()&&(c<=e._sorttedColumn()&&e._sorttedColumn()<c+d?e._sorttedColumn(-1):e._sorttedColumn()>=c&&e._sorttedColumn(e._sorttedColumn()-d));var f=e.range,g=f.col,h=f.colCount;0>g?(g=0,h=e.sheet.getColumnCount()+d):h=e.range.colCount;for(var i=c+d,j=g;g+h>j;j++)if(j>=c)if(i>j)e.removeFilterItems(j);else{var k=j-d,l=e.filteredColMap.indexOf(j);l>=0&&(e.filteredColMap[l]=k);var m=e.filterItemMap[j];m&&m.length>0&&(e.filterItemMap.remove(j),e.filterItemMap[k]=m)}f.col>=0&&(c<f.col?e._setRangeInternal(i<=f.col?new a.Range(f.row,f.col-d,f.rowCount,f.colCount):i<=f.col+f.colCount?new a.Range(f.row,c,f.rowCount,f.col+f.colCount-i):b):c<f.col+f.colCount&&e._setRangeInternal(i<=f.col+f.colCount?new a.Range(f.row,f.col,f.rowCount,f.colCount-d):new a.Range(f.row,f.col,f.rowCount,c-f.col))),e.reFilter()}},d.prototype._isSortted=function(){var a=this;return a.sortInfo?a.sortInfo.index>-1&&0!==a.getSortState(a.sortInfo.index):!1},d.prototype._sorttedColumn=function(a){var b=this;return 0===arguments.length?b.sortInfo?b.sortInfo.index:-1:(b.sortInfo?b.sortInfo.index=a:b.sortInfo={index:a,ascending:!1},b)},d.prototype._clear=function(b,c,d,e){var f=this;if(f.range){var g=new a.Range(b,c,d,e);if(f.showFilterButton){var h=f.range.row-1,i=f.range.rowCount+1;0>h&&(h=-1,i=-1),g.containsRange(new a.Range(h,f.range.col,i,f.range.colCount))&&f.unfilter()}else g.containsRange(f.range)&&f.unfilter()}},d.prototype._getConditionTypeDictionary=function(){if(!this._ruleTypeDictionary){var b={};b[0]=a.RelationCondition,b[1]=a.NumberCondition,b[2]=a.TextCondition,b[3]=a.ColorCondition,b[4]=a.FormulaCondition,b[5]=a.DateCondition,b[6]=a.DateExCondition,b[7]=a.TextLengthCondition,b[8]=a.Top10Condition,b[9]=a.UniqueCondition,b[10]=a.AverageCondition,b[11]=a.CellValueCondition,b[12]=a.AreaCondition,this._ruleTypeDictionary=b}return this._ruleTypeDictionary},d.prototype.fromJSON=function(d){if(d){var e=this;if(d.range){var f=d.range;e.range=new a.Range(f.row,f.col,f.rowCount,f.colCount)}if(a.features.conditionalFormat&&d.filterItemMap)for(var g=0;g<d.filterItemMap.length;g++){var h=d.filterItemMap[g].conditions;if(h)for(var i=0;i<h.length;i++){var j=h[i],k=b;if(j){var l=e._getConditionTypeDictionary(),m=l[j.conType];m&&(k=new m,k.fromJSON(j),e.addFilterItem(d.filterItemMap[g].index,k))}}}if(d.filteredColMap)for(var g=0;g<d.filteredColMap.length;g++){var n=d.filteredColMap[g];n!==c&&n!==b&&e._filterColumn(n)}d.sortInfo&&e.sortColumn(d.sortInfo.index,d.sortInfo.ascending),d.showFilterButton!==b&&d.showFilterButton!==c&&(e.showFilterButton=d.showFilterButton)}},d.prototype.toJSON=function(){for(var a=this,c=[],d=0,e=0;d<a.filterItemMap.length;d++){var f=a.filterItemMap[d];if(f){for(var g=[],h=0;h<f.length;h++){var i=f[h];g.push(i?i.toJSON():b)}c[e++]={index:d,conditions:g}}}var j={range:a.range,filterItemMap:c,filteredColMap:a.filteredColMap,sortInfo:a.sortInfo,showFilterButton:a.showFilterButton},k={};for(var l in j){var m=j[l];a._isDefaultValue(l,m)||(k[l]=m)}return k},d.prototype._isDefaultValue=function(a,c){switch(a){case"filterItemMap":return 0===c.length;case"filteredColMap":return 0===c.length;case"sortInfo":return c===b;case"showFilterButton":return c===!0;default:return!1}},d}();a.RowFilterBase=d;var e=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.isHideRowFilter=function(){return!0},b}(d);a.HideRowFilter=e;var f=function(a){function b(b){a.call(this),this._table=b,b&&(this.sheet=b._getSheet())}return __extends(b,a),b.prototype.table=function(a){return 0===arguments.length?this._table:(this._table=a,void(a&&(this.sheet=a._getSheet())))},b.prototype._addRows=function(b,c){a.prototype._addRows.call(this,b,c),this._table&&this._setRangeInternal(this._table.dataRange())},b.prototype._removeRows=function(b,c){a.prototype._removeRows.call(this,b,c),this._table&&this._setRangeInternal(this._table.dataRange())},b}(e);a._TableFilter=f}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("filter_ui",["core.common","core.stringResource","filter","core.spreadpanelex"]);var b=null,c="undefined",d="sortASC",e="sortDES",f="filterOK",g="filterCancel",h="filterSearch",i="filterCheckAll",j="filterUnCheckAll",k="filter-item",l="filter-item-container",m="filter-ui",n="filter-item-wrapper",o="filter-item-input",p="filter-item-text",q="filter-button",r="filter-sort",s="filter-check",t="filter-check-style",u="filter-check-outerDiv",v=".ui-filter-dialog",w="keydown"+v,x="keyup"+v,y="layout-table",z="filter-dialog-style",A="ui-state-hover",B="container-default-hover",C="no-user-select";!function(a){a[a.noSortFilter=0]="noSortFilter",a[a.ascend=1]="ascend",a[a.descend=2]="descend",a[a.filter=3]="filter",a[a.filterAscend=4]="filterAscend",a[a.filterDescend=5]="filterDescend",a[a.sortAscending=6]="sortAscending",a[a.sortDescending=7]="sortDescending",a[a.checkAll=8]="checkAll",a[a.unCheckAll=9]="unCheckAll"}(a._FilterButtonState||(a._FilterButtonState={}));var D=(a._FilterButtonState,function(){function a(a,b,c,d,e,f,g,h){var i=this;i.rowFilter=a,i.row=b,i.col=c,i.sheetArea=d,i.x=e,i.y=f,i.width=g,i.height=h}return a.prototype.getState=function(){var a=0,b=this.rowFilter;if(!b)return a;var c=b.getSortState(this.col);return b.isColumnFiltered(this.col)?0===c?a=3:1===c?a=4:2===c&&(a=5):0===c?a=0:1===c?a=1:2===c&&(a=2),a},a}());a._FilterButtonInfo=D;var E=function(a){function c(){a.call(this)}return __extends(c,a),c.prototype.find=function(a,c,d){for(var e,f=this.length,g=0;f>g;g++)if(e=this[g],e&&e.row===a&&e.col===c&&e.sheetArea===d)return e;return b},c}(a._XArray);a._FilterButtonInfoModel=E;var F=function(v){function D(a,b){v.call(this);var c=this;c._useWijmoTheme=!1,c.sheet=a,c.filterButtonInfo=b,c.init()}return __extends(D,v),D.prototype.init=function(){var a=this;a.defaultItemWidth=185,a._touchContainerWidth=257,a._touchContainerHeight=355,a.rEscape="/[-[]{}()*+?.,\\^$|#s]/g",a._itemValueCache=[],a._firstOpenCache=[],a.elementList=[],a.allItemsLength=-1,a.activeItemIndex=0,a.container=a.getContainer(),a._createTableLayout(),a._initFilterPanel()},D.prototype.open=function(){var b=this,e=b.sheet,f=e.parent;if(e){var g=f&&f.useTouchLayout?f.useTouchLayout():!1,h=f&&typeof f.useWijmoTheme!=c?f.useWijmoTheme:!1;b._initData(b.filterButtonInfo.col),b.container.appendTo(document.body),b.container.hide(),b.show("normal","fade",function(){$("#"+d).focus()}),g&&b._updateFilterPanel(b._touchContainerWidth,b._touchContainerHeight);var i=$(e._getCanvas()).offset(),j=b.container.width(),k=(b.container.height(),b.filterButtonInfo.x+b.filterButtonInfo.width-j),l=b.filterButtonInfo.y+b.filterButtonInfo.height;k+=i.left-6,l+=i.top,b.container.css({left:k,top:l}),b.resetDialogPosition(),b._initFirstOpenCache(),b._setItemWidth(),b.filterScrollPanel||(b.filterScrollPanel=new a.ScrollablePanel(b.itemList[0],b.itemsWrapper[0])),b.filterScrollPanel.refreshLayout(),b._updateItemWidth(),b._updateItemCache(),b._attachEvent(),b.useWijmoTheme(h),b.filterScrollPanel.useWijmoTheme(h)}},D.prototype._updateFilterPanel=function(a,b){var c=this,d=a-parseFloat(c.container.css("width")),e=b-parseFloat(c.container.css("height"));if(!(0>=d||0>=e)){c.container.css({width:a+"px",height:b+"px"});var g=parseFloat($("."+r).css("padding-top"))+e/30;$("."+r).css("padding",g+"px 6px");var i=$("."+k),m=parseFloat(i.css("height"))+e/4;i.css("height",m+"px");var n=$("."+o),s=$("."+p),t=parseFloat(n.css("height")),v=parseFloat(n.css("margin-top")),w=(m-t)/2;n.css("margin-top",w+"px");var x=parseFloat(s.css("top"))+w-v;s.css("top",x+"px");var y=parseFloat($("."+l).css("height")),z=parseFloat($("."+l).css("width")),A=y+d,B=z+e/2;$("."+l).css({width:B+"px",height:A+"px"}),c.defaultItemWidth=B-5;var C=$("."+q),D=parseFloat(C.css("width"))+d/4,E=parseFloat(C.css("height"))+e/8;C.css({width:D+"px",height:E+"px"});var F=$("#"+f),G=parseFloat(F.css("margin-left"))+d/2;F.css("margin-left",G+"px");var H=$("#"+h),I=parseFloat(H.css("width"))+d,J=parseFloat(H.css("height"))+e/8;H.css({height:J+"px",width:I+"px"});var K=$("."+u),L=parseFloat(K.css("margin-top"))+e/10;K.css("margin-top",L+"px");var M=$("#"+j),N=parseFloat(M.css("margin-left"))+d;$("#"+j).css("margin-left",N+"px")}},D.prototype.close=function(){v.prototype.close.call(this),this.sheet&&this.sheet.setFocus()},D.prototype.useWijmoTheme=function(a){var d=this;if(typeof a===c)return d._useWijmoTheme;if("boolean"==typeof a&&d._useWijmoTheme!==a){v.prototype.useWijmoTheme.call(this,a);var e=$("."+s),f=$("."+q),g=$("."+r),h=$("."+k),l=$("#"+i),m=$("#"+j),n=$(".sort-container"),o=$("."+y);return a?(d.container.removeClass(z),d.searchOuterDiv.removeClass("container-default-header"),f.removeClass("container-default-state"),e.removeClass(t),d.searchOuterDiv.addClass("ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix"),g.addClass("ui-corner-all"),h.addClass("ui-corner-all"),f.addClass("ui-button ui-state-default ui-corner-all"),l.find("span:eq(0)").addClass("ui-icon ui-icon-check"),m.find("span:eq(0)").addClass("ui-icon ui-icon-closethick"),o.addClass("ui-menu"),n.addClass("ui-menu-item")):(d.searchOuterDiv.remove("ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix"),g.removeClass("ui-corner-all"),h.removeClass("ui-corner-all"),f.removeClass("ui-button ui-state-default ui-corner-all"),l.find("span:eq(0)").removeClass("ui-icon ui-icon-check"),m.find("span:eq(0)").removeClass("ui-icon ui-icon-closethick"),o.removeClass("ui-menu"),n.removeClass("ui-menu-item"),d.container.addClass(z),e.addClass(t),d.searchOuterDiv.addClass("container-default-header"),f.addClass("container-default-state")),d}return b},D.prototype._initFilterPanel=function(){var b=this,c=b._getSortLink(d,a.SR.SortAscending).css("margin-top","6px"),k=b._getSortLink(e,a.SR.SortDescending);b.table.find("tr:eq(0) td:eq(0)").append($("<img>").attr("src",D.getImageSrc(6))),b.table.find("tr:eq(1) td:eq(0)").append($("<img>").attr("src",D.getImageSrc(7))),b.table.find("tr:eq(0) td:eq(1)").append(c),b.table.find("tr:eq(1) td:eq(1)").append(k),b.elementList.push(c[0]),b.elementList.push(k[0]),b.searchOuterDiv=$("<div>").addClass("search-outer-div container-default-header");var m=$("<div>").appendTo(b.searchOuterDiv),n=$("<input>").attr({type:"search",placeholder:a.SR.Search,id:h}).appendTo(m);b.elementList.push(n[0]);var o=$("<div>").appendTo(b.searchOuterDiv).addClass("filter-check-outerDiv"),p=b._getCheckLink(i,a.SR.CheckAll,"check-image"),r=b._getCheckLink(j,a.SR.UncheckAll,"uncheck-image");o.append(p).append(r),b.table.find("tr:eq(2) td:eq(1)").append(b.searchOuterDiv),b.itemList=$("<div>").addClass(l),b.table.find("tr:eq(3) td:eq(1)").append(b.itemList);var s=$("<button>").text(a.SR.OK).addClass(q+" container-default-state").attr({id:f}),t=$("<button>").text(a.SR.Cancel).addClass(q+" container-default-state").attr({id:g});b.table.find("tr:eq(4) td:eq(1)").append(s),b.table.find("tr:eq(4) td:eq(1)").append(t),b.elementList.push(s[0]),b.elementList.push(t[0])},D.prototype._createTableLayout=function(){var a=this,b=5,c=3;a.table=$("<table>").css({padding:0,display:"table"}).attr({cellspacing:0,cellpadding:0}).addClass(y);for(var d=0;b>d;d++){for(var e=$("<tr>"),f=0;c>f;f++){$("<td>").appendTo(e)}e.appendTo(a.table)}a.table.appendTo(a.container),$(a.table).find("tr").each(function(){$("td:eq(0)",this).addClass("layout-table-first-column"),$("td:eq(2)",this).addClass("layout-table-last-column")}),$(a.table).find("tr:eq(1) td:eq(1)").addClass("filter-sort-desc-container sort-container"),$(a.table).find("tr:eq(0) td:eq(1)").addClass("filter-sort-asc-container sort-container"),a.container.css({"box-shadow":"rgba(0, 0, 0, 0.4) 2px 4px 5px",padding:"2px"}).addClass(z+" "+m+" "+C)},D.prototype._updateItemCache=function(){var a=$("."+l),b=a.find("input");this._itemValueCache=[];var c=this;b.each(function(){c._itemValueCache.push($(this).val().toLowerCase())})},D.prototype._stopBubble=function(a){return a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0,!1},D.prototype._attachEvent=function(){var l=this;$("#"+d).bind({mouseup:function(b){l._sortByUser(!0),l.close(),a.util.cancelDefault(b)},mousedown:function(b){a.util.cancelDefault(b)}}),$("#"+e).bind({mouseup:function(b){l._sortByUser(!1),l.close(),a.util.cancelDefault(b)},mousedown:function(b){a.util.cancelDefault(b)}}),$("."+r).hover(function(){var a="filter-hover "+(l._useWijmoTheme?A:B),b=$(".filter-hover");b.removeClass(A+" "+B),$(this).addClass(a)},function(){var a="filter-hover "+(l._useWijmoTheme?A:B);$(this).removeClass(a)}),$("#"+i).bind({mousedown:function(b){a.util.cancelDefault(b)},mouseup:function(b){var c=$("."+k).find("input:visible");c.prop("checked",!0),l._setButtonState(),a.util.cancelDefault(b)}}),$("#"+j).bind({mousedown:function(b){a.util.cancelDefault(b)},mouseup:function(b){var c=$("."+k).find("input:visible");c.prop("checked",!1),l._setButtonState(),a.util.cancelDefault(b)}}),$("."+k).bind({mouseenter:function(){var a="filter-hover "+(l._useWijmoTheme?A:B),b=$(".filter-hover");b.removeClass(A+" "+B),$(this).addClass(a)},mouseleave:function(){var a="filter-hover "+(l._useWijmoTheme?A:B);$(this).removeClass(a)},click:function(){$(this).find("input").trigger("click")}}),$("."+k).find("input").bind("click",function(a){l._stopBubble(a),l._setButtonState();var b=$(this).parents("div."+k).get(0);l._updateActiveItemIndex(b)}),$("#"+h).bind({keydown:function(a){var b=a.which||a.keyCode;13===b&&a.preventDefault()},keyup:function(a){switch(a.keyCode){case 9:case 37:case 38:case 39:case 40:return;default:l._handler.call(l,a),l._setItemWidth(),l.filterScrollPanel.refreshLayout(),l._updateItemWidth(),l._setButtonState()}},search:function(a){l._handler.call(l,a),l._setItemWidth(),l.filterScrollPanel.refreshLayout(),l._updateItemWidth(),l._setButtonState()}}),$("."+q).hover(function(){var a=$(".filter-button-hover"),b="filter-button-hover "+(l._useWijmoTheme?A:B);a.removeClass(A+" "+B),$(this).addClass(b)},function(){var a="filter-button-hover "+(l._useWijmoTheme?A:B);$(this).removeClass(a)}),$("#"+f).bind("click",function(){var a=l._getCheckedValuesByUser();l._updateData(a),l._filter(a),l.close()}),$("#"+g).bind("click",function(){l.close()}),$(l.container).bind("mousewheel",function(b){a.util.cancelDefault(b)}),$(l.container).bind(w,function(h){var i=h.which||h.keyCode;if(27===i||13===i||38===i||40===i||9===i){var j=b;if(j=$(l._useWijmoTheme?"."+A:"."+B),27===i)return l.close(),a.util.cancelDefault(h),!1;if(13===i){if(1!==j.length)return;var m=j.attr("id");if(m===d)l._sortByUser(!0),l.close();else if(m===e)l._sortByUser(!1),l.close();else if(m===f){var n=l._getCheckedValuesByUser();l._updateData(n),l._filter(n),l.close()}else if(m===g)l.close();else{var o=$(j).find("input");o.length>0&&o.trigger("click"),l._updateActiveItemIndex(j[0])}}if(38===i||40===i||9===i){var p,q=l.itemList.find("div."+k);if(0===j.length)p=l.elementList[0];else{j.removeClass(A+" "+B);for(var r=l.elementList.concat([]),s=0;s<q.length;s++)r.splice(-2,0,q[s]);var t=!0;if(9===i){h.shiftKey&&(t=!1);var u=l.elementList.concat([]);u.splice(-2,0,q[l.activeItemIndex]);var v=$.inArray(j[0],q);if(t){if(v>=0){var w=$(l.elementList[3]);p=l._ignoreElement(w)?l.elementList[4]:l.elementList[3]}else if(v=$.inArray(j[0],u),v>=0){var x=u.length;for(p=u[v+1];l._ignoreElement($(p))&&x>v;)p=u[v+1],v++}}else{if(v>=0)p=l.elementList[2];else if(v=$.inArray(j[0],u),v>=0)for(p=u[v-1];v>0&&l._ignoreElement($(p));)p=u[v-1],v--;typeof p===c&&(p=u[u.length-1])}typeof p===c&&(p=u[0])}else{var y=$.inArray(j[0],r),z=r.length;if(y>=0){if(40===i)for(p=r[y+1],-1!==$.inArray(p,q)&&-1===$.inArray(j[0],q)&&(y+=l.activeItemIndex,p=r[y+1]);z>y&&l._ignoreElement($(p));)p=r[y+1],y++;else{for(p=r[y-1],-1!==$.inArray(p,q)&&-1===$.inArray(j[0],q)&&(y=l.activeItemIndex+3,p=r[y]);y>0&&l._ignoreElement($(p));)p=r[y-1],y--;typeof p===c&&(p=r[r.length-1])}typeof p===c&&(p=r[0])}}}j=$(p);var C=$.inArray(p,q);C>=0?(l.activeItemIndex=C,l.filterScrollPanel.scrollChildIntoView(p),j.find("input").focus()):j.focus(),j.addClass(l._useWijmoTheme?"filter-hover "+A:"filter-hover "+B),a.util.cancelDefault(h)}}}),$(l.container).bind(x,function(b){a.util.cancelDefault(b)})},D.prototype._updateActiveItemIndex=function(a){var b=this.itemList.find("div."+k);if(0!==b.length){var c=$.inArray(a,b);c>=0&&(this.activeItemIndex=c)}},D.prototype._setFocusBack=function(){this.sheet&&this.sheet.setFocus()},D.prototype._ignoreElement=function(a){return 0===a.length?!1:a.hasClass("ui-button-disabled")||a.hasClass(" ui-state-disabled")||a.hasClass("filter-button-disable")?!0:a.is(":visible")?!1:!0},D.prototype._updateItemPanel=function(){var a=$("."+k),b=a.find("input");b.prop("checked",!1),a.show()},D.prototype._filter=function(b){var c=this,d=c.sheet;if(d){var e=d.isPaintSuspended();try{d.isPaintSuspended(!0);var f=c.filterButtonInfo.rowFilter;if(!f)return;b&&b.length>0&&d._trigger(a.Events.RangeFiltering,{sheet:d,sheetName:d._name,col:c.filterButtonInfo.col,filterValues:b}),f.filter(c.filterButtonInfo.col),b&&b.length>0&&d._trigger(a.Events.RangeFiltered,{sheet:d,sheetName:d._name,col:c.filterButtonInfo.col,filterValues:b})}finally{d.isPaintSuspended(e)}}},D.prototype._updateData=function(c){var d=this.filterButtonInfo.col,e=this.filterButtonInfo.rowFilter;if(e&&a.features.conditionalFormat){e.unfilter(d),e.removeFilterItems(d);for(var f=0;f<c.length;f++){var g=c[f];g===a.SR.Blanks&&(g="");var h=new a.TextCondition(0,g,b);e.addFilterItem(d,h)}}},D.prototype._getCheckedValuesByUser=function(){var a=[],b=$("."+l),c=b.find("input");return c.each(function(){$(this).prop("checked")&&a.push($(this).val())}),this.allItemsLength===a.length&&(a=[]),a},D.prototype._handler=function(){var a=$("#"+h),b=$.trim(a.val().toLowerCase()),c=$("."+l),d=c.find("input"),e=d.parent();if(b){e.hide(),d.prop("checked",!1);var f=new RegExp(b.replace(this.rEscape,"\\$&"),"gi");$.map(this._itemValueCache,function(a,b){if(-1!==a.search(f)){e.eq(b).show();var c=d.get(b);return $(c).prop("checked",!0),c}})}else if(e.show(),this._firstOpenCache&&0!==this._firstOpenCache.length){d.prop("checked",!1);var g=this;$.each(d,function(a,b){var c=b;-1!==$.inArray(c.value,g._firstOpenCache)&&$(c).prop("checked",!0)})}else this._initFirstOpenCache()},D.prototype._getSortLink=function(a,b,c){var d=$("<a>");return d.attr({id:a,href:"javascript:void(0)"}).text(b).addClass(r).css({display:"block",padding:"5px 6px",cursor:"default",margin:"2px 0px 1px 2px","text-decoration":"none",outline:"none"}),c&&(d.click=c),d},D.prototype._getCheckLink=function(a,b,c,d){var e=$("<span>").addClass("check-uncheck-all "+c),f=$("<span>").text(b),g=$("<a>");return g.attr({href:"javascript:void(0)",id:a}).css({"float":"left","margin-left":"7px"}).addClass(s+" "+t).append(e).append(f),d&&(g.click=d),g},D.prototype._initData=function(a){var b=this,c=b.filterButtonInfo.rowFilter;if(c){var d=b._getAllData(a);d.sort(function(a,b){return a>b?1:b>a?-1:0}),b._bindData(d);var e=[];e=c.isColumnFiltered(a)?b._getCheckedData(a):d;var f=b._getActualValues(d,e);b._setCheckedValues(f)}},D.prototype._getAllData=function(b){var c=[],d=this.filterButtonInfo.rowFilter;if(!d)return c;var e,f=this.sheet;if(f&&(e=f._getActualRange(d.range)),b<e.col||b>e.col+e.colCount-1)return c;var g={hasBlank:!1};return c=d._getCandindateDataItems(b,g),g.hasBlank&&c.push(a.SR.Blanks),c},D.prototype._bindData=function(a){var b=this,c=document.createElement("div");c.className=n;for(var d=a.length,e=0;d>e;e++){var f=a[e],g=document.createElement("div");g.className=k,c.appendChild(g);var h=document.createElement("input");h.className=o,h.setAttribute("type","checkbox"),h.setAttribute("value",f),h.setAttribute("title",f),g.appendChild(h);var i=document.createElement("span");i.className=p,i.innerHTML=f,g.appendChild(i)}b.itemList.empty(),b.allItemsLength=d,b.itemsWrapper=$(c),$(b.itemsWrapper).appendTo(b.itemList)},D.prototype._setItemWidth=function(){var a=$("."+p),b=$("."+k),c=$("."+o),d=parseFloat(b.css("border-width")),e=parseFloat(c.css("margin-left")),f=parseFloat(c.css("margin-right")),g=0;isNaN(d)&&(d=0),isNaN(e)&&(e=0),isNaN(f)&&(f=0);for(var h=0;h<a.length;h++){var i=$(a[h]).width();i>g&&(g=i)}var j=g+c.width()+e+f+2*d;b.css("width",j)},D.prototype._updateItemWidth=function(){var a=this,b=a.filterScrollPanel;if(b){var c,d=b.showVerticalScrollbar(),e=b.showHorizontalScrollbar();c=e?$(a.itemsWrapper).width():d?a.defaultItemWidth-b._defaultScrollbarSize:a.defaultItemWidth,$("."+k).css("width",c)}},D.prototype._getCheckedData=function(a){var c=this.sheet,d=[],e={},f=this.filterButtonInfo.rowFilter;if(!f)return d;if(!c)return d;if(f.isColumnFiltered(a))for(var g=-1===f.range.row?0:f.range.row,h=-1===f.range.rowCount?c.getRowCount():f.range.rowCount,i=g;g+h>i;i++)if(!f.isRowFilteredOut(i)){var j=c.getValue(i,a),k=b;k=j instanceof Date?j:c.getText(i,a),e[k]||(d.push(k),e[k]=!0)}return d},D.prototype._ArrayToDic=function(a){var b={};return $.each(a,function(a,c){b[c]=c}),b},D.prototype._setCheckedValues=function(a){var d=this._ArrayToDic(a);this.itemList.find("input").each(function(){var a=$(this),e=a.val();d[e]!==b&&typeof d[e]!=c?a.prop("checked",!0):a.prop("checked",!1)})},D.prototype._getActualValues=function(d,e){for(var f=[],g=this._ArrayToDic(d),h={},i=0;i<e.length;i++){var j=e[i];(void 0===j||j===b||""===j)&&(j=a.SR.Blanks),g[j]===b||typeof g[j]==c||h[j]||(f.push(j),h[j]=!0)}return f},D.prototype._sortByUser=function(b){var c=this.filterButtonInfo.rowFilter;if(c){var d=this.sheet,e=d._name;if(d){var f=this.filterButtonInfo.col;d._trigger(a.Events.RangeSorting,{sheet:d,sheetName:e,col:f,ascending:b});var g=d.isPaintSuspended();d.isPaintSuspended(!0),c.sortColumn(f,b),d.isPaintSuspended(g),d._trigger(a.Events.RangeSorted,{sheet:d,sheetName:e,col:f,ascending:b})}}},D.prototype._setButtonState=function(){var a=$("."+l),b=a.find("input"),c=0,d=$("#"+f);b.each(function(){return $(this).prop("checked")?(c++,!1):void 0});var e=this._useWijmoTheme,g="ui-button-disabled ui-state-disabled",h="filter-button-disable";c>0?d.attr("disabled",!1).removeClass(e?g:h):d.attr("disabled",!0).addClass(e?g:h)},D.prototype._initFirstOpenCache=function(){var a=$("."+o);this._firstOpenCache=[];var b=this;$.each(a,function(a,c){$(c).prop("checked")===!0&&b._firstOpenCache.push(c.value)})},D.getImageSrc=function(a){return 0===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAABy0lEQVR42pyST2gTQRTGv9nEpCnqTasHES8VLCioiFDIYYum+I/ebFXQm1BbsdSDhKgoXhS8tLQSqAhexIInETwJIqJiexJEZXupwRJNbRsy2Z3dzHxesjGEChs/eMx7A+837817giQAYCD3cZuScqG8Wtj19tG5n/iHhBAkKcLYCh3fdSd04HXCq5xHG2oAdOAdNIG3qAJ5tW1A/9hrm8ZsV+7vDLTe2nsmP9AWwATuXe27330lLwvLkloHY5EBR0dexkB0xxKp9Ieno8MbOjYP1ZRMHz77YE8kAMk35V/fkpWSc6L3dL7Tl6uPAaAm155EAYhwjFHVOsY4AEwPXXkG7W+0EqmCodlRW17oCkrO5Pjc55lon7i2mBqenc7ETTmLFWdvaenLpijJDUBcywsAYFRwu/jja1dMWNfWKf2WEOJ43T8ihLgHACAJkpgZvNQ3kTnJG/u6Z8O7ZgNwAACbzCb5dxNVLPnQW3aKyY7EKABM2XZPcwUk5wG8qIfvSL5qtJAfHLnvF+Z2GsPr2fefipPH0luq5aXsOi3frJ+5xhSm+k/1VErOxRWlqgkrfujO/t191ZqxLeB5azbJeSFELnz9v/agVX8GAIjG5r9I9yjkAAAAAElFTkSuQmCC":7===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgVjMuNS41Tib51gAAAXlJREFUOE9jYACCqRH5a6eGZu6cHl00d2pUwa6J7r4Xe4w1U0ByWMB/DLHJnoHbQIKzI1PEp3r6vKjVU72HQzNIGNOA6W5uYiCZmUHxM+v0Vf836KuHkWQASPGciGznSe6+/+v01Vbh0YzdBeBwiC560GWi+aLVXEccxJ/i6KhNdBjMCM/u7be3+99hpJEK0jTJ01a0y1hjKVEGTHH31e4w1vxSrqP0tVZPbXazodqKSl2VV9W6KnOJMoCAf4mLRpAq/+pTEh4F+79aJSwGxwjJseBZdHCVa/b2/1YR00vJMsAtd+c957T1D42De17iMKARKO4NTUiuQLoLrs694IAT0PbvNrFzNYwDOv9bRc4IwGKIMVQzKCWCsBNcDVDzaafUdbfMwiZNMwnq/mIeNvkgDldsgWo+hqyZ2TVr+0egIRIgQcuomb7G/h3/zaOmaeFxBcJ2l6xtx8xDJ/6wDJ+cYhU2g8vYv/M9yABj//aLOFxRTUbU49YCALt6h216b0oVAAAAAElFTkSuQmCC":8===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAKBJREFUOE+l0cENwjAMBdCM0BEYhZG6AjdvwQhMUvXQI0KcKo6IY2/9v0qQnVilFoenJF+2q6RJRP7ihhFuGOGGO851Zg4/9PCGi8oOD+iAzQM8c7bRRTX9pStMmbnGd1Nhwz2vbOD+ATcwteagjPBSZuAVTmBqzUHhnTnkA2wkPmJT2wRKGbLk1avZHUAcwldv/n/hhhFuGOGGEW54nKQVV2qyDejeW7YAAAAASUVORK5CYII=":9===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAHpJREFUOE+lz8ENgDAMA8COxEiMkxWYgkmYhCGgllpkUz8aeJyQrVQJJSJ+sWWGLTNsmWHLaq22amkZX2T0MiuB7ASPOMusBIKNh9Evekh4weaTDOfDUDTYdBnTF/AjbOYssxJIf9Q39ouG35DwhS0zbJlhywxbzotyAztMtZGgPPrJAAAAAElFTkSuQmCC":""
},D}(a.BaseDialog);a._GcFilterDialog=F}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){function b(b,c,d,e){return new a.Range(b,c,d,e)}function c(b){return new a._DateTimeHelper(b)}function d(b){return"string"==typeof b?!1:a.FormatConverter.IsNumber(b)}function e(b){return a._DateTimeHelper.fromOADate(b)}function f(b,c,d,e,f,h){return function(b,d,e,f){if(!a.util.hasCalc())return g;var h=a.Calc.Functions.findGlobalFunction(c),i=h.evaluate([d,e,f]);return i[0][0]}(d,e,f,h)}a.feature("fill",["core.common","core.globalize","core.stringResource"]);var g=null,h=void 0,i=Math.abs,j=Math.min,k=Math.floor;!function(a){a[a.Direction=0]="Direction",a[a.Linear=1]="Linear",a[a.Growth=2]="Growth",a[a.Date=3]="Date",a[a.Auto=4]="Auto"}(a.FillType||(a.FillType={}));a.FillType;!function(a){a[a.Day=0]="Day",a[a.Weekday=1]="Weekday",a[a.Month=2]="Month",a[a.Year=3]="Year"}(a.FillDateUnit||(a.FillDateUnit={}));var l=(a.FillDateUnit,function(){function a(a){this._sheet=a}return a}()),m=function(){function b(a){this._indexes=[],this._innerValues=[],this._type=g,this._startIndex=a===h||a===g?-1:a}return b.prototype.dataCount=function(){return this._innerValues.length},b.prototype.values=function(){var a=this;if(a._innerValues.length>0){for(var b=[],c=0;c<a._innerValues.length;c++){var d,e=a._innerValues[c];d="object"===a._type?a.toDateTime(e):e,b.push(d)}return b}return[]},b.prototype.indexes2=function(){var b=this,c=b._indexes.length;if(c>0&&a.util.hasCalc()){var d=b._startIndex;-1===d&&(d=b._indexes[0]);var e=new Array(1);e[0]=new Array(c);for(var f=0;c>f;f++)e[0][f]=b._indexes[f]-d+1;return new a.Calc._ConcreteArray(e,c)}return g},b.prototype.values2=function(){var b=this._innerValues.length;if(b>0&&a.util.hasCalc()){var c=[this._innerValues];return new a.Calc._ConcreteArray(c,b)}return g},b.prototype.insert=function(b,c,e){if(!d(e))throw new Error(a.SR.Exp_NumberOnly);var f=this;(f._type===h||f._type===g)&&(f._type=e instanceof Date?"date":"number"),new a._ArrayHelper(f._indexes).insert(b,c),new a._ArrayHelper(f._innerValues).insert(b,f.toDouble(e))},b.prototype.add=function(a,b){var c=this;(c._type===h||c._type===g)&&(c._type=b instanceof Date?"date":"number"),c._indexes.push(a),c._innerValues.push(c.toDouble(b))},b.prototype.toActualValue=function(a){var b;return b="date"===this._type?this.toDateTime(a):a},b.prototype.toDouble=function(b){return a.FormatConverter.ToDouble(b)},b.prototype.toDateTime=function(b){var c=g;if(b instanceof Date)c=b;else if(a.util.hasCalc())try{c=a.Calc.Convert.toDateTime(b)}catch(d){c=b}return c},b}(),n=function(){function a(){}return a.TREND=function(a,b,c,d){return f(this,"Trend",a,b,c,d)},a.GROWTH=function(a,b,c,d){return f(this,"Growth",a,b,c,d)},a.FORECAST=function(a,b,c,d){return f(this,"Forecast",a,b,c,d)},a}(),o=function(){function f(a){this._worksheet=a,this._fillCache=new l(a)}return f.prototype.fillLinear=function(a,b,c,d){c!==h&&c!==g||d!==h&&d!==g?this.seriesFillRange(a,b,1,c,d,g):this.seriesTrendFillRange(a,b,1)},f.prototype.fillGrowth=function(a,b,c,d){c!==h&&c!==g||d!==h&&d!==g?this.seriesFillRange(a,b,2,c,d,g):this.seriesTrendFillRange(a,b,2)},f.prototype.fillDate=function(a,b,c,d,e){this.seriesFillRange(a,b,3,d,e,c)},f.prototype.seriesTrendFillRange=function(b,c,d,e){var f=this,g=f.fixRange(b),h=g.row,i=g.col,j=g.rowCount,k=g.colCount;if(f.hasSpans(h,i,j,k))throw new Error(a.SR.Exp_RangeContainsMergedCell);var l,m,n;if(1===c){for(var o=h;h+j>o;o++)if(l=f.getSeriesSource(o,i,1,k,c),l&&l.dataCount()>0&&(m=f.calcSeriesTrendData(l,k,d),m&&m.length>0))for(n=0;n<m.length;n++){if(e)return l.toActualValue(m[n]);f.copyCell(f._worksheet,o,l._indexes[0],o,i+n,l.toActualValue(m[n]),d)}}else if(0===c)for(var p=i;i+k>p;p++)if(l=f.getSeriesSource(h,p,j,1,c),l&&l.dataCount()>0&&(m=f.calcSeriesTrendData(l,j,d),m&&m.length>0))for(n=0;n<m.length;n++){if(e)return l.toActualValue(m[n]);f.copyCell(f._worksheet,l._indexes[0],p,h+n,p,l.toActualValue(m[n]),d)}},f.prototype.getSeriesSource=function(a,b,c,e,f){var h,i=g;if(1===f)for(var j=b+e-1;j>=b;)h=this._worksheet.getValue(a,j),d(h)&&(i||(i=new m(b)),i.insert(0,j,h)),j--;else if(0===f)for(var k=a+c-1;k>=a;)h=this._worksheet.getValue(k,b),d(h)&&(i||(i=new m(a)),i.insert(0,k,h)),k--;return i},f.prototype.calcSeriesTrendData=function(b,c,d){if(b&&b.dataCount()>0&&a.util.hasCalc()&&(1===d||2===d)){var e=[];1===b.dataCount()&&(1===d?b.add(b._indexes[0]+1,b.toActualValue(b._innerValues[0]+1)):2===d&&b.add(b._indexes[0]+1,b.values()[0]));for(var f=0;c>f;f++)1===d?e.push(n.TREND(this._worksheet,b.values2(),b.indexes2(),f+1)):2===d&&e.push(n.GROWTH(this._worksheet,b.values2(),b.indexes2(),f+1));return e}return g},f.prototype.fillAuto=function(b,c,d){var e=this,f=e._worksheet,g=e.fixRange(b),h=g.row,i=g.col,j=g.rowCount,k=g.colCount,l=e.fixRange(f._eventHandler._dragFillStartRange);if(l){if(e.hasPartSpans(l.row,l.col,l.rowCount,l.colCount)||e.hasPartSpans(h,i,j,k))throw new Error(a.SR.Exp_ChangeMergedCell);var m=!0;return(h<l.row||i<l.col)&&(m=!1),e.autoFillRange(l,j,k,c,d,m)}},f.prototype.fixRange=function(a){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount;return-1===c&&(c=0,e=this._worksheet.getRowCount()),-1===d&&(d=0,f=this._worksheet.getColumnCount()),b(c,d,e,f)},f.prototype.autoFillRange=function(a,c,d,e,f,h){var i,j,l,m,n=this,o=h?1:-1;if(1===e){if(i=k(d/a.colCount),j=d%a.colCount,i>1&&!f)for(m=1;i>m;m++)l=b(a.row,a.col+m*o*a.colCount,a.rowCount,a.colCount),n.copyRange(a,l,e,4,f);if(f&&i>1&&0===j&&(i-=1,j=a.colCount),i>0&&j>0)return l=h?b(a.row,a.col+i*a.colCount,a.rowCount,j):b(a.row,a.col-i*a.colCount+a.colCount-j,a.rowCount,j),n.copyRange(a,l,e,4,f,h,g,h?0:a.colCount-j)}else if(0===e){if(i=k(c/a.rowCount),j=c%a.rowCount,i>1&&!f)for(m=1;i>m;m++)l=b(a.row+m*o*a.rowCount,a.col,a.rowCount,a.colCount),n.copyRange(a,l,e,4,f,g,g,g,!0);if(f&&i>1&&0===j&&(i-=1,j=a.rowCount),i>0&&j>0)return l=h?b(a.row+i*a.rowCount,a.col,j,a.colCount):b(a.row-i*a.rowCount+a.rowCount-j,a.col,j,a.colCount),n.copyRange(a,l,e,4,f,h,h?0:a.rowCount-j,g,!0)}},f.prototype.copyRange=function(a,b,c,e,f,h,i,j,k){var l,n,o,p,q,r,s,t,u,v,w=this,x=w._worksheet,y=g,z=g;if(1===c)for(l=0;l<a.rowCount;l++){for(y=g,z=g,p=a.row+l,q=b.row+l,j=j?j:0,n=0;n<a.colCount;)if(o=a.col+n,r=b.col+n-j,s=g,t=x.getFormula(p,o),t&&""!==t||(s=x.getValue(p,o)),4===e&&d(s)&&(y||(y=new m),u=g,u=s instanceof Date?"date":"number",z||(z=u),z===u))y.add(o,s),n++;else if(s&&y&&y.dataCount()>0){var A=w.autoFillRowTrendValues(a,b,p,q,y,f,h,j);if(f&&A!==g)return A;y=g,z=g}else if(v=x._spanModel.find(p,o)){if(v.row===p)if(f){if(r===b.col+b.colCount-1)return s}else r<b.col+b.colCount&&r>=b.col&&w.copyCell(x,p,o,q,r,s,e);n+=v.colCount}else{if(f){if(h&&r===b.col+b.colCount-1)return s;if(!h&&r===b.col)return s}else r<b.col+b.colCount&&r>=b.col&&w.copyCell(x,p,o,q,r,s,e);n++}if(y&&y.dataCount()>0){var A=w.autoFillRowTrendValues(a,b,p,q,y,f,h,j);if(f&&A!==g)return A}}else if(0===c)for(n=0;n<a.colCount;n++){for(y=g,z=g,o=a.col+n,r=b.col+n,i=i?i:0,l=0;l<a.rowCount;)if(p=a.row+l,q=b.row+l-i,s=g,t=x.getFormula(p,o),t&&""!==t||(s=x.getValue(p,o)),4===e&&d(s)&&(y||(y=new m),u=g,u=s instanceof Date?"date":"number",z||(z=u),z===u))y.add(p,s),l++;else if(s&&y&&y.dataCount()>0){var A=w.autoFillColumnTrendValues(a,b,o,r,y,f,h,i,k);if(f&&A!==g)return A;y=g,z=g}else if(v=x._spanModel.find(p,o)){if(v.col===o)if(f){if(q===b.row+b.rowCount-1)return s}else q<b.row+b.rowCount&&q>=b.row&&(k&&x.isRowFilterOut(q)||w.copyCell(x,p,o,q,r,s,e));l+=v.rowCount}else{if(f){if(h&&q===b.row+b.rowCount-1)return s;if(!h&&q===b.row)return s}else q<b.row+b.rowCount&&q>=b.row&&(k&&x.isRowFilterOut(q)||w.copyCell(x,p,o,q,r,s,e));l++}if(y&&y.dataCount()>0){var A=w.autoFillColumnTrendValues(a,b,o,r,y,f,h,i,k);if(f&&A!==g)return A}}return g},f.prototype.autoFillRowTrendValues=function(b,c,d,e,f,h,i){var j,k,l,m,o,p=this,q=p._worksheet;if(f&&f.dataCount()>0&&a.util.hasCalc()){var r=(c.col-b.col)/b.colCount;if(p.isArithmeticProgression(f._indexes,f._innerValues)){var s=f.values2(),t=new Array(1);for(j=f.dataCount(),t[0]=new Array(j),k=0;j>k;k++)t[0][k]=k+1;var u=new a.Calc._ConcreteArray(t,j);for(k=0;j>k;k++)if(l=n.TREND(q,s,u,j*r+k+1),m=f._indexes[k],o=m+r*b.colCount,h){if(i&&o===c.col+c.colCount-1)return f.toActualValue(l);if(!i&&o===c.col)return f.toActualValue(l)}else o<c.col+c.colCount&&o>=c.col&&p.copyCell(q,d,m,e,o,f.toActualValue(l),4)}else{var v=f._indexes[0];for(j=f._indexes[f.dataCount()-1]-v+1,1===f.dataCount()&&f.add(f._indexes[0]+1,f.toActualValue(f._innerValues[0]+1)),k=0;j>k;k++)if(l=n.TREND(q,f.values2(),f.indexes2(),j*r+k+1),m=v+k,o=m+r*b.colCount,h){if(o===c.col+c.colCount-1)return f.toActualValue(l)}else o<c.col+c.colCount&&o>=c.col&&p.copyCell(q,d,m,e,o,f.toActualValue(l),4)}}return g},f.prototype.copyCell=function(b,c,d,e,f,h,i){if((b.hasFormula(c,d)||b.hasFormula(e,f))&&(b.setFormula(e,f,g),0===i||4===i)){var j=b.getFormula(c,d);j&&b._copyFormula(c,d,e,f,1,1)}b.setValue(e,f,h);var k=b.getCompositeStyle(c,d);if(k){var l=new a.Style;l.copyFrom(k),b.setStyle(e,f,l,3)}else b.setStyle(e,f,g,3);if(!b._spanModel.isEmpty()){b.removeSpan(e,f,3);var m=b._spanModel.find(c,d);m&&b._addSpanImp(e,f,m.rowCount,m.colCount,3)}},f.prototype.autoFillColumnTrendValues=function(b,c,d,e,f,h,i,j,k){var l,m,o,p,q,r=this,s=r._worksheet;if(f&&f.dataCount()>0&&a.util.hasCalc()){var t=(c.row-b.row-j)/b.rowCount;if(r.isArithmeticProgression(f._indexes,f._innerValues)){var u=f.values2(),v=new Array(1);for(l=f.dataCount(),v[0]=new Array(l),m=0;l>m;m++)v[0][m]=m+1;var w=new a.Calc._ConcreteArray(v,l);for(m=0;l>m;m++)if(o=n.TREND(s,u,w,l*t+m+1),p=f._indexes[m],q=p+t*b.rowCount,h){if(i&&q===c.row+c.rowCount-1)return f.toActualValue(o);if(!i&&q===c.row)return f.toActualValue(o)}else q<c.row+c.rowCount&&q>=c.row&&(k&&s.isRowFilterOut(q)||r.copyCell(s,p,d,q,e,f.toActualValue(o),4))}else{var x=f._indexes[0];for(l=f._indexes[f.dataCount()-1]-x+1,1===f.dataCount()&&f.add(f._indexes[0]+1,f.toActualValue(f._innerValues[0]+1)),m=0;l>m;m++)if(o=n.TREND(s,f.values2(),f.indexes2(),l*t+m+1),p=x+m,q=p+t*b.rowCount,h){if(q+j===c.row+c.rowCount-1)return f.toActualValue(o)}else q<c.row+c.rowCount&&q>=c.row&&(k&&s.isRowFilterOut(q)||r.copyCell(s,x,d,q,e,f.toActualValue(o),4))}}return g},f.prototype.isArithmeticProgression=function(a,b){if(a.length!==b.length)return!1;var c=b.length;if(1>=c)return!1;if(2===c)return!0;for(var d=a[1]-a[0],e=b[1]-b[0],f=2;c>f;f++){if(a[f]-a[f-1]!==d)return!1;if(b[f]-b[f-1]!==e)return!1}return!0},f.prototype.fillAutobyDirection=function(a,b){var c=this.fixRange(a),d=c.row,e=c.col,f=c.rowCount,g=c.colCount,h=this.getDirectionFillSourceRange(d,e,f,g,b);h&&this.directionFillRange(h,d,e,f,g,b)},f.prototype.directionFillRange=function(c,d,e,f,g,h){var i,j,l,m,n=this,o=a.SR.Exp_TargetContainsMergedCells,p=a.SR.Exp_MergedCellsIdentical;if(0===h){if(n.hasSpans(d,e,f,g-c.colCount))throw new Error(o);if(i=k(g/c.colCount),j=g%c.colCount,0!==j)throw new Error(p);if(i>1)for(m=1;i>m;m++)l=b(c.row,c.col-m*c.colCount,c.rowCount,c.colCount),n.copyRange(c,l,1,0)}else if(1===h){if(n.hasSpans(d,e+c.colCount,f,g-c.colCount))throw new Error(o);if(i=k(g/c.colCount),j=g%c.colCount,0!==j)throw new Error(p);if(i>1)for(m=1;i>m;m++)l=b(c.row,c.col+m*c.colCount,c.rowCount,c.colCount),n.copyRange(c,l,1,0)}else if(2===h){if(n.hasSpans(d,e,f-c.rowCount,g))throw new Error(o);if(i=k(f/c.rowCount),j=f%c.rowCount,0!==j)throw new Error(p);if(i>1)for(m=1;i>m;m++)l=b(c.row-m*c.rowCount,c.col,c.rowCount,c.colCount),n.copyRange(c,l,0,0)}else if(3===h){if(n.hasSpans(d+c.rowCount,e,f-c.rowCount,g))throw new Error(o);if(i=k(f/c.rowCount),j=f%c.rowCount,0!==j)throw new Error(p);if(i>1)for(m=1;i>m;m++)l=b(c.row+m*c.rowCount,c.col,c.rowCount,c.colCount),n.copyRange(c,l,0,0)}},f.prototype.getDirectionFillSourceRange=function(a,c,d,e,f){var h=g;return 0===f?h=b(a,c+e-1,d,1):1===f?h=b(a,c,d,1):2===f?h=b(a+d-1,c,1,e):3===f&&(h=b(a,c,1,e)),this.inflateCellRange(h)},f.prototype.inflateCellRange=function(a){var b=this._worksheet.getSpans();return b&&a&&(a=this._worksheet._cellRangeInflate(b,a)),a},f.prototype.hasPartSpans=function(a,b,c,d){for(var e=this._worksheet._spanModel.getEnumerator(a,b,c,d);e.moveNext();){var f=e.current();if(f.row<a||f.row+f.rowCount>a+c)return!0;if(f.col<b||f.col+f.colCount>b+d)return!0}return!1},f.prototype.hasSpans=function(a,b,c,d){var e=this._worksheet._spanModel.getEnumerator(a,b,c,d);return e.moveNext()},f.prototype.seriesFillRange=function(b,c,d,e,f,g){var h,i,j,k=this,l=k.fixRange(b),m=l.row,n=l.col,o=l.rowCount,p=l.colCount;if(k.hasSpans(m,n,o,p))throw new Error(a.SR.Exp_RangeContainsMergedCell);if(1===c){for(var q=m;m+o>q;q++)if(h=k.getSeriesSource(q,n,1,1,c),h&&h.dataCount()>0&&(i=k.calcSeriesData(h,p,d,e,f,g),i&&i.length>0))for(j=0;j<i.length;j++)k.copyCell(k._worksheet,q,h._indexes[0],q,n+j,h.toActualValue(i[j]),d)}else if(0===c)for(var r=n;n+p>r;r++)if(h=k.getSeriesSource(m,r,1,1,c),h&&h.dataCount()>0&&(i=k.calcSeriesData(h,o,d,e,f,g),i&&i.length>0))for(j=0;j<i.length;j++)k.copyCell(k._worksheet,h._indexes[0],r,m+j,r,h.toActualValue(i[j]),d)},f.prototype.calcSeriesData=function(a,b,c,d,e,f){if(a&&a.dataCount()>0){for(var i=[],j=a._innerValues[0],k=j,l=0;b>l;l++)(e===h||e===g||e>=k)&&(i.push(k),1===c?k+=d:2===c?k*=d:3===c&&f!==h&&f!==g&&(k=this.getNextDateValue(f,j,k,d,l+1)));return i}return g},f.prototype.getNextDateValue=function(a,b,d,f,g){var h,l=d;if(0===a)h=e(d),l=c(h.setDate(h.getDate()+f)).toOADate();else if(1===a){h=e(d);for(var m=i(f);m>0;)h.setDate(f>0?h.getDate()+j(1,m):h.getDate()-j(1,m)),6!==h.getDay()&&0!==h.getDay()&&(m-=1);l=c(h).toOADate()}else 2===a?(h=e(b),l=c(h.setMonth(h.getMonth()+k(g*f))).toOADate()):3===a&&(h=e(b),l=c(h.setFullYear(h.getFullYear()+k(g*f))).toOADate());return l},f}();a.FillImp=o}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("fill_ui",["core.common","core.sheet_action","core.stringResource"]),function(a){a[a.Tag=0]="Tag",a[a.Down=1]="Down"}(a._FillSmartTag||(a._FillSmartTag={}));var b=(a._FillSmartTag,function(b){function d(a,c){b.call(this);var d=this;d._useWijmoTheme=!1,d.eventNameSpace=".ui-fill",d.fillKeyDown="keydown"+d.eventNameSpace,d.sheet=a,d.fillInfo=c,d._initTagDialog()}return __extends(d,b),d.prototype._initTagDialog=function(){var a=this;a.tagContainer=a.getContainer().addClass("container-default-header tag-container no-user-select"),a.smartTag=$("<img>").attr("src",d.getImageSrc(0)).css("float","left").appendTo(a.tagContainer),a.smartTagDown=$("<img>").attr("src",d.getImageSrc(1)).css({"float":"left",display:"none"}).appendTo(a.tagContainer)},d.prototype.useWijmoTheme=function(a){var c=this;if("undefined"==typeof a)return c._useWijmoTheme;if("boolean"==typeof a&&c._useWijmoTheme!==a){b.prototype.useWijmoTheme.call(this,a);var d=c.tagContainer,e="ui-widget-header",f="container-default-header";return d.removeClass(a?f:e),d.addClass(a?e:f),c}return null},d.prototype._registerEvent=function(){var b=this,c=a.util.device(),d=$.browser.safari&&(c.ipad||c.iphone);b.tagContainer.hover(function(){var a=b._useWijmoTheme?"ui-state-hover":"container-default-hover",c=b.sheet._isTouchMode,e=c?"38px":"32px",f=c?"24px":"18px";if(b.menuDialog){var g=b.menuDialog.isOpen();if(g)return}$(this).addClass(a),$(this).css({width:e,height:f}),d||b.smartTagDown.show()},function(){var a=b._useWijmoTheme?"ui-state-hover":"container-default-hover",c=b.sheet._isTouchMode,e=c?"24px":"18px",f=c?"24px":"18px";if(b.menuDialog){var g=b.menuDialog.isOpen();if(g)return}$(this).removeClass(a),$(this).css({width:e,height:f}),d||b.smartTagDown.hide()}),b.tagContainer.toggle(function(){var a=b._useWijmoTheme?"ui-state-active":"container-default-active";d&&b.smartTagDown.show(),$(this).addClass(a),b._openMenu(),b._initData()},function(){var a=b._useWijmoTheme?"ui-state-active":"container-default-active";d&&b.smartTagDown.hide(),$(this).removeClass(a),b._closeMenu()}),$(document).bind(b.fillKeyDown,function(c){27===c.keyCode&&(b.menuDialog&&b.menuDialog.isOpen()?b._closeMenu():b.close(),a.util.cancelDefault(c))})},d.prototype.open=function(){var a=this,b=a.sheet;if(a.tagContainer){var c=$(b._getCanvas()).offset(),d=a.fillInfo.x,e=a.fillInfo.y;d+=c.left,e+=c.top,a.tagContainer.css({left:d,top:e}),a.show(),a._registerEvent();var f=b._isTouchMode,g=f?"3px":"0px",h=f?"24px":"18px";a.smartTag.css("margin",g),a.smartTagDown.css("height",h),a._reset();var i=b.parent,j=i&&"undefined"!=typeof i.useWijmoTheme?i.useWijmoTheme:!1;a.useWijmoTheme(j)}},d.prototype._initData=function(){var a=this.fillInfo.fillType;if(this.menuContainer){var b=this.menuContainer.find(":radio")[a];b&&b.checked===!1&&(b.checked=!0,$(b).change())}},d.prototype._openMenu=function(){var a=this;a.menuDialog||(a.menuDialog=new c(a.sheet),a.menuContainer=a.menuDialog.getContainer(),a.menuDialog.useWijmoTheme(a._useWijmoTheme));var b=$(a.tagContainer).offset(),d=b.left,e=b.top+a.tagContainer.height()+2;a.menuContainer.css({left:d,top:e}),a.menuDialog.show("normal"),a.menuDialog._attachEvent(),$(a.menuDialog).unbind("fillTypeChanged"),$(a.menuDialog).bind("fillTypeChanged",function(b,c){a.fillInfo.fillType=c})},d.prototype._closeMenu=function(){this.menuDialog&&this.menuDialog.close()},d.prototype._reset=function(){var a=this;if(a.menuDialog){var b=a.menuDialog.isOpen();b&&a.tagContainer.click(),a.tagContainer.mouseleave()}},d.prototype.close=function(){var a=this;a._reset(),$(document).unbind(a.fillKeyDown),b.prototype.close.call(this),a.sheet&&a.sheet.setFocus()},d.getImageSrc=function(a){return 0===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAFJJREFUeNrclEEKACAIBOfp/Xy7i4WSRnRYBIVRVhFJVIhyEAxllQa5E/wBSnsU6Rza2nugqNmASi57C/KKNg/Iqn+iVWzx6M4bOdUEAAD//wMAAYRMfiNaiqEAAAAASUVORK5CYII=":1===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAASCAYAAACXScT7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGCSURBVHjafNFPKKRxHAbw5/v7GYdBYUQjLm5SkoNykCQHtcx431/KgdKumJvSrAO7Nwc3RQ5kd3OkHJC/hUJREluonVcToqRh3sRFPA6M1Mbhc3z6Pj1fkMRHQNJL0uPeul731lU37o1y49cqHr8GvvgWQRLBsmpM/P0j4XAXiooKcXl1CZDEzl4EJBEwAZBUwWAQsVgsFSRR11gmM8trimSa3WypzZ31l5v2/vfk/4oAcv9aSGyUSz4gg/AIAOET0YQswIQWaNrnH+2OeSaY0BJN2+wDTi/OpCrwkxX1vW8q63p5cnaaB+Z/09u7x0nFJTVMiEajPsNCQaC6Ryb8THKcw/Tikho6zj//0RGUNV6gMZ1H8fmpH5iTHDlwsiOhO7FrN5RdP6aBIUj/pvJ2bkFbkxAzBzELELNCQQqgrJ5ST1/jqmYOJcHa7dYYGV5TrQ3d+vfUU+b7IfrOIRCGBYD0o1VGmaHaB6DZkqvMD2hUfF1UAISkvE/+yqbCZ89+HgBtwgFOrBUzJgAAAABJRU5ErkJggg==":""},d}(a.BaseDialog));a._GcFillDialog=b;var c=function(b){function c(a){b.call(this),this.sheet=a,this.init()}return __extends(c,b),c.prototype.init=function(){var a=this;a.itemClass="fill-type-item",a.menuClass="wijspread-fill-menu-container",a._useWijmoTheme=!1,a.smartTagContainer=$(".tag-container"),a._initMenuDialog()},c.prototype.show=function(a){0!==arguments.length&&b.prototype.show.call(this,a)},c.prototype._initMenuDialog=function(){var b=this;b.menuContainer=b.getContainer(),b.menuContainer.addClass(b.menuClass),b.copyCells=b._createMenuItem("smartMenuCopyCells",b.itemClass,a.SR.CopyCells,"0",!0).appendTo(b.menuContainer),b.fillSeries=b._createMenuItem("smartMenuFillSeries",b.itemClass,a.SR.FillSeries,"1").appendTo(b.menuContainer),b.fillFormattingOnly=b._createMenuItem("smartMenuFillFormattingOnly",b.itemClass,a.SR.FillFormattingOnly,"2").appendTo(b.menuContainer),b.fillWithoutFormatting=b._createMenuItem("smartMenuFillWithoutFormatting",b.itemClass,a.SR.FillWithoutFormatting,"3").appendTo(b.menuContainer)},c.prototype._createMenuItem=function(a,b,c,d,e){{var f=this.sheet._isTouchMode,g=f?"160px":"150px",h=f?"25px":"20px",i=$("<div>").css({width:g,height:h}).addClass("container-default-state "+b),j=$("<div>").addClass("menu-item-input").appendTo(i),k=$("<div>").addClass("menu-item-text").appendTo(i),l=$("<input>").attr({id:a,value:d,type:"radio",name:"fill-group",style:"display:none"}).appendTo(j);$("<span>").text(c).appendTo(k)}return e?(j.addClass("check-image"),l.prop("checked","checked")):l.prop("checked",""),i},c.prototype.useWijmoTheme=function(a){var c=this;if("undefined"==typeof a)return c._useWijmoTheme;if("boolean"==typeof a&&c._useWijmoTheme!==a){b.prototype.useWijmoTheme.call(this,a);var d=c.menuContainer.find("div."+c.itemClass),e=d.find("input:checked").parent(),f="ui-state-default",g="container-default-state",h="ui-icon ui-icon-check",i="check-image";return d.removeClass(a?g:f),d.addClass(a?f:g),e.removeClass(a?i:h),e.addClass(a?h:i),c}return null},c.prototype._attachEvent=function(){var a=this,b=$("."+a.itemClass);b.hover(function(){var b=a._useWijmoTheme?"ui-state-hover":"container-default-hover";$(this).addClass(b)},function(){var b=a._useWijmoTheme?"ui-state-hover":"container-default-hover";$(this).removeClass(b)}),b.click(function(){var b=a._useWijmoTheme?"ui-state-hover":"container-default-hover",c=$(this).find(":radio"),d=c[0];d.checked=!0,c.change(),a.smartTagContainer.click(),a.smartTagContainer.mouseleave(),$(this).removeClass(b);var e=parseInt(d.value,10);a._changeFill(e)});var c=a.menuContainer.find(":radio");$(c).change(function(){var b=a._useWijmoTheme?"ui-icon ui-icon-check":"check-image";$(".menu-item-input").removeClass(b),$(this).parent().addClass(b)})},c.prototype._changeFill=function(b){var c=this.sheet,d=c._eventHandler;c._skipCloseDragFillSmartTag=!0,c.suspendEvent();try{a.SpreadActions.undo.call(c)}finally{c.resumeEvent()}c._skipCloseDragFillSmartTag=!1,d.executeDragFillAction(d._currentFillRange,b),$(this).trigger("fillTypeChanged",b)},c.prototype.isOpen=function(){return $("."+this.menuClass).length>0?!0:!1},c}(a.BaseDialog)}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){b.feature("search",["core.common","core.sheet_ui","core.stringResource"]);var c=null,d=Math.max,e=Math.min;!function(a){a[a.All=0]="All",a[a.HasValue=1]="HasValue",a[a.HasStyle=2]="HasStyle"}(b.EnumeratorOption||(b.EnumeratorOption={}));var f=(b.EnumeratorOption,function(){function f(b,c){if(this.actualEndRow=-1,this.isActualEndRowSet=!1,this.isBlockRange=!1,this.options=1,!b)throw new Error(a.spread.SR.Exp_SheetIsNull);var d=this;d.worksheet=b,d.sheetArea=c.sheetArea,d.searchOrder=c.searchOrder,d.rowStart=c.rowStart,d.columnStart=c.columnStart,d.rowEnd=c.rowEnd,d.columnEnd=c.columnEnd,d.findBeginRow=c.findBeginRow,d.findBeginColumn=c.findBeginColumn,d.init(),d.block=d.worksheet}return f.prototype.init=function(){this.currentRow=-1,this.currentColumn=-1},f.prototype.moveNext=function(){var a=this;if(-1===a.currentRow&&-1===a.currentColumn&&a.rowStart<=a.rowEnd&&a.columnStart<=a.columnEnd&&(a.currentRow=a.findBeginRow,a.currentColumn=a.findBeginColumn,a.isIndexAcceptable(a.currentRow,a.currentColumn)&&!a.skipCurrent()))return!0;if(a.rowStart<=a.rowEnd&&a.columnStart<=a.columnEnd)for(;a.tryMoveNext();)if(!a.skipCurrent())return!0;return a.currentRow=-1,a.currentColumn=-1,!1},f.prototype.isIndexAcceptable=function(a,b){var d=this;return(1&d.options)>0&&d.block&&(d.block.getValue(a,b,d.sheetArea)!==c||d.block.getFormula(a,b,d.sheetArea)!==c)?!0:0===d.options},f.prototype.skipCurrent=function(){return!1},f.prototype.tryMoveNext=function(){var a=this,b=a.currentRow,c=a.currentColumn,d=!1;if((1&a.options)>0){var e={value:b},f={value:c};a.nextValue(e,f)&&(b=e.value,c=f.value,d=!0)}return 1===a.options&&(d?(a.currentRow=b,a.currentColumn=c):(a.currentRow=-1,a.currentColumn=-1)),!(-1===a.currentRow&&-1===a.currentColumn)},f.prototype.nextValue=function(a,b){for(;this.next(a,b);)if(this.isIndexAcceptable(a.value,b.value))return!0;return!1},f.prototype.nextZOrder=function(a,b,c){var d=this;if(a){var e=d.getNextNonEmptyColumnInRow(a,b.value,c.value+1);if(-1!==e&&(c.value=e,d.isZOrderOver(b.value,c.value)))return!0;do{var f=a.nextNonNullRow(b.value);if(-1===f||f>d.rowEnd?b.value=-1:(-1!==f&&(b.value=f),-1!==f&&f<b.value&&(b.value=f)),-1!==b.value){c.value=b.value===d.rowStart||d.isBlockRange?d.columnStart-1:-1;do{var g=d.getNextNonEmptyColumnInRow(a,b.value,c.value+1);if(-1===g||g>d.columnEnd?c.value=-1:(-1!==g&&(c.value=g),-1!==g&&g<c.value&&(c.value=g)),-1!==c.value)return d.isZOrderOver(b.value,c.value)}while(-1!==c.value)}}while(-1!==b.value)}return!1},f.prototype.getNextNonEmptyColumnInRow=function(a,b,d){for(var e=d;e<=this.columnEnd;e++)if(a.getValue(b,e)!==c)return e;return-1},f.prototype.isZOrderOver=function(a,b){var c=this;return c.isBlockRange?a>=c.rowStart&&a<=c.getActualEndRow()&&b>=c.columnStart&&b<=c.actualEndColumn():a>c.getActualEndRow()?!1:a===c.getActualEndRow()&&(0>b||b>c.actualEndColumn())?!1:a<c.rowStart?!1:a===c.rowStart&&b<c.columnStart?!1:!0},f.prototype.getActualEndRow=function(){var a=this;if(a.isActualEndRowSet)return a.actualEndRow;var b=-1,c=!1;
if((1&a.options)>0&&a.block){var f=a.block.getRowCount(a.sheetArea)-1;b=d(b,f),c=!0}return b=c?e(b,a.rowEnd):a.rowEnd,a.actualEndRow=b,a.isActualEndRowSet=!0,a.actualEndRow},f.prototype.actualEndColumn=function(){return this.columnEnd},f.prototype.next=function(a,b){var c=this;if(0===c.searchOrder){var d=c.getActualEndColumnZOrder(a.value);return b.value+1<=d?(b.value+=1,c.isZOrderOver(a.value,b.value)):a.value+1<=c.getActualEndRow()?(a.value+=1,b.value=c.isBlockRange?c.columnStart:0,c.isZOrderOver(a.value,b.value)):!1}if(1===c.searchOrder){var e=c.getActualEndRowNOrder(b.value);return a.value+1<=e?(a.value+=1,c.isNOrderOver(a.value,b.value)):b.value+1<=c.actualEndColumn()?(b.value+=1,a.value=c.isBlockRange?c.rowStart:0,c.isNOrderOver(a.value,b.value)):!1}return!1},f.prototype.getActualEndColumnZOrder=function(a){var b=this;if(a>=b.rowStart&&a<=b.rowEnd){var c=-1,f=!1;return(1&b.options)>0&&b.block&&(c=d(c,b.block.getColumnCount(b.sheetArea)-1),f=!0),c=a===b.rowEnd||b.isBlockRange?f?e(c,b.columnEnd):b.columnEnd:f?d(c,b.worksheet.getColumnCount(b.sheetArea)-1):b.worksheet.getColumnCount(b.sheetArea)-1}return-1},f.prototype.getActualEndRowNOrder=function(a){var b=this;if(a>=b.columnStart&&a<=b.columnEnd){var c=-1,f=!1;return(1&b.options)>0&&b.block&&(c=d(c,b.rowEnd),f=!0),c=a===b.columnEnd||b.isBlockRange?f?e(c,b.rowEnd):b.rowEnd:f?d(c,b.worksheet.getRowCount(b.sheetArea)-1):b.worksheet.getRowCount(b.sheetArea)-1}return-1},f.prototype.isNOrderOver=function(a,b){var c=this;return c.isBlockRange?a>=c.rowStart&&a<=c.getActualEndRow()&&b>=c.columnStart&&b<=c.actualEndColumn():b>c.actualEndColumn()?!1:b===c.actualEndColumn()&&(0>a||a>c.getActualEndRow())?!1:b<c.columnStart?!1:b===c.columnStart&&a<c.rowStart?!1:!0},f.prototype.current=function(){var a=this;return 0<=a.currentRow&&a.currentRow<a.worksheet.getRowCount(a.sheetArea)&&0<=a.currentColumn&&a.currentColumn<a.worksheet.getColumnCount(a.sheetArea)?new b.Cell(a.worksheet,a.currentRow,a.currentColumn,a.sheetArea):c},f}());b.CellsEnumerator=f;var g=function(){function a(){var a=this;a.startSheetIndex=-1,a.endSheetIndex=-1,a.searchString=c,a.searchFlags=0,a.searchOrder=0,a.searchTarget=1,a.sheetArea=3,a.rowStart=-1,a.columnStart=-1,a.rowEnd=-1,a.columnEnd=-1,a.findBeginRow=-1,a.findBeginColumn=-1}return a}();b.SearchCondition=g;var h=function(){function a(){var a=this;a.searchFoundFlag=0,a.foundSheetIndex=-1,a.foundRowIndex=-1,a.foundColumnIndex=-1,a.foundString=c}return a}();b.SearchResult=h,function(a){a[a.None=0]="None",a[a.IgnoreCase=1]="IgnoreCase",a[a.ExactMatch=2]="ExactMatch",a[a.UseWildCards=4]="UseWildCards",a[a.BlockRange=8]="BlockRange"}(b.SearchFlags||(b.SearchFlags={}));b.SearchFlags;!function(a){a[a.ZOrder=0]="ZOrder",a[a.NOrder=1]="NOrder"}(b.SearchOrder||(b.SearchOrder={}));b.SearchOrder;!function(a){a[a.None=0]="None",a[a.CellText=1]="CellText",a[a.CellFormula=8]="CellFormula"}(b.SearchFoundFlags||(b.SearchFoundFlags={}));b.SearchFoundFlags}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("binding",["core.common"]);var b=null,c="undefined",d=function(){function a(a){this._source=a,this.__cellBindingSource__=!0}return a.prototype.setValue=function(a,b){this._source&&a&&f.setValueByPath(this._source,a,b)},a.prototype.getValue=function(a){return this._source&&a?f.getValueByPath(this._source,a):b},a.prototype.getSource=function(){return this._source},a}();a.CellBindingSource=d;var e=function(){function a(a){this._init(),this._sheet=a}return a.prototype.bind=function(a){var b=this,c=b._dataSource;c&&$.isFunction(c.dispose)&&c.dispose(),b._unSubscribeHandlers(b._dataSourceSubscriptions),b._unSubscribeHandlers(b._dataItemSubscriptions),b._init(),b._dataSource=a,a&&(b._dataSourceType=b._getDataSourceType(a),b.getDataItemType(),b._sheet&&(a.subscribe&&b._dataSourceSubscriptions.push(a.subscribe(b._dataChangedhandler,b)),a.currentPosition&&a.currentPosition.subscribe&&b._dataSourceSubscriptions.push(a.currentPosition.subscribe(b._currentPositionChangedhandler,b)),b.doDataItemChanged()),b._fields=b._getFieldsInfo())},a.prototype.doDataItemChanged=function(){var a=this;if(a._sheet&&a._dataSource){var d=a._sheet,e=a._dataSource,f=a._dataSourceType;if(e&&$.type(window.ko)!==c){a._unSubscribeHandlers(a._dataItemSubscriptions);var g=b;if(3===f){if(e.currentPosition){var h=d.getActiveRowIndex();h>=-1&&h<e.count()&&e.currentPosition(h)}g=e.currentItem()}else 4===f||(g=e[d.getActiveColumnIndex()]);if(g)for(var i in g)g[i]&&$.isFunction(g[i].subscribe)&&a._dataItemSubscriptions.push(g[i].subscribe(a._activeDataItemChangedhandler,b,b))}}},a.prototype._activeDataItemChangedhandler=function(){this._sheet&&this._sheet.repaint()},a.prototype._unSubscribeHandlers=function(a){if(a)for(var b in a){var c=a[b];c&&$.isFunction(c.dispose)&&c.dispose()}},a.prototype.getRowCount=function(){return this._getDataLength()},a.prototype.getColumnCount=function(){if(this._fields)return this._fields.length;var a=this._dataSource;if(a){var b=a[0],c=$.type(b);if("null"===c||"string"===c||"number"===c)return 1}return 0},a.prototype.getSource=function(){return this._dataSource},a.prototype.getFields=function(){return this._fields},a.prototype.getDataItem=function(a){if(!this._dataSource)return b;var c=this._dataSource,d=this._dataSourceType;return 1===d?c[a]:4===d?b:2===d?c()[a]:3===d?c.item(a):b},a.prototype.getDataItemType=function(){if(!this._dataItemType)for(var a=this.getRowCount(),b=0;a>b;b++){var c=this.getDataItem(b);if(c){c.entityAspect&&c.entityType&&(this._dataItemType=c.entityType),this._dataItemType=c.constructor;break}}return this._dataItemType},a.prototype.getValue=function(a,d){var e=this;if(!e._dataSource)return b;var g,h,i=e._sheet,j="function",k="string",l=e._dataSource,m=e._dataSourceType;if(4!==m){if(0>a||e.getRowCount()<=a)return b;var n=i?i.getColumnCount():e.getColumnCount();if(0>d||d>=n)return b;i&&i._colInfos?(g=i._colInfos[d],g&&(h=g.name)):e._fields&&(h=e._fields[d])}if(1===m){var o=l[a];if(typeof o===c||o===b)return b;if(g&&typeof g.value===j)return g.value(o);if(h)return f.getValueByPath(o,h);if(($.type(o)===k||$.isNumeric(o))&&0===d)return o}else if(2===m){var o=l()[a];if(typeof o===c||o===b)return b;if(g&&typeof g.value===j)return g.value(o);if(h)return f.getValueByPath(o,h);if(($.type(o)===k||$.isNumeric(o))&&0===d)return o}else if(4===m){var p=i?i.getBindingPath(a,d):b;if(p)return l.getValue(p)}else if(3===m){var o=l.item(a);if(typeof o===c||o===b)return b;if(g&&typeof g.value===j)return g.value(o);if(h)return l.getProperty(o,h)}return b},a.prototype.setValue=function(a,d,e){var g=this;if(!g._dataSource)return!1;var h,i,j=g._sheet,k="function",l="string",m=g._dataSource,n=g._dataSourceType;if(4!==n){if(0>a||g.getRowCount()<=a)return!1;var o=j?j.getColumnCount():g.getColumnCount();if(0>d||d>=o)return!1;j&&j._colInfos?(h=j._colInfos[d],h&&(i=h.name)):g._fields&&(i=g._fields[d])}var p=!1;if(1===n){var q=m[a];q!==b&&typeof q!==c&&(h&&typeof h.value===k?(h.value(q,e),p=!0):i?(f.setValueByPath(q,i,e),p=!0):($.type(q)===l||$.isNumeric(q))&&0===d&&(m[a]=e,p=!0))}else if(2===n){var q=m()[a];q!==b&&typeof q!==c&&(h&&typeof h.value===k?(h.value(q,e),p=!0):i?(f.setValueByPath(q,i,e),p=!0):($.type(q)===l||$.isNumeric(q))&&0===d&&(m()[a]=e,p=!0))}else if(4===n){var r=j?j.getBindingPath(a,d):b;r&&(m.setValue(r,e),p=!0)}else if(3===n){var q=m.item(a);q!==b&&typeof q!==c&&(h&&typeof h.value===k?(h.value(q,e),p=!0):i&&(m.setProperty(q,i,e),p=!0))}return p},a.prototype.addItems=function(a,c){var d=this;if(d._dataSource&&!(a>d.getRowCount())){var e=d._dataSource,f=d._dataSourceType,g=d.getDataItemType();if(3===f){if(!d._dataViewUpdating){if(d._updatingDataView=!0,g){for(var h=0;c>h;h++){var i=g.createEntity?g.createEntity():new g;e.add(i)}e.commitEdit()}d._updatingDataView=!1}}else if(4===f);else for(var h=0;c>h;h++)if(g){var i=g.createEntity?g.createEntity():new g;e.splice(a,0,i)}else e.splice(a,0,b)}},a.prototype.removeItems=function(a,b){var c=this,d=c.getRowCount();if(c._dataSource&&!(a>=d)){var e=c._dataSource,f=c._dataSourceType,g=Math.min(b,d-a);if(3===f){if(!c._dataViewUpdating){c._updatingDataView=!0;for(var h=0;g>h;h++)e.remove(e.item(a));c._updatingDataView=!1}}else 4===f||d>a&&e.splice(a,g)}},a.isDataViewSource=function(a){var b=window.wijmo;return b&&b.data&&b.data.isDataView(a)},a.isCellBindingSource=function(a){return d&&a instanceof d||a&&a.hasOwnProperty("__cellBindingSource__")},a.prototype._init=function(){var a=this;a._dataSource=b,a._dataSourceType=0,a._dataItemType=b,a._fields=b,a._dataSourceSubscriptions=[],a._dataItemSubscriptions=[]},a.prototype._getDataSourceType=function(b){if(b){var c=window.ko;if(a.isDataViewSource(b))return 3;if(c&&c.isObservable(b))return 2;if(a.isCellBindingSource(b))return 4;if(b&&!isNaN(b.length))return 1}return 0},a.prototype._getDataLength=function(){var a=this._dataSource,b=this._dataSourceType;if(!a)return 0;var c=0;return 1===b?c=a.length:2===b?c=a().length:4===b||3===b&&(c=a.count()),c},a.prototype._getFieldsInfo=function(){var a=this,c=a._dataSource,d=a._dataSourceType,e=0,f=0,g=b;if(1===d){if(e=c.length,e>0){var h=a._getProperties(c[0]);if(h&&h.length>0){f=h.length,g=[];for(var i=0;f>i;i++)g.push(h[i])}}}else if(2===d){if(e=c().length,e>0){var h=a._getProperties(c()[0]);if(h&&h.length>0){f=h.length,g=[];for(var i=0;f>i;i++)g.push(h[i])}}}else if(4===d);else if(3===d){e=c.count();var h=c.getProperties();if(h&&h.length>0){f=h.length,g=[];for(var i=0;f>i;i++)g.push(h[i].name)}}return g},a.prototype._getProperties=function(a){var b=window.ko,d=[];for(var e in a)$.isFunction(a[e])?typeof b!==c&&b.isObservable(a[e])&&d.push(e):d.push(e);return d},a.prototype._dataChangedhandler=function(a){var c=this;if(!c._updatingDataView&&c._sheet){var d=c._sheet;d._bindToAutoRefresh(function(a){if(a){if(c._dataViewUpdating=!0,!isNaN(a.length)&&(d.setRowCount(a.length),(c._fields===b||void 0===c._fields)&&$.isEmptyObject(d._colInfos))){c._fields=c._getFieldsInfo(),d.setColumnCount(c.getColumnCount()),d._colInfos={};var e=c.getFields();if(e)for(var f in e)d._colInfos[f]={name:e[f]}}c._dataViewUpdating=!1}})(a)}},a.prototype._currentPositionChangedhandler=function(a){var b=this;if(b._dataSource&&b._sheet){var c=b._sheet,d=b._dataSource;c._bindToAutoRefresh(function(){if(d.currentPosition){var a=d.currentPosition();c._activeRowIndex!==a&&c.setActiveCell(a,c._activeColIndex)}})(a)}},a.prototype.toJSON=function(){var a=this._dataSource;if(!a)return b;var c=this._dataSourceType;return 2===c?a=a():4===c?a=a.getSource():3===c&&(a=a.local),{type:c,source:a}},a.prototype.fromJSON=function(a){var b=a&&a.source;if(b){var c=a.type;if(2===c){var e=window.ko;e&&e.observableArray&&this.bind(e.observableArray(b))}else this.bind(4===c?new d(b):b)}},a}();a._BindingManager=e;var f=function(){function a(){}return a.setValueByPath=function(a,b,d){if(a&&b)for(var e=window.ko,f="function",g=b.split("."),h=g.length,i=0;h>i;i++){var j=g[i];if(!a)break;i===h-1?typeof a[j]===f?(typeof e===c||!e.isObservable(a[j])||e.isWriteableObservable(a[j]))&&a[j](d):a[j]=d:a=typeof a[j]===f?a[j]():a[j]}},a.getValueByPath=function(a,d){if(!a||!d)return b;var e=d.split("."),f=e.length,g=0;do{var h=e[g];if(a="function"==typeof a[h]?a[h]():a[h],a===b||typeof a===c)return b}while(++g<f);return a},a}();a._BindingHelper=f,function(a){a[a.None=0]="None",a[a.Normal=1]="Normal",a[a.Knockout=2]="Knockout",a[a.DataView=3]="DataView",a[a.CellBinding=4]="CellBinding"}(a._DataSourceType||(a._DataSourceType={}));a._DataSourceType}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("table",["core.common","core.stringResource"]);var b=null,c=void 0,d=Math.min,e=Math.floor,f="undefined",g="Column",h=function(){function e(a,b,c,d,e,f){var g=this;g._init(),g._name=a,g._row=b,g._col=c,g._rowCount=d,g._colCount=e,g._style=f,g._columns=[];for(var h=0;h<g._colCount;h++){var j=new i(h+1);g._columns.push(j)}}return e.prototype.range=function(){var b=this;return new a.Range(b._row,b._col,b._rowCount,b._colCount)},e.prototype.dataRange=function(){var b=this,c=b._showHeader?b._row+1:b._row,d=b._showHeader?b._rowCount-1:b._rowCount;return b._showFooter&&d--,new a.Range(c,b._col,d,b._colCount)},e.prototype.name=function(a){return 0===arguments.length?this._name:(this._name=a,this)},e.prototype.headerIndex=function(){return this._showHeader?this._row:-1},e.prototype.footerIndex=function(){return this._showFooter?this._row+this._rowCount-1:-1},e.prototype.showHeader=function(a){var b=this;if(0===arguments.length)return b._showHeader;if(b._showHeader===a)return b;var c=b._showHeader=a;if(c)b._row>0&&(b._row=b._row-1,b._rowCount=b._rowCount+1),b._syncHeader();else{var d=b._row;b._row=b._row+1,b._rowCount=b._rowCount-1,b._clearSheetRow(d);var e=b._rowFilter;e&&(e.unfilter(),e.reset())}return b},e.prototype.showFooter=function(a){var b=this;if(0===arguments.length)return b._showFooter;if(b._showFooter===a)return b;var c=b._showFooter=a;if(c){var d=b._getSheet();(!d||b._row+b._rowCount<d.getRowCount())&&(b._rowCount=b._rowCount+1),b._syncFooter()}else{var e=b._row+b._rowCount-1;b._rowCount=b._rowCount-1,b._clearSheetRow(e)}return b},e.prototype.bandRows=function(a){return 0===arguments.length?this._bandRows:(this._bandRows=a,this)},e.prototype.bandColumns=function(a){return 0===arguments.length?this._bandColumns:(this._bandColumns=a,this)},e.prototype.highlightFirstColumn=function(a){return 0===arguments.length?this._highlightFirstColumn:(this._highlightFirstColumn=a,this)},e.prototype.highlightLastColumn=function(a){return 0===arguments.length?this._highlightLastColumn:(this._highlightLastColumn=a,this)},e.prototype.style=function(a){return 0===arguments.length?this._style:(this._style=a,this)},e.prototype.rowFilter=function(){var b=this;return!b._rowFilter&&a.features.filter&&(b._rowFilter=new a._TableFilter(b),b._rowFilter._updateRange(b.dataRange())),b._rowFilter},e.prototype.refresh=function(){this._bindingManager&&this._loadData()},e.prototype.getColumnName=function(c){var d=this._columns;if(d&&c>=0&&c<d.length){var e=d[c];if(e){var f=e.name();return f!==b&&(f=a.util.toString(f)),f}}return b},e.prototype.setColumnName=function(a,b){var c=this;if(c._hasColumnName(b))return c;var d=c._columns;if(d&&a>=0&&a<d.length){var e=d[a];if(e||(e=c._columns[a]=new i,e.id(c._newAutoId())),e.name(b),c._showHeader){var f=c._getSheet();f&&f.setText(c.headerIndex(),c._col+a,b)}}return c},e.prototype.getColumnFormula=function(a){var c=this._columns;if(c&&a>=0&&a<c.length){var d=c[a];if(d){var e=d.formula();return e?e.toUpperCase():e}}return b},e.prototype.setColumnFormula=function(a,b){var c=this,d=c._columns;if(d&&a>=0&&a<d.length){b&&"="===b[0]&&(b=b.substring(1));var e=d[a];if(e&&e.formula(b),c._showFooter){var f=c._getSheet();f&&f.setFormula(c.footerIndex(),c._col+a,b)}}return c},e.prototype.setColumnDataFormula=function(a,b){var c=this._columns;if(c&&a>=0&&a<c.length){b&&"="===b[0]&&(b=b.substring(1));var d=c[a];d&&this._setColumnDataAreaFormulaCore(d,b)}return this},e.prototype.getColumnValue=function(a){var c=this,d=c._columns;if(d&&a>=0&&a<d.length){var e=d[a];if(e){if(c._showFooter&&e.formula()){var f=c._getSheet();if(f)return f.getValue(c.footerIndex(),c._col+a)}return e.value()}}return b},e.prototype.setColumnValue=function(a,b){var c=this,d=c._columns;if(d&&a>=0&&a<d.length){var e=d[a];if(e&&e.value(b),c._showFooter){var f=c._getSheet();f&&f.setValue(c.footerIndex(),c._col+a,b)}}return c},e.prototype._setColumnDataAreaFormulaCore=function(a,b,c){if("undefined"==typeof c&&(c=!1),c||a.dataAreaFormula()!==b){var d=this;a.dataAreaFormula(b);var e=d._owner.getSheet();e.suspendCalcService();var f=d._getColumnIndex(a)+d._col,g=d._row,h=d._rowCount;d.showHeader()&&(g++,h--),d.showFooter()&&h--;for(var i=g;g+h>i;i++)e.setFormula(i,f,b);e.resumeCalcService()}},e.prototype._getColumnIndex=function(a){for(var b=0;b<this._columns.length;b++)if(this._columns[b]===a)return b;return-1},e.prototype._setOwner=function(a){this._owner=a},e.prototype._getSheet=function(){return this._owner?this._owner.getSheet():b},e.prototype._init=function(){var a=this;a._name=b,a._row=-1,a._col=-1,a._rowCount=-1,a._colCount=-1,a._style=b,a._showHeader=!0,a._showFooter=!1,a._highlightFirstColumn=!1,a._highlightLastColumn=!1,a._bandRows=!0,a._bandColumns=!1,a._bindingManager=b,a._columns=b,a._rowFilter=b,a._owner=b},e.prototype._bind=function(a){var b=this;if(b._bindingManager){var c=b._getSheet();if(c){var d=b.dataRange();c.clear(d.row,d.col,d.rowCount,d.colCount,3,17)}var e=b.range();b._clear(e.row,e.col,e.rowCount,e.colCount)}if(b._bindingManager=a,a){var f=b._bindingManager,g=f.getRowCount(),h=f.getColumnCount();b._showHeader&&g++,b._showFooter&&g++,b._rowCount=g,b._colCount=h,b._columns=[];for(var j=f.getFields(),k=0;k<b._colCount;k++){var l=new i(k+1);b._columns.push(l),j&&l.name(j[k])}b._loadData()}},e.prototype._loadData=function(){var a=this;if(a._bindingManager){var b=a._getSheet();if(b)for(var c=a._bindingManager,d=a.dataRange(),e=d.row,f=d.col,g=d.rowCount,h=d.colCount,i=0;g>i;i++)for(var j=0;h>j;j++)b.setValue(e+i,f+j,c.getValue(i,j))}},e.prototype._compose=function(b,c,d){var e=this,f=e._style;if(f){var g=e._getSheet();if(!(g&&g.getRowHeight(b)<=0)){var h=e.headerIndex(),i=e.footerIndex(),j=e._showHeader?b===e._row+1:b===e._row,k=e._showFooter?b===e._row+e._rowCount-2:b===e._row+e._rowCount-1,l=c===e._col,m=c===e._col+e._colCount-1,n=e._showHeader?b===h:b===e._row,o=e._showFooter?b===i:b===e._row+e._rowCount-1,p=f.highlightLastColumnStyle(),q=f.highlightFirstColumnStyle();if(h===b){var r=f.lastHeaderCellStyle();m&&e._highlightLastColumn&&r&&r._compose(d,!0,!0,!0,!0);var s=f.firstHeaderCellStyle();l&&e._highlightFirstColumn&&s&&s._compose(d,!0,!0,!0,!0);var t=f.headerRowStyle();t&&t._compose(d,!0,l,!0,m),m&&e._highlightLastColumn&&p&&p._compose(d,!0,!0,!1,!0),l&&e._highlightFirstColumn&&q&&q._compose(d,!0,!0,!1,!0)}else if(i===b){var u=f.lastFooterCellStyle();m&&e._highlightLastColumn&&u&&u._compose(d,!0,!0,!0,!0);var v=f.firstFooterCellStyle();l&&e._highlightFirstColumn&&v&&v._compose(d,!0,!0,!0,!0);var w=f.footerRowStyle();w&&w._compose(d,!0,l,!0,m),m&&e._highlightLastColumn&&p&&p._compose(d,!1,!0,!0,!0),l&&e._highlightFirstColumn&&q&&q._compose(d,!1,!0,!0,!0)}else{m&&e._highlightLastColumn&&p&&p._compose(d,n,!0,o,!0),l&&e._highlightFirstColumn&&q&&q._compose(d,n,!0,o,!0);var x=e._showHeader?b-e._row-1:b-e._row,y=c-e._col;if(a._CatchMgr._catched&&a._CatchMgr._visibleRowIndexCatch){for(var z=a._CatchMgr._visibleRowIndexCatch,A=e.dataRange().row;-1===z[A];)A++;if(A>b)return;x=z[b]-z[A]}else if(g){for(var B=0,C=0,A=e.dataRange().row;b>A;A++)g.getRowHeight(A)>0&&B++;for(var D=e._col;c>D;D++)g.getColumnWidth(D)>0&&C++;x=B,y=C}if(e.bandRows()){var E=f.firstRowStripSize(),F=E+f.secondRowStripSize();if(F>0){var G=x%F,H=f.firstRowStripStyle(),I=f.secondRowStripStyle();if(E>G&&H){var J=0===G,K=k||G===E-1;H._compose(d,J,l,K,m)}else if(G>=E&&I){var J=G===E,K=k||G===F-1;I._compose(d,J,l,K,m)}}}if(e.bandColumns()){var L=f.firstColumnStripSize(),F=L+f.secondColumnStripSize();if(F>0){var G=y%F,M=f.firstColumnStripStyle(),N=f.secondColumnStripStyle();if(L>G&&M){var O=0===G,P=m||G===L-1;M._compose(d,j,O,k,P)}else if(G>=L&&N){var O=G===L,P=m||G===F-1;N._compose(d,j,O,k,P)}}}}var Q=f.wholeTableStyle();Q&&Q._compose(d,n,l,o,m)}}},e.prototype._moveTo=function(b,c){var d=this;if(b!==d._row||c!==d._col){var e=d._getSheet();if(e){if(0>b||e.getRowCount()<b+d._rowCount)throw new Error(a.SR.Exp_TableMoveOutOfRange);if(0>c||e.getColumnCount()<c+d._colCount)throw new Error(a.SR.Exp_TableMoveOutOfRange);e.moveTo(d._row,d._col,b,c,d._rowCount,d._colCount,1)}d._row=b,d._col=c,d._updateFilter()}},e.prototype._resize=function(b,c){var d=this;if(b!==d._rowCount||c!==d._colCount){var e=0,f=1;if(d._showHeader&&(e+=1),d._showFooter&&(e+=1),e>b||f>c)throw new Error(a.SR.Exp_TableResizeOutOfRange);var g=d._getSheet();if(g&&(d._row+b>g.getRowCount()||d._col+c>g.getColumnCount()))throw new Error(a.SR.Exp_TableResizeOutOfRange);var h=d._columns,j=d._colCount;if(d._colCount=c,c>j){for(var k=c-j,l=0;k>l;l++){var m=new i;h.push(m),m.id(d._newAutoId())}d._showHeader&&d._syncHeader(j,k),d._showFooter&&d._syncFooter(j,k)}else if(j>c){var n=j-c;h.splice(c,n)}if(b!==d._rowCount){var o,p=d._showFooter;p&&(d._syncFooter(),o=d.footerIndex()),d._rowCount=b,p&&(d._syncSheetByFooter(),d._clearSheetRow(o))}d._updateFilter()}},e.prototype._updateFilter=function(){var a=this,b=a._rowFilter;b&&(b._updateRange(a.dataRange()),b.reFilter())},e.prototype._hasColumnName=function(c){c!==b&&(c=a.util.toString(c));for(var d=0;d<this._colCount;d++){var e=this.getColumnName(d);if(c===e)return!0}return!1},e.prototype._setHeader=function(a,b,c){var d=this;if(d._showHeader&&d.headerIndex()===a&&d._columns){var e=b-d._col,f=d._columns;if(e>=0&&e<f.length){var g=f[e];g&&g.name(c)}}},e.prototype._setFooterFormula=function(a,b,c){var d=this;if(d._showFooter&&d.footerIndex()===a&&d._columns){var e=b-d._col,f=d._columns;if(e>=0&&e<f.length){var g=f[e];g&&g.formula(c)}}},e.prototype._setFooterValue=function(a,b,c){var d=this;if(d._showFooter&&d.footerIndex()===a&&d._columns){var e=b-d._col,f=d._columns;if(e>=0&&e<f.length){var g=f[e];g&&g.value(c)}}},e.prototype._getColumn=function(a){var c=this.range();return c.col<=a&&a<c.col+c.colCount?this._columns[a-c.col]:b},e.prototype._newAutoId=function(){if(!this._columns||0===this._columns.length)return-1;for(var a,b=this._columns,c=[],d=b.length,e=0;d>e;e++)a=b[e],a&&a.isAutoId()&&c.push(a.id());if(c.sort(function(a,b){return a-b}),d=c.length,d>0){for(var e=0;d>e;e++)if(c[e]!==e+1)return e+1;return d+1}return 1},e.prototype._syncHeader=function(a,d){var e,f=this;if(f._showHeader&&f._columns&&(e=f._getSheet())){var g,h=f.headerIndex(),i=f._col,j=f._columns;(a===c||a===b)&&(a=0),(d===c||d===b)&&(d=j.length);for(var k,l=a;d>l;l++)g=j[l],g&&(k=e.getText(h,i+l),e.setFormula(h,i+l,b),k?g.name(k):e.setText(h,i+l,g.name()))}},e.prototype._syncFooter=function(a,d){var e,f=this;if(f._showFooter&&f._columns&&(e=f._getSheet())){var g,h=f.footerIndex(),i=f._col,j=f._columns;(a===c||a===b)&&(a=0),(d===c||d===b)&&(d=j.length);for(var k,l,m=a;d>m;m++)g=j[m],g&&(k=e.getFormula(h,i+m),k?g.formula(k):e.setFormula(h,i+m,g.formula()),l=e.getValue(h,i+m),l!==c&&l!==b?g.value(l):e.setValue(h,i+m,g.value()))}},e.prototype._clearHeader=function(a,e){if(this._showHeader&&this._columns){var f,g=this._columns;(a===c||a===b)&&(a=0),(e===c||e===b)&&(e=g.length);for(var h=d(g.length,a+e),i=a;h>i;i++)f=g[i],f&&f.name(b)}},e.prototype._clearFooter=function(a,e){if(this._showFooter&&this._columns){var f,g=this._columns;(a===c||a===b)&&(a=0),(e===c||e===b)&&(e=g.length);for(var h=d(g.length,a+e),i=a;h>i;i++)f=g[i],f&&(f.formula(b),f.value(b))}},e.prototype._syncSheetByFooter=function(){var a=this;if(a._showFooter&&a._columns){var b=a._getSheet();if(b)for(var c,d,e=a._columns,f=e.length,g=a._col,h=a.footerIndex(),i=0;f>i;i++)c=e[i],c&&(d=g+i,b.setValue(h,d,c.value()),b.setFormula(h,d,c.formula()))}},e.prototype._clearSheetRow=function(a){var c=this._getSheet();if(c&&!(0>a||c.getRowCount()<=a))for(var d,e=this._col,f=this._colCount,g=0;f>g;g++)d=e+g,c.setFormula(a,d,b),c.setValue(a,d,b)},e.prototype._addRows=function(a,b){var c=this;if(!(a>=c._row+c._rowCount)){var d=c._columns,e=c._row,f=c._row+c._rowCount-1;if(e>=a)c._row+=b;else if(f>=a){c._rowCount+=b;var g=c._owner.getSheet();g.suspendCalcService();for(var h=0;h<d.length;h++){var i=d[h],j=i.dataAreaFormula();if(j)for(var k=h+c._col,l=a;a+b>l;l++)g.setFormula(l,k,j)}g.resumeCalcService()}c._rowFilter&&c._rowFilter._addRows(a,b)}},e.prototype._addColumns=function(a,b){var c=this;if(!(a>=c._col+c._colCount)){if(a<=c._col)c._col+=b;else if(a<c._col+c._colCount){c._colCount+=b;var d=c._columns;if(d)for(var e=0;b>e;e++){var f=new i;d.splice(a+e-c._col,0,f),f.id(c._newAutoId())}}c._rowFilter&&c._rowFilter._addColumns(a,b)}},e.prototype._removeRows=function(a,b){var c=this;if(!(a>=c._row+c._rowCount)){var e=c._row,f=c._row+c._rowCount-1;e>a?a+b>e||(c._row-=b):a===e?c._showHeader||(c._rowCount-=d(f-a+1,b)):f>=a&&(c._rowCount-=d(f-a+1,b),a===f&&c._showFooter&&(c._showFooter=!1)),c._rowFilter&&c._rowFilter._removeRows(a,b)}},e.prototype._removeColumns=function(a,b){var c=this;if(!(a>=c._col+c._colCount)){var e=c._col,f=c._col+c._colCount-1;if(e>a)if(e>=a+b)c._col-=b;else{c._col=a,c._colCount-=a+b-e;var g=c._columns;g&&g.splice(0,a+b-e)}else{c._colCount-=d(f-a+1,b);var g=c._columns;g&&g.splice(a-e,d(f-a+1,b))}c._rowFilter&&c._rowFilter._removeColumns(a,b)}},e.prototype._clear=function(b,c,d,e){var f=this,g=d,h=e,i=f._getSheet();i&&(g=i.getRowCount(),h=i.getColumnCount());var j=0>b?0:b,k=0>c?0:c,l=0>b?g:d,m=0>c?h:e,n=new a.Range(j,k,l,m),o=f.headerIndex();if(f._showHeader&&o>=j&&j+l>o){var p=new a.Range(o,f._col,1,f._colCount),q=n.getIntersect(p,g,h);q&&f._clearHeader(q.col-f._col,q.colCount)}var r=f.footerIndex();if(f._showFooter&&r>=j&&j+l>r){var s=new a.Range(r,f._col,1,f._colCount),q=n.getIntersect(s,g,h);q&&f._clearFooter(q.col-f._col,q.colCount)}f._rowFilter&&f._rowFilter._clear(b,c,d,e)},e.prototype._copy=function(){},e.prototype._move=function(){},e.prototype._isDefaultValue=function(a,c){switch(a){case"name":return c===b;case"row":return-1===c;case"col":return-1===c;case"rowCount":return-1===c;case"colCount":return-1===c;case"showHeader":return c===!0;case"showFooter":return c===!1;case"highlightFirstColumn":return c===!1;case"highlightLastColumn":return c===!1;case"bandRows":return c===!0;case"bandColumns":return c===!1;case"style":return c===b;case"dataBinding":return c===b;case"columns":return c===b;case"rowFilter":return c===b;default:return!1}},e.prototype.toJSON=function(){var a=this,d={name:a._name,row:a._row,col:a._col,rowCount:a._rowCount,colCount:a._colCount,showHeader:a._showHeader,showFooter:a._showFooter,highlightFirstColumn:a._highlightFirstColumn,highlightLastColumn:a._highlightLastColumn,bandRows:a._bandRows,bandColumns:a._bandColumns,style:a._style?a._style.toJSON():b,dataBinding:a._bindingManager?a._bindingManager.toJSON():b,columns:a._columns,rowFilter:a._rowFilter?a._rowFilter.toJSON():b},e={};for(var f in d){var g=d[f];a._isDefaultValue(f,g)||(e[f]=g)}return $.isEmptyObject(e)?c:e},e.prototype.fromJSON=function(b){if(b){var c=this;if(typeof b.name!==f&&(c._name=b.name),typeof b.row!==f&&(c._row=b.row),typeof b.col!==f&&(c._col=b.col),typeof b.rowCount!==f&&(c._rowCount=b.rowCount),typeof b.colCount!==f&&(c._colCount=b.colCount),typeof b.showHeader!==f&&(c._showHeader=b.showHeader),typeof b.showFooter!==f&&(c._showFooter=b.showFooter),typeof b.highlightFirstColumn!==f&&(c._highlightFirstColumn=b.highlightFirstColumn),typeof b.highlightLastColumn!==f&&(c._highlightLastColumn=b.highlightLastColumn),typeof b.bandRows!==f&&(c._bandRows=b.bandRows),typeof b.bandColumns!==f&&(c._bandColumns=b.bandColumns),b.style){var d=new k;d.fromJSON(b.style),c._style=d}if(b.dataSource&&a.features.binding&&(c._bindingManager=new a._BindingManager,c._bindingManager.bind(b.dataSource)),b.dataBinding&&a.features.binding&&(c._bindingManager=new a._BindingManager,c._bindingManager.fromJSON(b.dataBinding)),b.columns){for(var e,g,h=b.columns,j=h.length,l=[],m=0;j>m;m++){g=h[m],e=new i;var n=g.id?g.id:g._id,o=g.name?g.name:g._name,p=g.fvalue?g.fvalue:g._fvalue,q=g.fformular?g.fformula:g._fformula,r=g.dataAreaFormula?g.dataAreaFormula:g._dataAreaFormula;e.id(n).name(o).value(p).formula(q).dataAreaFormula(r),l.push(e)}c._columns=l;for(var m=0;j>m;m++)e=l[m],e.isAutoId()||e.id(c._newAutoId())}if(b.rowFilter&&a.features.filter){var s=b.rowFilter,t=new a._TableFilter;t.table(c),t.fromJSON(s),c._rowFilter=t}}},e.prototype.startRow=function(){return this._row},e.prototype.startColumn=function(){return this._col},e.prototype.endRow=function(){return this._row+this._rowCount-1},e.prototype.endColumn=function(){return this._col+this._colCount-1},e.prototype.hasHeadersRow=function(){return this._showHeader},e.prototype.hasTotalsRow=function(){return this._showFooter},e.prototype.tableName=function(){return this._name},e.prototype.getColumnIndexInTable=function(a){for(var b=0;b<this._columns.length;b++){var c=this._columns[b];if(c.name()===a||c.name().toString().toLowerCase()===a.toLowerCase())return b}return-1},e.prototype.source=function(){return this._owner.getSheet()._getSheetSource()},e}();a.SheetTable=h;var i=function(){function a(a){var c=this;c._id=a,c._name=b,c._fformula=b,c._fvalue=b}return a.prototype.id=function(a){var b=this;return 0===arguments.length?b._id:(b._id=a,b._name||(b._name=g+b._id),b)},a.prototype.isAutoId=function(){return this._id>0?!0:!1},a.prototype.name=function(a){var b=this;return 0===arguments.length?b._name?b._name:g+b._id:(b._name=a,b)},a.prototype.value=function(a){return 0===arguments.length?this._fvalue:(this._fvalue=a,this)},a.prototype.dataAreaFormula=function(a){return 0===arguments.length?this._dataAreaFormula:(this._dataAreaFormula=a,this)},a.prototype.formula=function(a){return 0===arguments.length?this._fformula:(this._fformula=a,this)},a.prototype._isDefaultValue=function(a,c){switch(a){case"name":return c===b;case"fformula":return c===b;case"fvalue":return c===b;default:return!1}},a.prototype.toJSON=function(){var a=this,b={id:a._id,name:a._name,fformula:a._fformula,dataAreaFormula:a._dataAreaFormula,fvalue:a._fvalue},d={};for(var e in b){var f=b[e];a._isDefaultValue(e,f)||(d[e]=f)}return $.isEmptyObject(d)?c:d},a}();a._TableColumn=i;var j=function(){function b(a,b,c,d,e,f,g,h,i){var j=this;j.backColor=a,j.foreColor=b,j.font=c,j.borderLeft=d,j.borderTop=e,j.borderRight=f,j.borderBottom=g,j.borderHorizontal=h,j.borderVertical=i}return b.prototype._compose=function(a,b,c,d,e){var g=this;typeof g.backColor!==f&&typeof a.backColor===f&&(a.backColor=g.backColor),typeof g.foreColor!==f&&typeof a.foreColor===f&&(a.foreColor=g.foreColor),typeof g.font!==f&&typeof a.font===f&&(a.font=g.font),c&&typeof g.borderLeft!==f&&typeof a.borderLeft===f&&(a.borderLeft=g.borderLeft),b&&typeof g.borderTop!==f&&typeof a.borderTop===f&&(a.borderTop=g.borderTop),e&&typeof g.borderRight!==f&&typeof a.borderRight===f&&(a.borderRight=g.borderRight),d&&typeof g.borderBottom!==f&&typeof a.borderBottom===f&&(a.borderBottom=g.borderBottom),d||typeof g.borderHorizontal===f||typeof a.borderBottom!==f||(a.borderBottom=g.borderHorizontal),e||typeof g.borderVertical===f||typeof a.borderRight!==f||(a.borderRight=g.borderVertical)},b.prototype.toJSON=function(){var a=this;return{backColor:a.backColor,foreColor:a.foreColor,font:a.font,borderLeft:a.borderLeft?a.borderLeft.toJSON():a.borderLeft,borderTop:a.borderTop?a.borderTop.toJSON():a.borderTop,borderRight:a.borderRight?a.borderRight.toJSON():a.borderRight,borderBottom:a.borderBottom?a.borderBottom.toJSON():a.borderBottom,borderHorizontal:a.borderHorizontal?a.borderHorizontal.toJSON():a.borderHorizontal,borderVertical:a.borderVertical?a.borderVertical.toJSON():a.borderVertical}},b.prototype.fromJSON=function(b){if(b){var c=this;if(typeof b.backColor!==f&&(c.backColor=b.backColor),typeof b.foreColor!==f&&(c.foreColor=b.foreColor),typeof b.font!==f&&(c.font=b.font),typeof b.borderLeft!==f){var d=new a.LineBorder;d.fromJSON(b.borderLeft),c.borderLeft=d}if(typeof b.borderTop!==f){var e=new a.LineBorder;e.fromJSON(b.borderTop),c.borderTop=e}if(typeof b.borderRight!==f){var g=new a.LineBorder;g.fromJSON(b.borderRight),c.borderRight=g}if(typeof b.borderBottom!==f){var h=new a.LineBorder;h.fromJSON(b.borderBottom),c.borderBottom=h}if(typeof b.borderHorizontal!==f){var i=new a.LineBorder;i.fromJSON(b.borderHorizontal),c.borderHorizontal=i}if(typeof b.borderVertical!==f){var j=new a.LineBorder;j.fromJSON(b.borderVertical),c.borderVertical=j}}},b}();a.TableStyleInfo=j;var k=function(){function a(){this._lastFooterCellStyle=b,this._init()}return a.prototype.name=function(a){return 0===arguments.length?this._name:(this._name=a,this)},a.prototype.wholeTableStyle=function(a){return 0===arguments.length?this._wholeTableStyle:(this._wholeTableStyle=a,this)
},a.prototype.headerRowStyle=function(a){return 0===arguments.length?this._headerRowStyle:(this._headerRowStyle=a,this)},a.prototype.footerRowStyle=function(a){return 0===arguments.length?this._footerRowStyle:(this._footerRowStyle=a,this)},a.prototype.firstRowStripStyle=function(a){return 0===arguments.length?this._firstRowStripStyle:(this._firstRowStripStyle=a,this)},a.prototype.secondRowStripStyle=function(a){return 0===arguments.length?this._secondRowStripStyle:(this._secondRowStripStyle=a,this)},a.prototype.firstRowStripSize=function(a){return 0===arguments.length?this._firstRowStripSize:(this._firstRowStripSize=a,this)},a.prototype.secondRowStripSize=function(a){return 0===arguments.length?this._secondRowStripSize:(this._secondRowStripSize=a,this)},a.prototype.firstColumnStripStyle=function(a){return 0===arguments.length?this._firstColumnStripStyle:(this._firstColumnStripStyle=a,this)},a.prototype.secondColumnStripStyle=function(a){return 0===arguments.length?this._secondColumnStripStyle:(this._secondColumnStripStyle=a,this)},a.prototype.firstColumnStripSize=function(a){return 0===arguments.length?this._firstColumnStripSize:(this._firstColumnStripSize=a,this)},a.prototype.secondColumnStripSize=function(a){return 0===arguments.length?this._secondColumnStripSize:(this._secondColumnStripSize=a,this)},a.prototype.highlightFirstColumnStyle=function(a){return 0===arguments.length?this._highlightFirstColumnStyle:(this._highlightFirstColumnStyle=a,this)},a.prototype.highlightLastColumnStyle=function(a){return 0===arguments.length?this._highlightLastColumnStyle:(this._highlightLastColumnStyle=a,this)},a.prototype.firstHeaderCellStyle=function(a){return 0===arguments.length?this._firstHeaderCellStyle:(this._firstHeaderCellStyle=a,this)},a.prototype.lastHeaderCellStyle=function(a){return 0===arguments.length?this._lastHeaderCellStyle:(this._lastHeaderCellStyle=a,this)},a.prototype.firstFooterCellStyle=function(a){return 0===arguments.length?this._firstFooterCellStyle:(this._firstFooterCellStyle=a,this)},a.prototype.lastFooterCellStyle=function(a){return 0===arguments.length?this._lastFooterCellStyle:(this._lastFooterCellStyle=a,this)},a.prototype._init=function(){var a=this;a._name=b,a._headerRowStyle=b,a._footerRowStyle=b,a._wholeTableStyle=b,a._highlightLastColumnStyle=b,a._highlightFirstColumnStyle=b,a._firstRowStripStyle=b,a._secondRowStripStyle=b,a._firstColumnStripStyle=b,a._secondColumnStripStyle=b,a._firstHeaderCellStyle=b,a._lastHeaderCellStyle=b,a._firstFooterCellStyle=b,a._lastFooterCellStyle=b,a._firstRowStripSize=1,a._secondRowStripSize=1,a._firstColumnStripSize=1,a._secondColumnStripSize=1},a.prototype._isDefaultValue=function(a,c){switch(a){case"name":return c===b;case"headerRowStyle":return c===b;case"footerRowStyle":return c===b;case"wholeTableStyle":return c===b;case"highlightLastColumnStyle":return c===b;case"highlightFirstColumnStyle":return c===b;case"firstRowStripStyle":return c===b;case"secondRowStripStyle":return c===b;case"firstColumnStripStyle":return c===b;case"secondColumnStripStyle":return c===b;case"firstHeaderCellStyle":return c===b;case"lastHeaderCellStyle":return c===b;case"firstFooterCellStyle":return c===b;case"lastFooterCellStyle":return c===b;case"firstRowStripSize":return 1===c;case"secondRowStripSize":return 1===c;case"firstColumnStripSize":return 1===c;case"secondColumnStripSize":return 1===c;default:return!1}},a.prototype.toJSON=function(){var a=this,b={name:a._name,firstRowStripSize:a._firstRowStripSize,secondRowStripSize:a._secondRowStripSize,firstColumnStripSize:a._firstColumnStripSize,secondColumnStripSize:a._secondColumnStripSize},d=a._headerRowStyle;b.headerRowStyle=d?d.toJSON():d,d=a._footerRowStyle,b.footerRowStyle=d?d.toJSON():d,d=a._wholeTableStyle,b.wholeTableStyle=d?d.toJSON():d,d=a._highlightLastColumnStyle,b.highlightLastColumnStyle=d?d.toJSON():d,d=a._highlightFirstColumnStyle,b.highlightFirstColumnStyle=d?d.toJSON():d,d=a._firstRowStripStyle,b.firstRowStripStyle=d?d.toJSON():d,d=a._secondRowStripStyle,b.secondRowStripStyle=d?d.toJSON():d,d=a._firstColumnStripStyle,b.firstColumnStripStyle=d?d.toJSON():d,d=a._secondColumnStripStyle,b.secondColumnStripStyle=d?d.toJSON():d,d=a._firstHeaderCellStyle,b.firstHeaderCellStyle=d?d.toJSON():d,d=a._lastHeaderCellStyle,b.lastHeaderCellStyle=d?d.toJSON():d,d=a._firstFooterCellStyle,b.firstFooterCellStyle=d?d.toJSON():d,d=a._lastFooterCellStyle,b.lastFooterCellStyle=d?d.toJSON():d;var e={};for(var f in b){var g=b[f];a._isDefaultValue(f,g)||(e[f]=g)}return $.isEmptyObject(e)?c:e},a.prototype.fromJSON=function(a){if(a){var b=this,c=typeof a.name!==f?a.name:a._name;typeof c!==f&&(b._name=c);var d=typeof a.firstRowStripSize!==f?a.firstRowStripSize:a._firstRowStripSize;typeof d!==f&&(b._firstRowStripSize=d);var e=typeof a.secondRowStripSize!==f?a.secondRowStripSize:a._secondRowStripSize;typeof e!==f&&(b._secondRowStripSize=e);var g=typeof a.firstColumnStripSize!==f?a.firstColumnStripSize:a._firstColumnStripSize;typeof g!==f&&(b._firstColumnStripSize=g);var h=typeof a.secondColumnStripSize!==f?a.secondColumnStripSize:a._secondColumnStripSize;typeof h!==f&&(b._secondColumnStripSize=h);var i=typeof a.headerRowStyle!==f?a.headerRowStyle:a._headerRowStyle;if(typeof i!==f){var k=new j;k.fromJSON(i),b._headerRowStyle=k}var l=typeof a.footerRowStyle!==f?a.footerRowStyle:a._footerRowStyle;if(typeof l!==f){var k=new j;k.fromJSON(l),b._footerRowStyle=k}var m=typeof a.wholeTableStyle!==f?a.wholeTableStyle:a._wholeTableStyle;if(typeof m!==f){var k=new j;k.fromJSON(m),b._wholeTableStyle=k}var n=typeof a.highlightLastColumnStyle!==f?a.highlightLastColumnStyle:a._highlightLastColumnStyle;if(typeof n!==f){var k=new j;k.fromJSON(n),b._highlightLastColumnStyle=k}var o=typeof a.highlightFirstColumnStyle!==f?a.highlightFirstColumnStyle:a._highlightFirstColumnStyle;if(typeof o!==f){var k=new j;k.fromJSON(o),b._highlightFirstColumnStyle=k}var p=typeof a.firstRowStripStyle!==f?a.firstRowStripStyle:a._firstRowStripStyle;if(typeof p!==f){var k=new j;k.fromJSON(p),b._firstRowStripStyle=k}var q=typeof a.secondRowStripStyle!==f?a.secondRowStripStyle:a._secondRowStripStyle;if(typeof q!==f){var k=new j;k.fromJSON(q),b._secondRowStripStyle=k}var r=typeof a.firstColumnStripStyle!==f?a.firstColumnStripStyle:a._firstColumnStripStyle;if(typeof r!==f){var k=new j;k.fromJSON(r),b._firstColumnStripStyle=k}var s=typeof a.secondColumnStripStyle!==f?a.secondColumnStripStyle:a._secondColumnStripStyle;if(typeof s!==f){var k=new j;k.fromJSON(s),b._secondColumnStripStyle=k}var t=typeof a.firstHeaderCellStyle!==f?a.firstHeaderCellStyle:a._firstHeaderCellStyle;if(typeof t!==f){var k=new j;k.fromJSON(t),b._firstHeaderCellStyle=k}var u=typeof a.lastHeaderCellStyle!==f?a.lastHeaderCellStyle:a._lastHeaderCellStyle;if(typeof u!==f){var k=new j;k.fromJSON(u),b._lastHeaderCellStyle=k}var v=typeof a.firstFooterCellStyle!==f?a.firstFooterCellStyle:a._firstFooterCellStyle;if(typeof v!==f){var k=new j;k.fromJSON(v),b._firstFooterCellStyle=k}var w=typeof a.lastFooterCellStyle!==f?a.lastFooterCellStyle:a._lastFooterCellStyle;if(typeof w!==f){var k=new j;k.fromJSON(w),b._lastFooterCellStyle=k}}},a}();a.TableStyle=k;var l=function(){function c(){}return c.light1=function(){return c._getLightStyle(1)},c.light2=function(){return c._getLightStyle(2)},c.light3=function(){return c._getLightStyle(3)},c.light4=function(){return c._getLightStyle(4)},c.light5=function(){return c._getLightStyle(5)},c.light6=function(){return c._getLightStyle(6)},c.light7=function(){return c._getLightStyle(7)},c.light8=function(){return c._getLightStyle(8)},c.light9=function(){return c._getLightStyle(9)},c.light10=function(){return c._getLightStyle(10)},c.light11=function(){return c._getLightStyle(11)},c.light12=function(){return c._getLightStyle(12)},c.light13=function(){return c._getLightStyle(13)},c.light14=function(){return c._getLightStyle(14)},c.light15=function(){return c._getLightStyle(15)},c.light16=function(){return c._getLightStyle(16)},c.light17=function(){return c._getLightStyle(17)},c.light18=function(){return c._getLightStyle(18)},c.light19=function(){return c._getLightStyle(19)},c.light20=function(){return c._getLightStyle(20)},c.light21=function(){return c._getLightStyle(21)},c.medium1=function(){return c._getMediumStyle(1)},c.medium2=function(){return c._getMediumStyle(2)},c.medium3=function(){return c._getMediumStyle(3)},c.medium4=function(){return c._getMediumStyle(4)},c.medium5=function(){return c._getMediumStyle(5)},c.medium6=function(){return c._getMediumStyle(6)},c.medium7=function(){return c._getMediumStyle(7)},c.medium8=function(){return c._getMediumStyle(8)},c.medium9=function(){return c._getMediumStyle(9)},c.medium10=function(){return c._getMediumStyle(10)},c.medium11=function(){return c._getMediumStyle(11)},c.medium12=function(){return c._getMediumStyle(12)},c.medium13=function(){return c._getMediumStyle(13)},c.medium14=function(){return c._getMediumStyle(14)},c.medium15=function(){return c._getMediumStyle(15)},c.medium16=function(){return c._getMediumStyle(16)},c.medium17=function(){return c._getMediumStyle(17)},c.medium18=function(){return c._getMediumStyle(18)},c.medium19=function(){return c._getMediumStyle(19)},c.medium20=function(){return c._getMediumStyle(20)},c.medium21=function(){return c._getMediumStyle(21)},c.medium22=function(){return c._getMediumStyle(22)},c.medium23=function(){return c._getMediumStyle(23)},c.medium24=function(){return c._getMediumStyle(24)},c.medium25=function(){return c._getMediumStyle(25)},c.medium26=function(){return c._getMediumStyle(26)},c.medium27=function(){return c._getMediumStyle(27)},c.medium28=function(){return c._getMediumStyle(28)},c.dark1=function(){return c._getDarkStyle(1)},c.dark2=function(){return c._getDarkStyle(2)},c.dark3=function(){return c._getDarkStyle(3)},c.dark4=function(){return c._getDarkStyle(4)},c.dark5=function(){return c._getDarkStyle(5)},c.dark6=function(){return c._getDarkStyle(6)},c.dark7=function(){return c._getDarkStyle(7)},c.dark8=function(){return c._getDarkStyle(8)},c.dark9=function(){return c._getDarkStyle(9)},c.dark10=function(){return c._getDarkStyle(10)},c.dark11=function(){return c._getDarkStyle(11)},c.customStyles=function(){var a=c._customStyles;return a?a:b},c.addCustomStyles=function(b){if(b){c._customStyles||(c._customStyles=[]);for(var d,e=c._customStyles,f=e.length,g=0;f>g;g++)if(d=e[g],d.name()===b.name())throw new Error(a.SR.Exp_TableStyleAddCustomStyleError);e.push(b)}},c.removeCustomStyle=function(b){if(!b)return!1;var d=c._customStyles;if(d){var e=a.util.inArray(b,d);if(e>-1)return d.splice(e,1),!0}return!1},c.removeCustomStyleByName=function(a){var b=c._customStyles;if(b)for(var d,e=b.length,f=0;e>f;f++)if(d=b[f],d.name()===a)return b.splice(f,1),!0;return!1},c._getLightStyle=function(a){var d=a-1;if(typeof c._lights===f&&(c._lights={}),c._lights[d])return c._lights[d];var g=b;switch(e(d/7)){case 0:g=c._createLightA(d%7);break;case 1:g=c._createLightB(d%7);break;case 2:g=c._createLightC(d%7)}return g?(g.name("Light"+a),c._lights[d]=g,g):b},c._createLightA=function(b){var d=c._getTheme(b),e=d+" 80",f=d,g=new k,h=new j;h.borderBottom=new a.LineBorder(f,1),h.font="bold 10pt arial",h.foreColor=f,g.headerRowStyle(h);var i=new j;i.borderTop=new a.LineBorder(f,1),i.borderBottom=new a.LineBorder(f,1),i.foreColor=f,g.wholeTableStyle(i);var l=new j;l.backColor=e,g.firstRowStripStyle(l);var m=new j;m.font="bold 10pt arial",m.foreColor=f,g.highlightFirstColumnStyle(m);var n=new j;n.font="bold 10pt arial",n.foreColor=f,g.highlightLastColumnStyle(n);var o=new j;o.backColor=e,g.firstColumnStripStyle(o);var p=new j;return p.borderTop=new a.LineBorder(f,1),p.font="bold 10pt arial",p.foreColor=f,g.footerRowStyle(p),g},c._createLightB=function(b){var d=c._getTheme(b),e=d,f=new k,g=new j;g.backColor=e,g.font="bold 10pt arial",g.foreColor="white",f.headerRowStyle(g);var h=new j;h.borderLeft=new a.LineBorder(e,1),h.borderTop=new a.LineBorder(e,1),h.borderBottom=new a.LineBorder(e,1),h.borderRight=new a.LineBorder(e,1),f.wholeTableStyle(h);var i=new j;i.borderTop=new a.LineBorder(e,1),f.firstRowStripStyle(i);var l=new j;l.borderTop=new a.LineBorder(e,1),f.secondRowStripStyle(l);var m=new j;m.borderLeft=new a.LineBorder(e,1),f.firstColumnStripStyle(m);var n=new j;n.borderLeft=new a.LineBorder(e,1),f.secondColumnStripStyle(n);var o=new j;o.font="bold 10pt arial",f.highlightFirstColumnStyle(o);var p=new j;p.font="bold 10pt arial",f.highlightLastColumnStyle(p);var q=new j;return q.borderTop=new a.LineBorder(e,6),q.font="bold 10pt arial",f.footerRowStyle(q),f},c._createLightC=function(b){var d=c._getTheme(b),e=d+" 80",f=d,g=new k,h=new j;h.borderBottom=new a.LineBorder(f,2),h.font="bold 10pt arial",g.headerRowStyle(h);var i=new j;i.borderLeft=new a.LineBorder(f,1),i.borderTop=new a.LineBorder(f,1),i.borderRight=new a.LineBorder(f,1),i.borderBottom=new a.LineBorder(f,1),i.borderHorizontal=new a.LineBorder(f,1),i.borderVertical=new a.LineBorder(f,1),g.wholeTableStyle(i);var l=new j;l.backColor=e,g.firstRowStripStyle(l);var m=new j;m.backColor=e,g.firstColumnStripStyle(m);var n=new j;n.font="bold 10pt arial",g.highlightFirstColumnStyle(n);var o=new j;o.font="bold 10pt arial",g.highlightLastColumnStyle(o);var p=new j;return p.borderTop=new a.LineBorder(f,6),p.font="bold 10pt arial",g.footerRowStyle(p),g},c._getMediumStyle=function(a){var d=a-1;if(typeof c._mediums===f&&(c._mediums={}),c._mediums[d])return c._mediums[d];var g=b;switch(e(d/7)){case 0:g=c._createMediumA(d%7);break;case 1:g=c._createMediumB(d%7);break;case 2:g=c._createMediumC(d%7);break;case 3:g=c._createMediumD(d%7)}return g?(g.name("Medium"+a),c._mediums[d]=g,g):b},c._createMediumA=function(b){var d=c._getTheme(b),e=d+" 20",f=d,g=d+" 80",h=new k,i=new j;i.backColor=f,i.font="bold 10pt arial",i.foreColor="white",h.headerRowStyle(i);var l=new j;l.borderHorizontal=new a.LineBorder(e,1),l.borderLeft=new a.LineBorder(e,1),l.borderRight=new a.LineBorder(e,1),l.borderBottom=new a.LineBorder(e,1),l.borderTop=new a.LineBorder(e,1),h.wholeTableStyle(l);var m=new j;m.backColor=g,h.firstRowStripStyle(m);var n=new j;n.backColor=g,h.firstColumnStripStyle(n);var o=new j;o.font="bold 10pt arial",h.highlightFirstColumnStyle(o);var p=new j;p.font="bold 10pt arial",h.highlightLastColumnStyle(p);var q=new j;return q.borderTop=new a.LineBorder(e,6),q.font="bold 10pt arial",q.foreColor="black",h.footerRowStyle(q),h},c._createMediumB=function(b){var d=c._getTheme(b),e="white",f=d,g=d+" 60",h=d+" 80",i=new k,l=new j;l.backColor=f,l.borderBottom=new a.LineBorder(e,2),l.borderVertical=new a.LineBorder(e,1),l.font="bold 10pt arial",l.foreColor="white",i.headerRowStyle(l);var m=new j;m.borderHorizontal=new a.LineBorder(e,1),m.borderVertical=new a.LineBorder(e,1),m.backColor=h,i.wholeTableStyle(m);var n=new j;n.backColor=g,i.firstRowStripStyle(n);var o=new j;o.backColor=g,i.firstColumnStripStyle(o);var p=new j;p.backColor=f,p.foreColor="white",p.font="bold 10pt arial",i.highlightFirstColumnStyle(p);var q=new j;q.backColor=f,q.foreColor="white",q.font="bold 10pt arial",i.highlightLastColumnStyle(q);var r=new j;return r.borderTop=new a.LineBorder(e,2),r.borderVertical=new a.LineBorder(e,1),r.backColor=f,r.foreColor="white",r.font="bold 10pt arial",i.footerRowStyle(r),i},c._createMediumC=function(b){var d=c._getTheme(b),e=d,f="#D3D3D3",g=0===b?"black":"#D3D3D3",h=new k,i=new j;i.backColor=e,i.borderTop=new a.LineBorder("black",2),i.borderBottom=new a.LineBorder("black",2),i.font="bold 10pt arial",i.foreColor="white",h.headerRowStyle(i);var l=new j;l.borderLeft=new a.LineBorder(g,1),l.borderRight=new a.LineBorder(g,1),l.borderTop=new a.LineBorder("black",2),l.borderVertical=new a.LineBorder(g,1),0===b&&(l.borderHorizontal=new a.LineBorder(g,1)),l.borderBottom=new a.LineBorder("black",2),h.wholeTableStyle(l);var m=new j;m.backColor=f,h.firstRowStripStyle(m);var n=new j;n.backColor=f,h.firstColumnStripStyle(n);var o=new j;o.backColor=e,o.foreColor="white",h.highlightFirstColumnStyle(o);var p=new j;p.backColor=e,p.foreColor="white",h.highlightLastColumnStyle(p);var q=new j;q.backColor=e,q.font="bold 10pt arial",q.foreColor="white",h.firstFooterCellStyle(q);var r=new j;r.backColor=e,r.font="bold 10pt arial",r.foreColor="white",h.lastFooterCellStyle(r);var s=new j;return s.foreColor="black",s.borderTop=new a.LineBorder("black",6),h.footerRowStyle(s),h},c._createMediumD=function(b){var d=c._getTheme(b),e=d,f=d+" 40",g=d+" 80",h=d+" 60",i=d+" 80",l=new k,m=new j;m.backColor=g,m.borderVertical=new a.LineBorder(f,1),m.borderLeft=new a.LineBorder(f,1),m.borderTop=new a.LineBorder(f,1),m.borderRight=new a.LineBorder(f,1),m.borderBottom=new a.LineBorder(f,1),m.font="bold 10pt arial",m.foreColor="black",l.headerRowStyle(m);var n=new j;n.borderVertical=new a.LineBorder(f,1),n.borderHorizontal=new a.LineBorder(f,1),n.borderLeft=new a.LineBorder(f,1),n.borderTop=new a.LineBorder(f,1),n.borderRight=new a.LineBorder(f,1),n.borderBottom=new a.LineBorder(f,1),n.backColor=g,l.wholeTableStyle(n);var o=new j;o.backColor=h,l.firstRowStripStyle(o);var p=new j;p.backColor=h,l.firstColumnStripStyle(p);var q=new j;q.font="bold 10pt arial",l.highlightFirstColumnStyle(q);var r=new j;r.font="bold 10pt arial",l.highlightLastColumnStyle(r);var s=new j;return s.backColor=i,s.foreColor="black",s.font="bold 10pt arial",s.borderLeft=new a.LineBorder(f,1),s.borderTop=new a.LineBorder(e,2),s.borderRight=new a.LineBorder(f,1),s.borderBottom=new a.LineBorder(f,1),s.borderVertical=new a.LineBorder(f,1),l.footerRowStyle(s),l},c._getDarkStyle=function(a){var d=a-1;if(typeof c._darks===f&&(c._darks={}),c._darks[d])return c._darks[d];var g=b;switch(e(d/7)){case 0:g=c._createDarkA(d%7);break;case 1:g=c._createDarkB(d%7)}return g!=b?(g.name("Dark"+a),c._darks[d]=g,g):b},c._createDarkA=function(b){var d=c._getTheme(b),e="black",f=0===b?d+" 25":d+" -25",g=0===b?d+" 50":d,h=0===b?d:d+" -50",i=new k,l=new j;l.backColor=e,l.font="bold 10pt arial",l.foreColor="white",l.borderBottom=new a.LineBorder("white",2),i.headerRowStyle(l);var m=new j;m.backColor=g,m.foreColor="white",i.wholeTableStyle(m);var n=new j;n.backColor=f,i.firstRowStripStyle(n);var o=new j;o.backColor=f,i.firstColumnStripStyle(o);var p=new j;p.font="bold 10pt arial",p.borderRight=new a.LineBorder("white",2),p.backColor=f,p.foreColor="white",i.highlightFirstColumnStyle(p);var q=new j;q.font="bold 10pt arial",q.borderLeft=new a.LineBorder("white",2),q.backColor=f,q.foreColor="white",i.highlightLastColumnStyle(q);var r=new j;return r.backColor=h,r.font="bold 10pt arial",r.foreColor="white",r.borderTop=new a.LineBorder("white",2),i.footerRowStyle(r),i},c._createDarkB=function(b){var d=(c._getTheme(b),c._getHeaderColor(b)),e=c._getStripColor(b),f=c._getTableBackground(b),g=f,h=new k,i=new j;i.backColor=d,i.foreColor="white",h.headerRowStyle(i);var l=new j;l.backColor=f,h.wholeTableStyle(l);var m=new j;m.backColor=e,h.firstRowStripStyle(m);var n=new j;n.backColor=e,h.firstColumnStripStyle(n);var o=new j;o.font="bold 10pt arial",h.highlightFirstColumnStyle(o);var p=new j;p.font="bold 10pt arial",h.highlightLastColumnStyle(p);var q=new j;return q.backColor=g,q.font="bold 10pt arial",q.borderTop=new a.LineBorder("black",6),h.footerRowStyle(q),h},c._getTableBackground=function(a){return 0===a?"Background 1 -15":1===a?"Accent 1 80":2===a?"Accent 3 80":3===a?"Accent 5 80":""},c._getStripColor=function(a){return 0===a?"Background 1 -35":1===a?"Accent 1 60":2===a?"Accent 3 60":3===a?"Accent 5 60":""},c._getHeaderColor=function(a){return 0===a?"Text 1":1===a?"Accent 2":2===a?"Accent 4":3===a?"Accent 6":""},c._getTheme=function(a){return 0===a?"Text 1":"Accent "+a},c}();a.TableStyles=l;var m=function(){function d(a){this._sheet=a,this._tableList=[]}return d.prototype.getSheet=function(){return this._sheet},d.prototype.getCount=function(){return this._tableList.length},d.prototype.getTables=function(){return this._tableList},d.prototype.add=function(b){if(b){for(var c,d=this,e=d._tableList.length,f=0;e>f;f++)if(c=d._tableList[f],c&&c.name()===b.name())throw new Error(a.SR.Exp_TableHasSameNameError);return b._setOwner(d),d._tableList.push(b),b.showHeader()&&b._syncHeader(),b._syncFooter()&&b._syncFooter(),b}},d.prototype.remove=function(c){if(c){var d=a.util.inArray(c,this._tableList);if(d>-1){this._tableList.splice(d,1);for(var e=c.range(),f=this._sheet,g=e.row,h=e.row+e.rowCount,i=e.col,j=e.col+e.colCount,k=g;h>k;k++)for(var l=i;j>l;l++)f.setValue(k,l,b),f.setFormula(k,l,b)}}},d.prototype.find=function(a,c){var d=this._tableList.length;if(0===d)return b;for(var e,f=0;d>f;f++){e=this._tableList[f];var g=e.range();if(g.row<=a&&a<g.row+g.rowCount&&g.col<=c&&c<g.col+g.colCount)return e}return b},d.prototype.findByRange=function(a,c,d,e){var f=this._tableList.length;if(0===f)return b;for(var g,h=[],i=0;f>i;i++)g=this._tableList[i],g.range().intersect(a,c,d,e)&&h.push(g);return h},d.prototype.findByName=function(a){for(var c,d=this._tableList.length,e=0;d>e;e++)if(c=this._tableList[e],c.name().toLowerCase()===a.toLowerCase())return c;return b},d.prototype.has=function(a,b,c,d){for(var e,f=this._tableList.length,g=0;f>g;g++)if(e=this._tableList[g],e.range().intersect(a,b,c,d))return!0;return!1},d.prototype.addRows=function(a,b){for(var c,d=this._tableList.length,e=0;d>e;e++)c=this._tableList[e],c._addRows(a,b)},d.prototype.addColumns=function(a,b){for(var c,d=this._tableList.length,e=0;d>e;e++)c=this._tableList[e],c._addColumns(a,b)},d.prototype.removeRows=function(a,b){for(var c,d=[],e=this._tableList.length,f=0;e>f;f++){c=this._tableList[f];var g=c.range(),h=a<=g.row&&g.row+g.rowCount<=a+b;h||(c._removeRows(a,b),d.push(c))}this._tableList=d},d.prototype.removeColumns=function(a,b){for(var c,d=[],e=this._tableList.length,f=0;e>f;f++){c=this._tableList[f];var g=c.range(),h=a<=g.col&&g.col+g.colCount<=a+b;h||(c._removeColumns(a,b),d.push(c))}this._tableList=d},d.prototype.clear=function(c,d,e,f,g){var h,i,j=this,k=new a.Range(c,d,e,f);if(1===(1&g)){var l=[];h=j._tableList.length;for(var m=0;h>m;m++)i=j._tableList[m],k.containsRange(i.range())||l.push(i);h=l.length;for(var m=0;h>m;m++)i=l[m],i._clear(c,d,e,f);j._tableList=l}if(2===(2&g)){h=j._tableList.length;for(var m=0;h>m;m++)i=j._tableList[m],k.containsRange(i.range())&&i.style(b)}},d.prototype.copy=function(a,b,c,d,e,f){for(var g,h=this._tableList.length,i=0;h>i;i++)g=this._tableList[i],g._copy(a,b,c,d,e,f)},d.prototype.move=function(a,b,c,d,e,f){for(var g,h=this._tableList.length,i=0;h>i;i++)g=this._tableList[i],g._move(a,b,c,d,e,f)},d.prototype.toJSON=function(){return 0===this._tableList.length?c:{tables:this._tableList}},d.prototype.fromJSON=function(a){if(a&&(this._tableList=[],a.tables))for(var b=a.tables,c=b.length,d=0;c>d;d++){var e=new h;e._setOwner(this),e.fromJSON(b[d]),this._tableList.push(e)}},d}();a._SheetTableManager=m}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("group",["core.common","core.stringResource"]);var b=null,c=void 0,d=Math.max,e=Math.min,f="undefined",g=Array.prototype;g.nextNonEmptyIndex=function(a){0>a&&(a=-1);for(var d=a+1,e=d;e<this.length;e++)if(this[e]!==c&&this[e]!==b)return e;return-1},g.clear=function(a,c){if(!(0>a))for(var d=0,e=0;c>d&&e<this.length;e++)this[a+e]=b,d++},function(a){a[a.Expanded=0]="Expanded",a[a.Collapsed=1]="Collapsed"}(a.GroupState||(a.GroupState={}));var h=(a.GroupState,function(){function a(a,c,d,e){var f=this;f.model=b,f.children=b,f.parent=b,f.start=0,f.end=0,f.level=0,f.model=a,f.start=c,f.end=d,f.level=e}return a.prototype.getState=function(){return this.model?this.model.getState(this):0},a.prototype.setState=function(a){this.model&&this.model.expand(this.level,0===a)},a.prototype.contains=function(a){return this.start<=a&&a<=this.end},a.prototype.addChild=function(a){var b=this;a&&(b.children||(b.children=[]),b.children.push(a),a.parent=b)},a}());a.RangeGroupInfo=h;var i=function(){function a(){this.count=0}return a.prototype.addRef=function(){this.count++},a.prototype.release=function(){this.count--},a.prototype.isWorking=function(){return this.count>0},a}();a.WorkingState=i;var j=function(){function d(a){var c=this;c.head=b,c.tail=b,c.items=b,c._rootCached=b,c.direction=1,c.suspendAddingGroup=new i,c.items=new Array(a),c._empty=!0}return d.prototype.setDirection=function(a){this.direction=a},d.prototype.getDirection=function(){return this.direction},d.prototype._getCount=function(){var a=this.items;return a?a.length:0},d.prototype.group=function(c,d){var e=this;if(!e._isIndexValid(c))throw new Error(a.SR.Exp_InvalidIndex);if(!e._isIndexValid(c+d-1))throw new Error(a.SR.Exp_InvalidCount);e._rootCached=b;for(var f=0;d>f;f++){var g=c+f,h=e._getModelIndexFromViewIndex(g);e.items[h]?e.items[h].level++:e.items[h]=new k}e._rootCached=e.createRangeGroup(),e._empty=!1},d.prototype.ungroupRange=function(d,e){var f=this;if(!f._isIndexValid(d))throw new Error(a.SR.Exp_InvalidIndex);if(!f._isIndexValid(d+e-1))throw new Error(a.SR.Exp_InvalidCount);var g=!1,h=b,i=-1;if(1===f.direction){if(i=d+e,g=f._isIndexValid(i)){var j=d+e-1,k=j,l=b;do{var m=f._getModelIndexFromViewIndex(j);l=f.items[m],l!==c&&l!==b&&(k=j),j--}while((l===c||l===b)&&j>=d);l!==c&&l!==b&&(h=f._findImp(f._rootCached,k,l.level),h&&(i=h.end+1),g=h&&(h.end===d+e-1||1===f.getState(h)))}}else if(0===f.direction&&(i=d-1,g=f._isIndexValid(i))){var n=d,o=n,p=b;do{var q=f._getModelIndexFromViewIndex(n);p=f.items[q],p!==c&&p!==b&&(o=n),n++}while((p===c||p===b)&&d+e>n);p!==c&&p!==b&&(h=f._findImp(f._rootCached,o,p.level),h&&(i=h.start-1),g=h&&(h.start===d||1===f.getState(h)))}f._rootCached=b;for(var r=0;e>r;r++){var s=d+r,t=f._getModelIndexFromViewIndex(s);f.items[t]&&f.items[t].level>-1&&f.items[t].level--}if(g){var u=f._getModelIndexFromViewIndex(i),v=f.items[u];v&&v.level===h.level&&(f.items[u]=b)}f._rootCached=f.createRangeGroup()},d.prototype.ungroup=function(){var a=this;a._rootCached=b;var c=a._getCount();a.items=new Array(c),a._rootCached=a.createRangeGroup(),a._empty=!0},d.prototype._expand=function(b,c,d){if(!this._isIndexValid(b))throw new Error(a.SR.Exp_InvalidIndex);if(-1>c)throw new Error(a.SR.Exp_InvalidLevel);var e=this.find(b,c);e&&this.expandGroup(e,d)},d.prototype.expand=function(b,c){if(-1>b)throw new Error(a.SR.Exp_InvalidLevel);for(var d=new l(this);d.moveNext();)this._expand(d.current,b,c)},d.prototype.expandGroup=function(b,c){if(!b)throw new Error(a.SR.Exp_GroupInfoIsNull);var d=-1;switch(this.direction){case 0:d=b.start-1;break;case 1:d=b.end+1}this.setCollapsed(d,!c)},d.prototype.isCollapsed=function(a){var b=this.getLevel(a);if(b>-1)for(var c=this._findImp(this._rootCached,a,b);c;){if(1===c.getState())return!0;c=c.parent}return!1},d.prototype.find=function(c,d){var e=this._rootCached;if(e){if(-1===d)return e;if(!this._isIndexValid(c))throw new Error(a.SR.Exp_InvalidIndex);return this._findImp(e,c,d)}return b},d.prototype.getLevel=function(b){if(!this._isIndexValid(b))throw new Error(a.SR.Exp_InvalidIndex);var c=this._getModelIndexFromViewIndex(b),d=this.items[c];return d?d.level:-1},d.prototype.getCollapsed=function(a){var b=this._getModelIndexFromViewIndex(a),c=this.items[b];return c?!!c.collapsed:!1},d.prototype.setCollapsed=function(a,c){var d=this,e=!1;if(0>a){var f=d.head;f||(f=d.head=new k),f.collapsed!==c&&(f.collapsed=c,e=!0)}else if(a>-1&&a<d._getCount()){var g=d._getModelIndexFromViewIndex(a),h=d.items,i=h[g];i||(i=h[g]=new k,i.level=-1),i.collapsed!==c&&(i.collapsed=c,e=!0)}else if(a>=d._getCount()){var j=d.tail;j||(j=d.tail=new k),j.collapsed!==c&&(j.collapsed=c,e=!0)}e&&(d._rootCached=b,d.refresh())},d.prototype.getMaxLevel=function(){for(var a,b,c=-1,d=this.items,e=d.length,g=0;e>g;g++)a=d[g],b=a&&a.level,typeof b!==f&&b>c&&(c=b);return c},d.prototype._move=function(a,c,d){var e=this;if(d>0){if(0>a&&(a=0),0>c&&(c=0),a===c)return;for(var f=[],g=e.items.nextNonEmptyIndex(a-1);g>=0&&a+d>g;){var h=new k(e.items[g]);f.push({index:g-a,value:h}),g=e.items.nextNonEmptyIndex(g)}if(e.items.clear(a,d),e.items.clear(c,d),f.length>0)for(var i=0;i<f.length;i++){var j=f[i];e.items[c+j.index]=j.value}e._rootCached=b,e.refresh()}},d.prototype._copy=function(a,c,d){var e=this;if(d>0){if(0>a&&(a=0),0>c&&(c=0),a===c)return;for(var f=[],g=e.items.nextNonEmptyIndex(a-1);g>=0&&a+d>g;){var h=new k(e.items[g]);f.push({index:g-a,value:h}),g=e.items.nextNonEmptyIndex(g)}if(e.items.clear(c,d),f.length>0)for(var i=0;i<f.length;i++){var j=f[i];e.items[c+j.index]=j.value}e._rootCached=b,e.refresh()}},d.prototype._add=function(a,c){var d=this;if(c>0){for(var e=d._getModelIndexFromViewIndex(a),f=e>1?d.items[e-1]:b,g=0;c>g;g++)d.items.splice(e,0,f?new k(f):b);if(!d.suspendAddingGroup.isWorking&&a>0){var h=d._getModelIndexFromViewIndex(a-1),i=b;if(i=0>h?d.head:d.items[h])for(var j=0;c>j;j++)d.items[a+j]=new k({collapsed:i.collapsed,level:i.level})}d._rootCached=b,d.refresh()}},d.prototype._remove=function(a,c){c>0&&(this.items.splice(a,c),this._rootCached=b,this.refresh())},d.prototype.equals=function(a){var b=this,c=a;if(c){if(!b.items&&c.items&&c.items.length>0)return!1;if(!c.items&&b.items&&b.items.length>0)return!1;if(!b.rangeGroupItemInfoEquals(b.head,c.head))return!1;if(!b.rangeGroupItemInfoEquals(b.tail,c.tail))return!1;if(b.items&&c.items){if(b.direction!==c.direction)return!1;if(b.items.length!==c.items.length)return!1;for(var d=0;d<b.items.length;d++)if(!b.items[d]&&c.items[d]||b.items[d]&&!c.items[d])return!1}return!0}return!1},d.prototype._isEmpty=function(){return this._empty},d.prototype.refresh=function(){this._isEmpty()||(this._rootCached=this.createRangeGroup())},d.prototype._setCount=function(a){var c=this;c.items||(c.items=new Array(a)),c._rootCached=b;var d=c._getCount();if(d>a)c.items.splice(a,d-a);else if(a>d){var e=c.items[c.items.length-1];if(e)for(var f=0;a>f;f++)c.items.push(new k(e));else c.items=c.items.concat(new Array(a))}c.refresh()},d.prototype.getState=function(a){var c=this,d=-1;switch(c.direction){case 1:d=a.end+1;break;case 0:d=a.start-1}var e=b,f=c._getCount();if(0>d&&(e=c.head),d>-1&&f>d){var g=c._getViewIndexFromModelIndex(d);e=c.items[g]}else d>=f&&(e=c.tail);return e&&e.collapsed?1:0},d.prototype._setLevel=function(a,c){var d=this;if(0>a)d.head||(d.head=new k),d.head.level=c;else if(a>-1&&a<d._getCount()){var e=d._getModelIndexFromViewIndex(a);d.items[e]||(d.items[e]=new k,d.items[e].level=-1),d.items[e].level=c}else a>=d._getCount()&&(d.tail||(d.tail=new k),d.tail.level=c);d._rootCached=b,d.refresh()},d.prototype.suspendAdding=function(){this.suspendAddingGroup.addRef()},d.prototype.resumeAdding=function(){this.suspendAddingGroup.release()},d.prototype._getViewIndexFromModelIndex=function(a){return a},d.prototype._getModelIndexFromViewIndex=function(a){return a},d.prototype.rangeGroupItemInfoEquals=function(a,b){return a?b?a.level===b.level&&a.collapsed===b.collapsed:!1:!b},d.prototype.createRangeGroup=function(){for(var a=this,b=new h(a,0,a._getCount()-1,-1),c=new l(a);c.moveNext();){var d=a._createRangeGroup(c,0);d&&d.level>-1&&b.addChild(d)}return b},d.prototype._createRangeGroup=function(a,c){var d=this,e=b;do{var f=a.current,g=d._getModelIndexFromViewIndex(f),i=d.items[g],j=a.nextToCurrent();if(!(i.level<c)){if(i.level>=c&&(e||(e=new h(d,f,f,c))),i.level>c){var k=d._createRangeGroup(a,c+1);a.current>-1?(f=a.current,j=a.nextToCurrent()):(f=k.end,j=-1),e.addChild(k)}if(f>e.end&&(e.end=f),d.isGroupEnd(f,j,c))return e}}while(a.moveNext());return e},d.prototype.isGroupEnd=function(a,b,c){var d=this,e=d._getModelIndexFromViewIndex(a),f=d.items[e];if(!d._isIndexValid(b))return!0;var g=d._getModelIndexFromViewIndex(b),h=d.items[g];if(!h)return!0;if(h.level<f.level){var i=f.level-h.level,j=f.level-c;if(i===j)return!1;if(j>=0&&i>j)return!0}return!1},d.prototype._isIndexValid=function(a){return a>=-1&&a<this._getCount()},d.prototype._findImp=function(a,c,d){if(a){var e=[];for(e.unshift(a);e.length>0;){if(a=e.pop(),a.level===d&&a.contains(c))return a;var f=a.children,g=f&&f.length;if(g>0)for(var h=0;g>h;h++)e.unshift(f[h])}}return b
},d.prototype.fromJSON=function(a){if(a){var d=this,e=a.itemsCount;if((e===c||e===b)&&(e=d.items.length),d.items=new Array(e),a.itemsData)for(var f=a.itemsData.length,g=0;f>g;g++){var h=a.itemsData[g];if(h.count>0&&h.index>=0&&h.info){for(var i=0;i<h.count&&!(h.index+i>=d.items.length);i++)d.items[h.index+i]=new k(h.info);d._empty=!1}}a.direction!==b&&a.direction!==c&&(d.direction=a.direction),a.head&&(d.head=a.head),a.tail&&(d.tail=a.tail),d._rootCached=b,d.refresh()}},d.prototype.toJSON=function(){return this.toJSONCore()},d.prototype.toJSONCore=function(a){for(var b=this,d=[],e=b.items.length,f=-1,g=0;e>g;g++)b.items[g]&&(f>=0&&g===d[f].count+d[f].index&&b.items[g].level===d[f].info.level&&b.items[g].collapsed===d[f].info.collapsed?d[f].count++:(f++,d[f]={index:g,count:1,info:b.items[g]}));var h={itemsCount:e,itemsData:d,direction:b.direction,head:b.head,tail:b.tail},i={};for(var j in h){var k=h[j];b._isDefaultValue(j,k,a)||(i[j]=k)}return $.isEmptyObject(i)?c:i},d.prototype._isDefaultValue=function(a,c,d){switch(a){case"head":return c===b;case"tail":return c===b;case"direction":return 1===c;case"itemsData":return 0===c.length;case"itemsCount":if(d===!0)return 200===c;if(d===!1)return 20===c;default:return!1}},d}();a.RangeGroup=j;var k=function(){function a(a){var b=this;b!==a&&a&&(b.level=a.level,b.collapsed=a.collapsed),a||(b.level=0,b.collapsed=!1)}return a}();a.RangeGroupItemInfo=k;var l=function(){function a(a){this.isEOF=!1,this.rangeGroup=b,this.current=-1,this.rangeGroup=a}return a.prototype.nextToCurrent=function(){return this.current+1},a.prototype.moveNext=function(){var a=this;if(a.isEOF||!a.rangeGroup||!a.rangeGroup.items)return!1;for(var b=!1,c=a.current+1;c<a.rangeGroup.items.length;c++){var d=a.rangeGroup._getModelIndexFromViewIndex(c);if(a.rangeGroup.items[d]){b=!0,a.current=c;break}}return b||(a.current=-1),a.current>-1?!0:(a.isEOF=!0,!1)},a.prototype.reset=function(){this.isEOF=!1,this.current=-1},a}();a.GroupedItemIndexEnumerator=l;var m={getThemeBackgroundColor:function(b,c){if(b.parent&&b.parent.useWijmoTheme){var d=a.Global.prototype.getWijmoThemeStyle(0);d&&d.backgroundColor&&""!==d.backgroundColor&&(c=d.backgroundColor)}return c},getThemeForeColor:function(b,c){if(b.parent&&b.parent.useWijmoTheme){var d=a.Global.prototype.getWijmoThemeStyle(0);d&&d.color&&""!==d.color&&(c=d.color)}return c}},n=function(){function c(a,c,d,e){var g=this;g._sheet=b,g._rowGroup=b,g._viewportIndex=1,g._maxLevel=-1,g.PADDING=2,g.LINE_SIZE=2,g.STARTLINE_SIZE=6,g._groupLineInfos=b,g._groupDotInfos=b,g._groupButtonInfos=b,g._sheet=a,g._rowGroup=c,g._viewportIndex=d,g._maxLevel=typeof e===f?c?a.rowRangeGroup.getMaxLevel():a.colRangeGroup.getMaxLevel():e}return c.prototype.createGroupInfo=function(){var a=this;a._groupLineInfos=[],a._groupDotInfos=[],a._groupButtonInfos=[];var b=a._rowGroup,c=a._maxLevel;if(-1!==c){var d,e=a._sheet._getGroupLayout(),f=a._calcMinWidthOrHeight({width:e.width,height:e.height},b),g=a.getGroupsByLevel(0,b),h=g.length;if(h>0)for(var i=0;h>i;i++)d=g[i],a._measureGroups(d,f)}},c.prototype.paintGroups=function(a){this._rowGroup?this._paintRowGroups(a):this._paintColumnGroups(a)},c.prototype._calcMinWidthOrHeight=function(a,b){var c=0,e=this._maxLevel;return c=b?(a.width-2*this.PADDING)/(e+2):(a.height-2*this.PADDING)/(e+2),c=d(0,c)},c.prototype._measureGroups=function(a,c){var f,g,h,i=this,j=i._rowGroup,k=i.getGroupDirection(j),l=i.getViewportStartIndex(j),m=i.getViewportEndIndex(j),n=a.start,o=a.end;if(0===a.getState()){var p=!0,q=a.parent;if(q&&(0===k&&n===q.start||1===k&&o===q.end)&&(p=!1),p&&(f={isExpanded:!0,level:a.level,paintLine:!0},1===k?(g=o+1,g>=l&&m>=g&&(f.index=g,f.lineDirection=1,i._groupButtonInfos.push(f))):0===k&&(g=n-1,g>=l&&m>=g&&(f.index=g,f.lineDirection=0,i._groupButtonInfos.push(f)))),m>=n&&o>=l){var r=d(l,n),s=e(m,o);if(p){var t={start:r,end:s,level:a.level,startLine:b};(1===k&&r===n||0===k&&s===o)&&(t.startLine=!0),i._groupLineInfos.push(t)}var u=[];for(h=r;s>=h;h++)u.push(h);var v=a.children,w=v&&v.length;if(w>0)for(h=0;w>h;h++){var x=v[h],y=x.start,z=x.end;if(1===x.getState())for(var A=y;z>=A;A++)u.remove(A);1===k?u.remove(z+1):0===k&&u.remove(y-1),i._measureGroups(x,c)}var B=!0;if(w>0)for(var C=0;w>C;C++){var D=v[C];if(D){var E=D.start,F=D.end;if(E===n&&F===o){B=!1;break}if(1===k&&F===o||0===k&&E===n)for(var G=E;F>=G;G++)u.remove(G)}}if(B&&u.length>0)for(h=0;h<u.length;h++){var H=u[h],I={index:H,level:a.level+1};i._groupDotInfos.push(I)}}}else 1===a.getState()&&(f={isExpanded:!1,level:a.level},1===k?(g=o+1,g>=l&&m>=g&&(f.index=g,f.lineDirection=1,i._groupButtonInfos.push(f))):0===k&&(g=n-1,g>=l&&m>=g&&(f.index=g,f.lineDirection=0,i._groupButtonInfos.push(f))))},c.prototype._paintRowGroups=function(a){var c=this,f=c._maxLevel;if(-1!==f){var g=c._sheet,h=g._getGroupLayout(),i=c._calcMinWidthOrHeight({width:h.width,height:h.height},!0);if(0!==i){a.save();var j,k,l,n,o=c.STARTLINE_SIZE,p=c.PADDING,q=c.LINE_SIZE,r=d(0,(i-o)/2)+p,s=g._getRowLayout(c._viewportIndex,3),t=c._groupDotInfos,u=t&&t.length;if(u>0)for(l=0;u>l;l++){var v=t[l];if(n=s.findRow(v.index),n&&n.height>=q){j=v.level*i+r,k=n.y+d(0,(n.height-q)/2);var w=q,x=q;a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j+.5,h.y+k,w,x)}}var y=g.rowRangeGroup.direction,z=c._groupLineInfos,A=z&&z.length;if(A>0)for(l=0;A>l;l++){var B=z[l],C=B.start,D=B.end,E=b,F=b;do E=s.findRow(C),C++;while(!E&&D>=C);do F=s.findRow(D),D--;while(!F&&D>=C);if(E||F){!E&&F?E=F:E&&!F&&(F=E),j=B.level*i+r,k=E.y,1===y&&(k+=1);var G=q,H=d(0,F.y+F.height-E.y);a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j+.5,h.y+k,G,H);var I=B.startLine;if(I){var J=e(o,i-q);J>0&&(0===y&&(k=k+H-q),k>=E.y&&k<F.y+F.height&&(a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j+.5,h.y+k,J,q)))}}}var K=c._groupButtonInfos,L=K&&K.length;if(L>0)for(l=0;L>l;l++){var M=K[l];if(n=s.findRow(M.index),n&&!(n&&n.height<=0)){var N=d(0,(n.height-i)/2);j=M.level*i+p,k=n.y+N;var O=i,P=e(i,n.height);a.strokeStyle="gray",a.lineWidth=1,a.strokeRect(h.x+j+.5,h.y+k,O,P),M.isExpanded||a.fillRect(h.x+j+O/2-1+.5,h.y+k+4,2,P-8),a.fillRect(h.x+j+4+.5,h.y+k+P/2-1,O-8,2);var Q=M.paintLine;if(Q&&P<n.height){j=M.level*i+r,k=n.y;var R=q,S=N;0===M.lineDirection&&(k+=N+P,S=n.height-P-N),a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j+.5,h.y+k,R,S)}}}a.stroke(),a.beginPath(),a.restore()}}},c.prototype._paintColumnGroups=function(a){var c=this,f=c._maxLevel;if(-1!==f){var g=c._sheet,h=g._getGroupLayout(),i=c._calcMinWidthOrHeight({width:h.width,height:h.height},!1);if(0!==i){var j,k,l,n,o=c.STARTLINE_SIZE,p=c.PADDING,q=c.LINE_SIZE,r=d(0,(i-o)/2)+p,s=g._getColumnLayout(c._viewportIndex,3);a.save();var t=c._groupDotInfos,u=t.length;for(l=0;u>l;l++){var v=t[l];if(n=s.findCol(v.index),n&&n.width>=q){j=n.x+d(0,(n.width-q)/2),k=v.level*i+r;var w=q,x=q;a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j,h.y+k+.5,w,x)}}var y=g.colRangeGroup.direction,z=c._groupLineInfos,A=z.length;for(l=0;A>l;l++){var B=z[l],C=B.start,D=B.end,E=b,F=b;do E=s.findCol(C),C++;while(!E&&D>=C);do F=s.findCol(D),D--;while(!F&&D>=C);if(E||F){!E&&F?E=F:E&&!F&&(F=E),j=E.x,1===y&&(j+=1),k=B.level*i+r;var G=d(0,F.x+F.width-E.x),H=q;a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j,h.y+k+.5,G,H);var I=B.startLine;if(I){var J=e(o,i-q);J>0&&(0===y&&(j=j+G-q),j>=E.x&&j<F.x+F.width&&(a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j,h.y+k+.5,q,J)))}}}var K=c._groupButtonInfos,L=K.length;for(l=0;L>l;l++){var M=K[l];if(n=s.findCol(M.index),n&&!(n&&n.width<=0)){var N=d(0,(n.width-i)/2);j=n.x+N,k=M.level*i+p;var O=e(i,n.width),P=i;a.strokeStyle="gray",a.lineWidth=1,a.strokeRect(h.x+j,h.y+k+.5,O,P),M.isExpanded||a.fillRect(h.x+j+O/2-1,h.y+k+4.5,2,P-8),a.fillRect(h.x+j+4,h.y+k+P/2-.5,O-8,2);var Q=M.paintLine;if(Q&&O<n.width){j=n.x,k=M.level*i+r;var R=N,S=q;0===M.lineDirection&&(j+=N+O,R=n.width-O-N),a.fillStyle=m.getThemeForeColor(g,"black"),a.fillRect(h.x+j,h.y+k+.5,R,S)}}}a.beginPath(),a.restore()}}},c.prototype.getRowOrColumnStartIndex=function(a){var b=this._sheet,c=this._viewportIndex;if(a){var f=b._getRowLayout(c);if(f&&f.length>0){var g=f[0].row;return d(0,g-1)}}else{var h=b._getColumnLayout(c);if(h&&h.length>0){var i=h[0].col;return e(0,i-1)}}return-1},c.prototype.getRowOrColumnCount=function(a){var b=this._sheet,c=this._viewportIndex;if(a){var d=b._getRowLayout(c);if(d&&d.length>0){var f=d[d.length-1].row;return e(b.getRowCount(),f+2)}}else{var g=b._getColumnLayout(c);if(g&&g.length>0){var h=g[g.length-1].col;return e(b.getColumnCount(),h+2)}}return-1},c.prototype.getGroupsByLevel=function(a,b){for(var c,d=this,e=[],f=d.getRowOrColumnStartIndex(b),g=d.getRowOrColumnCount(b),h=b?d._sheet.rowRangeGroup:d._sheet.colRangeGroup;g>f;)c=h.find(f,a),c?(f=c.end+1,e.push(c)):f++;return e},c.prototype.getGroupDirection=function(a){return a?this._sheet.rowRangeGroup.direction:this._sheet.colRangeGroup.direction},c.prototype.getViewportStartIndex=function(a){var b=this._sheet,c=this._viewportIndex;if(a){var d=b._getRowLayout(c);if(d&&d.length>0)return d[0].row}else{var e=b._getColumnLayout(c);if(e&&e.length>0)return e[0].col}return-1},c.prototype.getViewportEndIndex=function(a){var b=this._sheet,c=this._viewportIndex;if(a){var d=b._getRowLayout(c);if(d&&d.length>0)return d[d.length-1].row}else{var e=b._getColumnLayout(c);if(e&&e.length>0)return e[e.length-1].col}return-1},c.prototype._processTouch=function(a){a&&this._sheet._isTouchMode&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},c.prototype.getRowGroupButton=function(c,f){var g=this,h=g._maxLevel;if(-1===h)return b;var i=g._sheet,j=i._getGroupLayout(),k=g._calcMinWidthOrHeight({width:j.width,height:j.height},!0);if(0===k)return b;var l,m,n=i._getRowLayout(g._viewportIndex,3),o=g._groupButtonInfos,p=o&&o.length;if(p>0)for(var q=0;p>q;q++){var r=o[q],s=n.findRow(r.index);if(s&&!(s&&s.height<=0)){var t=d(0,(s.height-k)/2);l=r.level*k+g.PADDING,m=s.y+t;var u=k,v=e(u,s.height),w=new a.Rect(j.x+l+.5,j.y+m+.5,u,v);if(g._processTouch(w),w.contains(c,f))return r}}return b},c.prototype.getColGroupButton=function(c,f){var g=this,h=g._maxLevel;if(-1===h)return b;var i=g._sheet,j=i._getGroupLayout(),k=g._calcMinWidthOrHeight({width:j.width,height:j.height},!1);if(0===k)return b;var l,m,n=i._getColumnLayout(g._viewportIndex,3),o=g._groupButtonInfos,p=o&&o.length;if(p>0)for(var q=0;p>q;q++){var r=o[q],s=n.findCol(r.index);if(s&&!(s&&s.width<=0)){var t=d(0,(s.width-k)/2);l=s.x+t,m=r.level*k+g.PADDING;var u=k,v=e(u,s.width),w=new a.Rect(j.x+l+.5,j.y+m+.5,v,u);if(g._processTouch(w),w.contains(c,f))return r}}return b},c}();a._RangeGroupPresenter=n;var o=function(){function c(a,c,d){var e=this;e._sheet=b,e._rowGroup=b,e._maxLevel=-1,e.PADDING=2,e._sheet=a,e._rowGroup=c,e._maxLevel=typeof d===f?c?a.rowRangeGroup.getMaxLevel():a.colRangeGroup.getMaxLevel():d}return c.prototype.paintGroupHeader=function(a){var b=this,c=b._sheet,e=b._maxLevel;if(c&&!(0>e)){var f=b._rowGroup,g=c._getGroupLayout(),h=b._calcMinWidthOrHeight({width:g.width,height:g.height},f);if(0!==h){var i,j,k,l,n,o,p,q,r,s=e+2,t=c._getSheetLayout();if(a.fillStyle=m.getThemeBackgroundColor(c,"#D7E6F7"),a.strokeStyle="gray",a.font="8.25pt Arial",a.lineWidth=1,f){if(a.fillRect(g.x,g.y,g.width,t.height),a.strokeRect(g.x-.5,g.y-.5,g.width,t.height+1),a.strokeRect(g.x-.5,t.headerY-.5,g.width,t.colHeaderHeight),a.fillStyle=m.getThemeForeColor(c,"black"),c.colHeaderVisible&&t.colHeaderHeight>=h)for(i=b.PADDING,j=d(0,t.headerY+(t.colHeaderHeight-h)/2),k=0;s>k;k++)l=h-1,n=g.x+i+.5,o=g.y+j,a.strokeRect(n,o,l,l),p=""+(k+1),q=a.measureText(p).width,r=c._getFontHeight(a.font),l>=q&&h>=r&&(a.textBaseline="middle",a.fillText(p,n+(l-q)/2,o+l/2)),i+=h}else if(a.fillRect(g.x,g.y,t.width,g.height),a.strokeRect(g.x-.5,g.y-.5,t.width+1,g.height),a.strokeRect(t.headerX-.5,g.y-.5,t.rowHeaderWidth,g.height),a.fillStyle=m.getThemeForeColor(c,"black"),c.rowHeaderVisible&&t.rowHeaderWidth>=h)for(i=d(0,t.headerX+(t.rowHeaderWidth-h)/2),j=b.PADDING,k=0;s>k;k++)l=h-1,n=g.x+i,o=g.y+j+.5,a.strokeRect(n,o,l,l),p=""+(k+1),q=a.measureText(p).width,r=c._getFontHeight(a.font),l>=q&&h>=r&&(a.textBaseline="middle",a.fillText(p,n+(l-q)/2,o+l/2)),j+=h}}},c.prototype.getGroupButton=function(c,e){var f=this,g=f._sheet,h=f._maxLevel;if(!g||0>h)return b;var i=f._rowGroup,j=g._getGroupLayout(),k=f._calcMinWidthOrHeight({width:j.width,height:j.height},i);if(0===k)return b;var l,m,n,o,p=h+2,q=g._getSheetLayout();if(i){if(g.colHeaderVisible&&q.colHeaderHeight>=k)for(l=f.PADDING,m=d(0,q.headerY+(q.colHeaderHeight-k)/2),n=0;p>n;n++){if(o=new a.Rect(j.x+l,j.y+m,k,k),o.contains(c,e))return{index:n};l+=k}}else if(g.rowHeaderVisible&&q.rowHeaderWidth>=k)for(l=d(0,q.headerX+(q.rowHeaderWidth-k)/2),m=f.PADDING,n=0;p>n;n++){if(o=new a.Rect(j.x+l,j.y+m,k,k),o.contains(c,e))return{index:n};m+=k}return b},c.prototype._calcMinWidthOrHeight=function(a,b){var c=0,e=this._maxLevel;return c=b?(a.width-2*this.PADDING)/(e+2):(a.height-2*this.PADDING)/(e+2),c=d(0,c)},c}();a._RangeGroupHeaderPresenter=o}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){function b(a,b,c,d,e){if(a)return e?e.call(b,b[c]):b[c];var f=b[c];return b[c]=d,e&&e.call(b,f!==d),b}function c(b,c){if(c&&b){var d=a._ThemeContext.getColor(c,b);if(d)return d}return b}function d(a,b){return 1===b?a.colCount:a.rowCount}function e(a,b,c,d){return 1===d?a.getValue(c.row,c.col+b):a.getValue(c.row+b,c.col)}function f(a,b,c,d){return 1===d?a.getColumnWidth(c.col+b)<=0||a.getRowHeight(c.row)<=0:a.getRowHeight(c.row+b)<=0||a.getColumnWidth(c.col)<=0}a.feature("sparkline",["core.common","core.theme","core.sheet_model"]);var g=null,h=void 0,i=Math.min,j=Math.floor,k=Math.max,l=Math.abs,m=Math.PI,n="undefined",o={Black:"black",Blue:"Blue",Brown:"Brown"},p={FromArgb:function(b,c,d,e){return new a._Color(b,c,d,e).toString()}};a.__invalidValuePlaceHolder={},function(a){a[a.Gaps=0]="Gaps",a[a.Zero=1]="Zero",a[a.Connect=2]="Connect"}(a.EmptyValueStyle||(a.EmptyValueStyle={}));a.EmptyValueStyle;!function(a){a[a.individual=0]="individual",a[a.group=1]="group",a[a.custom=2]="custom"}(a.SparklineAxisMinMax||(a.SparklineAxisMinMax={}));var q=(a.SparklineAxisMinMax,function(){function a(a){var b=this;if(a)for(var c in a)c&&(b[c]=a[c]);else b._axisColor=o.Black,b._firstMarkerColor=p.FromArgb(255,149,179,215),b._highMarkerColor=o.Blue,b._lastMarkerColor=p.FromArgb(255,149,179,215),b._lowMarkerColor=o.Blue,b._markersColor=p.FromArgb(255,36,64,98),b._negativeColor=o.Brown,b._seriesColor=p.FromArgb(255,36,64,98),b.displayEmptyCellsAs=0,b.rightToLeft=!1,b.displayHidden=!1,b.displayXAxis=!1,b._showFirst=!1,b._showHigh=!1,b._showLast=!1,b._showLow=!1,b._showNegative=!1,b._showMarkers=!1,b.manualMax=0,b.manualMin=0,b.maxAxisType=0,b.minAxisType=0,b.groupMaxValue=0,b.groupMinValue=0,b.lineWeight=1;b._worksheet=g}return a.prototype.axisColor=function(a){return b(0===arguments.length,this,"_axisColor",a)},a.prototype.firstMarkerColor=function(a){return b(0===arguments.length,this,"_firstMarkerColor",a)},a.prototype.highMarkerColor=function(a){return b(0===arguments.length,this,"_highMarkerColor",a)},a.prototype.lastMarkerColor=function(a){return b(0===arguments.length,this,"_lastMarkerColor",a)},a.prototype.lowMarkerColor=function(a){return b(0===arguments.length,this,"_lowMarkerColor",a)},a.prototype.markersColor=function(a){return b(0===arguments.length,this,"_markersColor",a)},a.prototype.negativeColor=function(a){return b(0===arguments.length,this,"_negativeColor",a)},a.prototype.seriesColor=function(a){return b(0===arguments.length,this,"_seriesColor",a)},a.prototype.showFirst=function(a){return b(0===arguments.length,this,"_showFirst",a)},a.prototype.showHigh=function(a){return b(0===arguments.length,this,"_showHigh",a)},a.prototype.showLast=function(a){return b(0===arguments.length,this,"_showLast",a)},a.prototype.showLow=function(a){return b(0===arguments.length,this,"_showLow",a)},a.prototype.showNegative=function(a){return b(0===arguments.length,this,"_showNegative",a)},a.prototype.showMarkers=function(a){return b(0===arguments.length,this,"_showMarkers",a)},a.prototype.clone=function(){var b=this,c=new a;return c._axisColor=b._axisColor,c._firstMarkerColor=b._firstMarkerColor,c._highMarkerColor=b._highMarkerColor,c._lastMarkerColor=b._lastMarkerColor,c._lowMarkerColor=b._lowMarkerColor,c._markersColor=b._markersColor,c._negativeColor=b._negativeColor,c._seriesColor=b._seriesColor,c.displayEmptyCellsAs=b.displayEmptyCellsAs,c.rightToLeft=b.rightToLeft,c.displayHidden=b.displayHidden,c.displayXAxis=b.displayXAxis,c._showFirst=b._showFirst,c._showHigh=b._showHigh,c._showLast=b._showLast,c._showLow=b._showLow,c._showNegative=b._showNegative,c._showMarkers=b._showMarkers,c.manualMax=b.manualMax,c.manualMin=b.manualMin,c.maxAxisType=b.maxAxisType,c.minAxisType=b.minAxisType,c.groupMaxValue=b.groupMaxValue,c.groupMinValue=b.groupMinValue,c.lineWeight=b.lineWeight,c},a.prototype._setThemeContext=function(a){this._worksheet=a},a.prototype._getActualColor=function(a){var b=this._worksheet;return b?c(this[a](),b):g},a.prototype._isDefaultValue=function(a,b){switch(a){case"axisColor":return b===o.Black;case"firstMarkerColor":return b===p.FromArgb(255,149,179,215);case"highMarkerColor":return b===o.Blue;case"lastMarkerColor":return b===p.FromArgb(255,149,179,215);case"lowMarkerColor":return b===o.Blue;case"markersColor":return b===p.FromArgb(255,36,64,98);case"negativeColor":return b===o.Brown;case"seriesColor":return b===p.FromArgb(255,36,64,98);case"displayEmptyCellsAs":return 0===b;case"rightToLeft":return b===!1;case"displayHidden":return b===!1;case"displayXAxis":return b===!1;case"showFirst":return b===!1;case"showHigh":return b===!1;case"showLast":return b===!1;case"showLow":return b===!1;case"showNegative":return b===!1;case"showMarkers":return b===!1;case"manualMax":return 0===b;case"manualMin":return 0===b;case"maxAxisType":return 0===b;case"minAxisType":return 0===b;case"groupMaxValue":return 0===b;case"groupMinValue":return 0===b;case"lineWeight":return 1===b;default:return!1}},a.prototype.toJSON=function(){var a=this,b={axisColor:a._axisColor,firstMarkerColor:a._firstMarkerColor,highMarkerColor:a._highMarkerColor,lastMarkerColor:a._lastMarkerColor,lowMarkerColor:a._lowMarkerColor,markersColor:a._markersColor,negativeColor:a._negativeColor,seriesColor:a._seriesColor,displayEmptyCellsAs:a.displayEmptyCellsAs,rightToLeft:a.rightToLeft,displayHidden:a.displayHidden,displayXAxis:a.displayXAxis,showFirst:a._showFirst,showHigh:a._showHigh,showLast:a._showLast,showLow:a._showLow,showNegative:a._showNegative,showMarkers:a._showMarkers,manualMax:a.manualMax,manualMin:a.manualMin,maxAxisType:a.maxAxisType,minAxisType:a.minAxisType,groupMaxValue:a.groupMaxValue,groupMinValue:a.groupMinValue,lineWeight:a.lineWeight},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return $.isEmptyObject(c)?h:c},a}());a.SparklineSetting=q,function(a){a[a.line=0]="line",a[a.column=1]="column",a[a.winloss=2]="winloss"}(a.SparklineType||(a.SparklineType={}));a.SparklineType;!function(a){a[a.Vertical=0]="Vertical",a[a.Horizontal=1]="Horizontal"}(a.DataOrientation||(a.DataOrientation={}));var r=(a.DataOrientation,function(){function c(a,b){var c=this;c.displayDateAxis=!1,c._sparklineGroupManager=g,c._innerList=[],c._axisReference=g,c._axisOrientation=1,c.setting=b,c.sparklineType=a}return c.prototype.add=function(a){var b=this;a&&(b._innerList.push(a),a.group(b),b._adjustGroupMaxMinValue(),b.onGroupChanged())},c.prototype.remove=function(a){var b=this,c=b._innerList.remove(a);return a.onSparklineChanged(),a._group=b.clone(),b._adjustGroupMaxMinValue(),b.onGroupChanged(),c},c.prototype.contains=function(a){return this._innerList.contains(a)},c.prototype.onGroupChanged=function(){if(this._innerList)for(var a=0;a<this._innerList.length;a++){var b=this._innerList[a];b&&b.onSparklineChanged()}},c.prototype.clone=function(){var a=this,b=a.setting?a.setting.clone():g,d=new c(a.sparklineType,b);return d.displayDateAxis=a.displayDateAxis,d._axisReference=a._axisReference,d._axisOrientation=a._axisOrientation,d},c.prototype.dateAxisData=function(a){return 0===arguments.length?b(!0,this,"_axisReference",a):b(!1,this,"_axisReference",a,function(a){a&&this.onGroupChanged()})},c.prototype.dateAxisOrientation=function(a){return 0===arguments.length?b(!0,this,"_axisOrientation",a):b(!1,this,"_axisOrientation",a,function(a){a&&this.onGroupChanged()})},c.prototype.count=function(){return this._innerList.length},c.prototype._adjustGroupMaxMinValue=function(){var a=this;if(a.setting){a.setting.groupMaxValue=-Number.MAX_VALUE,a.setting.groupMinValue=Number.MAX_VALUE;var b=1===a.setting.maxAxisType,c=1===a.setting.minAxisType,d=!1;if(b||c)for(var e=0;e<a._innerList.length;e++){var f=a._innerList[e],g=a._getMaxMinValues(f),h=g.min,i=g.max;b&&a.setting.groupMaxValue<i&&(a.setting.groupMaxValue=i,d=!0),c&&a.setting.groupMinValue>h&&(a.setting.groupMinValue=h,d=!0)}return d}},c.prototype._getMaxMinValues=function(b){var c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=b.data();if(e)for(var f=b._provideValues(e,b.dataOrientation(),!1),g=0;g<f.length;g++){var h=f[g];if(h===a.__invalidValuePlaceHolder&&(h=0),"number"==typeof h){var i=h;c=i>c?i:c,d=d>i?i:d}}return{min:d,max:c}},c.prototype._isDefaultValue=function(a,b){switch(a){case"setting":return b===g;case"displayDateAxis":return b===!1;case"axisReference":return b===g;case"axisOrientation":return 1===b;case"sparklines":return 0===b.length;default:return!1}},c.prototype.toJSON=function(){var a=this,b={setting:a.setting?a.setting.toJSON():g,displayDateAxis:a.displayDateAxis,sparklineType:a.sparklineType,axisReference:a._axisReference,axisOrientation:a._axisOrientation,sparklines:a._innerList},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return $.isEmptyObject(c)?h:c},c.prototype.fromJSON=function(a){if(a){var b=this;if(a.setting){b.setting=new q;var c=a.setting;for(var d in b.setting)if(b.setting.hasOwnProperty(d))if(c.hasOwnProperty(d))b.setting[d]=c[d];else if("_"===d.substr(0,1)){var e=d.substr(1);c.hasOwnProperty(e)&&(b.setting[d]=c[e])}}if(a.displayDateAxis!==h&&a.displayDateAxis!==g&&(b.displayDateAxis=a.displayDateAxis),a.sparklineType!==h&&a.sparklineType!==g&&(b.sparklineType=a.sparklineType),a.axisReference!==h&&a.axisReference!==g&&(b._axisReference=a.axisReference),a.axisOrientation!==h&&a.axisOrientation!==g&&(b._axisOrientation=a.axisOrientation),a.sparklines){b._innerList=[];for(var f=a.sparklines,i=f.length,j=0;i>j;j++){var k=new u;k.fromJSON(f[j]),b.add(k)}}}},c}());a.SparklineGroup=r;var s=function(){function a(a,b,c,d){var e=this;e.X=a,e.Y=b,e.Width=c,e.Height=d,e.Left=e.X,e.Right=e.Left+e.Width,e.Top=e.Y,e.Bottom=e.Y+e.Height}return a}();a._PositionRect=s;var t=function(){function c(a){this._minItemHeight=2,this.info=a,this._clearCache()}return c.prototype.sparklineInfo=function(){return b(0===arguments.length,this,"info")},c.prototype.paint=function(a,b,c,d,e){var f=this;f._clearCache();var g=f._getWorksheet(),h=f.info,i=f._getCachedValues(),j=h.dateAxisData()?f._getCachedDatetimes():[],k=g._zoomFactor;h.setting()._setThemeContext(g),f._paintCore(a,b,c,d,e,i,j,k)},c.prototype._paintCore=function(a,b,c,d,e,f,g,h){a.save(),a.rect(b,c,d,e),a.clip(),a.beginPath();var i=this;0===i.info.sparklineType()&&i._paintLines(a,b,c,d,e,f,g,h),i._paintDataPoints(a,b,c,d,e,f,g,h),i._paintAxis(a,b,c,d,e,f,g,h),a.restore()},c.prototype._clearCache=function(){var a=this;a._cachedMinDatetime=Number.MAX_VALUE,a._cachedMaxDatetime=-Number.MAX_VALUE,a._cachedMinValue=Number.MAX_VALUE,a._cachedMaxValue=-Number.MAX_VALUE,a._cachedIndexMapping=g,a._cachedValues=g,a._cachedDatetimes=g},c.prototype._getWorksheet=function(){var a=this.info,b=a&&a.group(),c=b&&b._sparklineGroupManager;return c?c._sheet:void 0},c.prototype._getSpace=function(a,b){return 0===this.info.sparklineType()?3+this._getLineWeight(b)+1:3},c.prototype._leftSpace=function(a){return this._getSpace("left",a)},c.prototype._rightSpace=function(a){return this._getSpace("right",a)},c.prototype._topSpace=function(a){return this._getSpace("top",a)},c.prototype._bottomSpace=function(a){return this._getSpace("bottom",a)},c.prototype._getCachedValues=function(){var a=this._cachedValues;if(!a){var b=this.info,c=b.data(),d=b.dataOrientation();a=this._cachedValues=b._provideValues(c,d)}return a},c.prototype._getCachedDatetimes=function(){var a=this._cachedDatetimes;if(!a){var b=this.info,c=b.group(),d=c.dateAxisData(),e=c.dateAxisOrientation();a=this._cachedDatetimes=b._provideValues(d,e,!0)}return a},c.prototype._getCachedIndexMaping=function(b,c){var d=this._cachedIndexMapping;if(d)return d;d=this._cachedIndexMapping=[];var e,f,j=a.__invalidValuePlaceHolder,k=b.length;if(this.sparklineInfo().displayDateAxis()){var l=c.length,m=i(k,l),o=[];m>0&&(o=c.slice(0,m)),o.sort(function(a,b){return a===b?0:(a===j&&(a=0),b===j&&(b=0),a-b)});var p,q,r=o.length;for(e=0;r>e;e++)if(p=o[e],typeof p!==n&&p!==g){for(q=c.indexOf(p);d.contains(q);)q=c.indexOf(p,q+1);isNaN(p)||(f=b[q],f!==h&&f!==g&&isNaN(f)&&f!==j||d.push(q))}}else for(e=0;k>e;e++)f=b[e],typeof f!==n&&f!==g&&isNaN(f)&&f!==j||d.push(e);return d},c.prototype._getValue=function(b,c){var d=c[b];return typeof d===n||d===g?1===this.sparklineInfo().setting().displayEmptyCellsAs&&(d=0):d===a.__invalidValuePlaceHolder&&(d=0),d},c.prototype._paintLines=function(a,b,c,d,e,f,h,i){var j,k,l,m=this,o=m._getCachedIndexMaping(f,h),p=o.length-1;0>p&&(p=0);var q,r,s,t,u,v,w,x=m.linePos=[],y=m.sparklineInfo().setting().displayEmptyCellsAs;for(j=0;p>j;j++)if(q=m._getValue(o[j],f),typeof q!==n&&q!==g){if(s=j+1,r=m._getValue(o[s],f),typeof r===n||r===g)if(1===y)r=0;else if(2===y)for(s=j+2;p>=s;s++)if(v=f[o[s]],typeof v!==n&&v!==g){r=v;break}typeof r!==n&&r!==g?(t=m._getDataPointPosition(o[j],{Width:d,Height:e},f,h,i),u=m._getDataPointPosition(o[s],{Width:d,Height:e},f,h,i),w=t.Width/2,k={X:t.X+w,Y:t.Y+w},l={X:u.X+w,Y:u.Y+w},x[j]={P1:k,P2:l}):j++}var z,A=x.length;if(A>0)for(a.strokeStyle=m.info.setting()._getActualColor("seriesColor"),a.lineCap="round",a.lineWidth=m._getLineWeight(i),j=0;A>j;j++)z=x[j],z&&(a.beginPath(),k=z.P1,l=z.P2,a.moveTo(b+k.X,c+k.Y),a.lineTo(b+l.X,c+l.Y),a.stroke(),a.closePath())},c.prototype._getDataPointColor=function(a,b,c){var d=this,e=g,f=(Number.MAX_VALUE,-Number.MAX_VALUE,d._getValue(a,b)),i=d.info.setting(),j=d._cachedMinValue,k=d._cachedMaxValue,l=d._getCachedIndexMaping(b,c),m=l.length,o=d.info,p=o.group();if(typeof f!==n&&f!==g){(j===Number.MAX_VALUE||k===-Number.MAX_VALUE)&&d._getMaxMinValue(b);var q=j;if(f===q&&i.showLow()&&(e=i._getActualColor("lowMarkerColor")),typeof e===n||e===g){var r=k;f===r&&i.showHigh()&&(e=i._getActualColor("highMarkerColor"))}if(typeof e===n||e===g)if(p.displayDateAxis){var s=l.indexOf(a);0===s&&i.showFirst()&&(e=i._getActualColor("firstMarkerColor"))}else 0===a&&i.showFirst()&&(e=i._getActualColor("firstMarkerColor"));if(typeof e===n||e===g)if(p.displayDateAxis){var t=l.indexOf(a);t===m-1&&i.showLast()&&(e=i._getActualColor("lastMarkerColor"))}else a===m-1&&i.showLast()&&(e=i._getActualColor("lastMarkerColor"));if((typeof e===n||e===g)&&0>f&&i.showNegative()&&(e=i._getActualColor("negativeColor")),typeof e===n||e===g){var u=o.sparklineType();0===u?i.showMarkers()&&(e=i._getActualColor("markersColor")):1===u?e=i._getActualColor("seriesColor"):2===u&&(e=i._getActualColor("seriesColor"))}}return e===h||e===g?"Transparent":e},c.prototype._paintDataPoints=function(a,b,c,d,e,f,g,h){for(var i,k,l,n,o,p,q,r,s,t=this,u={Width:d,Height:e},v=t._getCachedIndexMaping(f,g),w=v.length,x=t.info.sparklineType(),y=0;w>y;y++)i=v[y],k=t._getDataPointColor(i,f,g),l=t._getDataPointPosition(i,u,f,g,h),a.fillStyle!==k&&(a.fillStyle=k),0===x?(a.save(),n=b+l.X+l.Width/2,o=c+l.Y+l.Height/2,a.translate(n,o),a.rotate(45*m/180),a.fillRect(0-l.Width/2,0-l.Height/2,l.Width,l.Height),a.restore()):(p=b+l.X+l.Width/4,p=j(p),q=c+l.Y,r=l.Width/2,s=l.Height,a.fillRect(p,q,r,s))},c.prototype._paintAxis=function(a,b,c,d,e,f,g,h){var i=this,k=i.info.setting();if(k.displayXAxis&&i._hasAxis(f,g)){var l={Width:d,Height:e},m=i._leftSpace(h),n=l.Width-i._rightSpace(h),o=j(i._getAxisY(l,f,h))+.5,p=o,q=k._getActualColor("axisColor"),r=h;1>r&&(r=1),a.strokeStyle!==q&&(a.strokeStyle=q),a.lineWidth!==r&&(a.lineWidth=r),a.beginPath(),a.moveTo(b+m,c+o),a.lineTo(b+n,c+p),a.stroke()}},c.prototype._hasAxisNormal=function(a){var b=this._getActualMaxValue(a);if(b!==-Number.MAX_VALUE){var c=this._getActualMinValue(a);if(c!==Number.MAX_VALUE)return b===c||0>=b*c}return!0},c.prototype._hasAxis=function(a,b){var c=this._hasAxisNormal(a);if(2!==this.info.sparklineType())return c;var d,e,f=this._getCachedIndexMaping(a,b),h=f.length;if(!c&&h>0)for(var i=0;h>i;i++)if(d=f[i],e=a[d],typeof e!==n&&e!==g)return!0;return c},c.prototype._getMinDatetime=function(a,b){var c=this._cachedMinDatetime;return(isNaN(c)||c===Number.MAX_VALUE)&&this._getMaxMindatetimes(a,b),this._cachedMinDatetime},c.prototype._getMaxDatetime=function(a,b){var c=this._cachedMaxDatetime;return(isNaN(c)||c===-Number.MAX_VALUE)&&this._getMaxMindatetimes(a,b),this._cachedMaxDatetime},c.prototype._getMaxMindatetimes=function(a,b){for(var c,d,e,f=this,h=new Date(0,0,0),i=Number.MAX_VALUE,j=f._getCachedIndexMaping(a,b),k=j.length,l=0;k>l;l++)c=j[l],d=b[c],isNaN(d)||(e=f._getValue(c,a),e!==g&&typeof e===n||isNaN(e)||typeof d!==n&&d!==g&&(d>h&&(h=d),i>d&&(i=d)));f._cachedMaxDatetime=h,f._cachedMinDatetime=i},c.prototype._calcItemWidth=function(a,b,c,d){var e,f,h,i=this,j=i._getMinDatetime(b,c),k=i._getMaxDatetime(b,c),l=[],m=i._getCachedIndexMaping(b,c),o=m.length;for(e=0;o>e;e++)h=m[e],f=c[h],typeof f===n||f===g||isNaN(f)||f&&l.push(f);l.sort(function(a,b){return a-b});var p=l.length;if(p>1&&j!==k){var q,r=Number.MAX_VALUE,s=0;for(e=1;p>e;e++)q=l[e],f=q-l[e-1],r>f&&f>0&&(r=f),s+=f;var t=(a.Width-i._leftSpace(d)-i._rightSpace(d))*r/s/2;return 2>t&&(t=2),t}return(a.Width-i._leftSpace(d)-i._rightSpace(d))/2},c.prototype._getItemWidth=function(a,b,c,d){var e=this;if(e.info.displayDateAxis())return e._calcItemWidth(a,b,c,d);var f=e._getCachedIndexMaping(b,c).length;return(a.Width-e._leftSpace(d)-e._rightSpace(d))/f},c.prototype._getItemX=function(a,b,c,d,e){var f,g=this,h=g._leftSpace(e);if(g.sparklineInfo().displayDateAxis()){f=g._getItemWidth(a,c,d,e);var i=g._getMaxDatetime(c,d),k=g._getMinDatetime(c,d);if(i===k)return h+f/2;var l=d[b];if(!l)return 0;var m=a.Width-h-g._rightSpace(e);m-=f;var n=i-k;return h+j((l-k)/n*m)}f=g._getItemWidth(a,c,d,e);var o=g._getCachedIndexMaping(c,d).indexOf(b),p=h+f*o;return j(p)},c.prototype._getCanvasSize=function(a,b){var c=this,d=a.Width-c._leftSpace(b)-c._rightSpace(b);d=k(d,0);var e=a.Height-c._topSpace(b)-c._bottomSpace(b);return e=k(e,0),{Width:d,Height:e}},c.prototype._getMaxMinValue=function(a){for(var b,c=this,d=a.length,e=0;d>e;e++)b=a[e],typeof b!==n&&b!==g&&("number"!=typeof b&&(b=0),b<c._cachedMinValue&&(c._cachedMinValue=b),b>c._cachedMaxValue&&(c._cachedMaxValue=b))},c.prototype._getActualMaxValue=function(a){var b=this;b._cachedMaxValue!==-Number.MAX_VALUE&&b._cachedMaxValue||b._getMaxMinValue(a);var c=b.info.setting(),d=c.maxAxisType;return 0===d?b._cachedMaxValue:1===d?c.groupMaxValue:2===d?c.manualMax:b._cachedMaxValue},c.prototype._getActualMinValue=function(a){var b=this;b._cachedMinValue!==Number.MAX_VALUE&&b._cachedMinValue||b._getMaxMinValue(a);var c=b.info.setting(),d=c.minAxisType;return 0===d?b._cachedMinValue:1===d?c.groupMinValue:2===d?c.manualMin:void 0},c.prototype._getItemHeightNormal=function(a,b,c,d){var e,f,g=this._getCanvasSize(a,d),h=this._getActualMaxValue(c),i=this._getActualMinValue(c),j=h-i;if(h===i){if(0===h)return 0;j=l(h)}return e=c[b],e||(e=0),f=g.Height/j,e*f},c.prototype._getItemHeight=function(a,b,c,d){var e,f=this,h=f.info,i=h.sparklineType();if(0===i)return f._getItemHeightNormal(a,b,c,d);
if(1===i){if(e=c[b],(typeof e===n||e===g)&&1===h.setting().displayEmptyCellsAs)return 0;var j=f._getItemHeightNormal(a,b,c,d);if(j>-f._minItemHeight&&j<f._minItemHeight){if(e>0)return j+f._minItemHeight;if(0>e)return j-f._minItemHeight}return j}if(2===i){if(e=c[b],typeof e===n||e===g||0===e||isNaN(e))return 0;var k=f._getCanvasSize(a,d);return e>=0?k.Height/2:-k.Height/2}},c.prototype._getAxisYNormal=function(a,b,c){var d=this,e=d._getCanvasSize(a,c),f=d._getActualMaxValue(b),g=d._getActualMinValue(b);if(f===-Number.MAX_VALUE||g===Number.MAX_VALUE)return a.Height/2;var h=f-g;if(f===g){if(0===f)return a.Height/2;h=f,0>f&&(f=0)}var i=e.Height/h;return d._topSpace(c)+f*i},c.prototype._getAxisY=function(a,b,c){return 2===this.info.sparklineType()?a.Height/2:this._getAxisYNormal(a,b,c)},c.prototype._getItemVisibleHeightNormal=function(a,b,c,d){var e,f,h=this,i=h._getCanvasSize(a,d),j=h._getActualMaxValue(c),k=h._getActualMinValue(c),l=j-k;if(j===k){if(0===j)return 0;l=j}if(e=i.Height/l,f=h._getValue(b,c),(typeof f===n||f===g)&&(f=0),j!==k&&j*k>0){var m=0;return m=f>=0?(f-k)*e:(f-j)*e}return f*e},c.prototype._getItemVisibleHeight=function(a,b,c,d){var e=this,f=e.info.sparklineType();if(0===f)return e._getItemVisibleHeightNormal(a,b,c,d);if(1===f){var h=e._getItemVisibleHeightNormal(a,b,c,d),i=e._minItemHeight;if(h>-i&&i>h){var j=e._getValue(b,c);if((typeof j===n||j===g)&&(j=0),0!==j)return j>0?h+i:h-i}return h}return 2===f?e._getItemHeight(a,b,c,d):void 0},c.prototype._getDataPointPositionNormal=function(a,b,c,d,e){var f=this,g=f._getItemWidth(b,c,d,e),h=f._getItemX(b,a,c,d,e);0>g&&(g=0),g=j(g),g%2===1&&(g+=1);var i=f._getItemHeight(b,a,c,e),m=f._getAxisY(b,c,e),n=f._getActualMaxValue(c),o=f._getActualMinValue(c),p=0;0>n&&0>o?p=k(f._topSpace(e),m):(p=m,i>=0&&(p=m-i));var q=f._getItemVisibleHeight(b,a,c,e),r=new s(h,p,g,l(q));if(0!==i){var t=f._topSpace(e);if(r.Y<t&&r.Bottom<t+1)r.Height=j(r.Height+1);else{var u=b.Height-f._bottomSpace(e);r.Bottom>u&&r.Y>u-1&&(r.Y=u-q,r.Height=q)}}return r},c.prototype._getLineWeight=function(a){var b=this.info.setting().lineWeight*a;return 1>b&&(b=1),b},c.prototype._getDataPointPosition=function(a,b,c,d,e){var f=this,h=f._getLineWeight(e);h++,2>h&&(h=2);var i=f._getDataPointPositionNormal(a,b,c,d,e);if(0===f.info.sparklineType()){i.X=i.X+(i.Width-h)/2;var j=f._getValue(a,c);typeof j!==n&&j!==g?(j>=0?i.Y-=h/2:i.Y=i.Bottom-h/2,i.Width=h,i.Height=h):(i.Width=0,i.Height=0)}if(f.info.group().setting.rightToLeft){var k=i.X,l=b.Width-k,m=l-i.Width;i=new s(m,i.Y,i.Width,i.Height)}return i},c}();a.SparklineRender=t;var u=function(){function b(a,b,c,d,e,f){var g=this;g.row=a,g.column=b,g._dataOrientation=d,g._data=c,g._group=new r(e,f),g._group.add(g),g._renderer=new t(g)}return b.prototype.group=function(a){var b=this;if(0===arguments.length){var c=b._group;return c||(c=new r,c.add(b),b._group=c),c}return a!==b._group&&(b._group&&b._group.remove(b),b._group=a,b._group&&(b._group.contains(b)||b._group.add(b)),b.onSparklineChanged()),b},b.prototype.sparklineType=function(a){var b=this;return 0===arguments.length?b.group().sparklineType:(b.group().sparklineType!==a&&(b.group().sparklineType=a,b.onSparklineChanged()),b)},b.prototype.onSparklineChanged=function(){var b=this._getWorksheet();if(b){var c=this;b._trigger(a.Events.SparklineChanged,{sheet:b,sheetName:b._name,sparkline:c})}},b.prototype.setting=function(a){return 0===arguments.length?this.group().setting:(this.group().setting=a,this)},b.prototype.data=function(a){var b=this;return 0===arguments.length?b._data:(b._data!==a&&(b._data=a,b.onSparklineChanged()),b)},b.prototype.dataOrientation=function(a){var b=this;return 0===arguments.length?b._dataOrientation:(b._dataOrientation!==a&&(b._dataOrientation=a,b.onSparklineChanged()),b)},b.prototype.dateAxisData=function(a){return 0===arguments.length?this.group().dateAxisData():(this.group().dateAxisData(a),this)},b.prototype.dateAxisOrientation=function(a){return 0===arguments.length?this.group().dateAxisOrientation():(this.group().dateAxisOrientation(a),this)},b.prototype.displayDateAxis=function(a){return 0===arguments.length?this.group().displayDateAxis:(this.group().displayDateAxis=a,this)},b.prototype.clone=function(){var a=this,c=new b;return c.row=a.row,c.column=a.column,c.data(a.data()),c.dataOrientation(a.dataOrientation()),c.group(a.group().clone()),c},b.prototype.paintSparkline=function(a,b,c,d,e){this._renderer.paint(a,b,c,d,e)},b.prototype._provideValues=function(b,c,i){var j=this._getWorksheet(),k=[];if(!j)return k;for(var l=d(b,c),m=0;l>m;m++){var n=e(j,m,b,c);!this.setting().displayHidden&&f(j,m,b,c)?n=0/0:n!==g&&n!==h&&(i?n="number"==typeof n?a._DateTimeHelper.fromOADate(n):Date.parse(n):"number"!=typeof n&&(n=a.__invalidValuePlaceHolder)),k.push(n)}return k},b.prototype._getWorksheet=function(){return this.group()&&this.group()._sparklineGroupManager?this.group()._sparklineGroupManager._sheet:g},b.prototype._isDefaultValue=function(a,b){switch(a){case"axisReference":return b===g;case"axisOrientation":return 1===b;default:return!1}},b.prototype.toJSON=function(){var a=this,b={row:a.row,col:a.column,orientation:a._dataOrientation,data:a._data,type:a._group.sparklineType,setting:a._group.setting,axisReference:a._group._axisReference,axisOrientation:a._group._axisOrientation},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},b.prototype.fromJSON=function(b){if(b){var c=this;if(b.row!==h&&b.row!==g&&(c.row=b.row),b.col!==h&&b.col!==g&&(c.column=b.col),b.orientation!==h&&b.orientation!==g&&(c._dataOrientation=b.orientation),b.data){var d=b.data;c._data=new a.Range(d.row,d.col,d.rowCount,d.colCount)}}},b}();a.Sparkline=u;var v=function(){function c(a,b){this._groups=[],this._sheet=a,this.evaluator=b}return c.prototype.groups=function(){return b(0===arguments.length,this,"_groups")},c.prototype.add=function(a){this.groups().push(a),a._sparklineGroupManager=this,a._adjustGroupMaxMinValue()},c.prototype.remove=function(a){this.groups().remove(a)},c.prototype.contains=function(a){return this.groups().contains(a)},c.prototype.count=function(){return this.groups().length},c.prototype._addRows=function(a,b){for(var c=this,d=0;d<c._groups.length;d++){var e=c._groups[d];if(e.displayDateAxis){var f=c._addRowRange(a,b,e.dateAxisData());e.dateAxisData(f)}for(var g=0;g<e._innerList.length;g++){var h=e._innerList[g];a<=h.row&&(h.row+=b);var i=c._addRowRange(a,b,h.data());h.data(i)}}},c.prototype._addColumns=function(a,b){for(var c=this,d=0;d<c._groups.length;d++){var e=c._groups[d];if(e.displayDateAxis){var f=c._addColumnRange(a,b,e.dateAxisData());e.dateAxisData(f)}for(var g=0;g<e._innerList.length;g++){var h=e._innerList[g];a<=h.column&&(h.column+=b);var i=c._addColumnRange(a,b,h.data());h.data(i)}}},c.prototype._removeRows=function(a,b){for(var c=this,d=0;d<c._groups.length;d++){var e=c._groups[d];if(e.displayDateAxis){var f=c._removeRowRange(a,b,e.dateAxisData());if(f===g||f===h){e.clear(),c.remove(e);continue}e.dateAxisData(f)}var i=[];i=i.concat(e._innerList);for(var j=0;j<i.length;j++){var k=i[j];if(k.row>=a&&k.row<a+b)e.remove(k);else{a<=k.row&&(k.row-=b);var l=c._removeRowRange(a,b,k.data());l!==g&&l!==h?k.data(l):e.remove(k)}}e.count()<=0&&c.remove(e)}},c.prototype._removeColumns=function(a,b){for(var c=this,d=0;d<c._groups.length;d++){var e=c._groups[d];if(e.displayDateAxis){var f=c._removeColumnRange(a,b,e.dateAxisData());if(f===g||f===h){e.clear(),c.remove(e);continue}e.dateAxisData(f)}var i=[];i=i.concat(e._innerList);for(var j=0;j<i.length;j++){var k=i[j];if(k.column>=a&&k.column<a+b)e.remove(k);else{a<=k.column&&(k.column-=b);var l=c._removeColumnRange(a,b,k.data());l!==g&&l!==h?k.data(l):e.remove(k)}}e.count()<=0&&c.remove(e)}},c.prototype.clear=function(a,b,c,d){var e=this;if(0===arguments.length){for(var f=0;f<e._groups.length;f++){var h=e._groups[f];h&&(h.SparklineGroupManager=g)}return void e._groups.clear()}for(var i=a;a+c>i;i++)for(var j=b;b+d>j;j++){var k=e._find(i,j);if(k){var l=k.group();l.remove(k),0===l.count()&&e.remove(l)}}},c.prototype._find=function(a,b){for(var c=0;c<this._groups.length;c++)for(var d=this._groups[c],e=0;e<d.count();e++){var f=d[e];if(f&&f.row===a&&f.column===b)return f}return g},c.prototype._copy=function(b,c,d,e,f,i,j){var k=this,l=k._sheet;if(l){var m,n,o=new a._GcSheetModel(f,i,g),p=d-b,q=e-c,r=l._getModel(),s=l.getRowCount(),t=l.getColumnCount();for(m=0;f>m;m++)if(!j||!l.isRowFilterOut(d+m))for(n=0;i>n;n++){var u=r.getSparkline(b+m,c+n);if(u){var v=u.clone();v.row=d+m,v.column=e+n;var w=v.dateAxisData();w!==g&&w!==h&&k._canOffset(w,p,q,s,t)&&v.dateAxisData(w.offset(q,p));var x=v.data();x!==h&&x!==g&&k._canOffset(x,p,q,s,t)&&v.data(x.offset(q,p)),k.add(v.group()),o.setValue(m,n,v)}}for(m=0;f>m;m++)if(!j||!l.isRowFilterOut(d+m))for(n=0;i>n;n++)r.setSparkline(d+m,e+n,o.getValue(m,n))}},c.prototype._canOffset=function(a,b,c,d,e){var f=this._getExpressionRange(a);if(f){var g=f.row<0?0:f.row,h=f.col<0?0:f.col,i=f.row<0?d:f.rowCount,j=f.col<0?e:f.colCount;return!(0>g+b||0>h+c||g+i+b>d||h+j+c>e)}return!1},c.prototype._move=function(b,c,d,e,f,h){var i=this._sheet;if(i){this._moveDataRange(b,c,d,e,f,h);var j,k,l=i._getModel(),m=new a._GcSheetModel(f,h,g);for(j=0;f>j;j++)for(k=0;h>k;k++){var n=l.getSparkline(b+j,c+k);n&&(n.row=d+j,n.column=e+k,m.setValue(j,k,n)),l.setSparkline(b+j,c+k,g)}for(j=0;f>j;j++)for(k=0;h>k;k++)l.setSparkline(d+j,e+k,m.getValue(j,k))}},c.prototype._moveDataRange=function(b,c,d,e,f,g){for(var h=this,i=new a.Range(b,c,f,g),j=d-b,k=e-c,l=0;l<h._groups.length;l++)for(var m=h._groups[l],n=0;n<m._innerList.length;n++){var o=m._innerList[n];if(o){var p=o.dateAxisData(),q=h._getExpressionRange(p);q&&i.containsRange(q)&&i.contains(o.row,o.column)&&o.dateAxisData(p.offset(k,j));var r=o.data(),s=h._getExpressionRange(r);s&&i.containsRange(s)&&i.contains(o.row,o.column)&&o.data(r.offset(k,j))}}},c.prototype._getExpressionRange=function(a){return a},c.prototype._swap=function(){},c.prototype._exCopy=function(a,b,c,d,e,f,i,j){var k=this,l=k._sheet;if(l){if(a===l)return void k._copy(b,c,d,e,f,i);for(var m=d-b,n=e-c,o=a._getModel(),p=l._getModel(),q=l.getRowCount(),r=l.getColumnCount(),s=0;f>s;s++)if(!j||!l.isRowFilterOut(d+s))for(var t=0;i>t;t++){var u=o.getSparkline(b+s,c+t);if(u){var v=u.clone();v.row=d+s,v.column=e+t;var w=v.dateAxisData();w!==h&&w!==g&&k._canOffset(w,m,n,q,r)&&v.dateAxisData(w.offset(n,m));var x=v.data();x!==h&&x!==g&&k._canOffset(x,m,n,q,r)&&v.data(x.offset(n,m)),k.add(v.group()),p.setSparkline(d+s,e+t,v)}else p.setSparkline(d+s,e+t,g)}}},c.prototype._exMove=function(a,b,c,d,e,f,h){var i=this,j=i._sheet;if(j){if(a===j)return void i._move(b,c,d,e,f,h);var k=a._getModel(),l=j._getModel();i._exMoveDataRange(a,b,c,d,e,f,h);for(var m=0;f>m;m++)for(var n=0;h>n;n++){var o=k.getSparkline(b+m,c+n);if(o){o.row=d+m,o.column=e+n;var p=o.group(),q=p.clone();p.remove(o),p.length<=0&&a._sparklineGroupManager.remove(p),q.add(o),i.add(q),l.setSparkline(d+m,e+n,o)}else l.setSparkline(d+m,e+n,g);k.setSparkline(b+m,c+n,g)}}},c.prototype._exMoveDataRange=function(b,c,d,e,f,g,h){var i=this,j=i._sheet;if(b&&j){if(b===j)return void i._moveDataRange(c,d,e,f,g,h);for(var k=new a.Range(c,d,g,h),l=e-c,m=f-d,n=0;n<b._sparklineGroupManager._groups.length;n++)for(var o=b._sparklineGroupManager._groups[n],p=0;p<o._innerList.length;p++){var q=o._innerList[p];if(q){var r=q.dateAxisData(),s=i._getExpressionRange(r);s&&i._sameSource(b,r)&&k.containsRange(s)&&k.contains(q.row,q.column)&&q.dateAxisData(r.offset(m,l));var t=q.data(),u=i._getExpressionRange(t);u&&i._sameSource(b,t)&&k.containsRange(u)&&k.contains(q.row,q.column)&&q.data(t.offset(m,l))}}}},c.prototype._sameSource=function(){return!0},c.prototype._addRowRange=function(b,c,d){return d?b>d.row+d.rowCount-1?d:b>d.row?new a.Range(d.row,d.col,d.rowCount+c,d.colCount):new a.Range(d.row+c,d.col,d.rowCount,d.colCount):g},c.prototype._addColumnRange=function(b,c,d){return d?b>d.col+d.colCount-1?d:b>d.col?new a.Range(d.row,d.col,d.rowCount,d.colCount+c):new a.Range(d.row,d.col+c,d.rowCount,d.colCount):g},c.prototype._removeColumnRange=function(b,c,d){var e=this._rangeSubCat(d.col,d.col+d.colCount-1,b,b+c-1);return e?new a.Range(d.row,e.start,d.rowCount,e.end-e.start+1):g},c.prototype._removeRowRange=function(b,c,d){var e=this._rangeSubCat(d.row,d.row+d.rowCount-1,b,b+c-1);return e?new a.Range(e.start,d.col,e.end-e.start+1,d.colCount):g},c.prototype._rangeSubCat=function(a,b,c,d){var e,f,h=-1;if(a>d){var i=d-c+1;return h=a-i,e=b-i,{start:h,end:e}}if(c>b)return h=a,e=b,{start:h,end:e};if(a>=c){var j=b-a+1,k=0;for(f=a;d>=f&&b>=f;f++)k++;return h=c,e=h+j-k-1,{start:h,end:e}}var l=0;for(f=a;b>=f;f++)-1===h&&(c>f||f>d)&&(h=f),(c>f||f>d)&&l++;return-1!==h&&l>0?(e=h+l-1,{start:h,end:e}):g},c.prototype._isDefaultValue=function(a,b){switch(a){case"groups":return!b||0===b.length;default:return!1}},c.prototype.toJSON=function(){var a={groups:this._groups?this._groups:g},b={};for(var c in a){var d=a[c];this._isDefaultValue(c,d)||(b[c]=d)}return $.isEmptyObject(b)?h:b},c.prototype.fromJSON=function(a){if(a&&a.groups){this._groups=[];for(var b=a.groups,c=b.length,d=0;c>d;d++){var e=new r;e.fromJSON(b[d]),this.add(e)}}},c}();a.WorksheetSparklineGroupManager=v;var w=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(u);a.SparklineValue=w}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("touch",["core.common","core.sheet_action","core.sheet_model","core.sheet_border"]);var b=null,c=void 0,d=Math.abs,e=Math.min,f=Math.pow,g=Math.atan2,h=Math.PI,i=Math.round,j=Math.sqrt,k=Math.atan,l="undefined",m=100,n=function(){function d(){var a=this;a._elements=[],a._pressedPointers={length:0},a._checkPointerIntervalId=-1,a._manipulationProcessor=new p,a._tapEventProcesser=new q}return d.prototype.ManipulationStarting=function(a){var b=this._manipulationProcessor;b&&(b.ManipulationStarting=a)},d.prototype.ManipulationStarted=function(a){var b=this._manipulationProcessor;b&&(b.ManipulationStarted=a)},d.prototype.ManipulationCompleted=function(a){var b=this,c=b._manipulationProcessor;c&&(c.ManipulationCompleted=function(c){if(a){a(c);var d=b._touchMouseMessageFilter;d&&d.postProcessManipulationComplete()}})},d.prototype.ManipulationInertiaStarting=function(a){var b=this._manipulationProcessor;b&&(b.ManipulationInertiaStarting=a)},d.prototype.ManipulationDelta=function(a){var b=this._manipulationProcessor;b&&(b.ManipulationDelta=a)},d.prototype.Tapped=function(a){var b=this._tapEventProcesser;b&&(b.Tapped=a)},d.prototype.DoubleTapped=function(a){var b=this._tapEventProcesser;b&&(b.DoubleTapped=a)},d.prototype.RightTapped=function(a){var b=this._tapEventProcesser;b&&(b.RightTapped=a)},d.prototype.TouchOperatorStart=function(a){this.touchOperatorStart=a},d.prototype.TouchOperatorEnd=function(a){this.touchOperatorEnd=a},d.prototype._getOffsetRelativeToDownElement=function(a,b){var c,d={left:0,top:0};if(c=b?b.element:this._downElement.element,a!==c){var e=$(a).offset(),f=$(c).offset();d.left=e.left-f.left,d.top=e.top-f.top}return d},d.prototype.msPointerDown=function(b,c){if(c.pointerType===c.MSPOINTER_TYPE_TOUCH||"touch"===c.pointerType){var d=this._getOffsetRelativeToDownElement(c.target,b),e=this._down(b,c.target,c.pointerId,new t(c.offsetX+d.left,c.offsetY+d.top),c.timeStamp);if(e&&a.util.cancelDefault(c),"sheet"===this._downElement.eventFlag){var f=c.pageX-(c.offsetX+d.left),g=c.pageY-(c.offsetY+d.top);window.gcGlobal.canvasOffset={top:g,left:f}}}},d.prototype.msPointerMove=function(b){if(b.pointerType===b.MSPOINTER_TYPE_TOUCH||"touch"===b.pointerType){if(this._pressedPointers[b.pointerId]===c)return!1;var d=this._getOffsetRelativeToDownElement(b.target),e=this._move(b.pointerId,new t(b.offsetX+d.left,b.offsetY+d.top),b.timeStamp);e&&a.util.cancelDefault(b)}},d.prototype.msPointerUp=function(b){if(b.pointerType===b.MSPOINTER_TYPE_TOUCH||"touch"===b.pointerType){if(this._pressedPointers[b.pointerId]===c)return!1;var d=this._getOffsetRelativeToDownElement(b.target),e=this._up(b.pointerId,new t(b.offsetX+d.left,b.offsetY+d.top));e&&a.util.cancelDefault(b)}},d.prototype.msPointerCancel=function(b){if(b.pointerType===b.MSPOINTER_TYPE_TOUCH||"touch"===b.pointerType){if(this._pressedPointers[b.pointerId]===c)return!1;var d=this._getOffsetRelativeToDownElement(b.target),e=this._cancel(b.pointerId,new t(b.offsetX+d.left,b.offsetY+d.top));e&&a.util.cancelDefault(b)}},d.prototype._getElementOffset=function(a){var b=$(a).offset();return b?(isNaN(document.body.clientTop)||(b.top+=document.body.clientTop),isNaN(document.body.clientLeft)||(b.left+=document.body.clientLeft)):b={top:0,left:0},b},d.prototype.touchStart=function(b,c){for(var d=this._getElementOffset(b.element),e=!1,f=0;f<c.changedTouches.length;f++){var g=c.changedTouches[f],h=$.browser.mozilla?(new Date).valueOf():c.timeStamp;e=this._down(b,c.target,g.identifier,new t(g.pageX-d.left,g.pageY-d.top),h)||e}e&&a.util.cancelDefault(c)},d.prototype.touchMove=function(b){for(var c=this._getElementOffset(this._downElement.element),d=!1,e=0;e<b.changedTouches.length;e++){var f=b.changedTouches[e],g=$.browser.mozilla?(new Date).valueOf():b.timeStamp;d=this._move(f.identifier,new t(f.pageX-c.left,f.pageY-c.top),g)||d}d&&a.util.cancelDefault(b)},d.prototype.touchEnd=function(b){for(var c=this._getElementOffset(this._downElement.element),d=!1,e=0;e<b.changedTouches.length;e++){var f=b.changedTouches[e];d=this._up(f.identifier,new t(f.pageX-c.left,f.pageY-c.top))||d}d&&a.util.cancelDefault(b)},d.prototype.touchCancel=function(b){for(var c=this._getElementOffset(this._downElement.element),d=!1,e=0;e<b.changedTouches.length;e++){var f=b.changedTouches[e];d=this._cancel(f.identifier,new t(f.pageX-c.left,f.pageY-c.top))||d}d&&a.util.cancelDefault(b)},d.prototype._startCheckPointer=function(){-1===this._checkPointerIntervalId&&(this._checkPointerIntervalId=setInterval(this._checkCancelPointer,200))},d.prototype._endCheckPointer=function(){-1!==this._checkPointerIntervalId&&(clearInterval(this._checkPointerIntervalId),this._checkPointerIntervalId=-1)},d.prototype._checkCancelPointer=function(){var a=this;if(!a._manipulationProcessor||3!==a._manipulationProcessor._process){var b=(new Date).valueOf(),c=[],d=a._pressedPointers,e=0;for(var f in d)b-d[f].time>200&&c.push(d[f]),e++;for(var g=0;g<c.length;g++)a._cancel(c[g].id,c[g].position),delete d[c[g].id];e===c.length&&a._endCheckPointer()}},d.prototype._fixPosition=function(a){var b=this;if(b._downElement===b._manipulationElement)return a;var c=$(b._downElement.element).offset(),d=$(b._manipulationElement.element).offset();a.X+=c.left-d.left,a.Y+=c.top-d.top},d.prototype._setCaptureElement=function(a){var c=this,d=c._elements;c._manipulationElement=b,c._touchMouseMessageFilter=b;for(var e=0;e<d.length;e++)if(d[e]===a){var f=d[e],g=b,h=b;if(f.canDoManipulation&&!f.canDoManipulation()){for(var e=0;e<d.length;e++){var i=d[e];if(i!==f&&i.level>=0&&i.level<f.level&&(!i.canDoManipulation||i.canDoManipulation())){g=i;break}}if(g===b)return!1}if(f.canDoTap&&!f.canDoTap()){for(var e=0;e<d.length;e++){var i=d[e];if(i!==f&&i.level>=0&&i.level<f.level&&(!i.canDoTap||i.canDoTap())){h=i;break}}if(h===b)return!1}g===b&&(g=f),h===b&&(h=f),c._downElement=f,c._manipulationElement=g,c._tapElement=h,c.ManipulationStarting(g.manipulationStarting||b),c.ManipulationStarted(g.manipulationStarted||b),c.ManipulationDelta(g.manipulationDelta||b),c.ManipulationInertiaStarting(g.manipulationInertiaStarting||b),c.ManipulationCompleted(g.manipulationCompleted||b),c.Tapped(h.tapped||b),c.DoubleTapped(h.doubleTapped||b),c.RightTapped(h.rightTapped||b),c.TouchOperatorStart(g.touchOperatorStart||b),c.TouchOperatorEnd(g.touchOperatorEnd||b),g.messageFilter&&(c._touchMouseMessageFilter=f.messageFilter);break}return!0},d.prototype._down=function(a,d,e,f,g){var h=this;return h._pressedPointers[e]!==c?!1:0!==h._pressedPointers.length||h._setCaptureElement(a,d)?h._manipulationElement===b||typeof h._manipulationElement===l?!1:h._pressedPointers.length>=h._manipulationElement.maxPointer?!0:h._touchMouseMessageFilter&&h._touchMouseMessageFilter.preProcessPointerDown()?!1:(h._fixPosition(f),h._touchMouseMessageFilter&&0===h._pressedPointers.length&&h._touchMouseMessageFilter.preProcessManipulationStarting(),h._pressedPointers[e]={id:e,time:(new Date).valueOf(),position:f},h._pressedPointers.length++,h._manipulationProcessor&&(h._manipulationProcessor.PreviewPointerDown(d,e,f,g),h._manipulationProcessor.PointerDown(e,f,h._pressedPointers.length,g)),1===h._pressedPointers.length&&h._tapEventProcesser&&h._tapEventProcesser.PointerDown(f),1===h._pressedPointers.length&&h.touchOperatorStart&&h.touchOperatorStart({Position:f}),!0):!1},d.prototype._move=function(a,b,d){var e=this;return e._pressedPointers[a]===c?!1:e._touchMouseMessageFilter&&e._touchMouseMessageFilter.preProcessPointerMove()?!1:(e._fixPosition(b),e._pressedPointers[a]={id:a,time:(new Date).valueOf(),position:b},e._manipulationProcessor&&e._manipulationProcessor.PointerMove(a,b,d),!0)},d.prototype._up=function(a,b){var d=this;return d._pressedPointers[a]===c?!1:(delete d._pressedPointers[a],d._pressedPointers.length--,d._touchMouseMessageFilter&&d._touchMouseMessageFilter.preProcessPointerUp()?!1:(d._fixPosition(b),d._manipulationProcessor&&(d._manipulationProcessor.PreviewPointerUp(a),d._manipulationProcessor.PointerUp(a)),0===d._pressedPointers.length&&d._tapEventProcesser&&(d._tapEventProcesser.PreviewPointerUp(b),d._tapEventProcesser.PointerUp(b)),0===d._pressedPointers.length&&d.touchOperatorEnd&&d.touchOperatorEnd({Position:b}),d._touchMouseMessageFilter&&0===d._pressedPointers.length&&0===d._manipulationProcessor._process&&d._touchMouseMessageFilter.postProcessManipulationComplete(),!0))},d.prototype._cancel=function(a,b){return this._up(a,b)},d.prototype.attachDettach=function(a,c){var d=this,e=a.element,f=d._elements,g=f.indexOf(a);if(!(g>=0&&c||0>g&&!c)){var h="."+a.eventFlag,i=".gcSheet",j="MSPointerDown"+i,k="MSPointerMove"+i+h,m="MSPointerUp"+i+h,n="MSPointerCancel"+i+h,o="MSLostPointerCapture"+i+h,p="pointerdown"+i,q="pointermove"+i+h,r="pointerup"+i+h,s="LostPointerCapture"+i+h,t="pointercancel"+i+h,u="touchstart"+i,v="touchmove"+i,w="touchend"+i,x="touchcancel"+i;c?window.navigator.msPointerEnabled?(e.style.msTouchAction!==b&&typeof e.style.msTouchAction!==l&&(e.style.msTouchAction="none"),function(a){$(e).bind(j,function(b){d.msPointerDown(a,b.originalEvent)}).bind(p,function(b){d.msPointerDown(a,b.originalEvent)})}.call(d,a),$(document).bind(k,function(a){d.msPointerMove(a.originalEvent)}).bind(m,function(a){d.msPointerUp(a.originalEvent)}).bind(q,function(a){d.msPointerMove(a.originalEvent)}).bind(r,function(a){d.msPointerUp(a.originalEvent)}).bind(n,function(a){d.msPointerCancel(a.originalEvent)}).bind(o,function(a){d.msPointerCancel(a.originalEvent)}).bind(s,function(a){d.msPointerCancel(a.originalEvent)}).bind(t,function(a){d.msPointerCancel(a.originalEvent)})):(function(a){$(e).bind(u,function(b){d.touchStart(a,b.originalEvent)})}.call(d,a),$(e).bind(v,function(a){d.touchMove(a.originalEvent)}).bind(w,function(a){d.touchEnd(a.originalEvent)}).bind(x,function(a){d.touchCancel(a.originalEvent)})):window.navigator.msPointerEnabled?($(e).unbind(j).unbind(p),$(document).unbind(k).unbind(q).unbind(m).unbind(r).unbind(n).unbind(t).unbind(o).unbind(s)):$(e).unbind(u).unbind(v).unbind(w).unbind(x),c?f.push(a):f.splice(g,1)}},d.prototype.dispose=function(){for(var a=this._elements,b=a.length-1;b>=0;b--)this.attachDettach(a[b],!1)},d}();a.TouchEventProvider=n;var o,p=function(){function a(){var a=this;a._totalTranslateX=0,a._totalTranslateY=0,a._totalScale=1,a._totalRotation=0,a._totalExpansion=0,a._process=0,a._workingModes=511,a._manipulatorPointers=new D,a._minimumScaleRotateRadius=20,a._deltaHistory=new v}return a.prototype.PreviewPointerDown=function(a,b,c,d){var e=this;3===e._process&&e.Complete(!0),e._originalSource=a;var f=new C(b);f.PreviousPoint=c,f.InitialPoint=c,e._manipulatorPointers.Add(f),e._lastTime=d,e._manipulatorPointers.Count()>1&&(e.TranslateXLocked=!1,e.TranslateYLocked=!1,1===e._process&&e.StartManipulation())},a.prototype.PointerDown=function(a,b,c){0===this._process&&1===c&&this.Starting(this._manipulatorPointers.ItemAt(0).InitialPoint)},a.prototype.PointerMove=function(a,c,e){var f=this;if(0!==f._workingModes&&f._manipulatorPointers.Contains(a)){if(1===f._process&&1===f._manipulatorPointers.Count()){var g=f.IsPinned();if(!f.SupportsMode(1)&&!f.SupportsMode(2)&&!g)return;if(s.AreClose(c,f._manipulatorPointers.Find(a).InitialPoint))return;var h=d(c.X-f._manipulatorPointers.Find(a).InitialPoint.X),i=d(c.Y-f._manipulatorPointers.Find(a).InitialPoint.Y);f.SetTranslateRails(h,i)}if(!(e-f._lastTime<s.ManipulationDeltaInterval)){f._manipulatorPointers.Find(a).CurrentPoint=c;var j=f._manipulatorPointers.Count();if(j>1)for(var k=0;j>k;k++){var l=f._manipulatorPointers.ItemAt(k);if(!l.CurrentPoint)return}f.PointerMoveCore(e),f._lastTime=e;for(var j=f._manipulatorPointers.Count(),k=0;j>k;k++){var l=f._manipulatorPointers.ItemAt(k);l.PreviousPoint=l.CurrentPoint,l.CurrentPoint=b}}}},a.prototype.PointerUp=function(){var a=this;a._needFireEvents&&(a.OnManipulationCompleted(a._needFireEvents),a._needFireEvents=b)},a.prototype.PreviewPointerUp=function(a){var b=this;b._manipulatorPointers.Contains(a)&&(b._manipulatorPointers.Remove(a),2===b._process?0===b._manipulatorPointers.Count()&&(b.SupportsMode(64)||b.SupportsMode(256)||b.SupportsMode(128)?b.StartInertia():b.Complete(!0)):2===b._process||3===b._process?b.Complete(!0):1===b._process&&b.Complete(!1))},a.prototype.PointerMoveCore=function(a){var b,c,d,e,f,g,h=this,i=h.CalculateTranslate();b=i.translateX,c=i.translateY,g=i.position;var j=h.CalculateRotationAndScale();f=j.rotation,e=j.scale,d=j.expansion,h._totalTranslateX+=b,h._totalTranslateY+=c,h._totalScale*=e,h._totalRotation+=f,h._totalExpansion+=d;var k=new u;if(k.expansion=d,k.rotation=f,k.timeStamp=a-h._lastTime,k.translateX=b,k.translateY=c,h._deltaHistory.Enqueue(k),h._lastPosition=g,1===h._process||2===h._process){if(1===h._process){var l=h.StartManipulation();if(l)return}var m=new B;m.Expansion=d,m.Rotation=f,m.Scale=e,m.Translation=new t(b,c);var n=new w(h._deltaHistory),o=new H(h._originalSource,h.GetCumulative(),m,!1,g,n);if(h.OnManipulationDelta(o),o.IsComplete)return void h.Complete(!0)}},a.prototype.StartManipulation=function(){var a=this;a._process=2;var b=new J(a._originalSource,a._manipulatorPointers.Count(),a.GetCumulative(),a._manipulatorPointers.ItemAt(0).InitialPoint);return a.OnManipulationStarted(b),b.IsComplete?(a.Complete(!0),!0):!1},a.prototype.SetTranslateRails=function(a,b){var c=r.GetTranslateLocked(a,b);this.TranslateXLocked=c.translateXLocked,this.TranslateYLocked=c.translateYLocked},a.prototype.CalculateTranslate=function(){var a=0,b=0,c=this.GetAveragePoint(),d=c.currentAveragePoint,e=c.previousAveragePoint,f=new t(d.X,d.Y);return a=d.X-e.X,b=d.Y-e.Y,{translateX:a,translateY:b,position:f}},a.prototype.CalculateRotationAndScale=function(){var a=this,b=0,c=1,d=0;if(a.SupportsMode(16)&&1===a._manipulatorPointers.Count()&&a.IsPinned()&&(b=a.CalculateSingleManipulatorRotation(a._manipulatorPointers.ItemAt(0).CurrentPoint,a._manipulatorPointers.ItemAt(0).PreviousPoint,a._pivot)),a._manipulatorPointers.Count()>1){var e=a.CalculateMultiManipulatorRotationAndScale();b=e.rotation,c=e.scale,d=e.expansion}return b=b/h*180,{rotation:b,scale:c,expansion:d}},a.prototype.CalculateMultiManipulatorRotationAndScale=function(){for(var a=this,b=a.GetAveragePoint(),c=b.currentAveragePoint,d=b.previousAveragePoint,e=a.IsPinned(),f=e?a._pivot.Center:new t(0,0),g=0,h=1,i=0,j=0,k=0,l=0,m=0,n=a._manipulatorPointers.Count(),o=0;n>o;o++){var p=a._manipulatorPointers.ItemAt(o).CurrentPoint,q=a._manipulatorPointers.ItemAt(o).PreviousPoint,r=a.GetLength(p,c),s=a.GetLength(q,d),u=e?new t(q.X-f.X,q.Y-f.Y):new t(q.X-d.X,q.Y-d.Y),v=e?new t(p.X-f.X,p.Y-f.Y):new t(p.X-c.X,p.Y-c.Y),w=a.GetLength(q,f),x=a.GetLength(p,f);if(s>=a._minimumScaleRotateRadius&&r>=a._minimumScaleRotateRadius&&(k++,l+=r,m+=s,(!e||w>=a._minimumScaleRotateRadius)&&x>=a._minimumScaleRotateRadius)){var y=a.AngleBetween(u,v);g+=y,j++}}return j>0&&a.SupportsMode(16)?g/=j:g=0,k>0&&a.SupportsMode(32)?(h=l/m,i=(l-m)/k,a._lastDistance=l/k):a._lastDistance=0,{rotation:g,scale:h,expansion:i}},a.prototype.CalculateSingleManipulatorRotation=function(a,b,c){var d=new t(c.Center.X,c.Center.Y),g=new t(b.X-d.X,b.Y-d.Y),h=new t(a.X-d.X,a.Y-d.Y),i=e(1,f(this.GetLength(b,d)/c.Radius,4)),j=this.AngleBetween(g,h);return isNaN(j)?0:j*i},a.prototype.AngleBetween=function(a,b){var c=g(b.Y,b.X)-g(a.Y,a.X);return c>h?c-=2*h:-h>c&&(c+=2*h),c},a.prototype.SupportsMode=function(a){return 0!==(this._workingModes&a)},a.prototype.GetLength=function(a,b){return j((b.X-a.X)*(b.X-a.X)+(b.Y-a.Y)*(b.Y-a.Y))},a.prototype.GetAveragePoint=function(){for(var a=0,b=0,c=0,d=0,e=this._manipulatorPointers.Count(),f=0;e>f;f++){var g=this._manipulatorPointers.ItemAt(f);a+=g.PreviousPoint.X,b+=g.PreviousPoint.Y,c+=g.CurrentPoint.X,d+=g.CurrentPoint.Y}var h=new t(a/e,b/e),i=new t(c/e,d/e);return{currentAveragePoint:i,previousAveragePoint:h}},a.prototype.IsPinned=function(){return this._pivot&&!isNaN(this._pivot.Radius)},a.prototype.Starting=function(a){var c=this,d=new K(c._originalSource,c._workingModes,b,a);return d.Mode=511,c.OnManipulationStarting(d),c.ManipulationMode=d.Mode,0===d.Mode?(c.Complete(!1),!1):(c._workingModes=d.Mode,c._pivot=d.Pivot,c._process=1,!0)},a.prototype.Complete=function(a){var c=this,d=3===c._process;if(c._process=0,c._inertiaTimer&&(clearInterval(c._inertiaTimer),c._inertiaTimer=b),a){var e=new G(c._originalSource,c.GetCumulative(),d,t.Round(c._lastPosition),new w(c._deltaHistory));3===c._process?c._needFireEvents=e:c.OnManipulationCompleted(e)}c._deltaHistory.Clear(),c._manipulatorPointers.Clear(),c._pivot=b,c._totalTranslateX=0,c._totalTranslateY=0,c._totalScale=1,c._totalRotation=0,c._totalExpansion=0,c.TranslateXLocked=!1,c.TranslateYLocked=!1,c._workingModes=0},a.prototype.StartInertia=function(){var a=this,c=new A,d=new w(a._deltaHistory);if(c.CurrentTranslateXVelocity=a.SupportsMode(64)?d.Linear().X:0,c.CurrentTranslateYVelocity=a.SupportsMode(64)?d.Linear().Y:0,c.CurrentExpansionVelocity=a.SupportsMode(256)?d.Expansion():0,c.CurrentRotationVelocity=a.SupportsMode(128)?d.Angular():0,0===c.CurrentTranslateXVelocity&&0===c.CurrentTranslateYVelocity&&0===c.CurrentExpansionVelocity&&0===c.CurrentRotationVelocity)return void a.Complete(!0);c.TranslateBehavior=new z(c.CurrentTranslateXVelocity,c.CurrentTranslateYVelocity),c.ExpansionBehavior=new x(c.CurrentExpansionVelocity),c.RotationBehavior=new y(c.CurrentRotationVelocity),d=new w(b,c.CurrentTranslateXVelocity,c.CurrentTranslateYVelocity,c.CurrentRotationVelocity,c.CurrentExpansionVelocity);var e=new I(a._originalSource,a.GetCumulative(),new B,d,c.ExpansionBehavior,c.RotationBehavior,c.TranslateBehavior);a.OnManipulationInertiaStarting(e),c.TranslateBehavior=e.TranslationBehavior,c.ExpansionBehavior=e.ExpansionBehavior,c.RotationBehavior=e.RotationBehavior,c.TranslateBehavior.XDeceleration<=0&&c.TranslateBehavior.YDeceleration<=0&&c.TranslateBehavior.SetDecelerationInternal(.003),c.ExpansionBehavior.DecelerationInternal()<=0&&c.ExpansionBehavior.SetDecelerationInternal(.002),c.RotationBehavior.DecelerationInternal()<=0&&c.RotationBehavior.SetDecelerationInternal(.003);var f=(new Date).valueOf();c.StartTime=f,c.LastTime=f,c.DeltaXRemainder=0,c.DeltaYRemainder=0,a._process=3,a._inertiaTimer=setInterval(function(){try{a.InertiaTick(c)}catch(b){}},20)},a.prototype.InertiaTick=function(a){var c=this,e=(new Date).valueOf(),f=(e-a.StartTime,e-a.LastTime);if(0!==f){var g=a.CurrentTranslateXVelocity,h=a.CurrentTranslateYVelocity,j=a.CurrentExpansionVelocity,k=a.CurrentRotationVelocity;
a.CurrentTranslateXVelocity=c.GetInertiaCurrentVelocity(f,a.TranslateBehavior.XDeceleration,a.CurrentTranslateXVelocity),a.CurrentTranslateYVelocity=c.GetInertiaCurrentVelocity(f,a.TranslateBehavior.YDeceleration,a.CurrentTranslateYVelocity),a.CurrentExpansionVelocity=c.GetInertiaCurrentVelocity(f,a.ExpansionBehavior.DecelerationInternal(),a.CurrentExpansionVelocity),a.CurrentRotationVelocity=c.GetInertiaCurrentVelocity(f,a.RotationBehavior.DecelerationInternal(),a.CurrentRotationVelocity),g=(g+a.CurrentTranslateXVelocity)/2,h=(h+a.CurrentTranslateYVelocity)/2,j=(j+a.CurrentExpansionVelocity)/2,k=(k+a.CurrentRotationVelocity)/2,a.LastTime=e;var l=!1;c.IsZero(g)&&c.IsZero(h)&&c.IsZero(j)&&c.IsZero(k)&&(l=!0);var m=f*g,n=f*h,o=f*j,p=f*k,q=1;if(c._lastDistance>0&&(c._lastDistance+2*o<0&&(o=-c._lastDistance/2+1),0!==c._lastDistance&&(q=(c._lastDistance+2*o)/c._lastDistance)),c._totalExpansion+=o,c._totalRotation+=p,c._totalTranslateX+=m,c._totalTranslateY+=n,c._totalScale*=q,c._lastDistance+=o,c._lastPosition=new t(c._lastPosition.X+m,c._lastPosition.Y+n),a.DeltaXRemainder+=m,a.DeltaYRemainder+=n,l){if(m=i(a.DeltaXRemainder),n=i(a.DeltaYRemainder),c.IsZero(m)&&c.IsZero(n))return void c.Complete(!0)}else d(a.DeltaXRemainder)>=1&&(m=a.DeltaXRemainder,a.DeltaXRemainder-=m),d(a.DeltaYRemainder)>=1&&(n=a.DeltaYRemainder,a.DeltaYRemainder-=n);var r=new B;r.Translation=new t(m,n),r.Scale=q,r.Expansion=o,r.Rotation=p;var s=new w(b,a.CurrentTranslateXVelocity,a.CurrentTranslateYVelocity,a.CurrentRotationVelocity,a.CurrentExpansionVelocity),u=new H(c._originalSource,c.GetCumulative(),r,!0,t.Round(c._lastPosition),s);return c.OnManipulationDelta(u),u.IsComplete?void c.Complete(!0):void(l&&c.Complete(!0))}},a.prototype.GetInertiaCurrentVelocity=function(a,b,c){if(this.IsZero(c))return 0;var d;return d=0>c?c+b*a:c-b*a,(0>d&&c>0||d>0&&0>c)&&(d=0),d},a.prototype.GetCumulative=function(){var a=this,b=new B;return b.Expansion=a._totalExpansion,b.Rotation=a._totalRotation,b.Scale=a._totalScale,b.Translation=new t(a._totalTranslateX,a._totalTranslateY),b},a.prototype.IsZero=function(a){return d(a)<=2.220446049250313e-16},a.prototype.GetManipulationData=function(a,c,d,e){var f=this,g=new B,h=new B,i=0,j=0,k=0,l=0,m=f.SupportsMode(4)&&f.TranslateXLocked,n=f.SupportsMode(8)&&f.TranslateYLocked;!f.SupportsMode(1)||n||a&&!f.SupportsMode(64)||(g.Translation.X=c.Translation.X,h.Translation.X=d.Translation.X,i=e.Linear().X),!f.SupportsMode(2)||m||a&&!f.SupportsMode(64)||(g.Translation.Y=c.Translation.Y,h.Translation.Y=d.Translation.Y,j=e.Linear().Y),!f.SupportsMode(32)||a&&!f.SupportsMode(256)?(g.Scale=c.Scale,h.Scale=1):(g.Scale=c.Scale,g.Expansion=c.Expansion,h.Scale=d.Scale,h.Expansion=d.Expansion,l=e.Expansion()),!f.SupportsMode(16)||a&&!f.SupportsMode(128)||(g.Rotation=c.Rotation,h.Rotation=d.Rotation,k=e.Angular());var o=new w(b,i,j,k,l);return new E(g,h,o)},a.prototype.OnManipulationStarting=function(a){this.ManipulationStarting&&a&&this.ManipulationStarting(a)},a.prototype.OnManipulationStarted=function(a){this.ManipulationStarted&&a&&this.ManipulationStarted(a)},a.prototype.OnManipulationCompleted=function(a){if(this.ManipulationCompleted&&a){var b=this.GetManipulationData(!1,a.Cumulative,a.Cumulative,a.Velocities);a.Cumulative=b.Cumulative,a.Velocities=b.Velocities,this.ManipulationCompleted(a)}},a.prototype.OnManipulationInertiaStarting=function(a){if(this.ManipulationInertiaStarting&&a){var b=this.GetManipulationData(!1,a.Cumulative,a.Delta,a.Velocities);a.Cumulative=b.Cumulative,a.Delta=b.Delta,a.Velocities=b.Velocities,this.ManipulationInertiaStarting(a)}},a.prototype.OnManipulationDelta=function(a){if(this.ManipulationDelta&&a){var b=this.GetManipulationData(a.IsInertia,a.Cumulative,a.Delta,a.Velocities);a.Cumulative=b.Cumulative,a.Delta=b.Delta,a.Velocities=b.Velocities,this.ManipulationDelta(a)}},a}(),q=function(){function a(){}return a.prototype.PointerDown=function(a){var b=this;if(b._pointerCount++,!(b._pointerCount>1)){var c=(new Date).valueOf();b._firstDownPosition&&s.AreClose(a,b._firstDownPosition)&&c-b._lastDownTimestamp<s.DoubleTappedTimeOffset?b._count++:(b._firstDownPosition=a,b._count=1),b._lastDownPosition=a,b._lastDownTimestamp=c}},a.prototype.PointerUp=function(){var a=this;a._needFireEvents&&(a._needFireEvents instanceof L?a.OnTapped(a._needFireEvents):a._needFireEvents instanceof M&&a.OnRightTapped(a._needFireEvents),a._needFireEvents=b)},a.prototype.PreviewPointerUp=function(a){var c=this;if(c._pointerCount--,!(c._pointerCount>0)){var d=(new Date).valueOf();s.AreClose(a,c._lastDownPosition)?d-c._lastDownTimestamp>s.RightTappedTimeOffset?c._needFireEvents=new M(c._lastDownPosition):c._count>1?(c._count=0,c.OnDoubleTapped(new N(c._firstDownPosition)),c._firstDownPosition=b):c._needFireEvents=new L(c._lastDownPosition):c._firstDownPosition=b}},a.prototype.PointerCancel=function(){this._firstDownPosition=b},a.prototype.OnTapped=function(a){this.Tapped&&a&&this.Tapped(a)},a.prototype.OnDoubleTapped=function(a){this.DoubleTapped&&a&&this.DoubleTapped(a)},a.prototype.OnRightTapped=function(a){this.RightTapped&&a&&this.RightTapped(a)},a}(),r=function(){function a(){}return a.GetTranslateLocked=function(a,b){var c=!1,d=!1;if(0!==a){var e=k(b/a)/h*180;20>e&&(c=!0)}if(0===a)d=!0;else{var e=k(b/a)/h*180;e>75&&105>e&&(d=!0)}return{translateXLocked:c,translateYLocked:d}},a}(),s=function(){function a(){}return a.AreClose=function(b,c){if(!b||!c)return!1;var f=a.TappedMaxOffset,g=a.TappedMaxOffset,h=a.TappedMaxDistance,i=a.TappedMaxDistance,k=b.X-c.X,l=b.Y-c.Y;return d(k)<f&&d(l)<g&&j(k*k+l*l)<e(h,i)},a.TappedMaxOffset=13,a.TappedMaxDistance=15,a.DoubleTappedTimeOffset=400,a.RightTappedTimeOffset=1e3,a.ManipulationDeltaInterval=20,a}(),t=function(){function a(a,b){this.X=a,this.Y=b}return a.Round=function(b){return b?new a(i(b.X),i(b.Y)):new a(-1,-1)},a}(),u=function(){function a(){}return a}(),v=function(){function a(){var a=this;a._count=0,a._start=0,a._maxCount=10,a._history=new Array(a._maxCount)}return a.prototype.GetVelocity=function(a){var b=this;if(0===b._count)return 0;for(var c=(b.Item(b._count-1).timeStamp,0),d=(1+b._count)*b._count/2,e=b._count-1;e>=0;e--){var f=0;0===a?f=b.Item(e).translateX:1===a?f=b.Item(e).translateY:2===a?f=b.Item(e).expansion:3===a&&(f=b.Item(e).rotation);var g=b.GetSingleVelocity(f,b.Item(e).timeStamp);g*=e+1,c+=g}return c/d},a.prototype.GetSingleVelocity=function(a,b){return a/b},a.prototype.Item=function(a){return this._history[this.GetInnerListIndex(a)]},a.prototype.Last=function(){return this._history[this._count-1]},a.prototype.Enqueue=function(a){var b=this;10===b._count&&b.Dequeue(),b._count++,b._history[b.GetInnerListIndex(b._count-1)]=a;for(var c=s.ManipulationDeltaInterval*b._maxCount,d=0;d<b._count;d++)a.timeStamp-b._history[d].timeStamp>c&&(b.Dequeue(),d--)},a.prototype.Dequeue=function(){var a=this;a._start++,a._start===a._maxCount&&(a._start=0),a._count--},a.prototype.Clear=function(){this._count=0},a.prototype.GetInnerListIndex=function(a){return(this._start+a)%this._maxCount},a}(),w=function(){function a(a,b,c,d,e){var f=this;a?f._history=a:(f._linear=new t(b,c),f._angular=d,f._expansion=e)}return a.prototype.Linear=function(){var a=this;return a._linear||(a._linear=new t(a._history.GetVelocity(0),a._history.GetVelocity(1))),a._linear},a.prototype.Angular=function(){var a=this;return(a._angular===b||typeof a._angular===l)&&(a._angular=a._history.GetVelocity(3)),a._angular},a.prototype.Expansion=function(){var a=this;return(a._expansion===b||typeof a._expansion===l)&&(a._expansion=a._history.GetVelocity(2)),a._expansion},a}(),x=function(){function a(a){this._initialVelocity=a,this._decelerationInternal=0}return a.prototype.DecelerationInternal=function(){var a=this;return isNaN(a.DesiredExpansion)||0===a.DesiredExpansion?isNaN(a.DesiredDeceleration)?a._decelerationInternal:a.DesiredDeceleration:.5*a._initialVelocity*a._initialVelocity/a.DesiredExpansion},a.prototype.SetDecelerationInternal=function(a){this._decelerationInternal=a},a}(),y=function(){function a(a){this._initialVelocity=a,this._decelerationInternal=0}return a.prototype.DecelerationInternal=function(){var a=this;return isNaN(a.DesiredRotation)||0===a.DesiredRotation?isNaN(a.DesiredDeceleration)?a._decelerationInternal:a.DesiredDeceleration:.5*a._initialVelocity*a._initialVelocity/a.DesiredRotation},a.prototype.SetDecelerationInternal=function(a){this._decelerationInternal=a},a}(),z=function(){function a(a,b){var c=this;c._initialXVelocity=a,c._initialYVelocity=b,c.XDeceleration=0,c.YDeceleration=0,c._decelerationInternal=0,c._velocity=j(c._initialXVelocity*c._initialXVelocity+c._initialYVelocity*c._initialYVelocity)}return a.prototype.UpdateXYDecelerations=function(){var a=this;isNaN(a.DesiredDisplacement)||0===a.DesiredDisplacement?isNaN(a.DecelerationInternal())||0===a.DecelerationInternal()?(a.XDeceleration=0,a.YDeceleration=0):(a.XDeceleration=a.DecelerationInternal()*d(a._initialXVelocity)/a._velocity,a.YDeceleration=a.DecelerationInternal()*d(a._initialYVelocity)/a._velocity):(a.XDeceleration=.5*a._velocity*d(a._initialXVelocity)/a.DesiredDisplacement,a.YDeceleration=.5*a._velocity*d(a._initialYVelocity)/a.DesiredDisplacement)},a.prototype.SetDesiredDeceleration=function(a){this.DesiredDeceleration=a,this.UpdateXYDecelerations()},a.prototype.SetDesiredDisplacement=function(a){this.DesiredDisplacement=a,this.UpdateXYDecelerations()},a.prototype.DecelerationInternal=function(){return this.IsDefault()?this._decelerationInternal:this.DesiredDeceleration},a.prototype.SetDecelerationInternal=function(a){this._decelerationInternal=a,this.UpdateXYDecelerations()},a.prototype.IsDefault=function(){return isNaN(this.DesiredDeceleration)&&isNaN(this.DesiredDisplacement)},a}(),A=function(){function a(){}return a}(),B=function(){function a(){var a=this;a.Translation=new t(0,0),a.Scale=0,a.Rotation=0,a.Expansion=0}return a}(),C=(function(){function a(a,b){this.Center=a,this.Radius=b}return a}(),function(){function a(a){this.ID=a}return a}()),D=function(){function a(){this._list=new Array}return a.prototype.Contains=function(a){for(var b=0;b<this._list.length;b++){var c=this._list[b];if(c.ID===a)return!0}return!1},a.prototype.Add=function(a){this._list.push(a)},a.prototype.Remove=function(a){for(var b=0;b<this._list.length;b++)if(this._list[b].ID===a){this._list.splice(b,1);break}},a.prototype.Count=function(){return this._list.length},a.prototype.ItemAt=function(a){return this._list[a]},a.prototype.Find=function(a){for(var c=0;c<this._list.length;c++){var d=this._list[c];if(d.ID===a)return d}return b},a.prototype.Clear=function(){this._list.splice(0,this._list.length)},a}(),E=function(){function a(a,b,c){this.Cumulative=a,this.Delta=b,this.Velocities=c}return a}(),F=function(){function a(a){this.OriginalSource=a}return a}(),G=function(a){function b(b,c,d,e,f){a.call(this,b);var g=this;g.Cumulative=c,g.IsInertia=d,g.Position=e,g.Velocities=f}return __extends(b,a),b}(F),H=function(a){function b(b,c,d,e,f,g){a.call(this,b);var h=this;h.Cumulative=c,h.Delta=d,h.IsInertia=e,h.Position=f,h.Velocities=g}return __extends(b,a),b}(F),I=function(a){function b(b,c,d,e,f,g,h){a.call(this,b);var i=this;i.Cumulative=c,i.Delta=d,i.Velocities=e,i.ExpansionBehavior=f,i.RotationBehavior=g,i.TranslationBehavior=h}return __extends(b,a),b}(F),J=function(a){function b(b,c,d,e){a.call(this,b),this.PointerCount=c,this.Cumulative=d,this.Position=e}return __extends(b,a),b}(F),K=function(a){function b(b,c,d,e){a.call(this,b),this.Mode=c,this.Pivot=d,this.Position=e}return __extends(b,a),b}(F),L=function(){function a(a){this.Position=a}return a}(),M=function(){function a(a){this.Position=a}return a}(),N=function(){function a(a){this.Position=a}return a}();!function(a){a[a.All=511]="All",a[a.None=0]="None",a[a.TranslateX=1]="TranslateX",a[a.TranslateY=2]="TranslateY",a[a.TranslateRailsX=4]="TranslateRailsX",a[a.TranslateRailsY=8]="TranslateRailsY",a[a.Rotate=16]="Rotate",a[a.Scale=32]="Scale",a[a.TranslateInertia=64]="TranslateInertia",a[a.RotateInertia=128]="RotateInertia",a[a.ScaleInertia=256]="ScaleInertia"}(o||(o={}));var O;!function(a){a[a.NotStart=0]="NotStart",a[a.Starting=1]="Starting",a[a.Started=2]="Started",a[a.InertiaStarted=3]="InertiaStarted"}(O||(O={}));var P;!function(a){a[a.TranslateX=0]="TranslateX",a[a.TranslateY=1]="TranslateY",a[a.Expansion=2]="Expansion",a[a.Rotation=3]="Rotation"}(P||(P={}));var Q;!function(a){a[a.column=1]="column",a[a.row=2]="row",a[a.range=3]="range"}(Q||(Q={}));var R=function(){function a(){}return a.prototype._getTouchCanvas=function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c},a.prototype.saveCanvas=function(a,b,c){var d=this,e=a.width,f=a.height,g=d._getTouchCanvas(e,f);g.getContext("2d").drawImage(a,0,0,e,f),d._canvas=g,d._oldSheetLayout=b,d._oldZoomFactor=c},a.prototype.restoreCanvas=function(a,b,c,d,e){var f=this,g=a.width,h=a.height,i=f._oldSheetLayout.frozenX,j=f._oldSheetLayout.frozenY,k=g-i,l=h-j,m=b/f._oldZoomFactor,n=a.getContext("2d"),o=f._canvas;n.save(),n.fillStyle=c,n.fillRect(0,0,g,h),n.drawImage(o,i,j,k,l,i,j,k*m,l*m),d&&n.drawImage(o,0,j,i,l,0,j,i*m,l*m),e&&n.drawImage(o,i,0,k,j,i,0,k*m,j*m),d&&e&&n.drawImage(o,0,0,i,j,0,0,i*m,j*m),n.restore()},a}(),S=function(){function b(){this._waittime=-1}return b.prototype._getTouchCanvas=function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c},b.prototype._translatePaint=function(a,b,c,d){b.width>0&&b.height>0&&(a.translate(c,d),this._paint(a,b),a.translate(-c,-d))},b.prototype._paint=function(a,b){var c=this._sheet,d=c._render;!a||c._layoutSuspended>0||(d.paintBody(a,b),this._paintAdornment(a,b))},b.prototype._paintAdornment=function(a,b){var c=this._sheet,d=c._render;if(a&&!(c._layoutSuspended>0)&&!c._hoverCell){for(var e,f=c._getSheetLayout(),g=0;2>=g;g++)for(var h=0;2>=h;h++)e=f.viewportRect(g,h),e&&0!==e.width&&0!==e.height&&(!b||e.intersectRect(b))&&d.paintSelection(a,g,h,b);d.paintResizeLine(a)}},b.prototype._restoreColHeaderFrozenRows=function(a,b,c){var d=0,e=0,f=a.canvas.width,g=c.viewportY;a.drawImage(b,d,e,f,g,d,e,f,g)},b.prototype._restorePartViewportScrollTop=function(b,c,d,e){var f=0,g=d.viewportY,h=g+e,i=b.canvas.width,j=d.viewportHeight-e;return j>0&&b.drawImage(c,f,g,i,j,f,h,i,j),new a.Rect(f,h,i,j)},b.prototype._restorePartViewportScrollBottom=function(b,c,d,e,f){var g=0,h=d.viewportY,i=h+e,j=b.canvas.width,k=d.viewportHeight-e-f;return k>0&&b.drawImage(c,g,i,j,k,g,h,j,k),new a.Rect(g,h,j,k)},b.prototype._restoreTrailingFrozenRows=function(a,b,c,d){var e=0,f=c.frozenTrailingY-d,g=a.canvas.width,h=c.frozenTrailingHeight+d;h>0&&a.drawImage(b,e,f,g,h,e,f,g,h)},b.prototype._restoreRowHeaderFrozenCols=function(a,b,c){var d=0,e=0,f=c.viewportX,g=a.canvas.height;a.drawImage(b,d,e,f,g,d,e,f,g)},b.prototype._restorePartViewportScrollLeft=function(b,c,d,e){var f=d.viewportX,g=f+e,h=0,i=d.viewportWidth-e,j=b.canvas.height;return i>0&&b.drawImage(c,f,h,i,j,g,h,i,j),new a.Rect(g,h,i,j)},b.prototype._restorePartViewportScrollRight=function(b,c,d,e,f){var g=d.viewportX,h=g+e,i=0,j=d.viewportWidth-e-f,k=b.canvas.height;return j>0&&b.drawImage(c,h,i,j,k,g,i,j,k),new a.Rect(g,i,j,k)},b.prototype._restoreTrailingFrozenCols=function(a,b,c,d){var e=c.frozenTrailingX-d,f=0,g=c.frozenTrailingWidth+d,h=a.canvas.height;g>0&&a.drawImage(b,e,f,g,h,e,f,g,h)},b.prototype.saveTopRowLeftCol=function(a){var b=this;b._lastTime=0,b._sheet=a,b.oldTopRow=a._scrollTopRow,b.oldLeftColumn=a._scrollLeftCol},b.prototype.saveCanvas=function(a){var b=a.width,c=a.height,d=this._getTouchCanvas(b,c);d.getContext("2d").drawImage(a,0,0,b,c),this._canvas=d},b.prototype.saveCanvasWithInertia=function(a){var b=a.width,c=a.height,d=this._getTouchCanvas(b,c);d.getContext("2d").drawImage(a,0,0,b,c),this._canvasWithInertia=d},b.prototype.restoreCanvas=function(b,c,e,f,g,h){var i=this,j=(new Date).valueOf();if(!(j-i._lastTime<i._waittime)&&(i._lastTime=j,i._canvas&&i._sheet)){var k,l,m,n,o,p,q=i._sheet,r=i._canvas,s=q._getSheetLayout(),t=b.width,u=b.height,v=q.getFrozenTrailingColumnCount()>0?1:0,w=q.getFrozenTrailingRowCount()>0?1:0;if(0!==c||0!==e){var x=b.getContext("2d");if(x.save(),x.fillStyle=h,x.fillRect(0,0,t,u),d(c)>d(e)?(l=0,n=u,c>0?(i._restorePartViewportScrollLeft(x,r,s,c),o=c-f,s.viewportWidth<=c&&(o=0),m=f,k=s.viewportX,q.invalidateLayout(),i._translatePaint(x,new a.Rect(k,l,m,n),o,0)):0>c&&(i._restorePartViewportScrollRight(x,r,s,d(c),v),o=c-f,s.viewportWidth<=d(c)&&(o=0),q.invalidateLayout(),m=d(f),k=s.frozenTrailingX-m-v,i._translatePaint(x,new a.Rect(k,l,m,n),o,0)),i._restoreRowHeaderFrozenCols(x,r,s),i._restoreTrailingFrozenCols(x,r,s,v)):(k=0,m=t,e>0?(i._restorePartViewportScrollTop(x,r,s,e),p=e-g,s.viewportHeight<=e&&(p=0),n=g,l=s.viewportY,q.invalidateLayout(),i._translatePaint(x,new a.Rect(k,l,m,n),0,p)):0>e&&(i._restorePartViewportScrollBottom(x,r,s,d(e),w),p=e-g,s.viewportHeight<=d(e)&&(p=0),q.invalidateLayout(),n=d(g),l=s.frozenTrailingY-n-w,i._translatePaint(x,new a.Rect(k,l,m,n),0,p)),i._restoreColHeaderFrozenRows(x,r,s),i._restoreTrailingFrozenRows(x,r,s,w)),x.restore(),i.saveCanvasWithInertia(b),i._waittime<0){var y=(new Date).valueOf()-j;i._waittime=20>y?0:60}}}},b.prototype.restoreCanvasWithInertia=function(b,c,e,f,g,h,i,j){var k=this;if(k._canvasWithInertia&&k._sheet){var l,m,n,o,p,q,r=k._sheet,s=k._canvasWithInertia,t=r._getSheetLayout(),u=b.width,v=b.height,w=r.getFrozenTrailingColumnCount()>0?1:0,x=r.getFrozenTrailingRowCount()>0?1:0;if(0!==c&&0!==h||0!==e&&0!==i){var y=b.getContext("2d");if(y.save(),y.fillStyle=j,y.fillRect(0,0,u,v),d(c)>d(e)){if(m=0,o=v,c>0){var z=k._restorePartViewportScrollLeft(y,s,t,h);p=c-f,n=f,l=t.viewportX,r.invalidateLayout();var A=z.x-p;l+n>A&&(n=A-l+w),k._translatePaint(y,new a.Rect(l,m,n,o),p,0)}else if(0>c){var z=k._restorePartViewportScrollRight(y,s,t,d(h),w);p=c-f,r.invalidateLayout(),n=d(f),l=t.frozenTrailingX-n-w;var B=z.x+z.width-p,C=r._getScrollableColumn(r.getColumnCount(),!0),D=r._getViewportColumnLayout(1).findCol(C);if(D){var E=D.x+D.width-p;B>E&&(B=E)}B>l&&(n=t.frozenTrailingX-B,l=B-w),k._translatePaint(y,new a.Rect(l,m,n,o),p,0)}k._restoreRowHeaderFrozenCols(y,s,t),k._restoreTrailingFrozenCols(y,s,t,w)}else{if(l=0,n=u,e>0){var z=k._restorePartViewportScrollTop(y,s,t,i);q=e-g,o=g,m=t.viewportY,r.invalidateLayout();var F=z.y-q;m+o>F&&(o=F-m+x),k._translatePaint(y,new a.Rect(l,m,n,o),0,q)}else if(0>e){var z=k._restorePartViewportScrollBottom(y,s,t,d(i),x);q=e-g,r.invalidateLayout(),o=d(g),m=t.frozenTrailingY-o-x;var G=z.y+z.height-q,H=r._getScrollableRow(r.getRowCount(),!0),I=r._getViewportRowLayout(1).findRow(H);if(I){var J=I.y+I.height-q;G>J&&(G=J)}G>m&&(o=t.frozenTrailingY-G,m=G-x),k._translatePaint(y,new a.Rect(l,m,n,o),0,q)}k._restoreColHeaderFrozenRows(y,s,t),k._restoreTrailingFrozenRows(y,s,t,x)}y.restore(),k.saveCanvasWithInertia(b)}}},b}(),T=function(){function e(a){this._touchZoomManager=new R,this._touchScrollManager=new S,this.sheet=a}return e.prototype.doManipulationStarting=function(a){var b=this._touchHitTest(a.Position.X,a.Position.Y);a.Mode=b&&(b.resizeInfo||b.dragInfo&&"corner"===b.dragInfo.side||b.selectionHitInfo)?3:367},e.prototype.doManipulationStarted=function(a){var c=this;c._scrollInterval&&(clearInterval(c._scrollInterval),c._scrollInterval=b);var d=c.sheet,e=d._eventHandler,f=d._render,g=c._touchHitTest(a.Position.X,a.Position.Y);if(d._currentTarget=g,g.resizeInfo)e.startResizing(g);else if(g.dragInfo&&"corner"===g.dragInfo.side)e.startDragFill(g);else if(g.selectionHitInfo){var h=g.selectionHitInfo,i=h.isHeader,j=h.isFirstIndicator,k=h.type;i&&e._startSelectingCore(g,!0);var l=g.hitTestType;g.hitTestType=g.selectionHitInfo.type,e._startSelectingScroll(g),g.hitTestType=l,c._changeActiveCellBeforeSelect(i,j,k),f._showTouchSelectionIndicator=!1,f.refreshTouchSelectionIndicator()}else{var m=d._getSheetLayout(),n=f._getCtx();if(n){if(!d.endEdit())return;f._showTouchSelectionIndicator=!1,f.refreshTouchSelectionIndicator(),c._touchZoomManager.saveCanvas(n.canvas,m,d._zoomFactor),c._oldZoomFactor=d._zoomFactor;var o=c._touchScrollManager;o.saveTopRowLeftCol(d),o.saveCanvas(n.canvas),o.saveCanvasWithInertia(n.canvas)}}},e.prototype.doManipulationDelta=function(c,e){var f=this,g=f.sheet,h=g._render,j=g._eventHandler,k=c.Position.X,l=c.Position.Y;if(g._currentTarget){var m=g._currentTarget;if(m.resizeInfo)j.mousePosition={e:c,x:k,y:l},j.continueResizing();else if(m.dragInfo&&"corner"===m.dragInfo.side)j.mousePosition={e:c,x:k,y:l},j.continueDragFill();else if(m.selectionHitInfo||j.isSelecting){var n=m.selectionHitInfo;if(n){if(!j.startHitInfo||!j.isWorking)return;if(j._forceCancelSelectiong===!0)return;var o=n.type;j.mousePosition={e:c,x:k,y:l},3===o?j.continueCellSelecting():2===o?j.continueRowSelecting():1===o&&j.continueColumnSelecting()}}else{var p=h._getCtx(),q=c.Cumulative.Scale,r=h._getGrayAreaBackColor(!1),s=g.getRowHeaderVisible(),t=g.getColumnHeaderVisible();if(1!==q&&g.parent&&g.parent._allowUserZoom){var u=f._getNewZoomFactor(q,g._zoomFactor);p&&f._touchZoomManager.restoreCanvas(p.canvas,u,r,s,t),f._oldZoomFactor!==u&&(g._trigger(a.Events.UserZooming,{sheet:g,sheetName:g._name,oldZoomFactor:f._oldZoomFactor,newZoomFactor:u}),f._oldZoomFactor=u,h._paintFloatingObject(b,u))}else{var v,w,x,y,z,A,B,C,D=c.Cumulative.Translation.Y,E=c.Cumulative.Translation.X,F=c.Delta.Translation.Y,G=c.Delta.Translation.X,H=f._touchScrollManager,I=g.defaults.colWidth,J=g.defaults.rowHeight;if(d(E)>d(D)){if(x=f._getNewLeftColumnInfo(E,H.oldLeftColumn),g._scrollLeftCol=x.col,g._syncHScollbarPosition(),v=x.width,z=g._getScrollableColumn(-1),A=g._getScrollableColumn(g.getColumnCount(),!0),E>0&&H.oldLeftColumn===z&&g._scrollLeftCol===z?v=0:0>E&&H.oldLeftColumn===A&&g._scrollLeftCol===A&&(v=0),E>0&&E>v+I){if(E=v+I,G=0,f._reachMaxTranslationX&&c.IsInertia)return void(c.IsComplete=!0);f._reachMaxTranslationX=!0}else if(0>E&&v-I>E){if(E=v-I,G=0,f._reachMaxTranslationX&&c.IsInertia)return void(c.IsComplete=!0);f._reachMaxTranslationX=!0}else f._reachMaxTranslationX=!1;D=0,F=0,E=i(E),G=i(G),e||(f._xOffset=v-E,f._yOffset=0,f._lastDeltaEventArgs=c)}else{if(y=f._getNewTopRowInfo(D,H.oldTopRow),g._scrollTopRow=y.row,g._syncVScrollbarPosition(),w=y.height,B=g._getScrollableRow(-1),C=g._getScrollableRow(g.getRowCount(),!0),D>0&&H.oldTopRow===B&&g._scrollTopRow===B?w=0:0>D&&H.oldTopRow===C&&g._scrollTopRow===C&&(w=0),D>0&&D>w+J){if(D=w+J,F=0,f._reachMaxTranslationY&&c.IsInertia)return void(c.IsComplete=!0);f._reachMaxTranslationY=!0}else if(0>D&&w-J>D){if(D=w-J,F=0,f._reachMaxTranslationY&&c.IsInertia)return void(c.IsComplete=!0);f._reachMaxTranslationY=!0}else f._reachMaxTranslationY=!1;E=0,G=0,D=i(D),F=i(F),e||(f._xOffset=0,f._yOffset=w-D,f._lastDeltaEventArgs=c)}p&&(c.IsInertia?H.restoreCanvasWithInertia(p.canvas,E,D,v,w,G,F,r):H.restoreCanvas(p.canvas,E,D,v,w,r))}}}},e.prototype.doManipulationInertiaStarting=function(){},e.prototype.doManipulationCompleted=function(a){var c=this,d=c.sheet,e=d._eventHandler,f=d._render;f._showTouchSelectionIndicator=!0;var g=d._currentTarget;if(g.resizeInfo)e.stopResizing();else if(g.dragInfo&&e.isDraggingFill)e.endDragFill(),d.parent.touchToolStrip._closeAutoFillIndicator();else if(g.selectionHitInfo||e.isSelecting){e.stopSelecting();var h=g.selectionHitInfo;if(h){var i=h.isHeader,j=h.isFirstIndicator,k=h.type;c._changeActiveCellAfterSelect(i,j,k)}f.repaintSelection()}else{var l=a.Cumulative.Scale;if(1!==l&&d.parent&&d.parent._allowUserZoom)d._zoomFactor=c._getNewZoomFactor(l,d._zoomFactor),d.invalidateLayout(),d.repaint();else{var m=c._xOffset,n=c._yOffset,o=c._lastDeltaEventArgs;if(o){var p=160,q=20,r=p/q+1;c._scrollInterval=setInterval(function(){if(c._scrollInterval&&0>=p)return d.invalidateLayout(),d.repaint(),d._syncHScollbarPosition(),d._syncVScrollbarPosition(),clearInterval(c._scrollInterval),void(c._scrollInterval=b);var a=o.Cumulative.Translation,e=o.Delta.Translation,f=n/r,g=m/r;a.Y+=f,e.Y=f,a.X+=g,e.X=g,c.doManipulationDelta(o,!0),p-=q},q)}}}},e.prototype.doTapped=function(c){var d=this,e=d.sheet,f=!1;d._clearTouchToolStripTimeout(),"function"==typeof e.unSelectAllFloatingObjects&&e.unSelectAllFloatingObjects();var g=e._commentManager;g&&g.deactivateComment();var h=e._eventHandler,i=d._touchHitTest(c.Position.X,c.Position.Y,!0),j=i.row,k=i.col,l=i.groupHitInfo;if(l)e.isEditing()||h._doClickRangeGroup(l);else if(e._currentTarget=i,i.filterButtonHitInfo){if(!e.endEdit())return;h._openFilterDialog(i.filterButtonHitInfo)}else if(i.resizeInfo);else{var n=e._render;n._existTouchDragFillIndicator&&!h.isDraggingFill&&e.parent.touchToolStrip._closeAutoFillIndicator();var o=e.getActiveRowIndex(),p=e.getActiveColumnIndex();if(i.cellTypeHitInfo){if(j!==o||k!==p){var q=e.isPaintSuspended();if(e.isPaintSuspended(!0),!e.endEdit())return;var r={sheet:e,sheetName:e._name,row:o,col:p,cancel:!1};if(e._trigger(a.Events.LeaveCell,r),r&&r.cancel===!0)return;var t=e._selectionModel.toArray(),u=b,v=e._spanModel.find(j,k);u=v?[new a.Range(v.row,v.col,v.rowCount,v.colCount)]:[new a.Range(j,k,1,1)],e._trigger(a.Events.SelectionChanging,{sheet:e,sheetName:e._name,oldSelections:t,newSelections:u});var w=i.cellTypeHitInfo.isReservedLocation&&i.cellTypeHitInfo.isFocusAware;e._setActiveCellAndSelection(j,k,void 0,void 0,w),e._trigger(a.Events.EnterCell,{sheet:e,sheetName:e._name,row:j,col:k}),e._trigger(a.Events.SelectionChanged,{sheet:e,sheetName:e._name}),h._updateValidationUI(j,k),e.isPaintSuspended(q),f=!0}else n.refreshTouchSelectionIndicator();var x=e.getCellType(j,k,i.hitTestType);i.cellTypeHitInfo.sheet||(i.cellTypeHitInfo.sheet=e),x.processMouseDown(i.cellTypeHitInfo),x.processMouseUp(i.cellTypeHitInfo)}if(i.cellTypeHitInfo&&i.cellTypeHitInfo.isReservedLocation)return!0;e._trigger(a.Events.CellClick,{sheet:e,sheetName:e._name,sheetArea:i.hitTestType,row:i.row,col:i.col});try{if(h._hitTestResult=i,e.isEditing()&&o===e.getActiveRowIndex()&&p===e.getActiveColumnIndex()&&!e.endEdit())return}finally{h._hitTestResult=b}if(3===i.hitTestType&&h._updateValidationUI(j,k),d._isTouchSelected(j,k,i.hitTestType)&&!f)d._touchToolStripTimeout=setTimeout(function(){var b={x:i.x,y:i.y,handled:!1},c=e.parent.touchToolStrip;e._trigger(a.Events.TouchToolStripOpening,b),b.handled||c.open(i.x,i.y-m),d._clearTouchToolStripTimeout()},s.DoubleTappedTimeOffset+20);else{var y=e._selectionModel.toArray();h._startSelectingCore(i);var z=e._selectionModel.toArray();h._notEqualSelecions(y,z)&&e._trigger(a.Events.SelectionChanging,{sheet:e,sheetName:e._name,oldSelections:y,newSelections:z}),h.stopSelecting()}}},e.prototype.doDoubleTapped=function(b){var c=this.sheet;this._clearTouchToolStripTimeout();var d,e,f,g=c._currentTarget;if(g){c._trigger(a.Events.CellDoubleClick,{sheet:c,sheetName:c._name,sheetArea:g.hitTestType,row:g.row,col:g.col});var h=g.resizeInfo;if(h){if("sizeRow"===h.action){var i=[];if(c._isRowSelected(h.index)){for(d=0;d<c._selectionModel.length;d++)if(e=c._selectionModel[d],-1===e.col){e=c._getActualRange(e);for(var j=0;j<e.rowCount;j++)i.push({row:e.row+j})}}else i.push({row:h.index});f=new a.UndoRedo.RowAutoFitUndoAction(c,i,1===h.sheetArea),c._doCommand(f)}else{var k=[];if(c._isColumnSelected(h.index)){for(d=0;d<c._selectionModel.length;d++)if(e=c._selectionModel[d],-1===e.row){e=c._getActualRange(e);for(var l=0;l<e.colCount;l++)k.push({col:e.col+l})}}else k.push({col:h.index});f=new a.UndoRedo.ColumnAutoFitUndoAction(c,k,2===h.sheetArea),c._doCommand(f)}return}}var m=this._touchHitTest(b.Position.X,b.Position.Y,!0);m&&m.row>=0&&m.col>=0&&m.rowViewportIndex>=0&&m.colViewportIndex>=0&&!m.resizeInfo&&(c._clearSelectionImp(),c.addSelection(m.row,m.col,1,1),c._eventHandler.resumeFocus(!1),c._startEditImp(c._getCanvas(),m.row,m.col))},e.prototype.doRightTapped=function(){},e.prototype.doTouchOperatorStart=function(a){var b=this.sheet,c=this._touchHitTest(a.Position.X,a.Position.Y);if(b.isEditing())(c.row!==b._activeRowIndex||c.col!==b._activeColIndex)&&b._eventHandler.releaseFocus(c);else{this._target=c;var d=this._touchHitTest(a.Position.X,a.Position.Y,!0);d&&d.cellTypeHitInfo&&d.cellTypeHitInfo.isEditting||b._eventHandler.releaseFocus(d)}},e.prototype.doTouchOperatorEnd=function(){var a=this.sheet;if(!a.isEditing()){var b=this._target,c=!0;if(b)if(b.cellTypeHitInfo&&b.cellTypeHitInfo.isReservedLocation)c=!1;else{var d=a.getCellType(b.row,b.col);d&&d.isEditting()&&(c=!1)}c&&a._eventHandler.resumeFocus()}},e.prototype._touchHitTest=function(a,d,e){var f=this,g=f.sheet,h=g._render;g._getSheetLayout();var i,j,k={x:a,y:d,rowViewportIndex:b,colViewportIndex:b,row:-1,col:-1,resizeInfo:b,hitTestType:b,groupHitInfo:b,filterButtonHitInfo:b,dragInfo:b,cellTypeHitInfo:b,selectionHitInfo:b},l=h.groupHitTest(a,d);if(l)k.groupHitInfo=l;else{if(i=g._getRowViewportIndexFromY(d),j=g._getColumnViewportIndexFromX(a),k.rowViewportIndex=i,k.colViewportIndex=j,k.row=g._getRowIndexFromY(d,i),k.col=g._getColumnIndexFromX(a,j),i>=0&&2>=i&&j>=0){var m=g._getCellLayoutByCell(i,j,c,k.row,k.col);m&&(k.row=m.row,k.col=m.col)}k.hitTestType=g._getSheetArea(i,j);var n,o,p,q;(n=f._getTouchResizeInfo(k,a,d,10))?k.resizeInfo=n:h._existTouchDragFillIndicator&&(o=f._getDragFillInfo(k,a,d))?k.dragInfo=o:(p=g._getFilterButtonHitInfo(k,a,d))?k.filterButtonHitInfo=p:!e&&(q=f._getSelectionHitInfo(k,a,d))?k.selectionHitInfo=q:k.cellTypeHitInfo=g._getCellTypeHitInfo(k,a,d)}return k},e.prototype._getTouchResizeInfo=function(a,c,d,e){var f=this.sheet,g=f._eventHandler,h=f.getSelections(),i=b;if(f._isTouchMode&&h.length>0){var j=h[h.length-1],k=j.row,l=j.row+j.rowCount-1,m=j.col,n=j.col+j.colCount-1;(!f.parent||f.parent._allowUserResize)&&(-1!==k&&-1===m&&a.rowViewportIndex>=0&&a.colViewportIndex<0&&f.rowHeaderVisible?(i=g._getResizeRowInfo(f,a,e,2,d),i&&"sizeRow"===i.action&&2===i.sheetArea&&i.index!==l&&(i=b)):-1===k&&-1!==m&&a.rowViewportIndex<0&&a.colViewportIndex>=0&&f.colHeaderVisible&&(i=g._getResizeColInfo(f,a,e,1,c),i&&"sizeCol"===i.action&&1===i.sheetArea&&i.index!==n&&(i=b)))}return i},e.prototype._getSelectionHitInfo=function(a,c,d){var e=this.sheet,f=e._render.getSelectionIndicatorRects(),g=e.getSelections(),h=3;if(e._isTouchMode&&g.length>0){var i=g[g.length-1];-1!==i.row&&-1!==i.col?h=3:-1!==i.row?h=2:-1!==i.col&&(h=1)}for(var j=0;j<f.length;j++){var k=f[j];if(k.x-=k.width,k.y-=k.height,k.width*=3,k.height*=3,k.contains(c,d))return{x:c,y:d,type:h,isHeader:!1,isFirstIndicator:0===j}}return 1===a.hitTestType?{x:c,y:d,type:1,isHeader:!0}:2===a.hitTestType?{x:c,y:d,type:2,isHeader:!0}:b},e.prototype._getDragFillInfo=function(a,c,d){var e=b,f=a.rowViewportIndex,g=a.colViewportIndex;if(typeof f===l||f===b||typeof g===l||g===b)return e;var h=this.sheet,i=h._getActiveSelectedRange();if(f>=0&&g>=0&&1===h._selectionModel.length){var j=h._getActualRange(i),k=h._frozenTrailingColCount,m=h._frozenTrailingRowCount,n=h.getColumnCount()-k,o=h.getRowCount()-m;if(1===g&&k>0&&j.col<n&&j.col+j.colCount>n){var p=h._getColumnLayout(g);if(p&&p.length>0){var q=p[p.length-1];if(c>q.x+q.width)return e}}if(1===f&&m>0&&j.row<o&&j.row+j.rowCount>o){var r=h._getRowLayout(f);if(r&&r.length>0){var s=r[r.length-1];if(d>s.y+s.height)return e}}}var t=h._render.getTouchDragFillIndicatorRect();return t&&(e||(t.x-=t.width,t.y-=t.height,t.width*=3,t.height*=3,t.contains(c,d)&&(e={action:"drag",side:"corner"})),h.canUserDragFill()||e&&"corner"===e.side&&(e.side=b)),e},e.prototype._getNewZoomFactor=function(a,b){var c=a*b;return c>4?c=4:.5>c&&(c=.5),c},e.prototype._getNewTopRowInfo=function(a,b){var c=this.sheet,d=c._getScrollableRow(-1),e=c._getScrollableRow(c.getRowCount(),!0),f=b,g=0;if(a>0){for(;f>=d&&!(g>=a);)g+=c._getZoomRowHeight(f),f--;d>f&&(f=d)}else if(0>a){for(;e>=f&&!(a>=g);)g-=c._getZoomRowHeight(f),f++;f>e&&(f=e)}return{row:f,height:g}},e.prototype._getNewLeftColumnInfo=function(a,b){var c=this.sheet,d=c._getScrollableColumn(-1),e=c._getScrollableColumn(c.getColumnCount(),!0),f=b,g=0;if(a>0){for(;f>=d&&!(g>=a);)g+=c._getZoomColumnWidth(f),f--;d>f&&(f=d)}else if(0>a){for(;e>=f&&!(a>=g);)g-=c._getZoomColumnWidth(f),f++;
f>e&&(f=e)}return{col:f,width:g}},e.prototype._clearTouchToolStripTimeout=function(){this._touchToolStripTimeout&&(clearTimeout(this._touchToolStripTimeout),this._touchToolStripTimeout=b)},e.prototype._isTouchSelected=function(a,d,e){for(var f=!1,g=this.sheet,h=g._selectionModel,i=0,j=h.length;j>i;i++){var k=h[i];if(3===e||typeof e===c||e===b)k=g._getActualRange(k),f=k.row<=a&&a<k.row+k.rowCount&&k.col<=d&&d<k.col+k.colCount;else if(2===e)f=-1===k.col&&k.row<=a&&a<k.row+k.rowCount;else if(1===e)f=-1===k.row&&k.col<=d&&d<k.col+k.colCount;else if(0===e)return f;if(f)return f}return f},e.prototype._changeActiveCellBeforeSelect=function(a,b,c){if(!a){var d=this.sheet,e=d.getSelections(),f=e[e.length-1];b?3===c?(d._activeRowIndex=f.row+f.rowCount-1,d._activeColIndex=f.col+f.colCount-1):2===c?(d._activeRowIndex=f.row+f.rowCount-1,d._activeColIndex=0):1===c&&(d._activeRowIndex=0,d._activeColIndex=f.col+f.colCount-1):3===c?(d._activeRowIndex=f.row,d._activeColIndex=f.col):2===c?(d._activeRowIndex=f.row,d._activeColIndex=0):1===c&&(d._activeRowIndex=0,d._activeColIndex=f.col)}},e.prototype._changeActiveCellAfterSelect=function(a,b,c){var d=this.sheet,e=d.getSelections(),f=e[e.length-1];(a||b)&&(3===c?(d._activeRowIndex=f.row,d._activeColIndex=f.col):2===c?(d._activeRowIndex=f.row,d._activeColIndex=0):1===c&&(d._activeRowIndex=0,d._activeColIndex=f.col))},e}(),U=function(){function a(a,b,c){var d=this;d._touchEventProvider=c,d._touchMouseMessageFilter=new Z(b),d._touchEventHandler=new T(b),d._touchTarget=new eb(a,"sheet",d._touchMouseMessageFilter,100,100),d._touchTarget.level=10,d._touchEventProvider.attachDettach(d._touchTarget,!0)}return a.prototype.attach=function(){var a=(this._touchEventProvider,this._touchEventHandler),b=this._touchTarget;b.manipulationStarting=function(b){return a.doManipulationStarting(b)},b.manipulationStarted=function(b){return a.doManipulationStarted(b)},b.manipulationDelta=function(b){return a.doManipulationDelta(b)},b.manipulationInertiaStarting=function(b){return a.doManipulationInertiaStarting(b)},b.manipulationCompleted=function(b){return a.doManipulationCompleted(b)},b.tapped=function(b){return a.doTapped(b)},b.doubleTapped=function(b){return a.doDoubleTapped(b)},b.rightTapped=function(b){return a.doRightTapped(b)},b.touchOperatorStart=function(b){return a.doTouchOperatorStart(b)},b.touchOperatorEnd=function(b){return a.doTouchOperatorEnd(b)}},a.prototype.detach=function(){this._touchEventProvider.attachDettach(this._touchTarget,!1)},a.prototype.preProcessMouseDown=function(a){return this._touchMouseMessageFilter.preProcessMouseDown(a)},a.prototype.preProcessMouseUp=function(a){return this._touchMouseMessageFilter.preProcessMouseUp(a)},a.prototype.preProcessMouseMove=function(a){return this._touchMouseMessageFilter.preProcessMouseMove(a)},a}();a.TouchManager=U;var V;!function(a){a[a.paste=0]="paste",a[a.cut=1]="cut",a[a.copy=2]="copy",a[a.autoFill=3]="autoFill"}(V||(V={}));var W=function(d){function e(a){d.call(this);var b=this;b._useWijmoTheme=!1,b._touchEventNamespace=".touchToolStrip",b._domButton="button",b._buttonClass="toolstrip-button",b._buttonStyleClass="toolstrip-button-style",b._textClass="toolstrip-text",b._imageClass="wijspread-toolstrip-image",b._itemClass="toolstrip-item",b._domSpan="span",b._seprateLineClass="touch-sperate-line",b._defaultSeprateLineColor="#CCC",b._domDiv="div",b._imageAreaHeight=32,b._separatorHeight=45,b._itemMinWidth=60,b.menuItems={},b.pasteName="wijspread_toolstrip_paste",b.copyName="wijspread_toolstrip_copy",b.cutName="wijspread_toolstrip_cut",b.autoFillName="wijspread_toolstrip_autofill",b._isOpen=!1,b.spreadHost=a,b._initDialog()}return __extends(e,d),e.prototype.open=function(a,c){var d=this,e=d.spreadHost.getActiveSheet();if(e){window.gcGlobal.activeElement=b;var f=$(e._getCanvas()).offset();if(a+=f.left,c+=f.top,d._toolStripDialog.css({left:a,top:c}),d.show(),d._isOpen=!0,d.resetDialogPosition(),!d._isEmpty(d.menuItems)){var g=d.menuItems;for(var h in g){var i=g[h],j=i.canExecute?i.canExecute.call(d):!0;j?$("#"+h).show():$("#"+h).hide()}}}},e.prototype.add=function(a){if(a){var b=this,c=b.menuItems;if(a instanceof Y){var d=a.name();if(d){c[d]=a;var e=b._getMenuItemString(a,d);e&&b._addDom(e)}}else if(a instanceof X){var f=a.name();if(!b.getItem(f)){c[f]=a;var e=b._getMenuItemString(a);e&&b._addDom(e)}}}},e.prototype.getItem=function(a){return this.menuItems[a]},e.prototype.getItems=function(){var a=this,c=[];if(!a._isEmpty(a.menuItems)){for(var d in a.menuItems)c.push(a.menuItems[d]);return c}return b},e.prototype.remove=function(a){if(this.getItem(a)){$("#"+a).parent().remove();var c=this.menuItems[a];return delete this.menuItems[a],c}return b},e.prototype.clear=function(){this._toolStripDialog&&(this._toolStripDialog.find("td."+this._itemClass).remove(),this.menuItems={})},e.prototype.close=function(){var a=this;window.gcGlobal.resumeEvent(),a._toolStripDialog&&a._toolStripDialog.hide(),a._isOpen=!1,a.closeOverlay();var b=a.spreadHost.getActiveSheet();if(b){var c=b._render;b.setFocus();var d=b.getSelections();c&&!c._existTouchDragFillIndicator&&-1===d[0].row&&-1===d[0].col&&b._clearSelectionImp()}},e.prototype.imageAreaHeight=function(a){var b=this;if(0===arguments.length)return b._imageAreaHeight;if(!(0>=a))return b._imageAreaHeight=a,b._toolStripDialog.find("span."+b._imageClass).css("height",a+"px"),b},e.prototype.itemHeight=function(a){var b=this._toolStripDialog.find("button."+this._buttonClass);if(0===arguments.length)return parseFloat(b.css("height"));if(!(0>=a))return b.css("height",a+"px"),this},e.prototype.itemWidth=function(a){var b=this._toolStripDialog.find("button."+this._buttonClass);if(0===arguments.length)return parseFloat(b.css("width"));if(!(0>a)){var c=parseFloat(b.css("min-width"));return c>a&&b.css("min-width",a),b.css("width",a+"px"),this}},e.prototype.separatorHeight=function(a){var b=this;if(0===arguments.length)return b._separatorHeight;if(!(0>=a))return b._separatorHeight=a,b._toolStripDialog.find("div."+b._seprateLineClass).css("height",a+"px"),b},e.prototype.useWijmoTheme=function(a){var c=this;if("undfined"==typeof a)return c._useWijmoTheme;if("boolean"==typeof a&&c._useWijmoTheme!==a){d.prototype.useWijmoTheme.call(this,a);var e=c._toolStripDialog,f=e.find("span."+c._textClass),g=e.find("button."+c._buttonClass),h=e.find("div."+c._seprateLineClass),i="ui-state-default",j="toolstrip-default",k="ui-state-default ui-widget",l=c._buttonStyleClass;return e.removeClass(a?j:i),e.addClass(a?i:j),g.addClass(a?k:l),g.removeClass(a?l:k),h.css("background-color",a?f.css("color"):c._defaultSeprateLineColor),c}return b},e.prototype.repaint=function(){this.useWijmoTheme(this.spreadHost.useWijmoTheme)},e.prototype._createLayoutTable=function(){var a=$("<table>").css({padding:0,display:"table"}).attr({cellspacing:0,cellpadding:0});this._tableRow=$("<tr>").appendTo(a),a.appendTo(this._toolStripDialog)},e.prototype._dispose=function(){var a=this,c=a._toolStripDialog;c&&(a._isOpen&&window.gcGlobal.resumeEvent(),c.remove(),a.closeOverlay(),c=b)},e.prototype._isEmpty=function(a){return a&&"{}"!==JSON.stringify(a)?!1:!0},e.prototype._initDialog=function(){var a=this;a._toolStripDialog||((a._toolStripDialog=a.getContainer()).addClass("toolstrip-default").appendTo(document.body).hide(),a._createLayoutTable(),a._setDefaultCellDomString(),a._attachEvent())},e.prototype._attachEvent=function(){var a=this;this._toolStripDialog.bind("click",function(b){var c,d=b.target,e=$(d).get(0).tagName.toLowerCase();c="button"===e?$(d).attr("id"):$(d).parents("button").attr("id");var f=a.menuItems[c];c&&f&&f.command.call(a)})},e.prototype._addDom=function(a){var b=this.spreadHost.getActiveSheet();b&&this._toolStripDialog&&a&&$("<td>").append($(a)).appendTo(this._tableRow).addClass(this._itemClass)},e.prototype._setDefaultCellDomString=function(){var b=this,c=e._getImageSrc(0),d=e._getImageSrc(1),f=e._getImageSrc(2),g=e._getImageSrc(3);b._pasteItem=new X(b._getItemName(b.pasteName),a.SR.ToolStrip_PasteText,c,b._doTapPaste),b._cutItem=new X(b._getItemName(b.cutName),a.SR.ToolStrip_CutText,d,b._doTapCut),b._copyItem=new X(b._getItemName(b.copyName),a.SR.ToolStrip_CopyText,f,b._doTapCopy),b._autoFillItem=new X(b._getItemName(b.autoFillName),a.SR.ToolStrip_AutoFillText,g,b._showAutoFillIndicator,b._hideAutoFill),b.add(b._pasteItem),b.add(b._cutItem),b.add(b._copyItem),b.add(new Y(b._hideAutoFill)),b.add(b._autoFillItem)},e.prototype._hideAutoFill=function(){var a=this.spreadHost.getActiveSheet();if(!a)return!1;for(var b=a.getSelections(),c=0;c<b.length;c++){var d=b[c];if(-1===d.row&&-1===d.col)return!1}return!0},e.prototype._showAutoFillIndicator=function(){this.close();var a=this.spreadHost.getActiveSheet();if(a){var b=a.getSelections().length;if(!(b>1)){var c=a._render;c._existTouchDragFillIndicator=!0,c.repaintSelection()}}},e.prototype._closeAutoFillIndicator=function(){var a=this.spreadHost.getActiveSheet();if(a){var b=a._render;b._existTouchDragFillIndicator=!1,b.repaintSelection()}},e.prototype._doTapCopy=function(){var a=this.spreadHost.getActiveSheet();a&&(this._clipboardTouchData=a._doCopy(!0)),this.close()},e.prototype._doTapCut=function(){var a=this.spreadHost.getActiveSheet();a&&(this._clipboardTouchData=a._doCut(!0)),this.close()},e.prototype._doTapPaste=function(){var a=this,b=a.spreadHost.getActiveSheet();b&&typeof a._clipboardTouchData!==l&&b._doPaste(a._clipboardTouchData),a.close()},e.prototype._getMenuItemString=function(a,c){var d=this,e="",f="",g="";if(a.name&&(c=a.name()),a.image&&(e=d._getDomElementString(d._domSpan,c+"Image",b,{"class":d._imageClass,style:'background-image: url("'+a.image()+'");background-repeat: no-repeat;display: block;height:'+d._imageAreaHeight+"px;background-position-x:50%"})),a._font&&(g+="font:"+a._font+";"),a.text&&c&&(f=d._getDomElementString(d._domSpan,c+"Text",a.text(),{"class":d._textClass,style:g})),e&&c){var h;h=d._useWijmoTheme?"ui-state-default ui-widget":d._buttonStyleClass;var i=d._getDomElementString(d._domButton,c,e+f,{"class":d._buttonClass+" "+h,style:"border: 0px;padding:4px;margin:3px;min-width:"+d._itemMinWidth+"px;"});return i}return a instanceof Y?d._getDomElementString(d._domDiv,c,b,{"class":d._seprateLineClass,style:"width:1px;height:"+d._separatorHeight+"px;display:inline-block;background-color:"+d._defaultSeprateLineColor+";margin-left:5px;margin-right:5px;opacity:0.6"}):void 0},e.prototype._getDomElementString=function(a,b,d,e,f){var g="<"+a+" ";return b&&(g+="id='"+b+"' "),e&&$.each(e,function(a,b){g+=a+"='"+b+"' "}),g+=d?">"+d+"</"+a+">":f===c?"></"+a+">":f===!0?">":"/>"},e.prototype._getItemName=function(a){for(var b=0,c=a+b;document.getElementById(c);)b++,c=a+b;return c},e.prototype._updateResource=function(){var b=this,c=b._textClass;$("#"+b._pasteItem._name).find("span."+c).text(a.SR.ToolStrip_PasteText),$("#"+b._cutItem._name).find("span."+c).text(a.SR.ToolStrip_CutText),$("#"+b._copyItem._name).find("span."+c).text(a.SR.ToolStrip_CopyText),$("#"+b._autoFillItem._name).find("span."+c).text(a.SR.ToolStrip_AutoFillText)},e._getImageSrc=function(a){switch(a){case 0:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAA8ElEQVRIS92VwQ3CMAxFe + qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q / Eddu0KRe + 9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK + KYTFsz + 04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV / ZhBOQH2ddgKcYwBAc7R / weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N + B5MIaq5gb5o8kotBszJDShFlkvQ + ZHBvoTmC + fiVfoq / m86AAAAAElFTkSuQmCC";case 1:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAABkklEQVRIS7WTUXECQRBEcYCFOIiESAAH / OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko + Xt3ObG / 33t7eYhiGf6UU68 + vneD5Mu4HpZDgKja + YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o / tBKUJ8CTGsoveIsin3g1LEAkxzAd / kXbihwxwatGys+ EEpEAT5LR6FuDmMb + t + UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL / v0ZgfAQfSAk / WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP + Ihewf2gFPcWNNL817 / c / aAUKXpbfy / FXlzFIM6gOYy3Gp + iz / xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix + AHqkr6wgQ4Q7AAAAAElFTkSuQmCC";case 2:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAA3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL / iFSO9W0MDTzpqYob + ztTKeWn0uJIadE6H8 / ljXsR96q6tzt4YogH / olPcQ2R8mp3CHRBwO3 + 6EKkvNodcDkSgyyoAx0iRz / AA / 8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41 + kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM / u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII =";case 3:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAIdJREFUOE / tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j / tlP4wTHf4W / b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9 + eMSdet07b6c / bnwAAAABJRU5ErkJggg =="}},e}(a.BaseDialog);a.TouchToolStrip=W;var X=function(){function a(a,b,c,d,e){this._font="normal 12px Arial";var f=this;f._name=a,f._text=b,f._image=c,d&&(f.command=d),e&&(f.canExecute=e)}return a.prototype.name=function(a){var b=this;return 0===arguments.length?b._name:($("#"+b._name).attr("id",a),$("#"+b._name+"Text").attr("id",a+"Text"),$("#"+b._name+"Image").attr("id",a+"Image"),b._name=a,b)},a.prototype.text=function(a){var b=this;return 0===arguments.length?b._text:(b._text=a,$("#"+b.name()+"Text").text(a),b)},a.prototype.font=function(a){var b=this,c=$("#"+b.name()+"Text");return 0===arguments.length?b._font:(b._font=a,c.css("font",a),b)},a.prototype.foreColor=function(a){var b=this,c=$("#"+b.name()+"Text");return 0===arguments.length?b._foreColor?b._foreColor:c.css("color"):(c.css("color",a),b)},a.prototype.image=function(a){var b=this;return 0===arguments.length?b._image:(b._image=a,$("#"+b.name()+"Image").css("background-image","url("+a+")"),b)},a}();a.TouchToolStripItem=X;var Y=function(){function a(a){this._name=this._getSeparatorName(),a&&(this.canExecute=a)}return a.prototype.name=function(){return this._name},a.prototype._getSeparatorName=function(){for(var a=0,b="separator"+a;document.getElementById(b);)a++,b="separator"+a;return b},a}();a.TouchToolStripSeparator=Y;var Z=function(){function a(a){this.owner=a}return a.prototype.preProcessManipulationStarting=function(){this.eventMode=2,this.owner._isTouchMode=!0},a.prototype.postProcessManipulationComplete=function(){this.eventMode=0,this.touchCompleteTimestamp=(new Date).valueOf()},a.prototype.preProcessPointerDown=function(){return 1===this.eventMode},a.prototype.preProcessPointerUp=function(){return 1===this.eventMode},a.prototype.preProcessPointerMove=function(){return 1===this.eventMode},a.prototype.preProcessMouseDown=function(){var a=this;if(2===a.eventMode)return!0;if(a.touchCompleteTimestamp){if((new Date).valueOf()-a.touchCompleteTimestamp<=200)return a.mouseDownHandled++,!0;a.touchCompleteTimestamp=0,a.mouseDownHandled=0,a.eventMode=1}else a.eventMode=1;return a.owner._isTouchMode=!1,!1},a.prototype.preProcessMouseUp=function(){var a=this;return a.mouseDownHandled?(a.mouseDownHandled--,!0):2===a.eventMode?!0:(a.eventMode=0,!1)},a.prototype.preProcessMouseMove=function(){return 2===this.eventMode},a}();a.TouchMouseMessageFilter=Z;var _;!function(a){a[a.None=0]="None",a[a.MouseMode=1]="MouseMode",a[a.TouchMode=2]="TouchMode"}(_||(_={}));var ab=function(){function c(a){this._tab=a}return c.prototype.doManipulationStarting=function(){},c.prototype.doManipulationStarted=function(a){var b=this,c=b._tab,d=c._spread.getActiveSheet();c._tabNameEditor&&c.endSheetTabEditing(d,!1);var e="resizeBar",f="tab",g="newTab",h=c._hitTest(a.Position.X,a.Position.Y);if(h.element===e)c.resizeTab=!0,c.activeX=a.Position.X;else if(h.element===f||h.element===g||""===h.element){var i=c.canvas,j=i.width,k=i.height,l=b._getTouchCanvas(j,k);l.getContext("2d").drawImage(i,0,0,j,k),b._canvas=l,b._oldFirstTab=c._firstTab}b._minFirstTabIndex=c._getNextVisibleIndex(-1),b._maxFirstTabIndex=c._reCalculateFirstTabIndex(c._getVisibleTabs())},c.prototype.doManipulationDelta=function(c){var e=this,f=e._tab;if(f.resizeTab){var g=c.Position.X-f.activeX,h=f._spread,i=h._vp.clientWidth;h.setTabStripRatio(h._getActualTabStripRatio()+g/i,!0);var j=f._resizeBarWidth/i,k=1;h._getActualTabStripRatio()<j?(h.setTabStripRatio(j,!0),f.activeX=f._resizeBarWidth):h._getActualTabStripRatio()>=k?(h.setTabStripRatio(k,!0),f.activeX=i):f.activeX=c.Position.X}else{var m=e._canvas,n=e._oldFirstTab;if(!m||typeof n===l||n===b)return;var o=e._minFirstTabIndex,p=e._maxFirstTabIndex,q=f._newTabSize,r=f._getTabStartPosition(),s=c.Cumulative.Translation.X,t=e._getNewFirstTabInfo(s,n);f._firstTab=t.firstTab;var u=t.width;if(s>0&&n===o&&f._firstTab===o?u=0:0>s&&n===p&&f._firstTab===p&&(u=0),s>0&&s>u+q?s=u+q:0>s&&u-q>s&&(s=u-q),0!==s){var v=f.canvas,w=v.getContext("2d");w.save(),w.clearRect(0,0,v.width,v.height);var x=f.getBounds();w.fillStyle=f._getTabStripBackColor(w,x),w.fillRect(x.x,x.y,x.width,x.height);var y,z,A,B,C=0,D=x.height;s>0?(y=r,A=y+s,z=x.x+x.width-f._resizeBarWidth-A,z>0&&w.drawImage(m,y,C,z,D,A,C,z,D),B=s-u,x.x+x.width-f._resizeBarWidth-r<=s&&(B=0),z=u,y=r,z>0&&(w.translate(B,0),f.paintTabs(w,new a.Rect(y,C,z,D)),w.translate(-B,0))):0>s&&(A=r,y=A+d(s),z=x.x+x.width-f._resizeBarWidth-y,z>0&&w.drawImage(m,y,C,z,D,A,C,z,D),B=s-u,x.x+x.width-f._resizeBarWidth-r<=d(s)&&(B=0),z=d(u),y=x.x+x.width-f._resizeBarWidth-z,z>0&&(w.translate(B,0),f.paintTabs(w,new a.Rect(y,C,z,D)),w.translate(-B,0))),y=0,z=r,w.drawImage(m,y,C,z,D,y,C,z,D),y=x.width-f._resizeBarWidth,z=f._resizeBarWidth,w.drawImage(m,y,C,z,D,y,C,z,D),w.restore()}}},c.prototype.doManipulationInertiaStarting=function(){},c.prototype.doManipulationCompleted=function(){var a=this._tab;a.resizeTab?(a.resizeTab=!1,a._spread._doTabHSResize()):a.repaint()},c.prototype.doTapped=function(a){var b=this._tab,c=b._spread,d=c.getActiveSheet();b._tabNameEditor&&b.endSheetTabEditing(d,!1);var e="navButton",f="tab",g="newTab",h=b._hitTest(a.Position.X,a.Position.Y);c._suspendSetFocus=!0;try{h.element===e?b.doNavButtonClick(h.index,!0):h.element===f?b.doSheetTabClick(h.index,h.position):h.element===g&&b.doNewTabClick(h.position)}finally{c._suspendSetFocus=!1;var i=c.getActiveSheet();i!==d&&(i._isTouchMode=!0,i.setFocus())}},c.prototype.doDoubleTapped=function(a){return this._tab._doMouseDbClickImp(a.Position.X,a.Position.Y)},c.prototype.doRightTapped=function(){},c.prototype._getTouchCanvas=function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c},c.prototype._getNewFirstTabInfo=function(a,b){var c=this._tab,d=c._tabSizes,e=this._minFirstTabIndex,f=this._maxFirstTabIndex,g=b,h=0;if(a>0){for(;g>=e&&!(h>a);)h+=d[g],g--;e>g&&(g=e)}else if(0>a&&-1!==f){for(;f>=g&&!(a>h);)h-=d[g],g++;g>f&&(g=f)}return{firstTab:g,width:h}},c}(),bb=function(){function a(a,b,c){var d=this;d._touchMouseMessageFilter=new Z(d),d._touchTarget=new eb(a,"tabStrip",d._touchMouseMessageFilter,1,-1),d._touchEventProvider=c,d._touchEventHandler=new ab(b);var e=d._touchEventHandler,f=d._touchTarget;f.manipulationStarting=function(a){return e.doManipulationStarting(a)},f.manipulationStarted=function(a){return e.doManipulationStarted(a)},f.manipulationDelta=function(a){return e.doManipulationDelta(a)},f.manipulationInertiaStarting=function(a){return e.doManipulationInertiaStarting(a)},f.manipulationCompleted=function(a){return e.doManipulationCompleted(a)},f.tapped=function(a){return e.doTapped(a)},f.doubleTapped=function(a){return e.doDoubleTapped(a)},f.rightTapped=function(a){return e.doRightTapped(a)}}return a.prototype.bindTouchEvents=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!0)},a.prototype.unbindTouchEvents=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!1)},a.prototype.preProcessMouseDown=function(a){return this._touchMouseMessageFilter.preProcessMouseDown(a)},a.prototype.preProcessMouseUp=function(a){return this._touchMouseMessageFilter.preProcessMouseUp(a)},a.prototype.preProcessMouseMove=function(a){return this._touchMouseMessageFilter.preProcessMouseMove(a)},a}();a.TabStripTouchManager=bb;var cb=function(){function a(a,b,c){var d=this;d._touchMouseMessageFilter=new Z(d),d._touchTarget=new eb(a,"FL_"+b.name,d._touchMouseMessageFilter,1,200),d._touchEventProvider=c,d._touchEventHandler=new db(a,b);var e=d._touchEventHandler,f=d._touchTarget;f.canDoManipulation=function(){return b.floatingObject().isSelected()},f.canDoTap=function(){return!0},f.manipulationStarting=function(a){return e.doManipulationStarting(a)},f.manipulationStarted=function(a){return e.doManipulationStarted(a)},f.manipulationDelta=function(a){return e.doManipulationDelta(a)},f.manipulationInertiaStarting=function(a){return e.doManipulationInertiaStarting(a)},f.manipulationCompleted=function(a){return e.doManipulationCompleted(a)},f.tapped=function(a){return e.doTapped(a)},f.doubleTapped=function(a){return e.doDoubleTapped(a)},f.rightTapped=function(a){return e.doRightTapped(a)}}return a.prototype.attach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!0)},a.prototype.detach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!1)},a.prototype.preProcessMouseDown=function(a){return this._touchMouseMessageFilter.preProcessMouseDown(a)},a.prototype.preProcessMouseUp=function(a){return this._touchMouseMessageFilter.preProcessMouseUp(a)},a.prototype.preProcessMouseMove=function(a){return this._touchMouseMessageFilter.preProcessMouseMove(a)},a}();a.FloatingObjectTouchManager=cb;var db=function(){function a(a,b){this._floatingObjectRender=b,this._floatingObject=b.floatingObject(),this._containerElement=a}return a.prototype._positionToPage=function(a,b){var c=new t(b.X,b.Y),d=$(this._containerElement).offset();return d&&(isNaN(document.body.clientTop)||(d.top+=document.body.clientTop),isNaN(document.body.clientLeft)||(d.left+=document.body.clientLeft),c.X+=d.left,c.Y+=d.top),c},a.prototype.doManipulationStarting=function(a){a.Mode=3},a.prototype.doManipulationStarted=function(a){var b=this._positionToPage(a.OriginalSource,a.Position);this._floatingObjectRender._doMouseDown({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}})},a.prototype.doManipulationDelta=function(a){var b=this._positionToPage(a.OriginalSource,a.Position);this._floatingObjectRender._doMouseMove({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}})},a.prototype.doManipulationInertiaStarting=function(){},a.prototype.doManipulationCompleted=function(a){var b=this._positionToPage(a.OriginalSource,a.Position);this._floatingObjectRender._doMouseUp({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}})},a.prototype.doTapped=function(){try{var a=this._floatingObjectRender._sheet,b=a.isPaintSuspended();a.isPaintSuspended(!0),this._floatingObject.isSelected()||(a.unSelectAllFloatingObjects(),this._floatingObject.isSelected(!0),window.gcGlobal.activeElement=a),a.clearSelection()}finally{a.isPaintSuspended(b)}},a.prototype.doDoubleTapped=function(){},a.prototype.doRightTapped=function(){},a}(),eb=function(){function a(a,b,c,d,e){var f=this;f.element=a,f.messageFilter=c,f.eventFlag=b,f.maxPointer=d,f.level=e}return a}();a.TouchTargetElement=eb;var fb=function(){function c(){}return c.prototype.simulateMouseEvent=function(c,d){var e=c.originalEvent;if(e.isPrimary!==!1&&(!(e.touches&&e.touches.length>=1&&e.targetTouches&&e.targetTouches.length>=1)||e.touches[0].clientX===e.targetTouches[0].clientX&&e.touches[0].clientY===e.targetTouches[0].clientY)){a.util.cancelDefault(c);var f=typeof e.changedTouches!==l?e.changedTouches[0]:e,g=document.createEvent("MouseEvents");g.initMouseEvent(d,!0,!0,window,1,f.screenX,f.screenY,f.clientX,f.clientY,!1,!1,!1,!1,0,b),c.target.dispatchEvent(g)}},c.prototype.down=function(a){if(!a.pointerType||a.pointerType===a.MSPOINTER_TYPE_TOUCH||"touch"===a.pointerType){var b=a.data;if(b.touchHandled)return;b.touchHandled=!0,b._touchMoved=!1,b.simulateMouseEvent(a,"mouseover"),b.simulateMouseEvent(a,"mousemove"),b.simulateMouseEvent(a,"mousedown")}},c.prototype.move=function(a){if(!a.pointerType||a.pointerType===a.MSPOINTER_TYPE_TOUCH||"touch"===a.pointerType){var b=a.data;if(!b.touchHandled)return;b._touchMoved=!0,b.simulateMouseEvent(a,"mousemove")}},c.prototype.up=function(a){if(!a.pointerType||a.pointerType===a.MSPOINTER_TYPE_TOUCH||"touch"===a.pointerType){var b=a.data;if(!b.touchHandled)return;b.simulateMouseEvent(a,"mouseup"),b.simulateMouseEvent(a,"mouseout"),b._touchMoved||b.simulateMouseEvent(a,"click"),b.touchHandled=!1}},c.prototype.bindUnBindTouchEvents=function(a,c,d){var e=this,f=d.charAt(0);"."!==f&&(d="."+d);var g="MSPointerDown"+d,h="MSPointerMove"+d,i="MSPointerUp"+d,j="pointerdown"+d,k="pointermove"+d,m="pointerup"+d,n="touchstart"+d,o="touchmove"+d,p="touchend"+d;c?window.navigator.msPointerEnabled?(a.style.msTouchAction!==b&&typeof a.style.msTouchAction!==l&&(a.style.msTouchAction="none"),$(a).bind(g,e,e.down).bind(j,e,e.down),$(document).bind(h,e,e.move).bind(k,e,e.move).bind(i,e,e.up).bind(m,e,e.up)):$(a).bind(n,e,e.down).bind(o,e,e.move).bind(p,e,e.up):window.navigator.msPointerEnabled?($(a).unbind(g).unbind(j),$(document).unbind(h).unbind(k).unbind(i).unbind(m)):$(a).unbind(n).unbind(o).unbind(p)},c}();a._SimulateMouseEvents=fb}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("floatingObject",["core.common","core.stringResource","core.sheet_action","core.imageLoader"]);var b=null,c=void 0,d=Math.ceil,e=Math.floor,f=Math.max,g=Math.min,h=Math.abs,i="#044062",j=1,k=9007199254740992,l=4,m=700,n=701,o="position",p="absolute",q="100%",r="background",s="floatingobject-selected",t="floatingobject-unselected",u="floatingobject-resize-indicator-select",v="floatingobject-resize-indicator-unSelect",w="floatingobject-none-user-select",x="floatingobject-content-container",y="floatingobject-container",z="floatingobject-moving-container",A="floatingobject-moving-div",B="floatingobject-background-cover",C=".floatingobject-resize-indicator",D="div.floatingobject-resize-indicator.floatingobject-top.floatingobject-left",E="div.floatingobject-resize-indicator.middle.floatingobject-left",F="div.floatingobject-resize-indicator.floatingobject-bottom.floatingobject-left",G="div.floatingobject-resize-indicator.floatingobject-top.floatingobject-center",H="div.floatingobject-resize-indicator.floatingobject-bottom.floatingobject-center",I="div.floatingobject-resize-indicator.floatingobject-top.floatingobject-right",J="div.floatingobject-resize-indicator.middle.floatingobject-right",K="div.floatingobject-resize-indicator.floatingobject-bottom.floatingobject-right",L='<div class="floatingobject-resize-indicator floatingobject-top floatingobject-left floatingobject-absolute"></div><div class="floatingobject-resize-indicator floatingobject-top floatingobject-center floatingobject-absolute"></div><div class="floatingobject-resize-indicator floatingobject-top floatingobject-right floatingobject-absolute"></div><div class="floatingobject-resize-indicator middle floatingobject-left floatingobject-absolute"></div><div class="floatingobject-resize-indicator middle floatingobject-right floatingobject-absolute"></div><div class="floatingobject-resize-indicator floatingobject-bottom floatingobject-left floatingobject-absolute"></div><div class="floatingobject-resize-indicator floatingobject-bottom floatingobject-center floatingobject-absolute"></div><div class="floatingobject-resize-indicator floatingobject-bottom floatingobject-right floatingobject-absolute"></div>';!function(a){a[a.CustomFloatingObject=0]="CustomFloatingObject",a[a.Picture=1]="Picture"}(a.FloatingObjectType||(a.FloatingObjectType={}));var M=(a.FloatingObjectType,function(d){function e(a){d.call(this),this._floatingObjectType=b,this._sheet=a}return __extends(e,d),e.prototype.ownerSheet=function(a){return 0===arguments.length?this._sheet:(this._sheet=a,this)},e.prototype.find=function(a){var c=this._findItemIndex(a);return c>=0?this[c]:b},e.prototype.replace=function(d,e){if(e===b||e===c)throw new Error(a.SR.Exp_ValueIsNull);var f=this._findItemIndex(d);f>=0&&this.splice(f,1,e)},e.prototype.add=function(d){var e=d.name();if(e===b||e===c)throw new Error(a.SR.Exp_FloatingObjectNameEmptyError);this._checkObjectExists(e),d.owner(this._sheet),this.push(d)},e.prototype.remove=function(a){if(a!==b&&a!==c){var d=this._findItemIndex(a.name());return d>=0&&a.owner(b),this.splice(d,1),!0}return!1},e.prototype.addRows=function(a,b){var c,d;for(c=0,d=this.length;d>c;c++)this[c].addRows(a,b)},e.prototype.removeRows=function(a,b){var c,d,e=this,f=[];for(c=0,d=e.length;d>c;c++){var g=e[c];e._isCoverRange(a,-1,a+b-1,e._sheet.getColumnCount(),g)&&(g.dynamicMove()||g.dynamicSize())?f.push(g):g.removeRows(a,b)}for(c=0,d=f.length;d>c;c++)e.remove(f[c])},e.prototype.addColumns=function(a,b){var c,d;for(c=0,d=this.length;d>c;c++)this[c].addColumns(a,b)},e.prototype.removeColumns=function(a,b){var c,d,e=this,f=[];for(c=0,d=e.length;d>c;c++){var g=e[c];e._isCoverRange(-1,a,e._sheet.getRowCount(),a+b-1,g)&&(g.dynamicMove()||g.dynamicSize())?f.push(g):g.removeColumns(a,b)}for(c=0,d=f.length;d>c;c++)e.remove(f[c])},e.prototype._isCoverRange=function(a,b,c,d,e){var f=e.startRow(),g=e.startColumn(),h=e.endRow(),i=e.endColumn();return f>=a&&g>=b&&c>=h&&d>=i},e.prototype._checkObjectExists=function(b){if(this._sheet._findFloatingObjectInternal(b))throw new Error(a.SR.Exp_FloatingObjectHasSameNameError)},e.prototype._findItemIndex=function(a){for(var b=this.length,c=0;b>c;c++)if(this[c].name()===a)return c;return-1},e.prototype._updateFloatingsObjectlayoutOnColumnRowChanged=function(){for(var a=0,b=this.length;b>a;a++){var c=this[a];c.dynamicMove()?c._updateFloatingObjectLocation():c._updateStartPosition(),c.dynamicSize()?c._updateFloatingObjectSize():c._updateEndPosition()}},e.prototype.toJSON=function(){var a,b,d=[];for(a=0,b=this.length;b>a;a++)d.push(this[a].toJSON());return 0===d.length?c:{floatingObjects:d}},e.prototype.fromJSON=function(a){if(a&&a.floatingObjects)for(var c=a.floatingObjects,d=c.length,e=0;d>e;e++){var f=c[e],g=b;if(f){var h=this._getFloatingObjectTypes(),i=h[f.floatingObjectType];i&&(g=new i,g.owner(this._sheet),g.fromJSON(f))}g&&this.push(g)}},e.prototype._getFloatingObjectTypes=function(){if(!this._floatingObjectType){var a={};a[0]=O,a[1]=P,this._floatingObjectType=a}return this._floatingObjectType},e}(a._XArray));a._FloationgObjectArray=M;var N=function(){function e(b,d,e,f,g){this._cacheOffset={startRowOffset:c,startColumnOffset:c,endRowOffset:c,endColumnOffset:c},this._isFOColumnsOrRowsVisible=!0;var h=this;h._name=b,h._location=new a.Rect("number"==typeof d?d:0,"number"==typeof e?e:0,"number"==typeof f?f:0,"number"==typeof g?g:0),h._canPrint=!0,h._isLocked=!0,h._isVisible=!0,h._isSelected=!1,h._dynamicMove=!0,h._dynamicSize=!0}return e.prototype.name=function(b){var c=this;if(0===arguments.length)return c._name;if("string"!=typeof b||""===b)throw new Error(a.SR.Exp_FloatingObjectNameEmptyError);return c._name!==b&&(c._name=b,c._trigger({sheet:c._sheet,sheetName:c._sheet?c._sheet._name:"",floatingObject:c,propertyName:"name"})),c},e.prototype.owner=function(a){var b=this;return 0===arguments.length?b._sheet:(b._sheet=a,b._updateFloatingObjectCoorinates(),b)},e.prototype.isSelected=function(a){var b=this,c=b._sheet;
return 0===arguments.length?b._isSelected:("boolean"==typeof a&&b._isSelected!==a&&(c?c._bindToAutoRefresh(function(a){b._isSelected=a})(a):b._isSelected=a,b._trigger({sheet:c,sheetName:c?c._name:"",floatingObject:b,propertyName:"isSelected"})),b)},e.prototype.isLocked=function(a){var b=this;return 0===arguments.length?b._isLocked:("boolean"==typeof a&&b._isLocked!==a&&(b._isLocked=a,b._trigger({sheet:b._sheet,sheetName:b._sheet?b._sheet._name:"",floatingObject:b,propertyName:"islocked"})),b)},e.prototype.canPrint=function(a){var b=this;return 0===arguments.length?b._canPrint:("boolean"==typeof a&&b._canPrint!==a&&(b._canPrint=a,b._trigger({sheet:b._sheet,sheetName:b._sheet?b._sheet._name:"",floatingObject:b,propertyName:"canPrint"})),b)},e.prototype.isVisible=function(a){var b=this,c=b._sheet;return 0===arguments.length?b._isVisible:("boolean"==typeof a&&b._isVisible!==a&&(c?c._bindToAutoRefresh(function(){b._isVisible=a})(a):b._isVisible=a,b._trigger({sheet:c,sheetName:c?c._name:"",floatingObject:b,propertyName:"visible"})),b)},e.prototype.position=function(b){var c=this,d=c._sheet;return 0===arguments.length?new a.Point(c._location.x,c._location.y):(b instanceof a.Point&&(c._location.x!==b.x||c._location.y!==b.y)&&(d?d._bindToAutoRefresh(function(a){c._location.x=a.x,c._location.y=a.y,c._adjustPosition(),c._updateCoverRange()})(b):(c._location.x=b.x,c._location.y=b.y),c._trigger({sheet:d,sheetName:d?d._name:"",floatingObject:c,propertyName:"position"})),c)},e.prototype.height=function(a){var b=this,c=b._sheet;return 0===arguments.length?b._location.height:("number"==typeof a&&b._location.height!==a&&(c?c._bindToAutoRefresh(function(a){b._location.height=a,b._adjustSize(),b._adjustPosition(),b._updateCoverRange()})(a):b._location.height=a,b._trigger({sheet:c,sheetName:c?c._name:"",floatingObject:b,propertyName:"height"})),b)},e.prototype.width=function(a){var b=this,c=b._sheet;return 0===arguments.length?b._location.width:("number"==typeof a&&b._location.width!==a&&(c?c._bindToAutoRefresh(function(a){b._location.width=a,b._adjustSize(),b._adjustPosition(),b._updateCoverRange()})(a):b._location.width=a,b._trigger({sheet:c,sheetName:c?c._name:"",floatingObject:b,propertyName:"width"})),b)},e.prototype.startRow=function(a){var b=this;return 0===arguments.length?b._startRow:("number"==typeof a&&b._startRow!==a&&(a=d(a),b._sheet?b._sheet._bindToAutoRefresh(function(a){b._startRow=a,b._updateFloatingObjectLocation()})(a):b._startRow=a),b)},e.prototype.startRowOffset=function(a){var b=this;return 0===arguments.length?b._startRowOffset:("number"==typeof a&&b._startRowOffset!==a&&(b._sheet?b._sheet._bindToAutoRefresh(function(a){b._startRowOffset=a,b._updateFloatingObjectLocation()})(a):b._startRowOffset=a),b)},e.prototype.startColumn=function(a){var b=this;return 0===arguments.length?b._startColumn:("number"==typeof a&&b._startColumn!==a&&(a=d(a),b._sheet?b._sheet._bindToAutoRefresh(function(a){b._startColumn=a,b._updateFloatingObjectLocation()})(a):b._startColumn=a),b)},e.prototype.startColumnOffset=function(a){var b=this;return 0===arguments.length?b._startColumnOffset:("number"==typeof a&&b._startColumnOffset!==a&&(b._sheet?b._sheet._bindToAutoRefresh(function(a){b._startColumnOffset=a,b._updateFloatingObjectLocation()})(a):b._startColumnOffset=a),b)},e.prototype.endRow=function(a){var b=this;return 0===arguments.length?b._endRow:("number"==typeof a&&b._endRow!==a&&(b._sheet?b._sheet._bindToAutoRefresh(function(a){b._endRow=a,b._updateFloatingObjectSize()})(a):b._endRow=a),b)},e.prototype.endRowOffset=function(a){var b=this;return 0===arguments.length?b._endRowOffset:("number"==typeof a&&b._endRowOffset!==a&&(b._sheet?b._sheet._bindToAutoRefresh(function(a){b._endRowOffset=a,b._updateFloatingObjectSize()})(a):b._endRowOffset=a),b)},e.prototype.endColumn=function(a){var b=this;return 0===arguments.length?b._endColumn:("number"==typeof a&&b._endColumn!==a&&(a=d(a),b._sheet?b._sheet._bindToAutoRefresh(function(a){b._endColumn=a,b._updateFloatingObjectSize()})(a):b._endColumn=a),b)},e.prototype.endColumnOffset=function(a){var b=this;return 0===arguments.length?b._endColumnOffset:("number"==typeof a&&b._endColumnOffset!==a&&(b._sheet?b._sheet._bindToAutoRefresh(function(a){b._endColumnOffset=a,b._updateFloatingObjectSize()})(a):b._endColumnOffset=a),b)},e.prototype.dynamicMove=function(a){var b=this;return 0===arguments.length?b._dynamicMove:("boolean"==typeof a&&b._dynamicMove!==a&&(b._dynamicMove=a,b._trigger({sheet:b._sheet,sheetName:b._sheet?b._sheet._name:"",floatingObject:b,propertyName:"dynamicMove"})),b)},e.prototype.dynamicSize=function(a){var b=this;return 0===arguments.length?b._dynamicSize:("boolean"==typeof a&&b._dynamicSize!==a&&(b._dynamicSize=a,b._trigger({sheet:b._sheet,sheetName:b._sheet?b._sheet._name:"",floatingObject:b,propertyName:"dynamicSize"})),b)},e.prototype.addRows=function(a,b){var c=this;a=d(a),b=d(b),a<=c.startRow()?c.dynamicMove()&&(c.startRow(c.startRow()+b),c.endRow(c.endRow()+b)):a>c.startRow()&&a<c.endRow()&&c.dynamicSize()&&c.endRow(c.endRow()+b)},e.prototype.removeRows=function(a,b){var c=this,d=a+b-1;if(a<=c.startRow()){if(d<c.startRow())c.dynamicMove()&&(c.startRow(c.startRow()-b),c.endRow(c.endRow()-b));else if(d<c.endRow()){var e=d-c.startRow()+1,f=c.endRow()-c.startRow()+1-e;c.dynamicMove()&&(c.startRow(a),c.startRowOffset(0)),c.dynamicSize()&&c.endRow(a+f-1)}}else a<=c.endRow()&&(d<c.endRow()?c.dynamicSize()&&c.endRow(c.endRow()-b):c.dynamicSize()&&(c.endRow(a),c.endRowOffset(0)))},e.prototype.addColumns=function(a,b){var c=this;a=d(a),b=d(b),a<=c.startColumn()?c.dynamicMove()&&(c.startColumn(c.startColumn()+b),c.endColumn(c.endColumn()+b)):a>c.startColumn()&&a<c.endColumn()&&c.dynamicSize()&&c.endColumn(c.endColumn()+b)},e.prototype.removeColumns=function(a,b){var c=this;a=d(a),b=d(b);var e=a+b-1;if(a<=c.startColumn()){if(e<c.startColumn())c.dynamicMove()&&(c.startColumn(c.startColumn()-b),c.endColumn(c.endColumn()-b));else if(e<c.endColumn()){var f=e-c.startColumn()+1,g=c.endColumn()-c.startColumn()+1-f;c.dynamicMove()&&(c.startColumn(a),c.startColumnOffset(0)),c.dynamicSize()&&c.endColumn(a+g-1)}}else a<=c.endColumn()&&(e<c.endColumn()?c.dynamicSize()&&c.endColumn(c.endColumn()-b):c.dynamicSize()&&(c.endColumn(a),c.endColumnOffset(0)))},e.prototype._isDefaultValue=function(a,b){switch(a){case"x":return 0===b;case"y":return 0===b;case"width":return 0===b;case"height":return 0===b;case"canPrint":return b===!0;case"isSelected":return b===!1;case"isLocked":return 1==b;case"isVisible":return b===!0;case"dynamicMove":return b===!0;case"dynamicSize":return b===!0;default:return!1}},e.prototype.toJSON=function(){var a=this,b={name:a._name,x:a._location.x,y:a._location.y,width:a._location.width,height:a._location.height,canPrint:a._canPrint,isSelected:a._isSelected,isLocked:a._isLocked,isVisible:a._isVisible,dynamicMove:a._dynamicMove,dynamicSize:a._dynamicSize},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},e.prototype.fromJSON=function(b){if(b){var d=this;d._name=b.name;var e=b.x!==c?b.x:0,f=b.y!==c?b.y:0,g=b.width!==c?b.width:0,h=b.height!==c?b.height:0;d._location=new a.Rect(e,f,g,h),b.canPrint!==c&&(d._canPrint=b.canPrint),b.isSelected!==c&&(d._isSelected=b.isSelected),b.isLocked!==c&&(d._isLocked=b.isLocked),b.isVisible!==c&&(d._isVisible=b.isVisible),b.dynamicMove!==c&&(d._dynamicMove=b.dynamicMove),b.dynamicSize!==c&&(d._dynamicSize=b.dynamicSize),d._updateCoverRange()}},e.prototype.clone=function(){var a=new e,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a},e.prototype._adjustSize=function(){var a=this,b=a._getSheetHeight(),c=a._getSheetWidth();a._location.width>c&&(a._location.width=c),a._location.height>b&&(a._location.height=b)},e.prototype._adjustPosition=function(){var a=this,b=a._getSheetHeight(),c=a._getSheetWidth(),d=a._location.x+a._location.width;d>c&&(a._location.x=c-a._location.width),a._location.x<0&&(a._location.x=0);var e=a._location.y+a._location.height;e>b&&(a._location.y=b-a._location.height),a._location.y<0&&(a._location.y=0)},e.prototype._updateFloatingObjectCoorinates=function(){var a=this;a._adjustSize(),a._adjustPosition(),a._startRow!==b&&a._startRow!==c&&a._startColumn!==b&&a._startColumn!==c?(a._startRowOffset||(a._startRowOffset=0),a._startColumnOffset||(a._startColumnOffset=0),a._updateFloatingObjectLocation()):a._updateStartPosition(),a._endColumn!==b&&a._endColumn!==c&&a._endRow!==b&&a._endRow!==c?(a._endRowOffset||(a._endRowOffset=0),a._endColumnOffset||(a._endColumnOffset=0),a._updateFloatingObjectSize()):a._updateEndPosition()},e.prototype._getSheetHeight=function(){var a=this,d=a._sheet;if(d===b||d===c)return k;for(var e=0,f=d.getRowCount(),g=0;f>g;g++)e+=d.getRowHeight(g,3);return e},e.prototype._getSheetWidth=function(){var a=this,d=a._sheet;if(d===b||d===c)return k;for(var e=0,f=d.getColumnCount(),g=0;f>g;g++)e+=d.getColumnWidth(g,3);return e},e.prototype._updateStartRowOffset=function(){var a=this,b=a._startRowOffset,d=a._sheet.getRowHeight(a.startRow(),3),e=a._cacheOffset;d>0&&d--,b>d?(e.startRowOffset||(e.startRowOffset=b),a._startRowOffset=d):e.startRowOffset&&(e.startRowOffset<d?(a._startRowOffset=e.startRowOffset,e.startRowOffset=c):d<e.startRowOffset&&(a._startRowOffset=d))},e.prototype._updateStartColumnOffset=function(){var a=this,b=a._startColumnOffset,d=a._sheet.getColumnWidth(a.startColumn(),3),e=a._cacheOffset;d>0&&d--,b>d?(e.startColumnOffset||(e.startColumnOffset=b),a._startColumnOffset=d):e.startColumnOffset&&(e.startColumnOffset<d?(a._startColumnOffset=e.startColumnOffset,e.startColumnOffset=c):b<e.startColumnOffset&&(a._startColumnOffset=d))},e.prototype._updateEndRowOffset=function(){var a=this,b=a._endRowOffset,d=a._sheet.getRowHeight(a.endRow(),3),e=a._cacheOffset;d>0&&d--,b>d?(e.endRowOffset||(e.endRowOffset=b),a._endRowOffset=d):e.endRowOffset&&(e.endRowOffset<d?(a._endRowOffset=e.endRowOffset,e.endRowOffset=c):b<e.endRowOffset&&(a._endRowOffset=d))},e.prototype._updateEndColumnOffset=function(){var a=this,b=a._endColumnOffset,d=a._sheet.getColumnWidth(a.endColumn(),3),e=a._cacheOffset;d>0&&d--,b>d?(e.endColumnOffset||(e.endColumnOffset=b),a._endColumnOffset=d):e.endColumnOffset&&(e.endColumnOffset<d?(a._endColumnOffset=e.endColumnOffset,e.endColumnOffset=c):b<e.endColumnOffset&&(a._endColumnOffset=d))},e.prototype._updateFloatingObjectLocation=function(){var a=this,d=a._sheet;if(d!==b&&d!==c){for(var e=0,f=a.startRow(),g=0;f>g;g++)e+=d.getRowHeight(g,3);a._updateStartRowOffset(),e+=a._startRowOffset;for(var h=0,i=a.startColumn(),j=0;i>j;j++)h+=d.getColumnWidth(j,3);a._updateStartColumnOffset(),h+=a._startColumnOffset,(a._location.x!==h||a._location.y!==e)&&(a._location.x=h,a._location.y=e,a._trigger({sheet:d,sheetName:d?d._name:"",floatingObject:a,propertyName:"location"}))}},e.prototype._updateFloatingObjectSize=function(){var a=this,d=a._sheet;if(d!==b&&d!==c){a._isFOColumnsOrRowsVisible===!1&&(a._isVisible=!0,a._isFOColumnsOrRowsVisible=!0);for(var e=0,f=a.startRow(),g=a.endRow(),h=f;g>h;h++)e+=d.getRowHeight(h,3);var i=e+d.getRowHeight(g,3);if(0===i&&a._isVisible===!0&&(a._isVisible=!1,a._isFOColumnsOrRowsVisible=!1),f===g)a._updateEndRowOffset(),e=a.endRowOffset()-a.startRowOffset();else{var j=d.getRowHeight(f,3);j>0&&(e-=a._startRowOffset),a._updateEndRowOffset(),e+=a._endRowOffset}for(var k=0,l=a.startColumn(),m=a.endColumn(),n=l;m>n;n++)k+=d.getColumnWidth(n,3);var o=k+d.getColumnWidth(m,3);if(0===o&&a._isVisible===!0&&(a._isVisible=!1,a._isFOColumnsOrRowsVisible=!1),l===m)a._updateEndColumnOffset(),k=a.endColumnOffset()-a.startColumnOffset();else{var p=d.getColumnWidth(l,3);p>0&&(k-=a._startColumnOffset),a._updateEndColumnOffset(),k+=a._endColumnOffset}0>k&&(k=0),0>e&&(e=0),a._location.width!==k&&(a._location.width=k,a._trigger({sheet:d,sheetName:d?d._name:"",floatingObject:a,propertyName:"width"})),a._location.height!==e&&(a._location.height=e,a._trigger({sheet:d,sheetName:d?d._name:"",floatingObject:a,propertyName:"height"}))}},e.prototype._updateStartPosition=function(){var a=this,d=a._sheet;if(d!==b&&d!==c){var e=a._calcAnchorRow(a._location.y);if(a._startRow=e.row,a._startRowOffset=e.offsetY,-1===a._startRowOffset){a._startRow+=1,a._startRowOffset=0;var f=d.getRowCount();a._startRow===f&&(a._startRow=f-1)}var g=a._calcAnchorColumn(a._location.x);if(a._startColumn=g.column,a._startColumnOffset=g.offsetX,-1===a._startColumnOffset){a._startColumn+=1,a._startColumnOffset=0;var h=d.getColumnCount();a._startColumn===h&&(a._startColumn=h-1)}}},e.prototype._updateEndPosition=function(){var a=this;if(a._sheet!==b&&a._sheet!==c){var d=a._calcAnchorRow(a._location.y+a._location.height);a._endRow=d.row,a._endRowOffset=d.offsetY;var e=a._calcAnchorColumn(a._location.x+a._location.width);a._endColumn=e.column,a._endColumnOffset=e.offsetX}},e.prototype._updateCoverRange=function(){this._updateStartPosition(),this._updateEndPosition()},e.prototype._calcAnchorRow=function(a){for(var c=0,d=0,e=this._sheet.getRowCount(),f=0;e>f;f++){var g=this._sheet.getRowHeight(f,3);c+=g;var h=c-a;if(h>0)return d=h>0?g-h:-1,{row:f,offsetY:d};if(0===h)return d=0,{row:f+1,offsetY:0}}return b},e.prototype._calcAnchorColumn=function(a){for(var c=0,d=0,e=this._sheet.getColumnCount(),f=0;e>f;f++){var g=this._sheet.getColumnWidth(f,3);c+=g;var h=c-a;if(h>0)return d=h>0?g-h:-1,{column:f,offsetX:d};if(0===h)return d=0,{column:f+1,offsetX:0}}return b},e.prototype._trigger=function(b){if(this._sheet&&(this._sheet._trigger(a.Events.FloatingObjectChanged,b),"isSelected"===b.propertyName)){var c={sheet:b.sheet,sheetName:b.sheetName,floatingObject:b.floatingObject};this._sheet._trigger(a.Events.FloatingObjectSelectionChanged,c)}},e.prototype._createContentContainer=function(){var a=document.createElement("div"),b=$(a).addClass(x).addClass(w).css(o,p);return b.css(r,i),a},e}();a.FloatingObject=N;var O=function(a){function c(c,d,e,f,g){a.call(this,c,d,e,f,g),this._content=b}return __extends(c,a),c.prototype.Content=function(a){var b=this;return 0===arguments.length?b._content:(b.owner()?b.owner()._bindToAutoRefresh(function(a){b._content=a})(a):b._content=a,void b._trigger({sheet:b.owner(),sheetName:b.owner()?b.owner()._name:"",customFloatingObject:b,propertyName:"content"}))},c.prototype.toJSON=function(){var b=a.prototype.toJSON.call(this);b.floatingObjectType=0;var c=$("<div></div>").append(this.cloneContent()).html();return b.content=c,b},c.prototype.fromJSON=function(b){b&&(a.prototype.fromJSON.call(this,b),b.content&&(this._content=$(b.content).get(0)))},c.prototype.clone=function(){var a=new c,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a._content=this.cloneContent(),a},c.prototype.cloneContent=function(){return this._content?$(this._content).clone().filter("*").removeAttr("id").get(0):b},c.prototype._createContentContainer=function(){var a=document.createElement("div"),c=$(a).addClass(x).addClass(w).css(o,p),d=this.cloneContent(),e=q,f=q,g="",h="";if(d&&d.style&&(g=d.style.width,h=d.style.height),""!==g&&(e=g),""!==h&&(f=h),d!==b){$(d).css({width:e,height:f}).addClass(B).addClass(w).appendTo(a)}else c.css(r,i);return a},c}(N);a.CustomFloatingObject=O;var P=function(d){function e(a,c,e,f,g,h){d.call(this,a,e,f,g,h);var i=this;i._pictureStretch=0,i._borderWidth=1,i._borderStyle="none",i._borderColor=b,i._borderRadius=-1,i._backColor=b,i._imageLoader=b,i._isImageLoaded=!1,i._isTakeOriginalSize=!1,"string"==typeof c&&i.src(c)}return __extends(e,d),e.prototype._trigger=function(b){if(this.owner()&&(b&&b.floatingObject&&(b.picture=b.floatingObject,delete b.floatingObject),this.owner()._trigger(a.Events.PictureChanged,b),"isSelected"===b.propertyName)){var c={sheet:b.sheet,sheetName:b.sheetName,picture:b.picture};this.owner()._trigger(a.Events.PictureSelectionChanged,c)}},e.prototype.backColor=function(a){var b=this;if(0===arguments.length)return b._backColor;if("string"==typeof a&&b._backColor!==a){var c=b.owner();c?c._bindToAutoRefresh(function(a){b._backColor=a})(a):b._backColor=a,b._trigger({sheet:c,sheetName:c?c._name:"",picture:b,propertyName:"backColor"})}return b},e.prototype.borderRadius=function(a){var b=this;if(0===arguments.length)return b._borderRadius;if("number"==typeof a&&!isNaN(a)&&b._borderRadius!==a){var c=b.owner();c?c._bindToAutoRefresh(function(a){b._borderRadius=a})(a):b._borderRadius=a,b._trigger({sheet:c,sheetName:c?c._name:"",picture:b,propertyName:"borderRadius"})}return b},e.prototype.borderWidth=function(a){var b=this;if(0===arguments.length)return b._borderWidth;if("number"==typeof a&&!isNaN(a)&&b._borderWidth!==a){var c=b.owner();c?c._bindToAutoRefresh(function(a){b._borderWidth=a})(a):b._borderWidth=a,b._trigger({sheet:c,sheetName:c?c._name:"",picture:b,propertyName:"borderWidth"})}return b},e.prototype.borderStyle=function(a){var b=this;if(0===arguments.length)return b._borderStyle;if("string"==typeof a&&b._borderStyle!==a){var c=b.owner();c?c._bindToAutoRefresh(function(a){b._borderStyle=a})(a):b._borderStyle=a,b._isBorderStyleWork(a)||(b._borderWidth=0),b._trigger({sheet:c,sheetName:c?c._name:"",picture:b,propertyName:"borderStyle"})}return b},e.prototype.borderColor=function(a){var b=this;if(0===arguments.length)return b._borderColor;if("string"==typeof a&&b._borderColor!==a){var c=b.owner();c?c._bindToAutoRefresh(function(a){b._borderColor=a})(a):b._borderColor=a,b._trigger({sheet:c,sheetName:c?c._name:"",picture:b,propertyName:"borderColor"})}return b},e.prototype.pictureStretch=function(b){var d=this;if(0===arguments.length)return d._pictureStretch;if(d._pictureStretch!==b&&a.ImageLayout[b]!==c){var e=d.owner();e?e._bindToAutoRefresh(function(a){d._pictureStretch=a})(b):d._pictureStretch=b,d._trigger({sheet:e,sheetName:e?e._name:"",picture:d,propertyName:"pictureStretch"})}return d},e.prototype.getOriginalWidth=function(){return this._originalWidth},e.prototype.getOriginalHeight=function(){return this._originalHeight},e.prototype.src=function(a){var b=this;if(0===arguments.length)return b._src;if("string"==typeof a&&b._src!==a){var c=b.owner();c?c._bindToAutoRefresh(function(a){b._src=a})(a):b._src=a,b._trigger({sheet:c,sheetName:c?c._name:"",picture:b,propertyName:"src"}),b._isImageLoaded=!1,b._loadImage()}return b},e.prototype._isDefaultValue=function(a,c){switch(a){case"backColor":return c===b;case"borderRadius":return-1===c;case"borderWidth":return 1===c;case"borderStyle":return"none"===c;case"borderColor":return c===b;case"pictureStretch":return 0===c;default:return!1}},e.prototype.toJSON=function(){var a=this,b=d.prototype.toJSON.call(this);b.src=a._src,b.floatingObjectType=1,b.backColor=a._backColor,b.borderRadius=a._borderRadius,b.borderWidth=a._borderWidth,b.borderStyle=a._borderStyle,b.borderColor=a._borderColor,b.pictureStretch=a._pictureStretch;var e={};for(var f in b){var g=b[f];a._isDefaultValue(f,g)||(e[f]=g)}return $.isEmptyObject(e)?c:e},e.prototype.fromJSON=function(a){if(a){var b=this;d.prototype.fromJSON.call(this,a),a.src&&(b._src=a.src,b._isImageLoaded=!1,b._loadImage(),a.backColor!==c&&(b._backColor=a.backColor),a.borderRadius!==c&&(b._borderRadius=a.borderRadius),a.borderWidth!==c&&(b._borderWidth=a.borderWidth),a.borderStyle!==c&&(b._borderStyle=a.borderStyle),a.borderColor!==c&&(b._borderColor=a.borderColor),a.pictureStretch!==c&&(b._pictureStretch=a.pictureStretch),b._isBorderStyleWork(b._borderStyle)||(b._borderWidth=0))}},e.prototype.clone=function(){var a=new e,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a},e.prototype._isBorderStyleWork=function(a){switch(a){case"dotted":case"dashed":case"solid":case"double":case"groove":case"ridge":case"inset":case"outset":return!0;default:return!1}},e.prototype._loadImage=function(){var b=this,c=b._src;b._imageLoader||(b._imageLoader=new a._GcImageLoader(function(){b._loadImage()}));try{if(b._imageLoader.getState(c)){b._isImageLoaded=!0;var d=b._imageLoader.getImage(c);b._originalWidth=d.width,b._originalHeight=d.height,b._isTakeOriginalSize&&(b.width(b._originalWidth),b.height(b._originalHeight),b._isTakeOriginalSize=!1);var e=b.owner();e&&e.repaint()}else b._imageLoader.addImage(c)}catch(f){}},e.prototype._createContentContainer=function(){{var a=document.createElement("div");$(a).addClass(x).addClass(w).css(o,p)}return a},e}(N);a.Picture=P;var Q=function(){function d(a,b){this._srcCache="";var c=this;c._floatingObject=a,c.name=c._floatingObject.name(),c._sheet=b,c._isMouseCapture=!1}return d.prototype.floatingObject=function(){return this._floatingObject},d.prototype.render=function(b,c){var d=this,e=!1;if(d._rect=b,!d._floatingObjectContainerDiv){d._floatingObjectContainerDiv=d._createFloatingObjectContainer(d._floatingObject.name());var f=d._sheet.parent;f&&(d._containerDiv=f._getContainerDiv(),d._containerDiv&&$(d._containerDiv).append(d._floatingObjectContainerDiv))}d._floatingObjectContentDiv||(d._floatingObjectContentDiv=d._floatingObject._createContentContainer(),"function"==typeof d._floatingObject.borderWidth?(d._borderDiv=document.createElement("div"),$(d._borderDiv).addClass(w),d._floatingObjectContainerDiv.appendChild(d._borderDiv),d._borderDiv.appendChild(d._floatingObjectContentDiv)):(d._floatingObjectContainerDiv.appendChild(d._floatingObjectContentDiv),e=!0)),d._borderDiv&&(d._applyBorderStyle(c,b),c.x=0,c.y=0);var g=$(d._floatingObjectContainerDiv),h=$(d._floatingObjectContentDiv);if(g.css({top:b.y,left:b.x,width:b.width,height:b.height}),h.css({top:c.y,left:c.x,width:c.width,height:c.height}),d._borderDiv&&d._paintImage(),d._floatingObject.isSelected()?(h.removeClass(t).addClass(s),d._showResizeIndicator(g)):(h.removeClass(s).addClass(t),d._hideResizeIndicator(g)),e){var i=d._sheet,j=$(d._floatingObjectContentDiv).children()[0];i._trigger(a.Events.CustomFloatingObjectLoaded,{sheet:i,sheetName:i._name,customFloatingObject:d._floatingObject,element:j})}},d.prototype.setFloatingObjectZIndex=function(a){$(this._floatingObjectContainerDiv).css("z-index",a)},d.prototype.getFloatingObjectZIndex=function(){var a=parseInt($(this._floatingObjectContainerDiv).css("z-index"));return isNaN(a)?-1:a},d.prototype._paintImage=function(){var d=this,e=d._floatingObject,f=e.src(),g=e.pictureStretch(),h=a._ThemeContext.getColor(e.owner(),e.backColor());if(f&&d._floatingObjectContentDiv){var i=$(d._floatingObjectContentDiv);if(d._srcCache!==f&&(d._srcCache=f,i.css("background-image","url('"+f+"')").css("background-repeat","no-repeat")),i.css("background-color",h),g!==b&&g!==c&&e._isImageLoaded){var j=e.getOriginalWidth(),k=e.getOriginalHeight(),l=i.width(),m=i.height();a.util._applyBackgroundImageLayout(d._floatingObjectContentDiv,l,m,j,k,g)}}},d.prototype._applyBorderStyle=function(b,c){var d=this._borderDiv,e=this._floatingObject,g=e.borderWidth(),h=e.borderStyle(),i=a._ThemeContext.getColor(e.owner(),e.borderColor()),j=e.borderRadius(),k=0;e._isBorderStyleWork(h)||(g=0),l>g&&(k=l-g);var m=k,n=k,o=k,p=k,q=f(g,l);b.x<0?m+=b.x-q:(m+=b.x<q?b.x-q:0,p=c.width-m-b.width-2-2*g),b.y<0?n+=b.y-q:(n+=b.y<q?b.y-q:0,o=c.height-n-b.height-2-2*g),$(d).css({position:"absolute",left:m,top:n,bottom:o,right:p,"border-width":g,"border-style":h,"border-color":i,"border-radius":j})},d.prototype._dispose=function(){var a=this;a._touchManager&&a._touchManager.detach(),a._floatingObjectContainerDiv&&($(a._floatingObjectContainerDiv).remove(),a._floatingObjectContainerDiv=b),a._moveResizeContainerDiv&&($(a._moveResizeContainerDiv).remove(),a._moveResizeContainerDiv=b)},d.prototype._showResizeIndicator=function(a){var b=$(C,a);b.removeClass(v);var c=this,d=c._getHTMLElementBounds(c._floatingObjectContainerDiv),e=c._floatingObjectContentDiv,f=c._floatingObject;c._borderDiv&&(e=c._borderDiv);var g=c._getHTMLElementBounds(e),h=g.x,i=g.y,j=d.height-g.y-g.height,k=d.width-g.x-g.width,m=0,n=2*l+1;if("function"==typeof f.borderWidth){var o=f.borderWidth(),p=f.borderStyle();f._isBorderStyleWork(p)||(o=0),o>=l&&(m=o-l),j=d.height-i-g.height-o,k=d.width-h-g.width-o,h+=o,i+=o}h>0?(i>0?$(D,c._floatingObjectContainerDiv).css({top:m,left:m}).addClass(u):c._resizeIndicatorUnselect(D),d.height>0?$(E,c._floatingObjectContainerDiv).css({left:m,top:(g.height-n)/2+i}).addClass(u):c._resizeIndicatorUnselect(E),j>0?$(F,c._floatingObjectContainerDiv).css({left:m,bottom:m}).addClass(u):c._resizeIndicatorUnselect(F)):(c._resizeIndicatorUnselect(D),c._resizeIndicatorUnselect(E),c._resizeIndicatorUnselect(F)),i>0?$(G,c._floatingObjectContainerDiv).css({top:m,left:(g.width-n)/2+h}).addClass(u):c._resizeIndicatorUnselect(G),j>0?$(H,c._floatingObjectContainerDiv).css({left:(g.width-n)/2+h,bottom:m}).addClass(u):c._resizeIndicatorUnselect(H),k>0?(i>0?$(I,c._floatingObjectContainerDiv).css({right:m,top:m}).addClass(u):c._resizeIndicatorUnselect(I),d.height>0?$(J,c._floatingObjectContainerDiv).css({top:(g.height-n)/2+i,right:m}).addClass(u):c._resizeIndicatorUnselect(J),j>0?$(K,c._floatingObjectContainerDiv).css({right:m,bottom:m}).addClass(u):c._resizeIndicatorUnselect(K)):(c._resizeIndicatorUnselect(I),c._resizeIndicatorUnselect(J),c._resizeIndicatorUnselect(K))},d.prototype._resizeIndicatorUnselect=function(a){$(a,this._floatingObjectContainerDiv).removeClass(u).addClass(v)},d.prototype._hideResizeIndicator=function(a){$(C,a).removeClass(u).addClass(v)},d.prototype._createFloatingObjectContainer=function(){var b=document.createElement("div"),c=$(b),d=this;return d._renderManager.reduceZIndex(),c.addClass(y).addClass(w).css("z-index",m).bind("mousedown",function(a){d._doMouseDown(a)}).bind("mousemove",function(a){d._doMouseMove(a)}).bind("mouseup",function(a){d._doMouseUp(a)}),b.addEventListener("mousewheel",function(a){d._doMouseWheel(a)},!1),b.addEventListener("DOMMouseScroll",function(a){d._doMouseWheel(a)},!1),c.append($(L)),a.features.touch&&(d._touchManager=new a.FloatingObjectTouchManager(b,d,d._sheet.parent._touchEventProvider),d._touchManager.attach()),b},d.prototype._createMoveResizeContainer=function(){var a=this;if(a._floatingObjectContainerDiv&&a._layout&&!a._moveResizeDiv){a._moveResizeContainerDiv=document.createElement("div"),a._moveResizeDiv=document.createElement("div"),a._attachedMoveResizeDivDict={};for(var b=a._renderManager._containerArray.length,c=0;b>c;c++){var d=a._renderManager._containerArray[c],e=d._floatingObject;e&&e.name()!==a._floatingObject.name()&&e.isSelected()&&!a._attachedMoveResizeDivDict[e.name()]&&(a._attachedMoveResizeDivDict[e.name()]={offsetX:d._layout.x-a._layout.x,offsetY:d._layout.y-a._layout.y,height:d._layout.height,width:d._layout.width,moveResizeDiv:document.createElement("div")})}var f=a._getViewportRect(a._rowViewportIndex,a._columnViewportIndex),g=$(a._moveResizeContainerDiv);g.addClass(z).css("z-index",n).css({top:f.y,left:f.x,width:f.width,height:f.height}).bind("mousemove",function(b){a._doMouseMove(b)}).bind("mouseup",function(b){a._doMouseUp(b)});var h=a._layout.y-f.y,i=a._layout.x-f.x;a._attachMoveResizeDivToContainer(a._moveResizeDiv,a._moveResizeContainerDiv,i,h,a._layout.width,a._layout.height);for(var j in a._attachedMoveResizeDivDict){var k=a._attachedMoveResizeDivDict[j];a._attachMoveResizeDivToContainer(k.moveResizeDiv,a._moveResizeContainerDiv,i+k.offsetX,h+k.offsetY,k.width,k.height)}a._containerDiv&&$(a._containerDiv).append(a._moveResizeContainerDiv)}},d.prototype._handleDocumentMouseMove=function(){var a=this;a._isMouseCapture||($(document).bind("mousemove.gcSheet",function(b){a._doMouseMove(b)}),$(document).bind("mouseup.gcSheet",function(b){a._doMouseUp(b)}),a._isMouseCapture=!0)},d.prototype._unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,$(document).unbind("mousemove.gcSheet"),$(document).unbind("mouseup.gcSheet"))},d.prototype._doMouseDown=function(b){var c=this,d=c._sheet;if((!d.isProtected||!c._floatingObject.isLocked())&&d.endEdit()){if(c._touchManager&&!b.isTouch&&c._touchManager.preProcessMouseDown(b))return void a.util.cancelDefault(b);if(0===b.button||2===b.button){if(b.ctrlKey||b.shiftKey?c._floatingObject.isSelected()?c._floatingObject.isSelected(!1):(c._floatingObject.isSelected(!0),window.gcGlobal.activeElement=d):c._floatingObject.isSelected()||(d.unSelectAllFloatingObjects(),c._floatingObject.isSelected(!0),window.gcGlobal.activeElement=d),d._commentManager&&d._commentManager.deactivateComment(),d._saveAndClearSheetSelections(),2===b.button)return;var e=d._eventHandler,f=e._getCanvasOffset();if(c._mouseLeftButtonDownPosition=new a.Point(b.pageX-f.left,b.pageY-f.top),c._mousePosition=c._mouseLeftButtonDownPosition,c._isMouseLeftButtonDown=!0,c._mouseDownHittestInfo=c._hitTest(c._mousePosition.x,c._mousePosition.y),c._mouseDownHittestInfo.inMoving)c._moveInfo={},c._moveInfo.startTopRow=d.getViewportTopRow(c._rowViewportIndex),c._moveInfo.startLeftColumn=d.getViewportLeftColumn(c._columnViewportIndex);else{c._createMoveResizeContainer();{$(c._moveResizeDiv)}c._resizeInfo={};var g=c._getHTMLElementBounds(c._moveResizeDiv);c._resizeInfo.startX=g.x,c._resizeInfo.startY=g.y,c._resizeInfo.startWidth=g.width,c._resizeInfo.startHeight=g.height,c._resizeInfo.startTopRow=d.getViewportTopRow(c._rowViewportIndex),c._resizeInfo.startLeftColumn=d.getViewportLeftColumn(c._columnViewportIndex)}c._handleDocumentMouseMove();var h=d.hitTest(c._mousePosition.x,c._mousePosition.y);e.startHitInfo={scrollRowViewportIndex:h.rowViewportIndex,scrollColViewportIndex:h.colViewportIndex,hitTestType:h.hitTestType},e.mousePosition=c._mousePosition,e.startScroll(),e.isFloatingObjectWorking=!0}return b.stopPropagation(),!1}},d.prototype._doMouseMove=function(b){var c=this,d=c._sheet;if(!d.isProtected||!c._floatingObject.isLocked()){if(c._touchManager&&!b.isTouch&&c._touchManager.preProcessMouseMove(b))return void a.util.cancelDefault(b);if(d._isMouseDownInSheet){if(c._floatingObjectContainerDiv){var e=$(c._floatingObjectContainerDiv);e.css("cursor","default")}return!0}var f=d._eventHandler,g=f._getCanvasOffset(),h=new a.Point(b.pageX-g.left,b.pageY-g.top);return c._isMouseLeftButtonDown?($(c._moveResizeContainerDiv).css("cursor",$(c._floatingObjectContainerDiv).css("cursor")),c._mouseDownHittestInfo.inMoving?(c._isMoving=!0,c._createMoveResizeContainer(),c._doMoveContainer(c._mousePosition,h)):(c._isResizing=!0,c._doResizeContainer(c._mousePosition,c._mouseDownHittestInfo)),c._mousePosition=h,f.mousePosition=h,f.continueScroll(),$(document.body).addClass(w)):c._updateCursor(h),b.stopPropagation(),!1}},d.prototype._doMouseUp=function(c){var d=this,e=d._sheet,f=e._eventHandler;if(e.isProtected&&d._floatingObject.isLocked())return void a.util.cancelDefault(c);if(!d._touchManager||c.isTouch||!d._touchManager.preProcessMouseUp(c)){if(e._isMouseDownInSheet){if(d._floatingObjectContainerDiv){var g=$(d._floatingObjectContainerDiv);g.css("cursor","move")}return!0}f.isFloatingObjectWorking=!1,f.stopScroll();var h=f._getCanvasOffset(),i=new a.Point(c.pageX-h.left,c.pageY-h.top);return d._mouseDownHittestInfo&&(d._mouseDownHittestInfo.inMoving&&d._isMoving?c.ctrlKey?d._doCopyFloatingObject(d._mouseLeftButtonDownPosition,i):d._doMoveFloatingObject(d._mouseLeftButtonDownPosition,i):d._isResizing&&d._doResizeFloatingObject(),$(document.body).removeClass(w)),d._resizeInfo=b,d._moveInfo=b,d._attachedMoveResizeDivDict=b,$(d._moveResizeContainerDiv).remove(),d._moveResizeDiv=b,d._isMouseLeftButtonDown=!1,d._unhandleDocumentMouseMove(),d._isMoving=!1,d._isResizing=!1,c.stopPropagation(),!1}},d.prototype._doMouseWheel=function(b){var c=this._sheet;if(c){b=b?b:window.event;var d=b.detail?b.detail:b.wheelDelta/-40;return c._eventHandler.doMouseWheel(b,parseInt(d,10)),a.util.cancelDefault(b),!1}},d.prototype._doCopyFloatingObject=function(b,c){var d=this,e=d._sheet;if(d._moveInfo){var f=d._getTwoRowDistance(d._moveInfo.startTopRow,e.getViewportTopRow(d._rowViewportIndex)),g=d._getTwoColumnDistance(d._moveInfo.startLeftColumn,e.getViewportLeftColumn(d._columnViewportIndex)),h=c.x-b.x+(c.x>b.x?g:-1*g),i=c.y-b.y+(c.y>b.y?f:-1*f),j=[];j.push(d._floatingObject.name());for(var k in d._attachedMoveResizeDivDict)j.push(k);
var l=new a.UndoRedo.DragCopyFloatingObjectUndoAction(e,{names:j},{offsetX:h,offsetY:i});e._doCommand(l)}},d.prototype._doMoveFloatingObject=function(b,c){var d=this,e=d._sheet;if(d._moveInfo){var f=d._getTwoRowDistance(d._moveInfo.startTopRow,e.getViewportTopRow(d._rowViewportIndex)),g=d._getTwoColumnDistance(d._moveInfo.startLeftColumn,e.getViewportLeftColumn(d._columnViewportIndex)),h=c.x-b.x+(c.x>b.x?g:-1*g),i=c.y-b.y+(c.y>b.y?f:-1*f);h/=e._zoomFactor,i/=e._zoomFactor;var j=[];j.push(d._floatingObject.name());for(var k in d._attachedMoveResizeDivDict)j.push(k);var l=new a.UndoRedo.MovingFloatingObjectUndoAction(e,{names:j},{offsetX:h,offsetY:i});e._doCommand(l)}},d.prototype._doResizeFloatingObject=function(){var b=this,c=b._sheet,d=c._zoomFactor;if(b._resizeInfo){var e=b._getTwoRowDistance(b._resizeInfo.startTopRow,c.getViewportTopRow(b._rowViewportIndex)),f=b._getTwoColumnDistance(b._resizeInfo.startLeftColumn,c.getViewportLeftColumn(b._columnViewportIndex)),g=b._resizeInfo.endX-b._resizeInfo.startX+(b._resizeInfo.endX>b._resizeInfo.startX?f:-1*f);g/=d;var h=b._resizeInfo.endY-b._resizeInfo.startY+(b._resizeInfo.endY>b._resizeInfo.startY?e:-1*e);h/=d;var i=(b._resizeInfo.endWidth+f)/d-b._floatingObject.width(),j=(b._resizeInfo.endHeight+e)/d-b._floatingObject.height(),k=[];k.push(b._floatingObject.name());for(var l in b._attachedMoveResizeDivDict)k.push(l);var m=new a.UndoRedo.ResizingFloatingObjectUndoAction(c,{names:k},{offsetX:g,offsetY:h,offsetWidth:i,offsetHeight:j});c._doCommand(m)}},d.prototype._doMoveContainer=function(a,b){var c=this;if(c._moveResizeDiv){var d=($(c._moveResizeDiv),b.x-a.x),e=b.y-a.y;c._doMoveContainerImp(c._moveResizeDiv,d,e);for(var f in c._attachedMoveResizeDivDict){var g=c._attachedMoveResizeDivDict[f];c._doMoveContainerImp(g.moveResizeDiv,d,e)}}},d.prototype._doMoveContainerImp=function(a,b,c){var d=$(a),e=d.position();d.css({top:e.top+c,left:e.left+b})},d.prototype._doResizeContainer=function(b,c){if(c){var d,e=this,f=e._getViewportRect(e._rowViewportIndex,e._columnViewportIndex);b=new a.Point(b.x-f.x,b.y-f.y),c.inTopNWSEResizing?d=e._getFloatingObjectTopLeftResizingRect(b):c.inTopNSResizing?d=e._getFloatingObjectTopCenterResizingRect(b):c.inTopNESWResizing?d=e._getFloatingObjectTopRightResizingRect(b):c.inLeftWEResizing?d=e._getFloatingObjectMiddleLeftResizingRect(b):c.inRightWEResizing?d=e._getFloatingObjectMiddleRightResizingRect(b):c.inBottomNESWResizing?d=e._getFloatingObjectBottomLeftResizingRect(b):c.inBottomNSReszing?d=e._getFloatingObjectBottomCenterResizingRect(b):c.inBottomNWSEReszing&&(d=e._getFloatingObjectBottomRightResizingRect(b)),e._resizeInfo.endX=d.x,e._resizeInfo.endY=d.y,e._resizeInfo.endWidth=d.width,e._resizeInfo.endHeight=d.height;var g=($(e._moveResizeDiv),e._getHTMLElementBounds(e._moveResizeDiv)),h=d.y-g.y,i=d.x-g.x,j=d.width-g.width,k=d.height-g.height;e._doResizeContainerImp(e._moveResizeDiv,i,h,j,k);for(var l in e._attachedMoveResizeDivDict){var m=e._attachedMoveResizeDivDict[l];e._doResizeContainerImp(m.moveResizeDiv,i,h,j,k)}}},d.prototype._doResizeContainerImp=function(a,b,c,d,e){var f=$(a),g=this._getHTMLElementBounds(a);f.css({top:g.y+c,left:g.x+b,width:g.width+d,height:g.height+e})},d.prototype._attachMoveResizeDivToContainer=function(a,b,c,d,e,f){$(a).addClass(A).css({top:d-1,left:c-1,width:e,height:f}).appendTo(b)},d.prototype._getHTMLElementBounds=function(b){var c=$(b),d=c.position();return new a.Rect(d.left,d.top,c.width(),c.height())},d.prototype._updateCursor=function(a){var c=this;if(c._floatingObjectContainerDiv){var d,e=$(c._floatingObjectContainerDiv),f=c._hitTest(a.x,a.y);f!==b&&(d=f.inTopNWSEResizing?"nw-resize":f.inTopNSResizing?"n-resize":f.inTopNESWResizing?"ne-resize":f.inLeftWEResizing?"w-resize":f.inRightWEResizing?"w-resize":f.inBottomNESWResizing?"sw-resize":f.inBottomNSReszing?"n-resize":f.inBottomNWSEReszing?"se-resize":"move",e.css("cursor",d))}},d.prototype._getFloatingObjectTopLeftResizingRect=function(b){var c=this,d=g(c._resizeInfo.startX+c._resizeInfo.startWidth,b.x),e=g(c._resizeInfo.startY+c._resizeInfo.startHeight,b.y),f=h(b.x-c._resizeInfo.startX-c._resizeInfo.startWidth),i=h(b.y-c._resizeInfo.startY-c._resizeInfo.startHeight);return new a.Rect(d,e,f,i)},d.prototype._getFloatingObjectTopCenterResizingRect=function(b){var c=this,d=c._resizeInfo.startX,e=g(c._resizeInfo.startY+c._resizeInfo.startHeight,b.y),f=h(b.y-c._resizeInfo.startY-c._resizeInfo.startHeight),i=c._resizeInfo.startWidth;return new a.Rect(d,e,i,f)},d.prototype._getFloatingObjectTopRightResizingRect=function(b){var c=this,d=g(c._resizeInfo.startX,b.x),e=g(c._resizeInfo.startY+c._resizeInfo.startHeight,b.y),f=h(b.x-c._resizeInfo.startX),i=h(b.y-c._resizeInfo.startY-c._resizeInfo.startHeight);return new a.Rect(d,e,f,i)},d.prototype._getFloatingObjectMiddleLeftResizingRect=function(b){var c=this,d=g(c._resizeInfo.startX+c._resizeInfo.startWidth,b.x),e=c._resizeInfo.startY,f=h(b.x-c._resizeInfo.startX-c._resizeInfo.startWidth),i=c._resizeInfo.startHeight;return new a.Rect(d,e,f,i)},d.prototype._getFloatingObjectMiddleRightResizingRect=function(b){var c=this,d=g(c._resizeInfo.startX,b.x),e=c._resizeInfo.startY,f=h(b.x-c._resizeInfo.startX),i=c._resizeInfo.startHeight;return new a.Rect(d,e,f,i)},d.prototype._getFloatingObjectBottomLeftResizingRect=function(b){var c=this,d=g(c._resizeInfo.startX+c._resizeInfo.startWidth,b.x),e=g(c._resizeInfo.startY,b.y),f=h(b.x-c._resizeInfo.startX-c._resizeInfo.startWidth),i=h(b.y-c._resizeInfo.startY);return new a.Rect(d,e,f,i)},d.prototype._getFloatingObjectBottomCenterResizingRect=function(b){var c=this,d=c._resizeInfo.startX,e=g(c._resizeInfo.startY,b.y),f=h(b.y-c._resizeInfo.startY),i=c._resizeInfo.startWidth;return new a.Rect(d,e,i,f)},d.prototype._getFloatingObjectBottomRightResizingRect=function(b){var c=this,d=g(c._resizeInfo.startX,b.x),e=g(c._resizeInfo.startY,b.y),f=h(b.x-c._resizeInfo.startX),i=h(b.y-c._resizeInfo.startY);return new a.Rect(d,e,f,i)},d.prototype._getViewportRect=function(a,b){var c,d,e,f,g,h=this,i=h._sheet,k=i._getSheetLayout(),l=k.viewportRect(a,b),m=h._floatingObject,n=m.startRow(),o=m.startColumn(),p=m.endRow(),q=m.endColumn(),r=i.frozenRowCount,s=i.frozenColCount,t=i.getRowCount(3)-i.getFrozenTrailingRowCount()-1,u=i.getColumnCount(3)-i.getFrozenTrailingColumnCount()-1;return a===j?(r>0&&(c=i.getViewportTopRow(a),(r>n||c===r)&&(l.y-=k.frozenHeight,l.height+=k.frozenHeight)),i._frozenTrailingRowCount>0&&(d=i.getViewportBottomRow(a),p>t&&d===t&&(l.height+=k.frozenTrailingHeight))):a===j-1?(c=i.getViewportTopRow(a+1),(p>=c||c===r)&&(g=k.viewportRect(a+1,b),l.height+=g.height)):a===j+1&&(d=i.getViewportBottomRow(a-1),(d>=n||d===t)&&(g=k.viewportRect(a-1,b),l.y=g.y,l.height+=g.height)),b===j?(s>0&&(e=i.getViewportLeftColumn(b),(s>o||e===s)&&(l.x-=k.frozenWidth,l.width+=k.frozenWidth)),i._frozenTrailingColCount>0&&(f=i.getViewportRightColumn(b),(q>u||f===u)&&(l.width+=k.frozenTrailingWidth))):b===j-1?(e=i.getViewportLeftColumn(b+1),(q>=e||e===s)&&(g=k.viewportRect(a,b+1),l.width+=g.width)):b===j+1&&(f=i.getViewportRightColumn(b-1),(f>=o||f===u)&&(g=k.viewportRect(a,b-1),l.x=g.x,l.width+=g.width)),l},d.prototype._getTwoColumnDistance=function(a,b){for(var c=g(a,b),d=f(a,b),e=0,h=c;d>h;h++)e+=this._sheet.getColumnWidth(h,3);return e},d.prototype._getTwoRowDistance=function(a,b){for(var c=g(a,b),d=f(a,b),e=0,h=c;d>h;h++)e+=this._sheet.getRowHeight(h,3);return e},d.prototype._hitTest=function(c,d){var e=this;if(!e._layout)return b;var f={inMoving:!1,inTopNWSEResizing:!1,inTopNSResizing:!1,inTopNESWResizing:!1,inLeftWEResizing:!1,inRightWEResizing:!1,inBottomNESWResizing:!1,inBottomNSReszing:!1,inBottomNWSEReszing:!1};if(!e._floatingObject.isSelected())return f.inMoving=!0,f;var g=l,h=10,i=e._layout.x,j=e._layout.y,k=e._layout.width,m=e._layout.height;e._floatingObject&&e._floatingObject.isSelected()&&(i-=g,j-=g,k+=2*g,m+=2*g);var n=e._inflateRect(new a.Rect(i,j,g,g),h);if(n.contains(c,d))return f.inTopNWSEResizing=!0,f;var o=e._inflateRect(new a.Rect(i+k/2-g,j,2*g,g),h);if(o.contains(c,d))return f.inTopNSResizing=!0,f;var p=e._inflateRect(new a.Rect(i+k-g,j,g,g),h);if(p.contains(c,d))return f.inTopNESWResizing=!0,f;var q=e._inflateRect(new a.Rect(i,j+m/2-g,g,2*g),h);if(q.contains(c,d))return f.inLeftWEResizing=!0,f;var r=e._inflateRect(new a.Rect(i+k-g,j+m/2-g,g,2*g),h);if(r.contains(c,d))return f.inRightWEResizing=!0,f;var s=e._inflateRect(new a.Rect(i,j+m-g,g,g),h);if(s.contains(c,d))return f.inBottomNESWResizing=!0,f;var t=e._inflateRect(new a.Rect(i+k/2-g,j+m-g,2*g,g),h);if(t.contains(c,d))return f.inBottomNSReszing=!0,f;var u=e._inflateRect(new a.Rect(i+k-g,j+m-g,g,g),h);return u.contains(c,d)?(f.inBottomNWSEReszing=!0,f):(f.inMoving=!0,f)},d.prototype._inflateRect=function(b,c){var d=b.x-c,e=b.y-c,f=b.width+2*c,g=b.height+2*c;return new a.Rect(d,e,f>=0?f:0,g>=0?g:0)},d}();a._FloatingObjectRender=Q;var R=function(){function c(a){this._sheet=a,this._containerArray=new T}return c.prototype._dispose=function(){for(var a=this._containerArray.length,b=0;a>b;b++)this._containerArray[b]._dispose();this._containerArray.length=0},c.prototype._render=function(c,d,e){if(!(0>c||0>d)){var g,h,i=this,j=i._createViewportFloatingObjectLayoutModel(c,d,e),k=[];for(g=0,h=i._containerArray.length;h>g;g++)j.find(i._containerArray[g].name)||k.push(i._containerArray[g]);for(g=0,h=k.length;h>g;g++){var m=k[g];m._renderManager=b,i._containerArray.remove(m.name),m._dispose()}for(g=0;g<j.length;g++){var n=j[g],o=i._sheet._findFloatingObjectInternal(n.name),p=l;if(o&&"function"==typeof o.borderWidth){var q=o.borderWidth(),r=o.borderStyle();o._isBorderStyleWork(r)||(q=0),q>p&&(p=q)}var s=i._getViewportRect(c,d),t=1,u=n.x-p-t,v=n.y-p-t,w=n.width+2*p+2*t,x=n.height+2*p+2*t,y=f(s.y,v),z=f(s.x,u),A=x,B=w,C=p+t,D=p+t,E=-1*p-t;0>=v&&(C+=E>v?E:v),0>=u&&(D+=E>u?E:u),C=v-y+C,D=u-z+D,0>=C?(A+=C,A+=E):p>C&&C>0&&(A-=p-C),0>=D?(B+=D,B+=E):p>D&&D>0&&(B-=p-D);var F=i._containerArray.find(n.name);F||(F=new Q(i._sheet._findFloatingObjectInternal(n.name),i._sheet),F._renderManager=i,i._containerArray.push(F)),F._layout=n,F._rowViewportIndex=c,F._columnViewportIndex=d;var G=new a.Rect(s.x,s.y,s.width,s.height);F.render(new a.Rect(z,y,B,A).getIntersectRect(G)||new a.Rect(z,y,0,0),new a.Rect(D,C,n.width,n.height))}}},c.prototype.setFloatingObjectZIndex=function(a,b){var c=this._containerArray.find(a);c&&c.setFloatingObjectZIndex(b)},c.prototype.getFloatingObjectZIndex=function(a){var b=this._containerArray.find(a);return b?b.getFloatingObjectZIndex():-1},c.prototype.reduceZIndex=function(){for(var a=this._containerArray,b=0,c=a.length;c>b;b++){var d=a[b],e=d.getFloatingObjectZIndex();-1!==e&&d.setFloatingObjectZIndex(e-1)}},c.prototype._getViewportRect=function(b,c){var d=this._sheet,e=d._getViewportColumnLayout(c),f=0,g=0,h=0,i=0;if(e&&e.length>0){var j=e[0],k=e[e.length-1];f=j.x,h=k.x+k.width-f}var l=d._getViewportRowLayout(b);if(l&&l.length>0){var m=l[0],n=l[l.length-1];g=m.y,i=n.y+n.height-g}var o=d._getSheetLayout(),p=o.viewportRect(b,c);return f=p.x<f?f:p.x,g=p.y<g?g:p.y,h=p.width<h?p.width:h,i=p.height<i?p.height:i,new a.Rect(f,g,h,i)},c.prototype._createViewportFloatingObjectLayoutModel=function(a,b,c){var d=this,f=d._sheet,g=new T,h=f._floatingObjectArray.length;if(0===f._floatingObjectArray.length)return g;for(var i=(f._getSheetLayout(),d._getViewportRect(a,b)),j=d._getViewportTopLeftCoordinates(a,b,c),k=0;h>k;k++){var l=f._floatingObjectArray[k];if(l.isVisible()){for(var m=0,n=0;n<l.startColumn();n++)m+=e(f.getColumnWidth(n,3)*c);m+=l.startColumnOffset()*c;for(var o=0,p=0;p<l.startRow();p++)o+=e(f.getRowHeight(p,3)*c);o+=l.startRowOffset()*c;var q=e(l.width()*c),r=e(l.height()*c);m-=j.x,o-=j.y,m+=i.x,o+=i.y,g.push(new S(l.name(),m,o,q,r))}}return g},c.prototype._getViewportTopLeftCoordinates=function(b,c,d){for(var f=this,g=f._sheet,h=(g._getSheetLayout(),g.getViewportTopRow(b)),i=0,j=0;h>j;j++)i+=e(g.getRowHeight(j,3)*d);for(var k=g.getViewportLeftColumn(c),l=0,m=0;k>m;m++)l+=e(g.getColumnWidth(m,3)*d);return new a.Point(l,i)},c}();a._FloatingObjectRenderManager=R;var S=function(){function a(a,b,c,d,e){var f=this;f.name=a,f.x=b,f.y=c,f.height=e,f.width=d}return a}();a._FloatingObjectLayout=S;var T=function(a){function c(){a.call(this)}return __extends(c,a),c.prototype.remove=function(a){for(var b=0;b<this.length;b++)if(this[b].name===a)return void this.splice(b,1)},c.prototype.find=function(a){for(var c=0;c<this.length;c++)if(this[c].name===a)return this[c];return b},c.prototype.findByPropertyName=function(a){for(var c=0;c<this.length;c++)if(this[c]._name===a)return this[c];return b},c}(a._XArray);a._HelperArray=T}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(a){a.feature("sparklineEx",["core.theme"]);var b=null,c=Math.floor,d=Math.PI,e=Math.sin,f=Math.cos,g=Math.min,h=Math.max,i=Math.round,j=Math.pow,k=Math.sqrt,l="undefined",m=function(){function a(a,b){this.name=a,this.value=b}return a}();a.SparklineExValue=m;var n=function(){function c(){var c=this.createFunction();if(c){var d=c.name,e=c.evaluate;c.evaluate=function(a){var c=e.call(this,a);return c?new m(d,c):b},this._name=d,d&&!a.Calc.Functions.findGlobalFunction(d)&&(a.Calc.Functions._customFunctions[d]=c)}}return c.prototype.name=function(){return this._name},c.prototype.createFunction=function(){return b},c.prototype._paintSparkline=function(a,b,c,d,e,f){this.paint(a,b,c,d,e,f)},c.prototype.paint=function(){},c}();a.SparklineEx=n;var o=function(){function a(a,b){this.values=a,this.colors=b}return a}();a.PieSparklineValue=o;var p=function(h){function i(){h.call(this)}return __extends(i,h),i.prototype._getValuesFromReference=function(c){var d=[];if(c instanceof a.Calc.Reference)for(var e=c.getRangeCount(),f=0;e>f;f++)for(var g=c.getRowCount(f),h=c.getColumnCount(f),i=0;g>i;i++)for(var j=0;h>j;j++)d.push(c.getValue(f,i,j));else c!==b&&typeof c!==l&&d.push(c);return d},i.prototype.createFunction=function(){if(!a.util.hasCalc())return b;var c=new a.Calc.Functions.Function("PIESPARKLINE",1,255),d=this;return c.evaluate=function(a){var b=d._getValuesFromReference(a[0]),c=Array.prototype.slice.call(a,1);return new o(b,c)},c.acceptsReference=function(a){return 0===a},c},i.prototype._fixValues=function(a){for(var c,d=[],e=0,f=0,g=a.length;g>e;e++)c=a[e],c!==b&&typeof c!==l&&!isNaN(c)&&isFinite(c)?(0>c&&(c=-c),d[f++]=c):d[f++]=0;return 1===a.length&&1===d.length&&(d[1]=1-d[0]),d},i.prototype._fixColors=function(b,d){var e=[],f=d.length;if(f>=b)e=d.slice(0,b);else{0===f?(e.push("darkgray"),f=1):e=d.slice(0);for(var g,h,i,j,k=[],l=b-f+1,m=0;f>m;m++)k[m]=a._Color.parse(e[m]);for(var m=f;b>m;m++)g=k[m%f],h=g.r,i=g.g,j=g.b,h-=h/l*(m/f),i-=i/l*(m/f),j-=j/l*(m/f),e[m]=new a._Color(255,c(h),c(i),c(j)).toString()}return e},i.prototype.paint=function(a,b,c,h,i,j){for(var k,l=c+i/2,m=h+j/2,n=5,o=g(i,j)/2-n,p=-.5*d,q=l+o*f(p),r=m+o*e(p),s=[],t=[],u=this._fixValues(b.values),v=u.length,w=this._fixColors(v,b.colors),x=0,y=0;v>y;y++)x+=u[y];a.save();for(var y=0;v>y;y++)k=p+u[y]/x*2*d,a.beginPath(),a.moveTo(l,m),a.lineTo(q,r),a.arc(l,m,o,p,k,!1),a.lineTo(l,m),a.fillStyle=w[y],a.fill(),s.push(q),t.push(r),p=k,q=l+o*f(p),r=m+o*e(p);a.strokeStyle="white";for(var y=0;v>y;y++)a.beginPath(),a.moveTo(l,m),a.lineTo(s[y],t[y]),a.stroke();a.restore()},i}(n);a.PieSparkline=p;var q=function(){function a(a,b,c){this.x=a,this.y=b,this.value=c}return a}(),r=function(){function a(a,b,c,d,e,f,g){var h=this;h.points=a,h.mini=b,h.maxi=c,h.line1=d,h.line2=e,h.colorPositive=f,h.colorNegative=g}return a}();a.AreaSparklineValue=r;var s=function(c){function d(){c.call(this)}return __extends(d,c),d.prototype._getValuesFromReference=function(b){var c=[];if(b instanceof a.Calc.Reference)for(var d=b.getRangeCount(),e=0;d>e;e++)for(var f=b.getRowCount(e),g=b.getColumnCount(e),h=0;f>h;h++)for(var i=0;g>i;i++)c.push(b.getValue(e,h,i));return c},d.prototype.createFunction=function(){if(!a.util.hasCalc())return b;var c=new a.Calc.Functions.Function("AREASPARKLINE",1,7),d=this;return c.evaluate=function(a){var b=d._getValuesFromReference(a[0]),c=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6];return new r(b,c,e,f,g,h,i)},c.acceptsReference=function(a){return 0===a},c},d.prototype._fixValues=function(a){for(var c,d=[],e=0,f=0,g=a.length;g>e;e++)c=a[e],d[f++]=c!==b&&typeof c!==l&&!isNaN(c)&&isFinite(c)?c:0;return d},d.prototype._rangeMin=function(a){for(var b,c=a[0],d=1,e=a.length;e>d;d++)b=a[d],c>b&&(c=b);return c},d.prototype._rangeMax=function(a){for(var b,c=a[0],d=1,e=a.length;e>d;d++)b=a[d],b>c&&(c=b);return c},d.prototype._getXInStraightLine=function(a,b,c,d,e){return((b-e)*c+(e-d)*a)/(b-d)},d.prototype.paint=function(a,c,d,e,f,j){a.save();var k,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D=this,E=c.points,F=c.mini,G=c.maxi,H=c.line1,I=c.line2,J=c.colorPositive,K=c.colorNegative,L=5;E=D._fixValues(E),(J===b||typeof J===l)&&(J="#787878"),(K===b||typeof K==l)&&(K="#CB0000"),n=D._rangeMin(E),(F===b||typeof F===l)&&(F=n),p=g(F,n),o=D._rangeMax(E),(G===b||typeof G===l)&&(G=o),r=h(G,o),u=0,p>0&&(p=0),0>r&&(r=0),u>r&&(u=r),p>u&&(u=p-1),v=E.length,w=d+L,x=e+L,y=f-2*L,z=j-2*L,A=y/(v-1),B=(r-p)/z;for(var M,N,O,P,Q,R,S=[],T=x+(r-u)/B,U=0;v>U;U++)M=E[U],Q=w+A*U,R=x+(r-M)/B,0===U&&S.push(new q(Q,T,u)),U>0&&M*E[U-1]<0&&(O=S[S.length-1],O&&(P=D._getXInStraightLine(O.x,O.y,Q,R,T),S.push(new q(P,T,u)))),S.push(new q(Q,R,M)),U===v-1&&S.push(new q(Q,T,u));a.beginPath();for(var V=0,W=S.length;W>V;V++)N=S[V],N&&(a.lineTo(N.x,N.y),O=S[V-1],N.value===u&&O&&(a.fillStyle=O.value>u?J:K,a.fill(),V!==W-1&&(a.beginPath(),a.lineTo(N.x,N.y))));(H!==b||typeof H===l)&&(s=H,s>r&&(s=r),p>s&&(s=p),C=0!==B?(r-s)/B:z/2,k=i(x+C)-.5,a.beginPath(),a.moveTo(w,k),a.lineTo(w+y,k),a.strokeStyle="blue",a.stroke()),(I!==b||typeof I===l)&&(t=I,t>r&&(t=r),p>t&&(t=p),C=0!==B?(r-t)/B:z/2,m=i(x+C)-.5,a.beginPath(),a.moveTo(w,m),a.lineTo(w+y,m),a.strokeStyle="blue",a.stroke()),a.restore()},d}(n);a.AreaSparkline=s;var t=function(){function a(a,b){this.x=a,this.y=b}return a}(),u=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=this;s.points1=a,s.points2=b,s.minX=c,s.maxX=d,s.minY=e,s.maxY=f,s.hLine=g,s.vLine=h,s.xMinZone=i,s.xMaxZone=j,s.yMinZone=k,s.yMaxZone=l,s.tags=m,s.drawSymbol=n,s.drawLines=o,s.color1=p,s.color2=q,s.dash=r}return a}();a.ScatterSparklineValue=u;var v=function(c){function e(){c.call(this)}return __extends(e,c),e.prototype._getValuesFromReference=function(b){var c=[];if(b instanceof a.Calc.Reference){var d=b.getRangeCount();if(d>0)for(var e=b.getRowCount(0),f=b.getColumnCount(0),g=0;e>g;g++){c[g]=[];for(var h=0;f>h;h++)c[g].push(b.getValue(0,g,h))}}return c},e.prototype.createFunction=function(){if(!a.util.hasCalc())return b;var c=new a.Calc.Functions.Function("SCATTERSPARKLINE",1,18),d=this;return c.evaluate=function(a){var b=d._getValuesFromReference(a[0]),c=d._getValuesFromReference(a[1]),e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=a[9],m=a[10],n=a[11],o=a[12],p=a[13],q=a[14],r=a[15],s=a[16],t=a[17];return new u(b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t)},c.acceptsReference=function(a){return 0===a||1===a},c},e.prototype._getScatterPoints=function(a){var b,c,d=[];if(b=a.length,b>0)if(c=a[0].length,c>b){if(b>=2)for(var e=0;c>e;e++)d.push(new t(a[0][e],a[1][e]))}else if(c>=2)for(var f=0;b>f;f++)d.push(new t(a[f][0],a[f][1]));return d},e.prototype._getMinScatterPoint=function(a){for(var b,c=new t(Number.MAX_VALUE,Number.MAX_VALUE),d=a.length,e=0;d>e;e++)b=a[e],c.x>b.x&&(c.x=b.x),c.y>b.y&&(c.y=b.y);return c},e.prototype._getMaxScatterPoint=function(a){for(var b,c=new t(-Number.MAX_VALUE,-Number.MAX_VALUE),d=a.length,e=0;d>e;e++)b=a[e],c.x<b.x&&(c.x=b.x),c.y<b.y&&(c.y=b.y);return c},e.prototype._getXInStraightLine=function(a,b,c,d){return c/d*(b-a)+a},e.prototype._paintLine=function(a,b,c,d,e,f,g){if(g){var h,i,l,m,n=this,o=k(j(d-b,2)+j(e-c,2)),p=0,q=6,r=2,s=4,u=[];d>=b?(h=b,i=d,l=b,m=c):(h=d,i=b,l=d,m=e);var v=(e-c)/(d-b),w=c-v*b;for(u.push(new t(l,m));o>p;)p+=q,o>=p&&(l=n._getXInStraightLine(h,i,p,o),m=v*l+w,u.push(new t(l,m))),p+=s,o>=p&&(l=n._getXInStraightLine(h,i,p,o),m=v*l+w,u.push(new t(l,m))),p+=r,o>=p&&(l=n._getXInStraightLine(h,i,p,o),m=v*l+w,u.push(new t(l,m))),p+=s,o>=p&&(l=n._getXInStraightLine(h,i,p,o),m=v*l+w,u.push(new t(l,m)));a.strokeStyle=f;for(var x,y=0,z=u.length;z-1>y;y+=2)a.beginPath(),x=u[y],a.moveTo(x.x,x.y),x=u[y+1],a.lineTo(x.x,x.y),a.stroke()}else a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.strokeStyle=f,a.stroke()},e.prototype.paint=function(a,c,e,f,i,j){var k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=c.points1,J=c.points2,K=c.minX,L=c.maxX,M=c.minY,N=c.maxY,O=c.hLine,P=c.vLine,Q=c.xMinZone,R=c.xMaxZone,S=c.yMinZone,T=c.yMaxZone,U=c.tags,V=c.drawSymbol,W=c.drawLines,X=c.color1,Y=c.color2,Z=c.dash,$=4,_=5,ab=e+_,bb=f+_,cb=i-2*_,db=j-2*_;if(!(!I||I.length<=0||(k=H._getScatterPoints(I),k.length<=0||J&&J.length>0&&(m=H._getScatterPoints(J),m.length<=0)))){if(a.save(),a.rect(e,f,i,j),a.clip(),a.beginPath(),(V===b||typeof V===l)&&(V=!0),(X===b||typeof X===l)&&(X="#969696"),(Y===b||typeof Y===l)&&(Y="#CB0000"),n=M!==b&&typeof M!==l?M:H._getMinScatterPoint(k).y,o=N!==b&&typeof N!==l?N:H._getMaxScatterPoint(k).y,p=K!==b&&typeof K!==l?K:H._getMinScatterPoint(k).x,q=L!==b&&typeof L!==l?L:H._getMaxScatterPoint(k).x,p>=q&&(q=p+1),n>=o&&(o=n+1),Q!==b&&typeof Q!==l&&R!==b&&typeof R!==l&&S!==b&&typeof S!==l&&T!==b&&typeof T!==l&&Q>=p&&q>=Q&&R>=p&&q>=R&&S>=n&&o>=S&&T>=n&&o>=T){var eb=h(p,Q),fb=g(q,R),gb=h(n,S),hb=g(o,T);eb>=fb&&(fb=eb+1),gb>=hb&&(hb=gb+1),a.beginPath(),a.fillStyle="#DCDCDC",a.fillRect(ab+(eb-p)*cb/(q-p),bb+(o-hb)*db/(o-n),(fb-eb)*cb/(q-p),(hb-gb)*db/(o-n))}for(C=-Number.MAX_VALUE,D=-Number.MAX_VALUE,E=Number.MAX_VALUE,F=Number.MAX_VALUE,r=0,t=k.length;t-1>r;r++)s=k[r],u=s.x,v=s.y,s=k[r+1],w=s.x,x=s.y,y=ab+(u-p)*cb/(q-p),A=ab+(w-p)*cb/(q-p),z=bb+(o-v)*db/(o-n),B=bb+(o-x)*db/(o-n),W&&H._paintLine(a,y,z,A,B,X,Z),V&&(0===r&&(a.beginPath(),a.strokeStyle=X,a.arc(y-$/2,z-$/2,$/2,0,2*d,!1),a.stroke()),a.beginPath(),a.strokeStyle=X,a.arc(A-$/2,B-$/2,$/2,0,2*d,!1),a.stroke()),U&&(0===r&&(z>D&&(C=y,D=z),F>z&&(E=y,F=z)),B>D&&(C=A,D=B),F>B&&(E=A,F=B));if(J&&J.length>0)for((M===b||typeof M===l)&&(n=H._getMinScatterPoint(m).y),(N===b||typeof N===l)&&(o=H._getMaxScatterPoint(m).y),(K===b||typeof K===l)&&(p=H._getMinScatterPoint(m).x),(L===b||typeof L===l)&&(q=H._getMaxScatterPoint(m).x),p>=q&&(q=p+1),n>=o&&(o=n+1),r=0,t=m.length;t-1>r;r++)s=m[r],u=s.x,v=s.y,s=m[r+1],w=s.x,x=s.y,y=ab+(u-p)*cb/(q-p),A=ab+(w-p)*cb/(q-p),z=bb+(o-v)*db/(o-n),B=bb+(o-x)*db/(o-n),W&&H._paintLine(a,y,z,A,B,Y,Z),V&&(0===r&&(a.beginPath(),a.strokeStyle=Y,a.strokeRect(y-$/2,z-$/2,$,$)),a.beginPath(),a.strokeStyle=Y,a.strokeRect(A-$/2,B-$/2,$,$));U&&(a.beginPath(),a.arc(C-$/2,D-$/2,$/2,0,2*d,!1),a.fillStyle="#CB0000",a.fill(),a.beginPath(),a.arc(E-$/2,F-$/2,$/2,0,2*d,!1),a.fillStyle="#0000FF",a.fill()),O!==b&&typeof O!==l&&O>=n&&o>=O&&(G=bb+(o-O)*db/(o-n),H._paintLine(a,ab,G,ab+cb,G,"#CB0000")),P!==b&&typeof P!==l&&P>=p&&q>=P&&(G=ab+(P-p)*cb/(q-p),H._paintLine(a,G,bb,G,bb+db,"#CB0000")),a.restore()}},e}(n);a.ScatterSparkline=v;var w=function(c){function d(){c.call(this)}return __extends(d,c),d.prototype._getValuesFromReference=function(b){var c=[];if(b instanceof a.Calc.Reference){var d=b.getRangeCount();if(d>0)for(var e=b.getRowCount(0),f=b.getColumnCount(0),g=0;e>g;g++){c[g]=[];for(var h=0;f>h;h++)c[g].push(b.getValue(0,g,h))}}return c},d.prototype._parseSetting=function(a){var c={},d=!1,e=!0,f="",g="";if(a){a=a.substr(1,a.length-2);for(var h=0,i=a.length;i>h;h++){var j=a.charAt(h);":"===j?e=!1:","!==j||d?"'"===j||'"'===j||("("===j?d=!0:")"===j&&(d=!1),e?f+=j:g+=j):(c[f]=g,f="",g="",e=!0)}f&&(c[f]=g);for(var k in c){var m=c[k];m!==b&&typeof m!==l&&("TRUE"===m.toUpperCase()?c[k]=!0:"FALSE"===m.toUpperCase()?c[k]=!1:!isNaN(m)&&isFinite(m)&&(c[k]=parseFloat(m)))}}return c},d.prototype._createCustomFunction=function(c,d){var e=new a.Calc.Functions.Function(c,2,5),f=this;return e.evaluate=function(c){var e=c[0];if(e instanceof a.Calc.Reference){var g=e.getRangeCount();if(g>0){var h,i,j=new a.Range(e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0)),k=c[1],m=c[2];m instanceof a.Calc.Reference&&(g=m.getRangeCount(),g>0&&(h=new a.Range(m.getRow(0),m.getColumn(0),m.getRowCount(0),m.getColumnCount(0)),i=c[3]));var n=new a.SparklineSetting,o=c[4];if(o){var p,q=f._parseSetting(o),r={AXISCOLOR:"_axisColor",FIRSTMARKERCOLOR:"_firstMarkerColor",HIGHMARKERCOLOR:"_highMarkerColor",LASTMARKERCOLOR:"_lastMarkerColor",LOWMARKERCOLOR:"_lowMarkerColor",MARKERSCOLOR:"_markersColor",NEGATIVECOLOR:"_negativeColor",SERIESCOLOR:"_seriesColor",DISPLAYEMPTYCELLSAS:"displayEmptyCellsAs",RIGHTTOLEFT:"rightToLeft",DISPLAYHIDDEN:"displayHidden",DISPLAYXAXIS:"displayXAxis",SHOWFIRST:"_showFirst",SHOWHIGH:"_showHigh",SHOWLAST:"_showLast",SHOWLOW:"_showLow",SHOWNEGATIVE:"_showNegative",SHOWMARKERS:"_showMarkers",MANUALMAX:"manualMax",MANUALMIN:"manualMin",MAXAXISTYPE:"maxAxisType",MINAXISTYPE:"minAxisType",LINEWEIGHT:"lineWeight"};for(var s in q)s&&(p=r[s.toUpperCase()],p&&(n[p]=q[s]));var t={AC:"_axisColor",FMC:"_firstMarkerColor",HMC:"_highMarkerColor",LASTMC:"_lastMarkerColor",LOWMC:"_lowMarkerColor",MC:"_markersColor",NC:"_negativeColor",SC:"_seriesColor",DECA:"displayEmptyCellsAs",RTL:"rightToLeft",DH:"displayHidden",DXA:"displayXAxis",SF:"_showFirst",SH:"_showHigh",SLAST:"_showLast",SLOW:"_showLow",SN:"_showNegative",SM:"_showMarkers",MMAX:"manualMax",MMIN:"manualMin",MAXAT:"maxAxisType",MINAT:"minAxisType",LW:"lineWeight"};for(var s in q)s&&(p=t[s.toUpperCase()],p&&(n[p]=q[s]));1===n.maxAxisType&&(n.maxAxisType=0),1===n.minAxisType&&(n.minAxisType=0),n.rightToLeft=!!n.rightToLeft,n.displayHidden=!!n.displayHidden,n.displayXAxis=!!n.displayXAxis,n._showFirst=!!n._showFirst,n._showHigh=!!n._showHigh,n._showLast=!!n._showLast,n._showLow=!!n._showLow,n._showNegative=!!n._showNegative,n._showMarkers=!!n._showMarkers}var u=new a.SparklineValue(-1,-1,j,k,d,n);return h&&typeof i!==l&&i!==b&&(u.dateAxisData(h),u.dateAxisOrientation(i),u.group().displayDateAxis=!0),u.cachedValues=f._getValuesFromReference(e),u.cachedDatetimes=f._getValuesFromReference(m),u}}},e.acceptsReference=function(a){return 0===a||2===a},e},d.prototype._fixValues=function(c,d,e,f,g,h){var i=[],j=1===g;if(f)for(var k=0,m=j?f.colCount:f.rowCount;m>k;k++){var n=j?0:k,o=j?k:0,p=c[n][o];!e&&(d.getRowHeight(f.row+n)<=0||d.getColumnWidth(f.col+o)<=0)?p=0/0:p!==b&&typeof p!==l&&(h?p="number"==typeof p?a._DateTimeHelper.fromOADate(p):Date.parse(p):"number"!=typeof p&&(p=a.__invalidValuePlaceHolder)),i.push(p)}return i},d.prototype._paintSparkline=function(b,c,d,e,f,g,h){if(a.features.sparkline){var i=c,j=i.cachedValues,k=i.cachedDatetimes,l=h._zoomFactor,m=new a.SparklineRender(i),n=i.setting(),o=n.displayHidden;j=this._fixValues(j,h,o,i.data(),i.dataOrientation()),k=this._fixValues(k,h,o,i.dateAxisData(),i.dateAxisOrientation(),!0),n._setThemeContext(h),m._paintCore(b,d,e,f,g,j,k,l)}},d}(n);a.CompatibleSparkline=w;var x=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.createFunction=function(){return a.util.hasCalc()&&a.features.sparkline?c.prototype._createCustomFunction.call(this,"LINESPARKLINE",0):b},d}(w);a.LineSparkline=x;var y=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.createFunction=function(){return a.util.hasCalc()&&a.features.sparkline?c.prototype._createCustomFunction.call(this,"COLUMNSPARKLINE",1):b},d}(w);a.ColumnSparkline=y;var z=function(c){function d(){c.apply(this,arguments)}return __extends(d,c),d.prototype.createFunction=function(){return a.util.hasCalc()&&a.features.sparkline?c.prototype._createCustomFunction.call(this,"WINLOSSSPARKLINE",2):b},d}(w);a.WinlossSparkline=z}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("comment",["core.common","core.sheet_action"]);var b=null,c=void 0,d=Math.max,e=Math.min,f=Math.floor,g=Math.atan2,h=Math.abs;!function(a){a[a.AlwaysShown=1]="AlwaysShown",a[a.HoverShown=2]="HoverShown"}(a.DisplayMode||(a.DisplayMode={}));var i=a.DisplayMode,j=function(){function a(a,b,c,d){this.left=0,this.top=0,this.right=0,this.bottom=0;var e=this;1===arguments.length?e.top=e.right=e.bottom=e.left=a:4===arguments.length&&(e.top=a,e.right=b,e.bottom=c,e.left=d)}return a.prototype.toString=function(){var a=this;return a.top+"px "+a.right+"px "+a.bottom+"px "+a.left+"px"},a}();a.Padding=j,function(a){a[a.TopLeft=0]="TopLeft",a[a.TopRight=1]="TopRight",a[a.BottomLeft=2]="BottomLeft",a[a.BottomRight=3]="BottomRight",a[a.MiddleLeft=4]="MiddleLeft",a[a.MiddleRight=5]="MiddleRight",a[a.TopCenter=6]="TopCenter",a[a.BottomCenter=7]="BottomCenter"}(a.ResizeDirection||(a.ResizeDirection={}));var k=(a.ResizeDirection,function(){function d(){var c=this;c._defaultLocation=new a.Point(9,-18),c._text="",c._location=c._defaultLocation,c._displayMode=2,c._commentState=3,c._width=160,c._height=100,c._fontFamily="Arial",c._fontStyle="normal",c._fontSize="9pt",c._fontWeight="normal",c._textDecoration=0,c._foreColor="black",c._backColor="#FFFFE1",c._opacity=1,c._locked=!0,c._lockText=!0,c._dynamicMove=!0,c._dynamicSize=!0,c._horizontalAlign=0,c._autoSize=!1,c._borderWidth=1,c._borderStyle="solid",c._borderColor="black",c._padding=b,c._zIndex=-1,c._showShadow=!1,c._timeout=b,c._rowIndex=-1,c._colIndex=-1,c._sheet=b}return d.prototype.text=function(a){var b=this;return 0===arguments.length?b._text:(b._text!==a&&b._changeProperty("text",a),b)},d.prototype.location=function(a){var b=this;return 0===arguments.length?b._location:(a&&b._location!==a&&b._changeProperty("location",a),b)},d.prototype.width=function(a){var b=this;return 0===arguments.length?b._width:(a>0&&b._width!==a&&(b._autoSize=!1,b._changeProperty("width",a)),b)},d.prototype.height=function(a){var b=this;return 0===arguments.length?b._height:(a>0&&b._height!==a&&(b._autoSize=!1,b._changeProperty("height",a)),b)},d.prototype.fontFamily=function(a){var b=this;return 0===arguments.length?b._fontFamily:("string"==typeof a&&b._fontFamily!==a&&b._changeProperty("fontFamily",a),b)},d.prototype.fontStyle=function(a){var b=this;return 0===arguments.length?b._fontStyle:("string"==typeof a&&b._fontStyle!==a&&b._changeProperty("fontStyle",a),b)},d.prototype.fontSize=function(a){var b=this;return 0===arguments.length?b._fontSize:("string"==typeof a&&b._fontSize!==a&&b._changeProperty("fontSize",a),b)},d.prototype.fontWeight=function(a){var b=this;return 0===arguments.length?b._fontWeight:("string"==typeof a&&b._fontWeight!==a&&b._changeProperty("fontWeight",a),b)},d.prototype.textDecoration=function(b){var d=this;return 0===arguments.length?d._textDecoration:(d._textDecoration!==b&&a.TextDecorationType[b]!=c&&d._changeProperty("textDecoration",b),d)},d.prototype.foreColor=function(a){var b=this;return 0===arguments.length?b._foreColor:(a&&b._foreColor!==a&&b._changeProperty("foreColor",a),b)},d.prototype.locked=function(a){var b=this;return 0===arguments.length?b._locked:("boolean"==typeof a&&b._locked!==a&&b._changeProperty("locked",a),b)},d.prototype.lockText=function(a){var b=this;return 0===arguments.length?b._lockText:("boolean"==typeof a&&b._lockText!==a&&b._changeProperty("lockText",a),b)},d.prototype.horizontalAlign=function(b){var d=this;return 0===arguments.length?d._horizontalAlign:(d._horizontalAlign!==b&&a.HorizontalAlign[b]!=c&&d._changeProperty("horizontalAlign",b),d)},d.prototype.autoSize=function(a){var b=this;return 0===arguments.length?b._autoSize:("boolean"==typeof a&&b._autoSize!==a&&b._changeProperty("autoSize",a),b)},d.prototype.dynamicSize=function(a){var b=this;return 0===arguments.length?b._dynamicSize:("boolean"==typeof a&&b._dynamicSize!==a&&b._changeProperty("dynamicSize",a),b)},d.prototype.dynamicMove=function(a){var b=this;return 0===arguments.length?b._dynamicMove:("boolean"==typeof a&&b._dynamicMove!==a&&b._changeProperty("dynamicMove",a),b)
},d.prototype.backColor=function(a){var b=this;return 0===arguments.length?b._backColor:(a&&b._backColor!==a&&b._changeProperty("backColor",a),b)},d.prototype.opacity=function(a){var b=this;return 0===arguments.length?b._opacity:("number"==typeof a&&a>=0&&1>=a&&b._opacity!==a&&b._changeProperty("opacity",a),b)},d.prototype.borderWidth=function(a){var b=this;return 0===arguments.length?b._borderWidth:("number"==typeof a&&a>0&&b._borderWidth!==a&&b._changeProperty("borderWidth",a),b)},d.prototype.borderStyle=function(a){var b=this;return 0===arguments.length?b._borderStyle:("string"==typeof a&&b._borderStyle!==a&&b._changeProperty("borderStyle",a),b)},d.prototype.borderColor=function(a){var b=this;return 0===arguments.length?b._borderColor:("string"==typeof a&&b._borderColor!==a&&b._changeProperty("borderColor",a),b)},d.prototype.padding=function(a){var b=this;return 0===arguments.length?b._padding:((null===a||a instanceof j)&&b._padding!==a&&b._changeProperty("padding",a),b)},d.prototype.showShadow=function(a){var b=this;return 0===arguments.length?b._showShadow:("boolean"==typeof a&&b._showShadow!==a&&b._changeProperty("showShadow",a),b)},d.prototype.displayMode=function(a){var b=this;return 0===arguments.length?b._displayMode:(b._displayMode!==a&&i[a]!==c&&b._changeProperty("displayMode",a),b)},d.prototype.commentState=function(b){var d=this;return 0===arguments.length?d._commentState:(d._commentState!==b&&a.CommentState[b]!==c&&d._changeProperty("commentState",b),d)},d.prototype.zIndex=function(a){var b=this;return 0===arguments.length?b._zIndex:("number"==typeof a&&b._zIndex!==a&&b._changeProperty("zIndex",a),b)},d.prototype._changeProperty=function(a,b){var c=this,d=c._sheet,e="_"+a;d?d._bindToAutoRefresh(function(a){c.hasOwnProperty(e)&&(c[e]=a)})(b):c.hasOwnProperty(e)&&(c[e]=b),c._trigger({sheet:d,sheetName:d?d._name:"",comment:c,propertyName:a})},d.prototype._trigger=function(b){this._sheet&&this._sheet._trigger(a.Events.CommentChanged,b)},d.prototype.clone=function(){var b=this,c=new d;return c._text=b._text,c._location=new a.Point(b._location.x,b._location.y),b._defaultLocation&&(c._defaultLocation=new a.Point(b._defaultLocation.x,b._defaultLocation.y)),c._width=b._width,c._height=b._height,c._fontFamily=b._fontFamily,c._fontStyle=b._fontStyle,c._fontSize=b._fontSize,c._fontWeight=b._fontWeight,c._textDecoration=b._textDecoration,c._foreColor=b._foreColor,c._locked=b._locked,c._lockText=b._lockText,c._horizontalAlign=b._horizontalAlign,c._autoSize=b._autoSize,c._dynamicMove=b._dynamicMove,c._dynamicSize=b._dynamicSize,c._backColor=b._backColor,c._opacity=b._opacity,c._borderWidth=b._borderWidth,c._borderStyle=b._borderStyle,c._borderColor=b._borderColor,b._padding&&(c._padding=new j(b._padding.top,b._padding.right,b._padding.bottom,b._padding.left)),c._showShadow=b._showShadow,c._displayMode=b._displayMode,c._commentState=b._commentState,c._sheet=b._sheet,c._rowIndex=b._rowIndex,c._colIndex=b._colIndex,c._zIndex=b._zIndex,c},d.prototype.toJSON=function(){var a=this,b={text:a._text,location:a._location,displayMode:a._displayMode,commentState:a._commentState,width:a._width,height:a._height,fontFamily:a._fontFamily,fontStyle:a._fontStyle,fontSize:a._fontSize,fontWeight:a._fontWeight,textDecoration:a._textDecoration,foreColor:a._foreColor,backColor:a._backColor,opacity:a._opacity,locked:a._locked,lockText:a._lockText,dynamicMove:a._dynamicMove,dynamicSize:a._dynamicSize,horizontalAlign:a._horizontalAlign,autoSize:a._autoSize,borderWidth:a._borderWidth,borderStyle:a._borderStyle,borderColor:a._borderColor,padding:a._padding,zIndex:a._zIndex,showShadow:a._showShadow,rowIndex:a._rowIndex,colIndex:a._colIndex},c={};for(var d in b){var e=b[d];a._isDefaultValue(d,e)||(c[d]=e)}return c},d.prototype._isDefaultValue=function(a,b){switch(a){case"text":return""===b;case"location":return 9===b.x&&-18===b.y;case"displayMode":return 2===b;case"commentState":return 3===b;case"width":return 160===b;case"height":return 100===b;case"fontFamily":return"Arial"===b;case"fontStyle":return"normal"===b;case"fontSize":return"9pt"===b;case"fontWeight":return"normal"===b;case"textDecoration":return 0===b;case"foreColor":return"black"===b;case"backColor":return"#FFFFE1"===b;case"opacity":return 1===b;case"locked":return b===!0;case"lockText":return b===!0;case"dynamicMove":return b===!0;case"dynamicSize":return b===!0;case"horizontalAlign":return 0===b;case"autoSize":return b===!1;case"borderWidth":return 1===b;case"borderStyle":return"solid"===b;case"borderColor":return"black"===b;case"padding":return null===b;case"zIndex":return-1===b;case"showShadow":return b===!1;case"rowIndex":return-1===b;case"colIndex":return-1===b;default:return!1}},d.prototype.fromJSON=function(b){if(b){var d=this;b.text!==c&&(d._text=b.text);var e=b.location;e!==c&&(d._location=new a.Point(e.x,e.y)),b.displayMode!==c&&(d._displayMode=b.displayMode),b.commentState!==c&&(d._commentState=b.commentState),b.width!==c&&(d._width=b.width),b.height!==c&&(d._height=b.height),b.fontFamily!==c&&(d._fontFamily=b.fontFamily),b.fontStyle!==c&&(d._fontStyle=b.fontStyle),b.fontSize!==c&&(d._fontSize=b.fontSize),b.fontWeight!==c&&(d._fontWeight=b.fontWeight),b.textDecoration!==c&&(d._textDecoration=b.textDecoration),b.foreColor!==c&&(d._foreColor=b.foreColor),b.backColor!==c&&(d._backColor=b.backColor),b.opacity!==c&&(d._opacity=b.opacity),b.locked!==c&&(d._locked=b.locked),b.lockText!==c&&(d._lockText=b.lockText),b.dynamicMove!==c&&(d._dynamicMove=b.dynamicMove),b.dynamicSize!==c&&(d._dynamicSize=b.dynamicSize),b.horizontalAlign!==c&&(d._horizontalAlign=b.horizontalAlign),b.autoSize!==c&&(d._autoSize=b.autoSize),b.borderWidth!==c&&(d._borderWidth=b.borderWidth),b.borderStyle!==c&&(d._borderStyle=b.borderStyle),b.borderColor!==c&&(d._borderColor=b.borderColor);var f=b.padding;f!==c&&(d._padding=new j(f.top,f.right,f.bottom,f.left)),b.zIndex!==c&&(d._zIndex=b.zIndex),b.showShadow!==c&&(d._showShadow=b.showShadow),b.rowIndex!==c&&(d._rowIndex=b.rowIndex),b.colIndex!==c&&(d._colIndex=b.colIndex)}},d}());a.Comment=k;var l=function(){function i(a,b){this._rowViewportIndex=1,this._columnViewportIndex=1;var c=this,d=a&&a._sheet;c._comment=a,c._updateCommentViewportIndex(),c._zoomFactor=d._zoomFactor,c._commentManager=b,c._editor=b._editorDom,c._init(),c._absLocation=c._getAbsLocation(),c._updateStartCoordinate(),c._updateEndCoordinate()}return i.prototype._init=function(){var a=this;a._commentLayoutPanel=b,a._floatBlockCanvasContainer=b,a._floatBlockCanvas=b,a._hostContainer=b,a._host=b,a._lineCanvasContainer=b,a._lineCanvas=b,a._floatBlockCanvasContainerClassName="gc-spread-floatBlockCanvas-container",a._floatBlockCanvasClassName="gc-spread-floatBlockCanvas",a._hostContainerClassName="gc-spread-host-container",a._hostClassName="gc-spread-host",a._lineCanvasContainerClassName="gc-spread-lineCanvas-container",a._lineCanvasClassName="gc-spread-lineCanvas",a._floatBlockCanvasContainer=document.createElement("div"),$(a._floatBlockCanvasContainer).addClass(a._floatBlockCanvasContainerClassName).css("position","absolute").css("overflow","hidden"),a._floatBlockCanvas=document.createElement("canvas"),$(a._floatBlockCanvas).addClass(a._floatBlockCanvasClassName).css("left",0).css("top",0).css("position","absolute"),a._hostContainer=document.createElement("div"),$(a._hostContainer).addClass(a._hostContainerClassName).css("position","absolute"),a._host=document.createElement("div"),$(a._host).addClass(a._hostClassName).css("left",0).css("top",0).css("width","100%").css("height","100%").css("position","absolute").css("word-wrap","break-word").css("word-break","normal").css("white-space","pre-wrap").css("overflow","hidden"),$(a._hostContainer).append(a._host),$(a._floatBlockCanvasContainer).append(a._floatBlockCanvas,a._hostContainer),a._lineCanvasContainer=document.createElement("div"),$(a._lineCanvasContainer).addClass(a._lineCanvasContainerClassName).css("position","absolute").css("overflow","hidden"),a._lineCanvas=document.createElement("canvas"),$(a._lineCanvas).addClass(a._lineCanvasClassName).css("left",0).css("right",0).css("position","absolute"),$(a._lineCanvasContainer).append(a._lineCanvas),a._adornerDrawState=b,a._resizeHitRects=[],a._hostMargin=7,a._isMoving=!1,a._isResizing=!1},i.prototype.open=function(){var a=this,b=a._comment._sheet;(a._commentLayoutPanel||(b&&(a._commentLayoutPanel=b._commentRender._commentLayoutPanel),a._commentLayoutPanel))&&(a._commentLayoutPanel.appendChild(a._lineCanvasContainer),a._attachLineCanvasEventHandler(),a._commentLayoutPanel.appendChild(a._floatBlockCanvasContainer),a._attachFloatBlockCanvasEventHandler(),a._attachHostContainerEventHandler(),a.isEditing()?a._attachEditorEventHandler():a._attachHostEventHandler(),a.updateLayout())},i.prototype.close=function(){var a=this;a._floatBlockCanvasContainer&&a._lineCanvasContainer&&a._commentLayoutPanel&&(a._detachFloatBlockCanvasEventHandler(),a._detachHostContainerEventHandler(),a._detachHostEventHandler(),a._detachLineCanvasEventHandler(),a._detachEditorEventHandler(),$(a._floatBlockCanvasContainer).remove(),$(a._lineCanvasContainer).remove())},i.prototype.getComment=function(){return this._comment},i.prototype._getActualWidth=function(){return this._comment.width()*this._zoomFactor},i.prototype._getActualHeight=function(){return this._comment.height()*this._zoomFactor},i.prototype._getAbsLocation=function(){var a=this,b=a._comment;return a._convertRelLocationToAbsLocation(b===a._commentManager.getHoverShownComment()&&3===b.commentState()?b._defaultLocation:b.location())},i.prototype._convertRelLocationToAbsLocation=function(c){var d=this,e=d._comment,f=e&&e._sheet,g=d._zoomFactor,h=b;if(f){var i=d._getCellRect(f,e._rowIndex,e._colIndex,d._rowViewportIndex,d._columnViewportIndex);if(null!==i.x&&void 0!==i.x&&null!==i.y&&void 0!==i.y&&i.width&&i.height){var j=f._getSheetLayout();h=new a.Point(i.x+i.width+c.x*g-j.rowHeaderWidth,i.y+c.y*g-j.colHeaderHeight)}}return h},i.prototype._getCellRect=function(b,c,f,g,h){for(var i=this,j=new a.Rect(0,0,0,0),k=b._getSheetLayout(),l=b.getViewportTopRow(g),m=b.getViewportLeftColumn(h),n=e(l,c),o=d(l,c),p=e(m,f),q=d(m,f),r=0,s=0,t=i._zoomFactor,u=n;o>u;u++)s+=b.getRowHeight(u,3)*t;for(var v=p;q>v;v++)r+=b.getColumnWidth(v,3)*t;return j.y=c>=l?s:-s,j.x=f>=m?r:-r,j.width=b.getColumnWidth(f)*t,j.height=b.getRowHeight(c)*t,j.x+=k.rowHeaderWidth,j.y+=k.colHeaderHeight,1===g?j.y+=k.frozenHeight:2===g&&(j.y+=k.frozenHeight+k.viewportHeight),1===h?j.x+=k.frozenWidth:2===h&&(j.x+=k.frozenWidth+k.viewportWidth),j},i.prototype._convertAbsLocationToRelLocation=function(c){var d=this,e=d._comment,f=e&&e._sheet,g=d._zoomFactor,h=b;if(f){var i=d._getCellRect(f,e._rowIndex,e._colIndex,d._rowViewportIndex,d._columnViewportIndex);if(null!==i.x&&void 0!==i.x&&null!==i.y&&void 0!==i.y&&i.width&&i.height){var j=f._getSheetLayout(),k=(c.x-(i.x+i.width-j.rowHeaderWidth))/g,l=(c.y-(i.y-j.colHeaderHeight))/g;h=new a.Point(k,l)}}return h},i.prototype.updateLayoutWhenAutosizeChanged=function(){var a=this,b=a._comment,c=a._host,e=c.style;if(!b.autoSize()||"auto"===e.width&&"auto"===e.height)b.autoSize()||"auto"!==e.width||"auto"!==e.height||(a.isEditing()&&a.detachEditor(),$(c).css("width",$(c).width()).css("height",$(c).height()).css("word-wrap","break-word"));else{a.isEditing()&&a.detachEditor();var f=5,g=b._sheet._getFontHeight(e.font),h=$(c).width(),i=$(c).height();$(c).css("width","auto").css("height","auto").css("word-wrap","normal");var j=d($(c).width(),f),k=d($(c).height(),g);b._width+=j-h,b._height+=k-i}a.updateLayout()},i.prototype.updateLayoutWhenLocationChanged=function(){var a=this;a._absLocation=a._getAbsLocation(),a._updateStartCoordinate(),a._updateEndCoordinate(),a.updateLayout()},i.prototype.updateLayoutWhenWidthHeightChanged=function(){var a=this;a._absLocation=a._getAbsLocation(),a._updateEndCoordinate()},i.prototype.updateLayoutWhenRowColumnChanged=function(){var a=this,b=a._comment;if(b.dynamicMove())b.dynamicSize()?(a._updateSizeByCoordinate(),a._updateLocationByCoordinate()):(a._updateLocationByCoordinate(),a._updateEndCoordinate());else{a._updateStartCoordinate(),a._updateEndCoordinate();var c=a._convertAbsLocationToRelLocation(a._absLocation);b.location(c)}},i.prototype.updateLayoutWhenSheetScroll=function(){var a=this;a._absLocation=a._getAbsLocation(),a.updateLayout()},i.prototype._updateLocationByCoordinate=function(){var a=this,b=a._comment,c=(b&&b._sheet,a._getLocationByCoordinate());a._absLocation=c,b._location=a._convertAbsLocationToRelLocation(c),a.updateLayout()},i.prototype._getLocationByCoordinate=function(){{var b,c=this,d=c._comment,e=d&&d._sheet,f=c._zoomFactor,g=e.getViewportLeftColumn(c._columnViewportIndex),h=e.getViewportTopRow(c._rowViewportIndex);c._getViewportRect(c._rowViewportIndex,c._columnViewportIndex)}0===c._columnViewportIndex?b=0:1===c._columnViewportIndex?b=e.getViewportWidth(0):2===c._columnViewportIndex&&(b=e.getViewportWidth(0)+e.getViewportWidth(1));for(var i=g;i<c._startColumn;i++)b+=e.getColumnWidth(i,3)*f;var j=e.getColumnWidth(c._startColumn,3);j<c._startColumnOffset&&(c._startColumnOffset=j),b+=c._startColumnOffset*f;var k;0===c._rowViewportIndex?k=0:1===c._rowViewportIndex?k=e.getViewportHeight(0):2===c._rowViewportIndex&&(k=e.getViewportHeight(0)+e.getViewportHeight(1));for(var l=h;l<c._startRow;l++)k+=e.getRowHeight(l,3)*f;var m=e.getRowHeight(c._startRow,3);return m<c._startRowOffset&&(c._startRowOffset=m),k+=c._startRowOffset*f,new a.Point(b,k)},i.prototype._updateSizeByCoordinate=function(){for(var a=this,b=a._comment,c=b&&b._sheet,d=(a._zoomFactor,0),e=a._startColumn;e<a._endColumn;e++)d+=c.getColumnWidth(e,3);var f=c.getColumnWidth(a._startColumn,3);f<a._startColumnOffset&&(a._startColumnOffset=f);var g=c.getColumnWidth(a._endColumn,3);g<a._endColumnOffset&&(a._endColumnOffset=g),d=d-a._startColumnOffset+a._endColumnOffset;for(var h=0,i=a._startRow;i<a._endRow;i++)h+=c.getRowHeight(i,3);var j=c.getRowHeight(a._startRow,3);j<a._startRowOffset&&(a._startRowOffset=j);var k=c.getRowHeight(a._endRow,3);k<a._endRowOffset&&(a._endRowOffset=k),h=h-a._startRowOffset+a._endRowOffset,b.width(d),b.height(h)},i.prototype._updateStartCoordinate=function(){var b=this,c=b._comment,d=c&&c._sheet,e=b._zoomFactor;if(b._absLocation){var f,g=(b._getViewportRect(b._rowViewportIndex,b._columnViewportIndex),d.getViewportLeftColumn(b._columnViewportIndex)),h=d.getViewportTopRow(b._rowViewportIndex);0===b._columnViewportIndex?f=b._absLocation.x:1===b._columnViewportIndex?f=b._absLocation.x-d.getViewportWidth(0):2===b._columnViewportIndex&&(f=b._absLocation.x-(d.getViewportWidth(0)+d.getViewportWidth(1)));var i;0===b._rowViewportIndex?i=b._absLocation.y:1===b._rowViewportIndex?i=b._absLocation.y-d.getViewportHeight(0):2===b._rowViewportIndex&&(i=b._absLocation.y-(d.getViewportHeight(0)+d.getViewportHeight(1)));for(var j=new a.Point(f,i),k=0,l=0,m=g;m<d.getColumnCount();m++){var n=d.getColumnWidth(m,3)*e;if(!(k+n<j.x)){b._startColumn=m,b._startColumnOffset=(j.x-k)/e;break}k+=n}for(var o=h;o<d.getRowCount();o++){var p=d.getRowHeight(o,3)*e;if(!(l+p<j.y)){b._startRow=o,b._startRowOffset=(j.y-l)/e;break}l+=p}}},i.prototype._updateEndCoordinate=function(){var b=this,c=b._comment,d=c&&c._sheet,e=b._zoomFactor;if(b._absLocation){var f,g=(b._getViewportRect(b._rowViewportIndex,b._columnViewportIndex),d.getViewportLeftColumn(b._columnViewportIndex)),h=d.getViewportTopRow(b._rowViewportIndex);0===b._columnViewportIndex?f=b._absLocation.x+b._getActualWidth():1===b._columnViewportIndex?f=b._absLocation.x+b._getActualWidth()-d.getViewportWidth(0):2===b._columnViewportIndex&&(f=b._absLocation.x+b._getActualWidth()-(d.getViewportWidth(0)+d.getViewportWidth(1)));var i;0===b._rowViewportIndex?i=b._absLocation.y+b._getActualHeight():1===b._rowViewportIndex?i=b._absLocation.y+b._getActualHeight()-d.getViewportHeight(0):2===b._rowViewportIndex&&(i=b._absLocation.y+b._getActualHeight()-(d.getViewportHeight(0)+d.getViewportHeight(1)));for(var j=new a.Point(f,i),k=0,l=0,m=g;m<d.getColumnCount();m++){var n=d.getColumnWidth(m,3)*e;if(!(k+n<j.x)){b._endColumn=m,b._endColumnOffset=(j.x-k)/e;break}k+=n}for(var o=h;o<d.getRowCount();o++){var p=d.getRowHeight(o,3)*e;if(!(l+p<j.y)){b._endRow=o,b._endRowOffset=(j.y-l)/e;break}l+=p}}},i.prototype.addRows=function(a,b){var c=this,d=c._comment;a<=c._startRow?d.dynamicMove()&&(c._startRow+=b,c._endRow+=b):a>c._startRow&&a<=c._endRow&&d.dynamicSize()&&(c._endRow+=b),c._updateSizeByCoordinate(),c._updateLocationByCoordinate()},i.prototype.addColumns=function(a,b){var c=this,d=c._comment;a<=c._startColumn?d.dynamicMove()&&(c._startColumn+=b,c._endColumn+=b):a>c._startColumn&&a<=c._endColumn&&d.dynamicSize()&&(c._endColumn+=b),c._updateSizeByCoordinate(),c._updateLocationByCoordinate()},i.prototype.removeRows=function(a,b){var c=this,d=c._comment,e=a+b-1;a<c._startRow?e<c._startRow?d.dynamicMove()&&(c._startRow-=b,c._endRow-=b):e<c._endRow&&d.dynamicMove()&&(c._endRow-=d.dynamicSize()?b:c._startRow-a+1,c._startRow=a,c._startRowOffset=0):a<=c._endRow&&(e<c._endRow?d.dynamicSize()&&(c._endRow-=b):d.dynamicSize()&&(c._endRow=a,c._endRowOffset=0)),c._updateSizeByCoordinate(),c._updateLocationByCoordinate()},i.prototype.removeColumns=function(a,b){var c=this,d=c._comment,e=a+b-1;a<c._startColumn?e<c._startColumn?d.dynamicMove()&&(c._startColumn-=b,c._endColumn-=b):e<c._endColumn&&d.dynamicMove()&&(c._endColumn-=d.dynamicSize()?b:c._startColumn-a+1,c._startColumn=a,c._startColumnOffset=0):a<=c._endColumn&&(e<c._endColumn?d.dynamicSize()&&(c._endColumn-=b):d.dynamicSize()&&(c._endColumn=a,c._endColumnOffset=0)),c._updateSizeByCoordinate(),c._updateLocationByCoordinate()},i.prototype._updateCommentViewportIndex=function(){var a=this,b=a._comment,c=b&&b._sheet,d=b._rowIndex,e=b._colIndex,f=1,g=1,h=c.frozenRowCount,i=c.frozenColCount,j=c._frozenTrailingRowCount,k=c._frozenTrailingColCount,l=c.getRowCount(),m=c.getColumnCount();h>d?f=0:d>=h&&l-j-1>=d?f=1:d>l-j-1&&(f=2),i>e?g=0:e>=i&&m-k-1>=e?g=1:e>m-k-1&&(g=2),a._rowViewportIndex=f,a._columnViewportIndex=g},i.prototype.updateLayout=function(){var a=this,b=a._comment._sheet;a.isOpen()&&(a._zoomFactor!==b._zoomFactor?(a._zoomFactor=b._zoomFactor,a._absLocation=a._getLocationByCoordinate()):a._zoomFactor=b._zoomFactor,a._updateCommentViewportIndex(),a._formatComment(),a._updateLineContainerLayout(),a._updateAdornerLayout(),$.browser.chrome&&a._offsetCommentLayoutInChrome())},i.prototype._formatComment=function(){var a=this,b=a._comment,c=2===b.commentState()?a._editor:a._host;a._formatCommentState(),a._formatCommentStyle(c),a._formatCommentText(c),a._formatCommentLocation(),a._formatCommentSize(c),a._formatCommentProtection()},i.prototype._formatCommentText=function(a){var b=this,c=b._comment;a===b._host&&(a.innerHTML=c.text().replace(/\r\n|\n|\r/g,"<br/>"))},i.prototype._formatCommentLocation=function(){{var a=this,b=a._comment;b&&b._sheet}if(a._absLocation){var c=a._hostMargin,d=a._getActualWidth(),f=a._getActualHeight(),g=a._absLocation.x,h=a._absLocation.y,i=a._getViewportRect(a._rowViewportIndex,a._columnViewportIndex);g<i.x?($(a._floatBlockCanvas).css("left",g-i.x),$(a._hostContainer).css("left",g+c-i.x),d+=g-i.x,g=i.x):g+d>i.x+i.width?($(a._floatBlockCanvas).css("left",0),$(a._hostContainer).css("left",c),d+=i.x+i.width-1-(g+d)):($(a._floatBlockCanvas).css("left",0),$(a._hostContainer).css("left",c)),d=e(i.width-1,d),h<i.y?($(a._floatBlockCanvas).css("top",h-i.y),$(a._hostContainer).css("top",h+c-i.y),f+=h-i.y,h=i.y):h+f>i.y+i.height?($(a._floatBlockCanvas).css("top",0),$(a._hostContainer).css("top",c),f+=i.y+i.height-1-(h+f)):($(a._floatBlockCanvas).css("top",0),$(a._hostContainer).css("top",c)),f=e(i.height-1,f),$(a._floatBlockCanvasContainer).css("left",g).css("top",h).css("width",d).css("height",f)}},i.prototype._formatCommentSize=function(a){var b=this,c=b._comment,e=b._getActualWidth(),f=b._getActualHeight();$(b._hostContainer).css("width",d(0,e-2*b._hostMargin-2*c.borderWidth())).css("height",d(0,f-2*b._hostMargin-2*c.borderWidth()));var g=0,h=0;c.padding()&&(g-=parseInt(c.padding().left)+parseInt(c.padding().right),h-=parseInt(c.padding().top)+parseInt(c.padding().bottom)),$(a).css("width",d(0,$(b._hostContainer).width()+g)).css("height",d(0,$(b._hostContainer).height()+h))},i.prototype._formatCommentProtection=function(){var a=this,b=a._comment,c=b&&b._sheet;c.isProtected?(b.locked()?(a._detachFloatBlockCanvasEventHandler(),a._attachMouseWheelEvent(a._floatBlockCanvas),a._detachHostContainerEventHandler(),a._attachMouseWheelEvent(a._hostContainer),a._floatBlockCanvas.style.cursor="default",a._hostContainer.style.cursor="default"):(a._attachFloatBlockCanvasEventHandler(),a._attachHostContainerEventHandler()),b.lockText()?(a._detachHostEventHandler(),a._attachMouseWheelEvent(a._host),a._detachEditorEventHandler(),a._attachMouseWheelEvent(a._editor),a._comment.commentState(3),a._host.style.cursor=a._comment.locked()?"default":"move"):(a._attachHostEventHandler(),a._attachEditorEventHandler()),a._attachLineCanvasEventHandler()):(a._attachFloatBlockCanvasEventHandler(),a._attachHostContainerEventHandler(),a._attachLineCanvasEventHandler(),a._attachHostEventHandler(),a._attachEditorEventHandler())},i.prototype._formatCommentState=function(){var a=this,c=a._comment,d=a._commentManager,e=c&&c._sheet;switch(c.commentState()){case 1:d.activateComment(c),a.isEditing()&&a.detachEditor(),e.getSelections().length>0&&e._saveAndClearSheetSelections(),window.gcGlobal.activeElement=e;break;case 2:d.activateComment(c),a.isEditing()||a._attachEditor(),e.getSelections().length>0&&e._saveAndClearSheetSelections(),window.gcGlobal.activeElement=b;break;case 3:c===d.getActiveComment()&&(d.deactivateComment(),0===e.getSelections().length&&e._loadAndSetSheetSelections())}},i.prototype._formatCommentStyle=function(b){var c=this,d=c._comment,e=$(b);e.css("font-family",d.fontFamily()).css("font-style",d.fontStyle()).css("font-size",d.fontSize()).css("font-weight",d.fontWeight()),e.css("text-decoration",c._getTextDecorationString(d.textDecoration())),e.css("text-align",a.HorizontalAlign[d.horizontalAlign()]),d.padding()?e.css("padding",d.padding().toString()):e.css("padding","0px"),e.css("background-color",d.backColor()).css("color",d.foreColor()).css("opacity",d.opacity()),$(c._hostContainer).css("border-width",d.borderWidth()).css("border-style",d.borderStyle()).css("border-color",d.borderColor());var f=c._commentManager.getCommentActualZIndex(d);$(c._lineCanvasContainer).css("z-index",f),$(c._floatBlockCanvasContainer).css("z-index",f)},i.prototype._getTextDecorationString=function(a){var b="";return 0!==a?((1|a)===a&&(b+=" underline"),(2|a)===a&&(b+=" line-through"),(4|a)===a&&(b+=" overline")):b+="none",b},i.prototype._formatCommentDynamicMoveAndDynamicSize=function(){},i.prototype._offsetCommentLayoutInChrome=function(){var a=this,b=this._comment._sheet,c=$(a._hostContainer);if(b&&c){var d=b._eventHandler._getCanvasOffset(),e=d.left-Math.floor(d.left)>=.5?.5:0,f=d.top-Math.floor(d.top)>=.5?.5:0;c.css("left",parseFloat(c.css("left"))+e),c.css("top",parseFloat(c.css("top"))+f)}},i.prototype._updateLineContainerLayout=function(){var c=this,d=c._comment,f=d._sheet,g=c._getCellRect(f,d._rowIndex,d._colIndex,c._rowViewportIndex,c._columnViewportIndex),i=f._getSheetLayout(),j=b,k=g.x+g.width-i.rowHeaderWidth,l=g.y-i.colHeaderHeight;j=new a.Point(k,l);var m=b,n=$(c._floatBlockCanvasContainer).position(),o=$(c._hostContainer).position(),p=$(c._hostContainer);m=n.left+o.left>j.x?new a.Point(n.left+o.left,n.top+o.top):n.top+o.top+p.height()<j.y?new a.Point(n.left+o.left+p.width(),n.top+o.top+p.height()):new a.Point(n.left+o.left+p.width(),n.top+o.top);var q=c._hostMargin,r=h(j.x-m.x)+2*q,s=h(j.y-m.y)+2*q,t=e(j.x,m.x)-q,u=e(j.y,m.y)-q,v=t+r,w=u+s,x=c._getViewportRect(c._rowViewportIndex,c._columnViewportIndex);t<x.x&&(r-=x.x-t,t=x.x),v>x.x+x.width&&(r-=v-(x.x+x.width)),r=e(x.width,r),u<x.y&&(s-=x.y-u,u=x.y),w>x.y+x.height&&(s-=w-(x.y+x.height)),s=e(x.height,s),$(c._lineCanvasContainer).css("left",t).css("top",u).css("width",r).css("height",s),c._lineCanvas.width=r,c._lineCanvas.height=s,j.x=j.x-t,j.y=j.y-u,m.x=m.x-t,m.y=m.y-u,c._drawLine(j,m)},i.prototype._updateAdornerLayout=function(){{var a=this;a._comment}a._floatBlockCanvas.width=a._getActualWidth(),a._floatBlockCanvas.height=a._getActualHeight(),a._drawAdorner()},i.prototype._drawLine=function(a,b){var c=this;c._lineCxt||(c._lineCxt=c._lineCanvas.getContext("2d"));var d=c._lineCxt,e=c._comment.borderColor();d.strokeStyle=e,d.clearRect(0,0,c._lineCanvas.width,c._lineCanvas.height),d.beginPath(),d.moveTo(a.x,a.y),d.lineTo(b.x,b.y),d.stroke(),d.save(),d.translate(a.x,a.y),d.fillStyle=e,d.beginPath();var f=g(b.y-a.y,b.x-a.x);d.rotate(f),d.moveTo(0,0),d.lineTo(7,-4),d.lineTo(7,4),d.lineTo(0,0),d.fill(),d.closePath(),d.restore()},i.prototype._drawAdorner=function(){var a=this,b=a._comment,c=b._sheet;a._adornerDrawState=a._comment.commentState(),a._adornerCxt||(a._adornerCxt=a._floatBlockCanvas.getContext("2d"));var d=a._adornerCxt,e=a._floatBlockCanvas.width,f=a._floatBlockCanvas.height,g=$(a._hostContainer).outerWidth(),h=$(a._hostContainer).outerHeight(),i=a._hostMargin;d.clearRect(0,0,e,f),d.lineWidth=1,a._comment.showShadow()&&(a._drawShadowAdorner(d,i,g,h),a._drawStateAdorner(d,e,f)),c.isProtected&&b.locked()||a._drawResizeAdorner(d,i,e,f,g,h),d.restore()},i.prototype._drawShadowAdorner=function(a,b,c,d){a.rect(b+2,b+2,c,d),a.fill()},i.prototype._drawStateAdorner=function(a,b,c){switch(this._adornerDrawState){case 1:a.beginPath();for(var d=0;c>d;d++)for(var e=d%2==0?1:3;b>e;)a.moveTo(e,d),a.lineTo(e+1,d+1),e+=4;a.stroke(),a.closePath();break;case 2:a.beginPath();for(var e=0,d=0,f=4;b+c>e;)a.moveTo(e+f,0),a.lineTo(0,d+f),e+=f,d+=f;a.stroke(),a.closePath()}},i.prototype._drawResizeAdorner=function(c,d,e,g,h,i){var j=this;if(1===j._adornerDrawState||2===j._adornerDrawState){j._resizeHitRects.splice(0,j._resizeHitRects.length);var k=new a.Rect(0,0,d,d);j._resizeHitRects.push(k);var l=new a.Rect(e-d,0,d,d);j._resizeHitRects.push(l);var m=new a.Rect(0,g-d,d,d);j._resizeHitRects.push(m);var n=new a.Rect(e-d,g-d,d,d);if(j._resizeHitRects.push(n),i>=3*d){var o=new a.Rect(0,f(g/2-d/2),d,d);j._resizeHitRects.push(o);var p=new a.Rect(e-d,f(g/2-d/2),d,d);j._resizeHitRects.push(p)}else j._resizeHitRects.push(b),j._resizeHitRects.push(b);if(h>=3*d){var q=new a.Rect(f(e/2-d/2),0,d,d);j._resizeHitRects.push(q);var r=new a.Rect(f(e/2-d/2),g-d,d,d);j._resizeHitRects.push(r)}else j._resizeHitRects.push(b),j._resizeHitRects.push(b);c.save(),c.fillStyle="white",c.strokeStyle="#939393",c.linewidth=1,c.translate(.5,.5),$(j._resizeHitRects).each(function(){if(j){var a=this,b=a.x,d=a.y,e=a.width,f=a.height;c.beginPath(),c.fillRect(b,d,e-1,f-1),c.strokeRect(b,d,e-1,f-1),c.stroke(),c.closePath()}})}},i.prototype._drawMoveResizeContainer=function(){var a=this,b=a._commentManager;a._moveResizeContainerDom?$(a._moveResizeContainerDom).remove():a._moveResizeContainerDom=document.createElement("div"),a._moveResizePanelDom?$(a._moveResizePanelDom).remove():a._moveResizePanelDom=document.createElement("div");var c=$(a._moveResizePanelDom),d=$(a._moveResizeContainerDom),e=(b._mouseCapture,$(a._hostContainer)),f=a._getViewportRect(a._rowViewportIndex,a._columnViewportIndex);c.css({position:"absolute",overflow:"hidden",top:f.y,left:f.x,width:f.width,height:f.height}).bind("mousemove",function(b){a._doMouseMove(b)}).bind("mouseup",function(b){a._doMouseUp(b)}),d.addClass("gc-spread-moveResizeContainer").css("position","absolute").css("left",a._absLocation.x+a._hostMargin-f.x).css("top",a._absLocation.y+a._hostMargin-f.y).css("width",e.outerWidth()-2).css("height",e.outerHeight()-2).css("border","gray solid thin").css("z-index",900),c.append(a._moveResizeContainerDom),a._commentLayoutPanel&&a._commentLayoutPanel.appendChild(a._moveResizePanelDom)},i.prototype._doMoveResizeContainer=function(b){var c=this,e=c._comment._sheet,f=e._commentManager,g=c._zoomFactor,h=f._mouseCapture,i=f.getActiveComment();if(h.capture&&i){var j=f.getCommentView(i),k=j._absLocation,l=j._hostMargin,m=j._moveInfo.startTopRow,n=e.getViewportTopRow(j._rowViewportIndex),o=j._moveInfo.startLeftColumn,p=e.getViewportLeftColumn(j._columnViewportIndex),q=j._getTwoRowDistance(e,m,n),r=j._getTwoColumnDistance(e,o,p),s=b.pageX/g-h.x,t=b.pageY/g-h.y;p>o?s+=r:s-=r,n>m?t+=q:t-=q;var u=j._getViewportRect(j._rowViewportIndex,j._columnViewportIndex);if(0!==s||0!==t){var v=$(j._moveResizeContainerDom);if(-100==h.resizeDirct){var w=j._convertRelLocationToAbsLocation(new a.Point(h.cachedRect.x+s,h.cachedRect.y+t));v.css("left",w.x+l-u.x).css("top",w.y+l-u.y)}else{var x;switch(h.resizeDirct){case 0:s=d(s,0-k.x-l),t=d(t,0-k.y-l),x=j._getCommentTopLeftResizeRect(s,t);break;case 1:s=d(s,0-k.x-i.width()+l),t=d(t,0-k.y-l),x=j._getCommentTopRightResizeRect(s,t);break;case 2:s=d(s,0-k.x-l),t=d(t,0-k.y-i.height()+l),x=j._getCommentBottomLeftResizeRect(s,t);break;case 3:s=d(s,0-k.x-i.width()+l),t=d(t,0-k.y-i.height()+l),x=j._getCommentBottomRightResizeRect(s,t);break;case 4:s=d(s,0-k.x-l),x=j._getCommentMiddleLeftResizeRect(s);break;case 5:s=d(s,0-k.x-i.width()+l),x=j._getCommentMiddleRightResizeRect(s);break;case 6:t=d(t,0-k.y-l),x=j._getCommentTopCenterResizeRect(t);break;case 7:t=d(t,0-k.y-i.height()+l),x=j._getCommentBottomCenterResizeRect(t)}var w=j._convertRelLocationToAbsLocation(new a.Point(x.x,x.y));v.css("left",w.x+l-u.x).css("top",w.y+l-u.y).css("width",x.width*g-2*l-2).css("height",x.height*g-2*l-2)}}}},i.prototype._attachEditor=function(){var a=this,b=a._comment;if(!a.isEditing()){var c=a._commentManager._editorDom;$(a._host).remove(),a._detachHostEventHandler(),$(c).remove(),$(a._hostContainer).append(c),a._setDomStyle(c),a._formatCommentSize(c),$(c).focus(),c.selectionStart=c.value.length,a._attachEditorEventHandler(),2!==b.commentState()&&b.commentState(2)}},i.prototype.detachEditor=function(){var b=this,c=b._comment,d=c._sheet;if(b.isEditing()){var e=b._commentManager._editorDom;if($(e).remove(),b._detachEditorEventHandler(),$(b._hostContainer).append(b._host),b._setDomStyle(b._host),b._attachHostEventHandler(),2===c.commentState()&&c.commentState(3),$(e).val()!==c.text()){var f=new a.UndoRedo.CommentPropertyUndoAction(d,c,c.text(),$(e).val(),"text");d._doCommand(f)}}},i.prototype._getSheetHeight=function(a){if(a===b||a===c)return-1;for(var d=0,e=a.getRowCount(),f=0;e>f;f++)d+=a.getRowHeight(f,3)*this._zoomFactor;return d},i.prototype._getSheetWidth=function(a){if(a===b||a===c)return-1;for(var d=0,e=a.getColumnCount(),f=0;e>f;f++)d+=a.getColumnWidth(f,3)*this._zoomFactor;return d},i.prototype._getViewportHeight=function(a){var b=this,c=b._comment,d=c&&c._sheet;if(0===a||2===a)return d.getViewportHeight(a);if(1===a){for(var e=d.getViewportBottomRow(0)+1,f=d.getViewportTopRow(2),g=0,h=e;f>=h;h++)g+=d.getRowHeight(h,3)*b._zoomFactor;return g}return-1},i.prototype._getViewportWidth=function(a){var b=this,c=b._comment,d=c&&c._sheet;if(0===a||2===a)return d.getViewportWidth(a);if(1===a){for(var e=d.getViewportRightColumn(0)+1,f=d.getViewportLeftColumn(2),g=0,h=e;f>=h;h++)g+=d.getColumnWidth(h,3)*b._zoomFactor;return g}return-1},i.prototype._getTwoColumnDistance=function(a,b,c){for(var f=e(b,c),g=d(b,c),h=0,i=f;g>i;i++)h+=a.getColumnWidth(i,3)*this._zoomFactor;return h},i.prototype._getTwoRowDistance=function(a,b,c){for(var f=e(b,c),g=d(b,c),h=0,i=f;g>i;i++)h+=a.getRowHeight(i,3)*this._zoomFactor;return h},i.prototype._getViewportRect=function(b,c){var d=this,e=d._comment,f=e._sheet,g=d._commentManager,h=(g.getCommentView(e),f._getSheetLayout()),i=new a.Rect(0,0,0,0);return i=h.viewportRect(b,c),0===b&&0===c||0===b&&2===c||2===b&&0===c||2===b&&2===c?(i.x=0,i.y=0,i.width=h.frozenWidth+h.viewportWidth+h.frozenTrailingWidth,i.height=h.frozenHeight+h.viewportHeight+h.frozenTrailingHeight):0===b&&1===c||2===b&&1===c?(i.x=h.frozenWidth,i.y=0,i.width=h.viewportWidth,i.height=h.frozenHeight+h.viewportHeight+h.frozenTrailingHeight):1===b&&0===c||1===b&&2===c?(i.x=0,i.y=h.frozenHeight,i.width=h.frozenWidth+h.viewportWidth+h.frozenTrailingWidth,i.height=h.viewportHeight):1===b&&1===c&&(i.x=h.frozenWidth,i.y=h.frozenHeight,i.width=h.viewportWidth,i.height=h.viewportHeight),i
},i.prototype._setDomStyle=function(a){var b=this,c=b._comment,d=$(a);(a===b._editor||a===b._host)&&(a===b._editor?a.value=c.text():a.innerHTML=c.text().replace(/\r\n|\n|\r/g,"<br/>"),d.css("font-family",c.fontFamily()).css("font-style",c.fontStyle()).css("font-size",c.fontSize()).css("font-weight",c.fontWeight()).css("color",c.foreColor()).css("background-color",c.backColor()).css("text-align",c.horizontalAlign()).css("text-decoration",c.textDecoration()),c.padding()?d.css("padding",c.padding().toString()):d.css("padding","0px"))},i.prototype.isOpen=function(){var a=this;return a._floatBlockCanvasContainer&&a._floatBlockCanvasContainer.parentNode?!0:!1},i.prototype.isActive=function(){var a=this;return a.isOpen()&&a._comment===a._commentManager.getActiveComment()?!0:!1},i.prototype.isEditing=function(){var a=this;return a.isActive()?$(a._hostContainer).find("textarea").length>0:!1},i.prototype.getCommentRect=function(){var c=this,d=c._comment,e=(d&&d._sheet,c._zoomFactor,b);if(c.isOpen()){var f=c._comment._sheet._getSheetLayout();e=new a.Rect(c._absLocation.x+f.headerX+f.rowHeaderWidth,c._absLocation.y+f.headerY+f.colHeaderHeight,c._getActualWidth(),c._getActualHeight())}return e},i.prototype.getCommentEditAreaRect=function(){var c=this,d=c._comment,e=(d&&d._sheet,c._zoomFactor);if(c.isOpen()){var f=c.getCommentRect();if(f){var g,h,i,j,k=(c._hostMargin+d.borderWidth())*e,l=(c._hostMargin+d.borderWidth())*e;return g=f.x+k,h=f.y+l,i=f.width-2*k,j=f.height-2*l,new a.Rect(g,h,i,j)}}return b},i.prototype._setCursorState=function(a){var b=this,c=b._comment,d=c._sheet,e=a.target,f=b._commentManager._mouseCapture;if(f.capture)return void((e.className===b._hostClassName||e.className===b._floatBlockCanvasClassName||e.className===b._lineCanvasClassName||"gc-spread-floatPanel"===e.className)&&(e.style.cursor=f.resizeDirct>=0?"crosshair":"move"));if(e.className===b._hostClassName)return d.isProtected&&c.lockText()?void(e.style.cursor=c.locked()?"default":"move"):void(e.style.cursor="text");if(e.className===b._floatBlockCanvasClassName||e.className===b._hostContainerClassName){if(d.isProtected&&c.locked())return void(e.style.cursor="default");var g=b._getResizeDirection(a);switch(g){case 0:return void(e.style.cursor="nw-resize");case 1:return void(e.style.cursor="ne-resize");case 2:return void(e.style.cursor="sw-resize");case 3:return void(e.style.cursor="se-resize");case 4:return void(e.style.cursor="w-resize");case 5:return void(e.style.cursor="e-resize");case 6:return void(e.style.cursor="n-resize");case 7:return void(e.style.cursor="s-resize");default:return void(e.style.cursor="move")}}e.style.cursor="default"},i.prototype._doMouseDownToEdit=function(b){var c=this,d=c._comment,e=d&&d._sheet;return e.endEdit(),e.unSelectAllFloatingObjects(),c._commentManager.activateComment(d),d.commentState(2),c._doMouseUp(b),a.util.cancelDefault(b)},i.prototype._doMouseDownToDragOrResize=function(b){var c=this,d=c._comment,e=d&&d._sheet,f=c._zoomFactor,g=c._commentManager,h=g._mouseCapture;e.endEdit(),e.unSelectAllFloatingObjects(),h.x=b.pageX/f,h.y=b.pageY/f,h.cachedRect=new a.Rect(d.location().x,d.location().y,d.width(),d.height()),h.resizeDirct=c._getResizeDirection(b),c._handleDocumentMouseMove(),h.capture=!0,c._setCursorState(b),g.activateComment(d),d.commentState(1),e.isProtected&&d.locked()||(c._moveInfo={},c._moveInfo.startTopRow=e.getViewportTopRow(c._rowViewportIndex),c._moveInfo.startLeftColumn=e.getViewportLeftColumn(c._columnViewportIndex),c._drawMoveResizeContainer(),-100===h.resizeDirct?c._isMoving=!0:c._isResizing=!0);var i=e._eventHandler,j=i._getCanvasOffset(),k=new a.Point(b.pageX-j.left,b.pageY-j.top),l=e.hitTest(k.x,k.y);i.startHitInfo={scrollRowViewportIndex:l.rowViewportIndex,scrollColViewportIndex:l.colViewportIndex,hitTestType:l.hitTestType},i.mousePosition=k,i.startScroll(),i.isCommentWorking=!0,b.stopPropagation()},i.prototype._getAjustedLocationWhenMovingComment=function(b){var c=this,d=c._comment,e=d&&d._sheet,f=c._hostMargin,g=e._getSheetLayout(),h=c._getViewportRect(c._rowViewportIndex,c._columnViewportIndex),i=c._getSheetWidth(e),j=c._getSheetHeight(e),k=c._getCellRect(e,0,0,c._rowViewportIndex,c._columnViewportIndex),l=b.x+(0-(k.x-g.rowHeaderWidth))+d.width()-f,m=b.y+(0-(k.y-g.colHeaderHeight))+d.height()-f,n=b.x,o=b.y;if(1===c._columnViewportIndex){b.x<h.x-f&&(n=h.x-f);var p=c._getViewportWidth(2);l>i-p&&(n-=l-(i-p))}else 0===c._columnViewportIndex?(b.x<0-f&&(n=0-f),l>g.width-g.rowHeaderWidth&&(n-=l-(g.width-g.rowHeaderWidth))):2===c._columnViewportIndex&&(b.x<0-f&&(n=0-f),l>i&&(n-=l-i));if(1===c._rowViewportIndex){b.y<h.y-f&&(o=h.y-f);var q=c._getViewportHeight(2);m>j-q&&(o-=m-(j-q))}else 0===c._rowViewportIndex?(b.y<0-f&&(o=0-f),m>g.height-g.colHeaderHeight&&(o-=m-(g.height-g.colHeaderHeight))):2===c._rowViewportIndex&&(b.y<0-f&&(o=0-f),m>j&&(o-=m-j));return new a.Point(n,o)},i.prototype._getAdjustedRectWhenResizingComment=function(b,c,d){var e,f,g,h,i=this,j=i._comment,k=j&&j._sheet,l=i._hostMargin,m=i._zoomFactor,n=k._getSheetLayout(),o=i._getViewportRect(i._rowViewportIndex,i._columnViewportIndex),p=i._getSheetWidth(k),q=i._getSheetHeight(k),r=i._getCellRect(k,0,0,i._rowViewportIndex,i._columnViewportIndex),s=b.x,t=b.y,u=c*m,v=d*m,w=b.x+(0-(r.x-n.rowHeaderWidth))+u-l,x=b.y+(0-(r.y-n.colHeaderHeight))+v-l;if(1===i._columnViewportIndex){e=o.x-l,b.x<e&&(s=e,u-=e-b.x);var y=i._getViewportWidth(2);g=p-y,w>g&&(u-=w-g)}else 0===i._columnViewportIndex?(e=0-l,b.x<e&&(s=e,u-=e-b.x),g=n.width-n.rowHeaderWidth,w>g&&(u-=w-g)):2===i._columnViewportIndex&&(e=0-l,b.x<e&&(s=e,u-=e-b.x),g=p,w>g&&(u-=w-g));if(1===i._rowViewportIndex){f=o.y-l,b.y<f&&(t=f,v-=f-b.y);var z=i._getViewportHeight(2);h=q-z,x>h&&(v-=x-h)}else 0===i._rowViewportIndex?(f=0-l,b.y<f&&(t=f,v-=f-b.y),h=n.height-n.colHeaderHeight,x>h&&(v-=x-h)):2===i._rowViewportIndex&&(f=0-l,b.y<f&&(t=f,v-=f-b.y),h=q,x>h&&(v-=x-h));return new a.Rect(s,t,u/m,v/m)},i.prototype._doMoveResizeComment=function(b){var c=this,d=c._comment,e=d&&d._sheet,f=c._zoomFactor,g=e._commentManager,h=g._mouseCapture,i=g.getActiveComment();if(h.capture&&i){var j=e._commentManager.getCommentView(i),k=(j._absLocation,j._hostMargin,j._moveInfo.startTopRow),l=e.getViewportTopRow(j._rowViewportIndex),m=j._moveInfo.startLeftColumn,n=e.getViewportLeftColumn(j._columnViewportIndex),o=j._getTwoRowDistance(e,k,l),p=j._getTwoColumnDistance(e,m,n),q=b.pageX/f-h.x,r=b.pageY/f-h.y;if(n>m?q+=p:q-=p,l>k?r+=o:r-=o,0!==q||0!==r)if(-100==h.resizeDirct){var s=h.cachedRect.x+q,t=h.cachedRect.y+r,u=j._convertRelLocationToAbsLocation(new a.Point(s,t)),v=j._getAjustedLocationWhenMovingComment(u),w=j._convertAbsLocationToRelLocation(v);(w.x!==i.location().x||w.x!==i.location().y)&&e._doCommand(new a.UndoRedo.CommentPropertyUndoAction(e,i,i.location().clone(),w,"location"))}else{i._autoSize=!1;var x;switch(h.resizeDirct){case 0:x=j._getCommentTopLeftResizeRect(q,r);break;case 1:x=j._getCommentTopRightResizeRect(q,r);break;case 2:x=j._getCommentBottomLeftResizeRect(q,r);break;case 3:x=j._getCommentBottomRightResizeRect(q,r);break;case 4:x=j._getCommentMiddleLeftResizeRect(q);break;case 5:x=j._getCommentMiddleRightResizeRect(q);break;case 6:x=j._getCommentTopCenterResizeRect(r);break;case 7:x=j._getCommentBottomCenterResizeRect(r)}var u=j._convertRelLocationToAbsLocation(new a.Point(x.x,x.y)),y=j._getAdjustedRectWhenResizingComment(u,x.width,x.height),w=j._convertAbsLocationToRelLocation(new a.Point(y.x,y.y)),z=new a.UndoRedo.CommentUndoTransaction;(w.x!==i.location().x||w.y!==i.location().y)&&z.add(new a.UndoRedo.CommentPropertyUndoAction(e,i,i.location().clone(),w,"location")),y.width!==i.width()&&z.add(new a.UndoRedo.CommentPropertyUndoAction(e,i,i.width(),y.width,"width")),y.height!==i.height()&&z.add(new a.UndoRedo.CommentPropertyUndoAction(e,i,i.height(),y.height,"height")),e._doCommand(z)}}},i.prototype._doMouseMove=function(b){var c=this,d=c._comment._sheet;if(this._setCursorState(b),!(d.getSelections()&&d.getSelections().length>0)){var e=c._commentManager,f=b.target,g=e.getActiveComment(),h=d._eventHandler,i=h._getCanvasOffset(),j=new a.Point(b.pageX-i.left,b.pageY-i.top);if(f&&g&&e._mouseCapture.capture){var k=e.getCommentView(g);k&&k._moveResizeContainerDom&&this._doMoveResizeContainer(b),1===k._rowViewportIndex&&(h.mousePosition.y=j.y),1===k._columnViewportIndex&&(h.mousePosition.x=j.x),h.continueScroll()}return a.util.cancelDefault(b)}},i.prototype._doMouseUp=function(b){var c=this,d=c._comment._sheet;if(!(d.getSelections()&&d.getSelections().length>0)){var e=b.target,f=c._commentManager,g=f.getActiveComment(),h=d._eventHandler;if(h.isCommentWorking=!1,h.stopScroll(),e&&g){c._doMoveResizeComment(b);var i=f.getCommentView(g);i&&i._moveResizePanelDom&&($(i._moveResizePanelDom).remove(),i._moveResizePanelDom=null,i._isMoving=!1,i._isResizing=!1),c._unhandleDocumentMouseMove(),f._mouseCapture.capture=!1,c._setCursorState(b)}return a.util.cancelDefault(b)}},i.prototype._getResizeDirection=function(a){var b=this;if(b._resizeHitRects.length>0&&(1===b._adornerDrawState||2===b._adornerDrawState)){var c=a.target,d=a.pageX-$(c).offset().left,e=a.pageY-$(c).offset().top,f=b._resizeHitRects[0];if(f&&f.contains(d,e))return 0;if(f=b._resizeHitRects[1],f&&f.contains(d,e))return 1;if(f=b._resizeHitRects[2],f&&f.contains(d,e))return 2;if(f=b._resizeHitRects[3],f&&f.contains(d,e))return 3;if(f=b._resizeHitRects[4],f&&f.contains(d,e))return 4;if(f=b._resizeHitRects[5],f&&f.contains(d,e))return 5;if(f=b._resizeHitRects[6],f&&f.contains(d,e))return 6;if(f=b._resizeHitRects[7],f&&f.contains(d,e))return 7}return-100},i.prototype._getCommentTopLeftResizeRect=function(b,c){var d,e,f,g,h=this,i=h._commentManager._mouseCapture,j=i.cachedRect.width-2*h._hostMargin-b,k=i.cachedRect.height-2*h._hostMargin-c;return j>=0?(d=i.cachedRect.x+b,f=j+2*h._hostMargin):(d=i.cachedRect.x+i.cachedRect.width-2*h._hostMargin,f=-j+2*h._hostMargin),k>=0?(e=i.cachedRect.y+c,g=k+2*h._hostMargin):(e=i.cachedRect.y+i.cachedRect.height-2*h._hostMargin,g=-k+2*h._hostMargin),new a.Rect(d,e,f,g)},i.prototype._getCommentTopRightResizeRect=function(b,c){var d,e,f,g,h=this,i=h._commentManager._mouseCapture,j=i.cachedRect.width-2*h._hostMargin+b,k=i.cachedRect.height-2*h._hostMargin-c;return j>=0?(d=i.cachedRect.x,f=j+2*h._hostMargin):(d=i.cachedRect.x+j,f=-j+2*h._hostMargin),k>=0?(e=i.cachedRect.y+c,g=k+2*h._hostMargin):(e=i.cachedRect.y+i.cachedRect.height-2*h._hostMargin,g=-k+2*h._hostMargin),new a.Rect(d,e,f,g)},i.prototype._getCommentBottomLeftResizeRect=function(b,c){var d,e,f,g,h=this,i=h._commentManager._mouseCapture,j=i.cachedRect.width-2*h._hostMargin-b,k=i.cachedRect.height-2*h._hostMargin+c;return j>=0?(d=i.cachedRect.x+b,f=j+2*h._hostMargin):(d=i.cachedRect.x+i.cachedRect.width-2*h._hostMargin,f=-j+2*h._hostMargin),k>=0?(e=i.cachedRect.y,g=k+2*h._hostMargin):(e=i.cachedRect.y+k,g=-k+2*h._hostMargin),new a.Rect(d,e,f,g)},i.prototype._getCommentBottomRightResizeRect=function(b,c){var d,e,f,g,h=this,i=h._commentManager._mouseCapture,j=i.cachedRect.width-2*h._hostMargin+b,k=i.cachedRect.height-2*h._hostMargin+c;return j>=0?(d=i.cachedRect.x,f=j+2*h._hostMargin):(d=i.cachedRect.x+j,f=-j+2*h._hostMargin),k>=0?(e=i.cachedRect.y,g=k+2*h._hostMargin):(e=i.cachedRect.y+k,g=-k+2*h._hostMargin),new a.Rect(d,e,f,g)},i.prototype._getCommentMiddleLeftResizeRect=function(b){var c,d,e,f,g=this,h=g._commentManager._mouseCapture,i=h.cachedRect.width-2*g._hostMargin-b;return i>=0?(c=h.cachedRect.x+b,e=i+2*g._hostMargin):(c=h.cachedRect.x+h.cachedRect.width-2*g._hostMargin,e=-i+2*g._hostMargin),d=h.cachedRect.y,f=h.cachedRect.height,new a.Rect(c,d,e,f)},i.prototype._getCommentMiddleRightResizeRect=function(b){var c,d,e,f,g=this,h=g._commentManager._mouseCapture,i=h.cachedRect.width-2*g._hostMargin+b;return i>=0?(c=h.cachedRect.x,e=i+2*g._hostMargin):(c=h.cachedRect.x+i,e=-i+2*g._hostMargin),d=h.cachedRect.y,f=h.cachedRect.height,new a.Rect(c,d,e,f)},i.prototype._getCommentTopCenterResizeRect=function(b){var c,d,e,f,g=this,h=g._commentManager._mouseCapture,i=h.cachedRect.height-2*g._hostMargin-b;return c=h.cachedRect.x,e=h.cachedRect.width,i>=0?(d=h.cachedRect.y+b,f=i+2*g._hostMargin):(d=h.cachedRect.y+h.cachedRect.height-2*g._hostMargin,f=-i+2*g._hostMargin),new a.Rect(c,d,e,f)},i.prototype._getCommentBottomCenterResizeRect=function(b){var c,d,e,f,g=this,h=g._commentManager._mouseCapture,i=h.cachedRect.height-2*g._hostMargin+b;return c=h.cachedRect.x,e=h.cachedRect.width,i>=0?(d=h.cachedRect.y,f=i+2*g._hostMargin):(d=h.cachedRect.y+i,f=-i+2*g._hostMargin),new a.Rect(c,d,e,f)},i.prototype._attachMouseWheelEvent=function(b){var c=this,d=this._comment._sheet;if(b){var e="";switch(b){case c._floatBlockCanvas:e=".floatBlockCanvas";case c._hostContainer:e=".hostContainer";case c._lineCanvasContainer:e=".lineCanvasContainer";case c._host:e=".host";case c._editor:e=".editor"}e&&($(b).unbind("gcmousewheel"+e),$(b).bind("gcmousewheel"+e,function(b){d._mouseWheelDelegate(b.originalEvent),a.util.cancelDefault(b)}))}},i.prototype._attachFloatBlockCanvasEventHandler=function(){var a=this,b=a._comment,c=b&&b&&b._sheet;a._detachFloatBlockCanvasEventHandler();var d=".floatBlockCanvas";$(a._floatBlockCanvas).bind("mousedown"+d,function(b){a._doMouseDownToDragOrResize(b)}).bind("mousemove"+d,function(b){a._doMouseMove(b)}).bind("mouseup"+d,function(b){a._doMouseUp(b)}).bind("gcmousewheel"+d,function(a){c&&c._mouseWheelDelegate(a.originalEvent)})},i.prototype._detachFloatBlockCanvasEventHandler=function(){var a=this;$(a._floatBlockCanvas).unbind(".floatBlockCanvas")},i.prototype._attachHostContainerEventHandler=function(){var a=this,b=a._comment,c=b&&b._sheet;a._detachHostContainerEventHandler();var d=".hostContainer";$(a._hostContainer).bind("mousedown"+d,function(b){a._doMouseDownToDragOrResize(b)}).bind("mousemove"+d,function(b){a._doMouseMove(b)}).bind("mouseup"+d,function(b){a._doMouseUp(b)}).bind("gcmousewheel"+d,function(a){c&&c._mouseWheelDelegate(a.originalEvent)})},i.prototype._detachHostContainerEventHandler=function(){var a=this;$(a._hostContainer).unbind(".hostContainer")},i.prototype._attachLineCanvasEventHandler=function(){var a=this,b=a._comment,c=b&&b._sheet;if(a._detachLineCanvasEventHandler(),c){var d=c._eventHandler._getCanvasOffset(),e=".lineCanvas";$(a._lineCanvas).bind("mousedown"+e,function(b){var e=c.hitTest(b.pageX-d.left,b.pageY-d.top),f=e.commentHitInfo;if(f){var g=f.comment,h=c._commentManager.getCommentView(g);"editArea"===f.area?h._doMouseDownToEdit(b):"moveResizeArea"===f.area&&h._doMouseDownToDragOrResize(b),$(h._floatBlockCanvasContainer).css("z-index",parseInt($(a._lineCanvasContainer).css("z-index")+1))}else c._mouseDownDelegate(b)}).bind("mousemove"+e,function(b){var e=c.hitTest(b.pageX-d.left,b.pageY-d.top),f=e.commentHitInfo;if(f){var g=f.comment,h=c._commentManager.getCommentView(g);h._doMouseMove(b),"editArea"===f.area?a._lineCanvas.style.cursor="text":"moveResizeArea"===f.area&&(a._lineCanvas.style.cursor="move")}else{c._mouseMoveDelegate(b);var i=c._getCanvas();i&&(a._lineCanvas.style.cursor=i.style.cursor)}}).bind("mouseup"+e,function(a){var b=c.hitTest(a.pageX-d.left,a.pageY-d.top),e=b.commentHitInfo;if(e){var f=e.comment,g=c._commentManager.getCommentView(f);g._doMouseUp(a)}else c._mouseUpDelegate(a)}).bind("dblclick"+e,function(a){c._dblClickDelegate(a)}).bind("gcmousewheel"+e,function(a){c._mouseWheelDelegate(a.originalEvent)})}},i.prototype._detachLineCanvasEventHandler=function(){var a=this;$(a._lineCanvas).unbind(".lineCanvas")},i.prototype._attachHostEventHandler=function(){var a=this,b=a._comment,c=b&&b._sheet;if(2!==b.commentState()&&a._host){a._detachHostEventHandler();var d=".host";$(a._host).bind("mousedown"+d,function(b){a._doMouseDownToEdit(b)}).bind("mousemove"+d,function(b){a._doMouseMove(b)}).bind("mouseup"+d,function(b){a._doMouseUp(b)}).bind("gcmousewheel"+d,function(a){c&&c._mouseWheelDelegate(a.originalEvent)})}},i.prototype._detachHostEventHandler=function(){var a=this,b=a._comment;2!==b.commentState()&&a._host&&$(a._host).unbind(".host")},i.prototype._attachEditorEventHandler=function(){var a=this,b=a._comment,c=b&&b._sheet,d=a._editor;if(2===b.commentState()&&d){this._detachEditorEventHandler();var e=".editor";$(d).bind("mousedown"+e,function(a){a.stopPropagation()}).bind("mousemove"+e,function(a){a.stopPropagation()}).bind("mouseup"+e,function(a){a.stopPropagation()}).bind("gcmousewheel"+e,function(a){c&&c._mouseWheelDelegate(a.originalEvent)}).bind("input"+e,function(){b.autoSize()&&a._doAutoSizeEditor()}).bind("keydown"+e,function(a){(27===a.keyCode||9===a.keyCode)&&(b.commentState(1),window.gcGlobal.activeElement=c)})}},i.prototype._doAutoSizeEditor=function(){var a,b,c=this,e=c._comment,f=e&&e._sheet,g=c._editor,h=g.style,i=$(g).height(),j=$(g).width(),k=0;if(h.font)k=f._getFontHeight(h.font);else{var l="";e.fontStyle()&&(l+=" "+e.fontStyle()),e.fontWeight()&&(l+=" "+e.fontWeight()),e.fontSize()&&(l+=" "+e.fontSize()),e.fontFamily()&&(l+=" "+e.fontFamily()),k=f._getFontHeight(l)}var m=k,n=5,o=[];if(o=g.value.split("\n"),o&&o.length>0){a=d(o.length*k,m);for(var p=0,q=0;q<o.length;q++){var r=f._getStringWidth(o[q],h.font);r>p&&(p=r)}b=d(p,n)}else a=m,b=n;$(g).css("height",a).css("width",b),$(c._host).css("height","auto").css("width","auto"),e._text=g.value;var s=b-j;0!==s&&e._changeProperty("width",e.width()+s);var t=a-i;0!==t&&e._changeProperty("height",e.height()+t)},i.prototype._detachEditorEventHandler=function(){var a=this,b=a._comment,c=a._editor;2===b.commentState()&&c&&$(c).unbind(".editor")},i.prototype._handleDocumentMouseMove=function(){var a=this,b=this._commentManager._mouseCapture;if(!b.capture){var c=".gcComment";$(document).bind("mousemove"+c,function(b){a._doMouseMove(b)}).bind("mouseup"+c,function(b){a._doMouseUp(b)}),b.capture=!0}},i.prototype._unhandleDocumentMouseMove=function(){var a=this._commentManager._mouseCapture;a.capture&&(a.capture=!1,$(document).unbind(".gcComment"))},i}();a.CommentView=l;var m=function(){function a(a){var c=this;c._sheet=a,c._mouseCapture={capture:!1,x:0,y:0,cachedRect:b,resizeDirct:-100},c._editorDom=b,c._hoverShowComment=b,c._activeComment=b,c._commentList=[],c._commentViewList=[],c.createEditDom()}return a.prototype.createEditDom=function(){var a=document.createElement("textarea");$(a).addClass("gc-comment-editor").css("left",0).css("top",0).css("position","absolute").css("margin",0).css("padding",0).css("word-wrap","break-word").css("word-break","normal").css("overflow","hidden").css("resize","none").css("outline","none").css("border","0px").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this._editorDom=a},a.prototype.getCommentList=function(){for(var a=this,b=[],c=0;c<a._commentList.length;c++)b.push(a._commentList[c]);return b},a.prototype.getHoverShownComment=function(){return this._hoverShowComment},a.prototype._addCommentView=function(a){var b=this;a&&-1===b._commentViewList.indexOf(a)&&this._commentViewList.push(a)},a.prototype._removeCommentView=function(a){this._commentViewList.splice(this._commentViewList.indexOf(a),1)},a.prototype.getCommentView=function(a){if(!a)return b;for(var c=0;c<this._commentViewList.length;c++){var d=this._commentViewList[c];if(d.getComment()===a)return d}return b},a.prototype.hasComment=function(){return this._commentList.length>0},a.prototype.addComment=function(a,b,c){var d=this;c&&!d.containsComment(c)&&(c._sheet=d._sheet,c._rowIndex=a,c._colIndex=b,c._zIndex=898,d._updateCommentZIndex(),d._commentList.push(c),d._sheet.invalidate())},a.prototype._updateCommentZIndex=function(){for(var a=this,b=a._commentList,c=0;c<b.length;c++)b[c]._zIndex--},a.prototype._getTopCommentZIndex=function(){var a=this;if(a._commentList.length>0){for(var b=a._commentList[0].zIndex(),c=1;c<a._commentList.length;c++){var d=a._commentList[c];b<d.zIndex()&&(b=d.zIndex())}return b}return 0},a.prototype.removeComment=function(a){var b=this,c=b._commentList;if(a){b.hideComment(a),c.splice(c.indexOf(a),1);var d=b.getCommentView(a);d&&b._removeCommentView(d)}},a.prototype.containsComment=function(a){var b=this;return-1!==b._commentList.indexOf(a)?!0:!1},a.prototype.clear=function(a,c,d,e){var f=this,g=f._sheet,h=g.isPaintSuspended();g.isPaintSuspended(!0);for(var i=0;d>i;i++)for(var j=0;e>j;j++){var k=g.getComment(i+a,j+c);k&&(f.removeComment(k),g.setComment(i+a,j+c,b))}g.isPaintSuspended(h)},a.prototype.addRows=function(a,b){for(var c=this,d=c._commentList,e=c._commentViewList,f=0;f<d.length;f++){var g=d[f];a<=g._rowIndex&&(g._rowIndex+=b)}for(var f=0;f<e.length;f++){var h=e[f];h.isOpen()&&h.addRows(a,b)}},a.prototype.addColumns=function(a,b){for(var c=this,d=c._commentList,e=c._commentViewList,f=0;f<d.length;f++){var g=d[f];a<=g._colIndex&&(g._colIndex+=b)}for(var f=0;f<e.length;f++){var h=e[f];h.isOpen()&&h.addColumns(a,b)}},a.prototype.removeRows=function(a,b){for(var c=this,d=c._commentList,e=c._commentViewList,f=0;f<d.length;f++){var g=d[f];g._rowIndex>=a&&g._rowIndex<a+b&&(c.removeComment(g),f--)}for(var f=0;f<d.length;f++){var g=d[f];a<g._rowIndex&&(g._rowIndex-=b)}for(var f=0;f<e.length;f++){var h=e[f];h.isOpen()&&h.removeRows(a,b)}},a.prototype.removeColumns=function(a,b){for(var c=this,d=c._commentList,e=c._commentViewList,f=0;f<d.length;f++){var g=d[f];g._colIndex>=a&&g._colIndex<a+b&&(c.removeComment(g),f--)}for(var f=0;f<d.length;f++){var g=d[f];a<g._colIndex&&(g._colIndex-=b)}for(var f=0;f<e.length;f++){var h=e[f];h.isOpen()&&h.removeColumns(a,b)}},a.prototype.getActiveComment=function(){return this._activeComment},a.prototype.activateComment=function(a){var b=this;a&&a!==b._activeComment&&(b.deactivateComment(),b._activeComment=a)},a.prototype.deactivateComment=function(){var a=this,c=a._activeComment;if(c){var d=a.getCommentView(c);!d||d._isMoving||d._isResizing||(d.isEditing()&&d.detachEditor(),c.commentState(3),a._activeComment=b)}},a.prototype.showComment=function(a){var b=this;if(a){var c=b.getCommentView(a);c||(c=new l(a,b),b._addCommentView(c)),c.open()}},a.prototype.showAllComments=function(){for(var a=0;a<this._commentList.length;a++)this.showComment(this._commentList[a])},a.prototype.hideComment=function(a){var c=this,d=c.getCommentView(a);d&&d.isOpen()&&(d.close(),a===c._activeComment&&c._sheet._loadAndSetSheetSelections()),clearTimeout(a._timeout),a._timeout=b},a.prototype.hideAllComments=function(){for(var a=0;a<this._commentList.length;a++)this.hideComment(this._commentList[a])},a.prototype.hoverShowComment=function(a){var c=this,d=c._activeComment;if(d)if(1===d.displayMode()){if(2===d.commentState())return}else if(2===d.commentState()||1===d.commentState())return;a!==c._hoverShowComment&&(c._hoverShowComment&&c.hideComment(c._hoverShowComment),a&&2==a.displayMode()?c._mouseCapture.capture||a._timeout||(c._hoverShowComment=a,a._timeout=setTimeout(function(){c.showComment(a)},200)):c._hoverShowComment=b)},a.prototype._isHitTestComment=function(a,b,c){var d=this.getCommentView(a);if(d){var e=d.getCommentRect();if(e)return e.contains(b,c)}return!1},a.prototype._isHitTestCommentEditArea=function(a,b,c){var d=this.getCommentView(a);if(d){var e=d.getCommentEditAreaRect();if(e)return e.contains(b,c)}return!1},a.prototype.getCommentHitInfo=function(a,c){for(var d=this,e=b,f=0;f<d._commentList.length;f++){var g=d._commentList[f];d._isHitTestComment(g,a,c)&&(e?g.zIndex()>e.zIndex()&&(e=g):e=g)}return e?d._isHitTestCommentEditArea(e,a,c)?{x:a,y:c,comment:e,area:"editArea"}:{x:a,y:c,comment:e,area:"moveResizeArea"}:b},a.prototype.getCommentActualZIndex=function(a){var b=this,c=(b._sheet,b._getTopCommentZIndex());return a===b._hoverShowComment?c+2:a===b._activeComment?c+1:a.zIndex()},a.prototype.updateCommentsLayoutWhenRowColumnChanged=function(){for(var a=this._commentViewList,b=0;b<a.length;b++){var c=a[b];c.updateLayoutWhenRowColumnChanged()}},a.prototype.updateCommentsLayoutWhenSheetScroll=function(){for(var a=this._commentViewList,b=0;b<a.length;b++){var c=a[b];c.updateLayoutWhenSheetScroll()}},a.prototype.fromJSON=function(a){if(!a)return null;for(var b=0;b<a.length;b++){var c=new k;c.fromJSON(a[b]),(1===c.commentState()||2===c.commentState())&&(this._activeComment=c),this._sheet.setComment(c._rowIndex,c._colIndex,c)}},a.prototype.toJSON=function(){for(var a=[],b=0;b<this._commentList.length;b++)a.push(this._commentList[b].toJSON());return 0===a.length?c:a},a}();a.CommentManager=m;var n=function(){function a(a){this._sheet=b;var c=this;c._commentLayoutPanel=c._createCommentLayoutPanel(),a.appendChild(c._commentLayoutPanel)}return a.prototype._createCommentLayoutPanel=function(){var a=document.createElement("div");return $(a).addClass("comment-layoutPanel").css("position","absolute").css("left",0).css("top",0).css("height",0).css("width",0).css("overflow","visible").css("z-index",701),a},a.prototype.renderCommentFloatPanel=function(a){var b=this,c=b._sheet||a;if(c._commentManager.hasComment()){var d=a._getSheetLayout();if($(b._commentLayoutPanel).css("left",d.x+d.rowHeaderWidth).css("top",d.y+d.colHeaderHeight),b._sheet!==a){var e;if(b._sheet&&(e=b._sheet._commentManager),e){var f=e.getActiveComment();f&&2===f.commentState()&&f._changeProperty("commentState",1)}b._sheet=a}}},a.prototype.renderCommentCellAdorner=function(a,b,c){var d=c.row,e=c.col,f=c.x,g=c.y,h=c.width,i=c.height,j=this;if(3===b&&j._sheet){var k=j._sheet.getComment(d,e);if(k){var l=6;a&&h>0&&i>0&&(a.save(),a.rect(f,g,h,i),a.clip(),a.fillStyle="red",a.beginPath(),a.moveTo(f+h-l,g),a.lineTo(f+h,g),a.lineTo(f+h,g+l),a.lineTo(f+h-l,g),a.fill(),a.restore())}}},a.prototype.renderComment=function(a){for(var c=this._sheet,d=a.getCommentList(),e=0;e<d.length;e++){var f=d[e],g=a.getCommentView(f);this._canShowComment(a,f)?(1===f.displayMode()&&f===a.getHoverShownComment()&&(a._hoverShowComment=b),g&&g.isOpen()?g.updateLayout():a.showComment(f)):g&&g.isOpen()&&a.hideComment(f)}var h=a.getActiveComment();if(h){var i=a.getCommentView(h);i&&i.isOpen()&&c.getSelections().length>0&&c._selectionModel.clear()}},a.prototype._canShowComment=function(a,b){var c=this._sheet;if(c.getColumnWidth(b._colIndex)&&c.getRowHeight(b._rowIndex))switch(b.displayMode()){case 1:return!0;case 2:if(2===b.commentState()||1===b.commentState())return a&&b!==a.getHoverShownComment()&&(a._hoverShowComment=b),!0}return!1},a}();a.CommentRender=n}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(b){!function(c){function d(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=0,i=new x(d,e,f);i.moveNext();){var j=i.current();if(b.Convert.isNumber(j)){var k;if(isNaN(k=b.Convert.toDouble(j)))return u;g+=k,h++}else if(b.Convert.isError(j))return j}return 0===h?t:b.Convert.toResult(g/h)}function e(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=p;if(b._Helper._argumentExists(c,1))for(h=new x(d,e,f);h.moveNext();){var i=h.current();b.Convert.isNumber(i)&&g++}else for(h=new x(d,f);h.moveNext();)g++;return b.Convert.toResult(g)}function f(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=p;if(b._Helper._argumentExists(c,1))for(h=new x(d,e,f);h.moveNext();){var i=h.current();i&&g++}else for(h=new x(d,f);h.moveNext();)g++;return b.Convert.toResult(g)}function g(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=p,h=new x(d,e,f);return h.moveNext()?(g=h.current(),h.moveNext()?v:g):u}function h(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=!1,h=-1.79769e308,i=new x(d,e,f);i.moveNext();){var j=i.current();if(b.Convert.isNumber(j)){var k;if(isNaN(k=b.Convert.toDouble(j)))return u;(!g||k>h)&&(h=k),g=!0}else if(b.Convert.isError(j))return j}return g?b.Convert.toResult(h):u}function i(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=!1,h=1.79769e308,i=new x(d,e,f);i.moveNext();){var j=i.current();if(b.Convert.isNumber(j)){var k;if(isNaN(k=b.Convert.toDouble(j)))return u;(!g||h>k)&&(h=k),g=!0}else if(b.Convert.isError(j))return j}return g?b.Convert.toResult(h):u}function j(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=1,h=new x(d,e,f);h.moveNext();){var i=h.current();if(b.Convert.isNumber(i)){var j;if(isNaN(j=b.Convert.toDouble(i)))return u;g*=j}else if(b.Convert.isError(i))return i}return b.Convert.toResult(g)}function k(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=0,i=0,j=new x(d,e,f);j.moveNext();){var k=j.current();if(b.Convert.isNumber(k)){var l;if(isNaN(l=b.Convert.toDouble(k)))return u;g+=l,h+=l*l,i++}else if(b.Convert.isError(k))return k}return 1>=i?t:b.Convert.toResult(r(q(0,(i*h-g*g)/(i*(i-1)))))}function l(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=0,i=0,j=new x(d,e,f);j.moveNext();){var k=j.current();if(b.Convert.isNumber(k)){var l;if(isNaN(l=b.Convert.toDouble(k)))return u;g+=l,h+=l*l,i++}else if(b.Convert.isError(k))return k}return 0>=i?t:b.Convert.toResult(r(q(0,(i*h-g*g)/(i*i))))}function m(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=new x(d,e,f);h.moveNext();){var i=h.current();if(b.Convert.isNumber(i)){var j;if(isNaN(j=b.Convert.toDouble(i)))return u;g+=j}else if(b.Convert.isError(i))return i}return b.Convert.toResult(g)}function n(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=0,i=0,j=new x(d,e,f);j.moveNext();){var k=j.current();if(b.Convert.isNumber(k)){var l;if(isNaN(l=b.Convert.toDouble(k)))return u;g+=l,h+=l*l,i++}else if(b.Convert.isError(k))return k}return 1>=i?t:b.Convert.toResult(q(0,(i*h-g*g)/(i*(i-1))))}function o(c){if(!c[0]||!c[1]||!c[2])throw a.SR.Exp_ArgumentNull;for(var d=b.Convert._toArray(c[0]),e=c[1],f=b.Convert._toArray(c[2]),g=0,h=0,i=0,j=new x(d,e,f);j.moveNext();){var k=j.current();if(b.Convert.isNumber(k)){var l;if(isNaN(l=b.Convert.toDouble(k)))return u;g+=l,h+=l*l,i++}else if(b.Convert.isError(k))return k}return 1>=i?t:b.Convert.toResult(q(0,(i*h-g*g)/(i*i)))}a.feature("calc.functions_db",["calc.functions"]);var p=null,q=Math.max,r=Math.sqrt,s=b.Errors,t=(s.Null,s.DivideByZero),u=s.Value,v=(s.Reference,s.Name,s.NotAvailable,s.Number),w=function(){function a(a,b){this.criteriaOperator=a,this.criteriaValue=b}return a.prototype.evaluate=function(a){var c=this.criteriaOperator.evaluate(a,this.criteriaValue,p);return"boolean"==typeof c?b.Convert.toBool(c):!1},a}(),x=function(){function c(b,c,d){this.row=0;var e=this;if(e.database=b,e.field=c,e.criteria=d,3===arguments.length){if(e.column=e.columnIndex(b,c),b.getRowCount()<2||b.getColumnCount()<1)throw a.SR.Exp_InvalidCast;if(d.getRowCount()<2||d.getColumnCount()<1)throw a.SR.Exp_InvalidCast;if(e.column<0||e.database.getColumnCount()<=e.column)throw a.SR.Exp_InvalidCast}else{if(2!==arguments.length)throw a.SR.Exp_InvalidNull;if(e.column=-1,b.getRowCount()<2||b.getColumnCount()<1)throw a.SR.Exp_InvalidCast;if(d.getRowCount()<2||d.getColumnCount()<1)throw a.SR.Exp_InvalidCast}}return c.prototype.columnIndex=function(a,c){if("string"==typeof c){for(var d=0;d<a.getColumnCount();d++){var e=b.Convert.toString(a.getValue(0,d));if(e&&this.ignoreCaseEqual(e,c))return d}return-1}return b.Convert.toInt(c)-1},c.prototype.current=function(){var b=this;if(b.row<=0||b.database.getRowCount()<=b.row)throw a.SR.Exp_InvalidOperation;return b.database.getValue(b.row,b.column)},c.prototype.moveNext=function(){for(var a=this,b=!1;!b&&a.row<a.database.getRowCount();)a.row++,a.row<a.database.getRowCount()&&(b=a.rowMeetsCriteria());
return b},c.prototype.createEvaluator=function(d){if("string"==typeof d){for(var e=b.Convert.toString(d),f=new a._StringHelper(e),g=0,h=0;h<c.operators.length;h++)if(f.startsWith(c.operators[h].getName()))return e=e.substring(c.operators[h].getName().length),d=isNaN(g=a._NumberHelper.parseInvariant(e))?this.ignoreCaseEqual("true",e)?!0:this.ignoreCaseEqual("false",e)?!1:e:g,new w(c.operators[h],d);return new w(b.Operators.equal,d)}return d?new w(b.Operators.equal,d):p},c.prototype.rowMeetsCriteria=function(){for(var a=this,b=!1,c=1;!b&&c<a.criteria.getRowCount();c++){b=!0;for(var d=0;b&&d<a.criteria.getColumnCount();d++){var e=a.createEvaluator(a.criteria.getValue(c,d));if(e){var f=a.columnIndex(a.database,a.criteria.getValue(0,d)),g=a.database.getValue(a.row,f);b=e.evaluate(g)}}}return b},c.prototype.reset=function(){this.row=0},c.prototype.ignoreCaseEqual=function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a===b},c.operators=[b.Operators.equal,b.Operators.notEqual,b.Operators.lessThanOrEqual,b.Operators.greaterThanOrEqual,b.Operators.lessThan,b.Operators.greaterThan],c}();c.def("DAVERAGE",d,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DCOUNT",e,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DCOUNTA",f,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DGET",g,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DMAX",h,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DMIN",i,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DPRODUCT",j,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DSTDEV",k,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DSTDEVP",l,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DSUM",m,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DVAR",n,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond}),c.def("DVARP",o,{minArgs:3,maxArgs:3,acceptsReference:c.acceptsNotSecond,acceptsArray:c.acceptsNotSecond})}(b.Functions||(b.Functions={}));b.Functions}(a.Calc||(a.Calc={}));a.Calc}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(b){!function(c){function d(){var a=[];return a[0]=.0007969367292973471,a[1]=.08283523921074408,a[2]=1.239533716464143,a[3]=5.447250030587687,a[4]=8.74716500199817,a[5]=5.303240382353949,a[6]=1,a}function e(){var a=[];return a[0]=.0007621256162081731,a[1]=.07313970569409176,a[2]=1.1271960812968493,a[3]=5.112079511468076,a[4]=8.424045901417724,a[5]=5.214515986823615,a[6]=1,a}function f(){var a=[];return a[0]=.0009244088105588637,a[1]=.08562884743544745,a[2]=1.2535274390105895,a[3]=5.470977403304171,a[4]=8.761908832370695,a[5]=5.306052882353947,a[6]=1,a}function g(){var a=[];return a[0]=.0005713231280725487,a[1]=.06884559087544954,a[2]=1.105142326340617,a[3]=5.073863861286015,a[4]=8.399855543276042,a[5]=5.209828486823619,a[6]=1,a}function h(){var a=[];return a[0]=-.011366383889846916,a[1]=-1.2825271867050931,a[2]=-19.553954425773597,a[3]=-93.20601521237683,a[4]=-177.68116798048806,a[5]=-147.07750515495118,a[6]=-51.41053267665993,a[7]=-6.050143506007285,a}function i(){var a=[];return a[0]=.05108625947501766,a[1]=4.982138729512334,a[2]=75.82382841325453,a[3]=366.7796093601508,a[4]=710.8563049989261,a[5]=597.4896124006136,a[6]=211.68875710057213,a[7]=25.207020585802372,a}function j(){var a=[];return a[0]=64.3178256118178,a[1]=856.4300259769806,a[2]=3882.4018360540163,a[3]=7240.467741956525,a[4]=5930.727011873169,a[5]=2062.0933166032783,a[6]=242.0057402402914,a}function k(){var a=[];return a[0]=74.23732770356752,a[1]=1056.4488603826283,a[2]=4986.410583376536,a[3]=9562.318924047562,a[4]=7997.041604473507,a[5]=2826.1927851763908,a[6]=336.0936078106983,a}function l(){var a=[];return a[0]=15592.436785523574,a[1]=-14663929.59039716,a[2]=5435264770.518765,a[3]=-982136065717.9115,a[4]=87590639439536.7,a[5]=-0xc5090e8ec6601,a[6]=0x9d4a5b305a0018,a[7]=-0x41b52d6418d9ec,a}function m(){var a=[];return a[0]=1263204747.9017804,a[1]=-647355876379.1603,a[2]=114509511541823.73,a[3]=-8127702555013251,a[4]=0x2cf35a16e6cd620,a[5]=-0xacf20aeef158b80,a}function n(){var a=[];return a[0]=1041.2835366425984,a[1]=626107.330137135,a[2]=268919633.39381415,a[3]=86400248710.3935,a[4]=20297961275010.555,a[5]=3171577528429750.5,a[6]=0x37a4bf79f36ba00,a}function o(){var a=[];return a[0]=594.3015923461282,a[1]=235564.09294306856,a[2]=73481194.44597217,a[3]=18760131610.870617,a[4]=3882312774962.3857,a[5]=620557727146953.8,a[6]=0xf41f1e2a3d2440,a[7]=0x3721e321ece8fe00,a}function p(){var a=[];return a[0]=-4794432209.782018,a[1]=1956174919465.5657,a[2]=-249248344360967.72,a[3]=9708622510473064,a}function q(){var a=[];return a[0]=-899971225.7055594,a[1]=452228297998.19403,a[2]=-72749424522181.83,a[3]=0xd15a1534be241,a}function r(){var a=[];return a[0]=499.563147152651,a[1]=173785.4016763747,a[2]=48440965.83399621,a[3]=11185553704.535683,a[4]=2112775201154.892,a[5]=310518229857422.56,a[6]=0x710505f9ecba70,a[7]=0x17be34c7b662cc00,a}function s(){var a=[];return a[0]=620.8364781180543,a[1]=256987.25675774884,a[2]=83514679.14319493,a[3]=22151159547.97925,a[4]=4749141220799.914,a[5]=784369607876235.9,a[6]=89522233618462740,a[7]=0x49de55d9c0a4e400,a}function t(a,b,c){var d,e,f=0;d=parseFloat(b[f++]),e=c;do d=d*a+parseFloat(b[f++]);while(0!==--e);return d}function u(a,b,c){var d,e,f=0;d=a+parseFloat(b[f++]),e=c-1;do d=d*a+parseFloat(b[f++]);while(0!==--e);return d}function v(a){var b,c,e,g,i,k=d(),m=f(),o=h(),q=j(),s=(l(),n(),5.783185962946784),v=30.471262343662087,w=p(),x=r(),y=.7853981633974483,z=.7978845608028654;return 0>a&&(a=-a),5>=a?(c=a*a,1e-5>a?1-c/4:(e=(c-s)*(c-v),e=e*t(c,w,3)/u(c,x,8))):(b=5/a,g=25/(a*a),e=t(g,k,6)/t(g,m,6),g=t(g,o,7)/u(g,q,7),i=a-y,e=e*yb(i)-b*g*xb(i),e*z/zb(a))}function w(a){var b,c,d,f,h,j=q(),l=s(),m=i(),n=k(),o=e(),p=g(),r=14.681970642123893,v=49.2184563216946,w=.7978845608028654,x=2.356194490192345;return b=a,0>a&&(b=-a),5>=b?(c=a*a,b=t(c,j,3)/u(c,l,8),b=b*a*(c-r)*(c-v)):(b=5/a,c=b*b,d=t(c,o,6)/t(c,p,6),f=t(c,m,7)/u(c,n,7),h=a-x,d=d*yb(h)-b*f*xb(h),d*w/zb(a))}function x(a,b,c){a=Cb(-b)*zb(Db/(2*b))*c}function y(a,b,c,d,e,f,g,h,i,j,k,l,m,n){if(a>Ab(Lb))return 0;c=b,d=4*c*c,e=1,f=8*a,g=1,h=1,i=h,j=Lb,k=0;do l=d-e*e,h=h*l/(g*f),n=wb(h),k>=b&&n>j&&x(m,a,i),j=n,i+=h,g+=1,e+=2,k+=1;while(wb(h/i)>Qb)}function z(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(t=0>a?-a:a,t>31)return Lb;if(0>=b)return Lb;if(b>9.55&&y(b,t,c,n,o,j,m,h,i,f,s,k,l,e),l=0,j=.25*b*b,m=1,n=0,p=1,r=2/b,t>0){for(n=-Rb,c=1,s=1;t>s;s++)n+=1/c,c+=1,m*=c;if(p=r,1===t)l=1/b;else{for(e=m/t,d=1,i=e,k=-j,g=1,s=1;t>s;s++){if(e/=t-s,d*=s,g*=k,h=e*g/d,i+=h,Lb-wb(h)<wb(i))return Lb;if(r>1&&p>Lb/r)return Lb;p*=r}if(i*=.5,h=wb(i),p>1&&h>Lb/p)return Lb;if(h>1&&p>Lb/h)return Lb;l=i*p}}q=2*Ab(.5*b),o=-Rb,0===t?(n=o,h=1):(n+=1/t,h=1/m),i=(o+n-q)*h,c=1;do h*=j/(c*(c+t)),o+=1/c,n+=1/(c+t),i+=(o+n-q)*h,c+=1;while(wb(h/i)>Qb);return i=.5*i/p,0!==(1&t)&&(i=-i),l+=i}function A(a){var b,c,d,f,h,j=i(),l=k(),n=e(),p=g(),q=m(),r=o();return 5>=a?0>=a?-Lb:(c=a*a,b=a*(t(c,q,5)/u(c,r,8)),b+=Ob*(w(a)*Ab(a)-1/a)):(b=5/a,c=b*b,d=t(c,n,6)/t(c,p,6),f=t(c,j,7)/u(c,l,7),h=a-Nb,d=d*xb(h)+b*f*yb(h),d*Mb/zb(a))}function B(a){var b,c,e,g,i,k=d(),m=f(),o=h(),p=j(),q=l(),r=n();return 5>=a?0>=a?-Lb:(c=a*a,b=t(c,q,7)/u(c,r,7),b+=Ob*Ab(a)*v(a)):(b=5/a,c=25/(a*a),e=t(c,k,6)/t(c,m,6),g=t(c,o,7)/u(c,p,7),i=a-Pb,e=e*xb(i)+b*g*yb(i),e*Mb/zb(a))}function C(a,b){var c,d,e,f,g,h;if(0>a?(a=-a,h=0===(1&a)?1:-1):h=1,0===a)return h*B(b);if(1===a)return h*A(b);if(0>=b)return-Lb;e=B(b),d=A(b),g=1,f=2*g;do c=f*d/b-e,e=d,d=c,f+=2,++g;while(a>g);return h*c}function D(a){for(var b=1,c=a;c>1;c--)b*=c;return b}function E(a,b,c){if(0>b)return 0/0;var d,e,f,g,h,i,j,k,l=100;if(d=.5*a,e=d*d,d=Bb(d,parseFloat(b)),f=D(b),h=0,g=1,i=parseFloat(b),j=d/f,k=.9*j,c)for(;j!==k&&0!==l;)d*=e,h++,f*=h,i++,g*=i,k=j,j+=d/f/g,l--;else for(var m=!1;j!==k&&0!==l;)d*=e,h++,f*=h,i++,g*=i,k=j,m?j+=d/f/g:j-=d/f/g,l--,m=!m;return j}function F(a,b){var c=Bb(b,10),d=parseInt(a,b);return isNaN(d)?Kb:(d>=c/2&&(d-=c),d)}function G(a,b,c){var d;if(0>a&&(a+=Bb(b,10)),d=a.toString(b),d.length<c)for(var e=c-d.length,f=0;e>f;f++)d="0"+d;return d.toUpperCase()}function H(a){for(var b=0;ld[b].str;b++)if(0===a.localeCompare(ld[b].str))return!1;return!0}function I(a,b,c){var d;for(id=0,jd=1,d=0;a[d].str;d++)if(0===c.localeCompare(a[d].str))return id=a[d].c,!0;var e=0;if(b)for(d=0;b[d].str;d++){var f=c.substr(0,1).toLowerCase(),g=b[d].str.substr(0,1).toLowerCase();f===g&&H(c)&&(jd=b[d].c,e++)}for(d=0;a[d].str;d++){var h=c.substr(1,a[d].str.Length),i=a[d].str.substr(0,a[d].str.Length);if(h===i&&H(c))return id=a[d].c,!0}return!1}function J(a,b,c,d,e){var f,g,h,i;f=0,g=0,i=0,h=0;var j=I(a,b,c);f=id,g=jd;var k=I(a,b,d);return i=jd,h=id,j&&k?0===f||0===i?!1:(kd=e*g/f*h/i,!0):!1}function K(a){var c=parseFloat(a[0]);if(isNaN(c))return Ib;var d=b.Convert.toString(a[1]),e=b.Convert.toString(a[2]);return d&&""!==d&&e&&""!==e?(0===d.localeCompare("C")||0===d.localeCompare("cel"))&&0===e.localeCompare("C")||0===e.localeCompare("cel")?c:(0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==e.localeCompare("F")&&0!==e.localeCompare("fah"))&&(0!==d.localeCompare("K")&&0!==d.localeCompare("kel")||0!==e.localeCompare("K")&&0!==e.localeCompare("kel"))?0!==d.localeCompare("C")&&0!==d.localeCompare("cel")||0!==e.localeCompare("F")&&0!==e.localeCompare("fah")?0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==e.localeCompare("C")&&0!==e.localeCompare("cel")?0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==e.localeCompare("F")&&0!==e.localeCompare("fah")?0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==e.localeCompare("K")&&0!==e.localeCompare("kel")?0!==d.localeCompare("K")&&0!==d.localeCompare("kel")||0!==e.localeCompare("F")&&0!==e.localeCompare("fah")?0!==d.localeCompare("C")&&0!==d.localeCompare("cel")||0!==e.localeCompare("K")&&0!==e.localeCompare("kel")?0!==d.localeCompare("K")&&0!==d.localeCompare("kel")||0!==e.localeCompare("C")&&0!==e.localeCompare("cel")?J($c,hd,d,e,c)?kd:J(_c,hd,d,e,c)?kd:J(ad,vb,d,e,c)?kd:J(bd,hd,d,e,c)?kd:J(cd,hd,d,e,c)?kd:J(dd,hd,d,e,c)?kd:J(ed,hd,d,e,c)?kd:J(fd,hd,d,e,c)?kd:J(gd,hd,d,e,c)?kd:J(fd,hd,d,e,c)?kd:Jb:c-wc:c+wc:9*(c-wc)/5+32:5*(c-32)/9+wc:c:5*(c-32)/9:9*c/5+32:c:Jb}function L(a){var c=b.Convert.toDouble(a[0]);if(isNaN(c))return Ib;var d=b.Convert.toInt(a[1]);return isNaN(d)?Ib:0>d?Kb:b.Convert.toResult(E(c,d,!0))}function M(a){var c=b.Convert.toDouble(a[0]);if(isNaN(c))return Ib;var d=b.Convert.toInt(a[1]);return isNaN(d)?Ib:0>d?Kb:b.Convert.toResult(E(c,d,!1))}function N(a){var c=b.Convert.toDouble(a[0]);if(isNaN(c))return Ib;var d=b.Convert.toInt(a[1]);return isNaN(d)?Ib:0>=c?Kb:0>d?Kb:b.Convert.toResult(z(d,c))}function O(a){var c=b.Convert.toDouble(a[0]);if(isNaN(c))return Ib;var d=b.Convert.toInt(a[1]);return isNaN(d)?Ib:0>=c?Kb:0>d?Kb:b.Convert.toResult(C(d,c))}function P(a){var c,d=b.Convert.toString(a[0]);return d.length>10?Kb:(c=F(d,2),c.length<d.length?Kb:c)}function Q(a){var c,d,e=b.Convert.toString(a[0]),f=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return e.length>10?Kb:1>f||f>10?Kb:(c=F(e,2),c.length<e.length?Kb:(d=G(c,16,f),f<d.length&&c>=0&&b._Helper._argumentExists(a,1)?Kb:d))}function R(a){var c,d,e=b.Convert.toString(a[0]),f=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return 10<e.length?Kb:1>f||f>10?Kb:(c=F(e,2),c.length<e.length?Kb:(d=G(c,8,f),c>=0&&f<d.length&&b._Helper._argumentExists(a,1)?Kb:d))}function S(a){var c,d=b.Convert.toDouble(a[0]),e=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return-512>d||d>511?Kb:1>e||e>10?Kb:(c=G(d,2,e),c>=0&&e<c.length&&b._Helper._argumentExists(a,1)?Kb:c)}function T(a){var c,d=b.Convert.toDouble(a[0]),e=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return-549755813888>d||d>549755813887?Kb:1>e||e>10?Kb:(c=G(d,16,e),c>=0&&e<c.length&&b._Helper._argumentExists(a,1)?Kb:c)}function U(a){var c,d=b.Convert.toDouble(a[0]),e=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return-536870912>d||d>536870911?Kb:1>e||e>10?Kb:(c=G(d,8,e),c>=0&&e<c.length&&b._Helper._argumentExists(a,1)?Kb:c)}function V(a){var c,d,e=b.Convert.toString(a[0]),f=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return 10<e.length?Kb:1>f||f>10?Kb:(c=F(e.toLowerCase(),16),c.length<e.length?Kb:-512>c||c>511?Kb:(d=G(c,2,f),c>=0&&f<d.length&&b._Helper._argumentExists(a,1)?Kb:d))}function W(a){var c,d=b.Convert.toString(a[0]);return 10<d.length?Kb:(c=F(d.toLowerCase(),16),c.length<d.length?Kb:b.Convert.toResult(c))}function X(a){var c,d,e=b.Convert.toString(a[0]),f=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return 10<e.length?Kb:1>f||f>10?Kb:(c=F(e,16),c.length<e.length?Kb:-536870912>c||c>536870911?Kb:(d=G(c,8,f),c>=0&&f<d.length&&b._Helper._argumentExists(a,1)?Kb:d))}function Y(a){var c,d,e=b.Convert.toString(a[0]),f=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return 10<e.length?Kb:1>f||f>10?Kb:(c=F(e,8),c.length<e.length?Kb:-512>c||c>511?Kb:(d=G(c,2,f),c>=0&&f<d.length&&b._Helper._argumentExists(a,1)?Kb:d))}function Z(a){var c,d=b.Convert.toString(a[0]);return 10<d.length?Kb:(c=F(d,8),c.length<d.length?Kb:b.Convert.toResult(c))}function $(a){var c,d,e=b.Convert.toString(a[0]),f=b._Helper._argumentExists(a,1)?b.Convert.toInt(a[1]):1;return 10<e.length?Kb:1>f||f>10?Kb:(c=F(e,8),c.length<e.length?Kb:-549755813888>c||c>549755813887?Kb:(d=G(c,16,f),c>=0&&f<d.length&&b._Helper._argumentExists(a,1)?Kb:d))}function _(a){var d=b.Convert.toDouble(a[0]);if(isNaN(d))return Ib;var e=0;if(b._Helper._argumentExists(a,1)&&(e=b.Convert.toDouble(a[1]),isNaN(e)))return Ib;var f;if(0>d||0>e)return Kb;if(d>27||e>27)return Kb;var g=c.Functions._StatHelper.st_normsdist([d*zb(2)]);if(typeof g==typeof b.Errors)return 0/0;if(f=2*parseFloat(g)-1,b._Helper._argumentExists(a,1)){if(g=c.Functions._StatHelper.st_normsdist([e*zb(2)]),typeof g==typeof b.Errors)return 0/0;var h=2*parseFloat(g)-1;f=h-f}return f}function ab(a){var c=b.Convert.toDouble(a[0]);if(isNaN(c))return Ib;if(0>c)return Kb;var d=_([c]);return typeof d==typeof b.Errors?0/0:1-parseFloat(d)}function bb(a){var d=b.Convert.toDouble(a[0]);if(isNaN(d))return Ib;var e=0;return b._Helper._argumentExists(a,1)&&(e=b.Convert.toDouble(a[1]),isNaN(e))?Ib:c.Functions._MathHelper.approxEqual(d,e)?1:0}function cb(a){var c=b.Convert.toDouble(a[0]);if(isNaN(c))return Ib;var d=0;return b._Helper._argumentExists(a,1)&&(d=b.Convert.toDouble(a[1]),isNaN(d))?Ib:c>=d?1:0}function db(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDouble(a[1]);if(isNaN(c)||isNaN(d))return Ib;var e=b._Helper._argumentExists(a,2)?b.Convert.toString(a[2]):"i";return"i"!==e&&"j"!==e?Ib:Tb._toResult(new Sb(c,d),e)}function eb(a){var c=Tb._toComplex(a[0]),d=c.real(),e=c.imag();return b.Convert.toResult(zb(d*d+e*e))}function fb(a){var c=Tb._toComplex(a[0]);return b.Convert.toResult(c.imag())}function gb(a){var c=Tb._toComplex(a[0]),d=c.real(),e=c.imag();return 0===d&&0===e?Hb:b.Convert.toResult(Fb(e,d))}function hb(a){var b=Tb._toComplex(a[0]),c=b.real(),d=b.imag();return Tb._toResult(new Sb(c,-d))}function ib(a){var b=Tb._toComplex(a[0]),d=b.real(),e=b.imag();return Tb._toResult(new Sb(yb(d)*c.Functions._MathHelper.cosh(e),-xb(d)*c.Functions._MathHelper.sinh(e)))}function jb(a){var b=Tb._toComplex(a[0]),c=Tb._toComplex(a[1]),d=b.real(),e=b.imag(),f=c.real(),g=c.imag();return 0===f&&0===g?Kb:Tb._toResult(new Sb((d*f+e*g)/(f*f+g*g),(e*f-d*g)/(f*f+g*g)))}function kb(a){var b=Tb._toComplex(a[0]),c=b.real(),d=b.imag();return Tb._toResult(new Sb(Cb(c)*yb(d),Cb(c)*xb(d)))}function lb(a){var b=Tb._toComplex(a[0]),c=b.real(),d=b.imag();if(0===c&&0===d)return Kb;var e=zb(c*c+d*d),f=Fb(d,c);return Tb._toResult(new Sb(Ab(e),f))}function mb(a){var b=Tb._toComplex(a[0]),d=b.real(),e=b.imag();if(0===d&&0===e)return Kb;var f=zb(d*d+e*e),g=Fb(e,d),h=c.Functions._MathHelper.log10(Eb);return Tb._toResult(new Sb(h*Ab(f),h*g))}function nb(a){var b=Tb._toComplex(a[0]),d=b.real(),e=b.imag();if(0===d&&0===e)return Kb;var f=zb(d*d+e*e),g=Fb(e,d),h=c.Functions._MathHelper.log(Eb,2);return Tb._toResult(new Sb(h*Ab(f),h*g))}function ob(a){var b=Tb._toComplex(a[0]),c=parseFloat(a[1]);if(isNaN(c))return Ib;var d=b.real(),e=b.imag();if(0===d&&0===e)return c>0?Tb._toResult(new Sb(0,0)):Kb;var f=zb(d*d+e*e),g=Fb(e,d);return Tb._toResult(new Sb(Bb(f,c)*yb(c*g),Bb(f,c)*xb(c*g)))}function pb(a){for(var c,d,e,f,g,h=1,i=0,j=0;j<a.length;j++)if(a[j].constructor===b.CalcArray)for(var k=a[j],l=0;l<k.rowCount;l++)for(var m=0;m<k.columnCount;m++)c=Tb._toComplex(k.getValue(l,m)),d=h,e=i,f=c.real(),g=c.imag(),h=d*f-e*g,i=d*g+e*f;else c=Tb._toComplex(a[j]),d=h,e=i,f=c.real(),g=c.imag(),h=d*f-e*g,i=d*g+e*f;return Tb._toResult(new Sb(h,i))}function qb(a){var c=Tb._toComplex(a[0]);return b.Convert.toResult(c.real())}function rb(a){var b=Tb._toComplex(a[0]),d=b.real(),e=b.imag();return Tb._toResult(new Sb(xb(d)*c.Functions._MathHelper.cosh(e),yb(d)*c.Functions._MathHelper.sinh(e)))}function sb(a){var b=Tb._toComplex(a[0]),c=b.real(),d=b.imag();if(0===c&&0===d)return Tb._toResult(new Sb(0,0));var e=zb(c*c+d*d),f=Fb(d,c);return Tb._toResult(new Sb(zb(e)*yb(f/2),zb(e)*xb(f/2)))}function tb(a){var b=Tb._toComplex(a[0]),c=Tb._toComplex(a[1]),d=b.real(),e=b.imag(),f=c.real(),g=c.imag();return Tb._toResult(new Sb(d-f,e-g))}function ub(a){for(var c,d,e,f,g,h=0,i=0,j=0;j<a.length;j++)if(a[j].constructor===b.CalcArray)for(var k=a[j],l=0;l<k.rowCount;l++)for(var m=0;m<k.columnCount;m++)c=Tb._toComplex(k.getValue(l,m)),d=h,e=i,f=c.real(),g=c.imag(),h=d+f,i=e+g;else c=Tb._toComplex(a[j]),d=h,e=i,f=c.real(),g=c.imag(),h=d+f,i=e+g;return Tb._toResult(new Sb(h,i))}a.feature("calc.functions_eng",["calc.functions"]);var vb=null,wb=Math.abs,xb=Math.sin,yb=Math.cos,zb=Math.sqrt,Ab=Math.log,Bb=Math.pow,Cb=Math.exp,Db=Math.PI,Eb=Math.E,Fb=Math.atan2,Gb=(Math.floor,b.Errors),Hb=(Gb.Null,Gb.DivideByZero),Ib=Gb.Value,Jb=(Gb.Reference,Gb.Name,Gb.NotAvailable),Kb=Gb.Number,Lb=1.7976931348623157e308,Mb=.7978845608028654,Nb=2.356194490192345,Ob=.6366197723675814,Pb=.7853981633974483,Qb=1.1102230246251565e-16,Rb=.5772156649015329,Sb=function(){function b(a,b){this._real=a,this._imag=b}return b.prototype.real=function(){return this._real},b.prototype.imag=function(){return this._imag},b.prototype.toString=function(b){b||(b="i");var c=this,d=new a._StringBuilder;return(0!==c._real||0===c._imag)&&d.append(c._real.toString()),-1===c._imag?d.append("-"):0!==c._real&&c._imag>0&&d.append("+"),-1!==c._imag&&0!==c._imag&&1!==c._imag&&d.append(c._imag.toString()),0!==c._imag&&d.append(b),d.toString()},b._parse=function(c){var d=0,e=0,f=!1,g=!1,h=!1,i=0,j=0,k=0;if(!c)throw a.SR.Exp_ArgumentNull;if(0===c.length)throw a.SR.Exp_Format;for(k<c.length&&("+"===c.charAt(k)||"-"===c.charAt(k))&&k++;k<c.length&&!isNaN(Number(c.charAt(k)));)k++,f=!0;for(k<c.length&&"."===c.charAt(k)&&k++;k<c.length&&!isNaN(Number(c.charAt(k)));)k++,f=!0;if(k<c.length&&("E"===c.charAt(k)||"e"===c.charAt(k)))for(k++,f=!1,k<c.length&&("+"===c.charAt(k)||"-"===c.charAt(k))&&k++;k<c.length&&!isNaN(Number(c.charAt(k)));)k++,f=!0;if(k<c.length&&("+"===c.charAt(k)||"-"===c.charAt(k))){for(i=k,k++;k<c.length&&!isNaN(Number(c.charAt(k)));)k++,g=!0;for(k<c.length&&"."===c.charAt(k)&&k++;k<c.length&&!isNaN(Number(c.charAt(k)));)k++,g=!0;if(k<c.length&&("E"===c.charAt(k)||"e"===c.charAt(k)))for(k++,g=!1,k<c.length&&("+"===c.charAt(k)||"-"===c.charAt(k))&&k++;k<c.length&&!isNaN(Number(c.charAt(k)));)k++,g=!0;k<c.length&&("i"===c.charAt(k)||"j"===c.charAt(k))&&(k++,h=!0),j=k-i}else k<c.length&&("i"===c.charAt(k)||"j"===c.charAt(k))?(k++,j=k,g=f,h=!0,f=!1):i=k;if(k<c.length)throw a.SR.Exp_Format;if(i>0){if(!f)throw a.SR.Exp_Format;d=parseInt(c.substr(0,i),10)}if(j>0){if(!h)throw a.SR.Exp_Format;if(1===j)e=1;else if(2===j&&"+"===c.charAt(i))e=1;else if(2===j&&"-"===c.charAt(i))e=-1;else{if(!g)throw a.SR.Exp_Format;e=parseInt(c.substr(i,j-1),10)}}return new b(d,e)},b}(),Tb=function(){function b(){}return b._toComplex=function(b){try{if(b){if(b.constructor===Number)return new Sb(parseFloat(b),0);if(b.constructor===String)return Sb._parse(b);throw a.SR.Exp_InvalidCast}return new Sb(0,0)}catch(c){throw a.SR.Exp_InvalidCast}},b._toResult=function(a,b){return isNaN(a.real())||a.real()===Number.POSITIVE_INFINITY||isNaN(a.imag())||a.imag()===Number.POSITIVE_INFINITY?Kb:a.toString(b)},b}(),Ub=6852205001e-14,Vb=.002204622915,Wb=6.02217e23,Xb=.035273972,Yb=1/1852,Zb=1e4/254,$b=Zb/12,_b=$b/3,ac=_b/1760,bc=1e10,cc=2834.645669,dc=.001,ec=365.25,fc=24*ec,gc=60*fc,hc=60*gc,ic=9869233e-12,jc=.00750061708,kc=1e5,lc=.224808924,mc=745.701,nc=9999995.193,oc=.239006249,pc=.238846191,qc=62146e14,rc=1/(3600*mc),sc=1/3600,tc=23.73042222,uc=947815e-9,vc=1e4,wc=273.15,xc=1/3,yc=1/6,zc=1/48,Ac=1/96,Bc=1/192,Cc=1/768,Dc=.004929994,Ec=.008675585,Fc=1e24,Gc=1e21,Hc=1e18,Ic=1e15,Jc=1e12,Kc=1e9,Lc=1e6,Mc=1e3,Nc=100,Oc=10,Pc=.1,Qc=.01,Rc=.001,Sc=1e-6,Tc=1e-9,Uc=1e-12,Vc=1e-15,Wc=1e-18,Xc=1e-21,Yc=1e-24,Zc=function(){function a(a,b){this.str=a,this.c=b}return a}(),$c=[new Zc("g",1),new Zc("sg",Ub),new Zc("lbm",Vb),new Zc("u",Wb),new Zc("ozm",Xb),new Zc(vb,0)],_c=[new Zc("m",1),new Zc("mi",ac),new Zc("Nmi",Yb),new Zc("in",Zb),new Zc("ft",$b),new Zc("yd",_b),new Zc("ang",bc),new Zc("Pica",cc),new Zc("km",dc),new Zc(vb,0)],ad=[new Zc("yr",1),new Zc("day",ec),new Zc("hr",fc),new Zc("mn",gc),new Zc("sec",hc),new Zc(vb,0)],bd=[new Zc("Pa",1),new Zc("atm",ic),new Zc("mmHg",jc),new Zc("p",1),new Zc("at",ic),new Zc(vb,0)],cd=[new Zc("N",1),new Zc("dyn",kc),new Zc("lbf",lc),new Zc("dy",kc),new Zc(vb,0)],dd=[new Zc("J",1),new Zc("e",nc),new Zc("c",oc),new Zc("cal",pc),new Zc("eV",qc),new Zc("HPh",rc),new Zc("Wh",sc),new Zc("flb",tc),new Zc("BTU",uc),new Zc("ev",qc),new Zc("hh",rc),new Zc("wh",sc),new Zc("btu",uc),new Zc(vb,0)],ed=[new Zc("HP",1),new Zc("W",mc),new Zc("h",1),new Zc("w",mc),new Zc(vb,0)],fd=[new Zc("T",1),new Zc("ga",vc),new Zc(vb,0)],gd=[new Zc("tsp",1),new Zc("tbs",xc),new Zc("oz",yc),new Zc("cup",zc),new Zc("pt",Ac),new Zc("qt",Bc),new Zc("gal",Cc),new Zc("l",Dc),new Zc("uk_pt",Ec),new Zc("us_pt",Ac),new Zc("lt",Dc),new Zc(vb,0)],hd=[new Zc("Y",Fc),new Zc("Z",Gc),new Zc("E",Hc),new Zc("P",Ic),new Zc("T",Jc),new Zc("G",Kc),new Zc("M",Lc),new Zc("k",Mc),new Zc("h",Nc),new Zc("e",Oc),new Zc("d",Pc),new Zc("c",Qc),new Zc("m",Rc),new Zc("u",Sc),new Zc("n",Tc),new Zc("p",Uc),new Zc("f",Vc),new Zc("a",Wc),new Zc("z",Xc),new Zc("y",Yc),new Zc(vb,0)],id=0,jd=0,kd=0,ld=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];c.def("BESSELI",L,{minArgs:2,maxArgs:2}),c.def("BESSELJ",M,{minArgs:2,maxArgs:2}),c.def("BESSELK",N,{minArgs:2,maxArgs:2}),c.def("BESSELY",O,{minArgs:2,maxArgs:2}),c.def("BIN2DEC",P,{minArgs:1,maxArgs:1}),c.def("BIN2HEX",Q,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("BIN2OCT",R,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("DEC2BIN",S,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("DEC2HEX",T,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("DEC2OCT",U,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("HEX2BIN",V,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("HEX2DEC",W,{minArgs:1,maxArgs:1}),c.def("HEX2OCT",X,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("OCT2BIN",Y,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("OCT2DEC",Z,{minArgs:1,maxArgs:1}),c.def("OCT2HEX",$,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("ERF",_,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("ERFC",ab,{minArgs:1,maxArgs:1}),c.def("DELTA",bb,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("GESTEP",cb,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne}),c.def("COMPLEX",db,{minArgs:2,maxArgs:3,acceptsMissingArgument:c.acceptsTwo}),c.def("IMABS",eb,{minArgs:1,maxArgs:1}),c.def("IMAGINARY",fb,{minArgs:1,maxArgs:1}),c.def("IMARGUMENT",gb,{minArgs:1,maxArgs:1}),c.def("IMCONJUGATE",hb,{minArgs:1,maxArgs:1}),c.def("IMCOS",ib,{minArgs:1,maxArgs:1}),c.def("IMDIV",jb,{minArgs:2,maxArgs:2}),c.def("IMEXP",kb,{minArgs:1,maxArgs:1}),c.def("IMLN",lb,{minArgs:1,maxArgs:1}),c.def("IMLOG10",mb,{minArgs:1,maxArgs:1}),c.def("IMLOG2",nb,{minArgs:1,maxArgs:1}),c.def("IMPOWER",ob,{minArgs:2,maxArgs:2}),c.def("IMPRODUCT",pb,{minArgs:1,maxArgs:255,acceptsMissingArgument:c.acceptsNotZero}),c.def("IMREAL",qb,{minArgs:1,maxArgs:1}),c.def("IMSIN",rb,{minArgs:1,maxArgs:1}),c.def("IMSQRT",sb,{minArgs:1,maxArgs:1}),c.def("IMSUB",tb,{minArgs:2,maxArgs:2}),c.def("IMSUM",ub,{minArgs:1,maxArgs:255,acceptsMissingArgument:c.acceptsNotZero}),c.def("CONVERT",K,{minArgs:3,maxArgs:3})}(b.Functions||(b.Functions={}));b.Functions}(a.Calc||(a.Calc={}));a.Calc}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(b){!function(c){function d(a,b,d){var e,f,g,h,i,j,k,l,m,n,o,p;switch(g=a.getFullYear(),f=a.getMonth(),e=a.getDate(),j=b.getFullYear(),i=b.getMonth(),h=b.getDate(),m=j-g,k=i-f,l=h-e,k=12*m+k,n=Dc(g),d){case 0:var q=[];return q[0]=a,q[1]=b,c.Functions._DateHelper.days360(q);case 1:case 2:case 3:return p=Fc(a),o=Fc(b),o-p;case 4:return 30*k+l;default:return-1}}function e(a,b,c,d,e){var f;if(0===a)f=(c+d)/b;else{var g=rc(1+a,b);f=e>0?(d*a/(g-1)+c*a/(1-1/g))/(1+a):d*a/(g-1)+c*a/(1-1/g)}return-f}function f(a,b,c,d,e){var f;if(0===a)f=d+c*b;else{var g=rc(1+a,b);f=e>0?d*g+c*(1+a)*(g-1)/a:d*g+c*(g-1)/a}return-f}function g(a,b){var c=rc(1+a,b);return isNaN(c)||!isFinite(c)?Cc:c}function h(a,b){if(0===a)return b;var c=rc(1+a,b),d=c-1,e=d/a;return isNaN(e)||!isFinite(e)?Cc:e}function i(a,c,d,e,f){var i,j;i=g(a,c),j=h(a,c);var k=-d*i-e,l=1+a*b.Convert.toDouble(f),m=l*j,n=k/m;return isNaN(n)||!isFinite(n)?Cc:n}function j(a,b,c,d){var e=rc(1+c,d),f=e-1,g=-(a*e*c+b*f);return isNaN(g)||!isFinite(g)?Cc:g}function k(a,b,c,d){var e,f,g,h=new Date(1,0,1);h.setFullYear(1);var i=0;g=b.getDate()===Hc(b.getFullYear(),b.getMonth()),e=12/c,f=b.getFullYear()-a.getFullYear(),f>0&&(f=(f-1)*c);do h=new Date(b.getFullYear(),b.getMonth(),b.getDate()),f++,h.setMonth(h.getMonth()-f*e),g&&(i=Hc(h.getFullYear(),h.getMonth()),h=new Date(h.getFullYear(),h.getMonth(),i));while(Ec(a,h)<0);return d&&(h=new Date(b.getFullYear(),b.getMonth(),b.getDate()),f--,h.setMonth(h.getMonth()-f*e),g&&(i=Hc(h.getFullYear(),h.getMonth()),h=new Date(h.getFullYear(),h.getMonth(),i))),h}function l(a,b,c,d){var e=k(a,b,c,!1);return Ic(e,a,d)}function m(a,b,c,d){var e,f;switch(d){case 0:case 2:case 4:case 5:return 360/c;case 3:return 365/c;default:return f=k(a,b,c,!0),e=k(a,b,c,!1),Ic(e,f,1)}}function n(a,b,c,d){var e=k(a,b,c,!0);return Ic(a,e,d)}function o(a,b,c){var d=k(a,b,c,!0);return Fc(d)}function p(a,b,c){var d,e=new Date(b.getFullYear(),b.getMonth(),b.getDate());if(d=b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear()),e.setMonth(e.getMonth()-d),b.getDate()===Hc(b.getFullYear(),b.getMonth()))for(;e.getDate()!==Hc(e.getFullYear(),e.getMonth());)e.setDate(e.getDate()+1);return a.getDate()>=e.getDate()&&d--,parseInt((1+d/(12/c)).toString(),10)}function q(a,b,c){var d=k(a,b,c,!1);return Fc(d)}function r(a,c,d,e,f,g,h){var i,j=0,k=0,l=100,m=b.Convert;for(d*=l/m.toDouble(f),e/=f,e+=1,i=1;h>i;i++)j+=i*d/rc(e,i);for(j+=h*(d+l)/rc(e,h),i=1;h>i;i++)k+=d/rc(e,i);return k+=(d+l)/rc(e,h),j/=k,j/=m.toDouble(f)}function s(a){return a.havexpos=a.havexneg=!1,a.xmin=-1e10,a.xmax=1e10,a.precision=1e-10,a}function t(a,b,c){return b>0?(c.havexpos?c.havexneg?sc(a-c.xneg)<sc(c.xpos-c.xneg)&&(c.xpos=a,c.ypos=b):b<c.ypos&&(c.xpos=a,c.ypos=b):(c.xpos=a,c.ypos=b,c.havexpos=!0),[!1,c]):0>b?(c.havexneg?c.havexpos?sc(a-c.xpos)<sc(c.xpos-c.xneg)&&(c.xneg=a,c.yneg=b):-b<-c.yneg&&(c.xneg=a,c.yneg=b):(c.xneg=a,c.yneg=b,c.havexneg=!0),[!1,c]):(c.root=a,[!0,c])}function u(a,b,c,d,e,f,g){var h,i,j,k,o,q,r,s,t,u,v;for(h=l(a,b,f,g),i=n(a,b,f,g),j=m(a,b,f,g),v=parseInt(p(a,b,f).toString(),10),k=0,o=100*c/f,q=1+d/f,r=i/j,u=0;v>u;u++)k+=o/rc(q,r+u);return s=e/rc(q,v-1+i/j),t=h/j*o,s+k-t}function v(a,b,c,d,e){var f,g,h;if(f=k(a,c,d,!0),g=k(a,c,d,!1),Ec(f,b)>=0)return Ic(a,b,e)/m(g,f,d,e);for(h=Ic(a,f,e)/m(g,f,d,e);;){if(g=new Date(f.getFullYear(),f.getMonth(),f.getDate()),f.setMonth(f.getMonth()+12/d),Ec(f,b)>=0)return h+=Ic(g,b,e)/m(g,f,d,e);h+=1}}function w(a,b,c,d,e,f,g,h,i){var j,k,l,n=Ic(c,a,i),o=Ic(a,d,i),q=Ic(c,d,i),r=m(a,b,h,i),s=parseInt(p(a,b,h).toString(),10),t=100*e/h,u=1+f/h;if(o>r)switch(i){case 0:case 4:var w=Ic(d,b,i);s=1+parseInt(tc(w/r).toString(),10);break;default:var x=new Date(d.getFullYear(),d.getMonth(),d.getDate()),y=32767;for(s=0;y>s;s++){var z=new Date(x.getFullYear(),x.getMonth(),x.getDate());if(x.setMonth(x.getMonth()+12/h),Ec(x,b)>=0){s+=parseInt((tc(Ic(z,b,i))/m(z,x,h,i)).toString(),10)+1;break}}n=r*v(c,a,d,h,i),o=r*v(a,d,d,h,i),q=r*v(c,d,d,h,i)}return k=g/rc(u,s-1+o/r),l=q/r/rc(u,o/r),j=rc(u,-o/r)*(rc(u,-s)-1/u)/(1/u-1),k+t*(l+j-n/r)}function x(a,b){var d=a.substr(0,3),e=c.Functions._MathHelper.round;switch(a[0]){case"A":if("ATS"===d)return e(13.7603,b);break;case"B":if("BEF"===d)return e(40.3399,b);break;case"D":if("DEM"===d)return e(1.95583,b);break;case"E":if("ESP"===d)return e(166.386,b);if("EUR"===d)return e(1,b);break;case"F":if("FIM"===d)return e(5.94573,b);if("FRF"===d)return e(6.55957,b);break;case"G":if("GRD"===d)return e(340.75,b);break;case"I":if("IEP"===d)return e(.787564,b);if("ITL"===d)return e(1936.27,b);break;case"L":if("LUX"===d||"LUF"===d)return e(40.3399,b);break;case"N":if("NLG"===d)return e(2.20371,b);break;case"P":if("PTE"===d)return e(200.482,b)}return-1}function y(a){var b=a.substr(0,3);switch(a[0]){case"A":if("ATS"===b)return 2;break;case"B":if("BEF"===b)return 0;break;case"D":if("DEM"===b)return 2;break;case"E":if("ESP"===b)return 0;if("EUR"===b)return 2;break;case"F":if("FIM"===b)return 2;if("FRF"===b)return 2;break;case"G":if("GRD"===b)return 2;break;case"I":if("IEP"===b)return 2;if("ITL"===b)return 0;break;case"L":if("LUX"===b||"LUF"===b)return 0;break;case"N":if("NLG"===b)return 2;break;case"P":if("PTE"===b)return 1}return 2}function z(a){var b=a.substr(0,3);switch(a[0]){case"A":if("ATS"===b)return 2;break;case"B":if("BEF"===b)return 0;break;case"D":if("DEM"===b)return 2;break;case"E":if("ESP"===b)return 0;if("EUR"===b)return 2;break;case"F":if("FIM"===b)return 2;if("FRF"===b)return 2;break;case"G":if("GRD"===b)return 2;break;case"I":if("IEP"===b)return 2;if("ITL"===b)return 0;break;case"L":if("LUX"===b||"LUF"===b)return 0;break;case"N":if("NLG"===b)return 2;break;case"P":if("PTE"===b)return 2}return 2}function A(a){var c=b.Convert,d=b._Helper,e=c.toDouble(a[0]),f=c.toDouble(a[1]),g=c.toDouble(a[2]),h=d._argumentExists(a,3)?c.toDouble(a[3]):0,i=d._argumentExists(a,4)?c.toDouble(a[4]):0;return 0!==i&&(i=1),c.toResult(0===e?-(g*f+h):-(h*rc(1+e,f)+g*(1+e*i)*(rc(1+e,f)-1)/e))}function B(a){for(var c=b.Convert,d=b._ArrayHelper,e=c.toDouble(a[0]),f=0;f<d.getLength(a[1]);f++){var g=c.toDouble(d.getValueByIndex(a[1],f));e*=1+g}return e}function C(a){for(var c=b.Convert,d=b._ArrayHelper,e=c.toDouble(a[0]),f=0,g=1,h=0,i=1;i<a.length;i++){if(c.isError(a[i]))return a[i];if(d.isArrayOrReference(a[i])){for(var j=0;j<d.getLength(a[i]);j++){var k=d.getValueByIndex(a[i],j);if(c.isError(k))return c._inArray=!1,k;if(c.isNumber(k))h=c.toDouble(d.getValueByIndex(a[i],j)),f+=h/rc(1+e,g),g++;else if(c.isError(k))return c._inArray=!1,k}c._inArray=!1}else h=c.toDouble(a[i]),f+=h/rc(1+e,g),g++}return f}function D(a){var c=b.Convert,d=b._Helper,e=c.toDouble(a[0]),f=c.toDouble(a[1]),g=c.toDouble(a[2]),h=d._argumentExists(a,3)?c.toDouble(a[3]):0,i=d._argumentExists(a,4)?c.toDouble(a[4]):0;return 0!==i&&(i=1),0===e?c.toResult(-(g*f+h)):-1===e?Ac:c.toResult(-(h+g*(1+e*i)*(rc(1+e,f)-1)/e)/rc(1+e,f))
}function E(a){var c,e,f,g=b.Convert,h=b._Helper,i=g.toDateTime(a[0]),j=g.toDateTime(a[1]),k=g.toDouble(a[2]),l=g.toDouble(a[3]),m=h._argumentExists(a,4)?g.toInt(a[4]):0;return Ec(i,j)>=0?Cc:0>=k||0>=l||0>m||m>4?Cc:(c=d(i,j,m),e=Gc(i,m),0>=c||0>=e?Cc:(f=1-l*c/e,0>=f?Cc:k/f))}function F(a){var c=b.Convert,d=b._ArrayHelper,e=d.getLength(a[1]),f=d.getLength(a[2]);if(e!==f)return Cc;for(var g=c.toDouble(a[0]),h=[],i=[],j=0,k=0;e>k;k++)h[k]=c.toDouble(d.getValueByIndex(a[1],k));for(k=0;f>k;k++)i[k]=c.toDateTime(d.getValueByIndex(a[2],k));for(var l=0;e>l;l++)j+=h[l]/rc(1+g,(Fc(i[l])-Fc(i[0]))/365);return j}function G(a,b,c,d,g,h){var i,j,k;for(i=e(a,b,c,0,h),j=0,1===d&&(0>=h&&(j=-c),d++),k=d;g>=k;k++)j+=h>0?f(a,k-2,i,c,1)-i:f(a,k-1,i,c,0);return j*=a}function H(a){var c=b.Convert,d=c.toDouble(a[0]),e=c.toInt(a[1]),f=c.toDouble(a[2]),g=c.toInt(a[3]),h=c.toInt(a[4]),i=c.toInt(a[5]);return 1>g||g>h||0>=d||h>e||0>=e||0>=f||0!==i&&1!==i?Cc:G(d,e,f,g,h,i)}function I(a,b,c,d,g,h){var i,j,k;for(i=e(a,b,c,0,h),j=0,1===d&&(j=0>=h?i+c*a:i,d++),k=d;g>=k;k++)j+=h>0?i-(f(a,k-2,i,c,1)-i)*a:i-f(a,k-1,i,c,0)*a;return j}function J(a){var c=b.Convert,d=c.toDouble(a[0]),e=c.toInt(a[1]),f=c.toDouble(a[2]),g=c.toInt(a[3]),h=c.toInt(a[4]),i=c.toInt(a[5]);return 1>g||g>h||0>=d||h>e||0>=e||0>=f||0!==i&&1!==i?Cc:I(d,e,f,g,h,i)}function K(a){var c=b.Convert,d=b._Helper,e=c.toDouble(a[0]),f=c.toDouble(a[1]),g=c.toDouble(a[2]),h=c.toDouble(a[3]),k=d._argumentExists(a,4)?c.toDouble(a[4]):0,l=d._argumentExists(a,5)?c.toInt(a[5]):0;if(1>f||f>=g+1||1>g)return Cc;var m=i(e,g,h,k,l);return j(h,m,e,f-1)}function L(a){var c=b.Convert,d=c.toDouble(a[0]),e=c.toInt(a[1]),f=c.toInt(a[2]),g=c.toDouble(a[3]);return 0===f?Ac:c.toResult(g*d*(c.toDouble(e)/c.toDouble(f)-1))}function M(a){var c=b.Convert,d=b._Helper,e=c.toDouble(a[0]),f=c.toDouble(a[1]),g=c.toDouble(a[2]),h=d._argumentExists(a,3)?c.toDouble(a[3]):0,i=d._argumentExists(a,4)?c.toDouble(a[4]):0;return 0!==i&&(i=1),0===e?0===f?Ac:c.toResult(-(g+h)/f):0===f?Ac:c.toResult(-(g*rc(1+e,f)+h)/((1+e*i)*(rc(1+e,f)-1)/e))}function N(a){var c=b.Convert,d=b._Helper,e=c.toDouble(a[0]),f=c.toDouble(a[1]),g=c.toDouble(a[2]),h=c.toDouble(a[3]),k=d._argumentExists(a,4)?c.toDouble(a[4]):0,l=d._argumentExists(a,5)?c.toBool(a[5]):!1;if(1>f||f>=g+1)return Cc;var m=i(e,g,h,k,l?1:0),n=j(h,m,e,f-1);return m-n}function O(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toInt(a[2]),h=d._argumentExists(a,3)?c.toInt(a[3]):0,i=Cc;return 0>h||h>4?i:1!==g&&2!==g&&4!==g?i:Ec(e,f)>=0?i:l(e,f,g,h)}function P(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toInt(a[2]),h=d._argumentExists(a,3)?c.toInt(a[3]):0,i=Cc;return 0>h||h>4?i:1!==g&&2!==g&&4!==g?i:Ec(e,f)>=0?i:m(e,f,g,h)}function Q(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toInt(a[2]),h=d._argumentExists(a,3)?c.toInt(a[3]):0;return 0>h||h>4?Cc:1!==g&&2!==g&&4!==g?Cc:Ec(e,f)>=0?Cc:n(e,f,g,h)}function R(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toInt(a[2]),h=d._argumentExists(a,3)?c.toInt(a[3]):0;return 0>h||h>4?Cc:1!==g&&2!==g&&4!==g?Cc:Ec(e,f)>=0?Cc:o(e,f,g)}function S(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toInt(a[2]),h=d._argumentExists(a,3)?c.toInt(a[3]):0;return 0>h||h>4?Cc:1!==g&&2!==g&&4!==g?Cc:Ec(e,f)>=0?Cc:p(e,f,g)}function T(a){var c=b.Convert,d=(b._Helper,c.toDateTime(a[0])),e=c.toDateTime(a[1]),f=c.toInt(a[2]),g=b._Helper._argumentExists(a,3)?c.toInt(a[3]):0;return 0>g||g>4?Cc:1!==f&&2!==f&&4!==f?Cc:Ec(d,e)>=0?Cc:q(d,e,f)}function U(a){var c,d=b.Convert,e=b._Helper,f=d.toDateTime(a[0]),g=d.toDateTime(a[1]),h=d.toDouble(a[2]),i=d.toDouble(a[3]),j=d.toInt(a[4]),k=e._argumentExists(a,5)?d.toInt(a[5]):0;return 0>k||k>4?Cc:1!==j&&2!==j&&4!==j?Cc:Ec(f,g)>0?Cc:(c=p(f,g,j),r(f,g,h,i,j,k,c))}function V(a,c,d,e,f,g,h){var i=r(a,c,d,e,f,g,h);return i/=1+e/b.Convert.toDouble(f)}function W(a){var c,d=b.Convert,e=b._Helper,f=d.toDateTime(a[0]),g=d.toDateTime(a[1]),h=d.toDouble(a[2]),i=d.toDouble(a[3]),j=d.toInt(a[4]),k=e._argumentExists(a,5)?d.toInt(a[5]):0;return 0>k||k>4?Cc:1!==j&&2!==j&&4!==j?Cc:Ec(f,g)>0?Cc:(c=p(f,g,j),V(f,g,h,i,j,k,c))}function X(a){var c=b.Convert,d=b._Helper,e=c.toDouble(a[0]),f=c.toDouble(a[1]),g=c.toDouble(a[2]),h=d._argumentExists(a,3)?c.toDouble(a[3]):0,i=d._argumentExists(a,4)?c.toDouble(a[4]):0;return 0!==i&&(i=1),0===e?0===f?Ac:c.toResult(-(g+h)/f):-1>=e?Cc:c.toResult(uc((f*(1+e*i)-h*e)/(g*e+f*(1+e*i)))/uc(1+e))}function Y(a,b,c,d,e,f,g,h,i){return b=u(c,d,e,a,g,h,i)-f,[!0,b]}function Z(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o=0,p=0;if(l=a-c,l<d.xmin&&(l=a),m=a+c,m>d.xmax&&(m=a),l===m)return[!1,b,d];var q=Y(l,o,e,f,g,h,i,j,k);return o=q[1],(n=q[0])?(q=Y(m,p,e,f,g,h,i,j,k),p=q[1],(n=q[0])?(b=(p-o)/(m-l),[!0,b,d]):[n,b,d]):[n,b,d]}function $(a,b,c,d,e,f,g,h,i){var j,k,l=a.precision/2;for(j=0;20>j;j++){var m,n,o=0,p=0;if(i<a.xmin||i>a.xmax)return[!1,a];var q=Y(i,o,b,c,d,e,f,g,h);if(o=q[1],k=q[0],!k)return[k,a];if(q=t(i,o,a),a=q[1],q[0])return[!0,a];var r;r=sc(i)<1e-10?a.havexneg&&a.havexpos?sc(a.xpos-a.xneg)/1e6:(a.xmax-a.xmin)/1e6:sc(i)/1e6;var s=Z(i,p,r,a,b,c,d,e,f,g,h);if(a=s[2],p=s[1],k=s[0],!k)return[k,a];if(0===p)return[!1,a];if(m=i-1.000001*o/p,m===i)return a.root=i,[!0,a];if(n=sc(m-i)/(sc(i)+sc(m)),i=m,l>n)return a.root=i,[!0,a]}return[!1,a]}function _(a,b,c,d,e,f,g,h,i){var j,k=0;if(i<a.xmin||i>a.xmax)return[!1,a];var l=Y(i,k,b,c,d,e,f,g,h);return k=l[1],(j=l[0])?(l=t(i,k,a),a=l[1],l[0]?[!0,a]:[!1,a]):[j,a]}function ab(a,b,c,d,e,f,g,h,i,j,k,l,m,n){switch(n){case 0:k=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var o;k=(a.xpos+a.xneg)/2;var p=Y(k,l,b,c,d,e,f,g,h);if(l=p[1],m=p[0],!m)return[qc,a,j,k,l,n];if(0===l)return a=t(k,l,a)[1],[!0,a,j,k,l,n];if(o=vc(l*l-a.ypos*a.yneg),0===o)return[qc,a,j,k,l,n];k+=(k-a.xpos)*l/o;break;case 3:k=(a.xpos+a.xneg)/2;break;case 2:var q=0,r=0,s=0,u=0;if(i>.1)return n=3,ab(a,b,c,d,e,f,g,h,i,j,k,l,m,n);switch(j++%4){case 0:q=a.xpos,q=a.ypos;break;case 2:q=a.xneg,r=a.yneg;break;default:case 3:case 1:q=(a.xpos+a.xneg)/2;var v=Y(q,r,b,c,d,e,f,g,h);if(r=v[1],m=v[0],!m)return[qc,a,j,k,l,n]}s=sc(a.xpos-a.xneg)/1e6;var w=Z(q,u,s,a,b,c,d,e,f,g,h);if(a=w[2],u=w[1],m=w[0],!m)return[qc,a,j,k,l,n];if(0===u)return[qc,a,j,k,l,n];if(k=q-1.01*r/u,k<a.xpos&&k<a.xneg||k>a.xpos&&k>a.xneg)return[qc,a,j,k,l,n]}return[!1,a,j,k,l,n]}function bb(a,b,c,d,e,f,g,h){var i,j,k=0;if(!a.havexpos||!a.havexneg)return[!1,a];for(j=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),i=0;108>i;i++){var l,m,n=0,o=0;m=i%4===0?1:i%4===2?2:3;var p=ab(a,b,c,d,e,f,g,h,j,k,n,o,l,m);if(a=p[1],k=p[2],n=p[3],o=p[4],m=p[5],p[0]){if(p[0])return[!0,a];var q=Y(n,o,b,c,d,e,f,g,h);if(o=q[1],l=q[0]){var r=t(n,o,a);if(a=r[1],r[0])return[!0,a];if(j=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),j<a.precision)return a.yneg<o&&(o=a.yneg,n=a.xneg),a.ypos<o&&(o=a.ypos,n=a.xpos),a.root=n,[!0,a]}}}return[!1,a]}function cb(a){var c,d=b.Convert,e=b._Helper,f=d.toDateTime(a[0]),g=d.toDateTime(a[1]),h=d.toDouble(a[2]),i=d.toDouble(a[3]),j=d.toDouble(a[4]),k=d.toInt(a[5]),o=e._argumentExists(a,6)?d.toInt(a[6]):0;if(0>o||o>4||1!==k&&2!==k&&4!==k||Ec(f,g)>0)return Cc;if(0>h||0>i||0>=j)return Cc;if(c=p(f,g,k),1>=c){var q=l(f,g,k,o),r=n(f,g,k,o),t=m(f,g,k,o),u=k*t/r,v=j/100+h/k-(i/100+q/t*h/k),w=i/100+q/t*h/k;return v/w*u}var x,y={},z=.1;y.xmin=0,y.xmax=0,y.precision=0,y.havexpos=!1,y.xpos=0,y.ypos=0,y.havexneg=!1,y.xneg=0,y.yneg=0,y.root=0,y=s(y),y.xmin=xc(y.xmin,0),y.xmax=yc(y.xmax,1e3);var A=$(y,f,g,h,i,j,k,o,z);if(y=A[1],x=A[0],!x){for(z=1e-10;z<y.xmax;z*=2)y=_(y,f,g,h,i,j,k,o,z)[1];A=bb(y,f,g,h,i,j,k,o),y=A[1],x=A[0]}return x?y.root:Cc}function db(a){var d,e,f=b.Convert,g=b._Helper,h=f.toDateTime(a[0]),i=f.toDateTime(a[1]),j=f.toDouble(a[2]),k=f.toDouble(a[3]),l=g._argumentExists(a,4)?f.toInt(a[4]):0;return 0>l||l>4?Cc:0>=k||0>=j||Ec(h,i)>=0?Cc:(d=k/j-1,e=c.Functions._DateHelper.yearfrac([h,i,l]),d/e)}function eb(a,b,d,e,f,g){var h=c.Functions._DateHelper.yearfrac,i=h([d,b,g]),j=h([d,a,g]),k=h([a,b,g]),l=1+i*e;return l/=f/100+j*e,l--,l/=k}function fb(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toDateTime(a[2]),h=c.toDouble(a[3]),i=c.toDouble(a[4]),j=d._argumentExists(a,5)?c.toInt(a[5]):0;return 0>j||j>4||0>h?Cc:eb(e,f,g,h,i,j)}function gb(a,b,c,d,e,f,g,h,i,j,k){return b=w(c,d,e,f,g,a,i,j,k)-h,[!0,b]}function hb(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o,p,q=0,r=0;if(n=a-c,n<d.xmin&&(n=a),o=a+c,o>d.xmax&&(o=a),n===o)return[!1,b,d];var s=gb(n,q,e,f,g,h,i,j,k,l,m);return q=s[1],(p=s[0])?(s=gb(o,r,e,f,g,h,i,j,k,l,m),r=s[1],(p=s[0])?(b=(r-q)/(o-n),[!0,b,d]):[p,b,d]):[p,b,d]}function ib(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=a.precision/2;for(l=0;20>l;l++){var o,p,q=0,r=0;if(k<a.xmin||k>a.xmax)return[!1,a];var s=gb(k,q,b,c,d,e,f,g,h,i,j);if(q=s[1],m=s[0],!m)return[m,a];if(s=t(k,q,a),a=s[1],s[0])return[!0,a];var u;u=sc(k)<1e-10?a.havexneg&&a.havexpos?sc(a.xpos-a.xneg)/1e6:(a.xmax-a.xmin)/1e6:sc(k)/1e6;var v=hb(k,r,u,a,b,c,d,e,f,g,h,i,j);if(a=v[2],r=v[1],m=v[0],!m)return[m,a];if(0===r)return[!1,a];if(o=k-1.000001*q/r,o===k)return a.root=k,[!0,a];if(p=sc(o-k)/(sc(k)+sc(o)),k=o,n>p)return a.root=k,[!0,a]}return[!1,a]}function jb(a,b,c,d,e,f,g,h,i,j,k){var l,m=0;if(k<a.xmin||k>a.xmax)return[!1,a];var n=gb(k,m,b,c,d,e,f,g,h,i,j);return m=n[1],(l=n[0])?(n=t(k,m,a),a=n[1],n[0]?[!0,a]:[!1,a]):[l,a]}function kb(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){switch(p){case 0:m=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var q;m=(a.xpos+a.xneg)/2;var r=gb(m,n,b,c,d,e,f,g,h,i,j);if(n=r[1],o=r[0],!o)return[qc,a,l,m,n,p];if(0===n)return a=t(m,n,a)[1],[!0,a,l,m,n,p];if(q=vc(n*n-a.ypos*a.yneg),0===q)return[qc,a,l,m,n,p];m+=(m-a.xpos)*n/q;break;case 3:m=(a.xpos+a.xneg)/2;break;case 2:var s=0,u=0,v=0,w=0;if(k>.1)return p=3,kb(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p);switch(l++%4){case 0:s=a.xpos,s=a.ypos;break;case 2:s=a.xneg,u=a.yneg;break;default:case 3:case 1:s=(a.xpos+a.xneg)/2;var x=gb(s,u,b,c,d,e,f,g,h,i,j);if(u=x[1],o=x[0],!o)return[qc,a,l,m,n,p]}v=sc(a.xpos-a.xneg)/1e6;var y=hb(s,w,v,a,b,c,d,e,f,g,h,i,j);if(a=y[2],w=y[1],o=y[0],!o)return[qc,a,l,m,n,p];if(0===w)return[qc,a,l,m,n,p];if(m=s-1.01*u/w,m<a.xpos&&m<a.xneg||m>a.xpos&&m>a.xneg)return[qc,a,l,m,n,p]}return[!1,a,l,m,n,p]}function lb(a,b,c,d,e,f,g,h,i,j){var k,l,m=0;if(!a.havexpos||!a.havexneg)return[!1,a];for(l=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),k=0;108>k;k++){var n,o,p=0,q=0;o=k%4===0?1:k%4===2?2:3;var r=kb(a,b,c,d,e,f,g,h,i,j,l,m,p,q,n,o);if(a=r[1],m=r[2],p=r[3],q=r[4],o=r[5],void 0!==r[0]&&r[0]!==qc){if(r[0])return[!0,a];var s=gb(p,q,b,c,d,e,f,g,h,i,j);if(q=s[1],n=s[0]){var u=t(p,q,a);if(a=u[1],u[0])return[!0,a];if(l=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),l<a.precision)return a.yneg<q&&(q=a.yneg,p=a.xneg),a.ypos<q&&(q=a.ypos,p=a.xpos),a.root=p,[!0,a]}}}return[!1,a]}function mb(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toDateTime(a[2]),h=c.toDateTime(a[3]),i=c.toDouble(a[4]),j=c.toDouble(a[5]),k=c.toDouble(a[6]),l=c.toInt(a[7]),m=d._argumentExists(a,8)?c.toInt(a[8]):0,n=.1,o={};if(0>m||m>4||1!==l&&2!==l&&4!==l||Ec(g,e)>0||Ec(e,h)>0||Ec(h,f)>0)return Cc;if(0>i||0>=j||0>=k)return Cc;o.xmin=0,o.xmax=0,o.precision=0,o.havexpos=!1,o.xpos=0,o.ypos=0,o.havexneg=!1,o.xneg=0,o.yneg=0,o.root=0,o=s(o),o.xmin=xc(o.xmin,0),o.xmax=yc(o.xmax,1e3);var p=ib(o,e,f,g,h,i,j,k,l,m,n);o=p[1];var q=p[0];if(q){for(n=1e-10;n<o.xmax;n*=2)o=jb(o,e,f,g,h,i,j,k,l,m,n)[1];p=lb(o,e,f,g,h,i,j,k,l,m),o=p[1],q=p[0]}return q?o.root:Cc}function nb(a,b,c,d,e,f,g,h){var i,j,k,l=new Date(c.getFullYear(),c.getMonth(),c.getDate());do l.setMonth(l.getMonth()+12/g);while(Ec(l,b)<0);return i=v(c,a,l,g,h),j=v(c,b,l,g,h),k=v(a,b,l,g,h),(g*(f-e)+100*d*(j-i))/(k*e+100*d*i*k/g)}function ob(a){var c=b.Convert,d=b._Helper,e=c.toDateTime(a[0]),f=c.toDateTime(a[1]),g=c.toDateTime(a[2]),h=c.toDouble(a[3]),i=c.toDouble(a[4]),j=c.toDouble(a[5]),k=c.toInt(a[6]),l=d._argumentExists(a,7)?c.toInt(a[7]):0;return 0>l||l>4||1!==k&&2!==k&&4!==k||Ec(e,f)>0||Ec(g,e)>0?Cc:0>h||0>i||0>=j?Cc:nb(e,f,g,h,i,j,k,l)}function pb(a){var c,d=b.Convert,e=d.toDateTime(a[0]),f=d.toDateTime(a[1]),g=d.toDouble(a[2]);if(Ec(e,f)>=0)return Cc;if(0>=g)return Cc;if(c=Fc(f)-Fc(e),c>365)return Cc;var h=365*g,i=360-g*c;return 0===i?Ac:0>i?Cc:d.toResult(h/i)}function qb(a){var c,d=b.Convert,e=d.toDateTime(a[0]),f=d.toDateTime(a[1]),g=d.toDouble(a[2]);return Ec(e,f)>=0?Cc:0>=g?Cc:(c=Fc(f)-Fc(e),c>365?Cc:(100-g)/g*(360/c))}function rb(a,b,c){var d,e=c.length,f=0,g=1,h=1/(a+1);for(d=0;e>d;d++)f+=c[d]*g,g*=h;return b=f,[!0,b]}function sb(a,b,c){var d,e=c.length,f=0,g=1,h=1/(a+1);for(d=1;e>d;d++)f+=c[d]*-d*g,g*=h;return b=f,[!0,b]}function tb(a,b,c){var d,e=a.precision/2;for(d=0;20>d;d++){var f,g,h,i=0,j=0;if(c<a.xmin||c>a.xmax)return[!1,a];var k=rb(c,i,b);if(i=k[1],h=k[0],!h)return[h,a];if(k=t(c,i,a),a=k[1],k[0])return[!0,a];if(k=sb(c,j,b),j=k[1],h=k[0],!h)return[h,a];if(0===j)return[!1,a];if(f=c-1.000001*i/j,f===c)return a.root=c,[!0,a];if(g=sc(f-c)/(sc(c)+sc(f)),c=f,e>g)return a.root=c,[!0,a]}return[!1,a]}function ub(a,b,c){var d,e=0;if(c<a.xmin||c>a.xmax)return[!1,a];var f=rb(c,e,b);return e=f[1],(d=f[0])?(f=t(c,e,a),a=f[1],f[0]?[!0,a]:[!1,a]):[d,a]}function vb(a,b,c,d,e){var f,g,h,i=0,j=0;if(f=a-c,f<d.xmin&&(f=a),g=a+c,g>d.xmax&&(g=a),f===g)return[!1,b,d];var k=rb(f,i,e);return i=k[1],(h=k[0])?(k=rb(g,j,e),j=k[1],(h=k[0])?(b=(j-i)/(g-f),[!0,b,d]):[h,b,d]):[h,b,d]}function wb(a,b,c,d,e,f,g,h){switch(h){case 0:e=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var i;e=(a.xpos+a.xneg)/2;var j=rb(e,f,b);if(f=j[1],g=j[0],!g)return[qc,a,d,e,f,h];if(0===f)return a=t(e,f,a)[1],[!0,a,d,e,f,h];if(i=vc(f*f-a.ypos*a.yneg),0===i)return[qc,a,d,e,f,h];e+=(e-a.xpos)*f/i;break;case 3:e=(a.xpos+a.xneg)/2;break;case 2:var k,l,m=0,n=0;if(c>.1)return h=3,wb(a,b,c,d,e,f,g,h);switch(d++%4){case 0:k=a.xpos,k=a.ypos;break;case 2:k=a.xneg,m=a.yneg;break;default:case 3:case 1:k=(a.xpos+a.xneg)/2;var o=rb(k,m,b);if(m=o[1],g=o[0],!g)return[qc,a,d,e,f,h]}l=sc(a.xpos-a.xneg)/1e6;var p=vb(k,n,l,a,b);if(a=p[2],n=p[1],g=p[0],!g)return[qc,a,d,e,f,h];if(0===n)return[qc,a,d,e,f,h];if(e=k-1.01*m/n,e<a.xpos&&e<a.xneg||e>a.xpos&&e>a.xneg)return[qc,a,d,e,f,h];break;default:return[!1,a,d,e,f,h]}return[!1,a,d,e,f,h]}function xb(a,b){var c,d,e=0;if(!a.havexpos||!a.havexneg)return[!1,a];for(d=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),c=0;160>c;c++){var f,g,h=0,i=0;i=c%4===0?1:c%4===2?2:3;var j=wb(a,b,d,e,f,h,g,i);if(a=j[1],e=j[2],f=j[3],h=j[4],i=j[5],j[0]!==qc){if(j[0])return[!0,a];var k=rb(f,h,b);if(h=k[1],g=k[0]){if(k=t(f,h,a),a=k[1],k[0])return[!0,a];if(d=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),d<a.precision)return a.yneg<h&&(h=a.yneg,f=a.xneg),a.ypos<h&&(h=a.ypos,f=a.xpos),a.root=f,[!0,a]}}}return[!1,a]}function yb(a){var c={};c.xmin=0,c.xmax=0,c.precision=0,c.havexpos=!1,c.xpos=0,c.ypos=0,c.havexneg=!1,c.xneg=0,c.yneg=0,c.root=0,c=s(c);var d=a[0],e=b.Convert,f=b._Helper,g=b._ArrayHelper,h=f._argumentExists(a,1)?e.toDouble(a[1]):.1;sc(h)>1&&(h=.1);var i=g.getLength(d);if(!g.isArrayOrReference(d)||2>i)return Cc;var j=1.79769e308,k=[];c.xmin=-1,c.xmax=yc(c.xmax,rc(j/1e10,1/i)-1);for(var l=!1,m=!1,n=0;i>n;n++){var o=g.getValueByIndex(d,n);if(e.isNumber(o)){var p=e.toDouble(o);k[n]=p,p>0&&(l=!0),0>p&&(m=!0)}else if(e.isError(o))return o}if(!l||!m)return e._inArray=!1,Cc;var q=tb(c,k,h);c=q[1];var r=q[0];if(!r){var t;for(t=2;(!c.havexneg||!c.havexpos)&&100>t;t*=2)c=ub(c,k,h*t)[1],c=ub(c,k,h/t)[1];q=xb(c,k),c=q[1],r=q[0]}return e._inArray=!1,r?c.root:Cc}function zb(a){var c=b.Convert,d=b._ArrayHelper,e=c.toDouble(a[1]),f=c.toDouble(a[2]),g=0,h=0,i=0,j=0,k=0,l=(d.getLength(a[0]),[]);if(!d.isArrayOrReference(a[0]))return Ac;for(var m=d.getLength(a[0]),n=0;m>n;n++){var o=d.getValueByIndex(a[0],n);if(c.isNumber(o)){var p=c.toDouble(o);l[n]=p,p>=0?g++:h++}else if(c.isError(o))return c._inArray=!1,o}c._inArray=!1,i=h+g;for(var q=0;i>q;q++){var r=l[q];r>=0?j+=r/rc(1+f,q):k+=r/rc(1+e,q)}if(0===k||0===j||-1>=f)return Ac;var s=rc(-j*rc(1+f,i)/(k*(1+f)),1/(i-1))-1;return s}function Ab(a,b,d,e){for(var f=0,g=e.length,h=0;g>h;h++){var i=Fc(d[h])-Fc(d[0]);if(0>i)return[!1,b];f+=e[h]/c.Functions._MathHelper.pow1p(a,i/365)}return isFinite(f)?b=isNaN(f)?5e-324:f:f===Number.POSITIVE_INFINITY?b=1.79769e308:f===Number.NEGATIVE_INFINITY&&(b=-1.79769e308),[!0,b]}function Bb(a,b,c,d,e,f){var g,h,i,j=0,k=0;if(g=a-c,g<d.xmin&&(g=a),h=a+c,h>d.xmax&&(h=a),g===h)return[!1,b,d];var l=Ab(g,j,e,f);return j=l[1],(i=l[0])?(l=Ab(h,k,e,f),k=l[1],(i=l[0])?(b=(k-j)/(h-g),[!0,b,d]):[i,b,d]):[i,b,d]}function Cb(a,b,c,d){var e,f,g=a.precision/2;for(e=0;20>e;e++){var h,i,j=0,k=0,l=Ab(d,j,b,c);if(j=l[1],f=l[0],!f)return[f,a];if(l=t(d,j,a),a=l[1],l[0])return[!0,a];var m;m=sc(d)<1e-10?a.havexneg&&a.havexpos?sc(a.xpos-a.xneg)/1e6:(a.xmax-a.xmin)/1e6:sc(d)/1e6;var n=Bb(d,k,m,a,b,c);if(f=n[0],k=n[1],a=n[2],!f)return[f,a];if(0===k)return[!1,a];if(h=d-1.000001*j/k,h===d)return a.root=d,[!0,a];if(i=sc(h-d)/(sc(d)+sc(h)),d=h,g>i)return a.root=d,[!0,a]}return[!1,a]}function Db(a,b,c,d,e){var f,g=0;if(b<a.xmin||b>a.xmax)return[!1,a,c];var h=Ab(b,c,d,e);return c=h[1],(f=h[0])?(h=t(b,g,a),a=h[1],h[0]?[!0,a,c]:[!1,a,c]):[f,a,c]}function Eb(a,b,c,d,e,f,g,h,i){switch(i){case 0:f=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var j;f=(a.xpos+a.xneg)/2;var k=Ab(f,g,b,c);if(g=k[1],h=k[0],!h)return[qc,a,e,f,g,i];if(0===g)return a=t(f,g,a)[1],[!0,a,e,f,g,i];if(j=vc(g*g-a.ypos*a.yneg),0===j)return[qc,a,e,f,g,i];f+=(f-a.xpos)*g/j;break;case 3:f=(a.xpos+a.xneg)/2;break;case 2:var l=0,m=0,n=0,o=0;if(d>.1)return i=3,Eb(a,b,c,d,e,f,g,h,i);switch(e++%4){case 0:l=a.xpos,l=a.ypos;break;case 2:l=a.xneg,m=a.yneg;break;default:case 3:case 1:l=(a.xpos+a.xneg)/2;var p=Ab(l,m,b,c);if(m=p[1],h=p[0],!h)return[qc,a,e,f,g,i]}n=sc(a.xpos-a.xneg)/1e6;var q=Bb(l,o,n,a,b,c);if(a=q[2],o=q[1],h=q[0],!h)return[qc,a,e,f,g,i];if(0===o)return[qc,a,e,f,g,i];if(f=l-1.01*m/o,f<a.xpos&&f<a.xneg||f>a.xpos&&f>a.xneg)return[qc,a,e,f,g,i]}return[!1,a,e,f,g,i]}function Fb(a,b,c){var d,e,f=0;if(!a.havexpos||!a.havexneg)return[!1,a];for(e=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),d=0;108>d;d++){var g,h,i=0,j=0;h=d%4===0?1:d%4===2?2:3;var k=Eb(a,b,c,e,f,i,j,g,h);if(a=k[1],f=k[2],i=k[3],j=k[4],h=k[5],k[0]){if(k[0])return[!0,a];var l=Ab(i,j,b,c);if(j=l[1],g=l[0]){if(l=t(i,j,a),a=l[1],l[0])return[!0,a];if(e=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),e<a.precision)return a.yneg<j&&(j=a.yneg,i=a.xneg),a.ypos<j&&(j=a.ypos,i=a.xpos),a.root=i,[!0,a]}}}return[!1,a]}function Gb(a){var c=b._ArrayHelper.getLength(a[0]),d=b._ArrayHelper.getLength(a[1]),e=[],f=[],g=b._Helper._argumentExists(a,2)?b.Convert.toDouble(a[2]):.1;if(c!==d)return Cc;for(var h=0;c>h;h++)e[h]=b.Convert.toDouble(b._ArrayHelper.getValueByIndex(a[0],h));for(h=0;d>h;h++)f[h]=b.Convert.toDateTime(b._ArrayHelper.getValueByIndex(a[1],h));var i={};i.xmin=0,i.xmax=0,i.precision=0,i.havexpos=!1,i.xpos=0,i.ypos=0,i.havexneg=!1,i.xneg=0,i.yneg=0,i.root=0,i=s(i),i.xmin=-1,i.xmax=yc(1e3,i.xmax);var j=Cb(i,f,e,g);if(i=j[1],j[0])return i.root;var k,l;for(k=1;1024>=k;k+=k){var m=b.Convert.toDouble(k),n=9/(m+9),o=Db(i,g,n,f,e);i=o[1],n=o[2],n=m,o=Db(i,g,n,f,e),i=o[1],n=o[2];var p=Fb(i,f,e);if(i=p[1],l=p[0])return i.root}return Cc}function Hb(a,d,e,f,g,h,i){var j,k,l,m,n;n=1/h,k=3>n?1:5>n?1.5:6>=n?2:2.5,h*=k;var o=c.Functions._DateHelper.yearfrac([d,e,i]);if(b.Convert.isError(o))return 0;var p=o;for(l=wc(p*h*a+.5),a-=l,m=a-f,j=0;g>j;j++){if(l=wc(h*a+.5),m-=l,0>m)switch(g-j){case 0:case 1:return wc(.5*a+.5);default:return 0}a-=l}return l}function Ib(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDateTime(a[1]),e=b.Convert.toDateTime(a[2]),f=b.Convert.toDouble(a[3]),g=b.Convert.toInt(a[4]),h=b.Convert.toDouble(a[5]),i=b._Helper._argumentExists(a,6)?b.Convert.toInt(a[6]):0,j=1/h;return j>0&&1>j||j>1&&2>j||j>2&&3>j||j>4&&5>j?Cc:Ec(d,e)>0?Cc:0>i||i>4||0>=h||2===i?Cc:Hb(c,d,e,f,g,h,i)}function Jb(a,d,e,f,g,h,i){var j=a*h,k=a-f,l=c.Functions._DateHelper.yearfrac([d,e,i]);if(b.Convert.isError(l))return 0;var m,n=l,o=n*h*a,p=(a-f-o)/j,q=b.Convert.toInt((a-f-o)/j);return m=0===g?o:q>=g?j*(1>p?p:1):g===q+1?k-j*q-o:0}function Kb(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDateTime(a[1]),e=b.Convert.toDateTime(a[2]),f=b.Convert.toDouble(a[3]),g=b.Convert.toInt(a[4]),h=b.Convert.toDouble(a[5]),i=b._Helper._argumentExists(a,6)?b.Convert.toInt(a[6]):0;return Ec(d,e)>0?Cc:0>i||i>4||0>=h||2===i?Cc:Jb(c,d,e,f,g,h,i)}function Lb(a){var d=b.Convert.toDouble(a[0]),e=b.Convert.toDouble(a[1]),f=b.Convert.toInt(a[2]),g=b.Convert.toInt(a[3]),h=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):12,i=f+(12>h?1:0);if(0>d||1>f||1>g||g>i||1>h||h>12)return Cc;if(0===d)return 0;for(var j=c.Functions._MathHelper.round(1-rc(e/d,1/f),3),k=0,l=0,m=1;g>=m;m++)l=1===m?d*j*h/12:m===f+1?(d-k)*j*(12-h)/12:(d-k)*j,k+=l;return l}function Mb(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDouble(a[1]),e=b.Convert.toInt(a[2]),f=b.Convert.toInt(a[3]),g=b._Helper._argumentExists(a,4)?b.Convert.toDouble(a[4]):2,h=0,i=0;if(0>=e||0>c)return Cc;if(f>e)return Cc;if(0>=g)return Cc;if(0>=f)return Cc;if(d>=c)return 0;for(var j=1;f>=j;j++)i=(c-h)*(g/e),i=yc(i,c-h-d),h+=i;return i}function Nb(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDouble(a[1]),e=b.Convert.toInt(a[2]);return 0===e?Ac:(c-d)/e}function Ob(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDouble(a[1]),e=b.Convert.toInt(a[2]),f=b.Convert.toInt(a[3]);return 0>d||1>e||0>=f||f>e?Cc:(c-d)*(e-f+1)*2/(e*(e+1))}function Pb(a,b,c,d,e){var f,g,h,i;return g=e/c,g>=1?(g=1,h=1===d?a:0):h=a*rc(1-g,d-1),i=a*rc(1-g,d),f=b>i?h-b:h-i,0>f&&(f=0),f}function Qb(a,c,d,e,f,g){var h,i,j,k,l=0,m=tc(f),n=b.Convert.toInt(m),o=a-c,p=!1;for(i=0,k=1;n>=k;k++)p?h=i:(j=Pb(a,c,d,k,g),i=o/(e-(k-1)),i>j?(h=i,p=!0):(h=j,o-=j)),k===n&&(h*=f+1-m),l+=h;return l}function Rb(a,c,d,e,f,g,h){var i,j,k=wc(e),l=tc(f),m=b.Convert.toInt(k),n=b.Convert.toInt(l);if(i=0,h)for(j=m+1;n>=j;j++){var o;o=Pb(a,c,d,j,g),j===m+1?o*=yc(f,k+1)-e:j===n&&(o*=f+1-l),i+=o}else{var p,q=d;e!==wc(e)&&g>1&&e>=d/2&&(p=e-d/2,e=d/2,f-=p,q+=1),a-=Qb(a,c,d,q,e,g),i=Qb(a,c,d,d-e,f-e,g)}return i}function Sb(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toDouble(a[1]),e=b.Convert.toInt(a[2]),f=b.Convert.toDouble(a[3]),g=b.Convert.toDouble(a[4]),h=b._Helper._argumentExists(a,5)?b.Convert.toDouble(a[5]):2,i=b._Helper._argumentExists(a,6)?b.Convert.toBool(a[6]):!1;return 0>c||0>d||0>e||0>f||0>g||f>g?Cc:d>c&&0===f&&1===g?c-d:Rb(c,d,e,f,g,h,i)}function Tb(a){{var c,e,f,g,h=b.Convert.toDateTime(a[0]),i=(b.Convert.toDateTime(a[1]),b.Convert.toDateTime(a[2])),j=b.Convert.toDouble(a[3]),k=b._Helper._argumentExists(a,4)?b.Convert.toDouble(a[4]):1e3,l=b.Convert.toInt(a[5]),m=b._Helper._argumentExists(a,6)?b.Convert.toInt(a[6]):0;b._Helper._argumentExists(a,7)?b.Convert.toBool(a[7]):!0}return 0>=j||0>=k?Cc:0>m||m>4?Cc:1!==l&&2!==l&&4!==l?Cc:Ec(h,i)>=0?Cc:(c=d(h,i,m),e=Gc(h,m),0>c||0>=e?Cc:(f=k*j/b.Convert.toDouble(l),g=c/e,f*b.Convert.toDouble(l)*g))}function Ub(a){var c,e,f=b.Convert.toDateTime(a[0]),g=b.Convert.toDateTime(a[1]),h=b.Convert.toDouble(a[2]),i=b._Helper._argumentExists(a,3)?b.Convert.toDouble(a[3]):1e3,j=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):0;return 0>=h||0>=i||0>j||j>4?Cc:Ec(f,g)>0?Cc:(c=d(f,g,j),e=Gc(f,j),0>c||0>=e?Cc:i*h*c/e)}function Vb(a){var c,e,f=b.Convert.toDateTime(a[0]),g=b.Convert.toDateTime(a[1]),h=b.Convert.toDouble(a[2]),i=b.Convert.toDouble(a[3]),j=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):0;return Ec(f,g)>=0?Cc:0>=h||0>=i||0>j||j>4?Cc:(e=Gc(f,j),c=d(f,g,j),0>=c||0>=e?Cc:(i-h)/i*(e/c))}function Wb(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toInt(a[1]);return 0>=c||1>d?Cc:rc(1+c/d,d)-1}function Xb(a){var c,e,f=b.Convert.toDateTime(a[0]),g=b.Convert.toDateTime(a[1]),h=b.Convert.toDouble(a[2]),i=b.Convert.toDouble(a[3]),j=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):0;return Ec(f,g)>=0?Cc:0>=h||0>=i||0>j||j>4?Cc:(c=d(f,g,j),e=Gc(f,j),0>=c||0>=e?Cc:(i-h)/h*(e/c))}function Yb(a){var c=b.Convert.toDouble(a[0]),d=b.Convert.toInt(a[1]);return 0>=c||1>d?Cc:d*(rc(1+c,1/d)-1)}function Zb(a,b,c){if(a>-1&&0!==a){var d=c,e=rc(1+a,d.nper),f=(rc(1+a,d.nper)-1)/a;return b=d.pv*e+d.pmt*(1+a*d.type)*f+d.fv,[!0,b,c]}return[!1,b,c]}function $b(a,b,c){if(a>-1&&0!==a){var d=c,e=rc(1+a,d.nper-1),f=(rc(1+a,d.nper)-1)/a;return b=-d.pmt*f/a+e*d.nper*(d.pv+d.pmt*(d.type+1/a)),[!0,b,c]}return[!1,b,c]}function _b(a,b,c){var d,e=a.precision/2;for(d=0;100>d;d++){var f,g,h,i=0,j=0;if(c<a.xmin||c>a.xmax)return[!1,a,b];var k=Zb(c,i,b);if(b=k[2],i=k[1],h=k[0],!h)return[h,a,b];var l=t(c,i,a);if(a=l[1],l[0])return[!0,a,b];if(k=$b(c,j,b),b=k[2],j=k[1],h=k[0],!h)return[h,a,b];if(0===j)return[!1,a,b];if(f=c-1.000001*i/j,f===c)return a.root=c,[!0,a,b];if(g=sc(f-c)/(sc(c)+sc(f)),c=f,e>g)return a.root=c,[!0,a,b]}return[!1,a,b]}function ac(a,b,c){var d,e=0;if(c<a.xmin||c>a.xmax)return[!1,a,b];var f=Zb(c,e,b);if(b=f[2],e=f[1],d=f[0],!d)return[d,a,b];var g=t(c,e,a);return a=g[1],g[0]?[!0,a,b]:[!1,a,b]}function bc(a,b,c,d,e){var f,g,h,i=0,j=0;if(f=a-c,f<d.xmin&&(f=a),g=a+c,g>d.xmax&&(g=a),f===g)return[!1,b,d,e];var k=Zb(f,i,e);return e=k[2],i=k[1],(h=k[0])?(k=Zb(g,j,e),e=k[2],j=k[1],(h=k[0])?(b=(j-i)/(g-f),[!0,b,d,e]):[h,b,d,e]):[h,b,d,e]}function cc(a,b,c,d,e,f,g,h){switch(h){case 0:e=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var i;e=(a.xpos+a.xneg)/2;var j=Zb(e,f,b);if(b=j[2],f=j[1],g=j[0],!g)return[qc,a,b,d,e,f,h];if(0===f)return a=t(e,f,a)[1],[!0,a,b,d,e,f,h];if(i=vc(f*f-a.ypos*a.yneg),0===i)return[qc,a,b,d,e,f,h];e+=(e-a.xpos)*f/i;break;case 3:e=(a.xpos+a.xneg)/2;break;case 2:var k,l,m=0,n=0;if(c>.1)return h=3,cc(a,b,c,d,e,f,g,h);switch(d++%4){case 0:k=a.xpos,k=a.ypos;break;case 2:k=a.xneg,m=a.yneg;break;default:case 3:case 1:if(k=(a.xpos+a.xneg)/2,j=Zb(k,m,b),b=j[2],m=j[1],g=j[0],!g)return[qc,a,b,d,e,f,h]}l=sc(a.xpos-a.xneg)/1e6;var o=bc(k,n,l,a,b);if(b=o[3],a=o[2],n=o[1],g=o[0],!g)return[qc,a,b,d,e,f,h];if(0===n)return[qc,a,b,d,e,f,h];if(e=k-1.01*m/n,e<a.xpos&&e<a.xneg||e>a.xpos&&e>a.xneg)return[qc,a,b,d,e,f,h];break;default:return[!1,a,b,d,e,f,h]}return[!1,a,b,d,e,f,h]}function dc(a,b){var c,d,e=0;if(!a.havexpos||!a.havexneg)return[!1,a,b];for(d=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),c=0;160>c;c++){var f,g,h=0,i=0;i=c%4===0?1:c%4===2?2:3;var j=cc(a,b,d,e,f,h,g,i);if(a=j[1],b=j[2],e=j[3],f=j[4],h=j[5],i=j[6],j[0]){if(j[0])return[!0,a,b];var k=Zb(f,h,b);if(b=k[2],h=k[1],g=k[0]){var l=t(f,h,a);if(a=l[1],l[0])return[!0,a,b];if(d=sc(a.xpos-a.xneg)/(sc(a.xpos)+sc(a.xneg)),d<a.precision)return a.yneg<h&&(h=a.yneg,f=a.xneg),a.ypos<h&&(h=a.ypos,f=a.xpos),a.root=f,[!0,a,b]}}}return[!1,a,b]}function ec(a){var c={},d=b.Convert.toDouble(a[0]),e=b.Convert.toDouble(a[1]),f=b.Convert.toDouble(a[2]),g=b._Helper._argumentExists(a,3)?b.Convert.toDouble(a[3]):0,h=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):0,i=b._Helper._argumentExists(a,5)?b.Convert.toDouble(a[5]):.1;if(0>=d)return Cc;if(0>h)return Bc;h>1&&(h=1),c.xmin=0,c.xmax=0,c.precision=0,c.havexpos=!1,c.xpos=0,c.ypos=0,c.havexneg=!1,c.xneg=0,c.yneg=0,c.root=0,c=s(c),c.xmin=xc(c.xmin,-rc(1.7976931348623157e298,1/d)+1),c.xmax=yc(c.xmax,rc(1.7976931348623157e298,1/d)-1);var j={};j.nper=d,j.pmt=e,j.pv=f,j.fv=g,j.type=b.Convert.toInt(h);var k=_b(c,j,i);j=k[2],c=k[1];var l=k[0];if(!l){var m;for(m=2;(!c.havexneg||!c.havexpos)&&100>m;m*=2)k=ac(c,j,i*m),j=k[2],c=k[1],k=ac(c,j,i/m),j=k[2],c=k[1];k=dc(c,j),j=k[2],c=k[1],l=k[0]}return l?c.root:Cc}function fc(a){var d=b.Convert.toDouble(a[0]),e=b.Convert.toInt(a[1]);if(0===e)return Ac;if(0>e)return Cc;var f=0>d?tc(d):wc(d),g=d-f,h=rc(10,tc(c.Functions._MathHelper.log10(e)));return b.Convert.toResult(f+g*h/e)}function gc(a){var d=b.Convert.toDouble(a[0]),e=b.Convert.toInt(a[1]);if(0===e)return Ac;if(0>e)return Cc;var f=0>d?tc(d):wc(d),g=d-f,h=rc(10,tc(c.Functions._MathHelper.log10(e)));return b.Convert.toResult(f+g*e/h)}function hc(a){var c=b.Convert.toDateTime(a[0]),d=b.Convert.toDateTime(a[1]),e=b.Convert.toDouble(a[2]),f=b.Convert.toDouble(a[3]),g=b.Convert.toDouble(a[4]),h=b.Convert.toInt(a[5]),i=b._Helper._argumentExists(a,6)?b.Convert.toInt(a[6]):0;return 0>f||0>e||0===g?Cc:0>i||i>4?Cc:1!==h&&2!==h&&4!==h?Cc:Ec(c,d)>0?Cc:u(c,d,e,f,g,h,i)}function ic(a){var c,e,f=b.Convert.toDateTime(a[0]),g=b.Convert.toDateTime(a[1]),h=b.Convert.toDouble(a[2]),i=b.Convert.toDouble(a[3]),j=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):0;return Ec(f,g)>=0?Cc:0>=h||0>=i||0>j||j>4?Cc:(c=d(f,g,j),e=Gc(f,j),0>=c||0>=e?Cc:i-h*i*c/e)}function jc(a){var c,e,f,g,h,i=b.Convert.toDateTime(a[0]),j=b.Convert.toDateTime(a[1]),k=b.Convert.toDateTime(a[2]),l=b.Convert.toDouble(a[3]),m=b.Convert.toDouble(a[4]),n=b._Helper._argumentExists(a,5)?b.Convert.toInt(a[5]):0;return Ec(i,j)>=0?Cc:0>l||0>m||0>n||n>4?Cc:(f=d(i,j,n),g=d(k,j,n),c=d(k,i,n),e=Gc(i,n),0>=c||0>=e||0>=f||0>=g?Cc:(h=1+f/e*m,0===h?Cc:(100+g/e*l*100)/h-c/e*l*100))}function kc(a){var c=b.Convert.toDateTime(a[0]),d=b.Convert.toDateTime(a[1]),e=b.Convert.toDateTime(a[2]),f=b.Convert.toDateTime(a[3]),g=b.Convert.toDouble(a[4]),h=b.Convert.toDouble(a[5]),i=b.Convert.toDouble(a[6]),j=b.Convert.toInt(a[7]),k=b._Helper._argumentExists(a,8)?b.Convert.toInt(a[8]):0;return 0>k||k>4||1!==j&&2!==j&&4!==j||Ec(e,c)>0||Ec(c,f)>0||Ec(f,d)>0?Cc:0>g||0>h||0>=i?Cc:w(c,d,e,f,g,h,i,j,k)}function lc(a,b,c,d,e,f,g,h){var i,j,k,l=new Date(c.getFullYear(),c.getMonth(),c.getDate());do l.setMonth(l.getMonth()+12/g);while(Ec(l,b)<0);return i=v(c,a,l,g,h),j=v(c,b,l,g,h),k=v(a,b,l,g,h),(f*g+100*d*(j-i*(1+e*k/g)))/(e*k+g)}function mc(a){var c=b.Convert.toDateTime(a[0]),d=b.Convert.toDateTime(a[1]),e=b.Convert.toDateTime(a[2]),f=b.Convert.toDouble(a[3]),g=b.Convert.toDouble(a[4]),h=b.Convert.toDouble(a[5]),i=b.Convert.toInt(a[6]),j=b._Helper._argumentExists(a,7)?b.Convert.toInt(a[7]):0;return 0>j||j>4||1!==i&&2!==i&&4!==i||Ec(c,d)>0||Ec(e,c)>0?Cc:0>f||0>g||0>=h?Cc:lc(c,d,e,f,g,h,i,j)}function nc(a){var c,d=b.Convert.toDateTime(a[0]),e=b.Convert.toDateTime(a[1]),f=b.Convert.toDouble(a[2]);return Ec(d,e)>=0?Cc:0>=f?Cc:(c=Fc(e)-Fc(d),c>365?Cc:100*(1-f*c/360))}function oc(a){var c=b.Convert.toString(a[0]),d=x(c,2);return d>=0?d:Cc}function pc(a){var d=b.Convert.toDouble(a[0]),e=b.Convert.toString(a[1]),f=b.Convert.toString(a[2]),g=b._Helper._argumentExists(a,3)?b.Convert.toBool(a[3]):!1,h=b._Helper._argumentExists(a,4)?b.Convert.toInt(a[4]):3,i=0;if(3>h)return Bc;g||(i=z(f)),b._Helper._argumentExists(a,4)||(h=y(e));var j=0,k=x(e,h),l=x(f,h);return k>=0&&l>=0?(j=d*l/k,g||(j=c.Functions._MathHelper.round(j,i)),j):Bc}a.feature("calc.functions_fin",["calc.functions"]);var qc=null,rc=Math.pow,sc=Math.abs,tc=Math.ceil,uc=Math.log,vc=Math.sqrt,wc=Math.floor,xc=Math.max,yc=Math.min,zc=b.Errors,Ac=(zc.Null,zc.DivideByZero),Bc=zc.Value,Cc=(zc.Reference,zc.Name,zc.NotAvailable,zc.Number),Dc=c._FinancialHelper.__isLeapYear,Ec=c._FinancialHelper.__compareDateTime,Fc=c._FinancialHelper.__toOADate,Gc=c._FinancialHelper.__annual_year_basis,Hc=c._FinancialHelper.__getDaysInMonth,Ic=(c._FinancialHelper.__Days_Between_BASIS_30E_360,c._FinancialHelper.__Days_Between_BASIS_30Ep_360,c._FinancialHelper.__Days_Between_BASIS_MSRB_30_360_SYM,c._FinancialHelper.__Days_Between_BASIS_MSRB_30_360,c._FinancialHelper.__days_between_basis);c.def("FV",A,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsThreeFour}),c.def("FVSCHEDULE",B,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsOne,acceptsReference:c.acceptsOne}),c.def("NPV",C,{minArgs:2,acceptsArray:c.acceptsPositive,acceptsReference:c.acceptsPositive}),c.def("PV",D,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsThreeFour}),c.def("RECEIVED",E,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("XNPV",F,{minArgs:3,maxArgs:3,acceptsArray:c.acceptsNotZero,acceptsReference:c.acceptsNotZero}),c.def("CUMIPMT",H,{minArgs:6,maxArgs:6}),c.def("CUMPRINC",J,{minArgs:6,maxArgs:6}),c.def("IPMT",K,{minArgs:4,maxArgs:6,acceptsMissingArgument:c.acceptsFourFive}),c.def("ISPMT",L,{minArgs:4,maxArgs:4}),c.def("PMT",M,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsThreeFour}),c.def("PPMT",N,{minArgs:4,maxArgs:6,acceptsMissingArgument:c.acceptsFourFive}),c.def("COUPDAYBS",O,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsThree}),c.def("COUPDAYS",P,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsThree}),c.def("COUPDAYSNC",Q,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsThree}),c.def("COUPNCD",R,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsThree}),c.def("COUPNUM",S,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsThree}),c.def("COUPPCD",T,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsThree}),c.def("DURATION",U,{minArgs:5,maxArgs:6,acceptsMissingArgument:c.acceptsFive}),c.def("MDURATION",W,{minArgs:5,maxArgs:6,acceptsMissingArgument:c.acceptsFive}),c.def("NPER",X,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsThreeFour}),c.def("YIELD",cb,{minArgs:6,maxArgs:7,acceptsMissingArgument:c.acceptsSix}),c.def("YIELDDISC",db,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("YIELDMAT",fb,{minArgs:5,maxArgs:6,acceptsMissingArgument:c.acceptsFive}),c.def("ODDFYIELD",mb,{minArgs:8,maxArgs:9,acceptsMissingArgument:c.acceptsEight}),c.def("ODDLYIELD",ob,{minArgs:7,maxArgs:8,acceptsMissingArgument:c.acceptsSeven}),c.def("TBILLEQ",pb,{minArgs:3,maxArgs:3}),c.def("TBILLYIELD",qb,{minArgs:3,maxArgs:3}),c.def("IRR",yb,{minArgs:1,maxArgs:2,acceptsMissingArgument:c.acceptsOne,acceptsArray:c.acceptsZero,acceptsReference:c.acceptsZero}),c.def("MIRR",zb,{minArgs:3,maxArgs:3,acceptsArray:c.acceptsZero,acceptsReference:c.acceptsZero}),c.def("XIRR",Gb,{minArgs:2,maxArgs:3,acceptsMissingArgument:c.acceptsTwo,acceptsArray:c.acceptsNotTwo,acceptsReference:c.acceptsNotTwo}),c.def("AMORDEGRC",Ib,{minArgs:6,maxArgs:7,acceptsMissingArgument:c.acceptsSix}),c.def("AMORLINC",Kb,{minArgs:6,maxArgs:7,acceptsMissingArgument:c.acceptsSix}),c.def("DB",Lb,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("DDB",Mb,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("SLN",Nb,{minArgs:3,maxArgs:3}),c.def("SYD",Ob,{minArgs:4,maxArgs:4}),c.def("VDB",Sb,{minArgs:5,maxArgs:7,acceptsMissingArgument:c.acceptsFiveSix}),c.def("ACCRINT",Tb,{minArgs:6,maxArgs:8,acceptsMissingArgument:c.acceptsFourSixSeven}),c.def("ACCRINTM",Ub,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsThreeFour}),c.def("DISC",Vb,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("EFFECT",Wb,{minArgs:2,maxArgs:2}),c.def("INTRATE",Xb,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("NOMINAL",Yb,{minArgs:2,maxArgs:2}),c.def("RATE",ec,{minArgs:3,maxArgs:6,acceptsMissingArgument:c.acceptsThreeFourFive}),c.def("DOLLARDE",fc,{minArgs:2,maxArgs:2}),c.def("DOLLARFR",gc,{minArgs:2,maxArgs:2}),c.def("PRICE",hc,{minArgs:6,maxArgs:7,acceptsMissingArgument:c.acceptsSix}),c.def("PRICEDISC",ic,{minArgs:4,maxArgs:5,acceptsMissingArgument:c.acceptsFour}),c.def("PRICEMAT",jc,{minArgs:5,maxArgs:6,acceptsMissingArgument:c.acceptsFive}),c.def("ODDFPRICE",kc,{minArgs:8,maxArgs:9,acceptsMissingArgument:c.acceptsEight}),c.def("ODDLPRICE",mc,{minArgs:7,maxArgs:8,acceptsMissingArgument:c.acceptsSeven}),c.def("TBILLPRICE",nc,{minArgs:3,maxArgs:3}),c.def("EURO",oc,{minArgs:1,maxArgs:1}),c.def("EUROCONVERT",pc,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsThreeFour})
}(b.Functions||(b.Functions={}));b.Functions}(a.Calc||(a.Calc={}));a.Calc}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wijmo;!function(a){!function(b){!function(c){!function(d){function e(a,b,d){if(a===O||a===N)return N;if(c._ArrayHelper.isArrayOrReference(a)){if(b>c._ArrayHelper.getColumnCount(a)){var e=b;b=d,d=e}var f=d*c._ArrayHelper.getColumnCount(a)+b;return c.Convert._inArray=!1,c._ArrayHelper.getValueByIndex(a,f,0)}return a}function f(a,b){return b===O||b===N?!1:c.Convert.isNumber(a)&&c.Convert.isNumber(b)?!0:"boolean"==typeof a&&"boolean"==typeof b?!0:"string"==typeof a&&"string"==typeof b?!0:!1}function g(a,b,c,d,e){if(0>a)return-1;if(0>b)return-1;if(a>b)return-1;if(a>c)return-1;if(c>b)return-1;if(e)return G=a,H=b,I=c,J=c,K=d,L=d,I;if(K){if(I++,I>H&&K===L)I=J-1,K=!1;else if(I>H&&K!==L)return-1}else if(I--,G>I&&K===L)I=J+1,K=!0;else if(G>I&&K!==L)return-1;return I}function h(b,d,e){if(b===d)return 0;var f=N;if("string"==typeof b){if(d||0!==b.toString().length){if(c.Convert.isNumber(d))return 1;if("boolean"==typeof d)return 2;if("string"==typeof d){var g;return g=e?b.toString().localeCompare(d.toString()):b.toLowerCase().localeCompare(d.toLowerCase()),0===g?0:g>0?1:2}return d instanceof Date?(f=a.spread._DateTimeHelper._parseDate(b),isNaN(f)?1:f===d?0:f>d?1:2):-1}return 0}if("string"==typeof d)return b||0!==d.toString().length?c.Convert.isNumber(b)?2:"boolean"==typeof b?1:b instanceof Date?(f=a.spread._DateTimeHelper._parseDate(b),isNaN(f)?2:f===d?0:f>d?1:2):-1:0;if("boolean"==typeof b&&c.Convert.isNumber(d))return 1;if("boolean"==typeof d&&c.Convert.isNumber(b))return 2;var h=c.Convert.toDouble(b),i=c.Convert.toDouble(d);return h===i?0:i>h?2:1}function i(a,b,c){var d=e(a,b,c);return d===O||d===N?0:d}function j(a,b,d,j){var k,l=-1,m=0,n=-1,o=-1;if(k=j?c._ArrayHelper.getRowCount(b):c._ArrayHelper.getColumnCount(b),k--,m>k)return-1;for(;k>=m;){var p,q=N;d>=1!=(2===l)&&(n=o),o=c.Convert.toInt((m+k)/2),o=g(m,k,o,d>=0,!0),p=o;var r=a;for(a instanceof c.CalcArray?r=a.getValue(0,0):a instanceof c._SheetRangeReference?r=a.getValue(0,0,0,0):a instanceof c.Reference&&(r=a.getValue(0,0,0));!f(r,q)&&-1!==o;){var s=!1;if(q=j?e(b,0,o):e(b,o,0),f(r,q))break;o=g(0,0,0,!1,!1),!s&&d>=0&&p>o?(k=o,s=!0):!s&&0>d&&o>p&&(m=o,s=!0)}if(-1===o&&d>=1!=(2===l))return n;if(-1===o)return-1;if(l=h(r,q,!1),d>=1&&1===l)m=o+1;else if(d>=1&&2===l)k=o-1;else if(-1>=d&&1===l)k=o-1;else if(-1>=d&&2===l)m=o+1;else if(0===l){for(;-1>=d&&o>m||d>=0&&k>o;){var t=0;if(t=d>=0?o+1:o-1,q=j?i(b,0,t):i(b,t,0),"undefined"==typeof q||null===q)return-1;if(!f(r,q))break;if(l=h(r,q,!1),0!==l)break;o=t}return o}}return d>=1!=(2===l)?o:n}function k(a,b,d,e){var g,j,k,l=N,m=-1;for(j=e?c._ArrayHelper.getRowCount(b):c._ArrayHelper.getColumnCount(b),k=0;j>k;k++){var n;if(n=e?i(b,0,k):i(b,k,0),n===O||n===N)return-1;var o=a;if(a instanceof c.CalcArray?o=a.getValue(0,0):a instanceof c.Reference&&(o=a.getValue(0,0,0)),f(o,n))if(g=h(o,n,!1),d>=1&&1===g)g=-1,m>=0&&(g=h(n,l,!1)),(0>m||m>=0&&1===g)&&(m=k,l=n);else if(-1>=d&&2===g)g=-1,m>=0&&(g=h(n,l,!1)),(0>m||m>=0&&2===g)&&(m=k,l=n);else if(0===g)return k}return m}function l(){return!0}function m(a){if(c.Convert.isError(a))return-1;try{return c.Convert.toInt(a)}catch(b){}return-1}function n(a){if(!a)throw b.SR.Exp_InvalidArgument;if(a.length<1||a.length>1)throw b.SR.Exp_InvalidArgument}function o(a,b){if(n([a]),!b)return Q;var d=b.arrayFormulaMode,e=c._Helper._argumentExists(a,0)?a[0]:b.getReference(b.source,b.row,b.column,b.rowCount,b.columnCount);return e&&1===e.getRangeCount()?d?new T(e.getSource(),e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0),0):e.getRow(0)+1:Q}function p(a,b){if(n([a]),!b)return Q;var d=b.arrayFormulaMode,e=c._Helper._argumentExists(a,0)?a[0]:b.getReference(b.source,b.row,b.column,b.rowCount,b.columnCount);return e&&1===e.getRangeCount()?d?new T(e.getSource(),e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0),1):e.getColumn(0)+1:Q}function q(a){return n([a]),c._ArrayHelper.getRowCount(a[0])}function r(a){return n([a]),c._ArrayHelper.getColumnCount(a[0])}function s(a){return n([a]),new U(a[0])}function t(a){var b=(a[0],a[1]),d=c.Convert.toInt(a[2]),e=c._Helper._argumentExists(a,3)?c.Convert.toBool(a[3]):!0,f=-1;if(0>=d)return Q;if(d>c._ArrayHelper.getRowCount(b))return R;if(f=e?j(a[0],a[1],1,!1):k(a[0],a[1],0,!1),f>=0){var g=i(a[1],f,d-1);return g}return S}function u(a){var b=(a[0],a[1]),d=c.Convert.toInt(a[2]),e=c._Helper._argumentExists(a,3)?c.Convert.toBool(a[3]):!0,f=-1;if(0>=d)return Q;if(d>c._ArrayHelper.getColumnCount(b))return R;if(f=e?j(a[0],a[1],1,!0):k(a[0],a[1],0,!0),f>=0){var g=i(a[1],d-1,f);return g}return S}function v(a){var b,d=-1,e=c._ArrayHelper.getColumnCount(a[1]),f=c._ArrayHelper.getRowCount(a[1]);if(!(a.length>2)){var g=N;return e>f?(g=t([a[0],a[1],f]),g instanceof c.Error?S:g):(g=u([a[0],a[1],e]),g instanceof c.Error?S:g)}if(b=a[2]){var h=c._ArrayHelper.getColumnCount(b),k=c._ArrayHelper.getRowCount(b);if(h>1&&k>1)return S}else b=a[1];if(d=j(a[0],a[1],1,e>f?!1:!0),d>=0){var l=N;return e=c._ArrayHelper.getColumnCount(b),f=c._ArrayHelper.getRowCount(b),l=e>f?i(b,d,f-1):i(b,e-1,d)}return S}function w(a){var b=c.Convert.toInt(a[0]);return 1>b||a.length<=b?Q:a[b]?a[b]:0}function x(a,b){for(var d=c._ArrayHelper.getLength(a),e=0;d>e;e++)if(e>0){var f=c._ArrayHelper.getValueByIndex(a,e-1),g=c._ArrayHelper.getValueByIndex(a,e),i=h(f,g,!1);if(2===i&&!b)return!1}return!0}function y(a){if(!(a[1]instanceof c.Array||a[1]instanceof c.Reference))return S;var b=c._ArrayHelper.getColumnCount(a[1]),d=c._ArrayHelper.getRowCount(a[1]),e=c._Helper._argumentExists(a,2)?c.Convert.toInt(a[2]):0;if(b>1&&d>1)return S;if(1===e&&!x(a[1],!0))return S;if(-1===e&&!x(a[1],!1))return S;var f=-1;return 1===e?f=j(a[0],a[1],1,d>1):0===e?f=k(a[0],a[1],0,d>1):-1===e&&(f=j(a[0],a[1],-1,d>1)),-1===f?S:f+1}function z(a,b,c,d){a.append(b),d?0!==c&&(a.append("["),a.append(c.toString()),a.append("]")):a.append(c)}function A(a,b,c){return c||a.append("$"),a.append(b),a}function B(a,b,c){c||a.append("$");for(var d=a.toString().length;b>.1;b=(b-1)/26)a.insert(String.fromCharCode("A".charCodeAt(0)+(b-1)%26),d);return a}function C(a,b){if(b&&0<b.length){for(var d=!c.Parser._isLetter(b[0])&&"_"!==b[0],e=1;!d&&e<b.length;e++)d=!c.Parser._isLetterOrDigit(b[e])&&"_"!==b[e];d?(a.append("'"),a.append(b.replace("'","''")),a.append("'")):a.append(b),a.append("!")}return a}function D(a){var d=c.Convert.toInt(a[0]),e=c.Convert.toInt(a[1]),f=c._Helper._argumentExists(a,2)?c.Convert.toInt(a[2]):1,g=c._Helper._argumentExists(a,3)?c.Convert.toBool(a[3]):!0,h=c._Helper._argumentExists(a,4)?c.Convert.toString(a[4]):"",i=3===f||4===f||7===f||8===f,j=2===f||4===f||6===f||8===f,k=new b._StringBuilder;return 1>d&&(g||!i)||d>c.Parser.maxRowCount?Q:1>e&&(g||!j)||e>c.Parser.maxColumnCount?Q:1>f||f>8?Q:(C(k,h),g?(B(k,e,j),A(k,d,i)):(z(k,"R",d,i),z(k,"C",e,j)),k.toString())}function E(a,d){var e=d instanceof c.EvaluateContext?d:O,f=e!=N?e.acceptsReference:!1;if(a[0]instanceof c.Reference){var g=a[0],h=g.getRowCount(0),i=g.getColumnCount(0);if(2==a.length){if(1!=g.getRangeCount()||1!=h&&1!=i)return R;var j=c._Helper._argumentExists(a,1)?c.Convert.toInt(a[1]):0;if(0!=j||f||e==N||(j=h>0?e.rowOffset:e.columnOffset),0>j)return Q;if(j>h*i)return R;if(0==j)return new c._ConcreteReference(g,[new b.Range(0,0,h,i)]);var k=g.getRow(0),l=g.getColumn(0),m=Math.floor((j-1)/i)+k,n=(j-1)%i+l;return new c._ConcreteReference(g,[new b.Range(m,n,1,1)])}var o=c._Helper._argumentExists(a,1)?c.Convert.toInt(a[1])-1:-1,p=c._Helper._argumentExists(a,2)?c.Convert.toInt(a[2])-1:-1,q=c._Helper._argumentExists(a,3)?c.Convert.toInt(a[3])-1:0;if(q>=g.getRangeCount())return R;h=g.getRowCount(q),i=g.getColumnCount(q);var k=g.getRow(q),l=g.getColumn(q);-1==o&&!f&&h>1&&e!=N&&(o=e.rowOffset),-1==p&&!f&&i>1&&e!=N&&(p=e.columnOffset);var m=o+k,n=p+l;return-1>o||-1>p||0>q?Q:o>h||p>i||g.getRangeCount()<=q?R:-1==o&&-1==p?new c._ConcreteReference(g,[new b.Range(k,l,h,i)],q):-1==o?new c._ConcreteReference(g,[new b.Range(k,n,h,1)],q):-1==p?new c._ConcreteReference(g,[new b.Range(m,l,1,i)],q):new c._ConcreteReference(g,[new b.Range(m,n,1,1)],q)}if(a[0]instanceof c.CalcArray){var r=a[0];h=r.getRowCount(),i=r.getColumnCount();var o=c._Helper._argumentExists(a,1)?c.Convert.toInt(a[1]):0,p=c._Helper._argumentExists(a,2)?c.Convert.toInt(a[2]):0,q=c._Helper._argumentExists(a,3)?c.Convert.toInt(a[3])-1:1;return 1!=q?R:(h=r.getRowCount(),i=r.getColumnCount(),0>o||0>p||0>q?Q:(o>h&&1===h&&!c._Helper._argumentExists(a,2)&&(p=o,o=0),o>h||p>i?R:0==o&&0==p?new c._SliceArray(r,0,0,h,i):0==o?new c._SliceArray(r,0,p-1,h,1):0==p?new c._SliceArray(r,o-1,0,1,i):r.getValue(o-1,p-1)))}}function F(a){var b=a[0];if(!b||1!==b.getRangeCount())return Q;var d=c.Convert.toInt(a[1]),e=c.Convert.toInt(a[2]),f=c._Helper._argumentExists(a,3)?c.Convert.toInt(a[3]):b.getRowCount(0),g=c._Helper._argumentExists(a,4)?c.Convert.toInt(a[4]):b.getColumnCount(0),h=b.getSource(),i=b.getRow(0)+d,j=b.getColumn(0)+e;return 0>=f||0>=g?R:i<h.getRow(0)||h.getRow(0)+h.getRowCount(0)<i+f?R:j<h.getColumn(0)||h.getColumn(0)+h.getColumnCount(0)<j+g?R:new c._ConcreteReference(h,[{row:i,col:j,rowCount:f,colCount:g}])}b.feature("calc.functions_lookup",["calc.functions"]);{var G,H,I,J,K,L,M,N=null,O=void 0,P=c.Errors,Q=(P.Null,P.DivideByZero,P.Value),R=P.Reference,S=(P.Name,P.NotAvailable);P.Number}!function(a){a[a.row=0]="row",a[a.column=1]="column"}(M||(M={}));var T=function(b){function c(c,d,e,f,g,h){b.call(this,c,[new a.spread.Range(d,e,f,g)]);var i=this;i._row=d,i._column=e,i._rowCount=f,i._columnCount=g,i._type=h}return __extends(c,b),c.prototype.type=function(){return this._type},c.prototype.getValue=function(a,b,c){var d=this;switch(d._type){case 0:return d.getRow(0)+1+b;case 1:return d.getColumn(0)+1+c;default:return d.getActualValue(a,b,c)}},c}(c._ConcreteReference),U=function(a){function b(b){a.call(this),this._array=b}return __extends(b,a),b.prototype.getRowCount=function(){return c._ArrayHelper.getColumnCount(this._array)},b.prototype.getColumnCount=function(){return c._ArrayHelper.getRowCount(this._array)},b.prototype.getValue=function(a,b){return c._ArrayHelper.getValue(this._array,b,a)},b}(c.CalcArray);d.def("ADDRESS",D,{minArgs:2,maxArgs:5,acceptsMissingArgument:d.acceptsTwoThreeFour}),d.def("INDEX",E,{minArgs:2,maxArgs:4,acceptsReference:d.acceptsZero,acceptsArray:d.acceptsZero,acceptsMissingArgument:d.acceptsOneTwoThree,isContextSensitive:l}),d.def("OFFSET",F,{minArgs:3,maxArgs:5,acceptsMissingArgument:d.acceptsThreeFour,acceptsReference:d.acceptsZero,acceptsArray:d.acceptsZero,isVolatile:d.isVolatile,arrayArgumentEvaluateMode:2}),d.def("ROW",o,{minArgs:0,maxArgs:1,acceptsReference:d.acceptsAny,isContextSensitive:l,precedentReference:d.acceptsNone,expandColumns:d.acceptsNone}),d.def("COLUMN",p,{minArgs:0,maxArgs:1,acceptsMissingArgument:d.acceptsZero,acceptsReference:d.acceptsAny,isContextSensitive:l,precedentReference:d.acceptsNone,expandRows:d.acceptsNone}),d.def("ROWS",q,{minArgs:1,maxArgs:1,acceptsReference:d.acceptsAny,acceptsArray:d.acceptsAny,precedentReference:d.acceptsNone,expandColumns:d.acceptsNone}),d.def("COLUMNS",r,{minArgs:1,maxArgs:1,acceptsReference:d.acceptsAny,acceptsArray:d.acceptsAny,precedentReference:d.acceptsNone,expandRows:d.acceptsNone}),d.def("TRANSPOSE",s,{minArgs:1,maxArgs:1,acceptsReference:d.acceptsAny,acceptsArray:d.acceptsAny}),d.def("LOOKUP",v,{minArgs:2,maxArgs:3,acceptsArray:d.acceptsNotZero,acceptsReference:d.acceptsNotZero}),d.def("HLOOKUP",t,{minArgs:3,maxArgs:4,acceptsMissingArgument:d.acceptsThree,acceptsArray:d.acceptsOne,acceptsReference:d.acceptsOne}),d.def("VLOOKUP",u,{minArgs:3,maxArgs:4,acceptsMissingArgument:d.acceptsThree,acceptsArray:d.acceptsOne,acceptsReference:d.acceptsOne}),d.def("CHOOSE",w,{minArgs:2,maxArgs:255,acceptsError:d.acceptsMoreThanOne,isBranch:d.isBranch,findTestArgument:d.findTestArgument,findBranchArgument:m}),d.def("MATCH",y,{minArgs:2,maxArgs:3,acceptsMissingArgument:d.acceptsTwo,acceptsReference:d.acceptsOne,acceptsArray:d.acceptsOne})}(c.Functions||(c.Functions={}));c.Functions}(b.Calc||(b.Calc={}));b.Calc}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){!function(b){!function(c){function d(a){return pc(a,!0)}function e(a){for(var c,d=!1,e=0,f=b.Convert,g=b._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h])){for(var i=0;i<g.getLength(a[h]);i++){var j=g.getValueByIndex(a[h],i);if(f.isNumber(j)||typeof j===kc)c=f.toDouble(j),(!d||c>e)&&(e=c),d=!0;else if(typeof j===lc)c=0,(!d||c>e)&&(e=c),d=!0;else if(f.isError(j))return b.Convert._inArray=!1,j}b.Convert._inArray=!1}else{if(isNaN(c=f.toDouble(a[h])))return gc;(!d||c>e)&&(e=c),d=!0}}return e}function f(a){return qc(a,!0)}function g(a){for(var c,d=!1,e=0,f=b.Convert,g=b._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h])){for(var i=0;i<g.getLength(a[h]);i++){var j=g.getValueByIndex(a[h],i);if(f.isNumber(j)||typeof j===kc)c=f.toDouble(j),(!d||e>c)&&(e=c),d=!0;else if(typeof j===lc)c=0,(!d||e>c)&&(e=c),d=!0;else if(f.isError(j))return b.Convert._inArray=!1,j}b.Convert._inArray=!1}else{if(isNaN(c=f.toDouble(a[h])))return gc;(!d||e>c)&&(e=c),d=!0}}return e}function h(a){var c=b.Convert,d=b._ArrayHelper;if(c.isError(a[0]))return a[0];if(c.isError(a[1]))return a[1];var e,f=c.toInt(a[1]),g=[];if(d.isArrayOrReference(a[0])){for(var h=0;h<d.getLength(a[0]);h++){var i=d.getValueByIndex(a[0],h);if(c.isNumber(i))e=c.toDouble(i),g.push(e);else if(c.isError(i))return b.Convert._inArray=!1,i}b.Convert._inArray=!1}else{if(isNaN(e=c.toDouble(a[0])))return gc;g.push(e)}return g.sort(function(a,b){return a-b}),0>=f||g.length<f?ic:g[g.length-f]}function i(a){var c=b.Convert,d=b._ArrayHelper;if(c.isError(a[0]))return a[0];if(c.isError(a[1]))return a[1];var e;if(isNaN(e=c.toInt(a[1])))return gc;var f,g=[];if(d.isArrayOrReference(a[0])){for(var h=0;h<d.getLength(a[0]);h++){var i=d.getValueByIndex(a[0],h);if(c.isNumber(i))f=c.toDouble(i),g.push(f);else if(c.isError(i))return b.Convert._inArray=!1,i}b.Convert._inArray=!1}else{if(isNaN(f=c.toDouble(a[0])))return gc;g.push(f)}return g.sort(function(a,b){return a-b}),0>=e||g.length<e?ic:g[e-1]}function j(a){for(var c=0,d=0,e=b.Convert,f=b._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++){var i=f.getValueByIndex(a[g],h);if(e.isNumber(i)||typeof i===kc)c+=e.toDouble(i),d++;else if(typeof i===lc)c+=0,d++;else if(e.isError(i))return b.Convert._inArray=!1,i}b.Convert._inArray=!1}else{var j;if(isNaN(j=e.toDouble(a[g])))return gc;c+=j,d++}}return 0===d?fc:e.toResult(c/d)}function k(a,d,e){var f=0,g=0,h=c.Functions._MathHelper.parseCriteria(d),i=b.Convert,j=b._ArrayHelper;if(j.getRowCount(a)!==j.getRowCount(e)||j.getColumnCount(a)!==j.getColumnCount(e))return gc;for(var k=0;k<j.getLength(a);k++){var l=j.getValueByIndex(a,k);if(h&&h(l)){var m=j.getValueByIndex(e,k);if(i.isNumber(m))f+=i.toDouble(m),g++;else if(i.isError(m))return m}}return 0===g?fc:i.toResult(f/g)}function l(a){var c,d,e,f,g,h=a[0],i=a[1],j=b._Helper._argumentExists(a,2)?a[2]:a[0],l=b.Convert,m=a[1];if(l._isCalcReference(m)){for(c=m.getRowCount(0),d=m.getColumnCount(0),e=[],f=0;c>f;f++)for(e[f]=[],g=0;d>g;g++)e[f][g]=k(h,m.getValue(0,f,g),j);return new b._ConcreteArray(e)}var n=a[1];if(l._isCalcArray(n)){for(b.Convert._inArray=!0,c=n.getRowCount(),d=n.getColumnCount(),e=[],f=0;c>f;f++)for(e[f]=[],g=0;d>g;g++)e[f][g]=k(h,n.getValue(f,g),j);return b.Convert._inArray=!1,new b._ConcreteArray(e)}return k(h,i,j)}function m(a){for(var d,e=0,f=0,g=a[0],h=b.Convert,i=b._ArrayHelper,j=i.getLength(a[0]),k=0;j>k;k++){for(var l=!0,m=1;m<a.length;m+=2){var n=a[m],o=a[m+1],p=c.Functions._MathHelper.parseCriteria(o);if(d=i.getValueByIndex(n,k),l=p(d),!l)break}if(l)if(d=i.getValueByIndex(g,k),h.isNumber(d))e+=h.toDouble(d),f++;else if(h.isError(d))return d}return 0===f?fc:h.toResult(e/f)}function n(a){for(var c,d=[],e=b.Convert,f=b._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++){var i=f.getValueByIndex(a[g],h);if(e.isNumber(i))c=e.toDouble(i),d.push(c);else if(e.isError(i))return b.Convert._inArray=!1,i}b.Convert._inArray=!1}else{if(isNaN(c=e.toDouble(a[g])))return gc;d.push(c)}}return d.sort(function(a,b){return a-b}),0===d.length?ic:d.length%2===0?(e.toDouble(d[d.length/2-1])+e.toDouble(d[d.length/2]))/2:d[parseInt((d.length/2).toString(),10)]}function o(a){var c,d,e,f=Tb,g=0,h=[],i=b.Convert,j=b._ArrayHelper;for(c=0;c<a.length;c++){if(i.isError(a[c]))return a[c];if(j.isArrayOrReference(a[c])){for(d=0;d<j.getLength(a[c]);d++){var k=j.getValueByIndex(a[c],d);if(i.isNumber(k))e=i.toDouble(k),h.push(e);else if(i.isError(k))return b.Convert._inArray=!1,k}b.Convert._inArray=!1}else{if(isNaN(e=i.toDouble(a[c])))return gc;h.push(e)}}for(c=0;c<h.length;c++){var l=0;for(d=0;d<h.length;d++)d!==c&&i.toDouble(h[d])===i.toDouble(h[c])&&l++;l>g&&(g=l,f=h[c])}return 0===g?hc:f}function p(a){for(var c,d=1,e=0,f=b.Convert,g=b._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h])){for(var i=0;i<g.getLength(a[h]);i++){var j=g.getValueByIndex(a[h],i);if(f.isNumber(j)){if(c=f.toDouble(j),0>=c)return b.Convert._inArray=!1,ic;d*=c,e++}else if(f.isError(j))return b.Convert._inArray=!1,j}b.Convert._inArray=!1}else{if(isNaN(c=f.toDouble(a[h])))return gc;if(0>=c)return ic;d*=c,e++}}return 0>=e?fc:f.toResult(Ub(d,1/e))}function q(a){for(var c,d=0,e=0,f=b.Convert,g=b._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h])){for(var i=0;i<g.getLength(a[h]);i++){var j=g.getValueByIndex(a[h],i);if(f.isNumber(j)){if(c=f.toDouble(j),0>=c)return b.Convert._inArray=!1,ic;d+=1/c,e++}else if(f.isError(j))return b.Convert._inArray=!1,j}b.Convert._inArray=!1}else{if(isNaN(c=f.toDouble(a[h])))return gc;if(0>=c)return ic;d+=1/c,e++}}return 0===d?fc:f.toResult(e/d)}function r(a){var c,d=b.Convert,e=b._ArrayHelper;if(isNaN(c=d.toDouble(a[1])))return gc;var f,g,h=0,i=[];if(0>c||c>=1)return ic;if(d.isError(a[0]))return a[0];if(e.isArrayOrReference(a[0])){for(f=0;f<e.getLength(a[0]);f++){var j=e.getValueByIndex(a[0],f);if(d.isNumber(j))g=d.toDouble(j),i.push(g);else if(d.isError(j))return b.Convert._inArray=!1,j}b.Convert._inArray=!1}else{if(isNaN(g=d.toDouble(a[0])))return gc;i.push(g)}i.sort(function(a,b){return a-b});var k=parseInt((i.length*c/2).toString(),10);for(f=k;f<i.length-k;f++)h+=d.toDouble(i[f]);return h/(i.length-2*k)}function s(a){var c,d,e,f=b.Convert,g=f._toArray(a[0]),h=f._toArray(a[1]),i=0,j=h.getRowCount(),k=h.getColumnCount();for(c=0;j>c;c++)for(d=0;k>d;d++){if(e=h.getValue(c,d),f.isError(e))return e;f.isNumber(e)&&i++}var l=g.getRowCount(),m=g.getColumnCount();for(c=0;l>c;c++)for(d=0;m>d;d++)if(e=g.getValue(c,d),f.isError(e))return e;var n=[],o=[],p=i+1;for(i=0,c=0;j>c;c++)for(d=0;k>d;d++)e=h.getValue(c,d),f.isNumber(e)&&(n[i++]=f.toDouble(e));var q=n.slice(0);for(n.sort(function(a,b){return a-b}),c=0;p>c;c++)o[c]=0;for(c=0;l>c;c++)for(d=0;m>d;d++)if(e=g.getValue(c,d),f.isNumber(e)){for(var r=f.toDouble(e),s=!1,t=0;!s&&i>t;t++)r<=n[t]&&(o[q.indexOf(n[t])]++,s=!0);s||o[i]++}return new b._OneDimensionalArray(o)}function t(a){var c,d=b.Convert,e=b._ArrayHelper;if(isNaN(c=d.toDouble(a[0])))return gc;var f=a[1],g=0;if(b._Helper._argumentExists(a,2)&&isNaN(g=d.toDouble(a[2])))return gc;for(var h=0,i=0,j=0,k=0;k<e.getLength(f);k++){var l=e.getValueByIndex(a[1],k);if(d.isNumber(l)){var m=d.toDouble(l);c>m?h++:m>c?j++:i++}}return 0===i?hc:0===g?j+1:h+1}function u(a){var c,d,e,f,g,h,i=0,j=0,k=0,l=0,m=b.Convert,n=b._ArrayHelper;for(f=0;f<a.length;f++)if(n.isArrayOrReference(a[f])){for(g=0;g<n.getLength(a[f]);g++)if(h=n.getValueByIndex(a[f],g),m.isNumber(h))c=m.toDouble(h),i+=c,j+=c*c,l++;else if(m.isError(h))return b.Convert._inArray=!1,h;b.Convert._inArray=!1}else{if(isNaN(c=m.toDouble(a[f])))return gc;i+=c,j+=c*c,l++}if(3>=l)return fc;if(d=i/l,e=cc((l*j-i*i)/(l*(l-1))),0===e)return fc;for(f=0;f<a.length;f++)if(n.isArrayOrReference(a[f])){for(g=0;g<n.getLength(a[f]);g++)if(h=n.getValueByIndex(a[f],g),m.isNumber(h))c=m.toDouble(h),k+=Ub((c-d)/e,4);else if(m.isError(h))return b.Convert._inArray=!1,h;b.Convert._inArray=!1}else{if(isNaN(c=m.toDouble(a[f])))return gc;k+=Ub((c-d)/e,4)}return m.toResult(l*(l+1)*k/((l-1)*(l-2)*(l-3))-3*(l-1)*(l-1)/((l-2)*(l-3)))}function v(a){var d,e=a[0],f=b.Convert,g=b._ArrayHelper;if(isNaN(d=f.toDouble(a[1])))return gc;var h=3;if(b._Helper._argumentExists(a,2)&&isNaN(h=f.toInt(a[2])))return gc;var i,j;i=d;var k=0,l=0,m=0,n=i,o=i;if(1>h)return ic;for(var p=0;p<g.getLength(e);p++){var q=g.getValueByIndex(e,p);if(typeof q!==jc&&q!==Tb){var r;if(isNaN(r=f.toDouble(q)))return gc;i>r?(k++,(n===i||r>n)&&(n=r)):r>i?(l++,(o===i||o>r)&&(o=r)):m++}}if(k+m===0||l+m===0)return hc;if(0===l&&0===k&&0!==m)return 1;if(k=f.toDouble(k),l=f.toDouble(l),m=f.toDouble(m),1===m)j=k/(k+l);else if(0===m){var s=(i-n)/(o-n);j=(k+s-1)/(l+k-1)}else j=(k+.5*m)/(k+m+l);return c.Functions._MathHelper.round(j,h>15?15:h)}function w(a){var d=a[0],e=b.Convert,f=e.toInt(a[1]),g=0;switch(f){case 0:g=0;break;case 1:g=.25;break;case 2:g=.5;break;case 3:g=.75;break;case 4:g=1;break;default:return ic}return c._StatHelper.st_percentile([d,g])}function x(a){return nc(a,!0)}function y(a){return oc(a,!0)}function z(a){for(var c=0,d=b.Convert,e=b._ArrayHelper,f=0;f<e.getRangeCount(a[0]);f++)for(var g=0;g<e.getLength(a[0],f);g++)e.getValueByIndex(a[0],g,f)===Tb&&c++;return d.toDouble(c)}function A(a,d){for(var e=0,f=0===d,g=c.Functions._MathHelper.parseCriteria(d),h=b.Convert,i=b._ArrayHelper,j=0;j<i.getRangeCount(a);j++)for(var k=0;k<i.getLength(a,j);k++){var l=i.getValueByIndex(a,k,j);f&&l===Tb||g&&g(l)&&e++}return h.toResult(e)}function B(a){var c,d,e=a[0],f=a[1],g=b.Convert,h=b._ArrayHelper;if(h.isArrayOrReference(f)){var i=h.getRowCount(f),j=h.getColumnCount(f),k=[];for(c=0;i>c;c++)for(k[c]=[j],d=0;j>d;d++){var l=A(e,h.getValue(f,c,d));if(g.isError(l))return b.Convert._inArray=!1,l;var m;if(isNaN(m=g.toDouble(l)))return b.Convert._inArray=!1,gc;k[c][d]=m}var n=0;for(c=0;i>c;c++)for(d=0;j>d;d++)n+=k[c][d];return b.Convert._inArray=!1,n}return A(e,f)}function C(a){for(var d=0,e=b.Convert,f=b._ArrayHelper,g=f.getLength(a[0]),h=0;g>h;h++){for(var i=!0,j=0;j<a.length;j+=2){var k=a[j],l=a[j+1],m=c.Functions._MathHelper.parseCriteria(l),n=f.getValueByIndex(k,h);if(i=m&&m(n),!i)break}i&&d++}return e.toResult(d)}function D(a,c){for(var d,e=b.Convert,f=b._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g])){for(var h=0;h<f.getLength(a[g]);h++){var i=f.getValueByIndex(a[g],h);if(e.isNumber(i)||typeof i===kc)d=e.toDouble(i),c.sumx+=d,c.sumx2+=d*d,c.n++;else if(typeof i===lc)d=0,c.sumx+=d,c.sumx2+=d*d,c.n++;else if(e.isError(i))return b.Convert._inArray=!1,i}b.Convert._inArray=!1}else{if(isNaN(d=e.toDouble(a[g])))return gc;c.sumx+=d,c.sumx2+=d*d,c.n++}}}function E(a){var c,d,e,f,g,h=0,i=0,j=0,k=b.Convert,l=b._ArrayHelper;for(e=0;e<a.length;e++){if(k.isError(a[e]))return a[e];if(l.isArrayOrReference(a[e])){for(f=0;f<l.getLength(a[e]);f++)if(g=l.getValueByIndex(a[e],f),k.isNumber(g))c=k.toDouble(g),h+=c,j++;else if(k.isError(g))return b.Convert._inArray=!1,g;b.Convert._inArray=!1}else{if(isNaN(c=k.toDouble(a[e])))return gc;h+=c,j++}}for(d=h/j,e=0;e<a.length;e++){if(k.isError(a[e]))return a[e];if(l.isArrayOrReference(a[e])){for(f=0;f<l.getLength(a[e]);f++)if(g=l.getValueByIndex(a[e],f),k.isNumber(g))c=k.toDouble(g),i+=bc(c-d);else if(k.isError(g))return b.Convert._inArray=!1,g;b.Convert._inArray=!1}else{if(isNaN(c=k.toDouble(a[e])))return gc;i+=bc(c-d)}}return 0===j?fc:k.toResult(i/j)}function F(a){var c={sumx:0,sumx2:0,n:0},d=D(a,c),e=b.Convert;return e.isError(d)?d:c.n<=1?fc:e.toResult(cc(Vb(0,(c.n*c.sumx2-c.sumx*c.sumx)/(c.n*(c.n-1)))))}function G(a){return rc(a,!0)}function H(a){var c={sumx:0,sumx2:0,n:0},d=D(a,c),e=b.Convert;return e.isError(d)?d:c.n<=0?fc:e.toResult(cc(Vb(0,(c.n*c.sumx2-c.sumx*c.sumx)/(c.n*c.n))))}function I(a){return sc(a,!0)}function J(a){var c={sumx:0,sumx2:0,n:0},d=D(a,c),e=b.Convert;return e.isError(d)?d:c.n<=1?fc:e.toResult(Vb(0,(c.n*c.sumx2-c.sumx*c.sumx)/(c.n*(c.n-1))))}function K(a){return tc(a,!0)}function L(a){var c={sumx:0,sumx2:0,n:0},d=D(a,c),e=b.Convert;return e.isError(d)?d:c.n<=0?fc:e.toResult(Vb(0,(c.n*c.sumx2-c.sumx*c.sumx)/(c.n*c.n)))}function M(a){var c,d,e,f,g=0,h=0,i=0,j=b.Convert,k=b._ArrayHelper,l=k.getLength(a[0]);if(0===l)return fc;if(l!==k.getLength(a[1]))return hc;var m,n,o,p=0;if(k.isArrayOrReference(a[0])){for(m=0;l>m;m++)if(n=k.getValueByIndex(a[0],m),o=k.getValueByIndex(a[1],m),j.isNumber(n)&&j.isNumber(o))c=j.toDouble(n),d=j.toDouble(o),g+=c,h+=d,p++;else{if(j.isError(n))return b.Convert._inArray=!1,n;if(j.isError(o))return b.Convert._inArray=!1,o}b.Convert._inArray=!1}else{if(isNaN(c=j.toDouble(a[0]))||isNaN(d=j.toDouble(a[1])))return gc;g+=c,h+=d,p++}if(e=g/p,f=h/p,k.isArrayOrReference(a[0])){for(m=0;l>m;m++)if(n=k.getValueByIndex(a[0],m),o=k.getValueByIndex(a[1],m),j.isNumber(n)&&j.isNumber(o))c=j.toDouble(n),d=j.toDouble(o),i+=(c-e)*(d-f);else{if(j.isError(n))return b.Convert._inArray=!1,n;if(j.isError(o))return b.Convert._inArray=!1,o}b.Convert._inArray=!1}else{if(isNaN(c=j.toDouble(a[0]))||isNaN(d=j.toDouble(a[1])))return gc;i+=(c-e)*(d-f)}return 1>=p?fc:j.toResult(i/p)}function N(a){var c,d,e,f,g,h=0,i=0,j=0,k=b.Convert,l=b._ArrayHelper;for(e=0;e<a.length;e++){if(k.isError(a[e]))return a[e];if(l.isArrayOrReference(a[e])){for(f=0;f<l.getLength(a[e]);f++)if(g=l.getValueByIndex(a[e],f),k.isNumber(g))c=k.toDouble(l.getValueByIndex(a[e],f)),h+=c,j++;else if(k.isError(g))return b.Convert._inArray=!1,g;b.Convert._inArray=!1}else{if(isNaN(c=k.toDouble(a[e])))return gc;h+=c,j++}}for(d=h/j,e=0;e<a.length;e++)if(l.isArrayOrReference(a[e])){for(f=0;f<l.getLength(a[e]);f++)if(g=l.getValueByIndex(a[e],f),k.isNumber(g))c=k.toDouble(l.getValueByIndex(a[e],f)),i+=(c-d)*(c-d);else if(k.isError(g))return b.Convert._inArray=!1,g;b.Convert._inArray=!1}else{if(isNaN(c=k.toDouble(a[e])))return gc;i+=(c-d)*(c-d)}return k.toResult(i)}function O(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;var g;try{g=f.toBool(a[3])}catch(h){return gc}if(0>=e)return ic;if(g){var i=[];return i[0]=(c-d)/e,mc(i)}return f.toResult(ac(-((c-d)*(c-d))/(2*e*e))/(cc(2*$b)*e))}function P(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;var g,h,i;if(0>c||c>1)return ic;if(0>=e)return ic;if(g=c-.5,bc(g)<=.42)h=g*g,i=g*(((-25.44106049637*h+41.39119773534)*h-18.61500062529)*h+2.50662823884)/((((3.13082909833*h-21.06224101826)*h+23.08336743743)*h+-8.4735109309)*h+1);else{if(h=c,g>0&&(h=1-c),!(h>2.220446049250313e-16))return h>1e-300?(i=-2*dc(c),h=dc(6.283185307179586*i),h=h/i+(2-h)/(i*i)+(-14+6*h-h*h)/(2*i*i*i),i=cc(i*(1-h)),0>g&&(i=-i),i):0>g?-1.79769e308:1.79769e308;h=cc(-dc(h)),i=(((2.32121276858*h+4.85014127135)*h-2.29796479134)*h-2.78718931138)/((1.63706781897*h+3.54388924762)*h+1),0>g&&(i=-i)}var j=(i-0)/1,k=.3989422804014327*ac(-.5*j*j)/1,l=O([i,0,1,!0]);return f.isError(l)?l:(i-=(l-c)/k,d+e*i)}function Q(a){var c,d=b.Convert;return isNaN(c=d.toDouble(a[0]))?gc:0>c||c>1?ic:P([c,0,1])}function R(a){var c,d,e=b.Convert;if(isNaN(c=e.toDouble(a[0]))||isNaN(d=e.toDouble(a[1])))return gc;var f=e.toInt(a[2]);if(0>=c||c>=1)return ic;if(0>=d)return ic;if(1>f)return ic;var g=[];g[0]=c/2;var h=Q(g);return e.isError(h)?h:(h=e.toDouble(h),-h*(d/cc(f)))}function S(a){var b,c,d;b=a,c=b+5.5,c-=(b+.5)*dc(c),d=1.000000000190015+76.18009172947146/(a+1),d-=86.50532032941678/(a+2),d+=24.01409824083091/(a+3),d-=1.231739572450155/(a+4),d+=.001208650973866179/(a+5),d-=5395239384953e-18/(a+6);var e=dc(2.506628274631001*d/b);return e-c}function T(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=300,o=1e-50,p=1e-20;for(k=a+b,m=a+1,l=a-1,h=1,i=1-k*c/m,bc(i)<o&&(i=o),i=1/i,f=i,d=1;n>=d&&(e=d+d,g=(b-d)*d*c/((l+e)*(a+e)),i=1+g*i,bc(i)<o&&(i=o),h=1+g/h,bc(h)<o&&(h=o),i=1/i,f*=i*h,g=0-(a+d)*(k+d)*c/((a+e)*(m+e)),i=1+g*i,bc(i)<o&&(i=o),h=1+g/h,bc(h)<o&&(h=o),i=1/i,j=i*h,f*=j,!(bc(j-1)<p));d++);return f}function U(a){for(var c=b.Convert,d=b._Helper,e=0;e<a.length;e++)if(c.isError(a[e]))return a[e];var f,g,h;if(isNaN(f=c.toDouble(a[0]))||isNaN(g=c.toDouble(a[1]))||isNaN(h=c.toDouble(a[2])))return gc;var i=0;if(d._argumentExists(a,3)&&isNaN(i=c.toDouble(a[3])))return gc;var j=1;if(d._argumentExists(a,4)&&isNaN(j=c.toDouble(a[4])))return gc;var k,l;if(0>=g||0>=h)return ic;if(i>f||f>j||i===j)return ic;var m=(f-i)/(j-i),n=!1,o=S(g+h),p=S(g),q=S(h),r=dc(m),s=dc(1-m);return l=ac(o-p-q+g*r+h*s),k=(g+1)/(g+h+2)>m?l*T(h,g,1-m)/h:1-l*T(h,g,1-m)/h,n&&(k=-1),c.toResult(k)}function V(a){var b=[];switch(b[0]=2,a){case 1:return 2.2250738585072014e-308;case 2:return 1.7976931348623157e308;case 3:return Ub(2,-53);case 4:return Ub(2,-52);case 5:return c.Functions._MathHelper.log10(b);default:return 0}}function W(a,c,d){var e,f,g;if(1>c)return 0;g=0,e=0;var h=b.Convert;for(f=1;c>=f;f++)if(e=c-f,g+=bc(h.toDouble(a[e])),g>d)return e;return e}function X(a,c,d){var e,f,g,h,i;if(1>d||d>1e3)return 0/0;if(-1.1>a||a>1.1)return 0/0;h=2*a,g=f=0,e=0;var j=b.Convert;for(i=1;d>=i;i++)g=f,f=e,e=h*f-g+j.toDouble(c[d-i]);return.5*(e-g)}function Y(a){var b=[];b[0]=.16663894804518634,b[1]=-1384948176067564e-20,b[2]=9.81082564692473e-9,b[3]=-1.809129475572494e-11,b[4]=6.221098041892606e-14,b[5]=-3.399615005417722e-16,b[6]=2.683181998482699e-18,b[7]=-2.868042435334643e-20,b[8]=3.9628370610464347e-22,b[9]=-6.831888753985767e-24,b[10]=1.4292273559424982e-25,b[11]=-3.5475981581010704e-27,b[12]=1.025680058010471e-28,b[13]=-3.401102254316749e-30,b[14]=1.276642195630063e-31;var c,d=0,e=0,f=0;return 0===d&&(d=W(b,15,V(3)),e=1/cc(V(3)),f=ac(Wb(dc(V(2)/12),-dc(12*V(1))))),10>a?0/0:a>=f?4.930380657631324e-32:e>a?(c=10/a,X(c*c*2-1,b,d)/a):1/(12*a)}function Z(a){var b=[];b[0]=1.037869356274377,b[1]=-.13364301504908918,b[2]=.019408249135520562,b[3]=-.0030107551127535777,b[4]=.0004869461479715485,b[5]=-8105488189317536e-20,b[6]=13778847799559525e-21,b[7]=-2380221089435897e-21,b[8]=4.1640416213865184e-7,b[9]=-7.359582837807599e-8,b[10]=1.3117611876241675e-8,b[11]=-2.3546709317742423e-9,b[12]=4.2522773276035e-10,b[13]=-7.71908941348408e-11,b[14]=1.407574648135907e-11,b[15]=-2.5769072058024682e-12,b[16]=4.734240666629442e-13,b[17]=-8.724901267474264e-14,b[18]=1.612461490274055e-14,b[19]=-2.9875652015665774e-15,b[20]=5.548070120908289e-16,b[21]=-1.0324619158271569e-16,b[22]=1.9250239203049852e-17,b[23]=-3.595507346526515e-18,b[24]=6.726454253787686e-19,b[25]=-1.260262416873522e-19,b[26]=2.364488440860621e-20,b[27]=-4.4419377050807936e-21,b[28]=8.354659446403425e-22,b[29]=-1.5731559416479563e-22,b[30]=2.9653128740247425e-23,b[31]=-5.594958348181595e-24,b[32]=1.056635426883568e-24,b[33]=-1.9972483680670205e-25,b[34]=3.778297781883936e-26,b[35]=-7.153158688908174e-27,b[36]=1.3552488463674214e-27,b[37]=-2.5694673048487566e-28,b[38]=4.8747756066216946e-29,b[39]=-9.254211253084972e-30,b[40]=1.757859784176024e-30,b[41]=-3.341002667773101e-31,b[42]=6.353393618023618e-32;var c=0,d=0;return 0===c&&(c=W(b,43,.1*V(3)),d=-1+cc(V(4))),-1>=a?0/0:bc(a)<=.375?a*(1-a*X(a/.375,b,c)):dc(a+1)}function $(a){var c,d,e,f,g,h,i=1,j=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,7.7823e-12,-3.6968e-12,5.1e-13,-2.06e-14,-5.4e-15,1.4e-15];if(a>171)return 1e308;var k=b.Convert;if(a===k.toInt(a))if(a>0)for(f=1,c=2;a>c;c++)f*=c;
else f=1e308;else{if(bc(a)>1){for(h=bc(a),e=k.toInt(h),i=1,d=1;e>=d;d++)i*=h-d;h-=e}else h=a;for(g=j[24],d=23;d>=0;d--)g=g*h+j[d];f=1/(g*h),bc(a)>1&&(f*=i,0>a&&(f=-$b/(a*f*Yb($b*a))))}return f}function _(a){var c,d,e,f,g,h,i=0,j=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];c=a;var k=b.Convert;if(0>=a)return 1e308;if(1===a||2===a)return 0;for(7>=a&&(i=k.toInt(7-a),c=a+i),d=1/(c*c),e=2*$b,g=j[9],h=8;h>=0;h--)g=g*d+j[h];if(f=g/c+.5*dc(e)+(c-.5)*dc(c)-c,7>=a)for(h=1;i>=h;h++)f-=dc(c-1),c-=1;return f}function ab(a){var c,d=b.Convert;return isNaN(c=d.toDouble(a[0]))?gc:0>=c?ic:_(c)}function bb(a,c){var d,e,f;if(e=f=a,e>c&&(e=c),c>f&&(f=c),0>e)return 0/0;if(0===e)return 1.79769e308;if(e>=10)return d=Y(e)+Y(f)-Y(e+f),dc(f)*-.5+.9189385332046728+d+(e-.5)*dc(e/(e+f))+f*Z(-e/(e+f));if(f>=10){d=Y(f)-Y(e+f);var g=[];g[0]=e;var h=ab(g),i=b.Convert;return i.isError(h)?0/0:i.toDouble(h)+d+e-e*dc(e+f)+(f-.5)*Z(-e/(e+f))}var j=$(e),k=$(f),l=$(e+f);return dc(j*(k/l))}function cb(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=0,t=0,u=0,v=0;if(0===s&&(s=V(3),t=dc(s),u=V(1),v=dc(u)),o=a,h=c,k=d,a>h/(h+k)&&(o=1-o,h=d,k=c),s>(h+k)*o/(h+1))e=0,m=h*dc(Vb(o,u))-dc(h)-bb(h,k),m>v&&0!==o&&(e=ac(m)),(o!==a||h!==c)&&(e=1-e);else{i=k-Xb(k),0===i&&(i=1),m=h*dc(o)-bb(i,h)-dc(h),e=0;var w=b.Convert;if(m>=v&&(e=ac(m),l=e*h,1!==i))for(p=w.toInt(Vb(t/dc(o),4)),q=1;p>=q;q++)n=q,l=l*(n-i)*o/n,e+=l/(h+n);if(k>1){for(m=h*dc(o)+k*dc(1-o)-bb(h,k)-dc(k),r=w.toInt(Vb(m/v,0)),l=ac(m-r*v),f=1/(1-o),j=k*f/(h+k-1),g=0,p=w.toInt(k),k===p&&(p-=1),q=1;p>=q&&!(1>=j&&g>=l/s);q++)n=q,l=(k-n+1)*f*l/(h+k-n),l>1&&(r-=1,l*=u),0===r&&(g+=l);e+=g}(o!==a||h!==c)&&(e=1-e),e=Vb(Wb(e,1),0)}return e}function db(a){for(var c=b.Convert,d=b._Helper,e=0;e<a.length;e++)if(c.isError(a[e]))return a[e];var f,g,h;if(isNaN(f=c.toDouble(a[0]))||isNaN(g=c.toDouble(a[1]))||isNaN(h=c.toDouble(a[2])))return gc;var i=0;if(d._argumentExists(a,3)&&isNaN(i=c.toDouble(a[3])))return gc;var j=1;if(d._argumentExists(a,4)&&isNaN(j=c.toDouble(a[4])))return gc;if(0>=f||f>=1)return ic;if(0>=g||0>=h)return ic;var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=2.30753,F=.27061,G=.99229,H=.04481,I=0,J=3e-308,K=1e-300,L=J,M=1-2.22e-16,N=5,O=6,P=2;if(D=f,I>g||I>h||I>f||f>1)return 0/0;if(f===I||1===f)return f;for(p=bb(g,h),.5>=f?(n=f,s=g,u=h,k=0):(n=1-f,s=h,u=g,k=1),v=cc(-dc(n*n)),A=v-(E+F*v)/(1+(G+H*v)*v),s>1&&u>1?(v=(A*A-3)/6,w=1/(s+s-1),x=1/(u+u-1),r=2/(w+x),z=A*cc(r+v)/r-(x-w)*(v+N/O-P/(3*r)),D=s/(s+u*ac(z+z))):(v=u+u,x=1/(9*u),x=v*Ub(1-x+A*cc(x),3),I>=x?D=1-ac((dc((1-n)*u)+p)/u):(x=(4*s+v-P)/x,D=1>=x?ac((dc(n*s)+p)/s):1-P/(x+1))),v=1-s,x=1-u,B=I,o=1,L>D?D=L:D>M&&(D=M),C=Vb(K,Ub(10,-13-2.5/(s*s)-.5/(n*n))),y=t=I,l=0;1e3>l;l++){for(A=cb(D,s,u),A=(A-n)*ac(p+v*dc(D)+x*dc(1-D)),I>=A*B&&(t=Vb(bc(o),J)),q=1,m=0;1e3>m;m++){if(o=q*A,bc(o)<t&&(y=D-o,y>=I&&1>=y)){if(C>=t)return 0!==k&&(D=1-D),c.toResult((j-i)*D+i);if(bc(A)<=C)return 0!==k&&(D=1-D),c.toResult((j-i)*D+i);if(y!==I&&1!==y)break}q/=3}var Q=y;if(Q===D)return 0!==k&&(D=1-D),c.toResult((j-i)*D+i);D=y,B=A}return 0!==k&&(D=1-D),c.toResult((j-i)*D+i)}function eb(a){var c,d,e=b.Convert;if(isNaN(c=e.toInt(a[0]))||isNaN(d=e.toInt(a[1])))return gc;var f;if(isNaN(f=e.toDouble(a[2])))return gc;var g;try{g=e.toBool(a[3])}catch(h){return gc}if(0>c||0>d||c>d||0>f||f>1)return ic;var i,j,k;if(g){if(d===c)return 1;i=1-f,j=Ub(i,d);var l;if(0===j){if(j=Ub(f,d),0===j)return ic;for(l=1-j,k=0;d-c>k&&j>0;k++)j*=e.toDouble(d-k)/e.toDouble((k+1)*i/f),l-=j;return 0>l?0:l}for(l=j,k=0;c>k&&j>0;k++)j*=e.toDouble(d-k)/e.toDouble((k+1)*f/i),l+=j;return l}if(i=1-f,j=Ub(i,d),0===j){if(j=Ub(f,d),0===j)return ic;for(k=0;d-c>k&&j>0;k++)j*=e.toDouble(d-k)/e.toDouble((k+1)*i/f);return j}for(k=0;c>k&&j>0;k++)j*=e.toDouble(d-k)/e.toDouble((k+1)*f/i);return j}function fb(a){var d,e,f=b.Convert;if(isNaN(d=f.toInt(a[0]))||isNaN(e=f.toInt(a[1])))return gc;var g;if(isNaN(g=f.toDouble(a[2])))return gc;if(0>g||g>=1)return ic;if(0>=d+e-1)return ic;var h=c.Functions._MathHelper.combin(d+e-1,e-1);if(f.isError(h))return h;var i=f.toDouble(h),j=Ub(g,e),k=Ub(1-g,d);return f.toResult(i*j*k)}function gb(a){var c,d=b.Convert;if(isNaN(c=d.toInt(a[0])))return gc;var e,f;if(isNaN(e=d.toDouble(a[1]))||isNaN(f=d.toDouble(a[2])))return gc;if(0>c||0>e||e>1||0>=f||f>=1)return ic;var g,h,i=1-e,j=Ub(i,c);if(0===j){if(j=Ub(e,c),0===j)return ic;for(g=1-j,h=0;c>h&&g>=f;h++)j*=d.toDouble(c-h)/d.toDouble((h+1)*i/e),g-=j;return d.toDouble(c-h)}for(g=j,h=0;c>h&&f>g;h++)j*=d.toDouble(c-h)/d.toDouble((h+1)*e/i),g+=j;return d.toDouble(h)}function hb(a){for(var c=b.Convert,d=0;d<a.length;d++)if(c.isError(a[d]))return a[d];var e,f;if(isNaN(e=c.toDouble(a[0]))||isNaN(f=c.toDouble(a[1])))return gc;if(0>e)return ic;if(1>f||f>Ub(10,10))return ic;var g,h,i,j,k,l=dc(cc($b)),m=1/cc($b),n=0,o=e;k=.5*o;var p=f%2===0;f>1&&(n=ac(-k));var q=[];q[0]=-cc(o);var r=mc(q);if(c.isError(r))return r;var s=c.toDouble(r);if(h=p?n:2*s,f>2){if(o=.5*(f-1),i=p?1:.5,k>20){for(g=p?0:l,j=dc(k);o>=i;)g=dc(i)+g,h+=ac(j*i-k-g),i+=1;return h}for(g=p?1:m/cc(k),j=0;o>=i;)g*=k/i,j+=g,i+=1;return j*n+h}return h}function ib(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;var g;try{g=f.toBool(a[3])}catch(h){return gc}if(0>c||0>=d||0>=e)return ic;if(g===!1){var i=Ub(e,d);if(isNaN(i)||!isFinite(i))return fc;var j=1/(i*$(d)),k=Ub(c,d-1),l=ac(-(c/e)),m=k*l;return j*m}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=1/3,C=1e8,D=1e37,E=1e3,F=-88;if(c/=e,0>=c)return ic;if(d>E)return n=3*cc(d)*(Ub(c/d,B)+1/(9*d)-1),A=O([n,0,1,!0]),f.isError(A)?A:f.toDouble(A);if(c>C)return 1;if(1>=c||d>c){var G=[];if(G[0]=d+1,A=ab(G),f.isError(A))return A;t=d*dc(c)-c-f.toDouble(A),u=1,z=1,w=d;do w+=1,u=u*c/w,z+=u;while(u>2.220446049250313e-16);t+=dc(z),z=0,t>=F&&(z=ac(t))}else{var H=[];if(H[0]=d,A=ab(H),f.isError(A))return A;for(t=d*dc(c)-c-f.toDouble(A),w=1-d,x=w+c+1,u=0,n=1,o=c,p=c+1,q=c*x,z=p/q;;){if(w+=1,x+=2,u+=1,y=w*u,r=x*p-y*n,s=x*q-y*o,bc(s)>0){if(v=r/s,bc(z-v)<=Wb(2.220446049250313e-16,2.220446049250313e-16*v))break;z=v}n=p,o=q,p=r,q=s,bc(r)>=D&&(n/=D,o/=D,p/=D,q/=D)}t+=dc(z),z=1,t>=F&&(z=1-ac(t))}return z}function jb(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=4.67,z=6.66,A=6.73,B=13.32,C=60,D=70,E=84,F=105,G=120,H=127,I=140,J=1175,K=210,L=252,M=2264,N=294,O=346,Q=420,R=462,S=606,T=672,U=707,V=735,W=889,X=932,Y=966,Z=1141,$=1182,_=1278,bb=1740,cb=2520,db=5040,eb=5e-7,fb=.01,gb=5e-7,hb=20,jb=2e-6,kb=.999998;if(0>c||c>1||0>=d||0>=e)return ic;if(jb>c)return 0;if(c>kb)return 1.79769e308;m=2*d,i=d-1;var lb=[];lb[0]=d;var mb=ab(lb);if(f.isError(mb))return mb;if(k=f.toDouble(mb),m<-1.24*dc(c)){if(j=Ub(c*d*ac(k+.6931471805599453*d),1/d),eb>j)return 0/0}else if(m>.32){if(mb=P([c,0,1]),f.isError(mb))return mb;w=f.toDouble(mb),l=.222222/m,j=m*Ub(w*cc(l)+1-l,3),j>2.2*m+6&&(j=-2*(dc(1-c)-i*dc(.5*j)+k))}else{j=.4,g=dc(1-c)+k+.6931471805599453*i;do o=j,l=1+j*(y+j),n=j*(A+j*(z+j)),v=-.5+(y+2*j)/l-(A+j*(B+3*j))/n,j-=(1-ac(g+.5*j)*n/l)/v;while(bc(o/j-1)>fb)}for(x=1;hb>=x;x++){if(o=j,l=.5*j,mb=ib([l,d,1,!0]),f.isError(mb))return mb;if(n=c-f.toDouble(mb),v=n*ac(.6931471805599453*d+k+l-i*dc(j)),h=v/j,g=.5*v-h*i,p=(K+g*(I+g*(F+g*(E+g*(D+C*g)))))/Q,q=(Q+g*(V+g*(Y+g*(Z+_*g))))/cb,r=(K+g*(R+g*(U+X*g)))/cb,s=(L+g*(T+$*g)+i*(N+g*(W+bb*g)))/db,t=(E+M*g+i*(J+S*g))/cb,u=(G+i*(O+H*i))/db,j+=v*(1+.5*v*p-h*i*(p-h*(q-h*(r-h*(s-h*(t-h*u)))))),bc(o/j-1)>gb)return.5*e*j}return.5*e*j}function kb(a){for(var c=b.Convert,d=0;d<a.length;d++)if(c.isError(a[d]))return a[d];var e;if(isNaN(e=c.toDouble(a[0])))return gc;var f;if(isNaN(f=c.toInt(a[1])))return gc;if(0>e||e>1)return ic;if(1>f||f>Ub(10,10))return ic;var g=1-e,h=jb([g,.5*f,2]);return c.toDouble(h)}function lb(a){var c,d=0,e=b.Convert,f=b._ArrayHelper,g=f.getRowCount(a[0]),h=f.getColumnCount(a[0]);if(g!==f.getRowCount(a[1])||h!==f.getColumnCount(a[1]))return hc;if(g>1&&h>1)c=(g-1)*(h-1);else if(g>1&&1===h)c=g-1;else{if(!(1===g&&h>1))return hc;c=h-1}for(var i=0;g>i;i++)for(var j=0;h>j;j++){var k=f.getValue(a[0],i,j);if(e.isError(k))return k;var l=f.getValue(a[1],i,j);if(e.isError(l))return l;var m,n;if(isNaN(m=e.toDouble(k))||isNaN(n=e.toDouble(l)))return gc;if(0===n)return fc;d+=(m-n)*(m-n)/n}return hb([d,c])}function mb(a){var c,d,e,f,g=0,h=0,i=0,j=0,k=0,l=b.Convert,m=b._ArrayHelper,n=m.getLength(a[0]);if(n!==m.getLength(a[1]))return hc;var o,p,q,r,s,t=0;for(o=0;n>o;o++)if(r=m.getValueByIndex(a[0],o),s=m.getValueByIndex(a[1],o),l.isNumber(r)&&l.isNumber(s))p=l.toDouble(r),q=l.toDouble(s),g+=p,h+=q,i+=p*p,j+=q*q,t++;else{if(l.isError(r))return r;if(l.isError(s))return s}if(1>=t)return fc;if(c=g/t,d=h/t,e=cc((t*i-g*g)/(t*(t-1))),f=cc((t*j-h*h)/(t*(t-1))),0===e||0===f)return fc;for(o=0;n>o;o++)r=m.getValueByIndex(a[0],o),s=m.getValueByIndex(a[1],o),l.isNumber(r)&&l.isNumber(s)&&(p=l.toDouble(r),q=l.toDouble(s),k+=(p-c)*(q-d));return l.toResult(k/l.toDouble((t-1)*e*f))}function nb(a){for(var c=b.Convert,d=0;d<a.length;d++)if(c.isError(a[d]))return a[d];var e,f;if(isNaN(e=c.toDouble(a[0]))||isNaN(f=c.toDouble(a[1])))return gc;var g;if(isNaN(g=c.toDouble(a[2])))return gc;if(0>e)return ic;if(0>=f)return ic;var h=ac(-f*e);return c.toResult(g?1-h:f*h)}function ob(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;if(0>c||1>d||d>=Ub(10,10)||1>e||e>=Ub(10,10))return ic;var g=d*c/(d*c+e),h=.5*d,i=.5*e,j=U([g,h,i]);return f.isError(j)?j:1-f.toDouble(j)}function pb(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;if(0>c||c>1||1>d||d>=Ub(10,10)||1>e||e>=Ub(10,10))return ic;var g=1-c,h=db([1-g,e/2,d/2]);return f.isError(h)?h:(1/f.toDouble(h)-1)*(e/d)}function qb(a){var c,d=b.Convert;return isNaN(c=d.toDouble(a[0]))?gc:-1>=c||c>=1?ic:dc((1+c)/(1-c))/2}function rb(a){var c,d=b.Convert;if(isNaN(c=d.toDouble(a[0])))return gc;var e=ac(2*c)-1,f=ac(2*c)+1;return!isFinite(e)&&e>0&&!isFinite(f)&&f>0?1:e/f}function sb(a,c){for(var d,e,f,g=b.Convert,h=b._ArrayHelper,i=(h.getLength(c),0);i<h.getLength(c);i++){var j=h.getValueByIndex(c,i);g.isNumber(j)&&(d=g.toDouble(h.getValueByIndex(c,i)),e=d-a.M,f=e/(a.N+1),a.M+=f,a.Q+=a.N*e*f,a.N++,a.sum+=d)}}function tb(a){var c,d,e=a[0],f=a[1],g=b.Convert,h=b._ArrayHelper;for(c=0;c<h.getLength(e);c++)if(d=h.getValueByIndex(e,c),g.isError(d))return d;for(c=0;c<h.getLength(f);c++)if(d=h.getValueByIndex(f,c),g.isError(d))return d;var i,j,k,l,m,n={N:0,M:0,Q:0,afun_flag:!1,sum:0};if(sb(n,e),l=n.N-1,1===n.N)return fc;if(i=n.Q/(n.N-1),0===i)return fc;if(n.N=0,n.M=0,n.Q=0,n.afun_flag=!1,n.sum=0,sb(n,f),m=n.N-1,1===n.N)return fc;if(j=n.Q/(n.N-1),0===j)return fc;var o=ob([i/j,l,m]);return g.isError(o)?o:(k=2*(1-g.toDouble(o)),k>1&&(k=2-k),k)}function ub(a){var d=b.Convert,e=d.toInt(a[0]),f=d.toInt(a[1]),g=d.toInt(a[2]),h=d.toInt(a[3]);if(0>e||e>Wb(f,g))return ic;if(e<Vb(0,f-h+g))return ic;if(0>f||f>h)return ic;if(0>g||g>h)return ic;if(0>h)return ic;var i=c.Functions._MathHelper.combin(g,e);if(d.isError(i))return i;var j=d.toDouble(i);if(i=c.Functions._MathHelper.combin(h-g,f-e),d.isError(i))return i;var k=d.toDouble(i);if(i=c.Functions._MathHelper.combin(h,f),d.isError(i))return i;var l=d.toDouble(i);return d.toResult(j*k/l)}function vb(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;if(0>=c||0>=e)return ic;var g=[];return g[0]=(dc(c)-d)/e,mc(g)}function wb(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;if(0>=e||0>c||c>1)return ic;var g=[];g[0]=c;var h=Q(g);if(f.isError(h))return h;var i=f.toDouble(h);return f.toResult(ac(d+e*i))}function xb(a){var c=0,d=0,e=0,f=0,g=0,h=b.Convert,i=b._ArrayHelper,j=i.getLength(a[0]);if(j!==i.getLength(a[1]))return hc;for(var k=0,l=0;j>l;l++){var m=i.getValueByIndex(a[0],l),n=i.getValueByIndex(a[1],l);if(h.isNumber(m)&&h.isNumber(n)){var o=h.toDouble(m),p=h.toDouble(n);c+=o,d+=p,e+=o*o,f+=p*p,g+=o*p,k++}}return k*e-c*c===0||k*f-d*d===0?fc:(k*g-c*d)/cc((k*e-c*c)*(k*f-d*d))}function yb(a){var c=a[0],d=a[1],e=0,f=0,g=0,h=0,i=0,j=0,k=b.Convert,l=b._ArrayHelper,m=l.getLength(d);if(m!==l.getLength(c))return hc;for(var n=0;m>n;n++){var o=l.getValueByIndex(d,n),p=l.getValueByIndex(c,n);if(k.isNumber(o)&&k.isNumber(p)){var q=k.toDouble(o),r=k.toDouble(p);e+=q,f+=r,g+=q*q,h+=r*r,i+=q*r,j++}}var s=cc((j*g-e*e)*(j*h-f*f));if(0===s)return fc;var t=(j*i-e*f)/s;return k.toResult(t*t)}function zb(a){for(var b=1,c=a;c>1;c--)b*=c;return b}function Ab(a){var c,d=b.Convert;if(isNaN(c=d.toInt(a[0])))return gc;var e;if(isNaN(e=d.toDouble(a[1])))return gc;var f;try{f=d.toBool(a[2])}catch(g){return gc}var h=0;if(0>=c||0>=e)return ic;if(f)for(var i=0;c>=i;i++)h+=ac(-e)*Ub(e,i)/zb(i);else h=ac(-e)*Ub(e,c)/zb(c);return d.toResult(h)}function Bb(a){var c,d=b.Convert,e=b._ArrayHelper;if(isNaN(c=d.toDouble(a[2])))return gc;var f=c;if(b._Helper._argumentExists(a,3)&&isNaN(f=d.toDouble(a[3])))return gc;var g=0,h=0,i=e.getLength(a[0]);if(i!==e.getLength(a[1]))return hc;for(var j=0;i>j;j++)if(e.getValueByIndex(a[0],j)!==Tb&&e.getValueByIndex(a[1],j)!==Tb){var k,l;if(isNaN(k=d.toDouble(e.getValueByIndex(a[0],j)))||isNaN(l=d.toDouble(e.getValueByIndex(a[1],j))))return gc;if(0>=l||l>1)return ic;k>=c&&f>=k&&(g+=l),h+=l}return 1!==h?ic:g}function Cb(c){if(typeof c[0]===jc||c[0]===Tb)throw a.SR.Exp_InvalidArgument;var d,e,f,g,h,i,j=0,k=0,l=0,m=0,n=b.Convert,o=b._ArrayHelper;for(f=0;f<c.length;f++)if(o.isArrayOrReference(c[f])){for(g=0;g<o.getLength(c[f]);g++)if(i=o.getValueByIndex(c[f],g),n.isNumber(i))h=n.toDouble(i),j+=h,k+=h*h,m++;else if(n.isError(i))return b.Convert._inArray=!1,i;b.Convert._inArray=!1}else{if(n.isError(c[f]))return c[f];var p;if(isNaN(p=n.toDouble(c[f])))return gc;j+=p,k+=p*p,m++}if(2>=m)return fc;if(d=j/m,e=cc((m*k-j*j)/(m*(m-1))),0===e)return fc;for(f=0;f<c.length;f++)if(o.isArrayOrReference(c[f])){for(g=0;g<o.getLength(c[f]);g++)if(i=o.getValueByIndex(c[f],g),n.isNumber(i))h=n.toDouble(i),l+=Ub((h-d)/e,3);else if(n.isError(i))return b.Convert._inArray=!1,i;b.Convert._inArray=!1}else{if(isNaN(h=n.toDouble(c[f])))return gc;l+=Ub((h-d)/e,3)}return n.toResult(m*l/((m-1)*(m-2)))}function Db(a){var c,d,e,f=b.Convert;return isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2]))?gc:0>=e?ic:(c-d)/e}function Eb(a){var c,d=b.Convert;if(isNaN(c=d.toDouble(a[0])))return gc;var e,f;if(isNaN(e=d.toInt(a[1]))||isNaN(f=d.toInt(a[2])))return gc;if(1>e||1!==f&&2!==f||0>c)return ic;var g=e,h=c/cc(g),i=g/(g+c*c),j=g-2,k=g%2,l=1,m=1;g=1;var n=2+k,o=n;if(j>=2)for(var p=d.toInt(n);j>=p&&(m=m*i*(o-1)/o,l+=m,l!==g);p+=2)g=l,o+=2;return 1!==k?f*(1-(.5+.5*h*cc(i)*l)):(1===e&&(l=0),f*(1-(.5+.3183098862*(h*i*l+_b(h)))))}function Fb(a){var c,d=b.Convert;if(isNaN(c=d.toDouble(a[0])))return gc;var e;if(isNaN(e=d.toInt(a[1])))return gc;var f=1e-12;if(0>c||c>1||1>e||e>Ub(10,10))return ic;var g,h,i,j,k,l,m,n,o,p,q=c/2,r=q;if(e>1e20){var s=[];return s[0]=q,Q(s)}if(.5>r?(p=0,l=2*r):(p=1,l=2*(1-r)),bc(e-2)<f)m=l>0?cc(2/(l*(2-l))-2):1.79769e308;else if(d.toDouble(e)<1+f)l>0?(k=1.5707963267948966*(l+1),m=-Zb(k)):m=1.79769e308;else{if(g=1/(e-.5),h=48/(g*g),i=((20700*g/h-98)*g-16)*g+96.36,j=((94.5/(h+i)-3)/h+1)*cc(1.5707963267948966*g)*e,o=Ub(j*l,2/e),o>.05+g){var t=[];t[0]=.5*l;var u=Q(t);if(d.isError(u))return u;n=d.toDouble(u),o=n*n,5>e&&(i+=.3*(e-4.5)*(n+.6)),i=(((.05*j*n-5)*n-7)*n-2)*n+h+i,o=(((((.4*o+6.3)*o+36)*o+94.5)/i-o-3)/h+1)*n,o=g*o*o,o=o>.002?ac(o)-1:.5*o*o+o}else o=((1/(((e+6)/(e*o)-.089*j-.822)*(e+2)*3)+.5/(e+4))*o-1)*(e+1)/(e+2)+1/o;m=cc(e*o)}return 0!==p&&(m=-m),d.toResult(m)}function Gb(a,c){for(var d,e,f,g=b.Convert,h=b._ArrayHelper,i=h.getLength(c),j=0;i>j;j++)d=g.toDouble(h.getValueByIndex(c,j)),e=d-a.M,f=e/(a.N+1),a.M+=f,a.Q+=a.N*e*f,a.N++,a.sum+=d}function Hb(a){var b=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=a,d=a+5.5;d-=(a+.5)*dc(d);for(var e=1.000000000190015,f=0;5>=f;f++)e+=b[f]/++c;return-d+dc(2.5066282746310007*e/a)}function Ib(a,c){var d=b.Convert,e=b._ArrayHelper,f=e.getLength(a),g=e.getLength(c);if(f!==g)return hc;for(var h=[],i=0;f>i;i++){var j,k;if(isNaN(j=d.toDouble(e.getValueByIndex(a,i)))||isNaN(k=d.toDouble(e.getValueByIndex(c,i))))return gc;h[i]=j-k}return h}function Jb(a,c,d){var e=0===d||1===d?0:ac(Hb(a+c)-Hb(a)-Hb(c)+a*dc(d)+c*dc(1-d)),f=d>=(a+1)/(a+c+2);if(f){var g=a;a=c,c=g,d=1-d}var h=4.450147717014403e-308,i=100,j=a+c,k=a+1,l=a-1,m=1,n=1-j*d/k;bc(n)<h&&(n=h),n=1/n;for(var o=n,p=b.Convert,q=1,r=2;i>=q;q++,r+=2){var s=q*(c-q)*d/((l+r)*(a+r));n=1+s*n,bc(n)<h&&(n=h),m=1+s/m,bc(m)<h&&(m=h),n=1/n,o*=n*m,s=-(a+q)*(j+q)*d/((a+r)*(k+r)),n=1+s*n,bc(n)<h&&(n=h),m=1+s/m,bc(m)<h&&(m=h),n=1/n;var t=n*m;if(o*=t,bc(p.toDouble(t-1))<5e-324){var u=e*o/a;return f?1-u:u}}return ic}function Kb(a){var c=a[0],d=a[1],e=a[2],f=a[3],g=b.Convert;if(!g.isNumber(e)||!g.isNumber(f))return gc;var h,i,j,k,l,m,n,o,p,q=g.toInt(e),r=g.toInt(f),s={N:0,M:0,Q:0,sum:0,afun_flag:!1};if(1!==q&&2!==q||1>r||r>3)return ic;if(1===r){var t,u,v,w,x,y;if(c=Ib(c,d),g.isError(c))return c;u=v=w=x=y=t=0;for(var z=c.length,A=0;z>A;A++){var B;if(isNaN(B=g.toDouble(c[A])))return gc;u=B-w,v=u/(y+1),w+=v,x+=y*u*v,y++,t+=B}if(y-1===0||0===y)return fc;if(k=cc(x/(y-1)),isNaN(k)||!isFinite(k))return ic;h=t/y,j=h/(k/cc(y)),n=y-1}else{if(s.N=0,s.M=0,s.Q=0,s.afun_flag=!1,s.sum=0,Gb(s,c),l=s.Q/(s.N-1),h=s.sum/s.N,o=s.N,s.N=0,s.M=0,s.Q=0,s.afun_flag=!1,s.sum=0,Gb(s,d),m=s.Q/(s.N-1),i=s.sum/s.N,p=s.N,2!==r){var C=l/o/(l/o+m/p);n=1/(C*C/g.toDouble(o-1)+(1-C)*(1-C)/g.toDouble(p-1))}else n=g.toDouble(o+p-2);j=(h-i)/cc(l/g.toDouble(o)+m/g.toDouble(p))}j=bc(j);var D=Jb(.5*n,.5,n/(n+j*j));return g.isError(D)?D:.5*q*g.toDouble(D)}function Lb(a){var c,d=b.Convert,e=b._ArrayHelper;if(isNaN(c=d.toDouble(a[1])))return gc;var f=0;if(b._Helper._argumentExists(a,2)&&isNaN(f=d.toDouble(a[2])))return gc;var g,h,i,j=0,k=0,l=0;if(e.isArrayOrReference(a[0])){for(var m=0;m<e.getLength(a[0]);m++){var n=e.getValueByIndex(a[0],m);if(d.isNumber(n))i=d.toDouble(n),j+=i,k+=i*i,l++;else if(d.isError(n))return b.Convert._inArray=!1,n}b.Convert._inArray=!1}else{if(isNaN(i=d.toDouble(a[0])))return gc;j+=i,k+=i*i,l++}if(0===l)return hc;if(1===l)return fc;if(g=j/l,h=b._Helper._argumentExists(a,2)?f:cc((l*k-j*j)/(l*(l-1))),0===h)return fc;var o=[];o[0]=(g-c)/(h/cc(l));var p=mc(o);return d.isError(p)?p:d.toResult(1-d.toDouble(p))}function Mb(a){var c,d,e,f=b.Convert;if(isNaN(c=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return gc;var g;try{g=f.toBool(a[3])}catch(h){return gc}return 0>c||0>=d||0>=e?ic:f.toResult(g?1-ac(-Ub(c/e,d)):d/Ub(e,d)*Ub(c,d-1)*ac(-Ub(c/e,d)))}function Nb(a){var c=b.Convert,d=c.toDouble(c.toInt(a[0])),e=c.toDouble(c.toInt(a[1])),f=1;if(0>d||0>e||e>d)return ic;for(var g=d-e+1;d>=g;g++)f*=g;return c.toResult(f)}function Ob(a){var c,d,e,f=0,g=0,h=0,i=0,j=b.Convert,k=b._ArrayHelper,l=k.getLength(a[0]);if(l!==k.getLength(a[1]))return hc;for(var m=0,n=0;l>n;n++){var o=k.getValueByIndex(a[0],n),p=k.getValueByIndex(a[1],n);if(j.isNumber(o)&&j.isNumber(p))c=j.toDouble(o),d=j.toDouble(p),f+=c,g+=d,h+=d*d,i+=d*c,m++;else{if(j.isError(o))return o;if(j.isError(p))return p}}return 0===m?fc:m*h-g*g===0?fc:(e=(m*i-g*f)/(m*h-g*g),j.toResult(f/m-e*(g/m)))}function Pb(a){var c=b.Convert,d=b._Helper,e=c._toArray(a[0]),f=new b.CalcArray;f=d._argumentExists(a,1)?c._toArray(a[1]):e;var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=d._argumentExists(a,2)?c.toBool(a[2]):!0,w=d._argumentExists(a,3)?c.toBool(a[3]):!1;for(h=0;h<e.getRowCount();h++)for(i=0;i<e.getColumnCount();i++){if(c.isError(e.getValue(h,i)))return e.getValue(h,i);if(!c.isNumber(e.getValue(h,i)))return gc}for(h=0;h<f.getRowCount();h++)for(i=0;i<f.getColumnCount();i++){if(c.isError(f.getValue(h,i)))return f.getValue(h,i);if(!c.isNumber(f.getValue(h,i)))return gc}if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()&&(v||!w)){l=c.toDouble(f.getRowCount()*f.getColumnCount());var x,y=0,z=0,A=0,B=0,C=0;for(h=0;h<f.getRowCount();h++)for(i=0;i<f.getColumnCount();i++){if(isNaN(m=c.toDouble(f.getValue(h,i)))||isNaN(n=c.toDouble(e.getValue(h,i))))return gc;y+=m,z+=m*m,A+=n,B+=n*n,C+=m*n}if(v?(k=(l*C-y*A)/(l*z-y*y),x=(A*z-y*C)/(l*z-y*y)):(k=C/z,x=0),q=[],q[0]=[],q[0][0]=k,q[0][1]=x,w){q[1]=[],q[2]=[],q[3]=[],q[4]=[];var D=l*z-y*y,E=l*B-A*A,F=l*C-y*A,G=B-x*A-k*C,H=F*F/(D*E);3>l?(q[1][0]=ic,q[1][1]=ic,q[2][1]=ic,q[3][0]=ic):(q[1][0]=cc(G*l/(D*(l-2))),q[1][1]=cc(G*z/(D*(l-2))),q[2][1]=cc((E-F*F/D)/(l*(l-2))),q[3][0]=1===H?ic:H*(l-2)/(1-H)),q[2][0]=H,q[3][1]=l-2,q[4][0]=E/l-G,q[4][1]=G}return q}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){if(n=[],m=[],1===e.getColumnCount()){for(l=f.getRowCount(),k=f.getColumnCount(),h=0;l>h;h++){if(isNaN(g=c.toDouble(e.getValue(h,0))))return gc;n[h]=g}for(h=0;l>h;h++)for(m[h]=[],i=0;k>i;i++){if(isNaN(g=c.toDouble(f.getValue(h,i))))return gc;m[h][i]=g}}else{for(l=f.getColumnCount(),k=f.getRowCount(),m=[],n=[],h=0;l>h;h++){if(isNaN(g=c.toDouble(e.getValue(0,h))))return gc;n[h]=g}for(h=0;l>h;h++)for(m[h]=[],i=0;k>i;i++){if(isNaN(g=c.toDouble(f.getValue(i,h))))return gc;m[h][i]=g}}var I=[];for(j=0;k+1>j;j++)I[j]=[];for(o=0;k+1>o;o++)for(p=0;k+2>p;p++)I[o][p]=0;var J=[];for(o=0;k+2>o;o++)J[o]=0;var K=w?[]:Tb;for(j=0;l>j;j++)for(J[k+1]=J[k+1]+n[j]*n[j],I[0][k+1]=I[0][k+1]+n[j],J[0]=I[0][k+1],h=0;k>h;h++)for(I[0][h+1]=I[0][h+1]+m[j][h],I[h+1][0]=I[0][h+1],I[h+1][k+1]=I[h+1][k+1]+m[j][h]*n[j],J[h+1]=I[h+1][k+1],i=h;k>i;i++)I[i+1][h+1]=I[i+1][h+1]+m[j][h]*m[j][i],I[h+1][i+1]=I[i+1][h+1];if(I[0][0]=l,w){for(o=0;k+1>o;o++)for(K[o]=[],p=0;k+1>p;p++)K[o][p]=0;for(h=0;k+1>h;h++)K[h][h]=1}if(v)for(h=0;k+1>h;h++){if(0===I[h][h]){for(r=!1,i=h+1;!r&&k+1>i;i++)if(0!==I[i][h]){for(j=0;k+2>j;j++)s=I[h][j],I[h][j]=I[i][j],I[i][j]=s;if(w)for(j=0;k+1>j;j++)s=K[h][j],K[h][j]=K[i][j],K[i][j]=s;r=!0}if(!r)return ic}for(t=1/I[h][h],j=0;k+2>j;j++)I[h][j]=I[h][j]*t;if(w)for(j=0;k+1>j;j++)K[h][j]=K[h][j]*t;for(i=0;k+1>i;i++)if(i!==h){for(t=-I[i][h],j=0;k+2>j;j++)I[i][j]=I[i][j]+t*I[h][j];if(w)for(j=0;k+1>j;j++)K[i][j]=K[i][j]+t*K[h][j]}}else for(h=1;k+1>h;h++){if(0===I[h][h]){for(r=!1,i=h+1;!r&&k+1>i;i++)if(0!==I[i][h]){for(j=0;k+2>j;j++)s=I[h][j],I[h][j]=I[i][j],I[i][j]=s;if(w)for(j=0;k+1>j;j++)s=K[h][j],K[h][j]=K[i][j],K[i][j]=s;r=!0}if(!r)return ic}for(t=1/I[h][h],j=1;k+2>j;j++)I[h][j]=I[h][j]*t;if(w)for(j=1;k+1>j;j++)K[h][j]=K[h][j]*t;for(i=1;k+1>i;i++)if(i!==h){for(t=-I[i][h],j=1;k+2>j;j++)I[i][j]=I[i][j]+t*I[h][j];if(w)for(j=1;k+1>j;j++)K[i][j]=K[i][j]+t*K[h][j]}I[0][k+1]=0}for(q=[w?5:1,k+1],q[0]=[],h=0;k+1>h;h++)q[0][h]=I[k-h][k+1];if(w){for(o=1;5>o;o++)for(q[o]=[],p=0;k+1>p;p++)q[o][p]=0;var L,M,N;for(M=J[k+1]-J[0]*J[0]/l,L=J[k+1],h=0;k+1>h;h++)L-=I[h][k+1]*J[h];if(N=M-L,q[2][0]=0===M?ic:N/M,q[4][0]=N,q[4][1]=L,v){if(l-k-1===0)for(q[2][1]=ic,h=0;k+1>h;h++)q[1][h]=ic;else{for(u=L/(l-k-1),h=0;k+1>h;h++)q[1][k-h]=cc(u*K[h][h]);q[2][1]=cc(u)}q[3][0]=0===L?ic:c.toDouble(l-k-1)*N/(L*c.toDouble(k)),q[3][1]=c.toDouble(l-k-1)}else{if(l-k===0){for(h=0;k+1>h;h++)q[1][h]=ic;q[2][1]=ic}else{for(u=L/c.toDouble(l-k),q[1][k]=hc,h=1;k+1>h;h++)q[1][k-h]=cc(u*K[h][h]);q[2][1]=cc(u)}q[3][0]=0===L?ic:c.toDouble(l-k)*N/(L*c.toDouble(k)),q[3][1]=c.toDouble(l-k)}for(h=2;5>h;h++)for(i=2;k+1>i;i++)q[h][i]=hc}return q}return ic}function Qb(a){var c=a[0],d=a[1],e=0,f=0,g=0,h=0,i=0,j=b.Convert,k=b._ArrayHelper,l=k.getLength(a[0]);if(l!==k.getLength(a[1]))return hc;for(var m=0;l>m;m++){var n=k.getValueByIndex(c,m),o=k.getValueByIndex(d,m);if(j.isNumber(n)&&j.isNumber(o)){var p=j.toDouble(n),q=j.toDouble(o);e+=p,f+=q,g+=q*q,h+=q*p,i++}}return i*g-f*f===0?fc:j.toResult((i*h-f*e)/(i*g-f*f))}function Rb(a){var c,d,e=b.Convert,f=b._Helper,g=e._toArray(a[0]),h=f._argumentExists(a,1)?e._toArray(a[1]):g,i=f._argumentExists(a,2)?e.toBool(a[2]):!0,j=f._argumentExists(a,3)?e.toBool(a[3]):!1;for(c=0;c<g.getRowCount();c++)for(d=0;d<g.getColumnCount();d++){if(e.isError(g.getValue(c,d)))return g.getValue(c,d);if(!e.isNumber(g.getValue(c,d)))return gc}for(c=0;c<h.getRowCount();c++)for(d=0;d<h.getColumnCount();d++){if(e.isError(h.getValue(c,d)))return h.getValue(c,d);if(!e.isNumber(h.getValue(c,d)))return gc}var k,l,m,n,o,p,q,r,s,t,u,v,w;if(g.getRowCount()===h.getRowCount()&&g.getColumnCount()===h.getColumnCount()&&(i||!j)){n=h.getRowCount()*h.getColumnCount();var x,y=0,z=0,A=0,B=0,C=0;for(c=0;c<h.getRowCount();c++)for(d=0;d<h.getColumnCount();d++){if(isNaN(o=e.toDouble(h.getValue(c,d)))||isNaN(p=e.toDouble(g.getValue(c,d))))return gc;p=dc(p),y+=o,z+=o*o,A+=p,B+=p*p,C+=o*p}if(i?(m=(n*C-y*A)/(n*z-y*y),x=(A*z-y*C)/(n*z-y*y)):(m=C/z,x=0),s=[],s[0]=[],s[0][0]=ac(m),s[0][1]=ac(x),j){s[1]=[],s[2]=[],s[3]=[],s[4]=[];var D=n*z-y*y,E=n*B-A*A,F=n*C-y*A,G=B-x*A-m*C,H=F*F/(D*E);3>n?(s[1][0]=ic,s[1][1]=ic,s[2][1]=ic,s[3][0]=ic):(s[1][0]=cc(G*n/(D*(n-2))),s[1][1]=cc(G*z/(D*(n-2))),s[2][1]=cc((E-F*F/D)/(n*(n-2))),s[3][0]=1===H?ic:H*(n-2)/(1-H)),s[2][0]=H,s[3][1]=n-2,s[4][0]=E/n-G,s[4][1]=G}return s}if(1===g.getColumnCount()&&g.getRowCount()===h.getRowCount()||1===g.getRowCount()&&g.getColumnCount()===h.getColumnCount()){if(p=[],o=[],1===g.getColumnCount()){for(n=h.getRowCount(),m=h.getColumnCount(),c=0;n>c;c++){if(isNaN(k=e.toDouble(g.getValue(c,0))))return gc;p[c]=dc(k)}for(c=0;n>c;c++)for(o[c]=[],d=0;m>d;d++){if(isNaN(k=e.toDouble(h.getValue(c,d))))return gc;o[c][d]=k}}else{for(n=h.getColumnCount(),m=h.getRowCount(),o=[],p=[],c=0;n>c;c++){if(isNaN(k=e.toDouble(g.getValue(0,c))))return gc;p[c]=dc(k)}for(c=0;n>c;c++)for(o[c]=[],d=0;m>d;d++){if(isNaN(k=e.toDouble(h.getValue(d,c))))return gc;o[c][d]=k}}var I=[];for(q=0;m+1>q;q++)for(I[q]=[],r=0;m+2>r;r++)I[q][r]=0;var J=[];for(q=0;m+2>q;q++)J[q]=0;var K=j?[]:Tb;for(l=0;n>l;l++)for(J[m+1]=J[m+1]+p[l]*p[l],I[0][m+1]=I[0][m+1]+p[l],J[0]=I[0][m+1],c=0;m>c;c++)for(I[0][c+1]=I[0][c+1]+o[l][c],I[c+1][0]=I[0][c+1],I[c+1][m+1]=I[c+1][m+1]+o[l][c]*p[l],J[c+1]=I[c+1][m+1],d=c;m>d;d++)I[d+1][c+1]=I[d+1][c+1]+o[l][c]*o[l][d],I[c+1][d+1]=I[d+1][c+1];if(I[0][0]=n,j){for(q=0;m+1>q;q++)for(K[q]=[],r=0;m+1>r;r++)K[q][r]=0;for(c=0;m+1>c;c++)K[c][c]=1}if(i)for(c=0;m+1>c;c++){if(0===I[c][c]){for(v=!1,d=c+1;!v&&m+1>d;d++)if(0!==I[d][c]){for(l=0;m+2>l;l++)u=I[c][l],I[c][l]=I[d][l],I[d][l]=u;if(j)for(l=0;m+1>l;l++)u=K[c][l],K[c][l]=K[d][l],K[d][l]=u;v=!0}if(!v)return ic}for(t=1/I[c][c],l=0;m+2>l;l++)I[c][l]=I[c][l]*t;if(j)for(l=0;m+1>l;l++)K[c][l]=K[c][l]*t;for(d=0;m+1>d;d++)if(d!==c){for(t=-I[d][c],l=0;m+2>l;l++)I[d][l]=I[d][l]+t*I[c][l];if(j)for(l=0;m+1>l;l++)K[d][l]=K[d][l]+t*K[c][l]}}else for(c=1;m+1>c;c++){if(0===I[c][c]){for(v=!1,d=c+1;!v&&m+1>d;d++)if(0!==I[d][c]){for(l=0;m+2>l;l++)u=I[c][l],I[c][l]=I[d][l],I[d][l]=u;if(j)for(l=0;m+1>l;l++)u=K[c][l],K[c][l]=K[d][l],K[d][l]=u;v=!0}if(!v)return ic}for(t=1/I[c][c],l=1;m+2>l;l++)I[c][l]=I[c][l]*t;if(j)for(l=1;m+1>l;l++)K[c][l]=K[c][l]*t;for(d=1;m+1>d;d++)if(d!==c){for(t=-I[d][c],l=1;m+2>l;l++)I[d][l]=I[d][l]+t*I[c][l];if(j)for(l=1;m+1>l;l++)K[d][l]=K[d][l]+t*K[c][l]}I[0][m+1]=0}for(s=[],s[0]=[],c=0;m+1>c;c++)s[0][c]=ac(I[m-c][m+1]);if(j){s[1]=[],s[2]=[],s[3]=[],s[4]=[];var L,M,N;for(M=J[m+1]-J[0]*J[0]/n,L=J[m+1],c=0;m+1>c;c++)L-=I[c][m+1]*J[c];if(N=M-L,s[2][0]=0===M?ic:N/M,s[4][0]=N,s[4][1]=L,i){if(n-m-1===0)for(s[2][1]=ic,c=0;m+1>c;c++)s[1][c]=ic;else{for(w=L/(n-m-1),c=0;m+1>c;c++)s[1][m-c]=cc(w*K[c][c]);s[2][1]=cc(w)}s[3][0]=0===L?ic:e.toDouble(n-m-1)*N/(L*e.toDouble(m)),s[3][1]=e.toDouble(n-m-1)}else{if(n-m===0){for(c=0;m+1>c;c++)s[1][c]=ic;s[2][1]=ic}else{for(w=L/e.toDouble(n-m),s[1][m]=hc,c=1;m+1>c;c++)s[1][m-c]=cc(w*K[c][c]);s[2][1]=cc(w)}s[3][0]=0===L?ic:e.toDouble(n-m)*N/(L*e.toDouble(m)),s[3][1]=e.toDouble(n-m)}for(c=2;5>c;c++)for(d=2;m+1>d;d++)s[c][d]=hc}return s}return ic}function Sb(a){var c,d,e=0,f=0,g=0,h=0,i=0,j=0,k=b.Convert,l=b._ArrayHelper,m=l.getLength(a[0]);if(m!==l.getLength(a[1]))return hc;for(var n=0;m>n;n++){var o=l.getValueByIndex(a[0],n),p=l.getValueByIndex(a[1],n);if(k.isNumber(o)&&k.isNumber(p))d=k.toDouble(o),c=k.toDouble(p),e+=d,f+=d*d,g+=c,h+=c*c,i+=c*d,j++;else{if(k.isError(o))return o;if(k.isError(p))return p}}return j*(j-2)===0?fc:j*h-g*g===0?fc:cc((j*f-e*e-(j*i-g*e)*(j*i-g*e)/(j*h-g*g))/(j*(j-2)))}a.feature("calc.functions_stat",["calc.functions"]);var Tb=null,Ub=Math.pow,Vb=Math.max,Wb=Math.min,Xb=Math.floor,Yb=Math.sin,Zb=Math.tan,$b=Math.PI,_b=Math.atan,ac=Math.exp,bc=Math.abs,cc=Math.sqrt,dc=Math.log,ec=b.Errors,fc=(ec.Null,ec.DivideByZero),gc=ec.Value,hc=(ec.Reference,ec.Name,ec.NotAvailable),ic=ec.Number,jc="undefined",kc="boolean",lc="string",mc=(c._StatHelper.__dev1,c._StatHelper.st_normsdist),nc=c._StatHelper.__countIncludeSubtotals,oc=c._StatHelper.__countaIncludeSubtotals,pc=c._StatHelper.__maxIncludeSubtotals,qc=c._StatHelper.__minIncludeSubtotals,rc=c._StatHelper.__stdevpIncludeSubtotals,sc=c._StatHelper.__varrIncludeSubtotals,tc=c._StatHelper.__varpIncludeSubtotals;c.def("MAX",d,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("MAXA",e,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("MIN",f,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("MINA",g,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("LARGE",h,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsFirst,acceptsReference:c.acceptsFirst}),c.def("SMALL",i,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsFirst,acceptsReference:c.acceptsFirst}),c.def("AVERAGEA",j,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("AVERAGEIF",l,{minArgs:2,maxArgs:3,acceptsMissingArgument:c.acceptsThird,acceptsArray:c.acceptsFirstOrThird,acceptsReference:c.acceptsFirstOrThird}),c.def("AVERAGEIFS",m,{minArgs:3,acceptsArray:c.acceptsFirstOrOdd,acceptsReference:c.acceptsFirstOrOdd}),c.def("MEDIAN",n,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("MODE",o,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("GEOMEAN",p,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("HARMEAN",q,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("TRIMMEAN",r,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsFirst,acceptsReference:c.acceptsFirst}),c.def("FREQUENCY",s,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("RANK",t,{minArgs:2,maxArgs:3,acceptsMissingArgument:c.acceptsThird,acceptsArray:c.acceptsSecond,acceptsReference:c.acceptsSecond}),c.def("KURT",u,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("PERCENTRANK",v,{minArgs:2,maxArgs:3,acceptsMissingArgument:c.acceptsThird,acceptsArray:c.acceptsFirst,acceptsReference:c.acceptsFirst}),c.def("QUARTILE",w,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsFirst,acceptsReference:c.acceptsFirst}),c.def("COUNT",x,{minArgs:1,acceptsError:c.acceptsAny,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("COUNTA",y,{minArgs:1,acceptsError:c.acceptsAny,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("COUNTBLANK",z,{minArgs:1,maxArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("COUNTIF",B,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsFirst,acceptsReference:c.acceptsFirst}),c.def("COUNTIFS",C,{minArgs:2,acceptsArray:c.acceptsEven,acceptsReference:c.acceptsEven}),c.def("AVEDEV",E,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("STDEVA",F,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("STDEVP",G,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("STDEVPA",H,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("VAR",I,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("VARA",J,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("VARP",K,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("VARPA",L,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("COVAR",M,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("DEVSQ",N,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("CONFIDENCE",R,{minArgs:3,maxArgs:3}),c.def("INTERCEPT",Ob,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("LINEST",Pb,{minArgs:1,maxArgs:4,acceptsReference:c.acceptsFirstOrOne,acceptsArray:c.acceptsFirstOrOne,acceptsMissingArgument:c.acceptsSecondOrThirdOrFourth}),c.def("SLOPE",Qb,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny,arrayArgumentEvaluateMode:1}),c.def("LOGEST",Rb,{minArgs:1,maxArgs:4,acceptsReference:c.acceptsFirstOrOne,acceptsArray:c.acceptsFirstOrOne,acceptsMissingArgument:c.acceptsSecondOrThirdOrFourth}),c.def("STEYX",Sb,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("BETADIST",U,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsFourthOrFifth}),c.def("BETAINV",db,{minArgs:3,maxArgs:5,acceptsMissingArgument:c.acceptsFourthOrFifth}),c.def("BINOMDIST",eb,{minArgs:4,maxArgs:4}),c.def("NEGBINOMDIST",fb,{minArgs:3,maxArgs:3}),c.def("CRITBINOM",gb,{minArgs:3,maxArgs:3}),c.def("CHIDIST",hb,{minArgs:2,maxArgs:2}),c.def("CHIINV",kb,{minArgs:2,maxArgs:2}),c.def("CHITEST",lb,{minArgs:2,maxArgs:2,acceptsReference:c.acceptsAny,acceptsArray:c.acceptsAny}),c.def("CORREL",mb,{minArgs:2,maxArgs:2,acceptsReference:c.acceptsAny,acceptsArray:c.acceptsAny}),c.def("EXPONDIST",nb,{minArgs:3,maxArgs:3}),c.def("FDIST",ob,{minArgs:3,maxArgs:3}),c.def("FINV",pb,{minArgs:3,maxArgs:3}),c.def("FISHER",qb,{minArgs:1,maxArgs:1}),c.def("FISHERINV",rb,{minArgs:1,maxArgs:1}),c.def("FTEST",tb,{minArgs:2,maxArgs:2,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("GAMMADIST",ib,{minArgs:4,maxArgs:4}),c.def("GAMMAINV",jb,{minArgs:3,maxArgs:3}),c.def("GAMMALN",ab,{minArgs:1,maxArgs:1}),c.def("HYPGEOMDIST",ub,{minArgs:4,maxArgs:4}),c.def("LOGNORMDIST",vb,{minArgs:3,maxArgs:3}),c.def("LOGINV",wb,{minArgs:3,maxArgs:3}),c.def("NORMDIST",O,{minArgs:4,maxArgs:4}),c.def("NORMINV",P,{minArgs:3,maxArgs:3}),c.def("NORMSDIST",mc,{minArgs:1,maxArgs:1}),c.def("NORMSINV",Q,{minArgs:1,maxArgs:1}),c.def("PEARSON",xb,{minArgs:2,maxArgs:2,acceptsReference:c.acceptsAny,acceptsArray:c.acceptsAny}),c.def("RSQ",yb,{minArgs:2,maxArgs:2,acceptsReference:c.acceptsFirstOrOne,acceptsArray:c.acceptsFirstOrOne}),c.def("POISSON",Ab,{minArgs:3,maxArgs:3}),c.def("PROB",Bb,{minArgs:3,maxArgs:4,acceptsMissingArgument:c.acceptsFourth,acceptsReference:c.acceptsFirstOrOne,acceptsArray:c.acceptsFirstOrOne}),c.def("SKEW",Cb,{minArgs:1,acceptsArray:c.acceptsAny,acceptsReference:c.acceptsAny}),c.def("STANDARDIZE",Db,{minArgs:3,maxArgs:3}),c.def("TDIST",Eb,{minArgs:3,maxArgs:3}),c.def("TINV",Fb,{minArgs:2,maxArgs:2}),c.def("TTEST",Kb,{minArgs:4,maxArgs:4,acceptsReference:c.acceptsFirstOrOne,acceptsArray:c.acceptsFirstOrOne}),c.def("WEIBULL",Mb,{minArgs:4,maxArgs:4}),c.def("ZTEST",Lb,{minArgs:2,maxArgs:3,acceptsReference:c.acceptsFirst,acceptsArray:c.acceptsFirst,acceptsMissingArgument:c.acceptsThird}),c.def("PERMUT",Nb,{minArgs:2,maxArgs:2})
}(b.Functions||(b.Functions={}));b.Functions}(a.Calc||(a.Calc={}));a.Calc}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(b){b.feature("formulatextbox",["core.common"]);var c=null,d=void 0,e=Math.max,f=Math.min,g=".gcFormulaTextBoxInternal",h=".gcFormulaTextBox",i="TextChanged",j="CaretChanged",k="AppendStarted",l="AppendEnded",m={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},n=function(){function d(a){this._init(),a&&this._attachHost(a)}return d.prototype.destroy=function(){var a=this;a._isAppending=!1,a._appendingStart=-1,a._detachHost(),a._detachSpread(),$(a._funcsPopup).remove(),$(a._funcHelpPopup).remove()},d.prototype.bind=function(a,b,c){var d=this._host;d&&a&&(a=a.split(/\s+/).join(h+" "),$(d).bind(a+h,b,c))},d.prototype.unbind=function(a,b){var c=this._host;c&&a&&(a=a.split(/\s+/).join(h+" "),$(c).unbind(a+h,b))},d.prototype.unbindAll=function(){var a=this._host;a&&$(a).unbind(h)},d.prototype.caret=function(a){var b=this,c=b._host;if(c){var d=(document.activeElement,document.activeElement===c),e=$(c);return 0===arguments.length?d?b._getCaret(c).end:e.data("caret-before"):void(a!==b.caret()&&(d?(b._setCaret(c,a),e.data("caret-before",b._getCaret(c).end)):e.data("caret-before",a),b._trigger(j,{})))}},d.prototype._getCaret=function(a){var b=-1,c=-1,d=this._isInputElement(a),e=this._isEditableElement(a);if(d)b=a.selectionStart,c=a.selectionEnd;else if(e){var f=window.getSelection();if(f.rangeCount>0){var g=f.getRangeAt(0),h=g.cloneRange();h.selectNodeContents(a),h.setEnd(g.endContainer,g.endOffset),c=h.toString().length,h=g.cloneRange(),h.selectNodeContents(a),h.setEnd(g.startContainer,g.startOffset),b=h.toString().length,h.detach()}}return{start:b,end:c}},d.prototype._setCaret=function(a,b){var c=this._isInputElement(a),d=this._isEditableElement(a);if(c)a.setSelectionRange(b,b);else if(d){var e=this._getColorNode(a,b);if(e){var f=window.getSelection(),g=document.createRange();g.setStart(e.node.firstChild,e.offset),g.collapse(!0),f.removeAllRanges(),f.addRange(g)}}},d.prototype.text=function(a){var b=this,c=b._host;if(c){var d=b._isInputElement(c),e=b._isEditableElement(c);if(0===arguments.length){var f="";return d?f=c.value:e&&(f=c.textContent),f}(null===a||"undefined"==typeof a)&&(a=""),a!==b.text()&&(b._tokens=p.parse(a),d?c.value=a:e&&b._colorText(b._tokens),b._trigger(i,{}))}},d.prototype.autoComplete=function(a){return 0===arguments.length?this._autoComplete:void(this._autoComplete=a)},d.prototype.showHelp=function(a){return 0===arguments.length?this._showHelp:void(this._showHelp=a)},d.prototype.add=function(a){if(a)if($.isArray(a))for(var b=a.length,c=0;b>c;c++)this._add(a[c]);else this._add(a)},d.prototype._add=function(a){var b=a&&a.name&&a.name.toUpperCase();if(b){var c,d,e=this._funcs,f=e.length;for(c=0;f>c;c++){if(d=e[c].name.toUpperCase(),d===b)return;if(d>b)break}e.splice(c,0,a)}},d.prototype.remove=function(a){if(a){a=a.toUpperCase();for(var b=this._funcs,c=b.length,d=0;c>d;d++)if(b[d].name.toUpperCase()===a){b.splice(d,1);break}}},d.prototype.spread=function(a){return 0===arguments.length?this._spread:void this._attachSpread(a)},d.prototype.getRanges=function(){var a,b,c=[],d=this._tokens,e=d&&d.length,f=0,g=0;if(e>0)for(var h=0;e>h;h++)a=d[h],b=a.text,a.type===o.Range&&c.push({textOffset:f,text:b,index:g++}),f+=b.length;return c},d.prototype.getActiveRange=function(){var a=this._host,b=this.getRanges();if(a&&b&&b.length>0)for(var d,e,f=this.caret(),g=b.length,h=0;g>h;h++){if(d=b[h],e=d.textOffset,f>e&&f<=e+d.text.length)return d;if(e>=f)break}return c},d.prototype.isActiveRange=function(a){if(!a)return!1;var b=this.caret(),c=a.text,d=a.textOffset;return b>d&&b<=d+c.length?!0:!1},d.prototype.getRangeColor=function(a){var b=this.getRanges(),c=b.length;if(0>a||a>=c)return"";for(var e,f=[],g=0,h=0;c>h;h++){e=b[h];for(var i=!1,j=0;j<f.length;j++)if(f[j].text.replace(/\s+/g,"").toUpperCase()===e.text.replace(/\s+/g,"").toUpperCase()){i=!0;break}if(i){if(a===h){g=j;break}}else if(f.push(e),a===h){g=f.length-1;break}}var k=d.DEFAULT_RANGE_COLORS;return k[g%k.length]},d.prototype.canAppendRange=function(){if(this._isAppending)return!0;var a=this._getToken(this.caret());if(a){var b=a.type,c=a.text;return b===o.FormulaStart||b===o.ArgumentSeparator||b===o.Operator&&"%"!==c||b===o.ParenOpen||b===o.ArrayArgumentSeparator||b===o.Whitespace}return!1},d.prototype.isAppending=function(){return this._isAppending},d.prototype.isAppendingRange=function(a){if(!a||!this._isAppending)return!1;var b=this._appendingStart,c=this.caret(),d=a.textOffset;return d>=b&&c>d?!0:!1},d.prototype.getAppendingRanges=function(){var a,b=[],c=this.getRanges(),d=c.length;if(d>0)for(var e=0;d>e;e++)a=c[e],this.isAppendingRange(a)&&b.push(a);return b},d.prototype.appendRange=function(a,b,c){var d=this,e=d._host;if(a&&e){if(!d._isAppending){if(!d.canAppendRange())return;b=!1,d._isAppending=!0,d._appendingStart=d.caret(),d._trigger(k,{})}var f=d._appendingStart,g=d.text(),h=d.caret(),j=h;c&&(b=!1,g=g.substr(0,f)+g.substr(h),d._tokens=p.parse(g),h=f,j=h);var l=d._getToken(h);if(b){var m=g.substr(0,h);m=m.substr(0,m.length-l.text.length),m.length>=f&&(l.text=a,j=m.length+a.length)}else{var n=d._tokens,q=n.indexOf(l);h>f?(n.splice(q+1,0,{text:",",type:o.ArgumentSeparator}),n.splice(q+2,0,{text:a,type:o.Range}),a=","+a):n.splice(q+1,0,{text:a,type:o.Range}),j=h+a.length}d._updateHostValue(),d._trigger(i,{}),d.caret(j)}},d.prototype.stopAppending=function(){var a=this;a._isAppending&&(a._isAppending=!1,a._appendingStart=-1,a._trigger(l,{}))},d.prototype.repalceRange=function(a,b){var c=this,d=c._host;if(d&&!(0>a)&&b){for(var e,f=!1,g="",h=c._tokens,j=h&&h.length,k=0,l=0;j>l;l++){if(e=h[l],e.type===o.Range&&k++===a){h[l]={text:b,type:o.Range},f=!0;break}g+=e.text}f&&(c._updateHostValue(),c._trigger(i,{}),c.caret(g.length+b.length))}},d.prototype._attachSpread=function(b){if(b){var c=this;c._spread&&c._detachSpread();var d=c._host;if(b&&d){c._spread=b;var e=a.spread.Events;d.setAttribute("gcUIElement","gcAttachedFormulaTextBox"),b._attachedFormulaTextBox=c,b.bind(e.EditStarted,c,c._onSpreadEditStarted),b.bind(e.EnterCell,c,c._onSpreadEnterCell),b.bind(e.EditEnded,c,c._onSpreadEditEnded),b.bind(e.ActiveSheetChanged,c,c._onSpreadActiveSheetChanged),b.bind(e.RangeChanged,c,c._onSpreadRangeChanged),b.bind("FormulaTextBoxTextChanged",c,c._onSpreadFormulaTextBoxTextChanged),b.bind("FormulaTextBoxCaretChanged",c,c._onSpreadFormulaTextBoxCaretChanged);var f=b.getActiveSheet();f&&c.text(c._getEditText(f,f._activeRowIndex,f._activeColIndex)),c._bind(i,c,c._onFormulaTextBoxTextChanged),c._bind(j,c,c._onFormulaTextBoxCaretChanged)}}},d.prototype._detachSpread=function(){var b=this,c=b._spread;if(c){var d=a.spread.Events;c._attachedFormulaTextBox=null,c.unbind(d.EditStarted,b._onSpreadEditStarted),c.unbind(d.EnterCell,b._onSpreadEnterCell),c.unbind(d.EditEnded,b,b._onSpreadEditEnded),c.unbind(d.ActiveSheetChanged,b,b._onSpreadActiveSheetChanged),c.unbind(d.RangeChanged,b,b._onSpreadRangeChanged),c.unbind("FormulaTextBoxTextChanged",b._onSpreadFormulaTextBoxTextChanged),c.unbind("FormulaTextBoxCaretChanged",b._onSpreadFormulaTextBoxCaretChanged),b._unbind(i,b._onFormulaTextBoxTextChanged),b._unbind(j,b._onFormulaTextBoxCaretChanged),b.text("")}b._spread=null},d.prototype._startingSpreadEdit=function(){var a=this;if(!a._isWorking){a._isWorking=!0;var b=this._spread,c=b&&b.getActiveSheet();c&&!c.isEditing()?(c._startEditImp(null,c._activeRowIndex,c._activeColIndex,null,null,!1,null),a._spreadEditStarting=!0):a._spreadEditStarting=!1,a._isWorking=!1}},d.prototype._startSpreadEdit=function(){var b=this,c=b._spread,d=c&&c.getActiveSheet();if(d){if(b._spreadEditStarting){var f=d._formulaTextBox,g=f.text(),h=b.text();if(h!==g){var i=b.caret(),j=d.getFormulaInformation(d.getActiveRowIndex(),d.getActiveColumnIndex());b.text(g),j.isArrayFormula&&(i>=h.length&&(i-=1),i=e(0,i-1)),b.caret(i)}}var k=(a.spread.EditorStatus,d._editorStatus);2!==k&&(d._editorStatus=2,d._trigger("EditorStatusChanged",{sheet:d,sheetName:d._name,oldStatus:k,newStatus:2}))}},d.prototype._getEditText=function(a,b,c){var d="";if(a){var e=a.getFormulaInformation(b,c);if(e&&e.hasFormula)d="="+e.formula,e.isArrayFormula&&(d="{"+d+"}");else{d=a.getText(b,c);var f=a.parent?a.parent.canUserEditFormula():!0;"="===d[0]&&f&&(d="'"+d)}}return d},d.prototype._onSpreadActiveSheetChanged=function(a,b){var c=a.data;if(!c._isWorking){if(c._isWorking=!0,c.close(),b){var d=b.newSheet;c.text(c._getEditText(d,d._activeRowIndex,d._activeColIndex))}c._isWorking=!1}},d.prototype._onSpreadEditStarted=function(a){var b=a.data;if(!b._isWorking){var c=b._spread,d=c&&c.getActiveSheet(),e=d&&d._formulaTextBox;e&&(b._isWorking=!0,b.text(e.text()),b._isWorking=!1)}},d.prototype._onSpreadEnterCell=function(a,b){var c=a.data;c._isWorking||(c._isWorking=!0,b&&c.text(c._getEditText(b.sheet,b.row,b.col)),c._isWorking=!1)},d.prototype._onSpreadRangeChanged=function(b,c){var d=b.data;if(!d._isWorking){if(d._isWorking=!0,c){var e=c.sheet,f=c.row,g=c.column,h=c.rowCount,i=c.columnCount;new a.spread.Range(f,g,h,i).contains(e._activeRowIndex,e._activeColIndex)&&d.text(d._getEditText(e,f,g))}d._isWorking=!1}},d.prototype._onSpreadEditEnded=function(a,b){var c=a.data;c._isWorking||(c._isWorking=!0,c.close(),b&&c.text(c._getEditText(b.sheet,b.row,b.col)),c._isWorking=!1)},d.prototype._onSpreadFormulaTextBoxTextChanged=function(a,b){var c=a.data;if(!c._isWorking){if(c._isWorking=!0,b){var d=c.caret();c.text(b.text),c.caret(d)}c._isWorking=!1}},d.prototype._onSpreadFormulaTextBoxCaretChanged=function(a,b){var c=a.data;c._isWorking||(c._isWorking=!0,b&&c.caret(b.caret),c._isWorking=!1)},d.prototype._onFormulaTextBoxTextChanged=function(a){var b=a.data;if(!b._isWorking){var c=b._spread,d=c&&c.getActiveSheet();if(d){b._isWorking=!0;var e=d._formulaTextBox;if(e){var f=e.caret();e.text(b.text()),e.caret(f)}b._isWorking=!1}}},d.prototype._onFormulaTextBoxCaretChanged=function(a){var b=a.data;if(!b._isWorking){var c=b._spread,d=c&&c.getActiveSheet();if(d&&d.isEditing()){b._isWorking=!0;var e=d._formulaTextBox;e&&(e.caret(b.caret()),b._openFuncHelp()),b._isWorking=!1}}},d.prototype._init=function(){var a=this;a._isImeInputting=!1,a._isInputKey=!1,a._isAppending=!1,a._appendingStart=-1,a._funcs=[],a._autoComplete=!0,a._showHelp=!0,a._autoClose=!0;var b=document.createElement("div");b.className="gcsj-func-ac-popup",b.style.display="none",b.setAttribute("gcUIElement","gcFuncACPopup"),document.body.insertBefore(b,c),a._funcsPopup=b,a._isFuncsShown=!1;var d=document.createElement("div");d.className="gcsj-func-help-popup",d.style.display="none",d.setAttribute("gcUIElement","gcFuncHelpPopup"),document.body.insertBefore(d,c),a._funcHelpPopup=d,a._isFuncHelpShown=!1,$(b).mouseenter(function(){a._autoClose=!1}).mouseleave(function(){a._autoClose=!0}),$(d).mouseenter(function(){a._autoClose=!1}).mouseleave(function(){a._autoClose=!0})},d.prototype._attachHost=function(a){if(a){var b=this;if(b._isInputElement(a)||b._isEditableElement(a)){var c=$(a);b._host&&b._detachHost(),b._host=a,b._tokens=p.parse(b.text());var d=b._isEditableElement(a);if(d&&b._colorText(b._tokens),$.browser&&$.browser.msie){var e=parseInt($.browser.version,10)<10;d||e?(b._bind("focus",function(){c.data("text-before",b.text())}),b._bind("input keydown keyup cut paste",function(){b._checkInput()})):b._bind("input",function(){b._onInput()})}else b._bind("input",function(){b._onInput()});b._bind("keydown",function(a){var c=a.ctrlKey,d=a.shiftKey,e=a.altKey,f=a.metaKey,g=c||d||e||f,h=a.keyCode;b._isInputKey=!1,!g&&b._isFuncsShown&&(h===m.down?(b._selectFunc(1),a.preventDefault(),a.stopPropagation()):h===m.up?(b._selectFunc(-1),a.preventDefault(),a.stopPropagation()):h===m.tab&&(b._completeFunc(),a.preventDefault(),a.stopPropagation())),h===m.esc&&b.close(),b._checkCaret(a)}),b._bind("keyup",function(a){if(b._isInputKey&&$.browser&&$.browser.qtMode){var d=b.caret();c.data("caret-before")!==d&&(c.data("caret-before",d),b._trigger(j,{}),b._openFuncs(),b._isFuncsShown||b._openFuncHelp())}b._checkCaret(a)}),b._bind("focus",function(a){b._checkCaret(a)}),b._bind("blur",function(){b._autoClose&&b.close()}),b._bind("mousedown",function(){b._startingSpreadEdit()}),b._bind("mouseup",function(){b._startSpreadEdit()}),b._bind("click",function(a){b._isAppending&&b.stopAppending();var c=b._spread,d=c&&c.getActiveSheet(),e=d&&d._formulaTextBox;e&&e.isAppending()&&e.stopAppending(),b._checkCaret(a)}),b._bind("compositionstart",function(){b._isImeInputting=!0}),b._bind("compositionend",function(){b._isImeInputting=!1})}}},d.prototype._detachHost=function(){var a=this,b=a._host;if(b){var d=$(b);d.removeData("text-before"),d.removeData("caret-before"),a._unbindAll(),a.unbindAll(),a._host=c}},d.prototype._checkInput=function(){var a=this,b=$(a._host),c=a.text();b.data("text-before")!==c&&(b.data("text-before",c),a._onInput())},d.prototype._checkCaret=function(a){var b=this,c=a.keyCode,d=c===m.left||c===m.right||c===m.home||c===m.end||c===m.pdn||c===m.pup||c===m.tab||c===m.enter;b._autoComplete||(d=d||c===m.up||c===m.down);var e="undefined"!=typeof a.button;if(d||e){var f=b._host,g=$(f),h=b._getCaret(f);if(h.start!==h.end)return;var i=h.end;g.data("caret-before")!==i&&(g.data("caret-before",i),b._trigger(j,{}),b._openFuncHelp())}},d.prototype._onInput=function(){var a=this,b=a._host,c=$(b);if(a._isInputKey=!0,a._tokens=p.parse(a.text()),a._isEditableElement(b)){if(!a._isImeInputting){var d=a.caret();a._colorText(a._tokens),a._trigger(i,{type:"input"}),a.caret(d)}}else a._trigger(i,{type:"input"});var d=a.caret();c.data("caret-before")!==d&&(c.data("caret-before",d),a._trigger(j,{})),a._openFuncs(),a._isFuncsShown||a._openFuncHelp()},d.prototype._updateHostValue=function(){var a=this,b=a._host,c=a._tokens;if(a._isInputElement(b)){for(var d="",e=c&&c.length,f=0;e>f;f++)d+=c[f].text;b.value=d}else a._isEditableElement(b)&&a._colorText(c)},d.prototype._isInputElement=function(a){var b=a&&a.tagName;return"TEXTAREA"===b||"INPUT"===b},d.prototype._isEditableElement=function(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable},d.prototype._isFormula=function(a){return a&&"="===a[0]?!0:!1},d.prototype._bind=function(a,b,c){var d=this._host;d&&a&&(a=a.split(/\s+/).join(g+" "),$(d).bind(a+g,b,c))},d.prototype._unbind=function(a,b){var c=this._host;c&&a&&(a=a.split(/\s+/).join(g+" "),$(c).unbind(a+g,b))},d.prototype._unbindAll=function(){var a=this._host;a&&$(a).unbind(g)},d.prototype._trigger=function(a,b){var c=this._host;c&&$(c).trigger(a,b)},d.prototype._getToken=function(a){if(0>=a)return c;var b=this._tokens,d=b&&b.length;if(d>0)for(var e,f=0,g=0;d>g;g++)if(e=b[g],f+=e.text.length,f>=a)return e;return c},d.prototype._getFuncs=function(){var a=this._spread,b=a&&a.getActiveSheet(),c=b&&b._formulaTextBox;return c?c._funcs:this._funcs},d.prototype._getFuncsStartWith=function(a){a=a.toUpperCase();for(var b,c=[],d=this._getFuncs(),e=d&&d.length,f=!1,g=0;e>g;g++)if(b=d[g],0===b.name.toUpperCase().indexOf(a))c.push(b),f=!0;else if(f)break;return c},d.prototype._getActiveFuncInfo=function(){for(var a,b=this.caret(),d=this._tokens,e=d&&d.length,f=[],g=0,h=0;e>h;h++){if(a=d[h],f.push(a),a.type===o.ParenClose)for(;f.length>0&&f.pop().type!==o.FunctionName;);if(g+=a.text.length,g>=b)break}if(f.length>0){for(var i=0;f.length>0;)if(a=f.pop(),a.type===o.ArgumentSeparator)i++;else if(a.type===o.FunctionName)break;if(a.type===o.FunctionName)for(var j,k=a.text.toUpperCase(),l=this._getFuncs(),m=l&&l.length,h=0;m>h;h++)if(j=l[h],j.name.toUpperCase()===k)return{func:j,activeParamterIndex:i}}return c},d.prototype._openFuncs=function(){var a,b=this,c=b._getToken(b.caret()),d=c&&c.text;d&&/[a-z_$]/i.test(d[0])&&(a=b._getFuncsStartWith(d));var e=b._autoComplete&&b._isFormula(b.text())&&a&&a.length>0&&!b._isAppending&&!b._isImeInputting;if(e){b._closeFuncHelp();for(var f,g="",h=a.length,i=0;h>i;i++)f=a[i],g+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name'>"+f.name.toUpperCase()+"</div><div class='gcsj-func-ac-row-description'>"+(f.shortDescription||f.description)+"</div></div>";var j=$(b._funcsPopup);j.html(g).show(),b._isFuncsShown=!0;var k=j.find(".gcsj-func-ac-row");if(k.length>0){var l="gcsj-ac-row-active";$(k[0]).addClass(l),k.hover(function(){k.removeClass(l),$(this).addClass(l)}),k.click(function(){b._completeFunc()})}b.position()}else b._closeFuncs()},d.prototype._closeFuncs=function(){$(this._funcsPopup).hide(),this._isFuncsShown=!1},d.prototype._selectFunc=function(a){var b=$(this._funcsPopup).find(".gcsj-func-ac-row"),c=b.length;if(0!==c){var d="gcsj-ac-row-active",g=0;if(a)for(var h=0;c>h;h++)if($(b[h]).hasClass(d)){g=h+a;break}b.removeClass(d),g=e(g,0),g=f(g,c-1),$(b[g]).addClass(d)}},d.prototype._completeFunc=function(){var a=this,b=$(a._funcsPopup).find(".gcsj-ac-row-active .gcsj-func-ac-row-name").text();if(b){for(var d=a.caret(),e=a._tokens,f=e&&e.length,g=0,h=0,j=0,k=c;f>j&&(k=e[j],h=k.text.length,!(g+h>=d));)j++,g+=h;k.text=b,k.type=o.FunctionName;var l=j+1,m=e[l];m&&m.type===o.ParenOpen||e.splice(l,0,{text:"(",type:o.ParenOpen}),a._closeFuncs(),a._host.focus(),a._updateHostValue(),a._trigger(i,{}),a.caret(g+b.length+1),a._openFuncHelp()}},d.prototype._openFuncHelp=function(){var a=this;a._isFuncsShown&&a._closeFuncs();var c=a._getActiveFuncInfo(),d=a._showHelp&&a._isFormula(a.text())&&c&&!a._isAppending&&!a._isImeInputting;if(d){for(var e,g=c.func,h=g.parameters,i=h&&h.length,j=f(i-1,c.activeParamterIndex),k="",l=0;i>l;l++){e=h[l];var m=e.name;e.repeatable&&(m+=",..."),e.optional&&(m="["+m+"]");var n=l===i-1?"":", ";m=l===j?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+m+"</span>"+n:"<span class='gcsj-func-help-paramter'>"+m+"</span>"+n,k+=m}var o="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+g.name.toUpperCase()+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+k+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",p="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+b.SR.Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+g.description+"</div></div>",q="<div class='gcsj-func-help-section-content'>"+p+"</div>",r="<div class='gcsj-func-help-body'>"+q+"</div>",s=o+r;$(a._funcHelpPopup).html(s).show(),a._isFuncHelpShown=!0,a.position()}else a._closeFuncHelp()},d.prototype._closeFuncHelp=function(){$(this._funcHelpPopup).hide(),this._isFuncHelpShown=!1},d.prototype.close=function(){this._closeFuncs(),this._closeFuncHelp()},d.prototype.isReservedKey=function(a){if(this._isAppending)return!1;var b=a.ctrlKey||a.shiftKey||a.altKey||a.metaKey,c=a.keyCode;return!this._isFuncsShown||b||c!==m.down&&c!==m.up&&c!==m.tab?!1:!0},d.prototype.position=function(){var a=this,b=c;if(a._isFuncsShown?b=a._funcsPopup:a._isFuncHelpShown&&(b=a._funcHelpPopup),b){var d=$(a._host),e=$(b),f=d.offset(),g=f.top+d.outerHeight(),h={top:g,left:f.left},i=$(window).outerHeight(),j=e.outerHeight(),k=g+j;if(k>i){var l=f.top-j;l>=0&&(h.top=l)}e.css(h)}},d.prototype._colorText=function(a){for(var b,c=this,d="",e="",f=a&&a.length,g=0,h=0;f>h;h++){b=a[h];var i="";b.type===o.Range&&(i=" style='color: "+c.getRangeColor(g++)+"'"),d+="<span"+i+" class='gcsj-func-color-text'>"+b.text+"</span>",e+=b.text}if(e||c.text()){var j=c._host;if(d)j.innerHTML="<span class='gcsj-func-color-content'>"+d+"</span>";else for(;j.firstChild;)j.removeChild(j.firstChild)}},d.prototype._getColorNode=function(a,b){var d=$(a).find(".gcsj-func-color-content .gcsj-func-color-text"),f=d.length;if(f>0){b=e(0,b);for(var g,h,i=0;f>i;i++)if(g=d[i],h=g.textContent,b-=h.length,0>=b)return{node:g,offset:h.length+b};return{node:g,offset:h.length}}return c},d.DEFAULT_RANGE_COLORS=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],d}();b.FormulaTextBox=n;var o={FormulaStart:1,FunctionName:2,BraceOpen:3,BraceClose:4,ParenOpen:5,ParenClose:6,Operator:7,ArgumentSeparator:8,ArrayArgumentSeparator:9,ArrayGroupSeparator:10,Range:11,Boolean:12,Number:13,String:14,Whitespace:15,Error:16,Literal:17},p={rNumber:/^(\+|-)?((\d\d*\,?\d*)|(\d*\,?\d\d*))$/,rBoolean:/^(TRUE|FALSE)$/i,rRangeA1:/^(.*!)?((\$?[a-z]+\$?\d+(\s*:\s*\$?[a-z]+\$?\d+)?)|(\$?[a-z]+\s*:\s*\$?[a-z]+)|(\$?\d+\s*:\s*\$?\d+)|(\$?[a-z]+\$?\d+\s*:\s*\$?\d+)|(\$?\d+\s*:\s*\$?[a-z]+\$?\d+)|(\$?[a-z]+\$?\d+\s*:\s*\$?[a-z]+)|(\$?[a-z]+\s*:\s*\$?[a-z]+\$?\d+))$/i,rRangeR1C1:/^(.*!)?((R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?)?)|(R\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?)?)|(C\[?[-+]?\d*\]?\s*(:\s*C\[?[-+]?\d*\]?)?)|(R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?\s*(:\s*C\[?[-+]?\d*\]?)?)|(C\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?))?|(R\[?[-+]?\d*\]?C\[?\[-+]?d*\]?\s*(:\s*R\[?[-+]?\d*\]?))?|(R\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?))?)$/i,calcErrors:"#DIV/0! #N/A #NAME? #NULL! #NUM! #REF! #VALUE!".split(" "),parse:function(a){var b=[],c=this;if(a&&"="!==a[0])return c.addToken(b,a,o.Literal),b;for(var f,g=a&&a.length,h=0,i="",j=0;g>j;j++)switch(f=a[j]){case"'":i=c.addToken(b,i);var k=!0;do i+=f,f=a[++j],"'"===f&&"'"===a[j+1]?(i+=f,f=a[++j]):k="'"!==f;while(k&&g-1>j);f!==d&&(i+=f);break;case'"':i=c.addToken(b,i);var k=!0;do i+=f,f=a[++j],'"'===f&&'"'===a[j+1]?(i+=f,f=a[++j]):k='"'!==f;while(k&&g-1>j);f!==d&&(i+=f),i=c.addToken(b,i,o.String);break;case"\\":c.addToken(b,i),i=c.addToken(b,f,o.ArrayArgumentSeparator);break;case",":c.addToken(b,i),i=c.addToken(b,f,h>0?o.ArrayArgumentSeparator:o.ArgumentSeparator);break;case";":c.addToken(b,i),i=c.addToken(b,f,o.ArrayGroupSeparator);break;case"{":c.addToken(b,i),i=c.addToken(b,f,o.BraceOpen),h++;break;case"}":c.addToken(b,i),i=c.addToken(b,f,o.BraceClose),h--;break;case"(":c.addToken(b,i,o.FunctionName),i=c.addToken(b,f,o.ParenOpen);break;case")":c.addToken(b,i),i=c.addToken(b,f,o.ParenClose);break;case"=":c.addToken(b,i),i=0===j?c.addToken(b,f,o.FormulaStart):c.addToken(b,f,o.Operator);break;case"/":var l=i.toUpperCase(),m=g>j+1?a[j+1]:"",n=g>j+2?a[j+2]:"";"#DIV"===l&&"0"===m&&"!"===n||"#N"===l&&"A"===m.toUpperCase()?(i+=f+m,j++,"#DIV"===i&&(i+=n,j++),i=c.addToken(b,i)):(c.addToken(b,i),i=c.addToken(b,f,o.Operator));break;case"+":case"-":var p=i.replace(/\s/g,"").toUpperCase(),q=e(0,p.length-2);p.lastIndexOf("R[")>=q||p.lastIndexOf("C[")>=q?i+=f:(c.addToken(b,i),i=c.addToken(b,f,o.Operator));break;case"&":case"^":case"*":case"%":c.addToken(b,i),i=c.addToken(b,f,o.Operator);break;case"<":case">":i=c.addToken(b,i),i+=f;var m=g>j+1?a[j+1]:"";("="===m||"<"===f&&">"===m)&&(i+=m,j++),i=c.addToken(b,i,o.Operator);break;case" ":case" ":case"\r":case"\n":case"	":for(i=c.addToken(b,i),i+=f;g-1>j&&/^[\s]*$/.test(a[j+1]);)i+=a[++j];i=c.addToken(b,i,o.Whitespace);break;default:i+=f}return c.addToken(b,i),b},addToken:function(a,b,c){var d=this;if(b){"undefined"==typeof c&&(c=d.calcErrors.indexOf(b.toUpperCase())>-1?o.Error:d.rNumber.test(b)?o.Number:d.rBoolean.test(b)?o.Boolean:d.rRangeA1.test(b)||d.rRangeR1C1.test(b)?o.Range:o.Literal);var e=function(a){return a===o.Range||a===o.Literal||a===o.Number};if(e(c)){var f,g,h,i,j=a.length,k="";for(i=j-1;i>=0&&(f=a[i],g=f.type,h=f.text,k=h+k,g===o.Whitespace||":"===h);i--);var l;e(g)?(k+=b,l=":"===k[k.length-1]?k.substr(0,k.length-1):k,l=l.trim(),(d.rRangeA1.test(l)||d.rRangeR1C1.test(l))&&(a.splice(i),b=k,c=o.Range)):":"===b[b.length-1]&&(l=b.substr(0,b.length-1),(d.rRangeA1.test(l)||d.rRangeR1C1.test(l))&&(c=o.Range))}a.push({text:b,type:c})}return""}}}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));var wijmo;!function(a){!function(a){a.feature("formulatextbox_resource");var b=function(){function a(){}return a.Functions=[{name:"ABS",description:"This function calculates the absolute value of the specified value.",parameters:[{name:"value"}]},{name:"ACCRINT",description:"This function calculates the accrued interest for a security that pays periodic interest.",parameters:[{name:"issue"},{name:"first"},{name:"settle"},{name:"rate"},{name:"par"},{name:"frequency"},{name:"basis"}]},{name:"ACCRINTM",description:"This function calculates the accrued interest at maturity for a security that pays periodic interest.",parameters:[{name:"issue"},{name:"maturity"},{name:"rate"},{name:"par"},{name:"basis"}]},{name:"ACOS",description:"This function calculates the arccosine, that is, the angle whose cosine is the specified value.",parameters:[{name:"value"}]},{name:"ACOSH",description:"This function calculates the inverse hyperbolic cosine of the specified value.",parameters:[{name:"value"}]},{name:"ADDRESS",description:"This function uses the row and column numbers to create a cell address in text.",parameters:[{name:"row"},{name:"column"},{name:"absnum"},{name:"a1style"},{name:"sheettext"}]},{name:"AMORDEGRC",description:"This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",parameters:[{name:"cost"},{name:"datepurchased"},{name:"firstperiod"},{name:"salvage"},{name:"period"},{name:"drate"},{name:"basis"}]},{name:"AMORLINC",description:"This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",parameters:[{name:"cost"},{name:"datepurchased"},{name:"firstperiod"},{name:"salvage"},{name:"period"},{name:"drate"},{name:"basis"}]},{name:"AND",description:"Check whether all argumengts are True,and returns True if all argements are True.",parameters:[{name:"logical1"},{name:"logical2"}]},{name:"ASIN",description:"This function calculates the arcsine, that is, the angle whose sine is the specified value.",parameters:[{name:"value"}]},{name:"ASINH",description:"This function calculates the inverse hyperbolic sine of a number.",parameters:[{name:"value"}]},{name:"ATAN",description:"This function calculates the arctangent, that is, the angle whose tangent is the specified value.",parameters:[{name:"value"}]},{name:"ATAN2",description:"This function calculates the arctangent of the specified x- and y-coordinates.",parameters:[{name:"x"},{name:"y"}]},{name:"ATANH",description:"This function calculates the inverse hyperbolic tangent of a number.",parameters:[{name:"value"}]},{name:"AVEDEV",description:"This function calculates the average of the absolute deviations of the specified values from their mean.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"AVERAGE",description:"This function calculates the average of the specified numeric values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"AVERAGEA",description:"This function calculates the average of the specified values, including text or logical values as well as numeric values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"AVERAGEIF",description:"This function calculates the average of the specified numeric values provided that they meet the specified criteria.",parameters:[{name:"value1"},{name:"value2",repeatable:!0},{name:"condition"}]},{name:"AVERAGEIFS",description:"This function calculates the average of all cells that meet multiple specified criteria.",parameters:[{name:"value1"},{name:"condition1"},{name:"value2",repeatable:!0},{name:"condition2..."}]},{name:"BESSELI",description:"This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",parameters:[{name:"value"},{name:"order"}]},{name:"BESSELJ",description:"This function calculates the Bessel function of the first kind.",parameters:[{name:"value"},{name:"order"}]},{name:"BESSELK",description:"This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",parameters:[{name:"value"},{name:"order"}]},{name:"BESSELY",description:"This function calculates the Bessel function of the second kind.",parameters:[{name:"value"},{name:"order"}]},{name:"BETADIST",description:"This function calculates the cumulative beta distribution function.",parameters:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"lower"},{name:"upper"}]},{name:"BETAINV",description:"This function calculates the inverse of the cumulative beta distribution function.",parameters:[{name:"prob"},{name:"alpha"},{name:"beta"},{name:"lower"},{name:"upper"}]},{name:"BIN2DEC",description:"This function converts a binary number to a decimal number",parameters:[{name:"number"}]},{name:"BIN2HEX",description:"This function converts a binary number to a hexadecimal number.",parameters:[{name:"number"},{name:"places"}]},{name:"BIN2OCT",description:"This function converts a binary number to an octal number.",parameters:[{name:"number"},{name:"places"}]},{name:"BINOMDIST",description:"This function calculates the individual term binomial distribution probability.",parameters:[{name:"x"},{name:"n"},{name:"p"},{name:"cumulative"}]},{name:"CEILING",description:"This function rounds a number up to the nearest multiple of a specified value.",parameters:[{name:"value"},{name:"signif"}]},{name:"CHAR",description:"This function returns the character specified by a number.",parameters:[{name:"value"}]},{name:"CHIDIST",description:"This function calculates the one-tailed probability of the chi-squared distribution.",parameters:[{name:"value"},{name:"deg"}]},{name:"CHIINV",description:"This function calculates the inverse of the one-tailed probability of the chi-squared distribution",parameters:[{name:"prob"},{name:"deg"}]},{name:"CHITEST",description:"This function calculates the test for independence from the chi-squared distribution.",parameters:[{name:"obs_array"},{name:"exp_array"}]},{name:"CHOOSE",description:"This function returns a value from a list of values.",parameters:[{name:"index"},{name:"value1"},{name:"value2",repeatable:!0}]},{name:"CLEAN",description:"This function removes all non-printable characters from text.",parameters:[{name:"text"}]},{name:"CODE",description:"This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",parameters:[{name:"text"}]},{name:"COLUMN",description:"This function returns the column number of a reference.",parameters:[{name:"reference"}]},{name:"COLUMNS",description:"This function returns the number of columns in an array.",parameters:[{name:"array"}]},{name:"COMBIN",description:"This function calculates the number of possible combinations for a specified number of items.",parameters:[{name:"k"},{name:"n"}]},{name:"COMPLEX",description:"This function converts real and imaginary coefficients into a complex number.",parameters:[{name:"realcoeff"},{name:"imagcoeff"},{name:"suffix"}]},{name:"CONCATENATE",description:"This function combines multiple text strings or numbers into one text string.",parameters:[{name:"text1"},{name:"text2"},{name:"...."}]},{name:"CONFIDENCE",description:"This function returns confidence interval for a population mean.",parameters:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CONVERT",description:"This function converts a number from one measurement system to its equivalent in another measurement system.",parameters:[{name:"number"},{name:"from-unit"},{name:"to-unit"}]},{name:"CORREL",description:"This function returns the correlation coefficient of the two sets of data.",parameters:[{name:"array1"},{name:"array2"}]},{name:"COS",description:"This function returns the cosine of the specified angle.",parameters:[{name:"angle"}]},{name:"COSH",description:"This function returns the hyperbolic cosine of the specified value.",parameters:[{name:"value"}]},{name:"COUNT",description:"This function returns the number of cells that contain numbers.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"COUNTA",description:"This function returns the number of number of cells that contain numbers, text, or logical values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"COUNTBLANK",description:"This function returns the number of empty (or blank) cells in a range of cells on a sheet.",parameters:[{name:"cellrange"}]},{name:"COUNTIF",description:"This function returns the number of cells that meet a certain condition",parameters:[{name:"cellrange"},{name:"condition"}]},{name:"COUNTIFS",description:"This function returns the number of cells that meet multiple conditions.",parameters:[{name:"cellrange"},{name:"condition"}]},{name:"COUPDAYBS",description:"This function calculates the number of days from the beginning of the coupon period to the settlement date.",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPDAYS",description:"This function returns the number of days in the coupon period that contains the settlement date.",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPDAYSNC",description:"This function calculates the number of days from the settlement date to the next coupon date.",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPNCD",description:"This function returns a date number of the next coupon date after the settlement date.",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basi"}]},{name:"COUPNUM",description:"This function returns the number of coupons due between the settlement date and maturity date.",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPPCD",description:"This function returns a date number of the previous coupon date before the settlement date.",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COVAR",description:"This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",parameters:[{name:"array1"},{name:"array2"}]},{name:"CRITBINOM",description:"This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",parameters:[{name:"n"},{name:"p"},{name:"alpha"}]},{name:"CUMIPMT",description:"This function returns the cumulative interest paid on a loan between the starting and ending periods.",parameters:[{name:"rate"},{name:"nper"},{name:"pval"},{name:"startperiod"},{name:"endperiod"},{name:"paytype"}]},{name:"CUMPRINC",description:"This function returns the cumulative principal paid on a loan between the start and end periods.",parameters:[{name:"rate"},{name:"nper"},{name:"pval"},{name:"startperiod"},{name:"endperiod"},{name:"paytype"}]},{name:"DATE",description:"This function returns the DateTime object for a particular date, specified by the year, month, and day.",parameters:[{name:"year"},{name:"month"},{name:"day"}]},{name:"DATEDIF",description:"This function returns the number of days, months, or years between two dates.",parameters:[{name:"date1"},{name:"date2"},{name:"outputcode"}]},{name:"DATEVALUE",description:"This function returns a DateTime object of the specified date.",parameters:[{name:"date_string"}]},{name:"DAVERAGE",description:"This function calculates the average of values in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DAY",description:"This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",parameters:[{name:"date"}]},{name:"DAYS360",description:"This function returns the number of days between two dates based on a 360-day year.",parameters:[{name:"startdate"},{name:"enddate"},{name:"method"}]},{name:"DB",description:"This function calculates the depreciation of an asset for a specified period using the fixed‑declining balance method",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"month"}]},{name:"DCOUNT",description:"This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DCOUNTA",description:"This function counts the non-blank cells in a column of a list or database that match the specified conditions",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DDB",description:"This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"factor"}]},{name:"DEC2BIN",description:"This function converts a decimal number to a binary number.",parameters:[{name:"number"},{name:"places"}]},{name:"DEC2HEX",description:"This function converts a decimal number to a hexadecimal number",parameters:[{name:"number"},{name:"places"}]},{name:"DEC2OCT",description:"This function converts a decimal number to an octal number",parameters:[{name:"number"},{name:"places"}]},{name:"DEGREES",description:"This function converts the specified value from radians to degrees",parameters:[{name:"angle"}]},{name:"DELTA",description:"This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",parameters:[{name:"value1"},{name:"value2"}]},{name:"DEVSQ",description:"This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"DGET",description:"This function extracts a single value from a column of a list or database that matches the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DISC",description:"This function calculates the discount rate for a security.",parameters:[{name:"settle"},{name:"mature"},{name:"pricep"},{name:"redeem"},{name:"basis"}]},{name:"DMAX",description:"This function returns the largest number in a column of a list or database that matches the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DMIN",description:"This function returns the smallest number in a column of a list or database that matches the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DOLLAR",description:"This function converts a number to text using currency format, with the decimals rounded to the specified place.",parameters:[{name:"value"},{name:"digits"}]},{name:"DOLLARDE",description:"This function converts a fraction dollar price to a decimal dollar price.",parameters:[{name:"fractionaldollar"},{name:"fraction"}]},{name:"DOLLARFR",description:"This function converts a decimal number dollar price to a fraction dollar price.",parameters:[{name:"decimaldollar"},{name:"fraction"}]},{name:"DPRODUCT",description:"This function multiplies the values in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DSTDEV",description:"This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DSTDEVP",description:"This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DSUM",description:"This function adds the numbers in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DURATION",description:"This function returns the Macauley duration for an assumed par value of $100.",parameters:[{name:"settlement"},{name:"maturity"},{name:"coupon"},{name:"yield"},{name:"frequency"},{name:"basis"}]},{name:"DVAR",description:"This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DVARP",description:"This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"EDATE",description:"This function calculates the date that is the indicated number of months before or after a specified date.",parameters:[{name:"startdate"},{name:"months"}]},{name:"EFFECT",description:"This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",parameters:[{name:"nomrate"},{name:"comper"}]},{name:"EOMONTH",description:"This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",parameters:[{name:"startdate"},{name:"months"}]},{name:"ERF",description:"This function calculates the error function integrated between a lower and an upper limit.",parameters:[{name:"limit"},{name:"upperlimit"}]},{name:"ERFC",description:"This function calculates the complementary error function integrated between a lower limit and infinity.",parameters:[{name:"lowerlimit"}]},{name:"ERROR.TYPE",description:"This function returns a number corresponding to one of the error values.",parameters:[{name:"errorvalue"}]},{name:"EURO",description:"This function returns the equivalent of one Euro based on the ISO currency code.",parameters:[{name:"code"}]},{name:"EUROCONVERT",description:"This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",parameters:[{name:"currency"},{name:"source"},{name:"target"},{name:"fullprecision"},{name:"triangulation"}]},{name:"EVEN",description:"This function rounds the specified value up to the nearest even integer.",parameters:[{name:"value"}]},{name:"EXACT",description:"This function returns true if two strings are the same; otherwise, false.",parameters:[{name:"text1"},{name:"text2"}]},{name:"EXP",description:"This function returns e raised to the power of the specified value.",parameters:[{name:"value"}]},{name:"EXPONDIST",description:"This function returns the exponential distribution or the probability density",parameters:[{name:"value"},{name:"lambda"},{name:"cumulative"}]},{name:"FACT",description:"This function calculates the factorial of the specified number.",parameters:[{name:"number"}]},{name:"FACTDOUBLE",description:"This function calculates the double factorial of the specified number.",parameters:[{name:"number"}]},{name:"FALSE",description:"This function returns the value for logical FALSE.",parameters:[]},{name:"FDIST",description:"This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",parameters:[{name:"value"},{name:"degnum"},{name:"degden"}]},{name:"FIND",description:"This function finds one text value within another and returns the text value’s position in the text you searched.",parameters:[{name:"findtext"},{name:"intext"},{name:"start"}]},{name:"FINV",description:"This function returns the inverse of the F probability distribution.",parameters:[{name:"p"},{name:"degnum"},{name:"degden"}]},{name:"FISHER",description:"This function returns the Fisher transformation for a specified value",parameters:[{name:"value"}]},{name:"FISHERINV",description:"This function returns the inverse of the Fisher transformation for a specified value.",parameters:[{name:"value"}]},{name:"FIXED",description:"This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",parameters:[{name:"num"},{name:"digits"},{name:"notcomma"}]},{name:"FLOOR",description:"This function rounds a number down to the nearest multiple of a specified value.",parameters:[{name:"value"},{name:"signif"}]},{name:"FORECAST",description:"This function calculates a future value using existing values.",parameters:[{name:"value"},{name:"Yarray"},{name:"Xarray"}]},{name:"FREQUENCY",description:"This function calculates how often values occur within a range of values. This function returns a vertical array of numbers",parameters:[{name:"dataarray"},{name:"binarray"}]},{name:"FTEST",description:"This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",parameters:[{name:"array1"},{name:"array2"}]},{name:"FV",description:"This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",parameters:[{name:"rate"},{name:"numper"},{name:"paymt"},{name:"pval"},{name:"type"}]},{name:"FVSCHEDULE",description:"This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",parameters:[{name:"principal"},{name:"schedule"}]},{name:"GAMMADIST",description:"This function returns the gamma distribution.",parameters:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"GAMMAINV",description:"This function returns the inverse of the gamma cumulative distribution.",parameters:[{name:"p"},{name:"alpha"},{name:"beta"}]},{name:"GAMMALN",description:"This function returns the natural logarithm of the Gamma function, G(x).",parameters:[{name:"value"}]},{name:"GCD",description:"This function returns the greatest common divisor of two numbers.",parameters:[{name:"number1"},{name:"number2"}]},{name:"GEOMEAN",description:"This function returns the geometric mean of a set of positive data.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"GESTEP",description:"This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",parameters:[{name:"number"},{name:"step"}]},{name:"GROWTH",description:"This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",parameters:[{name:"y"},{name:"x"},{name:"newx"},{name:"constant"}]},{name:"HARMEAN",description:"This function returns the harmonic mean of a data set.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"HEX2BIN",description:"This function converts a hexadecimal number to a binary number.",parameters:[{name:"number"},{name:" places"}]},{name:"HEX2DEC",description:"This function converts a hexadecimal number to a decimal number.",parameters:[{name:"number"}]},{name:"HEX2OCT",description:"This function converts a hexadecimal number to an octal number.",parameters:[{name:"number"},{name:" places"}]},{name:"HLOOKUP",description:"This function searches for a value in the top row and then returns a value in the same column from a specified row.",parameters:[{name:"value"},{name:"array"},{name:"row"},{name:"approx"}]},{name:"HOUR",description:"This function returns the hour that corresponds to a specified time.",parameters:[{name:"time"}]},{name:"HYPGEOMDIST",description:"This function returns the hypergeometric distribution.",parameters:[{name:"x"},{name:"n"},{name:"M"},{name:"N"}]},{name:"IF",description:"This function performs a comparison and returns one of two provided values based on that comparison.",parameters:[{name:"valueTest"},{name:"valueTrue"},{name:"valueFalse"}]},{name:"IFERROR",description:"This function evaluates a formula and returns a value you provide if there is an error or the formula result.",parameters:[{name:"value"},{name:"error"}]},{name:"IMABS",description:"This function returns the absolute value or modulus of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMAGINARY",description:"This function returns the imaginary coefficient of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMARGUMENT",description:"This function returns the argument theta, which is an angle expressed in radians.",parameters:[{name:"complexnum"}]},{name:"IMCONJUGATE",description:"This function returns the complex conjugate of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMCOS",description:"This function returns the cosine of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMDIV",description:"This function returns the quotient of two complex numbers.",parameters:[{name:"complexnum"},{name:"complexdenom"}]},{name:"IMEXP",description:"This function returns the exponential of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMLN",description:"This function returns the natural logarithm of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMLOG2",description:"This function returns the base-2 logarithm of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMLOG10",description:"This function returns the common logarithm of a complex number.",parameters:[{name:"complexnum"}]},{name:"IMPOWER",description:"This function returns a complex number raised to a power.",parameters:[{name:"complexnum"},{name:"powernum"}]},{name:"IMPRODUCT",description:"This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format",parameters:[{name:"complexnum1"},{name:"complexnum2",repeatable:!0}]},{name:"IMREAL",description:"This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",parameters:[{name:"complexnum"}]},{name:"IMSIN",description:"This function returns the sine of a complex number in the x+yi or x+yj text format.",parameters:[{name:"complexnum"}]},{name:"IMSQRT",description:"This function returns the square root of a complex number in the x+yi or x+yj text format.",parameters:[{name:"complexnum"}]},{name:"IMSUB",description:"This function returns the difference of two complex numbers in the x+yi or x+yj text format.",parameters:[{name:"complexnum1"},{name:"complexnum2"}]},{name:"IMSUM",description:"This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",parameters:[{name:"complexnum1"},{name:"complexnum2",repeatable:!0}]},{name:"INDEX",description:"This function returns a value or the reference to a value from within an array or range.",parameters:[{name:"return"},{name:"row"},{name:"col"},{name:"area"}]},{name:"INT",description:"This function rounds a specified number down to the nearest integer.",parameters:[{name:"value"}]},{name:"INTERCEPT",description:"This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",parameters:[{name:"dependent"},{name:"independent"}]},{name:"INTRATE",description:"This function calculates the interest rate for a fully invested security.",parameters:[{name:"settle"},{name:"mature"},{name:"invest"},{name:"redeem"},{name:"basis"}]},{name:"IPMT",description:"This function calculates the payment of interest on a loan.",parameters:[{name:"rate"},{name:"per"},{name:"nper"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"IRR",description:"This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",parameters:[{name:"arrayvals"},{name:"estimate"}]},{name:"ISBLANK",description:"This function tests whether a value, an expression, or contents of a referenced cell is empty.",parameters:[{name:"cellreference"}]},{name:"ISERR",description:"This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",parameters:[{name:"cellreference"}]},{name:"ISERROR",description:"This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",parameters:[{name:"cellreference"}]},{name:"ISEVEN",description:"This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",parameters:[{name:"cellreference"}]},{name:"ISLOGICAL",description:"This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",parameters:[{name:"cellreference"}]},{name:"ISNA",description:"This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",parameters:[{name:"cellreference"}]},{name:"ISNONTEXT",description:"This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",parameters:[{name:"cellreference"}]},{name:"ISNUMBER",description:"This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",parameters:[{name:"cellreference"}]},{name:"ISODD",description:"This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",parameters:[{name:"cellreference"}]},{name:"ISPMT",description:"This function calculates the interest paid during a specific period of an investment.",parameters:[{name:"rate"},{name:"per"},{name:"nper"},{name:"pv"}]},{name:"ISREF",description:"This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",parameters:[{name:"cellreference"}]},{name:"ISTEXT",description:"This function tests whether a value, an expression, or contents of a referenced cell has text data.",parameters:[{name:"cellreference"}]},{name:"KURT",description:"This function returns the kurtosis of a data set.",parameters:[{name:"value1"},{name:"value2"},{name:"value3"},{name:"value4",repeatable:!0}]},{name:"LARGE",description:"This function returns the nth largest value in a data set, where n is specified.",parameters:[{name:"array"},{name:"n"}]},{name:"LCM",description:"This function returns the least common multiple of two numbers.",parameters:[{name:"number1"},{name:"number2"}]},{name:"LEFT",description:"This function returns the specified leftmost characters from a text value.",parameters:[{name:"mytext"},{name:"num_chars"}]},{name:"LEN",description:"This function returns the length of, the number of characters in, a text string.",parameters:[{name:"value"}]},{name:"LINEST",description:"This function calculates the statistics for a line.",parameters:[{name:"y"},{name:"x"},{name:"constant"},{name:"stats"}]},{name:"LN",description:"This function returns the natural logarithm of the specified number.",parameters:[{name:"value"}]},{name:"LOG",description:"This function returns the logarithm base Y of a number X.",parameters:[{name:"number"},{name:"base"}]},{name:"LOG10",description:"This function returns the logarithm base 10 of the number given.",parameters:[{name:"value"}]},{name:"LOGEST",description:"This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",parameters:[{name:"y"},{name:"x"},{name:"constant"},{name:"stats"}]},{name:"LOGINV",description:"This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",parameters:[{name:"prob"},{name:"mean"},{name:"stdev"}]},{name:"LOGNORMDIST",description:"This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",parameters:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"LOOKUP",description:"This function searches for a value and returns a value from the same location in a second area.",parameters:[{name:"lookupvalue"},{name:"lookupvector"},{name:"resultvector"}]},{name:"LOWER",description:"This function converts text to lower case letters.",parameters:[{name:"string"}]},{name:"MATCH",description:"This function returns the relative position of a specified item in a range.",parameters:[{name:"value1"},{name:"array"},{name:"type"}]},{name:"MAX",description:"This function returns the maximum value, the greatest value, of all the values in the arguments.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MAXA",description:"This function returns the largest value in a list of arguments, including text and logical values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MDETERM",description:"This function returns the matrix determinant of an array.",parameters:[{name:"array"}]},{name:"MDURATION",description:"This function calculates the modified Macauley duration of a security with an assumed par value of $100.",parameters:[{name:"settlement"},{name:"maturity"},{name:"coupon"},{name:"yield"},{name:"frequency"},{name:"basis"}]},{name:"MEDIAN",description:"This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MID",description:"This function returns the requested number of characters from a text string starting at the position you specify.",parameters:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"MIN",description:"This function returns the minimum value, the least value, of all the values in the arguments",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MINA",description:"This function returns the minimum value in a list of arguments, including text and logical values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MINUTE",description:"This function returns the minute corresponding to a specified time.",parameters:[{name:"time"}]},{name:"MINVERSE",description:"This function returns the inverse matrix for the matrix stored in an array.",parameters:[{name:"array"}]},{name:"MIRR",description:"This function returns the modified internal rate of return for a series of periodic cash flows.",parameters:[{name:"arrayvals"},{name:"payment_int"},{name:"income_int"}]},{name:"MMULT",description:"This function returns the matrix product for two arrays.",parameters:[{name:"array1"},{name:"array2"}]},{name:"MOD",description:"This function returns the remainder of a division operation.",parameters:[{name:"dividend"},{name:"divisor"}]},{name:"MODE",description:"This function returns the most frequently occurring value in a set of data.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MONTH",description:"This function returns the month corresponding to the specified date value.",parameters:[{name:"date"}]},{name:"MROUND",description:"This function returns a number rounded to the desired multiple.",parameters:[{name:"number"},{name:"multiple"}]},{name:"MULTINOMIAL",description:"This function calculates the ratio of the factorial of a sum of values to the product of factorials.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"N",description:"This function returns a value converted to a number.",parameters:[{name:"value"}]},{name:"NA",description:"This function returns the error value #N/A that means not available.",parameters:[]},{name:"NEGBINOMDIST",description:"This function returns the negative binomial distribution.",parameters:[{name:"x"},{name:"r"},{name:"p"}]},{name:"NETWORKDAYS",description:"This function returns the total number of complete working days between the start and end dates.",parameters:[{name:"startdate"},{name:"enddate"},{name:"holidays"}]},{name:"NOMINAL",description:"This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",parameters:[{name:"effrate"},{name:"comper"}]},{name:"NORMDIST",description:"This function returns the normal cumulative distribution for the specified mean and standard deviation.",parameters:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"NORMINV",description:"This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",parameters:[{name:"prob"},{name:"mean"},{name:"stdev"}]},{name:"NORMSDIST",description:"This function returns the standard normal cumulative distribution function.",parameters:[{name:"value"}]},{name:"NORMSINV",description:"This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",parameters:[{name:"prob"}]},{name:"NOT",description:"This function reverses the logical value of its argument.",parameters:[{name:"value"}]},{name:"NOW",description:"This function returns the current date and time.",parameters:[]},{name:"NPER",description:"This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",parameters:[{name:"rate"},{name:"paymt"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"NPV",description:"This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",parameters:[{name:"discount"},{name:"value1"},{name:"value2",repeatable:!0}]},{name:"OCT2BIN",description:"This function converts an octal number to a binary number.",parameters:[{name:"number"},{name:"places"}]},{name:"OCT2DEC",description:"This function converts an octal number to a decimal number.",parameters:[{name:"number"}]},{name:"OCT2HEX",description:"This function converts an octal number to a hexadecimal number.",parameters:[{name:"number"},{name:"places"}]},{name:"ODD",description:"This function rounds the specified value up to the nearest odd integer.",parameters:[{name:"value"}]},{name:"ODDFPRICE",description:"This function calculates the price per $100 face value of a security with an odd first period.",parameters:[{name:"settle"},{name:"maturity"},{name:"issue"},{name:"first"},{name:"rate"},{name:"yield"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"ODDFYIELD",description:"This function calculates the yield of a security with an odd first period.",parameters:[{name:"settle"},{name:"maturity"},{name:"issue"},{name:"first"},{name:"rate"},{name:"price"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"ODDLPRICE",description:"This function calculates the price per $100 face value of a security with an odd last coupon period.",parameters:[{name:"settle"},{name:"maturity"},{name:"last"},{name:"rate"},{name:"yield"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"ODDLYIELD",description:"This function calculates the yield of a security with an odd last period.",parameters:[{name:"settle"},{name:"maturity"},{name:"last"},{name:"rate"},{name:"price"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"OFFSET",description:"This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",parameters:[{name:"reference"},{name:"rows"},{name:"cols"},{name:"height"},{name:"width"}]},{name:"OR",description:"This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",parameters:[{name:"argument1"},{name:"argument2..."}]},{name:"PEARSON",description:"This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",parameters:[{name:"array_ind"},{name:"array_dep"}]},{name:"PERCENTILE",description:"This function returns the nth percentile of values in a range.",parameters:[{name:"array"},{name:"n"}]},{name:"PERCENTRANK",description:"This function returns the rank of a value in a data set as a percentage of the data set.",parameters:[{name:"array"},{name:"n"},{name:"sigdig"}]},{name:"PERMUT",description:"This function returns the number of possible permutations for a specified number of items.",parameters:[{name:"k"},{name:"n"}]},{name:"PI",description:"This function returns PI as 3.1415926536.",parameters:[]},{name:"PMT",description:"This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",parameters:[{name:"rate"},{name:"nper"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"POISSON",description:"This function returns the Poisson distribution.",parameters:[{name:"nevents"},{name:"mean"},{name:"cumulative"}]},{name:"POWER",description:"This function raises the specified number to the specified power.",parameters:[{name:"number"},{name:"power"}]},{name:"PPMT",description:"This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",parameters:[{name:"rate"},{name:"per"},{name:"nper"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"PRICE",description:"This function calculates the price per $100 face value of a periodic interest security",parameters:[{name:"settlement"},{name:"maturity"},{name:"rate"},{name:"yield"},{name:"redeem"},{name:"frequency"},{name:"basis"}]},{name:"PRICEDISC",description:"This function returns the price per $100 face value of a discounted security.",parameters:[{name:"settle"},{name:"mature"},{name:"discount"},{name:"redeem"},{name:"basis"}]},{name:"PRICEMAT",description:"This function returns the price at maturity per $100 face value of a security that pays interest.",parameters:[{name:"settle"},{name:"mature"},{name:"issue"},{name:"rate"},{name:"yield"},{name:"basis"}]},{name:"PROB",description:"This function returns the probability that values in a range are between two limits.",parameters:[{name:"array"},{name:"probs"},{name:"lower"},{name:"upper"}]},{name:"PRODUCT",description:"This function multiplies all the arguments and returns the product.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"PV",description:"This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",parameters:[{name:"rate"},{name:"numper"},{name:"paymt"},{name:"fval"},{name:"type"}]},{name:"QUARTILE",description:"This function returns which quartile (which quarter or 25 percent) of a data set a value is.",parameters:[{name:"array"},{name:"quart"}]},{name:"QUOTIENT",description:"This function returns the integer portion of a division. Use this to ignore the remainder of a division.",parameters:[{name:"numerator"},{name:"denominator"}]},{name:"RADIANS",description:"This function converts the specified number from degrees to radians.",parameters:[{name:"value"}]},{name:"RADIANS",description:"This function converts the specified number from degrees to radians.",parameters:[{name:"value"}]},{name:"RAND",description:"This function returns an evenly distributed random number between 0 and 1.",parameters:[]},{name:"RANDBETWEEN",description:"This function returns a random number between the numbers you specify.",parameters:[{name:"lower"},{name:"upper"}]},{name:"RANK",description:"This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",parameters:[{name:"number"},{name:"array"},{name:"order"}]},{name:"RATE",description:"This function returns the interest rate per period of an annuity.",parameters:[{name:"nper"},{name:"pmt"},{name:"pval"},{name:"fval"},{name:"type"},{name:"guess"}]},{name:"RECEIVED",description:"This function returns the amount received at maturity for a fully invested security.",parameters:[{name:"settle"},{name:"mature"},{name:"invest"},{name:"discount"},{name:"basis"}]},{name:"REPLACE",description:"This function replaces part of a text string with a different text string.",parameters:[{name:"old_text"},{name:"start_char"},{name:"num_chars"},{name:"new_text"}]},{name:"REPT",description:"This function repeats text a specified number of times.",parameters:[{name:"text"},{name:"number"}]},{name:"RIGHT",description:"This function returns the specified rightmost characters from a text value.",parameters:[{name:"text"},{name:"num_chars"}]},{name:"ROMAN",description:"This function converts an arabic numeral to a roman numeral text equivalent.",parameters:[{name:"number"},{name:"style"}]},{name:"ROUND",description:"This function rounds the specified value to the nearest number, using the specified number of decimal places.",parameters:[{name:"value"},{name:"places"}]},{name:"ROUNDDOWN",description:"This function rounds the specified number down to the nearest number, using the specified number of decimal places.",parameters:[{name:"value"},{name:"places"}]},{name:"ROUNDUP",description:"This function rounds the specified number up to the nearest number, using the specified number of decimal places.",parameters:[{name:"value"},{name:"places"}]},{name:"ROW",description:"This function returns the number of a row from a reference.",parameters:[{name:"reference"}]},{name:"ROWS",description:"This function returns the number of rows in an array.",parameters:[{name:"array"}]},{name:"RSQ",description:"This function returns the square of the Pearson product moment correlation coefficient (R‑squared) through data points in known y’s and known x’s.",parameters:[{name:"array_dep"},{name:"array_ind"}]},{name:"SEARCH",description:"This function finds one text string in another text string and returns the index of the starting position of the found text.",parameters:[{name:"string1"},{name:"string2"}]},{name:"SECOND",description:"This function returns the seconds (0 to 59) value for a specified time.",parameters:[{name:"time"}]},{name:"SERIESSUM",description:"This function returns the sum of a power series.",parameters:[{name:"x"},{name:"n"},{name:"m"},{name:"coeff"}]},{name:"SIGN",description:"This function returns the sign of a number or expression.",parameters:[{name:"cellreference"}]},{name:"SIN",description:"This function returns the sine of the specified angle.",parameters:[{name:"angle"}]},{name:"SINH",description:"This function returns the hyperbolic sine of the specified number.",parameters:[{name:"value"}]},{name:"SKEW",description:"This function returns the skewness of a distribution.",parameters:[{name:"number1"},{name:"number2",repeatable:!0}]},{name:"SLN",description:"This function returns the straight-line depreciation of an asset for one period.",parameters:[{name:"cost"},{name:"salvage"},{name:"life"}]},{name:"SLOPE",description:"This function calculates the slope of a linear regression.",parameters:[{name:"array_dep"},{name:"array_ind"}]},{name:"SMALL",description:"This function returns the nth smallest value in a data set, where n is specified.",parameters:[{name:"array"},{name:"n"}]},{name:"SQRT",description:"This function returns the positive square root of the specified number.",parameters:[{name:"value"}]},{name:"SQRTPI",description:"This function returns the positive square root of a multiple of pi (p).",parameters:[{name:"multiple"}]},{name:"STANDARDIZE",description:"This function returns a normalized value from a distribution characterized by mean and standard deviation.",parameters:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"STDEVA",description:"This function returns the standard deviation for a set of numbers, text, or logical values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"STDEVP",description:"This function returns the standard deviation for an entire specified population (of numeric values).",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"STDEVPA",description:"This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"STEYX",description:"This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",parameters:[{name:"array_dep"},{name:"array_ind"}]},{name:"SUBSTITUTE",description:"This function substitutes a new string for specified characters in an existing string.",parameters:[{name:"text"},{name:"old_piece"},{name:"new_piece"},{name:"instance"}]},{name:"SUBTOTAL",description:"This function calculates a subtotal of a list of numbers using a specified built-in function.",parameters:[{name:"functioncode"},{name:"value1"},{name:"value2",repeatable:!0}]},{name:"SUM",description:"This function returns the sum of cells or range of cells.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"SUMIF",description:"This function adds the cells using a given criteria.",parameters:[{name:"array"},{name:"condition"},{name:"sumrange"}]},{name:"SUMIFS",description:"This function adds the cells in a range using multiple criteria.",parameters:[{name:"array"},{name:"conditionarray"},{name:"condition",repeatable:!0}]},{name:"SUMPRODUCT",description:"This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",parameters:[{name:"array1"},{name:"array2",repeatable:!0}]},{name:"SUMSQ",description:"This function returns the sum of the squares of the arguments.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"SUMX2MY2",description:"This function returns the sum of the difference of the squares of corresponding values in two arrays.",parameters:[{name:"array_x"},{name:"array_y"}]},{name:"SUMX2PY2",description:"This function returns the sum of the sum of squares of corresponding values in two arrays.",parameters:[{name:"array_x"},{name:"array_y"}]},{name:"SUMXMY2",description:"This function returns the sum of the square of the differences of corresponding values in two arrays.",parameters:[{name:"array_x"},{name:"array_y"}]},{name:"SYD",description:"This function returns the sum-of-years’ digits depreciation of an asset for a specified period.",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"}]},{name:"T",description:"This function returns the text in a specified cell.",parameters:[{name:"value"}]},{name:"TAN",description:"This function returns the tangent of the specified angle.",parameters:[{name:"angle"}]},{name:"TANH",description:"This function returns the hyperbolic tangent of the specified number.",parameters:[{name:"value"}]},{name:"TBILLEQ",description:"This function returns the equivalent yield for a Treasury bill (or T-bill)",parameters:[{name:"settle"},{name:"mature"},{name:"discount"}]},{name:"TBILLPRICE",description:"This function returns the price per $100 face value for a Treasury bill (or T-bill).",parameters:[{name:"settle"},{name:"mature"},{name:"discount"}]},{name:"TBILLYIELD",description:"This function returns the yield for a Treasury bill (or T-bill).",parameters:[{name:"settle"},{name:"mature"},{name:"priceper"}]},{name:"TDIST",description:"This function returns the probability for the t-distribution.",parameters:[{name:"x"},{name:"deg"},{name:"tails"}]},{name:"TEXT",description:"This function formats a number and converts it to text.",parameters:[{name:"value"},{name:"text"}]},{name:"TIME",description:"This function returns the TimeSpan object for a specified time.",parameters:[{name:"hour"},{name:"minutes"},{name:"seconds"}]},{name:"TIMEVALUE",description:"This function returns the TimeSpan object of the time represented by a text string.",parameters:[{name:"time_string"}]},{name:"TINV",description:"This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",parameters:[{name:"prog"},{name:"deg"}]},{name:"TODAY",description:"This function returns the date and time of the current date.",parameters:[]},{name:"TRANSPOSE",description:"This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",parameters:[{name:"array"}]},{name:"TREND",description:"This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",parameters:[{name:"y"},{name:"x"},{name:"newx"},{name:"constant"}]},{name:"TRIM",description:"This function removes extra spaces from a string and leaves single spaces between words.",parameters:[{name:"text"}]},{name:"TRIMMEAN",description:"This function returns the mean of a subset of data excluding the top and bottom data.",parameters:[{name:"array"},{name:"percent"}]},{name:"TRUE",description:"This function returns the value for logical TRUE.",parameters:[]},{name:"TRUNC",description:"This function removes the specified fractional part of the specified number.",parameters:[{name:"value"},{name:"precision"}]},{name:"TTEST",description:"This function returns the probability associated with a t-test.",parameters:[{name:"array1"},{name:"array2"},{name:"tails"},{name:"type"}]},{name:"TYPE",description:"This function returns the type of value.",parameters:[{name:"value"}]},{name:"UPPER",description:"This function converts text to uppercase letters.",parameters:[{name:"string"}]},{name:"VALUE",description:"This function converts a text string that is a number to a numeric value.",parameters:[{name:"text"}]},{name:"VAR",description:"This function returns the variance based on a sample of a population, which uses only numeric values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VARA",description:"This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VARP",description:"This function returns variance based on the entire population, which uses only numeric values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VARPA",description:"This function returns variance based on the entire population, which includes numeric, logical, or text values.",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VDB",description:"This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"start"},{name:"end"},{name:"factor"},{name:"switchnot"}]},{name:"VLOOKUP",description:"This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",parameters:[{name:"value"},{name:"array"},{name:"colindex"},{name:"approx"}]},{name:"WEEKDAY",description:"This function returns the number corresponding to the day of the week for a specified date.",parameters:[{name:"date"},{name:"type"}]},{name:"WEEKNUM",description:"This function returns a number that indicates the week of the year numerically.",parameters:[{name:"date"},{name:"weektype"}]},{name:"WEIBULL",description:"This function returns the two-parameter Weibull distribution, often used in reliability analysis.",parameters:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"WORKDAY",description:"This function returns the number of working days before or after the starting date.",parameters:[{name:"startdate"},{name:"numdays"},{name:"holidays"}]},{name:"XIRR",description:"This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",parameters:[{name:"values"},{name:"dates"},{name:"guess"}]},{name:"XNPV",description:"This function calculates the net present value for a schedule of cash flows that may not be periodic.",parameters:[{name:"rate"},{name:"values"},{name:"dates"}]},{name:"YEAR",description:"This function returns the year as an integer for a specified date.",parameters:[{name:"date"}]},{name:"YEARFRAC",description:"This function returns the fraction of the year represented by the number of whole days between the start and end dates.",parameters:[{name:"startdate"},{name:"enddate"},{name:"basis"}]},{name:"YIELD",description:"This function calculates the yield on a security that pays periodic interest.",parameters:[{name:"settle"},{name:"maturity"},{name:"rate"},{name:"price"},{name:"redeem"},{name:"frequency"},{name:"basis"}]},{name:"YIELDDISC",description:"This function calculates the annual yield for a discounted security.",parameters:[{name:"settle"},{name:"maturity"},{name:"price"},{name:"redeem"},{name:"basis"}]},{name:"YIELDMAT",description:"This function calculates the annual yield of a security that pays interest at maturity.",parameters:[{name:"settle"},{name:"maturity"},{name:"issue"},{name:"issrate"},{name:"price"},{name:"basis"}]},{name:"ZTEST",description:"This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",parameters:[{name:"array"},{name:"x"},{name:"sigma"}]},{name:"PIESPARKLINE",description:"This function returns a data set used for representing a pie sparkline",parameters:[{name:"range|percentage"},{name:"color",repeatable:!0}]},{name:"AREASPARKLINE",description:"This function returns a data set used for representing a area sparkline",parameters:[{name:"points"},{name:"mini"},{name:"maxi"},{name:"line1"},{name:"line2"},{name:"colorPositive"},{name:"colorNegative"}]},{name:"SCATTERSPARKLINE",description:"This function returns a data set used for representing a scatter sparkline",parameters:[{name:"points1"},{name:"points2"},{name:"minX"},{name:"maxX"},{name:"minY"},{name:"maxY"},{name:"hLine"},{name:"vLine"},{name:"xMinZone"},{name:"xMaxZone"},{name:"yMinZone"},{name:"yMaxZone"},{name:"tags"},{name:"drawSymbol"},{name:"drawLines"},{name:"color1"},{name:"color2"},{name:"dash"}]},{name:"LINESPARKLINE",description:"This function returns a data set used for representing a line sparkline",parameters:[{name:"data"},{name:"dataOrientation"},{name:"dateAxisData"},{name:"dateAxisOrientation"},{name:"setting"}]},{name:"COLUMNSPARKLINE",description:"This function returns a data set used for representing a column sparkline",parameters:[{name:"data"},{name:"dataOrientation"},{name:"dateAxisData"},{name:"dateAxisOrientation"},{name:"setting"}]},{name:"WINLOSSSPARKLINE",description:"This function returns a data set used for representing a win/loss sparkline",parameters:[{name:"data"},{name:"dataOrientation"},{name:"dateAxisData"},{name:"dateAxisOrientation"},{name:"setting"}]}],a
}();a.FormulaTextBoxResource_EN=b;var c=function(){function a(){}return a.Functions=[{name:"ABS",description:"指定した値の絶対値を返します。",parameters:[{name:"value"}]},{name:"ACCRINT",description:"定期的に利息が支払われる証券の未収利息額を算出します。",parameters:[{name:"issue"},{name:"first"},{name:"settle"},{name:"rate"},{name:"par"},{name:"frequency"},{name:"basis"}]},{name:"ACCRINTM",description:"満期に利息が支払われる証券の未収利息額を算出します。",parameters:[{name:"issue"},{name:"maturity"},{name:"rate"},{name:"par"},{name:"basis"}]},{name:"ACOS",description:"指定の値がコサインとなる角度を返します。戻り値の角度は 0～π（ラジアン単位）です。",parameters:[{name:"value"}]},{name:"ACOSH",description:"指定した角度のハイパーボリックコサインの逆関数値を算出します。",parameters:[{name:"value"}]},{name:"ADDRESS",description:"指定の行番号および列番号に基づき、セル アドレスを表すテキストを生成します。",parameters:[{name:"row"},{name:"column"},{name:"absnum"},{name:"a1style"},{name:"sheettext"}]},{name:"AMORDEGRC",description:"日割り計算による減価償却を考慮し、資産耐用年数に基づく減価償却係数を計算に適用して、会計期ごとの減価償却を返します。",parameters:[{name:"cost"},{name:"datepurchased"},{name:"firstperiod"},{name:"salvage"},{name:"period"},{name:"drate"},{name:"basis"}]},{name:"AMORLINC",description:"日割り計算による減価消却を考慮し、指定の会計期の減価償却費を計算します。",parameters:[{name:"cost"},{name:"datepurchased"},{name:"firstperiod"},{name:"salvage"},{name:"period"},{name:"drate"},{name:"basis"}]},{name:"AND",description:"すべての引数が真であれば True を、１つ以上の引数が偽であれば False を返します。",parameters:[{name:"logical1"},{name:"logical2"}]},{name:"ASIN",description:"指定の値がサインとなる角度を返します。戻り値の角度は -π/2～π/2（ラジアン単位）です。",parameters:[{name:"value"}]},{name:"ASINH",description:"指定した数値のハイパーボリックサインの逆関数値を算出します。",parameters:[{name:"value"}]},{name:"ATAN",description:"指定の値がタンジェントとなる角度を返します。戻り値の角度は -π/2～π/2（ラジアン単位）です。",parameters:[{name:"value"}]},{name:"ATAN2",description:"指定の x 座標および y 座標のアークタンジェントを返します。戻り値の角度は -π～π（ラジアン単位、ただし -π を除く）です。",parameters:[{name:"x"},{name:"y"}]},{name:"ATANH",description:"指定した数値のハイパーボリックタンジェントの逆関数値を算出します。",parameters:[{name:"value"}]},{name:"AVEDEV",description:"指定のデータ全体の平均値に対する、個々の値の絶対偏差の平均値を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"AVERAGE",description:"指定した数値の平均値を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"AVERAGEA",description:"指定した数値の平均値を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"AVERAGEIF",description:"指定した基準を満たすデータセットの平均値を計算します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0},{name:"condition"}]},{name:"AVERAGEIFS",description:"指定した複数の基準を満たすデータセットの平均値を計算します。",parameters:[{name:"value1"},{name:"condition1"},{name:"value2",repeatable:!0},{name:"condition2..."}]},{name:"BESSELI",description:"純虚数を引数としたときの第１種変形ベッセル関数を返します。",parameters:[{name:"value"},{name:"order"}]},{name:"BESSELJ",description:"第１種ベッセル関数を返します。",parameters:[{name:"value"},{name:"order"}]},{name:"BESSELK",description:"純虚数を引数としたときの第２種変形ベッセル関数を返します。",parameters:[{name:"value"},{name:"order"}]},{name:"BESSELY",description:"第２種ベッセル関数を返します。",parameters:[{name:"value"},{name:"order"}]},{name:"BETADIST",description:"累積β確率密度関数の値を算出します。",parameters:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"lower"},{name:"upper"}]},{name:"BETAINV",description:"累積β確率密度関数の逆関数の値を算出します。",parameters:[{name:"prob"},{name:"alpha"},{name:"beta"},{name:"lower"},{name:"upper"}]},{name:"BIN2DEC",description:"２進数値を 10 進数値に変換します。",parameters:[{name:"number"}]},{name:"BIN2HEX",description:"２進数値を 16 進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"BIN2OCT",description:"２進数値を８進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"BINOMDIST",description:"個別項の二項分布の確率を算出します。",parameters:[{name:"x"},{name:"n"},{name:"p"},{name:"cumulative"}]},{name:"CEILING",description:"指定した基準値の倍数になるように数値を丸め、元の値に最も近い値を返します。",parameters:[{name:"value"},{name:"signif"}]},{name:"CHAR",description:"指定した数値に対応する文字を返します。",parameters:[{name:"value"}]},{name:"CHIDIST",description:"片側カイ２乗分布の確率を算出します。",parameters:[{name:"value"},{name:"deg"}]},{name:"CHIINV",description:"片側カイ２乗分布確率の逆関数を算出します。",parameters:[{name:"prob"},{name:"deg"}]},{name:"CHITEST",description:"カイ２乗分布からの独立性を検定します。",parameters:[{name:"obs_array"},{name:"exp_array"}]},{name:"CHOOSE",description:"値リストの中から特定の値を返します。",parameters:[{name:"index"},{name:"value1"},{name:"value2",repeatable:!0}]},{name:"CLEAN",description:"指定のテキストから、印刷できないすべての文字を削除します。",parameters:[{name:"text"}]},{name:"CODE",description:"テキスト内の先頭文字に対応する数値コードを返します。返されるコードは、Unicodeです。",parameters:[{name:"text"}]},{name:"COLUMN",description:"参照の列番号を返します。",parameters:[{name:"reference"}]},{name:"COLUMNS",description:"配列内の列数を返します。",parameters:[{name:"array"}]},{name:"COMBIN",description:"総数から指定の個数を抜き取る場合、選択可能な組み合わせの数を返します。",parameters:[{name:"k"},{name:"n"}]},{name:"COMPLEX",description:"実数係数および虚数係数を複素数に変換します。",parameters:[{name:"realcoeff"},{name:"imagcoeff"},{name:"suffix"}]},{name:"CONCATENATE",description:"指定の文字列または数値を１つの文字列に統合します。",parameters:[{name:"text1"},{name:"text2"},{name:"...."}]},{name:"CONFIDENCE",description:"母集団の平均値に対する信頼区間を返します。",parameters:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CONVERT",description:"ある計測単位の値を、別の計測単位に変換します。",parameters:[{name:"number"},{name:"from-unit"},{name:"to-unit"}]},{name:"CORREL",description:"２組のデータセット間の相関係数を返します。",parameters:[{name:"array1"},{name:"array2"}]},{name:"COS",description:"指定した角度のコサインを返します。",parameters:[{name:"angle"}]},{name:"COSH",description:"指定した角度のハイパーボリックコサインを返します。",parameters:[{name:"value"}]},{name:"COUNT",description:"指定した複数の値に数値が何個含まれているか個数を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"COUNTA",description:"指定した複数の値に数値が何個含まれているか個数を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"COUNTBLANK",description:"シート上の指定のセル範囲から、空白セルの数を返します。",parameters:[{name:"cellrange"}]},{name:"COUNTIF",description:"特定の条件を満たすセルの数を返します。",parameters:[{name:"cellrange"},{name:"condition"}]},{name:"COUNTIFS",description:"複数の条件を満たすセルの数を返します。",parameters:[{name:"cellrange"},{name:"condition"}]},{name:"COUPDAYBS",description:"証券の利払期間の１日目から受渡日までの日数を計算します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPDAYS",description:"証券の利払期間（受渡日を含む）を表す日数を返します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPDAYSNC",description:"証券の受渡日から次の利払日までの日数を計算します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPNCD",description:"証券の受渡後の次回の利払日を日付値で返します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basi"}]},{name:"COUPNUM",description:"証券の受渡日から満期日までの期間中の利払回数を返します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COUPPCD",description:"証券の受渡日直前の利払日を日付値で返します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis"}]},{name:"COVAR",description:"２組の対応するデータの標準偏差の積の平均値を返します。",parameters:[{name:"array1"},{name:"array2"}]},{name:"CRITBINOM",description:"累積二項分布の値が基準値以上となる最小値を返します。",parameters:[{name:"n"},{name:"p"},{name:"alpha"}]},{name:"CUMIPMT",description:"開始期から終了期までの期間内で、貸付金に対して支払われる利息の累計を計算します。",parameters:[{name:"rate"},{name:"nper"},{name:"pval"},{name:"startperiod"},{name:"endperiod"},{name:"paytype"}]},{name:"CUMPRINC",description:"開始期から終了期までの期間内で、貸付金に対して支払われる元金の累計を計算します。",parameters:[{name:"rate"},{name:"nper"},{name:"pval"},{name:"startperiod"},{name:"endperiod"},{name:"paytype"}]},{name:"DATE",description:"年、月、日で指定した日付に対する日付オブジェクトを返します。",parameters:[{name:"year"},{name:"month"},{name:"day"}]},{name:"DATEDIF",description:"２つの日付間の日数、月数、または年数を返します。",parameters:[{name:"date1"},{name:"date2"},{name:"outputcode"}]},{name:"DATEVALUE",description:"指定の日付に対する日時を返します。",parameters:[{name:"date_string"}]},{name:"DAVERAGE",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす値の平均値を計算します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DAY",description:"特定の日付に対応する、月内の日（1～31）を返します。",parameters:[{name:"date"}]},{name:"DAYS360",description:"１年を 360 日（１月が 30 日）とみなし、２つの日付間の日数を返します。",parameters:[{name:"startdate"},{name:"enddate"},{name:"method"}]},{name:"DB",description:"定率法を使用して、特定の期の資産の減価償却費を算出します。",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"month"}]},{name:"DCOUNT",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす数値を保持するセル数をカウントします。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DCOUNTA",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす、空白以外のセル数をカウントします。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DDB",description:"倍率法、またはその他の指定の計算方法を使用して、特定の期の資産の減価償却費を算出します。",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"factor"}]},{name:"DEC2BIN",description:"10 進数値を２進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"DEC2HEX",description:"10 進数値を 16 進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"DEC2OCT",description:"10 進数値を８進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"DEGREES",description:"指定したラジアン単位の角度の値を度単位に変換します。",parameters:[{name:"angle"}]},{name:"DELTA",description:"２つの値が等しいかどうかを調べます。２つの値が等しければ１、そうでなければ０を返します。",parameters:[{name:"value1"},{name:"value2"}]},{name:"DEVSQ",description:"平均値に対する個々のデータ点の偏差の平方和を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"DGET",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす１つの値を抽出します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DISC",description:"証券の割引率を算出します。",parameters:[{name:"settle"},{name:"mature"},{name:"pricep"},{name:"redeem"},{name:"basis"}]},{name:"DMAX",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす最大値を返します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DMIN",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす最小値を返します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DOLLAR",description:"数値を指定の小数位になるように四捨五入し、通貨書式を施した文字列に変換します。",parameters:[{name:"value"},{name:"digits"}]},{name:"DOLLARDE",description:"分数表記されたドル値を、小数表記のドル値に変換します。",parameters:[{name:"fractionaldollar"},{name:"fraction"}]},{name:"DOLLARFR",description:"小数表記されたドル値を、分数表記のドル値に変換します。",parameters:[{name:"decimaldollar"},{name:"fraction"}]},{name:"DPRODUCT",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす値を乗算します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DSTDEV",description:"リストまたはデータベース内の指定の１列における、指定の条件を満たす数値を標本として使用して、母集団の標準偏差を評価します",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DSTDEVP",description:"リストまたはデータベース内の指定の１列における、指定の条件を満たす数値を使用して、母集団全体に基づく標準偏差を計算します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DSUM",description:"リストまたはデータベース内の指定の１列において、指定の条件を満たす数値を加算します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DURATION",description:"額面を $100 とみなした証券のマコーレー デュレーションを返します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"coupon"},{name:"yield"},{name:"frequency"},{name:"basis"}]},{name:"DVAR",description:"リストまたはデータベース内の指定の１列における、指定の条件を満たす数値を標本として使用して、母集団の分散を評価します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"DVARP",description:"リストまたはデータベース内の指定の１列における、指定の条件を満たす数値を使用して、母集団全体に基づく分散を計算します。",parameters:[{name:"database"},{name:" field"},{name:" criteria"}]},{name:"EDATE",description:"指定の日付から、指定の月数だけ前または後の日時を返します。",parameters:[{name:"startdate"},{name:"months"}]},{name:"EFFECT",description:"指定の名目年利率と１年あたりの複利計算期間に基づき、実効年利率を返します。",parameters:[{name:"nomrate"},{name:"comper"}]},{name:"EOMONTH",description:"指定の日付から、指定の月数だけ前または後の月の最終日（月末日）となる日時を返します。",parameters:[{name:"startdate"},{name:"months"}]},{name:"ERF",description:"上限から下限の範囲で、誤差関数の積分値を返します。",parameters:[{name:"limit"},{name:"upperlimit"}]},{name:"ERFC",description:"下限から無限大の範囲で、相補誤差関数の積分値を返します。",parameters:[{name:"lowerlimit"}]},{name:"ERROR.TYPE",description:"エラー値に対応する数値を返します。エラーがない場合は、#N/A を返します。",parameters:[{name:"errorvalue"}]},{name:"EURO",description:"ISO 通貨コードに基づき、１ユーロに相当する通貨値を返します。",parameters:[{name:"code"}]},{name:"EUROCONVERT",description:"ユーロ加盟国通貨（ユーロを含む）間で、ある通貨値を別の通貨値に変換します。",parameters:[{name:"currency"},{name:"source"},{name:"target"},{name:"fullprecision"},{name:"triangulation"}]},{name:"EVEN",description:"指定した値を切り上げ、最も近い偶数の整数値を返します。",parameters:[{name:"value"}]},{name:"EXACT",description:"２つの文字列が等しければ True を、そうでなければ False を返します。",parameters:[{name:"text1"},{name:"text2"}]},{name:"EXP",description:"e（自然対数の底）を底とする、指定の数のべき乗 (ex) を返します。EXP 関数は LN の逆関数です。",parameters:[{name:"value"}]},{name:"EXPONDIST",description:"指数分布関数または確率密度関数の値を算出します。",parameters:[{name:"value"},{name:"lambda"},{name:"cumulative"}]},{name:"FACT",description:"指定した値の階乗を返します。",parameters:[{name:"number"}]},{name:"FACTDOUBLE",description:"数値の２乗階乗を返します。",parameters:[{name:"number"}]},{name:"FALSE",description:"論理値０（False）を返します。",parameters:[]},{name:"FDIST",description:"２組のデータ間の分散度を比較する F 確率分布関数を算出します。",parameters:[{name:"value"},{name:"degnum"},{name:"degden"}]},{name:"FIND",description:"テキスト内から指定の文字を検索し、この文字の位置を返します。",parameters:[{name:"findtext"},{name:"intext"},{name:"start"}]},{name:"FINV",description:"F 確率分布関数の逆関数の値を返します。p = FDIST(x,...) であるとき、FINV(p,...) = x となります。",parameters:[{name:"p"},{name:"degnum"},{name:"degden"}]},{name:"FISHER",description:"指定の値に対するフィッシャー変換値を算出します。",parameters:[{name:"value"}]},{name:"FISHERINV",description:"フィッシャー変換の逆関数の値を算出します。",parameters:[{name:"value"}]},{name:"FIXED",description:"数値を指定の小数位になるように四捨五入し、ピリオドとコンマ（指定した場合）による小数書式を適用した結果をテキストとして返します。",parameters:[{name:"num"},{name:"digits"},{name:"notcomma"}]},{name:"FLOOR",description:"指定した基準値の倍数になるように数値を切り捨て、元の値に最も近い値を返します。",parameters:[{name:"value"},{name:"signif"}]},{name:"FORECAST",description:"既知の値を使用して予測値を算出します。",parameters:[{name:"value"},{name:"Yarray"},{name:"Xarray"}]},{name:"FREQUENCY",description:"指定の値範囲内で値が出現する頻度を計算します。 この関数は、数値の垂直配列を返します。",parameters:[{name:"dataarray"},{name:"binarray"}]},{name:"FTEST",description:"F 検定の結果を返します。これは、２つの配列内のデータの分散に有意な差が認められない片側確率の算出結果です。",parameters:[{name:"array1"},{name:"array2"}]},{name:"FV",description:"現在価値、定期払い、および特定の利率を条件とし、投資の将来価値を算出します。",parameters:[{name:"rate"},{name:"numper"},{name:"paymt"},{name:"pval"},{name:"type"}]},{name:"FVSCHEDULE",description:"投資期間内の一連の金利を複合計算することにより、初期投資（元金）の将来価値を算出します。",parameters:[{name:"principal"},{name:"schedule"}]},{name:"GAMMADIST",description:"ガンマ分布関数の値を算出します。",parameters:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"GAMMAINV",description:"ガンマ累積分布関数の逆関数の値を返します。p = GAMMADIST(x,...) であるとき、GAMMAINV(p,...) = x となります。",parameters:[{name:"p"},{name:"alpha"},{name:"beta"}]},{name:"GAMMALN",description:"ガンマ関数の値の自然対数 (x) を返します。",parameters:[{name:"value"}]},{name:"GCD",description:"２つの数値間の最大公約数を返します。最大公約数とは、対象となるすべての値を余りを出さずに割り切ることのできる最大の整数です。",parameters:[{name:"number1"},{name:"number2"}]},{name:"GEOMEAN",description:"一群の正数の相乗平均値を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"GESTEP",description:"数値がしきい値に等しいかどうかを判定します。指定した数値がしきい値と等しいか、それ以上であれば１、そうでない場合は０を返します。",parameters:[{name:"number"},{name:"step"}]},{name:"GROWTH",description:"予測される指数曲線を計算します。",parameters:[{name:"y"},{name:"x"},{name:"newx"},{name:"constant"}]},{name:"HARMEAN",description:"一群の数値の調和平均を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"HEX2BIN",description:"16 進数値を２進数値に変換します。",parameters:[{name:"number"},{name:" places"}]},{name:"HEX2DEC",description:"16 進数値を 10 進数値に変換します。",parameters:[{name:"number"}]},{name:"HEX2OCT",description:"16 進数値を８進数値に変換します。",parameters:[{name:"number"},{name:" places"}]},{name:"HLOOKUP",description:"指定範囲の最上行から値を検索し、指定の行から、この値と同じ列内の値を返します。",parameters:[{name:"value"},{name:"array"},{name:"row"},{name:"approx"}]},{name:"HOUR",description:"指定の時刻値に対応する時を返します。",parameters:[{name:"time"}]},{name:"HYPGEOMDIST",description:"超幾何分布関数の値を算出します。",parameters:[{name:"x"},{name:"n"},{name:"M"},{name:"N"}]},{name:"IF",description:"論理式の結果を表す値を返します。",parameters:[{name:"valueTest"},{name:"valueTrue"},{name:"valueFalse"}]},{name:"IFERROR",description:"数式を評価し、エラーの場合には指定した値、その他の場合には数式の結果を返します。",parameters:[{name:"value"},{name:"error"}]},{name:"IMABS",description:"複素数の絶対値を返します。",parameters:[{name:"complexnum"}]},{name:"IMAGINARY",description:"複素数の虚数係数を返します。",parameters:[{name:"complexnum"}]},{name:"IMARGUMENT",description:"ラジアン単位の角度である引数θを返します。",parameters:[{name:"complexnum"}]},{name:"IMCONJUGATE",description:"複素数の複素共役を返します。",parameters:[{name:"complexnum"}]},{name:"IMCOS",description:"複素数のコサインを返します。",parameters:[{name:"complexnum"}]},{name:"IMDIV",description:"２つの複素数の商を返します。",parameters:[{name:"complexnum"},{name:"complexdenom"}]},{name:"IMEXP",description:"複素数の指数関数を返します。",parameters:[{name:"complexnum"}]},{name:"IMLN",description:"複素数の自然対数を返します。",parameters:[{name:"complexnum"}]},{name:"IMLOG2",description:"複素数の２を底とする対数を返します。",parameters:[{name:"complexnum"}]},{name:"IMLOG10",description:"複素数の常用対数を返します。",parameters:[{name:"complexnum"}]},{name:"IMPOWER",description:"複素数の整数乗を返します。",parameters:[{name:"complexnum"},{name:"powernum"}]},{name:"IMPRODUCT",description:'"x+yi" または "x+yj" 形式のテキストで指定した、最大 29 個の複素数の積を返します。',parameters:[{name:"complexnum1"},{name:"complexnum2",repeatable:!0}]},{name:"IMREAL",description:'"x+yi" または "x+yj" 形式のテキストで指定した複素数の実数係数を返します。',parameters:[{name:"complexnum"}]},{name:"IMSIN",description:'"x+yi" または "x+yj" 形式のテキストで指定した複素数のサインを返します。',parameters:[{name:"complexnum"}]},{name:"IMSQRT",description:'"x+yi" または "x+yj" 形式のテキストで指定した複素数の平方根を返します。',parameters:[{name:"complexnum"}]},{name:"IMSUB",description:'"x+yi" または "x+yj" 形式のテキストで指定した２つの複素数の差を返します。',parameters:[{name:"complexnum1"},{name:"complexnum2"}]},{name:"IMSUM",description:'x+yi" または "x+yj" 形式のテキストで指定した２つ以上の複素数の合計を返します。',parameters:[{name:"complexnum1"},{name:"complexnum2",repeatable:!0}]},{name:"INDEX",description:"配列またはセル範囲の中から、特定の値または値への参照を返します。",parameters:[{name:"return"},{name:"row"},{name:"col"},{name:"area"}]},{name:"INT",description:"指定した値の小数部分を切り捨て、最も近い整数値を返します。",parameters:[{name:"value"}]},{name:"INTERCEPT",description:"指定の x 値と y 値を使用して得た回帰直線が y 軸と交わる点を求めます。",parameters:[{name:"dependent"},{name:"independent"}]},{name:"INTRATE",description:"全額投資された証券の利率を算出します。",parameters:[{name:"settle"},{name:"mature"},{name:"invest"},{name:"redeem"},{name:"basis"}]},{name:"IPMT",description:"借入金返済において、支払うべき金利を算出します。",parameters:[{name:"rate"},{name:"per"},{name:"nper"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"IRR",description:"一連の定期的なキャッシュフロー（values 引数の配列値で指定）に基づき、内部利益率を算出します。",parameters:[{name:"arrayvals"},{name:"estimate"}]},{name:"ISBLANK",description:"セルなどの値が空白かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISERR",description:"セルなどの値が、#N/A（利用不可）以外のエラー値を参照するかどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISERROR",description:"セルなどの値が、任意のエラー値を参照するかどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISEVEN",description:"セルなどの値が偶数かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISLOGICAL",description:"セルなどの値が論理値かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISNA",description:"セルなどの値が、エラー値 #N/A（利用不可）を参照するかどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISNONTEXT",description:"セルなどの値が、テキスト以外のデータかどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISNUMBER",description:"セルなどの値が数値かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISODD",description:"セルなどの値が奇数かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISPMT",description:"指定の投資期間に支払われる金利を計算します。",parameters:[{name:"rate"},{name:"per"},{name:"nper"},{name:"pv"}]},{name:"ISREF",description:"セルなどの値が、他のセルへの参照かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"ISTEXT",description:"セルなどの値が文字列かどうかを判定します。",parameters:[{name:"cellreference"}]},{name:"KURT",description:"データ集合の尖度を返します。",parameters:[{name:"value1"},{name:"value2"},{name:"value3"},{name:"value4",repeatable:!0}]},{name:"LARGE",description:"データ集合内で n 番目に大きい値を返します。",parameters:[{name:"array"},{name:"n"}]},{name:"LCM",description:"指定した整数の最小公倍数を返します。",parameters:[{name:"number1"},{name:"number2"}]},{name:"LEFT",description:"テキスト値から先頭（左端）の文字を返します。",parameters:[{name:"mytext"},{name:"num_chars"}]},{name:"LEN",description:"テキストの文字数を返します。",parameters:[{name:"value"}]},{name:"LINEST",description:"直線に基づく統計値を計算します。",parameters:[{name:"y"},{name:"x"},{name:"constant"},{name:"stats"}]},{name:"LN",description:"指定した数の自然対数を返します。LN は EXP の逆関数です。",parameters:[{name:"value"}]},{name:"LOG",description:"Y を底とする数値 X の対数を返します。",parameters:[{name:"number"},{name:"base"}]},{name:"LOG10",description:"10 を底とする数値 X の対数を返します。",parameters:[{name:"value"}]},{name:"LOGEST",description:"データに適合する指数曲線を計算し、この曲線を表す値の配列を返します。",parameters:[{name:"y"},{name:"x"},{name:"constant"},{name:"stats"}]},{name:"LOGINV",description:"x の対数正規累積分布関数の逆関数の値を算出します。",parameters:[{name:"prob"},{name:"mean"},{name:"stdev"}]},{name:"LOGNORMDIST",description:"x の対数正規累積分布関数の値を算出します。",parameters:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"LOOKUP",description:"１行または１列内のセル範囲、または配列から値を検索します。",parameters:[{name:"lookupvalue"},{name:"lookupvector"},{name:"resultvector"}]},{name:"LOWER",description:"テキストを小文字に変換します。",parameters:[{name:"string"}]},{name:"MATCH",description:"指定された項目の範囲内における相対位置を返します。",parameters:[{name:"value1"},{name:"array"},{name:"type"}]},{name:"MAX",description:"引数リストの中から最大値を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MAXA",description:"引数リストの中から最大値を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MDETERM",description:"配列の行列式を返します。",parameters:[{name:"array"}]},{name:"MDURATION",description:"額面を $100 とみなした証券の修正マコーレー デュレーションを返します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"coupon"},{name:"yield"},{name:"frequency"},{name:"basis"}]},{name:"MEDIAN",description:"指定した一群の数値の中からメジアン（中央値）を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MID",description:"テキスト内の指定位置から、指定した数の文字を取り出して返します。",parameters:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"MIN",description:"引数リストの中から最小値を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MINA",description:"引数リストの中から最小値を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MINUTE",description:"引数リストの中から最小値を返します。",parameters:[{name:"time"}]},{name:"MINVERSE",description:"配列に指定した行列の逆行列を返します。",parameters:[{name:"array"}]},{name:"MIRR",description:"一連の定期的なキャッシュフローに基づき、修正内部利益率を算出します。",parameters:[{name:"arrayvals"},{name:"payment_int"},{name:"income_int"}]},{name:"MMULT",description:"２つの配列に指定した行列の積を返します。",parameters:[{name:"array1"},{name:"array2"}]},{name:"MOD",description:"number 引数（被除数）を divisor 引数（除数）で割ったときの剰余を返します。",parameters:[{name:"dividend"},{name:"divisor"}]},{name:"MODE",description:"指定の引数リストの中で、最も頻繁に出現する値を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"MONTH",description:"指定の日付値に対応する月を返します。",parameters:[{name:"date"}]},{name:"MROUND",description:"指定の倍数となるように丸めた値を返します。",parameters:[{name:"number"},{name:"multiple"}]},{name:"MULTINOMIAL",description:"指定された引数リストの多項係数（リスト内の値の和の階乗と、各値の階乗の積との比）を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"N",description:"数値に変換した値を返します。",parameters:[{name:"value"}]},{name:"NA",description:"「利用不可」を意味するエラー値 #N/A を返します。",parameters:[]},{name:"NEGBINOMDIST",description:"負の二項分布を算出します。",parameters:[{name:"x"},{name:"r"},{name:"p"}]},{name:"NETWORKDAYS",description:"開始日から終了日までの期間内で、完全な稼働日の合計を計算します。",parameters:[{name:"startdate"},{name:"enddate"},{name:"holidays"}]},{name:"NOMINAL",description:"指定の実効利率と１年あたりの複利計算期間に基づき、名目上の年利率を算出します。",parameters:[{name:"effrate"},{name:"comper"}]},{name:"NORMDIST",description:"指定の平均と標準偏差に対する正規累積分布関数の値を返します。",parameters:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"NORMINV",description:"指定の平均と標準偏差に対する正規累積分布関数の逆関数の値を返します。",parameters:[{name:"prob"},{name:"mean"},{name:"stdev"}]},{name:"NORMSDIST",description:"標準正規累積分布関数の値を算出します。",parameters:[{name:"value"}]},{name:"NORMSINV",description:"標準正規累積分布関数の逆関数の値を返します。この分布では、平均が０、標準偏差が１となります。",parameters:[{name:"prob"}]},{name:"NOT",description:"引数の論理値を逆にします。",parameters:[{name:"value"}]},{name:"NOW",description:"現在の日付と時刻を表す値を返します。",parameters:[]},{name:"NPER",description:"現行価値、将来価値、定期払い、および特定の利率を条件とし、投資に必要な期間（支払回数）を返します。",parameters:[{name:"rate"},{name:"paymt"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"NPV",description:"割引率と、将来行われる一連の支払いおよびその収益に基づいて、投資の正味現在価値を算出します。",parameters:[{name:"discount"},{name:"value1"},{name:"value2",repeatable:!0}]},{name:"OCT2BIN",description:"８進数値を２進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"OCT2DEC",description:"８進数値を 10 進数値に変換します。",parameters:[{name:"number"}]},{name:"OCT2HEX",description:"８進数値を 16 進数値に変換します。",parameters:[{name:"number"},{name:"places"}]},{name:"ODD",description:"指定した値を切り上げ、最も近い奇数の整数値を返します。",parameters:[{name:"value"}]},{name:"ODDFPRICE",description:"１期目の日数が半端な証券に対し、額面 $100 あたりの価格を計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"issue"},{name:"first"},{name:"rate"},{name:"yield"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"ODDFYIELD",description:"１期目の日数が半端な証券の利回りを計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"issue"},{name:"first"},{name:"rate"},{name:"price"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"ODDLPRICE",description:"最終期の日数が半端な証券に対し、額面 $100 あたりの価格を計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"last"},{name:"rate"},{name:"yield"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"ODDLYIELD",description:"最終期の日数が半端な証券の利回りを計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"last"},{name:"rate"},{name:"price"},{name:"redeem"},{name:"freq"},{name:"basis"}]},{name:"OFFSET",description:"この関数は、セル範囲への参照を返します。 返されるセル範囲は、単一のセルまたはセル範囲からの行数と列数で指定します。 これにより、単一のセルまたはセル範囲が返されます。",parameters:[{name:"reference"},{name:"rows"},{name:"cols"},{name:"height"},{name:"width"}]},{name:"OR",description:"いずれかの引数が真であれば１（True）を、すべての引数が偽であれば０（False）を返します。",parameters:[{name:"argument1"},{name:"argument2..."}]},{name:"PEARSON",description:"ピアソンの積率相関係数を返します。これは -1.0～1.0 の範囲の数値であり、２組のデータ間での線形相関の程度を示します。",parameters:[{name:"array_ind"},{name:"array_dep"}]},{name:"PERCENTILE",description:"ある範囲内の値の中で n 番目の百分位を持つ値を返します。",parameters:[{name:"array"},{name:"n"}]},{name:"PERCENTRANK",description:"データセット内の値の順位を、このデータセット内の百分率として返します。",parameters:[{name:"array"},{name:"n"},{name:"sigdig"}]},{name:"PERMUT",description:"指定した数の標本を抜き取る際の、有効な順列の数を返します。",parameters:[{name:"k"},{name:"n"}]},{name:"PI",description:"円周率（π）を 3.1415926536 として返します。",parameters:[]},{name:"PMT",description:"現在価値、指定の利率、および支払回数に基づき、借入金返済での定期支払額を算出します。",parameters:[{name:"rate"},{name:"nper"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"POISSON",description:"ポアソン確率分布の値を算出します。",parameters:[{name:"nevents"},{name:"mean"},{name:"cumulative"}]},{name:"POWER",description:"指定の数（X）を底とする指数（Y）のべき乗を求めます。",parameters:[{name:"number"},{name:"power"}]},{name:"PPMT",description:"元金の返済額を返します。",parameters:[{name:"rate"},{name:"per"},{name:"nper"},{name:"pval"},{name:"fval"},{name:"type"}]},{name:"PRICE",description:"定期的に利息が支払われる証券に対し、額面 $100 あたりの価格を計算します。",parameters:[{name:"settlement"},{name:"maturity"},{name:"rate"},{name:"yield"},{name:"redeem"},{name:"frequency"},{name:"basis"}]},{name:"PRICEDISC",description:"割引債の額面 $100 あたりの価格を算出します。",parameters:[{name:"settle"},{name:"mature"},{name:"discount"},{name:"redeem"},{name:"basis"}]},{name:"PRICEMAT",description:"満期日に利息が払われる証券に対し、額面 $100 あたりの価格を返します。",parameters:[{name:"settle"},{name:"mature"},{name:"issue"},{name:"rate"},{name:"yield"},{name:"basis"}]},{name:"PROB",description:"特定範囲内の値が上限と下限の間に収まる確率を返します。",parameters:[{name:"array"},{name:"probs"},{name:"lower"},{name:"upper"}]},{name:"PRODUCT",description:"すべての引数値を乗算して得た積を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"PV",description:"特定の利率、定期払いの回数と支払額、および将来価値を条件として、投資の現在価値を返します。",parameters:[{name:"rate"},{name:"numper"},{name:"paymt"},{name:"fval"},{name:"type"}]},{name:"QUARTILE",description:"データセットから、指定した四分位数（データセットの 1/4［25%］）を返します。",parameters:[{name:"array"},{name:"quart"}]},{name:"QUOTIENT",description:"除算で得た商の整数部分を返します。QUOTIENT 関数は、商の余り（剰余）を無視したい場合に使用します。",parameters:[{name:"numerator"},{name:"denominator"}]},{name:"RADIANS",description:"度単位の角度の値をラジアン単位に変換します。",parameters:[{name:"value"}]},{name:"RADIANS",description:"度単位の角度の値をラジアン単位に変換します。",parameters:[{name:"value"}]},{name:"RAND",description:"分布が一様な、0以上1未満の乱数を発生させます。RAND 関数は、スプレッドシートが再計算されるたびに新たな乱数を発生させます。",parameters:[]},{name:"RANDBETWEEN",description:"指定した２つの数値間の範囲で乱数を発生させます。RANDBETWEEN 関数は、シートが再計算されるたびに新たに乱数を発生させます。",parameters:[{name:"lower"},{name:"upper"}]},{name:"RANK",description:"数値リストの中から、指定の数値が何番目に位置するかを返します。RANK 関数の返す順位は、リスト内の数値を並べ替えた場合の数値の順位となります。",parameters:[{name:"number"},{name:"array"},{name:"order"}]},{name:"RATE",description:"投資期間を通じた利率を返します。",parameters:[{name:"nper"},{name:"pmt"},{name:"pval"},{name:"fval"},{name:"type"},{name:"guess"}]},{name:"RECEIVED",description:"全額投資された証券に対して、満期に支払われる金額を返します。",parameters:[{name:"settle"},{name:"mature"},{name:"invest"},{name:"discount"},{name:"basis"}]},{name:"REPLACE",description:"文字列の一部を別の文字列に置き換えます。",parameters:[{name:"old_text"},{name:"start_char"},{name:"num_chars"},{name:"new_text"}]},{name:"REPT",description:"文字列を指定の回数分、繰り返し表示します。",parameters:[{name:"text"},{name:"number"}]},{name:"RIGHT",description:"テキスト値から右端の文字を返します。",parameters:[{name:"text"},{name:"num_chars"}]},{name:"ROMAN",description:"アラビア数字を、ローマ数字を表すテキストに変換します。",parameters:[{name:"number"},{name:"style"}]},{name:"ROUND",description:"指定の数値を、指定の桁数になるように四捨五入します。",parameters:[{name:"value"},{name:"places"}]},{name:"ROUNDDOWN",description:"指定の数値を、指定の桁数になるように切り捨てます。",parameters:[{name:"value"},{name:"places"}]},{name:"ROUNDUP",description:"指定の数値を、指定の桁数になるように切り上げます。",parameters:[{name:"value"},{name:"places"}]},{name:"ROW",description:"参照の行番号を返します。",parameters:[{name:"reference"}]},{name:"ROWS",description:"配列内の行数を返します。",parameters:[{name:"array"}]},{name:"RSQ",description:"既知の x と既知の Y を通過する回帰直線のデータ点を使用して、ピアソン積率相関係数の二乗を返します。",parameters:[{name:"array_dep"},{name:"array_ind"}]},{name:"SEARCH",description:"テキスト内から指定の文字を検索し、テキスト内におけるこの文字の開始位置を返します。",parameters:[{name:"string1"},{name:"string2"}]},{name:"SECOND",description:"指定の時刻値に対応する秒の値（0～59）を返します。",parameters:[{name:"time"}]},{name:"SERIESSUM",description:"べき級数を返します。",parameters:[{name:"x"},{name:"n"},{name:"m"},{name:"coeff"}]},{name:"SIGN",description:"数値の符号を返します。",parameters:[{name:"cellreference"}]},{name:"SIN",description:"指定した角度のサインを返します。",parameters:[{name:"angle"}]},{name:"SINH",description:"指定した数値のハイパーボリックサインを返します。",parameters:[{name:"value"}]},{name:"SKEW",description:"分布の歪度（平均値からのデータの偏り）を返します。",parameters:[{name:"number1"},{name:"number2",repeatable:!0}]},{name:"SLN",description:"定額法を使用して、１期あたりの資産の減価償却費を算出します。",parameters:[{name:"cost"},{name:"salvage"},{name:"life"}]},{name:"SLOPE",description:"回帰直線の傾きを算出します。",parameters:[{name:"array_dep"},{name:"array_ind"}]},{name:"SMALL",description:"データ集合内で n 番目に小さい値を返します。",parameters:[{name:"array"},{name:"n"}]},{name:"SQRT",description:"指定した数値の正の平方根を返します。",parameters:[{name:"value"}]},{name:"SQRTPI",description:"指定の数値を円周率に掛けた値の正の平方根を返します。",parameters:[{name:"multiple"}]},{name:"STANDARDIZE",description:"特定の平均値と標準偏差で決定される分布を標準化するための変量を返します。",parameters:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"STDEVA",description:"指定した数値の集合から標準偏差を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"STDEVP",description:"引数として指定した母集団全体の標準偏差を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"STDEVPA",description:"引数として指定した母集団全体の標準偏差を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"STEYX",description:"個別の x に対する y の予測値の標準誤差を返します。標準誤差とは、x 値に対して予測される y 値の誤差の量を表す指標です。",parameters:[{name:"array_dep"},{name:"array_ind"}]},{name:"SUBSTITUTE",description:"既存文字列内の指定の文字を、新規文字列に置き換えます。",parameters:[{name:"text"},{name:"old_piece"},{name:"new_piece"},{name:"instance"}]},{name:"SUBTOTAL",description:"小計を返します。",parameters:[{name:"functioncode"},{name:"value1"},{name:"value2",repeatable:!0}]},{name:"SUM",description:"セルまたはセルブロックの和を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"SUMIF",description:"指定の基準に基づき、セル値を合計します。",parameters:[{name:"array"},{name:"condition"},{name:"sumrange"}]},{name:"SUMIFS",description:"複数の基準に基づき、セル値を合計します。",parameters:[{name:"array"},{name:"conditionarray"},{name:"condition",repeatable:!0}]},{name:"SUMPRODUCT",description:"指定の配列内の対応する要素の積を算出し、これらの積の合計を返します。",parameters:[{name:"array1"},{name:"array2",repeatable:!0}]},{name:"SUMSQ",description:"引数に指定した値の２乗の合計を返します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"SUMX2MY2",description:"２つの配列内の対応する要素の平方差を合計して返します。",parameters:[{name:"array_x"},{name:"array_y"}]},{name:"SUMX2PY2",description:"２つの配列内の対応する要素の平方和を合計して返します。",parameters:[{name:"array_x"},{name:"array_y"}]},{name:"SUMXMY2",description:"２つの配列内の対応する要素の差を２乗して合計します。",parameters:[{name:"array_x"},{name:"array_y"}]},{name:"SYD",description:"定額逓減法を使用して、特定期間の資産の減価償却費を返します。",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"}]},{name:"T",description:"セル内にテキストが保持されている場合にこのテキストを返します。",parameters:[{name:"value"}]},{name:"TAN",description:"指定した角度のタンジェントを返します。",parameters:[{name:"angle"}]},{name:"TANH",description:"指定した数値のハイパーボリックタンジェントを返します。",parameters:[{name:"value"}]},{name:"TBILLEQ",description:"米国財務省短期証券（TB）の債券に相当する利回りを返します。",parameters:[{name:"settle"},{name:"mature"},{name:"discount"}]},{name:"TBILLPRICE",description:"米国財務省短期証券（TB）の額面 $100 あたりの価格を返します。",parameters:[{name:"settle"},{name:"mature"},{name:"discount"}]},{name:"TBILLYIELD",description:"米国財務省短期証券（TB）の利回りを返します。",parameters:[{name:"settle"},{name:"mature"},{name:"priceper"}]},{name:"TDIST",description:"t 分布の確率を返します。",parameters:[{name:"x"},{name:"deg"},{name:"tails"}]},{name:"TEXT",description:"数値を書式設定し、テキストに変換します。",parameters:[{name:"value"},{name:"text"}]},{name:"TIME",description:"指定の時間に対する DateTime オブジェクトを返します。",parameters:[{name:"hour"},{name:"minutes"},{name:"seconds"}]},{name:"TIMEVALUE",description:"文字列で表される時刻に対応する時間間隔値を返します。",parameters:[{name:"time_string"}]},{name:"TINV",description:"スチューデントの t 分布の値を、確率と自由度を使用した関数として算出します。",parameters:[{name:"prog"},{name:"deg"}]},{name:"TODAY",description:"現在の日付を表す連続値を返します。",parameters:[]},{name:"TRANSPOSE",description:"水平セル範囲を垂直セル範囲として返し、垂直セル範囲を水平セル範囲として返します。",parameters:[{name:"array"}]},{name:"TREND",description:"回帰直線に対して予測される値を返します。",parameters:[{name:"y"},{name:"x"},{name:"newx"},{name:"constant"}]},{name:"TRIM",description:"文字列から余分なスペースを削除し、単語間に１文字分のスペースを保ちます。",parameters:[{name:"text"}]},{name:"TRIMMEAN",description:"上位および下位のデータを除外した、データセット内の中間データの平均値を算出します。",parameters:[{name:"array"},{name:"percent"}]},{name:"TRUE",description:"論理値１（True）を返します。",parameters:[]},{name:"TRUNC",description:"スチューデントの t 検定に関連する確率を返します。",parameters:[{name:"value"},{name:"precision"}]},{name:"TTEST",description:"スチューデントの t 検定に関連する確率を返します。",parameters:[{name:"array1"},{name:"array2"},{name:"tails"},{name:"type"}]},{name:"TYPE",description:"値のデータ型を返します。",parameters:[{name:"value"}]},{name:"UPPER",description:"テキストを大文字に変換します。",parameters:[{name:"string"}]},{name:"VALUE",description:"数値を表す文字列を数値に変換します。",parameters:[{name:"text"}]},{name:"VAR",description:"引数値を母集団の標本とみなし、母集団の分散を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VARA",description:"引数値を母集団の標本とみなし、母集団の分散を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VARP",description:"母集団全体の分散を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VARPA",description:"母集団全体の分散を算出します。",parameters:[{name:"value1"},{name:"value2",repeatable:!0}]},{name:"VDB",description:"倍率法を使用して、指定した任意の期間における資産の減価償却費を算出します。",parameters:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"start"},{name:"end"},{name:"factor"},{name:"switchnot"}]},{name:"VLOOKUP",description:"指定範囲の最左列から値を検索し、指定の列から、この値と同じ行内の値を返します。",parameters:[{name:"value"},{name:"array"},{name:"colindex"},{name:"approx"}]},{name:"WEEKDAY",description:"指定の日付に対応する曜日を返します。",parameters:[{name:"date"},{name:"type"}]},{name:"WEEKNUM",description:"指定の日付がその年の何週目に当たるかを表す数値を返します。",parameters:[{name:"date"},{name:"weektype"}]},{name:"WEIBULL",description:"２つのパラメータによるワイブル分布の値を算出します。これは、信頼性の分析などによく使用されます。",parameters:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"WORKDAY",description:"開始日より指定の日数分以前または以降の稼働日の値を返します。",parameters:[{name:"startdate"},{name:"numdays"},{name:"holidays"}]},{name:"XIRR",description:"予定されているキャッシュフロー（定期的、または不定期）に基づき、内部利益率を計算します。",parameters:[{name:"values"},{name:"dates"},{name:"guess"}]},{name:"XNPV",description:"予定されているキャッシュフロー（定期的、または不定期）に基づき、正味現在価値を計算します。",parameters:[{name:"rate"},{name:"values"},{name:"dates"}]},{name:"YEAR",description:"指定の日付に対応する年を表す整数を返します。",parameters:[{name:"date"}]},{name:"YEARFRAC",description:"開始日から終了日までの期間内の完全な日数が、１年のどれだけを占めるかを表す割合を返します。",parameters:[{name:"startdate"},{name:"enddate"},{name:"basis"}]},{name:"YIELD",description:"定期的に利息が支払われる証券の利回りを計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"rate"},{name:"price"},{name:"redeem"},{name:"frequency"},{name:"basis"}]},{name:"YIELDDISC",description:"割引債の年利回りを計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"price"},{name:"redeem"},{name:"basis"}]},{name:"YIELDMAT",description:"満期に利息が支払われる証券の年利回りを計算します。",parameters:[{name:"settle"},{name:"maturity"},{name:"issue"},{name:"issrate"},{name:"price"},{name:"basis"}]},{name:"ZTEST",description:"z 検定の有意値を返します。z 検定では、一群のデータに対する検定値 x の標準スコアを生成し、正規分布の両側の確率値を返します。",parameters:[{name:"array"},{name:"x"},{name:"sigma"}]},{name:"PIESPARKLINE",description:"円スパークラインを表示する為のデータセットを返します",parameters:[{name:"range|percentage"},{name:"color",repeatable:!0}]},{name:"AREASPARKLINE",description:"面スパークラインを表示する為のデータセットを返します",parameters:[{name:"points"},{name:"mini"},{name:"maxi"},{name:"line1"},{name:"line2"},{name:"colorPositive"},{name:"colorNegative"}]},{name:"SCATTERSPARKLINE",description:"散布図スパークラインを表示する為のデータセットを返します",parameters:[{name:"points1"},{name:"points2"},{name:"minX"},{name:"maxX"},{name:"minY"},{name:"maxY"},{name:"hLine"},{name:"vLine"},{name:"xMinZone"},{name:"xMaxZone"},{name:"yMinZone"},{name:"yMaxZone"},{name:"tags"},{name:"drawSymbol"},{name:"drawLines"},{name:"color1"},{name:"color2"},{name:"dash"}]},{name:"LINESPARKLINE",description:"折れ線スパークラインを表示する為のデータセットを返します",parameters:[{name:"data"},{name:"dataOrientation"},{name:"dateAxisData"},{name:"dateAxisOrientation"},{name:"setting"}]},{name:"COLUMNSPARKLINE",description:"縦棒スパークラインを表示する為のデータセットを返します",parameters:[{name:"data"},{name:"dataOrientation"},{name:"dateAxisData"},{name:"dateAxisOrientation"},{name:"setting"}]},{name:"WINLOSSSPARKLINE",description:"勝敗スパークラインを表示する為のデータセットを返します",parameters:[{name:"data"},{name:"dataOrientation"},{name:"dateAxisData"},{name:"dateAxisOrientation"},{name:"setting"}]}],a
}();a.FormulaTextBoxResource_JP=c}(a.spread||(a.spread={}));a.spread}(wijmo||(wijmo={}));
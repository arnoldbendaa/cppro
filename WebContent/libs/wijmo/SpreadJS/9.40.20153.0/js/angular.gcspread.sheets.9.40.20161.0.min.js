/*
 *
 * SpreadJS Library 9.40.20161.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
(function(){function s(n){this.headerText="";this.dataField=""}function f(n){var t,i;return n?(n=n.trim(),t=n.indexOf(",")>=0?n.split(","):n.split(" "),i=new GcSpread.Sheets.LineBorder,i.color=t[0].trim(),t.length>1&&(i.style=GcSpread.Sheets.LineStyle[t[1].trim()]),i):undefined}function u(n,t,i){if(n&&t){t=t.toLowerCase();var r;t==="numbervalidator"?r=GcSpread.Sheets.DefaultDataValidator.createNumberValidator(i.comparisonOperator,i.value1,i.value2,i.isIntegervalue):t==="datevalidator"?r=GcSpread.Sheets.DefaultDataValidator.createDateValidator(i.comparisonOperator,i.value1,i.value2):t==="textlengthvalidator"?r=GcSpread.Sheets.DefaultDataValidator.createTextLengthValidator(i.comparisonOperator,i.value1,i.value2):t==="formulavalidator"?r=GcSpread.Sheets.DefaultDataValidator.createFormulaValidator(i.formula):t==="formulalistvalidator"?r=GcSpread.Sheets.DefaultDataValidator.createFormulaListValidator(i.formulaList):t==="listvalidator"&&(r=GcSpread.Sheets.DefaultDataValidator.createListValidator(i.list));r&&(i.ignoreBlank!==undefined&&(r.ignoreBlank=i.ignoreBlank),i.inCellDropdown!==undefined&&(r.inCellDropdown=i.inCellDropdown),i.showInputMessage!==undefined&&(r.showInputMessage=i.showInputMessage),i.showErrorMessage!==undefined&&(r.showErrorMessage=i.showErrorMessage),i.errorStyle!==undefined&&(r.errorStyle=i.errorStyle),i.inputMessage!==undefined&&(r.inputMessage=i.inputMessage),i.inputTitle!==undefined&&(r.inputTitle=i.inputTitle),i.errorMessage!==undefined&&(r.errorMessage=i.errorMessage),i.errorTitle!==undefined&&(r.errorTitle=i.errorTitle),n.validator=r)}}function v(n,t,i){n._angularDataValidationResult=i}function y(n,t,i){if(i.text!==undefined||i.value!==undefined){i.text===undefined?i.text=i.value:i.value===undefined&&(i.value=i.text);var r;n.items()?r=n.items():(r=[],n.items(r));r.push(i)}}function h(n,t,i){t&&i.groups&&(t=t.toLowerCase().trim(),angular.forEach(i.groups,function(i){t==="rowrangegroup"?n.rowRangeGroup.group(i.index,i.count):n.colRangeGroup.group(i.index,i.count)}))}function p(n,t,i){n.groups||(n.groups=[]);n.groups.push(i)}function ot(n,t,i){rangeGroup.groups||(rangeGroup.groups=[]);rangeGroup.groups.push(i)}function w(n,t){return n[t].call(n).name()}function b(n,t,i){n._columnDefs=i}function k(n,t,i){n._sheetDefs=i;i.spread=n}function d(n,t,i){n.push(i)}function g(n,t,i){n.push(i);n.spread.addSheet(n.length-1,i)}function nt(n,t,i){n._angularDataSource=i}function tt(n,t,i){n.borderLeft||(n.borderLeft=i);n.borderTop||(n.borderTop=i);n.borderRight||(n.borderRight=i);n.borderBottom||(n.borderBottom=i)}var l=angular.module("gcspreadsheets",[]),a=angular.module("wijspread",[]),i,o,e,t,n;for(s.prototype={width:function(n){return arguments.length===0?this.column?this.column.width():undefined:(this._width=n,this.column&&this.column.width(n),this)},visible:function(n){return arguments.length===0?this.column?this.column.visible():undefined:(this._visible=n,this.column&&this.column.visible(n),this)},resizable:function(n){return arguments.length===0?this.column?this.column.resizable():undefined:(this._resizable=n,this.column&&this.column.resizable(n),this)},defaultStyle:function(n){return arguments.length===0?this.sheet?this.sheet.getStyle(-1,this.index,GcSpread.Sheets.SheetArea.viewport):null:(this._defaultStyle=n,this.sheet&&this.sheet.setStyle(-1,this.index,n,GcSpread.Sheets.SheetArea.viewport),this)},attach:function(n,t,i){this.sheet=n;this.column=t;this.index=i;this.updata()},updata:function(){this.sheet.suspendEvent();this._width!==undefined&&this.column.width(this._width);this._visible!==undefined&&this.column.visible(this._visible);this._resizable!==undefined&&this.column.resizable(this._resizable);this._defaultStyle&&this.sheet.setStyle(-1,this.index,this._defaultStyle,GcSpread.Sheets.SheetArea.viewport);this.autoFit&&this.sheet.autoFitColumn(this.index);this.sheet.resumeEvent()}},GcSpread.Sheets.ColumnWrapper=s,i={backcolor:{type:"string",name:"backColor"},forecolor:{type:"string",name:"foreColor"},halign:{type:"enum, HorizontalAlign",name:"hAlign"},valign:{type:"enum, VerticalAlign",name:"vAlign"},font:{type:"string",name:"font"},themefont:{type:"string",name:"themeFont"},formatter:{type:"string",name:"formatter"},border:{type:"LineBordeer",name:"border",getProperties:["borderLeft","borderTop","borderRight","borderBottom"],setFunction:tt,converter:f},borderleft:{type:"LineBorder",name:"borderLeft",converter:f},bordertop:{type:"LineBorder",name:"borderTop",converter:f},borderright:{type:"LineBorder",name:"borderRight",converter:f},borderbottom:{type:"LineBorder",name:"borderBottom",converter:f},locked:{type:"boolean",name:"locked"},wordwrap:{type:"boolean",name:"wordWrap"},textindent:{type:"number",name:"textIndent"},shrinktofit:{type:"boolean",name:"shrinkToFit"},backgroundimage:{type:"string",name:"backgroundImage"},backgroundimagelayout:{type:"enum, ImageLayout",name:"backgroundImageLayout"},numbervalidator:{type:"object",name:"numberValidator",setFunction:u,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"},isintegervalue:{type:"boolean",name:"isIntegerValue"}}},datevalidator:{type:"object",name:"dateValidator",setFunction:u,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"}}},textlengthvalidator:{type:"object",name:"textLengthValidator",setFunction:u,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"}}},formulavalidator:{type:"object",name:"formulaValidator",setFunction:u,properties:{formula:{type:"string",name:"formula"}}},formulalistvalidator:{type:"object",name:"formulaListValidator",setFunction:u,properties:{formulalist:{type:"string",name:"formulaList"}}},listvalidator:{type:"object",name:"listValidator",setFunction:u,properties:{list:{type:"string",name:"list"}}},textcelltype:{type:"TextCellType",name:"cellType",properties:{}},buttoncelltype:{type:"ButtonCellType",name:"cellType",properties:{buttonbackcolor:{type:"string",name:"buttonBackColor",setFunction:"buttonBackColor"},marginleft:{type:"number",name:"marginLeft",setFunction:"marginLeft"},margintop:{type:"number",name:"marginTop",setFunction:"marginTop"},marginright:{type:"number",name:"marginRight",setFunction:"marginRight"},marginbottom:{type:"number",name:"marginBottom",setFunction:"marginBottom"},text:{type:"string",name:"text",setFunction:"text"}}},checkboxcelltype:{type:"CheckBoxCellType",name:"cellType",properties:{caption:{type:"string",name:"caption",setFunction:"caption"},isthreestate:{type:"boolean",name:"isThreeState",setFunction:"isThreeState"},textalign:{type:"enum,CheckBoxTextAlign",name:"textAlign",setFunction:"textAlign"},textfalse:{type:"string",name:"textFalse",setFunction:"textFalse"},textindeterminate:{type:"string",name:"textIndeterminate",setFunction:"textIndeterminate"},texttrue:{type:"string",name:"textTrue",setFunction:"textTrue"}}},comboboxcelltype:{type:"ComboBoxCellType",name:"cellType",properties:{editorvaluetype:{type:"enum,EditorValueType",name:"editorValueType",setFunction:"editorValueType"},item:{type:"object",name:"items",setFunction:y,properties:{value:{type:"string",name:"value"},text:{type:"string",name:"text"}}}}},hyperlinkcelltype:{type:"HyperLinkCellType",name:"cellType",properties:{linkcolor:{type:"string",name:"linkColor",setFunction:"linkColor"},linktooltip:{type:"string",name:"linkToolTip",setFunction:"linkToolTip"},text:{type:"string",name:"text",setFunction:"text"},visitedlinkcolor:{type:"string",name:"visitedLinkColor",setFunction:"visitedLinkColor"}}}},o=["numbervalidator","datevalidator","textlengthvalidator","formulavalidator","formulalistvalidator","listvalidator"],e=0;e<o.length;e++)t=i[o[e]].properties,t.ignoreblank={type:"boolean",name:"ignoreBlank"},t.incelldropdown={type:"boolean",name:"inCellDropdown"},t.showinputmessage={type:"boolean",name:"showInputMessage"},t.showerrormessage={type:"boolean",name:"showErrorMessage"},t.errorstyle={type:"enum, ErrorStyle",name:"errorStyle"},t.inputmessage={type:"string",name:"inputMessage"},t.inputtitle={type:"string",name:"inputTitle"},t.errormessage={type:"string",name:"errorMessage"},t.errortitle={type:"string",name:"errorTitle"};var c={group:{type:"object",name:"group",setFunction:p,properties:{index:{type:"number",name:"index"},count:{type:"number",name:"count"}}}},it={datafield:{type:"string",name:"dataField"},headertext:{type:"string",name:"headerText"},width:{type:"number",name:"width",setFunction:"width",getFunction:"width"},visible:{type:"boolean",name:"visible",setFunction:"visible",getFunction:"visible"},resizable:{type:"boolean",name:"resizable",setFunction:"resizable",getFunction:"resizable"},defaultstyle:{type:"Style",name:"defaultStyle",setFunction:"defaultStyle",getFunction:"defaultStyle",properties:i},autofit:{type:"boolean",name:"autoFit"}},rt={column:{type:"ColumnWrapper",name:"column",setFunction:d,properties:it}},ut={name:{type:"string",name:"name",setFunction:"setName",getFunction:"getName"},referencestyle:{type:"enum, ReferenceStyle",name:"referenceStyle",setFunction:"referenceStyle",getFunction:"referenceStyle"},frozentrailingcolumncount:{type:"number",name:"frozenTrailingColumnCount",setFunction:"setFrozenTrailingColumnCount",getFunction:"getFrozenTrailingColumnCount"},frozentrailingrowcount:{type:"number",name:"frozenTrailingRowCount",setFunction:"setFrozenTrailingRowCount",getFunction:"getFrozenTrailingRowCount"},frozencolumncount:{type:"number",name:"frozenColumnCount",setFunction:"setFrozenColumnCount",getFunction:"getFrozenColumnCount"},frozenrowcount:{type:"number",name:"frozenRowCount",setFunction:"setFrozenRowCount",getFunction:"getFrozenRowCount"},defaultstyle:{type:"Style",name:"defaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.viewport]},properties:i},rowheaderdefaultstyle:{type:"Style",name:"rowHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.rowHeader]},properties:i},columnheaderdefaultstyle:{type:"Style",name:"columnHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.colHeader]},properties:i},cornerheaderdefaultstyle:{type:"Style",name:"cornerHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.corner]},properties:i},allowcelloverflow:{type:"boolean",name:"allowCellOverflow",setFunction:"allowCellOverflow",getFunction:"allowCellOverflow"},frozenlinecolor:{type:"string",name:"frozenlineColor",setFunction:"frozenlineColor",getFunction:"frozenlineColor"},sheettabcolor:{type:"string",name:"sheetTabColor",setFunction:"sheetTabColor",getFunction:"sheetTabColor"},rowcount:{type:"number",name:"rowCount",setFunction:"setRowCount",getFunction:"getRowCount"},selectionpolicy:{type:"enum, SelectionPolicy",name:"selectionPolicy",setFunction:"selectionPolicy",getFunction:"selectionPolicy"},selectionunit:{type:"enum,SelectionUnit",name:"selectionUnit",setFunction:"selectionUnit",getFunction:"selectionUnit"},zoom:{type:"number",name:"zoom",setFunction:"zoom",getFunction:"zoom"},currenttheme:{type:"string",name:"currentTheme",setFunction:"currentTheme",getFunction:w},clipboardoptions:{type:"enum,ClipboardPasteOptions",name:"clipBoardOptions",setFunction:"clipBoardOptions",getFunction:"clipBoardOptions"},canuserdragfill:{type:"boolean",name:"canUserDragFill",setFunction:"canUserDragFill",getFunction:"canUserDragFill"},canuserdragdrop:{type:"boolean",name:"canUserDragDrop",setFunction:"canUserDragDrop",getFunction:"canUserDragDrop"},rowheadervisible:{type:"boolean",name:"rowHeaderVisible",setFunction:"setRowHeaderVisible",getFunction:"getRowHeaderVisible"},columnheadervisible:{type:"boolean",name:"columnHeaderVisible",setFunction:"setColumnHeaderVisible",getFunction:"getColumnHeaderVisible"},rowheaderautotext:{type:"enum, HeaderAutoText",name:"rowHeaderAutoText",setFunction:"setRowHeaderAutoText",getFunction:"getRowHeaderAutoText"},columnheaderautotext:{type:"enum, HeaderAutoText",name:"columnHeaderAutoText",setFunction:"setColumnHeaderAutoText",getFunction:"getColumnHeaderAutoText"},rowheaderautotextindex:{type:"number",name:"rowHeaderAutoTextIndex",setFunction:"setRowHeaderAutoTextIndex",getFunction:"getRowHeaderAutoTextIndex"},columnheaderautotextindex:{type:"number",name:"columnHeaderAutoTextIndex",setFunction:"setColumnHeaderAutoTextIndex",getFunction:"getColumnHeaderAutoTextIndex"},isprotected:{type:"boolean",name:"isProtected",setFunction:"setIsProtected",getFunction:"getIsProtected"},showrowrangegroup:{type:"boolean",name:"showRowRangeGroup",setFunction:"showRowRangeGroup",getFunction:"showRowRangeGroup"},showcolumnrangegroup:{type:"boolean",name:"showColumnRangeGroup",setFunction:"showColumnRangeGroup",getFunction:"showColumnRangeGroup"},rowrangegroup:{type:"object",name:"rowRangeGroup",setFunction:h,properties:c},colrangegroup:{type:"object",name:"colRangeGroup",setFunction:h,properties:c},selectionbackcolor:{type:"string",name:"selectionBackColor",setFunction:"selectionBackColor",getFunction:"selectionBackColor"},selectionbordercolor:{type:"string",name:"selectionBorderColor",setFunction:"selectionBorderColor",getFunction:"selectionBorderColor"},columns:{type:"[]",name:"columns",setFunction:b,properties:rt},datasource:{type:"[]",name:"dataSource",setFunction:nt},datasourcedeepwatch:{type:"boolean",name:"dataSourceDeepWatch"}},ft={sheet:{type:"Sheet",name:"sheet",setFunction:g,properties:ut}},et={name:{type:"string",name:"name"},allowuserzoom:{type:"boolean",name:"allowUserZoom",setFunction:"allowUserZoom",getFunction:"allowUserZoom"},allowuserresize:{type:"boolean",name:"allowUserResize",setFunction:"allowUserResize",getFunction:"allowUserResize"},tabstripvisible:{type:"boolean",name:"tabStripVisible",setFunction:"tabStripVisible",getFunction:"tabStripVisible"},tabeditable:{type:"boolean",name:"tabEditable",setFunction:"tabEditable",getFunction:"tabEditable"},newtabvisible:{type:"boolean",name:"newTabVisible",setFunction:"newTabVisible",getFunction:"newTabVisible"},canusereditformula:{type:"boolean",name:"canUserEditFormula",setFunction:"canUserEditFormula",getFunction:"canUserEditFormula"},autofittype:{type:"enum, AutoFitType",name:"autoFitType",setFunction:"autoFitType",getFunction:"autoFitType"},canuserdragfill:{type:"boolean",name:"canUserDragFill",setFunction:"canUserDragFill",getFunction:"canUserDragFill"},canuserdragdrop:{type:"boolean",name:"canUserDragDrop",setFunction:"canUserDragDrop",getFunction:"canUserDragDrop"},highlightinvaliddata:{type:"boolean",name:"highlightInvalidData",setFunction:"highlightInvalidData",getFunction:"highlightInvalidData"},referencestyle:{type:"enum, ReferenceStyle",name:"referenceStyle",setFunction:"referenceStyle",getFunction:"referenceStyle"},backcolor:{type:"string",name:"backColor",setFunction:"backColor",getFunction:"backColor"},grayareabackcolor:{type:"string",name:"grayAreaBackColor",setFunction:"grayAreaBackColor",getFunction:"grayAreaBackColor"},backgroundimage:{type:"string",name:"backgroundImage",setFunction:"backgroundImage",getFunction:"backgroundImage"},backgroundimagelayout:{type:"enum, ImageLayout",name:"backgroundImageLayout",setFunction:"backgroundImageLayout",getFunction:"backgroundImageLayout"},showverticalscrollbar:{type:"boolean",name:"showVerticalScrollbar",setFunction:"showVerticalScrollbar",getFunction:"showVerticalScrollbar"},showhorizontalscrollbar:{type:"boolean",name:"showHorizontalScrollbar",setFunction:"showHorizontalScrollbar",getFunction:"showHorizontalScrollbar"},showscrolltip:{type:"enum, ShowScrollTip",name:"showScrollTip",setFunction:"showScrollTip",getFunction:"showScrollTip"},showresizetip:{type:"enum, ShowResizeTip",name:"showResizeTip",setFunction:"showResizeTip",getFunction:"showResizeTip"},showdragdroptip:{type:"boolean",name:"showDragDropTip",setFunction:"showDragDropTip",getFunction:"showDragDropTip"},showdragfilltip:{type:"boolean",name:"showDragFillTip",setFunction:"showDragFillTip",getFunction:"showDragFillTip"},datavalidationresult:{type:"enum, DataValidationResult",name:"DataValidationResult",setFunction:v},sheets:{type:"[]",name:"sheets",setFunction:k,properties:ft}},r;(function(n){n._map=[];n.ELEMENT_NODE=1;n.ATTRIBUTE_NODE=2;n.TEXT_NODE=3;n.CDATA_SECTION_NODE=4;n.ENTITY_REFERENCE_NODE=5;n.ENTITY_NODE=6;n.PROCESSING_INSTRUCTION_NODE=7;n.COMMENT_NODE=8;n.DOCUMENT_NODE=9;n.DOCUMENT_TYPE_NODE=10;n.DOCUMENT_FRAGMENT_NODE=11;n.NOTATION_NODE=12})(r||(r={}));n=function(){};n.prototype.setValues=function(n){var t=this;this.valueCatch&&angular.forEach(this.valueCatch,function(n){var i=n.target;angular.forEach(n.setting,function(n){var r=n.nodeDef,u=n.value;t.setPropertyValue(i,r,u)})})};n.prototype.setBindings=function(n){var t=n.$parent,i=this;this.bindings&&angular.forEach(this.bindings,function(n){var r,u;n.dynamicText&&(r=n.dynamicText.substring(2,n.dynamicText.length-2),n.target._angularBindingPath||(n.target._angularBindingPath={}),n.target._angularBindingPath[n.name]=r,u=r,t[u]===undefined?t[u]=i.getPropertyValue(n.target,n.metadata):i.setPropertyValue(n.target,n.metadata,t[u]),t.$watch(r,function(t){i.setPropertyValue(n.target,n.metadata,t)}))})};n.prototype.initSpread=function(n,t,i){var r=t[0];this._readNodeWithChildren(n,r,et,"sheets",!1)};n.prototype._readNodeWithChildren=function(n,t,i,r,u){var e=this,f;u||(this.valueCatch||(this.valueCatch=[]),angular.forEach(this.valueCatch,function(t){t.target===n&&(f=t)}),f||(f={target:n,setting:[]},this.valueCatch.push(f)));angular.forEach(t.attributes,function(t){e._readNode(n,t,i,f,u)});t.childNodes.length>0&&angular.forEach(t.childNodes,function(t){var s=t.nodeName.toLowerCase(),r,o,h;if(s=e.normalizeName(s),r=i[s],r&&r.type){if(r.type==="object")o={};else if(r.type==="[]")o=[];else{if(h=GcSpread.Sheets[r.type],!h)return;o=new h}r.name==="sheets"||r.name==="sheet"||r.name==="columns"||r.name==="column"?e._readNodeWithChildren(o,t,r.properties,undefined,!1):e._readNodeWithChildren(o,t,r.properties,undefined,!0);u?e.setPropertyValue(n,r,o):f.setting.push({nodeDef:r,value:o})}})};n.prototype.convertValue=function(n,t,i){var s,e,r,f,o,u;if(i)return i.call(null,n);if(n===undefined||t===undefined)return n;if(typeof n=="string"&&(n=n.trim()),t.length>2&&t[0]==="["&&(s=t.substring(1,t.length-2),n.length>2)){for(n[0]==="["&&n[n.length-1]==="]"&&(n=n.substring(1,n.length-2)),e=n.split(","),r=[],u=0;u<e.length;u++)r.push(this.convertValue(e[u],s,i));return r}switch(t){case"string":return n;case"boolean":if(typeof n=="boolean")return n;if(n.toLowerCase()==="true")return!0;else if(n.toLowerCase()==="false")return!1;return Boolean(n);case"number":return Number(n);case"color":return n;case"[]":return n}if(t.length>5&&t.substring(0,5)==="enum,"){if(typeof n!="number"&&(typeof n!="string"||parseInt(n)===undefined||isNaN(parseInt(n)))){if(t=t.substring(5).trim(),f=GcSpread.Sheets,t.indexOf(".")>0)for(o=name.split("."),u=0;u<o.length;u++)f=r[o[u]];else f=f[t];r=f[n];r===undefined&&(n=n[0].toUpperCase()+n.substring(1),r=f[n])}else r=parseInt(n);return r}return n};n.prototype.normalizeName=function(n){if(n.match(/-/)){var t=n.split("-");n=t.shift();angular.forEach(t,function(t){n+=t})}return n};n.prototype._readNode=function(n,t,i,u,f){var e,o,h,s;switch(t.nodeType){case r.ATTRIBUTE_NODE:e=t.value;break;case r.ELEMENT_NODE:e=t.textContent;break;default:return}if(o=t.nodeName||t.name,o=o.toLowerCase(),o=this.normalizeName(o),s=i[o],s)o=s.name;else return;if(!this.hasChildElements(t)&&e&&e.length>4&&e.substring(0,2)==="{{"&&e.substring(e.length-2)==="}}"){this.bindings||(this.bindings=[]);this.bindings.push({target:n,metadata:s,path:o,name:o,dynamicText:e});return}e.match(/^[^\d]/)&&t.nodeType===r.ATTRIBUTE_NODE&&(s.changeEvent||s.twoWayBinding)?(this.bindings||(this.bindings=[]),_this.bindings.push({target:n,path:(path&&path+".")+o,name:o,expression:e})):t.nodeType===r.ATTRIBUTE_NODE&&(f?this.setPropertyValue(n,s,e):u.setting.push({nodeDef:s,value:e}))};n.prototype.setPropertyValue=function(n,t,i){if(i!==undefined){n.$scopeObject&&(n=n.$scopeObject);try{i=this.convertValue(i,t.type,t.converter);t.setFunction?typeof t.setFunction=="function"?t.setFunction.call(this,n,t.name,i):this.setPropertyValueCore(n,i,undefined,t.setFunction):(this.setPropertyValueCore(n,i,t.name),n[t.name]=i)}catch(r){}}};n.prototype.setPropertyValueCore=function(n,t,i,r){var f,u,e;if(i)n[i]=t;else if(r)if(typeof r=="string")n[r].call(n,t);else{for(f=r.name,u=[],e=0;e<r.args.length;e++)u[e]=r.args[e]==="$value-replace$"?t:r.args[e];switch(u.length){case 1:n[f].call(n,u[0]);break;case 2:n[f].call(n,u[0],u[1]);break;case 3:n[f].call(n,u[0],u[1],u[2]);break;case 4:n[f].call(n,u[0],u[1],u[2],u[3]);break;case 5:n[f].call(n,u[0],u[1],u[2],u[3],u[4]);break}}};n.prototype.getPropertyValue=function(n,t){n.$scopeObject&&(n=n.$scopeObject);var i="";try{if(t.getProperties)angular.forEach(t.getProperties,function(t){i=i===""?this.setPropertyValueCore(n,i,t):i+","+this.setPropertyValueCore(n,i,t)});else if(t.getFunction)if(typeof t.getFunction=="function")return t.getFunction.call(this,n,t.name);else i=this.getPropertyValueCore(n,undefined,t.getFunction);else i=this.getPropertyValueCore(n,name)}catch(r){}return i};n.prototype.getPropertyValueCore=function(n,t,i){if(t)return n[t];else if(i&&typeof i=="string")return n[i].call(n);return""};n.prototype.hasChildElements=function(n){var i,t,u;if(!n||!n.childNodes)return!1;for(i=n.childNodes.length,t=0;t<i;t++)if(u=n.childNodes[t],u.nodeType==r.ELEMENT_NODE)return!0;return!1};n.angularDerictive=function(){return{restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",scope:{},controller:["$scope",function(n){}],link:function(t,i,r){function y(n){var r=n._columnDefs&&n._columnDefs.length>0,i;if(r)for(n.setColumnCount(n._columnDefs.length),i=0;i<n._columnDefs.length;i++)n._columnDefs[i].attach(n,n.getColumn(i),i);n.bind(e.Events.ValidationError,function(n,t){t.validationResult=u._angularDataValidationResult!==undefined?u._angularDataValidationResult:e.DataValidationResult.Discard});n.bind(e.Events.ColumnWidthChanged,function(n,t){for(var u,f,e=t.sheet,r=t.colList,i=0;i<r.length;i++)u=e._columnDefs[r[i]],f=u._angularBindingPath&&u._angularBindingPath.width,f&&(o[f]=e.getColumnWidth(r[i]));o.$apply()});n.bind(e.Events.SheetNameChanged,function(t,i){var r=n._angularBindingPath&&n._angularBindingPath.name;r&&(o[r]=i.newValue,o.$apply())});n.bind(e.Events.UserZooming,function(t,i){var r=n._angularBindingPath&&n._angularBindingPath.zoom;r&&(o[r]=i.newValue,o.$apply())});c.setBindings(t)}function p(n,t,i){var f,o,s,u,r,h;if(i)if(i!==n.getDataSource()){if(n.isPaintSuspended(!0),f=n._columnDefs&&n._columnDefs.length>0,f)for(n.autoGenerateColumns=!1,n.setDataSource(i,!1),n.setColumnCount(n._columnDefs.length),r=0;r<n._columnDefs.length;r++)w(n,r);else{for(o=b(n),n.autoGenerateColumns=!0,n.setDataSource(i,!1),u=n.getColumnHeaderAutoTextIndex(),s=u<0?n.getRowCount(e.SheetArea.colHeader)-1:u,r=0;r<n.getColumnCount();r++)h=n.getValue(s,r,e.SheetArea.colHeader),h.indexOf("$$")==0&&(n.deleteColumns(r,1),r--);k(n,o)}n.parent.isPaintSuspended()?n.parent.isPaintSuspended(!1):n.isPaintSuspended(!1)}else i&&t&&i.length!=t.length?(n.setRowCount(i.length),n.invalidateLayout(),n.repaint()):(n.invalidateLayout(),n.repaint());else t&&n.setDataSource(null,!0)}function w(n,t){var r=n.getColumn(t),i=n._columnDefs[t];(i.dataField||i.headerText)&&n.bindColumn(t,{name:i.dataField,displayName:i.headerText});i.updata()}function b(n){for(var i=[],t=0;t<n.getColumnCount();t++)i.push(n.getColumn(t).width());return i}function k(n,t){if(n.getColumnCount()==t.length)for(var i=0;i<n.getColumnCount();i++)n.getColumn(i).width(t[i])}var c=new n,s,l,h,f,a,v;c.initSpread(t,i,r);var u=new GcSpread.Sheets.Spread(i[0],0),e=GcSpread.Sheets,o=t.$parent;if(t.$scopeObject=u,u.suspendCalcService(!0),u.isPaintSuspended(!0),c.setValues(t),s=u._sheetDefs,l=!1,s&&s.length>0)for(h=0;h<s.length;h++)f=s[h],f.suspendEvent(),y(f),f._angularDataSource&&(l=!0,a=!0,f.dataSourceDeepWatch!==undefined&&(a=f.dataSourceDeepWatch),v=function(n,t){o.$watch(n._angularDataSource,function(t,i){p(n,i,t)},t)},v(f,a)),f.resumeEvent();l||u.isPaintSuspended(!1);u.resumeCalcService(!1)}}};l.directive("gcspreadSheets",function(){return n.angularDerictive()});a.directive("wijSpread",function(){return n.angularDerictive()})})()
